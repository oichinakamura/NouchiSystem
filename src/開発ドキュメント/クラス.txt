



Class CFol印刷管理
    Option Explicit
    Implements ADBasicLIB2.CDataviewSK
    Private DVProperty As CDataviewProperty
    Private Sub Class_Initialize(): Set DVProperty = mvarPDW.DataviewCol.GetNewDVP: End Sub
    
    Public Property Let Key(RHS As String): DVProperty.SetDVP RHS: End Property
    Public Property Get Key() As String: Key = DVProperty.Key: End Property
    
    Private Sub CDataviewSK_CloseRecordset(): End Sub
    Private Property Set CDataviewSK_Container(ByVal RHS As ADBasicLIB2.CPDW): End Property

    Private Sub CDataviewSK_DblClick()
        Dim sSQL As String
        Select Case DVProperty.Key
            Case "印刷.1":
            Case "印刷.2":
            Case "印刷.81": MsgBox "住民区分に住登外の詳細がないと機能しません", vbInformation
            Case "印刷.160": mvarPDW.PrintGo ObjectMan.GetObject("名簿登載候補一覧.0")
            Case "印刷.161": mvarPDW.PrintGo ObjectMan.GetObject("選挙申請書.0")
            Case "印刷.162": mvarPDW.PrintGo ObjectMan.GetObject("選挙権確定者.0")
            Case "印刷.163":
                sSQL = "SELECT '行政区.' & [V_行政区].ID AS [KEY], [V_行政区].ID, [V_行政区].行政区, Sum(IIf([性別]=0,1,0)) AS 選挙登録日男, Sum(IIf([性別]=1,1,0)) AS 選挙登録日女, Count([D:個人Info].ID) AS 選挙登録日計, [D:個人Info].投票区 FROM [D:個人Info] RIGHT JOIN [V_行政区] ON [D:個人Info].行政区ID = [V_行政区].ID WHERE ((([D:個人Info].選挙権の有無) = TRUE) AND (([D:個人Info].住民区分) = 0)) GROUP BY '行政区.' & [V_行政区].ID, [V_行政区].ID, [V_行政区].行政区, [D:個人Info].投票区 " & _
                       "UNION SELECT '小計.' & [D:個人Info].[投票区] AS [KEY], NULL AS ID, '小計' AS 行政区, Sum(IIf([性別]=0,1,0)) AS 選挙登録日男, Sum(IIf([性別]=1,1,0)) AS 選挙登録日女, Count([D:個人Info].ID) AS 選挙登録日計, [D:個人Info].投票区+0.5 AS 投票区 FROM [D:個人Info] RIGHT JOIN [V_行政区] ON [D:個人Info].行政区ID = [V_行政区].ID WHERE ((([D:個人Info].選挙権の有無)=True) AND (([D:個人Info].住民区分)=0)) GROUP BY '行政区.' & [D:個人Info].[投票区], NULL, [投票区], NULL ORDER BY [投票区] " & _
                       "UNION SELECT '合計' AS [KEY], NULL AS ID, '合計' AS 行政区, Sum(IIf([性別]=0,1,0)) AS 選挙登録日男, Sum(IIf([性別]=1,1,0)) AS 選挙登録日女, Count([D:個人Info].ID) AS 選挙登録日計, 100 AS 投票区 FROM [D:個人Info] RIGHT JOIN [V_行政区] ON [D:個人Info].行政区ID = [V_行政区].ID WHERE ((([D:個人Info].選挙権の有無)=TRUE) AND (([D:個人Info].住民区分)=0)) GROUP BY NULL, '合計', 100 ORDER BY [投票区];"
                    mvarPDW.SQLListview.SQLListviewCHead sSQL, _
                    "行政区;行政区;@選挙登録日男;選挙登録日男;@選挙登録日女;選挙登録日女;@選挙登録日計;選挙登録日計", _
                    "行政区別・登録者数集計表"
            Case "印刷.181": 'SystemDB.ExecuteSQL "DELETE X_エラーリスト.AutoID FROM X_エラーリスト;"
            Case "印刷.190": mvarPDW.PrintGo ObjectMan.GetObject("小作地実態調査票.0")
            
            Case Else
                Dim SX As String
                SX = ADApp.Common.AppData(DVProperty.Key)
                
                If Len(SX) Then
                    Dim sTitle As String
                    Dim Sc As String
                    Dim sParam As String
                    Dim Ar As Variant
                    Ar = Split(SX, "&&&")
                    
                    sTitle = Ar(1)
                    Sc = Ar(2)
                    sParam = Replace(Ar(3), "%SYS.Date%", Date)
                    
                    sSQL = Ar(4)
                    
                    With Fnc.InputMulti(sTitle, Sc, sParam, , True)
                        If .IsALLEmpty Then
                        Else
                            sTitle = .StrReplace(sTitle)
                            sSQL = .StrReplace(sSQL)
                            Select Case Ar(0)
                                Case "農地リスト": view農地List sSQL, sTitle
                            End Select
                        End If
                    End With
                Else
                    Debug.Assert CaseAssertPrint(DVProperty.Key)
                End If
        End Select
    End Sub

    Private Function CDataviewSK_DoCommand2(sCmd As String, Optional sParam As String = "") As Variant
        Dim sSQL As String
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim Ar As Variant
        Dim St As String
        Dim n As Long
        
        If Len(sCmd) = 0 Then Exit Function
        With SystemDB
            Select Case CStr(DVProperty.ID) & ":" & sCmd
                Case "81:不在地主の区分設定"
                    mvarPDW.WaitMessage = "不在地主の区分設定中"
                    .ExecuteSQL "UPDATE [D:個人Info] SET [D:個人Info].不在区分 = Null;"
                    .ExecuteSQL "UPDATE [D:個人Info] SET [D:個人Info].不在区分 = 0 WHERE ((([D:個人Info].住所) Is Null));"
                    .ExecuteSQL "UPDATE [D:個人Info], (SELECT [DATA] FROM [S_システムデータ] WHERE [KEY]='市町村名') AS 市町村名 SET [D:個人Info].不在区分 = 1 WHERE ((([D:個人Info].住所) Like '*' & [DATA] & '*'));"
                    .ExecuteSQL "UPDATE [D:個人Info], (SELECT [DATA] FROM [S_システムデータ] WHERE [KEY]='台帳記載住民コード') AS 台帳記載住民コード SET [D:個人Info].不在区分 = 1 WHERE (([D:個人Info].住民区分)=Val([DATA]));"
                    .ExecuteSQL "UPDATE [D:個人Info] SET [D:個人Info].不在区分 = 0 WHERE ((([D:個人Info].不在区分) Is Null));"
                    mvarPDW.WaitMessage = ""
                Case "81:所有者が不在地主の小作地"
                    sSQL = "SELECT IIf([不在区分]=0,'不在','在村') AS 在村区分, Format(Sum([V_農地].田面積),'#,##0.00') AS 田面積の合計, Format$(Sum([V_農地].畑面積),'#,##0.00') AS 畑面積の合計, Format(Sum([田面積]+[畑面積]),'#,##0.00') AS 計 " & _
                    "FROM [V_農地] INNER JOIN [D:個人Info] ON [V_農地].管理人ID = [D:個人Info].ID " & _
                    "WHERE ((([自小作別] > 0) = True)) GROUP BY IIf([不在区分]=0,'不在','在村');"
                    SubMakeTable "所有者が不在地主の小作地", sSQL
               Case "81:借受者が不在地主の小作地"
                    sSQL = "SELECT IIf([不在区分]=0,'不在','在村') AS 在村区分, Format(Sum([D:農地Info].田面積),'#,##0.00') AS 田面積の合計, Format$(Sum([D:農地Info].畑面積),'#,##0.00') AS 畑面積の合計, Format(Sum([田面積]+[畑面積]),'#,##0.00') AS 計 " & _
                    "FROM [D:農地Info] INNER JOIN [D:個人Info] ON [D:農地Info].借受人ID = [D:個人Info].ID " & _
                    "WHERE ((([自小作別] > 0) = True)) GROUP BY IIf([不在区分]=0,'不在','在村');"
                    SubMakeTable "借受者が不在地主の小作地", sSQL
                Case "160:農家番号": .DBProperty("選挙関連農家番号の印刷") = Not Val(.DBProperty("選挙関連農家番号の印刷"))
                Case "160:自治会", "161:自治会": .DBProperty("選挙申請名簿用") = 0
                Case "160:集落名", "161:集落名": .DBProperty("選挙申請名簿用") = 1
                Case "160:行政区", "161:行政区": .DBProperty("選挙申請名簿用") = 2
                Case "160:公民館", "161:公民館": .DBProperty("選挙申請名簿用") = 3
                Case "160:公民会", "161:公民会": .DBProperty("選挙申請名簿用") = 4
                Case "161:会長名の表示": .DBProperty("申請名簿会長名出力") = Not Val(.DBProperty("申請名簿会長名出力"))
                Case "161:認定面積の表示": .DBProperty("認定面積") = Not Val(.DBProperty("認定面積"))
                Case "161:提出日の表示": .DBProperty("提出日") = Not Val(.DBProperty("提出日"))
                Case "161:提出日の設定": .DBProperty("提出日程") = InputBox("提出日を入力してください" & vbCr & "(入力例)" & vbCr & " H ○○ / ○○ / ○○" & vbCr & " 平成 ○○ 年 ○○ 月 ○○ 日", "選管への提出日", IIf(IsDate(.DBProperty("提出日程")), .DBProperty("提出日程"), "平成" & Format(Now(), " E 年 1 月 31 日")))
                Case "161:裏面": .DBProperty("裏面") = 0
                Case "161:別紙": .DBProperty("裏面") = 1
                Case "161:なし": .DBProperty("裏面") = 2
                Case "161:本人の申請": .DBProperty("本人") = False
                Case "161:世帯の耕作": .DBProperty("本人") = True
                Case "161:生年月日の表示": .DBProperty("生年月日の表示") = Not Val(.DBProperty("生年月日の表示"))
                Case "161:性別の表示": .DBProperty("男女の表示") = Not Val(.DBProperty("男女の表示"))
                Case "161:世帯員の表示": .DBProperty("世帯員表示") = Not Val(.DBProperty("世帯員表示"))
                Case "161:前年有権者のみ表示": .DBProperty("前年有権者のみ表示") = Not Val(.DBProperty("前年有権者のみ表示"))
                Case "161:白抜き印刷": mvarPDW.PrintGo ADApp.ObjectMan.GetObject("選挙申請書"), -1
                Case "162:確定者リスト":
                    mvarPDW.WaitMessage = "面積クリア中"
                        SystemDB.ExecuteSQL "UPDATE [D:世帯Info] SET [D:世帯Info].総経営地 = 0" '面積クリア
                    mvarPDW.WaitMessage = "面積当込み中"
                        SystemDB.CreateView "VV_経営面積", "SELECT V_農地.耕作世帯ID AS ID, Sum(IIf(IsNull([V_農地].[田面積]),0,[V_農地].[田面積])+IIf(IsNull([V_農地].[畑面積]),0,[V_農地].[畑面積])+IIf(IsNull([V_農地].[樹園地]),0,[V_農地].[樹園地])) AS 耕作面積 FROM V_農地 WHERE (((V_農地.農地状況) < 20 Or (V_農地.農地状況) Is Null)) GROUP BY V_農地.耕作世帯ID;"
                    sSQL = "SELECT '世帯員.' & [D:個人Info].ID AS [KEY], Right('0000000000' & [D:個人Info].ID,10) AS 個人番号, Right('000000' & [D:世帯Info].農家番号,6) AS 農家番号, M_BASICALL.名称 AS 行政区, [D:個人Info].氏名, IIf([性別]=0,'男','女') AS 性, V_続柄.続柄 AS 続柄1, V_続柄_1.続柄 AS 続柄2, V_続柄_2.続柄 AS 続柄3, [D:個人Info].生年月日, IIf([生年月日]>0,IIf(DateAdd('yyyy',DateDiff('yyyy',[生年月日],Now()),[生年月日])>Now(),DateDiff('yyyy',[生年月日],Now())-1,DateDiff('yyyy',[生年月日],Now())),'-') AS 年齢, [D:個人Info].住所, [D:個人Info].投票区, [M:投票区].選挙区, VV_経営面積.耕作面積 AS 総経営地, 'Farmer' AS ICON " & _
                    "FROM VV_経営面積 INNER JOIN ((([D:世帯Info] INNER JOIN ((([D:個人Info] LEFT JOIN V_続柄 ON [D:個人Info].続柄1 = V_続柄.ID) LEFT JOIN V_続柄 AS V_続柄_1 ON [D:個人Info].続柄2 = V_続柄_1.ID) LEFT JOIN V_続柄 AS V_続柄_2 ON [D:個人Info].続柄3 = V_続柄_2.ID) ON [D:世帯Info].ID = [D:個人Info].世帯ID) LEFT JOIN [M:投票区] ON [D:個人Info].投票区 = [M:投票区].ID) LEFT JOIN M_BASICALL ON [D:個人Info].行政区ID = M_BASICALL.ID) ON VV_経営面積.ID = [D:世帯Info].ID " & _
                    "WHERE ((([D:個人Info].住民区分)=0) AND ((M_BASICALL.Class)='行政区')) GROUP BY M_BASICALL.名称, [D:個人Info].氏名, IIf([性別]=0,'男','女'), V_続柄.続柄, V_続柄_1.続柄, V_続柄_2.続柄, [D:個人Info].生年月日, [D:個人Info].住所, [D:個人Info].投票区, [M:投票区].選挙区, VV_経営面積.耕作面積, [D:個人Info].行政区ID, [D:個人Info].行政区ID, [D:世帯Info].農家番号, [D:個人Info].年齢, [D:個人Info].選挙権の有無, [D:世帯Info].ID, [D:個人Info].ID, V_続柄.ID HAVING ((([D:個人Info].行政区ID)>0) AND (([D:個人Info].選挙権の有無)=True) AND (([D:世帯Info].ID)>0)) ORDER BY [D:個人Info].投票区, [D:個人Info].行政区ID, [D:世帯Info].ID, [D:世帯Info].ID, V_続柄.ID, [D:個人Info].生年月日;"
                    mvarPDW.SQLListview.SQLListviewCHead sSQL, "個人番号;個人番号;農家番号;農家番号;投票区;選挙区;行政区;行政区;氏名;氏名;性別;続柄1;続柄1;続柄2;続柄2;続柄3;続柄3;性;生年月日;生年月日;年齢;年齢;住所;住所;@総経営地;総経営地", "選挙権確定者リスト"
                Case "162:確定者住民番号＋面積"
                    mvarPDW.WaitMessage = "面積クリア中"
                        SystemDB.ExecuteSQL "UPDATE [D:世帯Info] SET [D:世帯Info].総経営地 = 0" '面積クリア
                    mvarPDW.WaitMessage = "面積当込み中"
                        SystemDB.CreateView "VV_経営面積", "SELECT V_農地.耕作世帯ID AS ID, Sum(IIf(IsNull([V_農地].[田面積]),0,[V_農地].[田面積])+IIf(IsNull([V_農地].[畑面積]),0,[V_農地].[畑面積])+IIf(IsNull([V_農地].[樹園地]),0,[V_農地].[樹園地])) AS 耕作面積 FROM V_農地 WHERE (((V_農地.農地状況) < 20 Or (V_農地.農地状況) Is Null)) GROUP BY V_農地.耕作世帯ID;"
                    sSQL = "SELECT '世帯員.' & [D:個人Info].ID AS [KEY], Right('0000000000' & [D:個人Info].ID,10) AS 個人番号, Right('000000' & [D:世帯Info].農家番号,6) AS 農家番号, M_BASICALL.名称 AS 行政区, [D:個人Info].氏名, IIf([性別]=0,'男','女') AS 性, V_続柄.続柄 AS 続柄1, V_続柄_1.続柄 AS 続柄2, V_続柄_2.続柄 AS 続柄3, [D:個人Info].生年月日, IIf([生年月日]>0,IIf(DateAdd('yyyy',DateDiff('yyyy',[生年月日],Now()),[生年月日])>Now(),DateDiff('yyyy',[生年月日],Now())-1,DateDiff('yyyy',[生年月日],Now())),'-') AS 年齢, [D:個人Info].住所, [D:個人Info].投票区, [M:投票区].選挙区, VV_経営面積.耕作面積 AS 総経営地, 'Farmer' AS ICON " & _
                    "FROM VV_経営面積 INNER JOIN ((([D:世帯Info] INNER JOIN ((([D:個人Info] LEFT JOIN V_続柄 ON [D:個人Info].続柄1 = V_続柄.ID) LEFT JOIN V_続柄 AS V_続柄_1 ON [D:個人Info].続柄2 = V_続柄_1.ID) LEFT JOIN V_続柄 AS V_続柄_2 ON [D:個人Info].続柄3 = V_続柄_2.ID) ON [D:世帯Info].ID = [D:個人Info].世帯ID) LEFT JOIN [M:投票区] ON [D:個人Info].投票区 = [M:投票区].ID) LEFT JOIN M_BASICALL ON [D:個人Info].行政区ID = M_BASICALL.ID) ON VV_経営面積.ID = [D:世帯Info].ID " & _
                    "WHERE ((([D:個人Info].住民区分)=0) AND ((M_BASICALL.Class)='行政区')) GROUP BY M_BASICALL.名称, [D:個人Info].氏名, IIf([性別]=0,'男','女'), V_続柄.続柄, V_続柄_1.続柄, V_続柄_2.続柄, [D:個人Info].生年月日, [D:個人Info].住所, [D:個人Info].投票区, [M:投票区].選挙区, VV_経営面積.耕作面積, [D:個人Info].行政区ID, [D:個人Info].行政区ID, [D:世帯Info].農家番号, [D:個人Info].年齢, [D:個人Info].選挙権の有無, [D:世帯Info].ID, [D:個人Info].ID, V_続柄.ID HAVING ((([D:個人Info].行政区ID)>0) AND (([D:個人Info].選挙権の有無)=True) AND (([D:世帯Info].ID)>0)) ORDER BY [D:個人Info].ID;"
                    mvarPDW.SQLListview.SQLListviewCHead sSQL, "個人番号;個人番号;@総経営地;総経営地", "住民番号＋面積"
                Case Else
                    Debug.Assert CaseAssertPrint(CStr(DVProperty.ID) & ":" & sCmd, "CFol印刷管理_DoCommannd")
            End Select
        End With
    End Function

    Private Sub CDataviewSK_DropDown(sSourceList As String, Optional sOption As String = ""): End Sub

    Private Property Set CDataviewSK_DVProperty(ByVal RHS As ADBasicLIB2.CDataviewProperty): Set DVProperty = RHS: End Property
    Private Property Get CDataviewSK_DVProperty() As ADBasicLIB2.CDataviewProperty: Set CDataviewSK_DVProperty = DVProperty: End Property

    Private Function CDataviewSK_GetProperty2(sPropName As String, Optional sParam As String = "") As Variant: End Function
    Private Property Get CDataviewSK_IconName() As String: End Property
    Private Property Get CDataviewSK_Key() As String: End Property
    Private Property Let CDataviewSK_Key(ByVal RHS As String): End Property
    Private Property Get CDataviewSK_ParentKey() As String: End Property

    Private Function CDataviewSK_PopupMenu(Optional ByVal sParam As String = "", Optional vParam As Variant) As String
        Dim sMenu As String
        
        With SystemDB
            Select Case DVProperty.ID
                Case 81: sMenu = "所有者が不在地主の小作地;借受者が不在地主の小作地;-;不在地主の区分設定"
                Case 160: sMenu = ">名称変更;" & Choose(Val(.DBProperty("選挙申請名簿用")) + 1, "@自治会;集落名;行政区;公民館;公民会", "自治会;@集落名;行政区;公民館;公民会", "自治会;集落名;@行政区;公民館;公民会", "自治会;集落名;行政区;@公民館;公民会", "自治会;集落名;行政区;公民館;@公民会") & ";<;-;農家番号;"
                Case 161:
                    sMenu = ">注意事項の参照先;" & Choose(Val(.DBProperty("裏面")) + 1, "@裏面;別紙;なし", "裏面;@別紙;なし", "裏面;別紙;@なし") & ";<;" & _
                            ">申請面積の表記;" & IIf(Val(.DBProperty("本人")), "本人の申請;@世帯の耕作", "@本人の申請;世帯の耕作") & ";<;" & _
                            ">名称変更;" & Choose(Val(.DBProperty("選挙申請名簿用")) + 1, "@自治会;集落名;行政区;公民館;公民会", "自治会;@集落名;行政区;公民館;公民会", "自治会;集落名;@行政区;公民館;公民会", "自治会;集落名;行政区;@公民館;公民会", "自治会;集落名;行政区;公民館;@公民会") & ";<;" & _
                            ">選管への提出日;" & IIf(Val(.DBProperty("提出日")), "^", "") & "提出日の表示;" & "提出日の設定" & ";<;-;" & _
                            IIf(Val(.DBProperty("申請名簿会長名出力")), "^", "") & "会長名の表示" & ";" & _
                            IIf(Val(.DBProperty("認定面積")), "^", "") & "認定面積の表示;" & _
                            ">プライバシーの保護;" & _
                            IIf(Val(.DBProperty("生年月日の表示")), "^", "") & "生年月日の表示;" & _
                            IIf(Val(.DBProperty("男女の表示")), "^", "") & "性別の表示;<;-;" & _
                            IIf(Val(.DBProperty("世帯員表示")), "^", "") & "世帯員の表示;" & _
                            IIf(Val(.DBProperty("前年有権者のみ表示")), "^", "") & "前年有権者のみ表示;-;白抜き印刷"
                Case 162: sMenu = "確定者リスト;確定者住民番号＋面積"
            End Select
        End With
        If Len(sMenu) Then
            CDataviewSK_DoCommand2 SysAD.PopupMenu(sMenu)
        End If
    End Function

    Private Sub CDataviewSK_Refresh(Optional bReLoad As Boolean = False): End Sub


End Class










Class CFol各種管理
    Option Explicit
    Implements ADBasicLIB2.CDataviewSK
    
    Private DVProperty As CDataviewProperty
    Private Sub Class_Initialize(): Set DVProperty = mvarPDW.DataviewCol.GetNewDVP: End Sub
    
    Private Sub CDataviewSK_CloseRecordset(): End Sub
    
    Private Property Set CDataviewSK_Container(ByVal RHS As ADBasicLIB2.CPDW): End Property

    Private Sub CDataviewSK_DblClick()
        Dim St As String
        Dim sSQL As String
        
        With mvarPDW.SQLListview
            If Fnc.GetKeyHead(DVProperty.Key) Like "*審査中" And Fnc.GetKeyHead(DVProperty.Key) <> "審査中" Then
                Select Case Fnc.GetKeyHead(DVProperty.Key)
                    Case "３条審査中": St = "(" & state3条所有権 & "," & state3条賃借権 & ")"
                    Case "県３条審査中": St = "(" & state県3条所有権 & "," & state県3条賃借権 & ")"
                    Case "４条審査中": St = "(" & state4条転用 & ")"
                    Case "５条審査中": St = "(" & state5条所有権 & "," & state5条賃借権 & ")"
                    Case "利用権移転審査中": St = "(" & state基盤利用権移転 & ")"
                    Case "利用権設定審査中": St = "(" & state基盤利用権設定 & ")"
                    Case "所有権移転審査中": St = "(" & state基盤所有権設定 & ")"
                    Case "農地利用変更審査中": St = "(" & state農地利用変更 & ")"
                    Case "事業計画変更審査中": St = "(" & state事業計画変更 & ")"
                    Case "農用地計画変更審査中": St = "(" & state農用地計画変更 & ")"
                    Case "あっせん申出審査中": St = "(" & stateあっせん出手 & "," & stateあっせん受手 & ")"
                    Case "農地利用変更審査中": St = "(" & state農地利用変更 & ")"
         
                    Case Else
                        Debug.Assert CaseAssertPrint(Fnc.GetKeyHead(DVProperty.Key))
                End Select
                If Len(St) Then .SQLListviewCHead "SELECT '申請.' & [D_申請].[ID] AS [KEY], [名称],'Apply' AS [Icon],総会番号,IIf(IsNull([受付補助記号]),[受付番号],[受付補助記号] & '-' & [受付番号]) AS [受付],[通年受付番号],[受付年月日],[許可番号],[許可年月日],[D_申請].[小作料] & [小作料単位] AS [小作料],IIF(IsNull([AutoID]),'−','○') AS [土地管理情報の有無] FROM [D_申請] LEFT JOIN [D_土地管理] ON [D_申請].[ID] = [D_土地管理].[ID] WHERE ([法令] IN " & St & ") AND [状態]=1", Replace(SysAD.GetSettingData("農地基本台帳", "申請審査中リスト表示", ADApp.Common.AppData("申請審査中リスト表示")), ",", ";"), Fnc.GetKeyHead(DVProperty.Key) & "一覧"
            Else
                Select Case Fnc.GetKeyHead(DVProperty.Key)
                    Case "認定農業者管理": mvarPDW.SQLListview.SQLListviewCHead ADApp.Common.AppData("認定農業者管理_DblClick"), ADApp.Common.AppData("認定農業者管理_DblClickHead"), "認定農業者"
                    Case "担い手農家管理": mvarPDW.SQLListview.SQLListviewCHead ADApp.Common.AppData("担い手農家管理_DblClick"), "名称;名称;フリガナ;フリガナ;認定番号;認定番号;集落;集落;=認定日;認定日;@自作田;自作田;@自作畑;自作畑;@自作樹;自作樹;@自作計;自作計;@小作田;小作田;@小作畑;小作畑;@小作樹;小作樹;@小作計;小作計;@経営地計;経営地計", "担い手農家"
                    Case "合併世帯管理": view世帯List "WHERE [D:世帯Info].[合併異動]=TRUE", "合併世帯一覧" '/** 農地0001-0001-0001
                    Case "利用権終期":  view農地List "WHERE (([D:農地Info].小作地適用法=2) AND (([D:農地info].自小作別) > 0) And Year([小作終了年月日]) = " & Fnc.GetKeyCode(DVProperty.Key) & ")", "利用権終期一覧：" & Format$(DateSerial(Fnc.GetKeyCode(Key), 7, 1), "GGGEE") '/** 農地0001-0001-0002
                    Case "農地法終期": ADApp.DoCommand "農地一覧", "WHERE (([D:農地Info].小作地適用法=1) AND (([D:農地info].自小作別) > 0) And Year([小作終了年月日]) = " & Fnc.GetKeyCode(DVProperty.Key) & ")"
                    Case "地方管理": .SQLListviewCHead "SELECT [KEY],[名称],[Icon],[SelectIcon] FROM [S_Folder] WHERE [ParentKey]='" & DVProperty.Key & "' AND [Key]<>'都道府県." & SystemDB.GetDirectData("S_システムデータ", "DATA", , "都道府県ID") & "'", "名称;名称", DVProperty.Name
                    Case "市町村内その他": SQLList世帯員 "[世帯ID]=0 AND [D:個人Info].[市町村ID]=" & SystemDB.GetDirectData("S_システムデータ", "Data", , "市町村ID") & " ", "市町村内その他", False
                    Case "その他管理": .SQLListviewCHead "SELECT '世帯員.' & [ID] AS [Key], [D:個人Info].氏名 AS 名称, 'Farmer' AS Icon, 'Farmer' AS SelectICon, [D:個人Info].住所 FROM [D:個人Info] WHERE ((([D:個人Info].市町村ID) Is Null Or ([D:個人Info].市町村ID)=0));", "氏名;名称;住所;住所", "その他"
                    Case "年金被保険者"
                        St = "SELECT '世帯員.' & [D:個人Info].[ID] AS [Key], [D:個人Info].氏名,[生年月日], [D:個人Info].フリガナ, [D:個人Info].住所, M_BASICALL.名称 AS 加入区分 FROM [D:個人Info] LEFT JOIN M_BASICALL ON [D:個人Info].農年加入種別 = M_BASICALL.ID WHERE ((([D:個人Info].農年加入種別)>0) AND ((M_BASICALL.Class)='新農業者年金加入区分'));"
                        .SQLListviewCHead St, "氏名;氏名;フリガナ;フリガナ;住所;住所;加入区分;加入区分;生年月日;生年月日", "農業者年金被保険者"
                    Case "経営移譲年金受給者地区":
                        .SQLListviewCHead "SELECT '年金受給個人.' & [D:個人Info].[ID] AS [Key], [D:個人Info].氏名, [D:個人Info].生年月日, [D:個人Info].住所, D_年金受給者.被保険者記号番号, D_年金受給者.資格取得年月日 " & _
                        "FROM [D:個人Info] INNER JOIN D_年金受給者 ON [D:個人Info].ID = D_年金受給者.ID " & _
                        "WHERE [受給地区]=" & DVProperty.ID, "氏名;氏名;生年月日;生年月日", "移譲年金受給者地区"
                    Case "３条許可済", "県３条許可済", "４条許可済", "５条許可済", "利用権移転承認済", "利用権設定承認済", "所有権移転承認済", "奨励金許可済", "農地利用変更許可済", "事業計画変更許可済", "農用地計画変更許可済", "解約許可済", "解約適用済", "農地利用変更承認済", "非農地承認済"
                        Select Case Fnc.GetKeyHead(DVProperty.Key)
                            Case "３条許可済": St = "(" & state3条所有権 & "," & state3条賃借権 & ")"
                            Case "県３条許可済": St = "(" & state県3条所有権 & "," & state県3条賃借権 & ")"
                            Case "４条許可済": St = "(" & state4条転用 & ")"
                            Case "５条許可済": St = "(" & state5条所有権 & "," & state5条賃借権 & ")"
                            Case "利用権移転承認済": St = "(" & state基盤利用権移転 & ")"
                            Case "利用権設定承認済": St = "(" & state基盤利用権設定 & ")"
                            Case "所有権移転承認済": St = "(" & state基盤所有権設定 & ")"
                            Case "農地利用変更許可済": St = "(" & state農地利用変更 & ")"
                            Case "奨励金許可済": St = "(" & state奨励金交付A & "," & state奨励金交付B & ")"
                            Case "事業計画変更許可済": St = "(" & state事業計画変更 & ")"
                            Case "農用地計画変更許可済": St = "(" & state農用地計画変更 & ")"
                            Case "解約許可済", "解約適用済": St = "(" & state20条解約 & "," & state合意解約 & "," & state満期解約 & ")"
                            Case "農地利用変更承認済": St = "(" & state農地利用変更 & ")"
                          
                            Case Else
                                Debug.Assert CaseAssertPrint(Fnc.GetKeyHead(DVProperty.Key))
                        End Select
                        .SQLListviewCHead "SELECT '申請.' & [D_申請].[ID] AS [KEY], [名称],'Apply' AS [Icon],総会番号,IIf(IsNull([受付補助記号]),[受付番号],[受付補助記号] & '-' & [受付番号]) AS [受付],[通年受付番号],[受付年月日],[許可番号],[許可年月日],[D_申請].[小作料] & [小作料単位] AS [小作料],IIF(IsNull([AutoID]),'−','○') AS [土地管理情報の有無] FROM [D_申請] LEFT JOIN [D_土地管理] ON [D_申請].[ID] = [D_土地管理].[ID] WHERE ([法令] IN " & St & ") AND [状態]=2", Replace(SysAD.GetSettingData("農地基本台帳", "申請許可済リスト表示", ADApp.Common.AppData("申請許可済リスト表示")), ",", ";"), Fnc.GetKeyHead(DVProperty.Key) & "一覧"
                    Case "パソコン研修管理": mvarPDW.SQLListview.SQLListviewCHead "SELECT '農家.' & [D:世帯Info].[ID] AS [KEY], [D:個人Info].フリガナ, [D:個人Info].氏名, [V_行政区].行政区, [D:個人Info].住所, [D:個人Info].生年月日, 'House' AS Icon FROM ([D:個人Info] INNER JOIN [D:世帯Info] ON [D:個人Info].ID = [D:世帯Info].世帯主ID) INNER JOIN [V_行政区] ON [D:個人Info].行政区ID = [V_行政区].ID WHERE ((([D:世帯Info].パソコン研修)>0));", "氏名;氏名;フリガナ;フリガナ;行政区;行政区;住所;住所;=生年月日;生年月日", "パソコン研修"
                    
                    Case "貸付希望者リスト": view農地List "[貸付希望]=TRUE", "貸付希望"
                    Case "売渡希望者リスト": view農地List "[売渡希望]=TRUE", "売渡希望"
                    
                    Case "農振農用地内一覧":
                        'ﾌｧｲﾙ名を指定してCSVﾌｧｲﾙに出力する
                        Dim RsN As ADBasicLIB2.RecordsetEx
                        Dim Ts As CTextStream
                        Dim sFile As String
                        
                        sFile = Fnc.OpenFileDlg("農地一覧ファイル名", "*.csv", "C:\")
                        
                        If Len(sFile) Then
                            sSQL = "SELECT V_農地.土地所在, V_農地.登記簿面積, V_農地.実面積, V_地目.名称, V_地目_1.名称, IIf([農業振興地域]=0,'農用地外',IIf([農業振興地域]=1,'農用地内',IIf([農業振興地域]=2,'振興地域外','その他'))) AS 農業振興地域区分, V_農地.所有世帯ID, V_農地.所有者ID, [D:個人Info].氏名, [D:個人Info].フリガナ, [D:個人Info].住所, IIf([自小作別]<>0,[V_農地].[借受世帯ID],'-') AS 借受世帯IDS, IIf([自小作別]<>0,[借受人ID],'-') AS 借受人IDS, IIf([自小作別]<>0,[D:個人Info_1].[氏名],'-') AS 借受者氏名S, IIf([自小作別]<>0,[D:個人Info_1].[フリガナ],'-') AS 借受者フリガナS, IIf([自小作別]<>0,[D:個人Info_1].[住所],'-') AS 借受者住所S, IIf([自小作別]<>0,[V_小作形態].[名称],'-') AS 小作形態S, IIf([自小作別]<>0,[小作開始年月日],'-') AS 小作開始年月日S, IIf([自小作別]<>0,[小作終了年月日],'-') AS 小作終了年月日S " & _
                                   "FROM ((((V_農地 LEFT JOIN [D:個人Info] AS [D:個人Info_1] ON V_農地.借受人ID = [D:個人Info_1].ID) LEFT JOIN [D:個人Info] ON V_農地.所有者ID = [D:個人Info].ID) LEFT JOIN V_小作形態 ON V_農地.小作形態 = V_小作形態.ID) LEFT JOIN V_地目 ON V_農地.登記簿地目 = V_地目.ID) LEFT JOIN V_地目 AS V_地目_1 ON V_農地.現況地目 = V_地目_1.ID " & _
                                   "WHERE (((V_農地.農業振興地域)=0 Or (V_農地.農業振興地域)=1));"
                            
                            mvarPDW.WaitMessage = "出力中"
                            Set RsN = SystemDB.GetRecordsetEx(sSQL, 0, , Me)
                            
                            St = "土地所在,登記面積,現況面積,登記地目,現況地目,区分,所有者農家番号,所有者個人番号,所有者氏名,所有者カナ,所有者住所,借受者農家番号,借受者個人番号,借受者氏名,借受者カナ,借受者住所,利用権設定,利用権設定開始日,利用権設定終了日" & vbCrLf & RsN.GetString(",", vbCrLf)
                            
                            Set Ts = Fnc.Fs.OpenTextFile(sFile, ForWriting, True)
                            Ts.WriteS St
                            Ts.CloseFile
                            RsN.CloseRs
                            mvarPDW.WaitMessage = ""
                            MsgBox ("ＣＳＶ出力しました。")
                        End If


                    Case "家族経営協定管理": mvarPDW.SQLListview.SQLListviewCHead "SELECT '農家.' & [D:世帯Info].[ID] AS [KEY], [D:個人Info].フリガナ, [D:個人Info].氏名, [V_行政区].行政区, [D:個人Info].住所, [D:個人Info].生年月日, 'House' AS Icon FROM ([D:個人Info] INNER JOIN [D:世帯Info] ON [D:個人Info].ID = [D:世帯Info].世帯主ID) INNER JOIN [V_行政区] ON [D:個人Info].行政区ID = [V_行政区].ID WHERE ((([D:世帯Info].家族経営協定)>0));", "氏名;氏名;フリガナ;フリガナ;行政区;行政区;住所;住所;=生年月日;生年月日", "家族経営協定"
                    Case "農業法人研修希望": mvarPDW.SQLListview.SQLListviewCHead "SELECT '農家.' & [D:世帯Info].[ID] AS [KEY], [D:個人Info].フリガナ, [D:個人Info].氏名, [V_行政区].行政区, [D:個人Info].住所, [D:個人Info].生年月日, 'House' AS Icon FROM ([D:個人Info] INNER JOIN [D:世帯Info] ON [D:個人Info].ID = [D:世帯Info].世帯主ID) INNER JOIN [V_行政区] ON [D:個人Info].行政区ID = [V_行政区].ID WHERE ((([D:世帯Info].農業法人研修希望)=True));", "氏名;氏名;フリガナ;フリガナ;行政区;行政区;住所;住所;=生年月日;生年月日", "農業法人研修希望"
                    Case "受付中", "審査中", "許可済": .SQLListviewCHead "SELECT [KEY],[名称],[Icon],[SelectIcon] FROM [S_Folder] WHERE [ParentKey]='" & DVProperty.Key & "'", "名称;名称", ""
                    Case "総会資料":
                        Dim pFrm As New frm総会選択
                        pFrm.b新規 = False
                        pFrm.Show vbModal
                    Case "３条許可済月別", "３条許可済年別", "県３条許可済月別", "県３条許可済年別", "４条許可済月別", "４条許可済年別", "５条許可済年別", "５条許可済月別" _
                    , "所有権移転承認済月別", "所有権移転承認済年別", "利用権設定承認済年別", "利用権設定承認済月別", "解約適用済年別", "解約適用済月別", "農地利用変更承認済月別", "農地利用変更承認済年別", "非農地承認済月別", "非農地承認済年別", "農用地計画変更許可済月別"
                        Select Case Replace(Replace(Fnc.GetKeyHead(DVProperty.Key), "年別", ""), "月別", "")
                            Case "３条許可済", "３条許可済": St = "(" & state3条所有権 & "," & state3条賃借権 & ")"
                            Case "県３条許可済": St = "(" & state県3条所有権 & "," & state県3条賃借権 & ")"
                            Case "４条許可済": St = "(" & state4条転用 & ")"
                            Case "５条許可済": St = "(" & state5条所有権 & "," & state5条賃借権 & ")"
                            Case "利用権移転承認済": St = "(" & state基盤利用権移転 & ")"
                            Case "利用権設定承認済": St = "(" & state基盤利用権設定 & ")"
                            Case "所有権移転承認済": St = "(" & state基盤所有権設定 & ")"
                            Case "農地利用変更許可済": St = "(" & state農地利用変更 & ")"
                            Case "奨励金許可済": St = "(" & state奨励金交付A & "," & state奨励金交付B & ")"
                            Case "事業計画変更許可済": St = "(" & state事業計画変更 & ")"
                            Case "農用地計画変更許可済": St = "(" & state農用地計画変更 & ")"
                            Case "解約許可済", "解約適用済": St = "(" & state20条解約 & "," & state合意解約 & "," & state満期解約 & ")"
                            Case "農地利用変更承認済": St = "(" & state農地利用変更 & ")"
            
                            Case "農用地計画変更許可済": St = "(" & state農用地計画変更 & ")"
                            Case Else
                                Debug.Assert CaseAssertPrint(Fnc.GetKeyHead(DVProperty.Key))
                        End Select
                        .SQLListviewCHead "SELECT '申請.' & [D_申請].[ID] AS [KEY], [名称],'Apply' AS [Icon],総会番号,IIf(IsNull([受付補助記号]),[受付番号],[受付補助記号] & '-' & [受付番号]) AS [受付],[通年受付番号],[受付年月日],[許可番号],[許可年月日],[D_申請].[小作料] & [小作料単位] AS [小作料],IIF(IsNull([AutoID]),'−','○') AS [土地管理情報の有無] FROM [D_申請] LEFT JOIN [D_土地管理] ON [D_申請].[ID] = [D_土地管理].[ID] WHERE ([法令] IN " & St & ") AND Format$([許可年月日],'yyyy" & IIf((DVProperty.ID Mod 100) > 0, "mm", "00") & "')='" & DVProperty.ID & "' AND [状態]=2", Replace(SysAD.GetSettingData("農地基本台帳", "申請許可済リスト表示", ADApp.Common.AppData("申請許可済リスト表示")), ",", ";"), Fnc.GetKeyHead(DVProperty.Key) & "一覧"
                    Case Else
                        .SQLListviewCHead "SELECT [KEY],[名称],[Icon],[SelectIcon] FROM [S_Folder] WHERE [ParentKey]='" & DVProperty.Key & "'", "名称;名称", ""
                End Select
            End If
        End With
    End Sub
    
    Private Function CDataviewSK_DoCommand2(sCmd As String, Optional sParam As String = "") As Variant
        Dim sSQL As String
        Dim s名称 As String
        Dim ID As Long
        Dim pObj As Object
        Dim St As String
        Dim pFrm As frm総会選択
        Dim Ar As Variant
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim Rx As ADBasicLIB2.RecordsetEx
        Dim n As Long
        Dim pDic As CDataDictionary
        
        Select Case DVProperty.ClassStr & "-" & sCmd
            Case "世帯管理-開く": CDataviewSK_DblClick
            Case "その他管理-住所による分配": SystemDB.ExecuteSQL "UPDATE [D:個人Info] SET [D:個人Info].市町村ID = " & SystemDB.DBProperty("市町村コード") & " WHERE ((([D:個人Info].住所) Like '" & SystemDB.DBProperty("市町村名") & "%'));"
            Case "都道府県-市町村の追加": MasterAdd "市町村", "市町村の追加", "追加する市町村のコードと名称を入力してください", DVProperty.Key, "CloseFolderG", "OpenFolderG", True
            Case "町外管理-市町村追加": MasterAdd "市町村", "市町村の追加", "追加する市町村のコードと名称を入力してください", "町外管理.0", "CloseFolderG", "OpenFolderG", True
            Case "地方管理-都道府県の追加": MasterAdd "都道府県", "都道府県の追加", "追加する都道府県のコードと名称を入力してください", DVProperty.Key, "CloseFolderG", "OpenFolderG", True
            Case "農地管理-大字／地区別遊休地集計"
                sSQL = "SELECT '大字.' & [V_大字].ID AS [KEY],[V_大字].名称, Count([D:農地Info].ID) AS 農地筆数, Sum(IIf([田面積]>0,1,0)) AS 全田筆数, Sum(IIf([畑面積]>0,1,0)) AS 全畑筆数, Sum(Int([田面積]+[畑面積])) AS 全農地面積, Sum(Int([田面積])) AS 田合計, Sum(Int([畑面積])) AS 畑合計, Sum(IIf([遊休化],1,0)) AS 遊休化農地筆数, Sum(IIf([遊休化],-1,0)*([田面積]>0)) AS 遊休化田筆数, Sum(IIf([遊休化],-1,0)*([畑面積]>0)) AS 遊休化畑筆数, Sum(Int([田面積]+[畑面積])*IIf([遊休化],1,0)) AS 遊休化面積合計, Sum(Int([田面積])*IIf([遊休化],1,0)) AS 遊休化田面積合計, Sum(Int([畑面積])*IIf([遊休化],1,0)) AS 遊休化畑面積合計" _
                & " FROM [D:農地Info] INNER JOIN [V_大字] ON [D:農地Info].大字ID = [V_大字].ID" _
                & " WHERE ((([D:農地Info].農委地目ID)=1 Or ([D:農地Info].農委地目ID)=2))" _
                & " GROUP BY [V_大字].ID, [V_大字].名称" _
                & " HAVING ((([V_大字].ID)>0))" _
                & " ORDER BY [V_大字].ID;"
                mvarPDW.SQLListview.SQLListviewCHead sSQL, "名称;名称;@農地筆数;農地筆数;@田筆数;全田筆数;@畑筆数;全畑筆数;@農地面積;全農地面積;@田面積;田合計;@畑面積;畑合計;@遊休地筆数;遊休化農地筆数;@遊休田筆数;遊休化田筆数;@遊休畑筆数;遊休化畑筆数;@遊休地面積合計;遊休化面積合計;@遊休田面積;遊休化田面積合計;@遊休畑面積;遊休化畑面積合計", "大字／地区別遊休地集計"
            Case "利用権終期台帳-期間指定で検索"
                Dim sStartW As String, sStartM As String
                Dim sEndW As String, sEndM As String
                
                With Fnc.InputData("終期台帳", "期間を入力してください", Me, GetArray("検索開始日;日付;%%Now%%", "検索終了日;日付;%%Now%%"))
                    If .IsObtained Then
                        If .IsDate("検索開始日") Then sStartW = "[V_農地].[小作終了年月日]>=" & .Getリテラル日付("検索開始日", True): sStartM = .Getリテラル日付("検索開始日", True)
                        If .IsDate("検索終了日") Then sEndW = "[V_農地].[小作終了年月日]<=" & .Getリテラル日付("検索終了日", True): sEndM = .Getリテラル日付("検索終了日", True)
                            
                        St = "SELECT '農地.' & [V_農地].ID AS [KEY],[V_行政区].行政区 AS 設定者集落, [D:個人Info].住所 AS 設定者住所, [D:個人Info].氏名 AS 設定者, IIf([D:個人INfo].[死亡],'死亡',' ') AS 設定者区分, [V_行政区_1].行政区 AS 被設定者集落, [D:個人Info_1].住所 AS 被設定者住所, [D:個人Info_1].氏名 AS 被設定者,[V_地目].[名称], [V_農地].登記簿面積, V_小作形態.名称 AS 種類, [V_農地].小作料, [V_農地].[小作開始年月日] AS 開始日, [V_農地].[小作終了年月日] AS 終了日,[V_農地].土地所在"
                        St = St & " FROM ((((([V_行政区] RIGHT JOIN (([V_農地] INNER JOIN [D:個人Info] ON [V_農地].管理人ID = [D:個人Info].ID) LEFT JOIN [D:世帯Info] ON [D:個人Info].世帯ID = [D:世帯Info].ID) ON [V_行政区].ID = [D:世帯Info].行政区ID) LEFT JOIN [D:個人Info] AS [D:個人Info_1] ON [V_農地].借受人ID = [D:個人Info_1].ID) LEFT JOIN [D:世帯Info] AS [D:世帯Info_1] ON [D:個人Info_1].世帯ID = [D:世帯Info_1].ID) LEFT JOIN [V_行政区] AS [V_行政区_1] ON [D:世帯Info_1].行政区ID = [V_行政区_1].ID) INNER JOIN V_小作形態 ON [V_農地].小作形態 = V_小作形態.ID) INNER JOIN V_地目 ON [V_農地].現況地目 = V_地目.ID"
                        St = St & " WHERE ([V_農地].自小作別)>0 AND ([V_農地].小作地適用法=2) " & IIf(Len(sStartW), "AND " & sStartW & " ", "") & IIf(Len(sEndW), "AND " & sEndW & " ", "") & "ORDER BY [V_農地].小作終了年月日,[D:個人Info_1].氏名,[D:個人Info].氏名;"
                        mvarPDW.SQLListview.SQLListviewCHead St, "土地所在;土地所在;設定する者;設定者;設定者住所;設定者住所;設定を受ける者;被設定者;被設定者住所;被設定者住所;@面積;登記簿面積;地目;名称;=始期;開始日;=終期;終了日", "利用権終期台帳:" & sStartM & "〜" & sEndM
                    End If
                End With
            Case "申請管理-議案書新規作成"
                Set pFrm = New frm総会選択
                pFrm.b新規 = True
                pFrm.Show vbModal
            Case "申請管理-議案書作成"
                Set pFrm = New frm総会選択
                pFrm.b新規 = False
                pFrm.Show vbModal
            Case "申請管理-利用権表紙印刷": mvarPDW.PrintGo ADApp.ObjectMan.GetObject("利用権表紙")
            Case "受付中-総会資料作成"
                Set pFrm = New frm総会選択
                pFrm.Show vbModal
            Case "年金受給者地区-受給者地区名の変更"
                s名称 = SystemDB.GetDirectData("S_Folder", "名称", , DVProperty.Key)
                s名称 = Fnc.InputText("変更する地区名[" & s名称 & "]⇒", "地区名を入力してください", s名称, , 4)
                SystemDB.ExecuteSQL "UPDATE S_Folder SET S_Folder.名称 = '" & s名称 & "' WHERE (((S_Folder.Key)='" & DVProperty.Key & "'));"
                mvarPDW.Folder.Redraw mvarPDW.Folder.ExpandedList
            Case "老齢年金受給者地区-受給者地区名の削除"
            Case "利用権終期台帳-終期通知発行"
                With Fnc.InputData("終期通知発行", "通知番号、発行年月日、〆日(各月の何日)を入力してください", Me, GetArray("通知番号;数値;" & (Val(SystemDB.DBProperty("終期通知番号")) + 1), "発行年月日;日付;" & Date, "〆日;数値;" & 10, "提出期限;日付;" & 0))
                    If .IsObtained Then
                        If Not .IsDate("発行年月日") Then .Item("発行年月日") = Now()
                        mvarPDW.PrintGo ADApp.ObjectMan.GetObject("利用権終期通知書"), CStr(.Item("発行年月日")) & ";" & Val(.Item("通知番号")) & ";" & CStr(.Item("〆日")) & ";" & CStr(.Item("提出期限"))
                        SystemDB.DBProperty("終期通知番号") = Val(.Item("通知番号"))
                    End If
                End With
            Case "町外管理-町外個人の追加": ADApp.DoCommand "住民の追加", SystemDB.DBProperty("不明住民区分")
            Case "農地管理-大字の追加"
                Ar = Split("大字:SELECT '大字.' & [ID] AS [KEY],[大字] AS [名称] FROM [V_大字]", ";")
                mvarPDW.FindSelectDlg Ar, "", False
            Case "農地管理-遊休農地一覧": view農地List "WHERE [遊休化]=TRUE", "遊休農地一覧" '/** 農地0001-0001-0002
            Case "年金受給者-地区の追加"
                s名称 = Fnc.InputText("追加する地区名", "追加する地区名を入力してください", "", , 4)
                If Len(s名称) Then
                    ID = GetMaxKeyCode("S_Folder", "Key", "Class='年金受給者地区'")
                    SystemDB.ExecuteSQL "INSERT INTO S_Folder([Key],ParentKey,表示順序,名称,Class,Icon,SelectIcon,Visible) VALUES('老齢年金受給者地区." & ID & "','" & DVProperty.Key & "',1000,'" & s名称 & "','老齢年金受給者地区','CloseFolderG','OpenFolderG',True);"
                    SystemDB.ExecuteSQL "INSERT INTO S_Folder([Key],ParentKey,表示順序,名称,Class,Icon,SelectIcon,Visible) VALUES('経営移譲年金受給者地区." & ID & "','" & DVProperty.Key & "',1000,'" & s名称 & "','経営移譲年金受給者地区','CloseFolderG','OpenFolderG',True);"
                    mvarPDW.Folder.Redraw mvarPDW.Folder.ExpandedList
                End If
            Case "農地管理-大字／町名を追加":
                Set Rs = SystemDB.GetRecordsetEx("SELECT V_大字.ID & ':' & V_大字.名称 AS [List] FROM V_大字 LEFT JOIN S_Folder ON V_大字.名称 = S_Folder.名称 WHERE (((S_Folder.Key) Is Null));", , , Me)
                St = Fnc.OptionSelect(Rs.GetString(, ";"), "追加する大字／町名を選択してください")
                If Len(St) Then
                    n = Val(Left$(St, InStr(St, ":") - 1))
                    St = MID$(St, InStr(St, ":") + 1)
                    SystemDB.ExecuteSQL "INSERT INTO S_Folder ([Key], ParentKey, 表示順序, 名称, Class, Icon, SelectIcon, Visible ) VALUES('農地大字." & n & "', '農地管理.0' , 10000 , '" & St & "' , '大字', 'CloseFolderG', 'OpenFolderG', -1);"
                End If
                SystemDB.CloseRs Rs
                mvarPDW.Folder.Redraw mvarPDW.Folder.ExpandedList
            Case "世帯管理-集落別利用権を設定した面積": mvarPDW.SQLListview.SQLListviewCHead "SELECT '行政区.' & [行政区ID] AS [Key], [V_行政区].行政区, Sum(V_農地.田面積) AS 利用権を設定した田, Sum(V_農地.畑面積) AS 利用権を設定した畑 FROM (V_農地 LEFT JOIN [D:個人Info] ON V_農地.管理人ID = [D:個人Info].ID) LEFT JOIN [V_行政区] ON [D:個人Info].行政区ID = [V_行政区].ID WHERE (((V_農地.小作地適用法)=2) AND ((V_農地.自小作別)>0)) GROUP BY '行政区.' & [行政区ID], [V_行政区].行政区;", "行政区;行政区;利用権を設定した田;利用権を設定した田;利用権を設定した畑;利用権を設定した畑", "集落別利用権を設定した面積"
            Case "利用権終期台帳-終期台帳の発行" 'CFol各種管理
                Set pDic = Fnc.InputMulti("終期印刷", "印刷開始・終了年月日を入力してください", "開始日;日付;" & Now & "|終了日;日付;" & Now)
                If Not pDic Is Nothing Then
                    mvarPDW.PrintGo ObjectMan.GetObject("利用権印刷"), pDic.Item("開始日") & ";" & pDic.Item("終了日")
                End If
            Case "世帯管理-集落別耕作農家": mvarPDW.SQLListview.SQLListviewCHead "SELECT '行政区.' & [V_行政区].[ID] AS [Key], [V_行政区].行政区, Count([D:世帯Info].ID) AS IDのカウント FROM [V_行政区] RIGHT JOIN [D:世帯Info] ON [V_行政区].ID = [D:世帯Info].行政区ID WHERE [D:世帯Info].[農地との関連]=TRUE GROUP BY '行政区.' & [V_行政区].[ID], [V_行政区].行政区;", "行政区;行政区;@世帯数;IDのカウント", "集落別耕作農家"
            Case "世帯管理-集落別利用権の設定を受けた面積": mvarPDW.SQLListview.SQLListviewCHead "SELECT '行政区.' & [行政区ID] AS [Key], [V_行政区].行政区, Sum(V_農地.田面積) AS 利用権を受けた田, Sum(V_農地.畑面積) AS 利用権を受けた畑 FROM (V_農地 LEFT JOIN [D:個人Info] ON V_農地.借受人ID = [D:個人Info].ID) LEFT JOIN [V_行政区] ON [D:個人Info].行政区ID = [V_行政区].ID WHERE (((V_農地.小作地適用法) = 2) And ((V_農地.自小作別) > 0)) GROUP BY '行政区.' & [行政区ID], [V_行政区].行政区;", "行政区;行政区;利用権を受けた田;利用権を受けた田;利用権を受けた畑;利用権を受けた畑", "集落別利用権を受けた面積"
            Case "許可済-転用許可済み４条":
                Set Rs = SystemDB.GetRecordsetEx("SELECT D_土地履歴.ID, D_土地履歴.LID, D_土地履歴.申請ID, D_土地履歴.異動事由 FROM D_土地履歴 WHERE (((D_土地履歴.申請ID)=0 Or (D_土地履歴.申請ID) Is Null) AND ((D_土地履歴.異動事由)=10040));", 2, , Me)
                Do Until Rs.EOF
                    Set Rx = SystemDB.GetRecordsetEx("SELECT D_申請.ID, D_申請.農地リスト, D_申請.法令 FROM D_申請 WHERE ((([D_申請].[農地リスト] Like '%." & Rs.V("LID") & ";%') OR [D_申請].[農地リスト] Like '%." & Rs.V("LID") & "' ) AND ((D_申請.法令)=40 Or (D_申請.法令)=41));", 0, , Me)
                    If Rx.IsNoRecord Then
                    Else
                        Rs.Update "申請ID", Rx.ID
                    End If
                    Rs.MoveNext
                Loop
                mvarPDW.SQLListview.SQLListviewCHead "SELECT '転用農地.' & [D_転用農地].[ID] AS [Key], D_転用農地.大字ID, [V_大字].名称 AS 大字, D_転用農地.小字ID, [V_小字].名称 AS [小字], D_転用農地.地番, D_転用農地.登記簿面積 AS 地籍, V_地目.名称 AS 地目, D_申請.許可年月日, D_申請.許可番号, D_申請.許可補助番号, D_申請.申請理由A AS 転用目的,D_申請.申請者A, D_申請.氏名A AS 関係者A,D_申請.申請者B, D_申請.氏名B AS 関係者B ,NULL AS [指令所番号]" & _
                "FROM (([V_大字] RIGHT JOIN ((((D_土地履歴 AS D_土地履歴_1 INNER JOIN D_申請 ON D_土地履歴_1.申請ID = D_申請.ID) INNER JOIN D_転用農地 ON D_土地履歴_1.LID = D_転用農地.ID) LEFT JOIN V_地目 ON D_転用農地.現況地目 = V_地目.ID) LEFT JOIN [V_小字] ON D_転用農地.小字ID = [V_小字].ID) ON [V_大字].ID = D_転用農地.大字ID) LEFT JOIN [D:個人Info] ON D_土地履歴_1.関係者A = [D:個人Info].ID) LEFT JOIN [D:個人Info] AS [D:個人Info_1] ON D_土地履歴_1.関係者B = [D:個人Info_1].ID " & _
                "WHERE (((D_土地履歴_1.異動事由)=10040)) GROUP BY [申請者A],[申請者B],'転用農地.' & [D_転用農地].[ID], D_転用農地.大字ID, [V_大字].名称, D_転用農地.小字ID, [V_小字].名称, D_転用農地.地番, D_転用農地.登記簿面積, V_地目.名称, D_申請.許可年月日, D_申請.許可番号, D_申請.許可補助番号, D_申請.申請理由A, D_申請.氏名A, D_申請.氏名B " & _
                "ORDER BY '転用農地.' & [D_転用農地].[ID], D_申請.許可年月日, D_申請.許可番号, D_申請.許可補助番号;", _
                "大字コード;大字ID;大字;大字;小字コード;小字ID;小字;小字;地番;地番;地籍;地籍;地目;地目;指令所番号;指令所番号;許可年月日;許可年月日;転用目的;転用目的;申請者番号;申請者A;申請人;関係者A", "転用許可済み４条リスト"
            Case "許可済-転用許可済み５条":
                Set Rs = SystemDB.GetRecordsetEx("SELECT D_土地履歴.ID, D_土地履歴.LID, D_土地履歴.申請ID, D_土地履歴.異動事由 FROM D_土地履歴 WHERE (((D_土地履歴.申請ID)=0 Or (D_土地履歴.申請ID) Is Null) AND ((D_土地履歴.異動事由)=10050));", 2, , Me)
                Do Until Rs.EOF
                    Set Rx = SystemDB.GetRecordsetEx("SELECT D_申請.ID, D_申請.農地リスト, D_申請.法令 FROM D_申請 WHERE ((([D_申請].[農地リスト] Like '%." & Rs.V("LID") & ";%') OR [D_申請].[農地リスト] Like '%." & Rs.V("LID") & "' ) AND ((D_申請.法令)=50 Or (D_申請.法令)=51));", 0, , Me)
                    If Rx.IsNoRecord Then
                    Else
                        Rs.Update "申請ID", Rx.ID
                    End If
                    Rs.MoveNext
                Loop
                
                mvarPDW.SQLListview.SQLListviewCHead "SELECT '転用農地.' & [D_転用農地].[ID] AS [Key], D_転用農地.大字ID, [V_大字].名称 AS 大字, D_転用農地.小字ID, [V_小字].名称 AS [小字], D_転用農地.地番, D_転用農地.登記簿面積 AS 地籍, V_地目.名称 AS 地目, D_申請.許可年月日, D_申請.許可番号, D_申請.許可補助番号, D_申請.申請理由A AS 転用目的,D_申請.申請者A,D_申請.氏名A AS 関係者A,D_申請.申請者B, D_申請.氏名B AS 関係者B ,NULL AS [指令所番号]" & _
                "FROM (([V_大字] RIGHT JOIN ((((D_土地履歴 AS D_土地履歴_1 INNER JOIN D_申請 ON D_土地履歴_1.申請ID = D_申請.ID) INNER JOIN D_転用農地 ON D_土地履歴_1.LID = D_転用農地.ID) LEFT JOIN V_地目 ON D_転用農地.現況地目 = V_地目.ID) LEFT JOIN [V_小字] ON D_転用農地.小字ID = [V_小字].ID) ON [V_大字].ID = D_転用農地.大字ID) LEFT JOIN [D:個人Info] ON D_土地履歴_1.関係者A = [D:個人Info].ID) LEFT JOIN [D:個人Info] AS [D:個人Info_1] ON D_土地履歴_1.関係者B = [D:個人Info_1].ID " & _
                "WHERE (((D_土地履歴_1.異動事由)=10050)) GROUP BY [申請者A],[申請者B],'転用農地.' & [D_転用農地].[ID], D_転用農地.大字ID, [V_大字].名称, D_転用農地.小字ID, [V_小字].名称, D_転用農地.地番, D_転用農地.登記簿面積, V_地目.名称, D_申請.許可年月日, D_申請.許可番号, D_申請.許可補助番号, D_申請.申請理由A, D_申請.氏名A, D_申請.氏名B " & _
                "ORDER BY '転用農地.' & [D_転用農地].[ID], D_申請.許可年月日, D_申請.許可番号, D_申請.許可補助番号;", _
                "大字コード;大字ID;大字;大字;小字コード;小字ID;小字;小字;地番;地番;地籍;地籍;地目;地目;指令所番号;指令所番号;許可年月日;許可年月日;転用目的;転用目的;譲受ID;申請者B;譲受人;関係者B;譲渡ID;申請者A;譲渡人;関係者A", "転用許可済み５条リスト"
            Case "許可済-利用権総括表"
                Dim dt開始日 As Date
                Dim dt終了日 As Date
                Dim arHeader As Variant
                Dim sData As Variant
                Dim n面積(3) As Long
                Dim Cm As Variant
                Dim RsS As ADBasicLIB2.RecordsetEx
                Dim RsT As ADBasicLIB2.RecordsetEx

                dt開始日 = Format(IIf(Month(Now()) = 1, Year(Now()) - 1, Year(Now())) & "/" & IIf(Month(Now()) = 1, "12", Month(Now()) - 1) & "/1", "GGGEE/MM/" & SystemDB.DBProperty("利用権継続〆日") + 1)
                dt終了日 = Format(Now(), "GGGEE/MM/" & SystemDB.DBProperty("利用権継続〆日"))
                With SysAD.Func.InputMulti("利用権総括表", "検索期間を入力してください", "検索開始日;日付;" & dt開始日 & "|検索終了日;日付;" & dt終了日, , True)
                    If Not .IsALLEmpty Then
                        sSQL = "SELECT D_申請.受付年月日 FROM D_申請 WHERE (((D_申請.法令) = 60)) GROUP BY D_申請.受付年月日 HAVING (((D_申請.受付年月日) >= " & .Getリテラル日付("検索開始日") & " And (D_申請.受付年月日) <= #" & .Getリテラル日付("検索終了日") & "#)) ORDER BY D_申請.受付年月日;"
                        
                        Set Rs = SystemDB.GetRecordsetEx(sSQL, 1, , "議案書")
                            If Rs.IsNoRecord Then
                                MsgBox "対象となるデータがありません", vbExclamation
                                Exit Function
                            Else
                                Do Until Rs.EOF
                                    Ar = Ar & "," & Rs.V("受付年月日")
                                    Rs.MoveNext
                                Loop
                                Ar = MID(Ar, 2)
                                Ar = Split(Ar, ",")
                                n面積(0) = 0: n面積(1) = 0: n面積(2) = 0
                                For n = 0 To UBound(Ar)
                                    sSQL = "SELECT D_申請.農地リスト FROM D_申請 WHERE (((D_申請.受付年月日) = #" & Ar(0) & "# And ((D_申請.法令) = 60)));"
                                    Set RsS = SystemDB.GetRecordsetEx(sSQL, , , Me)
                                    Do Until RsS.EOF
                                        St = Replace(Replace(RsS.NullCast("農地リスト", ""), "農地.", ""), ";", ",")
                                        sSQL = "SELECT Sum(V_農地.田面積) AS 田面積計, Sum(V_農地.畑面積) AS 畑面積計, Sum(V_農地.樹園地) AS 樹園地計, Sum(V_農地.採草放牧面積) AS 採草放牧計 FROM (((V_農地 LEFT JOIN V_地目 ON V_農地.登記簿地目 = V_地目.ID) LEFT JOIN V_地目 AS 地目2 ON V_農地.現況地目 = 地目2.ID) LEFT JOIN V_農委地目 ON V_農地.農委地目ID = V_農委地目.ID) LEFT JOIN D_部分申請 ON V_農地.ID = D_部分申請.農地ID WHERE (((V_農地.ID) In (" & St & ")));"
                                        Set RsT = SystemDB.GetRecordsetEx(sSQL, 0, , "基盤利用権設定(所有権)")
                                            n面積(0) = n面積(0) + RsT.V("田面積計")
                                            n面積(1) = n面積(1) + RsT.V("畑面積計")
                                            n面積(2) = n面積(2) + RsT.V("樹園地計")
                                            n面積(3) = n面積(3) + RsT.V("採草放牧計")
                                        SystemDB.CloseRs RsT
                                        
                                        RsS.MoveNext
                                    Loop
                                    sSQL = "SELECT Sum(申請人.申請者Aカウント) AS 申請者A合計, Sum(申請人.申請者Bカウント) AS 申請者B合計 FROM (SELECT D_申請.受付年月日, Count(D_申請.申請者A) AS 申請者Aカウント,0 AS 申請者Bカウント FROM D_申請 WHERE ((D_申請.受付年月日) = #" & Ar(n) & "# And ((D_申請.法令) = 60)) GROUP BY D_申請.受付年月日 UNION SELECT D_申請.受付年月日, 0 AS 申請者Aカウント, Count(D_申請.申請者B) AS 申請者Bカウント FROM D_申請 WHERE (((D_申請.受付年月日) = #" & Ar(n) & "#) And ((D_申請.法令) = 60)) GROUP BY D_申請.受付年月日, 0) AS 申請人 WHERE (((申請人.受付年月日)=#" & Ar(n) & "#))"
                                    Set RsT = SystemDB.GetRecordsetEx(sSQL, 0, , "基盤利用権設定(所有権)")
                                        sData = sData & Ar(n) & "," & n面積(0) & "," & n面積(1) & "," & n面積(2) & "," & n面積(3) & "," & n面積(0) + n面積(1) + n面積(2) + n面積(3) & "," & RsT.NullCast("申請者A合計", 0) & "," & RsT.NullCast("申請者B合計", 0) & vbCr
                                    SystemDB.CloseRs RsT
                                Next
                            End If
                        SystemDB.CloseRs Rs
                        sData = Left(sData, Len(sData) - 1)
                        
                        sData = Split(sData, vbCr)
                        arHeader = GetArray("公告年月日", "田", "畑", "樹園地", "その他", "計", "所有権を移転する者の数", "所有権の移転を受ける者の数")
    
                        With mvarPDW.Gridview
                            .ClearAll
                            .Cols = 9
                            .Rows = UBound(sData) + 2
                            
                            For n = 0 To 7: .TextMatrix(0, n) = arHeader(n): Next
                            For n = 0 To UBound(Ar)
                                Cm = Split(sData(n), ",")
                                .TextMatrix(n + 1, 0) = Format(Cm(0), "EE.MM.DD")
                                .TextMatrix(n + 1, 1) = Format(Cm(1), "#,##0")
                                .TextMatrix(n + 1, 2) = Format(Cm(2), "#,##0")
                                .TextMatrix(n + 1, 3) = Format(Cm(3), "#,##0")
                                .TextMatrix(n + 1, 4) = Format(Cm(4), "#,##0")
                                .TextMatrix(n + 1, 5) = Format(Cm(5), "#,##0")
                                .TextMatrix(n + 1, 6) = Format(Cm(6), "#,##0")
                                .TextMatrix(n + 1, 7) = Format(Cm(7), "#,##0")
                            Next
                            .FitWidth
                        End With
                        
                        Set mvarPDW.TabPages.SelectedItem = mvarPDW.Gridview
                        mvarPDW.TabPages.SelectedItem.Title = "基盤利用権設定(所有権)"
                    Else
                        Exit Function
                    End If
                End With
            Case "許可済-３条所有権許可一覧"
                SystemDB.Execute "UPDATE D_申請 INNER JOIN D_土地履歴 ON (D_申請.申請者B = D_土地履歴.関係者B) AND (D_申請.申請者A = D_土地履歴.関係者A) SET D_土地履歴.申請ID = [D_申請].[ID] WHERE D_申請.法令 IN (30,32) AND (((D_申請.状態)=2) AND ((D_土地履歴.申請ID) Is Null Or (D_土地履歴.申請ID)=0) AND ((D_申請.許可年月日)=[異動日]));"
                
                With Fnc.InputData("３条所有権許可一覧", "検索する許可日の期間を入力してください", Me, GetArray("期間開始日;日付;" & Now(), "期間終了日;日付;" & Now()))
                    If Not .IsObtained Then Exit Function
                    If Not .IsDate("期間開始日") Or Not .IsDate("期間終了日") Then Exit Function
                    mvarPDW.SQLListview.SQLListviewCHead .StrReplace("SELECT '農地.' & [V_農地].ID,D_申請.名称,申請者A AS 番号A,申請者B AS 番号B, D_申請.氏名A, D_申請.住所A, D_申請.申請理由A, D_申請.氏名B, D_申請.住所B, D_申請.申請理由B,IIF(Len(D_申請.小作料)>0, D_申請.小作料,'') & IIF(Len(D_申請.小作料単位)>0, D_申請.小作料単位,'') AS 対価 ,D_申請.許可年月日, V_農地.土地所在, V_農地.地目名, V_農地.実面積 FROM V_農地 INNER JOIN (D_土地履歴 INNER JOIN D_申請 ON D_土地履歴.申請ID = D_申請.ID) ON V_農地.ID = D_土地履歴.LID WHERE ([D_申請].[許可年月日]>=CDate('%DD.期間開始日%')) AND ([D_申請].[許可年月日]<=CDate('%DD.期間終了日%')) AND " & _
                    "((D_申請.状態)=2) AND ((D_申請.法令) IN (30,32)) ORDER BY [D_申請].[許可年月日];"), "名称;名称;番号A;番号A;氏名A;氏名A;住所A;住所A;申請理由A;申請理由A;番号B;番号B;氏名B;氏名B;住所B;住所B;申請理由B;申請理由B;許可年月日;許可年月日;土地所在;土地所在;地目名;地目名;実面積;実面積;対価;対価", "３条所有権許可一覧"
                End With
            Case "許可済-３条貸借許可一覧"
                SystemDB.Execute "UPDATE D_申請 INNER JOIN D_土地履歴 ON (D_申請.申請者B = D_土地履歴.関係者B) AND (D_申請.申請者A = D_土地履歴.関係者A) SET D_土地履歴.申請ID = [D_申請].[ID] WHERE D_申請.法令 IN (31,33) AND (((D_申請.状態)=2) AND ((D_土地履歴.申請ID) Is Null Or (D_土地履歴.申請ID)=0) AND ((D_申請.許可年月日)=[異動日]));"
                
                With Fnc.InputData("３条貸借許可一覧", "検索する許可日の期間を入力してください", Me, GetArray("期間開始日;日付;" & Now(), "期間終了日;日付;" & Now()))
                    If Not .IsObtained Then Exit Function
                    If Not .IsDate("期間開始日") Or Not .IsDate("期間終了日") Then Exit Function
                    mvarPDW.SQLListview.SQLListviewCHead .StrReplace("SELECT '農地.' & [V_農地].ID,D_申請.名称,申請者A AS 番号A,申請者B AS 番号B, D_申請.氏名A, D_申請.住所A, D_申請.申請理由A, D_申請.氏名B, D_申請.住所B, D_申請.申請理由B, D_申請.許可年月日, V_農地.土地所在, V_農地.地目名, V_農地.実面積,IIF(Len(D_申請.小作料)>0, D_申請.小作料,'') & IIF(Len(D_申請.小作料単位)>0, D_申請.小作料単位,'') AS 小作料文字 FROM V_農地 INNER JOIN (D_土地履歴 INNER JOIN D_申請 ON D_土地履歴.申請ID = D_申請.ID) ON V_農地.ID = D_土地履歴.LID WHERE ([D_申請].[許可年月日]>=CDate('%DD.期間開始日%')) AND ([D_申請].[許可年月日]<=CDate('%DD.期間終了日%')) AND " & _
                    "((D_申請.状態)=2) AND ((D_申請.法令) IN (31,33)) ORDER BY [D_申請].[許可年月日];"), "名称;名称;番号A;番号A;氏名A;氏名A;住所A;住所A;申請理由A;申請理由A;番号B;番号B;氏名B;氏名B;住所B;住所B;申請理由B;申請理由B;許可年月日;許可年月日;土地所在;土地所在;地目名;地目名;実面積;実面積;小作料;小作料文字", "３条貸借許可一覧"
                End With
            Case "許可済-利用権許可一覧"
                SystemDB.Execute "UPDATE (D_土地履歴 INNER JOIN [D:農地Info] ON D_土地履歴.LID = [D:農地Info].ID) INNER JOIN D_申請 ON (D_申請.申請者B = [D:農地Info].借受人ID) AND ([D:農地Info].小作終了年月日 = D_申請.終期) AND ([D:農地Info].小作開始年月日 = D_申請.始期) SET D_土地履歴.申請ID = [D_申請].[ID], D_土地履歴.関係者B = [申請者B] WHERE (((D_土地履歴.異動事由)=10061 Or (D_土地履歴.異動事由)=10062) AND ((D_土地履歴.申請ID) Is Null Or (D_土地履歴.申請ID)=0));"

                With Fnc.InputData("利用権許可一覧", "検索する許可日の期間を入力してください", Me, GetArray("期間開始日;日付;" & Now(), "期間終了日;日付;" & Now()))
                    If Not .IsObtained Then Exit Function
                    If Not .IsDate("期間開始日") Or Not .IsDate("期間終了日") Then Exit Function
                    mvarPDW.SQLListview.SQLListviewCHead .StrReplace("SELECT '農地.' & [V_農地].ID,D_申請.名称,申請者A AS 番号A,申請者B AS 番号B, D_申請.氏名A, D_申請.住所A, D_申請.申請理由A, D_申請.氏名B, D_申請.住所B, D_申請.申請理由B, D_申請.許可年月日, V_農地.土地所在, V_農地.地目名, V_農地.実面積, D_申請.始期, D_申請.終期, IIf([権利種類]=1,'賃貸借','使用貸借') AS 契約内容, IIf([D_申請].[再設定]=-1,'再設定','新規') AS 設定内容 FROM V_農地 INNER JOIN (D_土地履歴 INNER JOIN D_申請 ON D_土地履歴.申請ID = D_申請.ID) ON V_農地.ID = D_土地履歴.LID WHERE ([D_申請].[許可年月日]>=CDate('%DD.期間開始日%')) AND ([D_申請].[許可年月日]<=CDate('%DD.期間終了日%')) AND " & _
                    "((D_申請.状態)=2) AND ((D_申請.法令)=61) ORDER BY [D_申請].[許可年月日];"), "名称;名称;番号A;番号A;氏名A;氏名A;住所A;住所A;申請理由A;申請理由A;番号B;番号B;氏名B;氏名B;住所B;住所B;申請理由B;申請理由B;許可年月日;許可年月日;土地所在;土地所在;地目名;地目名;実面積;実面積;始期;始期;終期;終期;契約内容;契約内容;設定内容;設定内容", ""
                End With
            Case "受付中-流動化奨励金":
                    mod農家台帳.Sub奨励金作成
                    mvarPDW.SQLListview.SQLListviewCHead "SELECT '申請.' & [ID] AS [KEY], [名称],'Apply' AS [Icon], D_申請.総会番号,IIf(IsNull([受付補助記号]),[受付番号],[受付補助記号] & '-' & [受付番号]) AS [受付],* FROM [D_申請] WHERE ([法令] IN (" & state奨励金交付A & "," & state奨励金交付B & ")) AND [状態]=0", "%5000,名称;名称;総会番号;総会番号;受付番号;受付;=受付年月日;受付年月日", "奨励金"
            Case "受付中-事業計画変更", "申請管理-事業計画変更新規作成": mod農家台帳.事業計画変更
            Case "農地管理-登記地目が農地以外": view農地List "Not [登記簿地目] IN (10,11,20,21)", "登記地目が農地以外"
            Case "農業者年金受付管理-受付処理簿", "一時金請求受付管理-受付処理簿":
                St = Format(Now(), "ge")
                If Fnc.InputTextEx("年度設定", "年度を入力してください" & vbCrLf & vbCrLf & "　（入力例 ： 平成17年度 → H17 ）", St, , vbIMEModeOff) Then
                    Select Case DVProperty.ClassStr
                        Case "農業者年金受付管理": mvarPDW.PrintGo ADApp.ObjectMan.GetObject("年金受付簿"), "1;" & St
                        Case "一時金請求受付管理": mvarPDW.PrintGo ADApp.ObjectMan.GetObject("年金受付簿"), "2;" & St
                    End Select
                End If
            Case "認定農業者管理-期間別貸借一覧"
                With Fnc.InputMulti("期間別利用権設定一覧", "検索する許可日の期間を入力してください", "期間開始日;日付;" & Now() & "|期間終了日;日付;" & Now(), , True)
                    If .IsALLEmpty Then Exit Function
                    If Not .IsDate("期間開始日") Then Exit Function
                    If Not .IsDate("期間終了日") Then Exit Function
                    mvarPDW.SQLListview.SQLListviewCHead .StrReplace("SELECT '農地.' & V_農地.ID AS [KEY], V_農地.土地所在, V_地目.名称 AS 登記地目, V_地目2.名称 AS 現況地目, [畑面積]+[田面積]+[樹園地] AS 面積, [D:個人Info_1].氏名 AS 貸人,[D:個人Info].認定番号, [D:個人Info].氏名 AS 認定農業者, V_農地.小作開始年月日, V_農地.小作終了年月日 FROM (((V_農地 INNER JOIN [D:個人Info] ON V_農地.借受人ID = [D:個人Info].ID) INNER JOIN V_地目 ON V_農地.登記簿地目 = V_地目.ID) INNER JOIN V_地目 AS V_地目2 ON V_農地.現況地目 = V_地目2.ID) INNER JOIN [D:個人Info] AS [D:個人Info_1] ON V_農地.所有者ID = [D:個人Info_1].ID " & _
                    "WHERE (([D:個人Info].農業改善計画認定)=1) AND (((V_農地.自小作別)<>0) AND ((V_農地.小作地適用法)=2) AND ((V_農地.小作開始年月日)>CDate('%DD.期間開始日%') And (V_農地.小作開始年月日)<CDate('%DD.期間終了日%')));"), "土地所在;土地所在;登記地目;登記地目;現況地目;現況地目;@面積;面積;貸人;貸人;@認定番号;認定番号;認定農業者;認定農業者;始期;小作開始年月日;終期;小作終了年月日", ""
                End With
            Case "認定農業者管理-農地明細":
                view農地List "[自小作別]>0 AND ([D:個人Info].[農業改善計画認定]=1 Or [T_借受者].[農業改善計画認定]=1)", "認定農業者農地明細", False
            Case "世帯管理-世帯経営面積一覧"
                view世帯集計List "[D:個人Info].[行政区ID] Is Not Null", "世帯経営面積一覧"
            Case "世帯管理-選挙候補者一覧"
                view選挙候補者List
                
            Case Else
                Select Case sCmd
                    Case "最新情報に更新"
                        If InStr(DVProperty.ClassStr, "許可済") Or InStr(DVProperty.ClassStr, "承認済") Or InStr(DVProperty.ClassStr, "適用済") Then
                            Sub申請月別作成 DVProperty.ClassStr
                        Else
                            Debug.Assert CaseAssertPrint(DVProperty.ClassStr)
                        End If
                    Case "名前の変更":
                        Set Rs = SystemDB.GetRecordsetEx("SELECT * FROM [S_Folder] WHERE [KEY]='" & DVProperty.Key & "'", , , Me)
                        If Rs.EOF Then
                            MsgBox "この項目の名前の変更は現在許可されていません", vbCritical
                        Else
                            St = Trim(Fnc.InputText("名前の変更", "新しい名前を入力してください", Rs.Value("名称")))
                            If Len(St) Then
                                Rs.Update "名称", St
                                mvarPDW.Folder.Redraw mvarPDW.Folder.ExpandedList
                            End If
                        End If
                        SystemDB.CloseRs Rs
                    Case "削除": mvarPDW.Folder.RemoveNode Me.Key, True
                    Case "都道府県別世帯一覧": view世帯List "WHERE [都道府県ID]=" & DVProperty.ID, "世帯一覧" '/** 農地0001-0001-0001
                    Case "コードの表示": MsgBox "Key:" & DVProperty.Key, vbOKOnly, "コードの表示"
                    Case "自然解約の実行": sub自然解約
                    Case "世帯に関連付けていない農地所有者": mvarPDW.SQLListview.SQLListviewCHead "SELECT '世帯員.' & [D:個人Info].[ID] AS [Key], [D:個人Info].氏名, [D:個人Info].住所 FROM [D:農地Info] INNER JOIN [D:個人Info] ON [D:農地Info].所有者ID = [D:個人Info].ID WHERE ((([D:個人Info].世帯ID) Is Null Or ([D:個人Info].世帯ID)=0)) GROUP BY '世帯員.' & [D:個人Info].[ID], [D:個人Info].氏名, [D:個人Info].住所;", "氏名;氏名;住所;住所", "世帯に関連付けていない農地所有者"
                    Case "貸借・終了関連"
                        mvarPDW.SQLListview.SQLListviewCHead _
                        "SELECT '土地履歴.' & D_土地履歴.ID AS [KEY], D_土地履歴.内容, D_土地履歴.異動事由, M_BASICALL.名称, D_土地履歴.異動日, V_農地.土地所在, V_農地.地目名, V_農地.登記簿面積 FROM (V_農地 INNER JOIN D_土地履歴 ON V_農地.ID = D_土地履歴.LID) LEFT JOIN M_BASICALL ON D_土地履歴.異動事由 = M_BASICALL.ID WHERE (((D_土地履歴.異動事由)>10009 And (D_土地履歴.異動事由)<=10202) AND (((M_BASICALL.Class) IS NULL) OR (M_BASICALL.Class)='土地異動事由')) ORDER BY D_土地履歴.異動事由, D_土地履歴.異動日;" _
                        , "内容;内容;異動事由;異動事由;名称;名称;異動日;異動日;土地所在;土地所在;地目;地目名;@登記簿面積;登記簿面積", "貸借・終了関連"
                    Case "連絡先課名":
                        St = SysAD.GetSettingData("利用権終期通知書", "連絡先課名", "")
                        St = Fnc.InputText("連絡先課名入力", "連絡先を入力してください。", St, , vbIMEHiragana)
                        If Len(St) Then SysAD.SetSettingData "利用権終期通知書", "連絡先課名", St
                    Case Else
                        Debug.Assert CaseAssertPrint(DVProperty.ClassStr & "-" & sCmd, "CFol各種管理")
                End Select
        End Select
    End Function
    
    Private Sub CDataviewSK_DropDown(sSourceList As String, Optional sOption As String = "")
        Dim Ar As Variant
        Dim n As Long
        Dim ID As Long
        Dim HD As String
        Dim St As String
        
        If Len(sSourceList) = 0 Then Exit Sub
        Select Case Fnc.GetKeyHead(DVProperty.Key) & "-" & Fnc.GetKeyHead(sSourceList)
            Case "都道府県-農家": SystemDB.Execute "UPDATE [D:世帯Info] SET [D:世帯Info].都道府県ID = " & Fnc.GetKeyCode(DVProperty.Key) & " WHERE [D:世帯Info].[ID] IN ( " & GetKeyCodeList(sSourceList, "農家") & ");": mvarPDW.SQLListview.Refresh
            Case "農地管理-農家": MsgBox "「農家」を「農地グループ」へドロップできません", vbExclamation, "ドラッグドロップの失敗"
            Case "年金受給者地区-世帯員"
                St = GetKeyCodeList(sSourceList, "世帯員")
                Ar = Split(St, ";")
                For n = 0 To UBound(Ar)
                    SystemDB.ExecuteSQL "INSERT INTO D_年金受給者 ( ID, 受給地区 ) VALUES(" & Fnc.GetKeyCode(CStr(Ar(n))) & "," & DVProperty.ID & ");"
                Next
            Case "都道府県-市町村": ChangeMasterParent sSourceList, DVProperty.Key
            Case "世帯管理-行政区":
                Ar = Split(sSourceList, ";")
                For n = LBound(Ar) To UBound(Ar)
                    If Len(Ar(n)) Then
                        HD = Fnc.GetKeyHead(CStr(Ar(n)))
                    Else
                        HD = ""
                    End If
                    
                    SystemDB.SetDirectData "S_Folder", "ParentKey", DVProperty.Key, , CStr(Ar(n))
                Next
                mvarPDW.Folder.Redraw
            Case "地域-行政区"
                If Len(sSourceList) Then
                    Ar = Split(sSourceList, ";")
                    
                    For n = LBound(Ar) To UBound(Ar)
                        If Len(Ar(n)) Then
                            HD = Fnc.GetKeyHead(CStr(Ar(n)))
                        Else
                            HD = ""
                        End If
                        SystemDB.SetDirectData "S_Folder", "ParentKey", DVProperty.Key, , CStr(Ar(n))
                    Next
                    mvarPDW.Folder.Redraw mvarPDW.Folder.ExpandedList
                End If
            Case "地域-地域"
                If MsgBox("地域を移動しますか", vbYesNo) = vbYes Then
                    Ar = Split(sSourceList, ";")
                    ID = SystemDB.GetDirectData("S_Folder", "表示順序", , DVProperty.Key) + 1
                    For n = LBound(Ar) To UBound(Ar)
                        If Len(Ar(n)) And Ar(n) <> DVProperty.Key Then
                            SystemDB.SetDirectData "S_Folder", "表示順序", ID + n, , CStr(Ar(n))
                            SystemDB.SetDirectData "S_Folder", "ParentKey", DVProperty.Key, , CStr(Ar(n))
                        End If
                    Next
                    mvarPDW.Folder.Redraw mvarPDW.Folder.ExpandedList
                End If
            Case "担い手農家管理-世帯員": St = GetKeyCodeList(sSourceList, "世帯員"): SystemDB.ExecuteSQL "UPDATE [D:個人Info] SET [農業改善計画認定]=2 WHERE [ID] IN (" & St & ")": MsgBox "担い手農家に設定しました。", vbInformation
            Case "認定農業者管理-世帯員": St = GetKeyCodeList(sSourceList, "世帯員"): SystemDB.ExecuteSQL "UPDATE [D:個人Info] SET [農業改善計画認定]=1 WHERE [ID] IN (" & St & ")": MsgBox "認定農業者に設定しました。", vbInformation
            Case "市町村内その他-農家"
            Case "年金受給者-世帯員": MsgBox "給付種類を限定してドラッグしてください", vbCritical
            Case "老齢年金受給者-世帯員"
                St = Replace(Replace(sSourceList, ";", ","), "世帯員.", "")
                SystemDB.ExecuteSQL "UPDATE [D:個人Info] SET [D:個人Info].[老齢受給の有無] = True WHERE ((([D:個人Info].ID) IN (" & St & ")));"
            Case "経営移譲年金受給者-世帯員"
                St = Replace(Replace(sSourceList, ";", ","), "世帯員.", "")
                SystemDB.ExecuteSQL "UPDATE [D:個人Info] SET [D:個人Info].[経営移譲受給の有無] = True WHERE ((([D:個人Info].ID) IN (" & St & ")));"
            Case "町外管理-都道府県"
            Case "マスタ管理-農家台帳"
            Case "印刷グループ-印刷", "印刷管理-カスタム書式", "マスタグループ-続柄管理"
                Ar = Split(sSourceList, ";")
                For n = LBound(Ar) To UBound(Ar)
                    SystemDB.ExecuteSQL "UPDATE S_Folder, S_Folder AS S_Folder_1 SET S_Folder.ParentKey = '" & DVProperty.Key & "' WHERE (((S_Folder.Key) ='" & Ar(n) & "'));"
                Next
                mvarPDW.Folder.Redraw mvarPDW.Folder.ExpandedList
            Case "農地管理-大字"
                ID = Fnc.GetKeyCode(sSourceList)
                SystemDB.ExecuteSQL "INSERT INTO [S_Folder] VALUES('農地大字." & ID & "','農地管理.0',1000,'" & SystemDB.GetDirectDataWithClass("M_BASICALL", "名称", "大字", ID) & "','大字','CloseFolderR','OpenFolderR',TRUE)"
                mvarPDW.Folder.Redraw mvarPDW.Folder.ExpandedList
            Case "地域-"
            Case Else
                Debug.Assert CaseAssertPrint(Fnc.GetKeyHead(DVProperty.Key) & "-" & Fnc.GetKeyHead(sSourceList))
                MsgBox Fnc.GetKeyHead(sSourceList) & "のドロップはできません", vbCritical
        End Select
    End Sub

    Private Property Set CDataviewSK_DVProperty(ByVal RHS As ADBasicLIB2.CDataviewProperty): Set DVProperty = RHS: End Property
    Private Property Get CDataviewSK_DVProperty() As ADBasicLIB2.CDataviewProperty: Set CDataviewSK_DVProperty = DVProperty: End Property

    Private Function CDataviewSK_GetProperty2(sPropName As String, Optional sParam As String = "") As Variant
        Select Case sPropName
            Case Else
                Debug.Assert False 'Non Code
        End Select
    End Function

    Private Property Get CDataviewSK_IconName() As String: End Property
    Private Sub ViewOutofLand()
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim St As String
        Dim n As Long
        
        Set Rs = SystemDB.GetRecordsetEx("SELECT [D:個人Info].ID AS IDのカウント FROM [D:個人Info] INNER JOIN [D:農地Info] ON [D:個人Info].ID = [D:農地Info].所有者ID Where ((([D:個人Info].不在) = True) And (([D:個人Info].死亡) = False)) GROUP BY [D:個人Info].ID;", , , Me)
        n = 0
        Do Until Rs.EOF
            n = n + 1
            Rs.MoveNext
        Loop
        St = "町外者・法人=" & Format(n, "#0,000人") & vbCrLf
        Rs.CloseRs
        Set Rs = SystemDB.GetRecordsetEx("SELECT Sum(IIf(IsNull([D:農地Info].[田面積]),0,[D:農地Info].[田面積])) AS 田面積の合計, Sum(IIf(IsNull([D:農地Info].[畑面積]),0,[D:農地Info].[畑面積])) AS 畑面積の合計, Sum(IIf(([D:農地Info].[田面積])<>0,1,0)) AS 田筆数, Sum(IIf([D:農地Info].[畑面積]<>0,1,0)) AS 畑筆数 FROM [D:個人Info] INNER JOIN [D:農地Info] ON [D:個人Info].ID = [D:農地Info].所有者ID WHERE ((([D:個人Info].死亡)=False) AND (([D:個人Info].不在)=True));", 0, , Me)
        
        St = St & "田面積=" & Right$("          " & Rs.FormatS("田面積の合計", "#0,000"), 11) & "[u](" & Right$("      " & Round(Rs.Value("田面積の合計") / 10000), 6) & "[ha], " & Rs.Value("田筆数") & "筆)" & vbCrLf
        St = St & "畑面積=" & Right$("          " & Rs.FormatS("畑面積の合計", "#0,000"), 11) & "[u](" & Right$("      " & Round(Rs.Value("畑面積の合計") / 10000), 6) & "[ha], " & Rs.Value("畑筆数") & "筆)" & vbCrLf
        Rs.CloseRs
        
        MsgBox St, vbInformation, "町外・法人情報"
    End Sub
    
    Private Sub cmd世帯管理に地域の追加()
        Dim sKey As String
        Dim St As String
        Dim n As Long
        
        St = InputBox("追加する地域の名称を入力してください", "地域の追加")
        If Len(St) Then
            sKey = "地域." & GetMaxKeyCode("S_Folder", "Key", "[Key] Like '地域%'")
            n = SystemDB.GetMaxCode("S_Folder", "表示順序")
            SystemDB.ExecuteSQL "INSERT INTO S_Folder ([Key], ParentKey, 表示順序, 名称, Class, Icon, SelectIcon,Visible) VALUES('" & sKey & "','" & DVProperty.Key & "'," & n & ",'" & St & "','地域','UserFolder','UserFolder',-1)"
            mvarPDW.Folder.Redraw mvarPDW.Folder.ExpandedList
        End If
    End Sub
    
    Private Sub cmd終了年の再捜査(n法令 As Long)
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim RsF As ADBasicLIB2.RecordsetEx
        Dim n As Long
        Dim s法令 As String
        
        Set Rs = SystemDB.GetRecordsetEx("SELECT Year([小作終了年月日]) AS 終了年 FROM [D:農地info] WHERE ((([D:農地info].小作地適用法)=" & n法令 & ") AND (([D:農地info].自小作別)>0)) GROUP BY Year([小作終了年月日]) HAVING (((Year([小作終了年月日]))>1800)) ORDER BY Year([小作終了年月日]);", , , Me)
        Set RsF = SystemDB.GetRecordsetEx("SELECT * FROM [S_Folder]", , , Me)
        
        s法令 = IIf(n法令 = 1, "農地法終期", "利用権終期")
        SystemDB.ExecuteSQL "DELETE FROM [S_FOLDER] WHERE [KEY] LIKE '" & s法令 & ".%';", "初期化中"
        n = 50000
        Do Until Rs.EOF
            RsF.AddNew GetArray("Key", "ParentKey", "表示順序", "名称", "Class", "Icon", "SelectIcon", "Visible"), GetArray(s法令 & "." & Rs.Value("終了年"), s法令 & "台帳.0", n, s法令 & "_" & Format(CDate(Rs.Value("終了年") & "/1/1"), "GGGEE"), s法令, "IDocument", "IDocument", True)
            Rs.MoveNext
            n = n + 1
        Loop
        Rs.CloseRs
        RsF.CloseRs
    End Sub

    Private Function CDataviewSK_PopupMenu(Optional ByVal sParam As String = "", Optional vParam As Variant) As String
        Dim pPrint As CPrintObject
        Dim St As String
        Dim pID As Long
        Dim dtStart As Date
        Dim dtEnd As Date
        Dim StStartR As String
        Dim StEndR As String
        
        St = "開く;-;"
        Select Case Fnc.GetKeyHead(Me.Key)
            Case "世帯管理": St = St & ">フォルダへの追加;地域;大字;行政区;<;-;>検索;世帯数;世帯番号からの検索;住民番号からの検索;生年月日からの検索;<;町内居住者の再サンプル;農業者の検索;-;>一覧;集落別耕作農家;世帯経営面積一覧;集落別利用権を設定した面積;集落別利用権の設定を受けた面積;-;選挙候補者一覧;<;"
            Case "農地管理": St = St & "大字／町名を追加;農地検索;-;貸借農地一覧;未世帯農地一覧;台帳内作成農地一覧;-;遊休農地一覧;登記地目が農地以外;大字／地区別遊休地集計;-;備考欄検索;"
            Case "利用権終期台帳": St = St & "自然解約の実行;終期台帳の発行;利用権終了年の再捜査;-;終期通知発行;-;期間指定で検索;-;連絡先課名;"
            Case "農地法終期台帳": St = St & "農地法終了年の再捜査;-;終期農地一覧表;"
            Case "利用権終期": St = St & ">月別一覧;１月;２月;３月;４月;５月;６月;７月;８月;９月;１０月;１１月;１２月;<;削除;"
            Case "農地法終期": St = St & "削除;"
            Case "マスタ管理": St = St & "テーブル表示;"
            Case "認定農業者":
            Case "老齢年金受給者地区": St = St & "受給者地区名の変更;"
            Case "経営移譲年金受給者地区": St = St & "受給者地区名の変更;受給者地区名の削除"
            Case "県外管理":
            Case "申請管理": St = St & "議案書作成;議案書新規作成;-;事業計画変更新規作成;" & IIf(Val(SystemDB.DBProperty("利用権表紙")), "-;利用権表紙印刷;-", "")
            Case "年金受給者": St = St & "地区の追加;"
            Case "合併世帯管理": St = St & "世帯に関連付けていない農地所有者;"
            Case "地方管理": St = St & "都道府県の追加;コードの表示;"
            Case "都道府県": St = St & "都道府県別世帯一覧;市町村の追加;-;削除;"
            Case "地域": St = St & "地域の削除;"
            Case "受付中": St = St & ">新規作成;農地法３条申請（所有権）;農地法４条申請（転用）;農地法５条申請（転用目的の移動）;利用権設定;-;流動化奨励金;事業計画変更;<;-;総会資料作成;"
            Case "町外管理": St = St & "町外個人の追加;>追加;市町村追加;<;>不在地主管理;未分配者一覧;<;町外者・法人所有（死亡名義人を除く）情報;"
            Case "その他管理": St = St & "町外農業者の登録;住所による分配;"
            Case "対象者": St = "対象者から外す;"
            Case "農業者年金受付管理", "一時金請求受付管理": St = "受付処理簿;"
            Case "許可済": St = "貸借・終了関連;３条所有権許可一覧;３条貸借許可一覧;-;転用許可済み４条;転用許可済み５条;-;利用権総括表;利用権許可一覧;"
            Case "認定農業者管理": St = St & ADApp.Common.GetPopMenu(Me.Key) & ";"
            Case "総会資料": St = "開く;"
            Case "３条許可済", "県３条許可済", "４条許可済", "５条許可済", "所有権移転承認済", "農用地計画変更許可済", "解約適用済", "利用権設定承認済", "利用権移転承認済", "農地利用変更許可済", "農地利用変更承認済", "非農地承認済"
                St = "開く;最新情報に更新;"
            Case Else
                St = St & "コードの表示;"
        End Select
        
        St = St & "-;名前の変更;最下位置に移動する;"
        If Not DVProperty.Body Is Nothing Then St = St & "-;閉じる;"
        
        St = SysAD.PopupMenu(St)
        Select Case St
            Case "開く": CDataviewSK_DblClick
            Case "未世帯農地一覧": view未世帯農地一覧
            Case "世帯番号からの検索": Find世帯With世帯番号
            Case "住民番号からの検索": Find個人With住民番号
            Case "生年月日からの検索": Find個人With住民番号
            Case "未分配者一覧": mvarPDW.SQLListview.SQLListviewCHead "SELECT '世帯員.' & [D:個人Info].ID AS [KEY], [D:個人Info].氏名,'Farmer' AS [Icon], [D:個人Info].住所, [D:個人Info].市町村ID FROM [D:個人Info] WHERE (([D:個人Info].市町村ID=0) Or ([D:個人Info].市町村ID Is Null));", "氏名;氏名;住所;住所", "未分配者一覧"
            Case "地域": cmd世帯管理に地域の追加
            Case "世帯数":
            Case "大字"
                Debug.Assert False 'Non Code
            Case "台帳内作成農地一覧": ADApp.DoCommand "農地一覧", "WHERE [V_農地].[ID]<0"
            Case "備考欄検索"
                St = Fnc.InputText("農地備考欄検索", "検索文字列を入力してください。", "*", 0, 1)
                If Len(St) Then
                    St = Replace(St, "*", "%")
                    view農地List "WHERE [備考欄] LIKE '" & St & "'", "備考欄文字列検索", False '/** 農地0001-0001-0002
                End If
            
            Case "地域の削除":
                With SystemDB
                    .ExecuteSQL "UPDATE S_Folder SET S_Folder.ParentKey = '世帯管理.0' WHERE [S_Folder].[ParentKey]='" & DVProperty.Key & "';"
                    .ExecuteSQL "Delete S_Folder.Key From S_Folder WHERE [S_Folder].[Key]='" & DVProperty.Key & "';"
                End With
                mvarPDW.SQLListview.Refresh
                mvarPDW.Folder.Redraw mvarPDW.Folder.ExpandedList
            Case "利用権終期農地一覧表Ａ"
                mvarPDW.PrintGo ADApp.ObjectMan.GetObject("利用権終期農地一覧表Ａ")
            Case "利用権終期農地一覧表"
    '                Dim stInput As String
    '                Dim stMess As String
    '
    '                stInput = ""
    '                stMess = "検査開始日を入力してください"
    '                Do Until IsDate(stInput)
    '                    stInput = InputBox(stMess, "利用権終期農地一覧", Date)
    '                    If Len(stInput) = 0 Then Exit Sub
    '                    stMess = "正しい日付(開始日)を入力してください"
    '                Loop
    '                dtStart = CDate(stInput)
    '
    '                stInput = ""
    '                stMess = "検査終了日を入力してください"
    '                Do Until IsDate(stInput)
    '                    stInput = InputBox(stMess, "利用権終期農地一覧", Date)
    '                    If Len(stInput) = 0 Then Exit Sub
    '                    stMess = "正しい日付(終了日)を入力してください"
    '                Loop
    '                dtEnd = CDate(stInput)
    '
    '                Set pPrint = ADApp.ObjectMan.GetObject("利用権終期農地一覧")
    '                pPrint.Printview dtStart & ";" & dtEnd ' DVProperty.ID &
                
            Case "町内居住者の再サンプル"
                Dim Rs As ADBasicLIB2.RecordsetEx
                Dim S2 As String
                Dim S3 As String
                Dim Ro As ADBasicLIB2.RecordsetEx
                Dim ID As Long
                
                Set Rs = SystemDB.GetRecordsetEx("SELECT [D:個人Info].住所, [D:世帯Info].市町村ID FROM [D:世帯Info] WHERE ([D:個人Info].住所 Is Not Null AND (([D:世帯Info].市町村ID)=0));", , , Me)
                Set Ro = SystemDB.GetRecordsetEx("SELECT [ID],[名称] FROM [M_BASICALL] WHERE [CLASS] = '大字'", , , Me)
                If Not Rs.EOF And Not Ro.EOF Then
                    Rs.MoveFirst
                    St = SystemDB.GetDirectData("S_システムデータ", "Data", , "市町村名")
                    ID = Val(SystemDB.GetDirectData("S_システムデータ", "Data", , "市町村ID"))
                    S3 = SystemDB.GetDirectData("S_Folder", "名称", , "都道府県." & SystemDB.GetDirectData("S_システムデータ", "Data", , "都道府県ID"))
                    
                    Do Until Rs.EOF
                        Ro.MoveFirst
                        Do Until Ro.EOF
                            S2 = St & Ro.Value("名称")
                            If Left$(Rs.Value("住所"), Len(S2)) = S2 Then
                                Rs.Update "市町村ID", ID
                            ElseIf Left$(St & Rs.Value("住所"), Len(S2)) = S2 Then
                                Rs.Update "市町村ID", ID
                            ElseIf Left$(Rs.Value("住所"), Len(S3 & S2)) = S3 & S2 Then
                                Rs.Update "市町村ID", ID
                            ElseIf Left$(Rs.Value("住所"), Len(S3 & S2) + 2) = S3 & St & "大字" & Ro.Value("名称") Then
                                Rs.Update "市町村ID", ID
                            End If
                            Ro.MoveNext
                        Loop
                        Rs.MoveNext
                    Loop
                End If
                Rs.CloseRs
                Ro.CloseRs
            Case "１月", "２月", "３月", "４月", "５月", "６月", "７月", "８月", "９月", "１０月", "１１月", "１２月"
                dtStart = FormatDateTime(DateSerial(Fnc.GetKeyCode(DVProperty.Key), Val(StrConv(St, vbNarrow)), 1), 1)
                dtEnd = FormatDateTime(DateAdd("m", 1, dtStart) - 1, 1)
                
                St = "SELECT '農地.' & [V_農地].ID AS [KEY], V_農地.地目名, [V_行政区].[ID] & ':' & [V_行政区].[行政区] AS 設定者集落, [D:個人Info].郵便番号 AS 設定者郵便, [D:個人Info].住所 AS 設定者住所, Choose([農業振興地域]+1,'地','内','外') AS 農振地域, Choose(Val([D:個人Info].[農業改善計画認定]+1),'-','認','担','法','認+担') AS 農業改善計画認定, [D:個人Info].氏名 AS 設定者, IIf([D:個人INfo].[死亡],'死亡',' ') AS 設定者区分, [V_行政区_1].[ID] & ':' & [V_行政区_1].[行政区] AS 被設定者集落, [D:個人Info_1].郵便番号 AS 被設定者郵便, [D:個人Info_1].住所 AS 被設定者住所, [D:個人Info_1].氏名 AS 被設定者, V_地目.名称 AS 地目, V_農地.登記簿面積, V_小作形態.名称 AS 種類, V_農地.小作料, V_農地.小作開始年月日 AS 開始日, V_農地.小作終了年月日 AS 終了日, V_農地.土地所在, V_農地.小作料S " & _
                     "FROM (((((V_行政区 RIGHT JOIN ((V_農地 INNER JOIN [D:個人Info] ON V_農地.管理人ID = [D:個人Info].ID) LEFT JOIN [D:世帯Info] ON [D:個人Info].世帯ID = [D:世帯Info].ID) ON V_行政区.ID = [D:世帯Info].行政区ID) LEFT JOIN [D:個人Info] AS [D:個人Info_1] ON V_農地.借受人ID = [D:個人Info_1].ID) LEFT JOIN [D:世帯Info] AS [D:世帯Info_1] ON [D:個人Info_1].世帯ID = [D:世帯Info_1].ID) LEFT JOIN V_行政区 AS V_行政区_1 ON [D:世帯Info_1].行政区ID = V_行政区_1.ID) INNER JOIN V_小作形態 ON V_農地.小作形態 = V_小作形態.ID) INNER JOIN V_地目 ON V_農地.現況地目 = V_地目.ID " & _
                     "WHERE (((V_農地.小作終了年月日) >= #12/1/2011# And (V_農地.小作終了年月日) <= #12/31/2011#) And ((V_農地.自小作別) > 0) And ((V_農地.小作地適用法) = 2)) " & _
                     "GROUP BY '農地.' & [V_農地].ID, V_農地.地目名, [V_行政区].[ID] & ':' & [V_行政区].[行政区], [D:個人Info].郵便番号, [D:個人Info].住所, Choose([農業振興地域]+1,'地','内','外'), Choose(Val([D:個人Info].[農業改善計画認定]+1),'-','認','担','法','認+担'), [D:個人Info].氏名, IIf([D:個人INfo].[死亡],'死亡',' '), [V_行政区_1].[ID] & ':' & [V_行政区_1].[行政区], [D:個人Info_1].郵便番号, [D:個人Info_1].住所, [D:個人Info_1].氏名, V_地目.名称, V_農地.登記簿面積, V_小作形態.名称, V_農地.小作料, V_農地.小作開始年月日, V_農地.小作終了年月日, V_農地.土地所在, V_農地.小作料S, [D:個人Info_1].氏名, [D:個人Info].氏名 " & _
                     "ORDER BY V_農地.小作終了年月日, [D:個人Info_1].氏名, [D:個人Info].氏名;"
                mvarPDW.SQLListview.SQLListviewCHead St, "土地所在;土地所在;農振地域;農振地域;設定する者;設定者;設定者集落;設定者集落;所有者郵便番号;設定者郵便;設定者住所;設定者住所;設定を受ける者;被設定者;認定項目;農業改善計画認定;被設定者集落;被設定者集落;設定を受ける者郵便番号;被設定者郵便;設定を受ける者住所;被設定者住所;地目名;地目名;@面積;登記簿面積;=始期;開始日;=終期;終了日;小作料;小作料S", "利用権終期台帳:" & CStr(dtStart) & "〜" & CStr(dtEnd)
            Case "町外者・法人所有（死亡名義人を除く）情報"
                ViewOutofLand
            Case "農業者の検索": mvarPDW.ExplorerBar.Add ADApp.ObjectMan.GetObject("農家検索.1")
            Case "農地検索": mvarPDW.ExplorerBar.Add ADApp.ObjectMan.GetObject("農地検索.1")
            Case "行政区":
                SystemDB.ExecuteSQL "UPDATE M_BASICALL SET M_BASICALL.sParam = '行政区.' & [ID] WHERE (((M_BASICALL.Class)='行政区'));"
                Set Rs = SystemDB.GetRecordsetEx("SELECT Right$('0000' & [ID],4) & ':' & [M_BASICALL].[名称] AS List FROM M_BASICALL LEFT JOIN S_Folder ON M_BASICALL.sParam = S_Folder.Key WHERE (((M_BASICALL.Class)='行政区') AND ((M_BASICALL.ID)>0) AND ((S_Folder.Key) Is Null)) ORDER BY Right$('0000' & [ID],4) & ':' & [M_BASICALL].[名称];", 0, , Me)
                St = Rs.GetString("", ";")
                Rs.CloseRs
                St = Fnc.OptionSelect(St, "追加する行政区を選択してください")
                If Len(St) Then
                    SystemDB.ExecuteSQL "INSERT INTO S_Folder ( [Key], ParentKey, 表示順序, 名称, Class, Icon, SelectIcon, Visible ) VALUES('行政区." & Val(Left$(St, 4)) & "','世帯管理.0',4000,'" & Trim(MID$(St, 6)) & "','行政区','CloseFolder','OpenFolder', TRUE);"
                    mvarPDW.Folder.Redraw mvarPDW.Folder.ExpandedList
                End If
            Case "農地法終了年の再捜査": cmd終了年の再捜査 1: mvarPDW.Folder.Redraw mvarPDW.Folder.ExpandedList
            Case "利用権終了年の再捜査": cmd終了年の再捜査 2: mvarPDW.Folder.Redraw mvarPDW.Folder.ExpandedList
            Case "最下位置に移動する": mvarPDW.Folder.NodeMoveLast Me.Key
            Case "町外農業者の登録": CreateFarmer
            Case ""
                
            Case Else
                CDataviewSK_DoCommand2 St
        End Select
    End Function

    '各DLL共通↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓
    Public Property Get Key() As String: Key = DVProperty.Key: End Property
    Public Property Let Key(ByVal RHS As String): DVProperty.SetDVP RHS: End Property

    Private Property Let CDataviewSK_Key(ByVal RHS As String): Me.Key = RHS: End Property
    Private Property Get CDataviewSK_Key() As String: CDataviewSK_Key = Me.Key: End Property

    '各DLL共通↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑
    Private Sub CDataviewSK_Refresh(Optional bReLoad As Boolean = False)
        Debug.Assert False 'Non Code
    End Sub

End Class










Class CFol各受付中
    Option Explicit
    Implements ADBasicLIB2.CDataviewSK
    
    Private DVProperty As CDataviewProperty
    Private Sub Class_Initialize(): Set DVProperty = mvarPDW.DataviewCol.GetNewDVP: End Sub

    Public Property Get Key() As String: Key = DVProperty.Key: End Property
    Public Property Let Key(ByVal RHS As String): DVProperty.SetDVP RHS: End Property

    Private Sub CDataviewSK_CloseRecordset(): End Sub

    Private Property Set CDataviewSK_DVProperty(ByVal RHS As ADBasicLIB2.CDataviewProperty): Set DVProperty = RHS: End Property
    Private Property Get CDataviewSK_DVProperty() As ADBasicLIB2.CDataviewProperty: Set CDataviewSK_DVProperty = DVProperty: End Property

    Private Property Get CDataviewSK_ParentKey() As String: CDataviewSK_ParentKey = DVProperty.Key: End Property

    Private Function CDataviewSK_PopupMenu(Optional ByVal sParam As String = "", Optional vParam As Variant) As String
        CDataviewSK_DoCommand2 SysAD.PopupMenu("開く;-;受付簿;-;最下位置に移動する;")
    End Function

    Private Sub CDataviewSK_Refresh(Optional bReLoad As Boolean = False)
        Debug.Assert False 'Non Code
    End Sub

    Private Property Set CDataviewSK_Container(ByVal RHS As ADBasicLIB2.CPDW)
    Debug.Assert False 'Non Code
    End Property

    Public Sub SetAToB(ByVal s法令 As String)
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim Rp As ADBasicLIB2.RecordsetEx
        
        Set Rs = SystemDB.GetRecordsetEx("SELECT * FROM [D_申請] WHERE ([法令] IN " & s法令 & ")", , , "申請設定")
        Do Until Rs.EOF
            If Not Rs.IsNull("申請者B") Then
                Set Rp = SystemDB.GetRecordsetEx("SELECT * FROM [D:個人Info] WHERE [ID]=" & Rs.Value("申請者B"), , , "申請設定2")
            End If

            If Left$(Rs.Value("名称"), Len(Rs.NullCast("代理人名", ""))) = Rs.NullCast("代理人名", "") Then
            Else
                Rs.Value("名称") = Replace(Rs.Value("名称"), Left$(Rs.Value("名称"), InStr(Rs.Value("名称"), "(") - 1), Rs.Value("代理人名"))
            End If

            If Rp Is Nothing Then
            ElseIf Rp.State = adStateClosed Then
                SystemDB.CloseRs Rp
            ElseIf Rp.EOF Then
                SystemDB.CloseRs Rp
            ElseIf (Right$(Rs.Value("名称"), 1) = "→") Then
                Rs.Value("名称") = Rs.Value("名称") & Rp.Value("氏名")
                SystemDB.CloseRs Rp
            ElseIf MID$(Rs.Value("名称"), InStrRev(Rs.Value("名称"), "→") + 1) <> Rp.Value("氏名") Then
                Rs.Value("名称") = Left$(Rs.Value("名称"), InStrRev(Rs.Value("名称"), "→")) & Rp.Value("氏名")
                SystemDB.CloseRs Rp
            End If
            Rs.Update
            Rs.MoveNext

            If Not Rp Is Nothing Then SystemDB.CloseRs Rp
        Loop
        SystemDB.CloseRs Rs
    End Sub

    Private Sub CDataviewSK_DblClick()
        Dim St As String
        
        Select Case Fnc.GetKeyHead(Me.Key)
            Case "３条受付中": St = "(" & state3条所有権 & "," & state3条賃借権 & ")"
            Case "県３条受付中": St = "(" & state県3条所有権 & "," & state県3条賃借権 & ")"
            Case "４条受付中": St = "(" & state4条転用 & ")"
            Case "５条受付中": St = "(" & state5条所有権 & "," & state5条賃借権 & ")"
            Case "解約受付中": St = "(" & state20条解約 & "," & state合意解約 & ")"
            Case "利用権移転受付中": St = "(" & state基盤利用権移転 & ")"
            Case "利用権設定受付中": St = "(" & state基盤利用権設定 & ")"
            Case "所有権移転受付中": St = "(" & state基盤所有権設定 & ")"
            Case "所有権設定受付中": St = "(" & state基盤所有権設定 & ")"
            Case "農用地計画変更受付中": St = "(" & state農用地計画変更 & ")"
            Case "事業計画変更受付中": St = "(" & state事業計画変更 & ")"
           
            Case "奨励金受付中": St = "(" & state奨励金交付A & "," & state奨励金交付B & ")"
            Case "農地利用変更受付中": St = "(" & state農地利用変更 & ")"

            Case Else
                Debug.Assert CaseAssertPrint(TypeName(Me) & "=>" & "CFolderDblClick=>" & Me.Key)
        End Select
        If SystemDB.DBProperty("支所番号") = "-1" Then
            mvarPDW.SQLListview.SQLListviewCHead "SELECT '申請.' & [D_申請].[ID] AS [KEY], [D_申請].[名称],'Apply' AS [Icon], M_BASICALL.名称 AS 支所, D_申請.総会番号,IIf(IsNull([受付補助記号]),[受付番号],[受付補助記号] & '-' & [受付番号]) AS [受付],[通年受付番号],[受付年月日] FROM [D_申請] INNER JOIN M_BASICALL ON D_申請.支所番号 = M_BASICALL.ID WHERE [Class]='支所番号' AND ([法令] IN " & St & ") AND [状態]=0", Replace(SysAD.GetSettingData("農地基本台帳", "申請受付中リスト表示", ADApp.Common.AppData("申請受付中リスト表示")), ",", ";"), Replace(Me.Key, "受付中", "受付簿")
        Else
            mvarPDW.SQLListview.SQLListviewCHead "SELECT '申請.' & [D_申請].[ID] AS [KEY], [D_申請].[名称],'Apply' AS [Icon], D_申請.総会番号,IIf(IsNull([受付補助記号]),[受付番号],[受付補助記号] & '-' & [受付番号]) AS [受付],[受付年月日],[通年受付番号],[D_申請].[小作料] & [小作料単位] AS [小作料],IIF(IsNull([AutoID]),'−','○') AS [土地管理情報の有無] FROM [D_申請] LEFT JOIN [D_土地管理] ON [D_申請].[ID] = [D_土地管理].[ID] WHERE ([法令] IN " & St & ") AND [状態]=0", Replace(SysAD.GetSettingData("農地基本台帳", "申請受付中リスト表示", ADApp.Common.AppData("申請受付中リスト表示")), ",", ";"), Replace(Me.Key, "受付中", "受付簿")
        End If
    End Sub

    Private Function CDataviewSK_DoCommand2(sCmd As String, Optional sParam As String = "") As Variant
        Dim St As String
        
        Select Case Fnc.GetKeyHead(Me.Key)
            Case "３条受付中": St = "(" & state3条所有権 & "," & state3条賃借権 & ")"
            Case "県３条受付中": St = "(" & state県3条所有権 & "," & state県3条賃借権 & ")"
            Case "４条受付中": St = "(" & state4条転用 & ")"
            Case "５条受付中": St = "(" & state5条所有権 & "," & state5条賃借権 & ")"
            Case "解約受付中": St = "(" & state20条解約 & "," & state合意解約 & ")"
            Case "利用権移転受付中": St = "(" & state基盤利用権移転 & ")"
            Case "利用権設定受付中": St = "(" & state基盤利用権設定 & ")"
            Case "所有権移転受付中": St = "(" & state基盤所有権設定 & ")"
            Case "所有権設定受付中": St = "(" & state基盤所有権設定 & ")"
            Case "農用地計画変更受付中": St = "(" & state農用地計画変更 & ")"
            Case "事業計画変更受付中": St = "(" & state事業計画変更 & ")"
         
            Case "奨励金受付中": St = "(" & state奨励金交付A & "," & state奨励金交付B & ")"
            Case "農地利用変更受付中": St = "(" & state農地利用変更 & ")"
            Case Else
                Exit Function
        End Select
        
        Select Case sCmd
            Case "受付簿"
                If SystemDB.DBProperty("支所番号") = "-1" Then
                    mvarPDW.SQLListview.SQLListviewCHead "SELECT '申請.' & [D_申請].[ID] AS [KEY], [D_申請].[名称],'Apply' AS [Icon], M_BASICALL.名称 AS 支所, D_申請.総会番号,IIf(IsNull([受付補助記号]),[受付番号],[受付補助記号] & '-' & [受付番号]) AS [受付], [受付年月日] FROM [D_申請] INNER JOIN M_BASICALL ON D_申請.支所番号 = M_BASICALL.ID WHERE [Class]='支所番号' AND ([法令] IN " & St & ") AND [状態]=0", "%5000,名称;名称;支所;支所;総会番号;総会番号;受付番号;受付;=受付年月日;受付年月日", Replace(Me.Key, "受付中", "受付簿")
                Else
                    mvarPDW.SQLListview.SQLListviewCHead "SELECT '申請.' & [D_申請].[ID] AS [KEY], [D_申請].[名称],'Apply' AS [Icon], D_申請.総会番号,IIf(IsNull([受付補助記号]),[受付番号],[受付補助記号] & '-' & [受付番号]) AS [受付], [受付年月日] FROM [D_申請] WHERE ([法令] IN " & St & ") AND [状態]=0", "%5000,名称;名称;総会番号;総会番号;受付番号;受付;=受付年月日;受付年月日", Replace(Me.Key, "受付中", "受付簿")
                End If
            Case "最下位置に移動する":
                SystemDB.ExecuteSQL "UPDATE S_Folder SET S_Folder.表示順序 = " & SystemDB.GetMaxCode("S_Folder", "表示順序") & " WHERE (((S_Folder.Key)=" & Me.Key & "));"
                mvarPDW.Folder.Redraw mvarPDW.Folder.ExpandedList
            Case Else
                Debug.Assert CaseAssertPrint(sCmd, "CFol各受付中_DoCommand2")
        End Select
    End Function

    Private Sub CDataviewSK_DropDown(sSourceList As String, Optional sOption As String = "")
        Dim Ar As Variant
        Dim pDV As CDataviewSK
        
        Ar = Split(sSourceList, ";")
        If UBound(Ar) > -1 Then
            Set pDV = ObjectMan.GetObjectDVP(CStr(Ar(0)))
            Select Case pDV.DVProperty.ClassStr & "-" & DVProperty.ClassStr
                Case "申請-３条受付中":
                    Select Case pDV.GetProperty2("法令")
                        Case 32: pDV.DVProperty.Rs.Update "法令", 30: SysAD.ApplicationDLL.Form.SQLListview.Refresh
                        Case 33: pDV.DVProperty.Rs.Update "法令", 31: SysAD.ApplicationDLL.Form.SQLListview.Refresh
                    End Select
                Case "申請-県３条受付中":
                    Select Case pDV.GetProperty2("法令")
                        Case 30: pDV.DVProperty.Rs.Update "法令", 32: SysAD.ApplicationDLL.Form.SQLListview.Refresh
                        Case 31: pDV.DVProperty.Rs.Update "法令", 33: SysAD.ApplicationDLL.Form.SQLListview.Refresh
                    End Select
                Case Else
                    MsgBox "この操作はサポートされていません", vbCritical
            End Select
        End If
    End Sub

    Private Function CDataviewSK_GetProperty2(sPropName As String, Optional sParam As String = "") As Variant
        Debug.Assert False 'Non Code
    End Function

    Private Property Get CDataviewSK_IconName() As String
        Debug.Assert False 'Non Code
    End Property

    Private Property Get CDataviewSK_IsUpdated() As Boolean: CDataviewSK_IsUpdated = DVProperty.Controls.IsUpdated: End Property

    '各DLL共通↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓
    Private Property Let CDataviewSK_Key(ByVal RHS As String): Me.Key = RHS: End Property
    Private Property Get CDataviewSK_Key() As String: CDataviewSK_Key = Me.Key: End Property
    '各DLL共通↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑


End Class


Class CMenu受付
    Option Explicit
    Implements ADBasicLIB2.CTabPage
    Private WithEvents mvarBody As ADBasicLIB2.CPictureBoxHelper
    
    Private WithEvents mvarGrid As ADBasicLIB2.CGridHelper
    Private WithEvents mvarTabS As ADBasicLIB2.CTabStripHelper
    Private WithEvents mvarToolBar As ADBasicLIB2.CToolBarHelper
    
    Private mvarTitle As String
    Private mvarSelectKey As String
    Private mvarRedrow As Boolean

    Private Sub CTabPage_Active(): End Sub

    Private Property Get CTabPage_Body() As Object
        Dim TB As MSComctlLib.Toolbar
        Dim OBJ As Object
        
        If mvarBody Is Nothing Then
            Set mvarTabS = New CTabStripHelper
            Set mvarToolBar = New CToolBarHelper

            Set mvarBody = New CPictureBoxHelper
            Set OBJ = mvarPDW.AddCtrlWithCode("受付BODY", "VB.PictureBox", mvarPDW.TabPages.Body)
            Set mvarBody.Body = OBJ
            With mvarBody
                .Appearance = 0
                .BorderStyle = 0
            End With
            
            Set OBJ = mvarBody.AddToolBarHelper("受付TOOLBAR", "受付TOOLBAR", "Align=2")
            Set mvarToolBar = mvarBody.CtrlCollection("受付TOOLBAR")
            mvarBody.AddGridHelper "受付GridCtl", "受付GridCtl", "BackColorBkg=64;AllowUserResizing=3"
            Set mvarGrid = mvarBody.CtrlCollection("受付GridCtl")
            If Not mvarToolBar.Body Is Nothing Then
                With mvarToolBar
                    .Style = tbrFlat
                    .Appearance = ccFlat
                    Set .ImageList = SysAD.MDIForm.LargeIcons
                    .ButtonsAdd(, "開く", "開く", 0, "Apply").Enabled = False
                    .ButtonsAdd(, "削除", "削除", 0, "IDelete").Enabled = False
                    .ButtonsAdd(, "許可", "許可", 1, "Apply").Enabled = False
                    .ButtonsAdd , , , 4
                    .ButtonsAdd , "申請入力", "申請入力", 0, "Apply"
                    .ButtonsAdd , , , 4
                    .ButtonsAdd , "議案書印刷", "議案書印刷", 0, "IPrinter"
                    .ButtonsAdd , "受付交付簿", "受付・交付簿", 0, "IPrinter"
                    .ButtonsAdd , , , 4
                    .ButtonsAdd(, "今回表示", "今回表示", 1, "Apply").Value = 1
                    .ButtonsAdd(, "受付表示", "受付表示", 1, "Apply").Value = 1
                    .ButtonsAdd(, "許可表示", "許可表示", 1, "Apply").Value = 1
                    
                    .Height = 900
                    .Visible = True
                End With
            End If
            With mvarTabS
                .AddCtrl "受付TAB", mvarPDW, mvarBody.Body
                .TabsClear
                .TabsAdd , "総会情報", "総会情報"
                .TabsAdd , "農地法３条", "農地法３条"
                .TabsAdd , "農地法４条", "農地法４条"
                .TabsAdd , "農地法５条", "農地法５条"
                .TabsAdd , "農地法20条", "農地法20条"
                .TabsAdd , "基盤法所有権", "基盤法所有権"
                .TabsAdd , "利用権設定", "利用権設定"
                .TabsAdd , "利用権移転", "利用権移転"
                .TabsAdd , "利用権解約", "利用権解約"
                
    
                
                If Fnc.s市町村名 = "南種子町" Then
                    .TabsAdd , "流動化奨励金", "流動化奨励金"
                End If
                .TabsAdd , "農地改良届", "農地改良届"
                .TabsAdd , "農用地利用変更(除外)", "農用地利用変更(除外)"
                .Visible = True
                .MultiRow = True
                .TabStyle = 1
                .Style = 0
                End With
            If Not mvarToolBar.Body Is Nothing Then
            End If
        End If
        
        mvarRedrow = True
        Set CTabPage_Body = mvarBody.Body
    End Property

    Private Function CTabPage_DoCommand(ByVal sCommand As String, pArray As Variant) As Variant

    End Function

    Private Sub CTabPage_Init(ByVal sParam As String, Optional ByVal sKey As String = "")
        mvarBody_Resize
    End Sub

    Private Property Let CTabPage_Key(ByVal RHS As String): End Property
    Private Property Get CTabPage_Key() As String: CTabPage_Key = "申請受付": End Property

    
    Private Property Set CTabPage_Parent(ByVal RHS As ADBasicLIB2.CTabPageCol)

    End Property

    Private Property Get CTabPage_Parent() As ADBasicLIB2.CTabPageCol

    End Property


    Private Sub CTabPage_Refresh(Optional ByVal sParam As String)
        ChangeTab
    End Sub

    Private Sub CTabPage_Remove()
        mvarPDW.RemoveCtrlwithCode "受付BODY"
        mvarPDW.RemoveCtrlwithCode "受付TOOLBAR"
        mvarPDW.RemoveCtrlwithCode "受付TAB"
        mvarPDW.RemoveCtrlwithCode "受付GridCtl"
    End Sub

    Private Property Let CTabPage_Title(ByVal RHS As String): End Property
    Private Property Get CTabPage_Title() As String: CTabPage_Title = "受付処理": End Property

    Private Sub CTabPage_ToExcel(Optional ByVal sFile As String, Optional sPaperSize As String, Optional nOrientation As Long = 0&)
        Debug.Assert False
    End Sub

    Private Property Get CTabPage_Visible() As Boolean: CTabPage_Visible = mvarBody.Visible: End Property
    Private Property Let CTabPage_Visible(ByVal RHS As Boolean): mvarBody.Visible = RHS: mvarBody_Resize: End Property

    Private Sub mvarBody_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)
        mvarBody_Resize
    End Sub

    Private Sub mvarBody_Resize()
        On Error Resume Next
        Dim H As Single
        H = 765
        If mvarTabS.Body Is Nothing Then Exit Sub
        If mvarToolBar.Height > H Then H = mvarToolBar.Height
        With mvarTabS
            .Move 0, 0, mvarBody.ScaleWidth, mvarBody.ScaleHeight - H
            mvarGrid.Move .ClientLeft, .ClientTop, .ClientWidth, .ClientHeight
        End With
        
        mvarToolBar.Move 0, mvarBody.ScaleHeight - H, mvarBody.ScaleWidth, H
    End Sub

    Private Sub mvarGrid_DblClick(ByVal MX As Long, ByVal MY As Long, ByVal Key As String)
        On Error Resume Next
        Dim pInputView As CInputView
        Select Case Val(SystemDB.DBProperty("申請書の入力画面"))
            Case True
                If Len(Key) = 0 Then
                ElseIf Not StrConv(Key, vbLowerCase) = "key" Then
                    Select Case mvarTabS.SelectedKey
                        Case "農地法３条": ADApp.DoCommand "農地法３条申請入力", Key
                        Case "農地法４条": ADApp.DoCommand "農地法４条申請入力", Key
                        Case "農地法５条": ADApp.DoCommand "農地法５条申請入力", Key
                        Case "農地法20条": ObjectMan.GetObject("申請入力").View "農地法20条." & Fnc.GetKeyCode(Key)
                        Case "基盤法所有権": ObjectMan.GetObject("申請入力").View "基盤法所有権." & Fnc.GetKeyCode(Key)
                        Case "利用権移転": ObjectMan.GetObject("申請入力").View "利用権移転." & Fnc.GetKeyCode(Key)
                        Case "利用権解約": ObjectMan.GetObject("申請入力").View "利用権解約." & Fnc.GetKeyCode(Key)
                        Case Else
                            Select Case Key
                                Case "総会番号": sub総会番号入力
                                Case "受付範囲":
                                Dim pDate As Date
                                    pDate = CDate(mvarGrid.TextMatrix(2, 1))
                                    If Fnc.InputDateEx("受付範囲", "申請の受付け範囲（開始日）を入力してください。", pDate) Then
                                        mvarGrid.TextMatrix(2, 1) = Format(pDate, "GGGEE年MM月DD日")
                                        ADApp.Common.AppData("受付範囲") = pDate
                                    End If
                                Case Else
                                    Debug.Assert CaseAssertPrint(mvarTabS.SelectedKey)
                            End Select
                    End Select
                End If
            Case False
'                If Not StrConv(Key, vbLowerCase) = "key" Then ObjectMan.GetObjectDVP(Key).DblClick
        End Select
    End Sub

    Private Sub sub総会番号入力()
        Dim St As String
        St = Fnc.InputText("総会番号", "今月の総会番号を入力してください", SystemDB.DBProperty("今月総会番号"), 1, vbIMEModeOff)
        If Val(St) > 0 Then
            SystemDB.DBProperty("今月総会番号") = Val(St)
            mvarGrid.TextMatrix(mvarGrid.Row, 1) = Val(St)
        End If
    End Sub

    Private Sub mvarGrid_PopupMenu(ByVal MX As Long, ByVal MY As Long, ByVal Key As String)
        Dim Dt As Date
        Select Case Key
            Case "総会番号": sub総会番号入力
            Case "受付範囲":
                Dt = ADApp.Common.AppData("受付範囲")
                If Fnc.InputDateEx("検索範囲", "検索範囲を入力してください", Dt) Then
                    ADApp.Common.AppData("受付範囲") = Dt
                    mvarGrid.TextMatrix(2, 1) = Format(Dt, "GGGEE年MM月DD日")
                End If
            Case Else
                If Len(Key) Then ObjectMan.GetObjectDVP(Key).PopupMenu
        End Select
        mvarPDW.TabPages("申請受付").Refresh
    End Sub

    Private Sub mvarGrid_RowColChange(ByVal MX As Long, ByVal MY As Long, ByVal Key As String)
    Dim B As Boolean
    If mvarRedrow Then
        mvarSelectKey = Key
        B = (InStr(mvarSelectKey, ".") > 0)
        mvarToolBar.ButtonsEnabled("開く") = B
        mvarToolBar.ButtonsEnabled("削除") = B
        mvarToolBar.ButtonsEnabled("許可") = B
    End If
    End Sub

    Private Sub ChangeTab()
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim s共通 As String
        Dim sWhere As String
        Dim sNow As String
        Dim sOrderBy As String
        Dim s農業委員 As String
        
        sWhere = ""
        If Not mvarToolBar.Body Is Nothing Then
            If Val(mvarToolBar.ButtonsValue("許可表示")) = 0 Then
                sWhere = sWhere & " AND [状態]<>2"
            End If
            If Val(mvarToolBar.ButtonsValue("受付表示")) = 0 Then
                sWhere = sWhere & " AND [状態]<>0"
            End If
            If Val(mvarToolBar.ButtonsValue("今回表示")) = 1 Then
                sWhere = " AND ([総会番号]=" & SystemDB.DBProperty("今月総会番号") & ") "
            End If
            
            If CDate(ADApp.Common.AppData("受付範囲")) <> 0 Then
                sWhere = sWhere & " AND [受付年月日]>CDate('" & ADApp.Common.AppData("受付範囲") & "') "
            End If
            
            If Val(SystemDB.DBProperty("申請書の昇順・降順")) Then
                sOrderBy = " ORDER BY [総会番号] DESC,[受付番号] DESC"
            Else
                sOrderBy = " ORDER BY [総会番号],[受付番号]"
            End If
            s共通 = "SELECT '申請.' & [D_申請].[ID] AS [KEY],IIF(IsNull([総会番号]),'00',Right$('000' & [総会番号],2)) & IIF(IsNull([受付補助記号]),'','-' & [受付補助記号]) &  '-' & IIF(IsNull([受付番号]),'00',Right$('000' & [受付番号],3)) & IIF(IsNull([通年受付番号]),'(0000)','(' & Right$('0000' & [通年受付番号],4) & ')')  AS [整理番号],Format$([受付年月日],'GGGEE年MM月DD日') AS [受付日],[氏名A] AS [申請者A],"
            s農業委員 = "SELECT [M_BASICALL].ID, [M_BASICALL].名称 FROM [M_BASICALL] WHERE [M_BASICALL].Class='農業委員'"
            With mvarTabS
                Select Case .SelectedKey
                    Case "総会情報": Set Rs = Nothing
                        With mvarGrid
                            .Clear
                            .Cols = 2
                            .Rows = 2
                            
                            .AddItem "総会番号"
                            .TextMatrix(.Rows - 1, 1) = SystemDB.DBProperty("今月総会番号")
                            .AddItem "受付範囲"
                            If CDate(ADApp.Common.AppData("受付範囲")) = 0 Then ADApp.Common.AppData("受付範囲") = DateSerial(Year(Now), Month(Now) - 1, Val(SystemDB.DBProperty("申請締切")) + 1)
                            .TextMatrix(.Rows - 1, 1) = Format(CDate(ADApp.Common.AppData("受付範囲")), "GGGEE年MM月DD日")
                            .RemoveRow 1
                            .FitWidthSize
                        End With
                    Case "農地法３条": Set Rs = SystemDB.GetRecordsetEx(s共通 & "[氏名B] AS [申請者B],[調査員A] AS [調査員],[V_申請状況].[名称] AS [申請状況] FROM [D_申請] LEFT JOIN [V_申請状況] ON [D_申請].[状態] = [V_申請状況].ID WHERE [法令] IN (30,31,32,33)" & sWhere & sOrderBy, , , Me)
    '                Case "農地法４条": Set Rs = SystemDB.GetRecordsetEx(s共通 & "[調査員A] AS [調査員],[V_申請状況].[名称] AS [申請状況] FROM [D_申請] LEFT JOIN [V_申請状況] ON [D_申請].[状態] = [V_申請状況].ID WHERE [法令]=40" & sWhere & sOrderBy, , , Me)
    '                Case "農地法５条": Set Rs = SystemDB.GetRecordsetEx(s共通 & "[氏名B] AS [申請者B],[調査員A] AS [調査員],[V_申請状況].[名称] AS [申請状況] FROM [D_申請] LEFT JOIN [V_申請状況] ON [D_申請].[状態] = [V_申請状況].ID WHERE [法令] IN (50,51)" & sWhere & sOrderBy, , , Me)
                    Case "農地法４条": Set Rs = SystemDB.GetRecordsetEx(s共通 & "[V_農業委員].[名称] AS [調査員],[V_申請状況].[名称] AS [申請状況] FROM ([D_申請] LEFT JOIN [V_申請状況] ON [D_申請].[状態] = [V_申請状況].ID) LEFT JOIN (" & s農業委員 & ") AS [V_農業委員] ON [D_申請].[調査員] = [V_農業委員].ID WHERE [法令]=40" & sWhere & sOrderBy, , , Me)
                    Case "農地法５条": Set Rs = SystemDB.GetRecordsetEx(s共通 & "[氏名B] AS [申請者B],[V_農業委員].[名称] AS [調査員],[V_申請状況].[名称] AS [申請状況] FROM ([D_申請] LEFT JOIN [V_申請状況] ON [D_申請].[状態] = [V_申請状況].ID) LEFT JOIN  (" & s農業委員 & ") AS [V_農業委員]  ON [D_申請].[調査員] = [V_農業委員].ID WHERE [法令] IN (50,51)" & sWhere & sOrderBy, , , Me)
                    Case "農地法20条": Set Rs = SystemDB.GetRecordsetEx(s共通 & "[氏名B] AS [申請者B],[V_申請状況].[名称] AS [申請状況] FROM [D_申請] LEFT JOIN [V_申請状況] ON [D_申請].[状態] = [V_申請状況].ID WHERE [法令]=200" & sWhere & sOrderBy, , , Me)
                    '301
                    Case "基盤法所有権": Set Rs = SystemDB.GetRecordsetEx(s共通 & "[氏名B] AS [申請者B] FROM [D_申請] WHERE [法令]=60" & sWhere & sOrderBy, , , Me)
                    Case "利用権設定": Set Rs = SystemDB.GetRecordsetEx(s共通 & "[氏名B] AS [申請者B],[V_申請状況].[名称] AS [申請状況] FROM [D_申請] LEFT JOIN [V_申請状況] ON [D_申請].[状態] = [V_申請状況].ID WHERE [法令]=61" & sWhere & sOrderBy, , , Me)
                    Case "利用権移転": Set Rs = SystemDB.GetRecordsetEx(s共通 & "[氏名B] AS [申請者B],[V_申請状況].[名称] AS [申請状況] FROM [D_申請] LEFT JOIN [V_申請状況] ON [D_申請].[状態] = [V_申請状況].ID WHERE [法令]=62" & sWhere & sOrderBy, , , Me)
                    Case "利用権解約": Set Rs = SystemDB.GetRecordsetEx(s共通 & "[氏名B] AS [申請者B] FROM [D_申請] WHERE [法令]=210" & sWhere & sOrderBy, , , Me)
                    Case "農地改良届": Set Rs = SystemDB.GetRecordsetEx(s共通 & "[調査員A] AS [調査員] FROM [D_申請] WHERE [法令]=301 ORDER BY [総会番号],[受付番号]", , , Me)
                    Case "農用地利用変更(除外)": Set Rs = SystemDB.GetRecordsetEx(s共通 & "[調査員A] AS [調査員] FROM [D_申請] WHERE [法令]=302 ORDER BY [総会番号],[受付番号]", , , Me)
                    Case "流動化奨励金": Set Rs = SystemDB.GetRecordsetEx(s共通 & "[住所A] AS [申請者住所] FROM [D_申請] WHERE [法令] IN (990,991)" & sWhere & sOrderBy, , , Me)
                    Case Else
                        Debug.Assert CaseAssertPrint(.SelectedKey)
                End Select
                If Rs Is Nothing Then
                Else
                    mvarGrid.SetRecordsetData Rs: SystemDB.CloseRs Rs
                End If
            End With
        End If
    End Sub

    Private Sub mvarTabS_Click(ByVal Key As String): ChangeTab: End Sub

    Private Sub mvarToolBar_Click(ByVal Key As String)
        Dim St As String
        Dim SX As String
        Dim s総会番号 As String
        Dim pInputView As CInputView
        Dim Ar As Variant
        Dim Cm As Variant
        Dim n As Long
        Dim Rs As ADBasicLIB2.RecordsetEx
        
        Select Case Key
            Case "開く":
                Select Case mvarTabS.SelectedKey
                    Case "総会情報"
                        If mvarGrid.Row = 1 Then sub総会番号入力
                    Case Else
                        If Len(mvarSelectKey) Then ObjectMan.GetObjectDVP(mvarSelectKey).DblClick
                End Select
            Case "議案書印刷": ObjectMan.GetObjectDVP("申請管理").DoCommand2 "議案書作成"
            Case "削除": If Len(Key) Then ObjectMan.GetObjectDVP(mvarSelectKey).DoCommand2 "削除"
            Case "許可":
                mvarRedrow = False
                For n = mvarGrid.RowSelStart To mvarGrid.RowSelEnd
                    ObjectMan.GetObjectDVP(mvarGrid.TextMatrix(n, 0)).DoCommand2 "まとめて許可"
                Next
                mvarRedrow = True
                ChangeTab
            Case "受付交付簿":
                St = mvarGrid.TextMatrix(mvarGrid.Row, 1)
                If Len(St) > 0 Then
                    s総会番号 = SystemDB.DBProperty("今月総会番号")
                    Select Case mvarTabS.SelectedKey
                        Case "農地法３条": mvarPDW.PrintGo ObjectMan.GetObject("受付交付簿３条"), s総会番号 & ";" & ADApp.Common.AppData("受付範囲")
                        Case "農地法４条": mvarPDW.PrintGo ObjectMan.GetObject("受付交付簿４条"), s総会番号 & ";" & ADApp.Common.AppData("受付範囲")
                        Case "農地法５条": mvarPDW.PrintGo ObjectMan.GetObject("受付交付簿５条"), s総会番号 & ";" & ADApp.Common.AppData("受付範囲")
                    End Select
                End If
            Case "今回表示": ChangeTab
            Case "受付表示": ChangeTab
            Case "許可表示": ChangeTab
            Case Else
                ADApp.DoCommand Key
        End Select
    End Sub

    Private Sub mvarToolBar_WordWrapp()
        mvarBody_Resize
    End Sub

End Class










Class CMenu集計一覧
    Option Explicit
    Implements ADBasicLIB2.CTabPage
    Implements CCtrlEventReceiver
    
    Private WithEvents mvarBody As VB.PictureBox
    Private WithEvents mvarPanel As VB.PictureBox
    
    Private mvarTitle As String
    Private mvarSelectKey As String
    Private mvarKey As String
    Private mvarUniqueCode As String
    Private WithEvents picHelper As CPictureBoxHelper
    Private WithEvents vsc As VB.VScrollBar
    Private WithEvents hsc As VB.HScrollBar

    Private Sub CCtrlEventReceiver_Change(ByVal Key As String, Optional ByVal Index As Long = -1&): End Sub
    Private Sub CCtrlEventReceiver_Click(ByVal Key As String, Optional ByVal Index As Long = -1&)
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim St As String
        Dim Ar As Variant
        Dim sSQL As String
        Dim Area As Currency
        Dim n As Long
        Dim pDic As CDataDictionary
        
        Select Case MID$(Key, Len(mvarUniqueCode) + 1)
            Case "貸借農地一覧", "小作農地所有状況一覧": mod農家台帳.view農地List "[自小作別]>0", MID$(Key, Len(mvarUniqueCode) + 1) '/** 農地0001-0001-0002
            Case "小作地所有集計": mvarPDW.SQLListview.SQLListviewCHead "SELECT '世帯員.' & [所有個人].[ID] AS [Key], 'Farmer' AS Icon, 所有個人.氏名, 所有個人.住所, Sum(V_農地.田面積) AS 田面積計, Sum(V_農地.畑面積) AS 畑面積計 FROM V_農地 INNER JOIN [D:個人Info] AS 所有個人 ON V_農地.管理人ID = 所有個人.ID WHERE (((V_農地.自小作別) > 0)) Group By '世帯員.' & [所有個人].[ID], 'Farmer', 所有個人.氏名, 所有個人.住所;", "氏名;氏名;住所;住所;@小作田面積;田面積計;@小作畑面積;畑面積計", "小作地所有集計"
            Case "農地経営世帯一覧"
                If MsgBox("再計算しますか", vbYesNo) = vbYes Then
                    If SystemDB.TableExists("wk世帯自作面積") Then SystemDB.Execute "DROP Table [wk世帯自作面積];"
                    If SystemDB.TableExists("wk世帯小作面積") Then SystemDB.Execute "DROP Table [wk世帯小作面積];"
                    SystemDB.Execute "SELECT [D:農地Info].所有世帯ID, Int(Sum([D:農地Info].田面積)) AS 田自, Int(Sum([D:農地Info].畑面積)) AS 畑自 INTO wk世帯自作面積 FROM [D:農地Info] WHERE ((([D:農地Info].自小作別) < 1) AND (([D:農地Info].農地状況) < 20)) GROUP BY [D:農地Info].所有世帯ID HAVING ((([D:農地Info].所有世帯ID)<>0));"
                    SystemDB.Execute "SELECT [D:農地Info].借受世帯ID, Int(Sum([D:農地Info].田面積)) AS 田借, Int(Sum([D:農地Info].畑面積)) AS 畑借 INTO wk世帯小作面積 FROM [D:農地Info] WHERE ((([D:農地Info].自小作別) > 0) AND (([D:農地Info].農地状況) < 20)) GROUP BY [D:農地Info].借受世帯ID HAVING ((([D:農地Info].借受世帯ID)<>0));"
                End If
                mvarPDW.SQLListview.SQLListviewCHead "SELECT '農家.' & [D:世帯Info].[ID] AS [Key], [D:個人Info].氏名, [D:個人Info].住所, wk世帯自作面積.田自, wk世帯自作面積.畑自, wk世帯小作面積.田借, wk世帯小作面積.畑借, IIf(IsNull([田自]),0,[田自])+IIf(IsNull([畑自]),0,[畑自])+IIf(IsNull([田借]),0,[田借])+IIf(IsNull([畑借]),0,[畑借]) AS 総計 FROM (wk世帯小作面積 RIGHT JOIN ([D:世帯Info] LEFT JOIN wk世帯自作面積 ON [D:世帯Info].ID = wk世帯自作面積.所有世帯ID) ON wk世帯小作面積.借受世帯ID = [D:世帯Info].ID) INNER JOIN [D:個人Info] ON [D:世帯Info].世帯主ID = [D:個人Info].ID WHERE (((IsNull([田自])+IsNull([畑自])+IsNull([田借])+IsNull([畑借]))>-4));", "氏名;氏名;住所;住所;@田自;田自;@畑自;畑自;@田借;田借;@畑借;畑借;@総計;総計", "農地経営世帯一覧"
            Case "年齢別耕作農地一覧"
                mvarPDW.WaitMessage = "集計中..."
                sSQL = "SELECT Year(Now())-Year([生年月日]) AS 年齢, Sum(Int(IIf([自小作別]=0,[V_農地].[田面積],0))) AS 自作田, Sum(Int(IIf([自小作別]=0,[V_農地].[畑面積],0))) AS 自作畑, Sum(Int(IIf([自小作別]=0,[V_農地].[田面積],0))+Int(IIf([自小作別]=0,[V_農地].[畑面積],0))) AS 自作計, Sum(Int(IIf([自小作別]>0,[V_農地].[田面積],0))) AS 小作田, Sum(Int(IIf([自小作別]>0,[V_農地].[畑面積],0))) AS 小作畑, Sum(Int(IIf([自小作別]>0,[V_農地].[田面積],0))+Int(IIf([自小作別]>0,[V_農地].[畑面積],0))) AS 小作計, Sum(Int(IIf([自小作別]=0,[V_農地].[田面積],0))+Int(IIf([自小作別]=0,[V_農地].[畑面積],0))+Int(IIf([自小作別]>0,[V_農地].[田面積],0))+Int(IIf([自小作別]>0,[V_農地].[畑面積],0))) AS 経営地計 " & _
                "FROM (V_農地 INNER JOIN [D:世帯Info] ON V_農地.耕作世帯ID = [D:世帯Info].ID) INNER JOIN [D:個人Info] ON [D:世帯Info].世帯主ID = [D:個人Info].ID " & _
                "WHERE ((([D:個人Info].生年月日) Is Not Null)) GROUP BY Year(Now())-Year([生年月日]) ORDER BY Year(Now())-Year([生年月日]);"
                
                Set Rs = SystemDB.GetRecordsetEx(sSQL, 0, , Me)
                
                Ar = Rs.FildeHeaders
                St = Rs.GetString
                Rs.CloseRs
                
                With mvarPDW.Gridview
                    .ClearAll
                    .Cols = UBound(Ar) + 1
                    .SetLine 0, 0, Join(Ar, vbTab), vbTab, vbCrLf
                    .AddLine 1, 0, St, vbTab, vbCrLf
                    .TextMatrix(.Rows - 1, 0) = "合計"
                    For n = 1 To .Cols - 1
                        .Sum 1, n, .Rows - 2, n, .Rows - 1, n, "#,##0"
                    Next
                    .FitWidth
                End With
                
                Set mvarPDW.TabPages.SelectedItem = mvarPDW.Gridview
                mvarPDW.TabPages.SelectedItem.Title = "年齢別耕作農地一覧"
                mvarPDW.WaitMessage = ""
            Case "開始年度別利用権"
                SetGridView("SELECT Year([小作開始年月日]) AS 開始年, Sum(Sgn([田面積])) AS 田筆数, Sum([D:農地Info].田面積) AS 田面積の合計, Sum(Sgn([畑面積])) AS 畑筆数, Sum([D:農地Info].畑面積) AS 畑面積の合計, Sum(Sgn([樹園地])) AS 樹筆数, Sum([D:農地Info].樹園地) AS 樹園地の合計 FROM [D:農地Info] GROUP BY Year([小作開始年月日]) HAVING (((Year([小作開始年月日]))>1899));", "", "", "合計;Sum;Sum;Sum").Title = "開始年度別利用権"
            Case "集落別選挙有資格世帯数"
                mvarPDW.WaitMessage = "集計中..."
                Set Rs = SystemDB.GetRecordsetEx("SELECT X.NID AS コード,X.行政区 AS 行政区名, Count(X.ID) AS 有選挙権世帯数  " & _
                "FROM (SELECT [V_行政区].ID AS NID,[V_行政区].行政区, [D:世帯Info].ID " & _
                "FROM ([D:個人Info] INNER JOIN [D:世帯Info] ON [D:個人Info].世帯ID = [D:世帯Info].ID) INNER JOIN [V_行政区] ON [D:個人Info].行政区ID = [V_行政区].ID " & _
                "WHERE ((([D:個人Info].選挙権の有無)=True)) " & _
                "GROUP BY [V_行政区].ID,[V_行政区].行政区, [D:世帯Info].ID" & _
                ") AS X GROUP BY X.NID,X.行政区 ORDER BY X.NID;", , , Me)
                
                Ar = Rs.FildeHeaders
                St = Rs.GetString
                SystemDB.CloseRs Rs
                
                With mvarPDW.Gridview
                    .ClearAll
                    .Cols = UBound(Ar) + 1
                    .SetLine 0, 0, Join(Ar, vbTab), vbTab, vbCrLf
                    .AddLine 1, 0, St, vbTab, vbCrLf
                    .Sum 1, 2, .Rows - 2, 2, .Rows - 1, 2, "#,##0"
                    .FitWidth
                End With
                
                Set mvarPDW.TabPages.SelectedItem = mvarPDW.Gridview
                mvarPDW.TabPages.SelectedItem.Title = "集落別選挙有資格世帯数"
                mvarPDW.WaitMessage = ""
            Case "死亡借受農地一覧"
                St = SystemDB.DBProperty("死亡住民コード")
                Do Until Val(St) <> 0
                    St = Fnc.InputText("死亡住民コード", "死亡住民を示すコードを入力してください｡", -99, 1)
                    If St = "" Then Exit Sub
                Loop
                n = Val(St)
                St = "SELECT '農地.' & [V_農地].[ID] AS [Key], V_農地.土地所在, [D:個人Info].氏名 AS 借受者, [D:個人Info].住所"
                St = St & " FROM V_農地 INNER JOIN [D:個人Info] ON V_農地.借受人ID = [D:個人Info].ID"
                St = St & " WHERE ((([D:個人Info].住民区分)=" & n & ") AND ((V_農地.自小作別)=True));"
                mvarPDW.SQLListview.SQLListviewCHead St, "土地所在;土地所在;借受者;借受者;住所;住所", "死亡借受農地一覧"
            Case "集落別選挙有資格者数"
                mvarPDW.WaitMessage = "集計中..."
                Set Rs = SystemDB.GetRecordsetEx("SELECT [V_行政区].ID AS コード, [V_行政区].行政区, Sum(-([性別]=0)) AS 男, Sum(-([性別]=1)) AS 女, Sum(1) AS 計 " & _
                "FROM ([D:個人Info] INNER JOIN V_行政区 ON [D:個人Info].行政区ID = V_行政区.ID) INNER JOIN [D:世帯Info] ON [D:個人Info].世帯ID = [D:世帯Info].ID " & _
                "GROUP BY [V_行政区].ID, [V_行政区].行政区, [D:個人Info].選挙権の有無 " & _
                "HAVING ((([D:個人Info].選挙権の有無)=True)) " & _
                "ORDER BY [V_行政区].ID;", , , Me)
                
                Ar = Rs.FildeHeaders
                St = Rs.GetString
                SystemDB.CloseRs Rs
                
                With mvarPDW.Gridview
                    .ClearAll
                    .Cols = UBound(Ar) + 1
                    .SetLine 0, 0, Join(Ar, vbTab), vbTab, vbCrLf
                    .AddLine 1, 0, St, vbTab, vbCrLf
                    .Sum 1, 2, .Rows - 2, 2, .Rows - 1, 2, "#,##0"
                    .Sum 1, 3, .Rows - 2, 3, .Rows - 1, 3, "#,##0"
                    .Sum 1, 4, .Rows - 2, 4, .Rows - 1, 4, "#,##0"
                    .FitWidth
                End With
                Set mvarPDW.TabPages.SelectedItem = mvarPDW.Gridview
                mvarPDW.TabPages.SelectedItem.Title = "集落別選挙有資格者数"
                mvarPDW.WaitMessage = ""
            Case "大字別農地集計"
                SetGridView("SELECT V_大字.名称 AS 大字名, Sum(Int([田面積])) AS 田合計, Sum(Int([畑面積])) AS 畑合計, Sum(Int([樹園地])) AS 樹園地合計, Sum(Int([田面積])+Int([畑面積])+Int([樹園地])) AS 農地計 " & _
                "FROM V_農地 INNER JOIN V_大字 ON V_農地.大字ID = V_大字.ID " & _
                "GROUP BY V_大字.ID, V_大字.名称 HAVING (((V_大字.ID)>0)) " & _
                "ORDER BY V_大字.ID;", "大字名,大字名;田合計,田合計;畑合計,畑合計;樹園地合計,樹園地合計;農地計,農地計", "開始年,開始年;田筆数,田筆数;田面積の合計,田面積の合計;畑筆数,畑筆数;畑面積の合計,畑面積の合計;樹筆数,樹筆数;樹園地の合計,樹園地の合計", "合計;Sum;Sum;Sum;Sum").Title = "大字別農地集計"
            Case "世帯と世帯主の情報エラー"
                Debug.Assert False
            Case "地区別世帯件数集計": mvarPDW.PrintGo ADApp.ObjectMan.GetObject("地区別世帯件数集計"), "地区別世帯件数集計"
            Case "後継者状況別世帯件数集計表": mvarPDW.PrintGo ADApp.ObjectMan.GetObject("後継者状況別世帯件数集計表"), "後継者状況別世帯件数集計表"
            Case "60歳以上の農業従事者"
                sSQL = "SELECT '世帯員.' & [D:個人Info].[ID] AS [Key], [D:個人Info].フリガナ, [D:個人Info].氏名, [D:個人Info].住所, IIf([D:個人Info].[性別]=0,'男',IIf([D:個人Info].[性別]=1,'女','-')) AS 性別, [D:個人Info].生年月日, Val(IIf([生年月日]>0,IIf(DateAdd('yyyy',DateDiff('yyyy',[生年月日],Now()),[生年月日])>Now(),DateDiff('yyyy',[生年月日],Now())-1,DateDiff('yyyy',[生年月日],Now())),'-')) AS 年齢, Sum(Int([V_農地].[田面積])) AS 田面積, Sum(Int([V_農地].[畑面積])) AS 畑面積,Sum(Int([V_農地].[田面積])+Int([V_農地].[畑面積])) AS [農地計]" & _
                "FROM [D:個人Info] INNER JOIN V_農地 ON [D:個人Info].ID = V_農地.耕作者ID " & _
                "WHERE (((Int([V_農地].[田面積])+Int([V_農地].[畑面積]))>0))" & _
                "GROUP BY '世帯員.' & [D:個人Info].[ID], [D:個人Info].フリガナ, [D:個人Info].氏名, [D:個人Info].住所, IIf([D:個人Info].[性別]=0,'男',IIf([D:個人Info].[性別]=1,'女','-')), [D:個人Info].生年月日, Val(IIf([生年月日]>0,IIf(DateAdd('yyyy',DateDiff('yyyy',[生年月日],Now()),[生年月日])>Now(),DateDiff('yyyy',[生年月日],Now())-1,DateDiff('yyyy',[生年月日],Now())),'-')) " & _
                "HAVING (((Val(IIf([生年月日]>0,IIf(DateAdd('yyyy',DateDiff('yyyy',[生年月日],Now()),[生年月日])>Now(),DateDiff('yyyy',[生年月日],Now())-1,DateDiff('yyyy',[生年月日],Now())),'-')))>=60)) " & _
                "ORDER BY [D:個人Info].フリガナ;"
                mvarPDW.SQLListview.SQLListviewCHead sSQL, "氏名;氏名;フリガナ;フリガナ;住所;住所;性別;性別;生年月日;生年月日;@年齢;年齢;@田面積;田面積;@畑面積;畑面積;@農地計;農地計", "60歳以上の農業従事者一覧"
            Case "集落別耕作世帯集計"
                sSQL = "SELECT V_行政区.名称 AS [行政区名], Count(耕作世帯.ID) AS 世帯数, Sum(耕作世帯.田面積の合計) AS 田耕作面積, Sum(耕作世帯.畑面積の合計) AS 畑耕作面積 FROM " & _
                "(SELECT [D:世帯Info].ID, [D:個人Info].行政区ID, Sum(Int(V_農地.田面積)) AS 田面積の合計, Sum(Int(V_農地.畑面積)) AS 畑面積の合計 FROM (V_農地 INNER JOIN [D:世帯Info] ON V_農地.耕作世帯ID = [D:世帯Info].ID) INNER JOIN [D:個人Info] ON [D:世帯Info].世帯主ID = [D:個人Info].ID " & _
                "WHERE ((([V_農地].[田面積] + [V_農地].[畑面積]) > 0)) GROUP BY [D:世帯Info].ID, [D:個人Info].行政区ID HAVING ((([D:個人Info].行政区ID)>0))) AS [耕作世帯] " & _
                "INNER JOIN V_行政区 ON 耕作世帯.行政区ID = V_行政区.ID GROUP BY V_行政区.ID, V_行政区.名称 ORDER BY V_行政区.ID;"
                SetGridView(sSQL, "行政区名,行政区名;世帯数,世帯数;田耕作面積u,田耕作面積;畑耕作面積u,畑耕作面積", "", "合計;Sum;Sum;Sum").Title = "集落別耕作世帯集計"
            Case "小作形態別集計": mvarPDW.PrintGo ADApp.ObjectMan.GetObject("小作形態別集計"), "小作形態別集計"
            Case "面積別集計"
                sSQL = "SELECT IIf([田面積]+[畑面積]<1000,'  10アール 未満',Right$('   ' & Fix(([田面積]+[畑面積])/1000)*10,4) & 'アール以上') AS 面積, Sum(IIf([田面積]>0,1,0)) AS 田筆数, Sum(IIf([畑面積]>0,1,0)) AS 畑筆数, Count([D:農地Info].ID) AS 筆数合計 " & _
                "FROM [D:農地Info] " & _
                "GROUP BY IIf([田面積]+[畑面積]<1000,'  10アール 未満',Right$('   ' & Fix(([田面積]+[畑面積])/1000)*10,4) & 'アール以上') " & _
                "ORDER BY IIf([田面積]+[畑面積]<1000,'  10アール 未満',Right$('   ' & Fix(([田面積]+[畑面積])/1000)*10,4) & 'アール以上');"
                SetGridView(sSQL, "面積,面積;田筆数,田筆数;畑筆数,畑筆数;筆数計,筆数合計", "", "合計;Sum;Sum;Sum").Title = "面積別集計"
            Case "現況地目別集計"
                sSQL = "SELECT V_地目.ID, V_地目.名称 AS 現況地目,Count([V_地目].[ID]) AS 筆数, Sum(Int([畑面積])+Int([田面積])) AS 耕作面積 " & _
                "FROM V_農地 INNER JOIN V_地目 ON V_農地.現況地目 = V_地目.ID " & _
                "GROUP BY V_地目.ID, V_地目.名称 ORDER BY V_地目.ID;"
                SetGridView(sSQL, "現況地目,現況地目;筆数,筆数;耕作面積,耕作面積", "", "合計;Sum;Sum").Title = "現況地目別集計"
            Case "登記地目別集計"
                sSQL = "SELECT V_地目.ID, V_地目.名称 AS 登記地目,Count([V_地目].[ID]) AS 筆数, Sum(Int([畑面積])+Int([田面積])) AS 耕作面積 " & _
                "FROM V_農地 INNER JOIN V_地目 ON V_農地.登記簿地目 = V_地目.ID " & _
                "GROUP BY V_地目.ID, V_地目.名称 ORDER BY V_地目.ID;"
                SetGridView(sSQL, "登記地目,登記地目;筆数,筆数;耕作面積,耕作面積", "", "合計;Sum;Sum").Title = "登記地目別集計"
            Case "経営規模別世帯集計"
                sSQL = "SELECT IIf(Fix([世帯経営面積]/1000)>0,Right$('   ' & Fix([世帯経営面積]/1000)*10,4) & 'アール以上','  10 アール未満') AS 経営規模, Count(世帯経営.ID) AS 世帯数 FROM (SELECT [D:世帯Info].ID, Sum([V_農地].[田面積]+[V_農地].[畑面積]) AS 世帯経営面積 " & _
                "FROM V_農地 INNER JOIN [D:世帯Info] ON V_農地.耕作世帯ID = [D:世帯Info].ID GROUP BY [D:世帯Info].ID ) AS 世帯経営 " & _
                "GROUP BY IIf(Fix([世帯経営面積]/1000)>0,Right$('   ' & Fix([世帯経営面積]/1000)*10,4) & 'アール以上','  10 アール未満') " & _
                "ORDER BY IIf(Fix([世帯経営面積]/1000)>0,Right$('   ' & Fix([世帯経営面積]/1000)*10,4) & 'アール以上','  10 アール未満')"
                SetGridView(sSQL, "経営規模,経営規模;世帯数,世帯数", "", "合計;Sum").Title = "経営規模別世帯集計"

    '_/_/リストビュー_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
    '_/_/確認済み_/_/_/_/_/_/_/_/_/_/
            Case "貸借集計"
                sSQL = "SELECT IIf([小作地適用法]=1,'農地法',IIf([小作地適用法],'基盤強化法','その他')) AS 法令, V_農地.小作地適用法, V_農地.小作形態, IIf([小作形態]=1,'賃貸借',IIf([小作形態]=2,'使用貸借','その他')) AS 形態, IIf(DateDiff('yyyy',[小作開始年月日],[小作終了年月日])>0,DateDiff('yyyy',[小作開始年月日],[小作終了年月日]),Null) AS 期間, Format$(Sum(Int([田面積])),'#,##0') AS 田面積の合計, Format$(Sum(Int([畑面積])),'#,##0') AS 畑面積の合計 FROM V_農地 WHERE (((V_農地.自小作別)>0)) " & _
                "GROUP BY IIf([小作地適用法]=1,'農地法',IIf([小作地適用法],'基盤強化法','その他')), V_農地.小作地適用法, V_農地.小作形態, IIf([小作形態]=1,'賃貸借',IIf([小作形態]=2,'使用貸借','その他')), IIf(DateDiff('yyyy',[小作開始年月日],[小作終了年月日])>0,DateDiff('yyyy',[小作開始年月日],[小作終了年月日]),Null), V_農地.小作地適用法, V_農地.小作形態, IIf(DateDiff('yyyy',[小作開始年月日],[小作終了年月日])>0,DateDiff('yyyy',[小作開始年月日],[小作終了年月日]),Null) " & _
                "ORDER BY V_農地.小作地適用法, V_農地.小作形態, IIf(DateDiff('yyyy',[小作開始年月日],[小作終了年月日])>0,DateDiff('yyyy',[小作開始年月日],[小作終了年月日]),Null), V_農地.小作地適用法, V_農地.小作形態, IIf(DateDiff('yyyy',[小作開始年月日],[小作終了年月日])>0,DateDiff('yyyy',[小作開始年月日],[小作終了年月日]),Null);"
                SetGridView(sSQL, "法令,法令;形態,形態;期間,期間;田面積計u,田面積の合計;畑面積計u,畑面積の合計", "", "合計;空白;空白;Sum;Sum").Title = "貸借集計"
    '＿／未確認＿／＿／＿／＿／＿／＿／＿／＿／＿／＿／＿／＿／
            Case "面積未設定エラー": view農地List "((([V_農地].現況地目) In (" & SystemDB.DBProperty("田地目") & "," & SystemDB.DBProperty("畑地目") & ")) AND (([V_農地].田面積)=0) AND (([V_農地].畑面積)=0))", "面積の設定されていない田畑" '/** 農地0001-0001-0002


    '_/_/リストビュー_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
    '_/_/確認済み＿／＿／＿／＿／＿／＿／＿／＿／＿／＿／＿／＿／
            Case "集落別集計農地関係者":
                mvarPDW.SQLListview.SQLListviewCHead "SELECT '行政区.' & [V_行政区].ID AS [KEY], [V_行政区].行政区, Sum([D:農地Info].田面積) AS 自作地田面積, Sum([D:農地Info].畑面積) AS 自作地畑面積, Sum([D:農地Info_1].田面積) AS 小作地田面積, Sum([D:農地Info_1].畑面積) AS 小作地畑面積, Sum([D:農地Info_2].田面積) AS 貸付地田面積, Sum([D:農地Info_2].畑面積) AS 貸付地畑面積" & _
                " FROM [D:農地Info] AS [D:農地Info_2] RIGHT JOIN ((([D:世帯Info] INNER JOIN [V_行政区] ON [D:世帯Info].行政区ID = [V_行政区].ID) LEFT JOIN [D:農地Info] ON [D:世帯Info].ID = [D:農地Info].所有世帯ID) LEFT JOIN [D:農地Info] AS [D:農地Info_1] ON [D:世帯Info].ID = [D:農地Info_1].借受世帯ID) ON [D:農地Info_2].所有世帯ID = [D:世帯Info].ID" & _
                " WHERE ((([D:農地Info].自小作別)=0 Or ([D:農地Info].自小作別) Is Null) AND (([D:農地Info_1].自小作別)>0 Or ([D:農地Info_1].自小作別) Is Null) AND (([D:農地Info_2].自小作別)>0 Or ([D:農地Info_2].自小作別) Is Null))" & _
                " GROUP BY [V_行政区].ID, [V_行政区].行政区" & _
                " HAVING ((([V_行政区].ID)>0));", "行政区;行政区;#自作地田面積u;自作地田面積;#自作地畑面積u;自作地畑面積;#小作地田面積u;小作地田面積;#小作地畑面積u;小作地畑面積;#貸付地田面積u;貸付地田面積;#貸付地畑面積u;貸付地畑面積", "集落別集計農地関係者"
            Case "１０ａ以上農家一覧":
                sSQL = "SELECT '農家.' & [V_農地].耕作世帯ID AS [KEY], V_農地.耕作世帯ID, Sum(Int([V_農地].[田面積]+[V_農地].[畑面積])) AS 面計, [D:個人Info].氏名, [V_行政区].行政区, [D:個人Info].住所 " & _
                "FROM ([D:個人Info] INNER JOIN (V_農地 INNER JOIN [D:世帯Info] ON V_農地.耕作世帯ID = [D:世帯Info].ID) ON [D:個人Info].ID = [D:世帯Info].世帯主ID) INNER JOIN [V_行政区] ON [D:個人Info].行政区ID = [V_行政区].ID " & _
                "GROUP BY '農家.' & [V_農地].耕作世帯ID, V_農地.耕作世帯ID, [D:個人Info].氏名, [V_行政区].行政区, [D:個人Info].住所, [V_行政区].ID, [D:個人Info].フリガナ " & _
                "HAVING (((Sum(Int([V_農地].[田面積]+[V_農地].[畑面積])))>=1000)) " & _
                "ORDER BY [V_行政区].ID, [D:個人Info].フリガナ;"
                mvarPDW.SQLListview.SQLListviewCHead sSQL, "集落;行政区;氏名;氏名;住所;住所;@農家台帳登載面積(u);面計", "10a以上農家一覧"
    '＿／未確認＿／＿／＿／＿／＿／＿／＿／＿／＿／＿／＿／＿／
            Case "利用権設定面積":
                sSQL = "SELECT IIf([小作形態]=3,'期間借地',IIf([小作形態]=2,'使用貸借',IIf([小作形態]=1,'賃貸借'))) AS 形態, Sum(Int([田面積])) AS 田計, Sum(Int([畑面積])) AS 畑計, Sum(Int([樹園地])) AS 樹園地計, Sum(Int([田面積]+[畑面積]+[樹園地])) AS 農地計 " & _
                "FROM [D:農地Info] " & _
                "WHERE ((([D:農地Info].自小作別) > 0) And (([D:農地Info].小作地適用法) = 2)) " & _
                "GROUP BY [D:農地Info].小作形態, IIf([小作形態]=3,'期間借地',IIf([小作形態]=2,'使用貸借',IIf([小作形態]=1,'賃貸借'))) " & _
                "ORDER BY [D:農地Info].小作形態;"
                mvarPDW.SQLListview.SQLListviewCHead sSQL, "形態;形態;@田計;田計;@畑計;畑計;@樹園地計;樹園地計;@農地計;農地計", "利用権設定面積"
            Case "利用権設定筆数":
                sSQL = "SELECT IIf([小作形態]=3,'期間借地',IIf([小作形態]=2,'使用貸借',IIf([小作形態]=1,'賃貸借'))) AS 形態, Sum(Sgn([田面積])) AS 田計, Sum(Sgn([畑面積])) AS 畑計, Sum(Sgn([樹園地])) AS 樹園地計, Sum(Sgn([田面積]+[畑面積]+[樹園地])) AS 農地計 " & _
                "FROM [D:農地Info] " & _
                "WHERE ((([D:農地Info].自小作別) > 0) And (([D:農地Info].小作地適用法) = 2)) " & _
                "GROUP BY [D:農地Info].小作形態, IIf([小作形態]=3,'期間借地',IIf([小作形態]=2,'使用貸借',IIf([小作形態]=1,'賃貸借'))) " & _
                "ORDER BY [D:農地Info].小作形態;"
                mvarPDW.SQLListview.SQLListviewCHead sSQL, "形態;形態;@田計;田計;@畑計;畑計;@樹園地計;樹園地計;@農地計;農地計", "利用権設定筆数"
            Case "指定面積以上農家一覧":
                Set pDic = SysAD.MDIForm.InputMulti("経営面積指定の一覧", "経営面積の上下限を入力してください。", "下限面積(u);数値;1000|上限面積(u);数値;99999999")
                If Not pDic Is Nothing Then
                    sSQL = "SELECT '農家.' & [V_農地].耕作世帯ID AS [KEY], V_農地.耕作世帯ID, Sum(Int([V_農地].[田面積]+[V_農地].[畑面積]+[V_農地].[樹園地])) AS 面計,Sum(Int([V_農地].[田面積])) AS 田面計,Sum(Int([V_農地].[畑面積])) AS 畑面計,Sum(Int([V_農地].[樹園地])) AS 樹園地計, [D:個人Info].氏名, [V_行政区].行政区, [D:個人Info].住所 " & _
                    "FROM ([D:個人Info] INNER JOIN (V_農地 INNER JOIN [D:世帯Info] ON V_農地.耕作世帯ID = [D:世帯Info].ID) ON [D:個人Info].ID = [D:世帯Info].世帯主ID) INNER JOIN [V_行政区] ON [D:個人Info].行政区ID = [V_行政区].ID " & _
                    "GROUP BY '農家.' & [V_農地].耕作世帯ID, V_農地.耕作世帯ID, [D:個人Info].氏名, [V_行政区].行政区, [D:個人Info].住所, [V_行政区].ID, [D:個人Info].フリガナ " & _
                    "HAVING (((Sum(Int([V_農地].[田面積]+[V_農地].[畑面積]+[V_農地].[樹園地])))>=" & pDic.Item("下限面積(u)") & ")) AND (((Sum(Int([V_農地].[田面積]+[V_農地].[畑面積]+[V_農地].[樹園地])))<=" & pDic.Item("上限面積(u)") & ")) " & _
                    "ORDER BY [V_行政区].ID, [D:個人Info].フリガナ;"
                    mvarPDW.SQLListview.SQLListviewCHead sSQL, "集落;行政区;氏名;氏名;住所;住所;@農家台帳登載面積;面計;@田面計;田面計;@畑面計;畑面計;@樹園地計;樹園地計", "指定面積以上農家一覧"
                End If
            Case "貸付希望地一覧": view農地List "[貸付希望]=TRUE", "貸付希望地一覧" '/** 農地0001-0001-0002
            Case "売渡希望地一覧": view農地List "[売渡希望]=TRUE", "売渡希望地一覧" '/** 農地0001-0001-0002
            Case "規模拡大希望世帯一覧": view世帯List "WHERE [規模拡大希望]=TRUE", "規模拡大希望世帯一覧" '/** 農地0001-0001-0001
            Case "法人化希望世帯一覧": view世帯List "WHERE [法人化希望]=TRUE", "法人化希望世帯一覧" '/** 農地0001-0001-0001
            Case "基本集計"
                With mvarPDW.Gridview
                    .ClearAll
                    mvarPDW.WaitMessage = "集計中..."
                    .Cols = 9
                    .Rows = 8
                    
                    .TextMatrix(1, 1) = "農家(" & SystemDB.DBProperty("市町村種別") & "内)"
                    Set Rs = SystemDB.GetRecordsetEx("SELECT Count([D:世帯Info].ID) AS 総数 FROM [D:世帯Info] INNER JOIN [D:個人Info] ON [D:世帯Info].世帯主ID = [D:個人Info].ID WHERE ((([D:世帯Info].農地との関連)=True) AND (([D:個人Info].住民区分)=" & SystemDB.DBProperty("記録住民コード") & "));", 0, , Me)
                    If Not Rs.EOF Then
                        .TextMatrix(2, 2) = "農家世帯数(" & SystemDB.DBProperty("市町村種別") & "内)"
                        .TextMatrix(2, 3) = Rs.Value("総数")
                        .TextMatrix(2, 4) = "戸"
                    End If
                    Rs.CloseRs
            
                    Set Rs = SystemDB.GetRecordsetEx("SELECT Count([D:世帯Info].ID) AS 総数 FROM [D:世帯Info] INNER JOIN [D:個人Info] ON [D:世帯Info].ID = [D:個人Info].世帯ID WHERE ((([D:世帯Info].農地との関連)=True) AND (([D:個人Info].住民区分)=" & SystemDB.DBProperty("記録住民コード") & "));", 0, , Me)
                    If Not Rs.EOF Then
                        .TextMatrix(3, 2) = "農家人口(" & SystemDB.DBProperty("市町村種別") & "内)"
                        .TextMatrix(3, 3) = Rs.Value("総数")
                        .TextMatrix(3, 4) = "人"
                    End If
                    Rs.CloseRs
            
                    .TextMatrix(4, 1) = "農地(" & SystemDB.DBProperty("市町村種別") & "内)"
                    
                    Set Rs = SystemDB.GetRecordsetEx("SELECT Sum(-([田面積]>0)) AS 筆数, Sum([D:農地Info].田面積) AS 田面積の合計 FROM [D:農地Info] WHERE ((([D:農地Info].大字ID)<>-1) AND ((([農地状況]<=19))=True)) HAVING (((Sum([D:農地Info].田面積))>0));", 0, , Me)
                    If Not Rs.EOF Then
                        .TextMatrix(5, 2) = "田"
                        .TextMatrix(5, 3) = Rs.Value("筆数")
                        .TextMatrix(5, 4) = "筆"
                        .TextMatrix(5, 5) = FormatNumber(Rs.Value("田面積の合計") / 10000, 2)
                        .TextMatrix(5, 6) = "f"
                        .TextMatrix(5, 7) = FormatNumber(Rs.Value("田面積の合計"), 2)
                        .TextMatrix(5, 8) = "u"
                        Area = Rs.Value("田面積の合計")
                    End If
                    Rs.CloseRs
            
                    Set Rs = SystemDB.GetRecordsetEx("SELECT Sum(-([畑面積]>0)) AS 筆数, Sum([D:農地Info].畑面積) AS 畑面積の合計 FROM [D:農地Info] WHERE ((([D:農地Info].大字ID)<>-1) AND ((([農地状況]<=19))=True)) HAVING (((Sum([D:農地Info].畑面積))>0));", 0, , Me)
                    If Not Rs.EOF Then
                        .TextMatrix(6, 2) = "畑"
                        .TextMatrix(6, 3) = Rs.Value("筆数")
                        .TextMatrix(6, 4) = "筆"
                        .TextMatrix(6, 5) = FormatNumber(Rs.Value("畑面積の合計") / 10000, 2)
                        .TextMatrix(6, 6) = "f"
                        .TextMatrix(6, 7) = FormatNumber(Rs.Value("畑面積の合計"), 2)
                        .TextMatrix(6, 8) = "u"
                        Area = Area + Rs.Value("畑面積の合計")
                    End If
                    Rs.CloseRs
            '
                    .TextMatrix(7, 2) = "計"
                    .TextMatrix(7, 3) = Val(.TextMatrix(5, 3)) + Val(.TextMatrix(6, 3))
                    .TextMatrix(7, 4) = "筆"
                    .TextMatrix(7, 5) = FormatNumber(Area, 2)
                    .TextMatrix(7, 6) = "f"
                    .TextMatrix(7, 5) = FormatNumber(Area / 10000, 2)
                    .TextMatrix(7, 6) = "f"
                    .TextMatrix(7, 7) = FormatNumber(Area, 2)
                    .TextMatrix(7, 8) = "f"
                    
                    mvarPDW.WaitMessage = ""
                    .FitWidth
                End With
                Set mvarPDW.TabPages.SelectedItem = mvarPDW.Gridview
                mvarPDW.TabPages.SelectedItem.Title = "台帳基本集計"
            Case "遊休農地一覧"
                mvarPDW.SQLListview.SQLListviewCHead "SELECT '農地.' & [V_農地].[ID] AS [KEY], Format$([遊休時期],'gggee') & '年調査' AS 調査時期, V_農地.土地所在, V_農地.田面積, V_農地.畑面積, [D:個人Info].氏名 AS 所有者 " & _
                "FROM V_農地 INNER JOIN [D:個人Info] ON V_農地.所有者ID = [D:個人Info].ID WHERE (((V_農地.遊休化)=True)) ORDER BY Format$([遊休時期],'gggee') & '年調査', V_農地.土地所在;", "土地所在;土地所在;調査時期;調査時期;@田面積;田面積;@畑面積;畑面積;所有者;所有者", "遊休農地一覧"
            Case "農地状況別農地一覧"
                mvarPDW.SQLListview.SQLListviewCHead "SELECT '農地.' & [V_農地].[ID] AS [KEY], V_農地.土地所在, V_農地.田面積, V_農地.畑面積, V_農地.樹園地, V_農地.採草放牧面積, [D:個人Info].氏名 AS 所有者, [D:個人Info].住所 AS 所有者住所, V_住民区分.名称 AS 所有者区分, M_BASICALL.名称 FROM ((V_農地 INNER JOIN [D:個人Info] ON V_農地.所有者ID = [D:個人Info].ID) INNER JOIN M_BASICALL ON V_農地.農地状況 = M_BASICALL.ID) LEFT JOIN V_住民区分 ON [D:個人Info].住民区分 = V_住民区分.ID WHERE (((V_農地.農地状況)<>0) AND ((M_BASICALL.Class)='農地状況')) ORDER BY V_農地.土地所在;" _
                , "土地所在;土地所在;@田面積;田面積;@畑面積;畑面積;@樹園地;樹園地;@採草放牧面積;採草放牧面積;所有者;所有者;所有者住所;所有者住所;所有者区分;所有者区分;農地状況;名称", "遊休農地一覧"
            Case "遊休農地調査年度指定"
                St = Trim(Fnc.InputText("指定年度", "年度を指定してください", Fnc.Get年度("GGGEE", Now())))
                If Len(St) = 0 Then
                ElseIf IsDate(St & "/1/1") Then
                    sSQL = "SELECT '農地.' & [V_農地].[ID] AS [KEY], Format$([遊休時期],'gggee') & '年調査' AS 調査時期, V_農地.土地所在, V_農地.田面積, V_農地.畑面積, [D:個人Info].氏名 AS 所有者 " & _
                    "FROM V_農地 INNER JOIN [D:個人Info] ON V_農地.所有者ID = [D:個人Info].ID WHERE (((V_農地.遊休化)=True)) AND Year([遊休時期]) = " & Year(CDate(St & "/4/1")) & " ORDER BY Format$([遊休時期],'gggee') & '年調査', V_農地.土地所在;"
                    
                    mvarPDW.SQLListview.SQLListviewCHead sSQL, "土地所在;土地所在;調査時期;調査時期;@田面積;田面積;@畑面積;畑面積;所有者;所有者", "遊休農地一覧"
                End If
            Case Else
                Debug.Assert CaseAssertPrint(Key)
        End Select
    End Sub
    
    Private Function SetGridView(ByVal sSQL As String, ByVal sColumn As String, ByVal sExecute As String, sFooter As String) As CTabPage
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim Ar As Variant
        Dim Cmn As Variant
        Dim Cm As Variant
        Dim n As Long
        Dim R As Long
        Dim y As Long
        Dim A As Currency
        
        With mvarPDW.Gridview
            .ClearAll
            mvarPDW.WaitMessage = "集計中..."
        
            Ar = Split(sExecute, ";" & vbCrLf)
            
            For n = 0 To UBound(Ar)
                If Len(Ar(n)) Then SystemDB.ExecuteSQL sExecute
            Next
        
            Set Rs = SystemDB.GetRecordsetEx(sSQL, 0, , Me)
        
            Cmn = Split(sColumn, ";")
            .Cols = UBound(Cmn) + 1
            For n = 0 To UBound(Cmn)
                If Len(Cmn(n)) Then
                    Cm = Split(Cmn(n), ",")
                    .TextMatrix(0, n) = Cm(0)
                End If
            Next

            R = 1
            Do Until Rs.EOF
                If R > .Rows - 1 Then .Rows = .Rows + 1
                For n = 0 To UBound(Cmn)
                    If Len(Cmn(n)) Then
                        Cm = Split(Cmn(n), ",")
                        .TextMatrix(R, n) = Rs.Value(Cm(1))
                    End If
                Next
                 
                R = R + 1
                Rs.MoveNext
            Loop

            If Len(sFooter) Then
                .Rows = .Rows + 1
                Cmn = Split(sFooter, ";")
                For n = 0 To UBound(Cmn)
                    If Len(Cmn(n)) Then
                        Cm = Split(Cmn(n), ",")
                        Select Case Cm(0)
                            Case "合計"
                                .TextMatrix(R, n) = Cm(0)
                            Case "Sum"
                                A = 0
                                For y = 1 To .Rows - 2
                                    A = A + Val(.TextMatrix(y, n))
                                Next
                                .TextMatrix(R, n) = A
                            Case "Count"
                        End Select
                    End If
                Next
            End If
            mvarPDW.WaitMessage = ""
            Rs.CloseRs
            .FitWidth
            Set mvarPDW.TabPages.SelectedItem = mvarPDW.Gridview
            Set SetGridView = mvarPDW.Gridview
        End With
    End Function

    Private Sub CCtrlEventReceiver_DblClick(ByVal Key As String, Optional vParam As Variant, Optional ByVal Index As Long = -1&)
        
    End Sub

    Private Sub CCtrlEventReceiver_ExtEvent(ByVal Key As String, ByVal EventName As String, ByVal sParam As String)

    End Sub

    Private Sub CCtrlEventReceiver_GridRowColChange(ByVal Key As String, Optional ByVal Index As Long = -1&)

    End Sub

    Private Sub CCtrlEventReceiver_KeyDown(ByVal Key As String, KeyCode As Integer, Shift As Integer, Optional ByVal Index As Long = -1&)

    End Sub

    Private Sub CCtrlEventReceiver_Paint(ByVal Key As String, Optional ByVal Index As Long = -1&)

    End Sub

    Private Sub CTabPage_Active()
        Debug.Assert False
    End Sub

    Private Property Get CTabPage_Body() As Object
        Dim pTop As Single
        If mvarBody Is Nothing Then
            
            Set picHelper = New CPictureBoxHelper
            mvarUniqueCode = mvarPDW.GetUniqueCode
            
            
            Set mvarBody = mvarPDW.AddCtrlWithCode("集計一覧BODY", "VB.PictureBox", mvarPDW.TabPages.Body)
            With mvarBody
                .Appearance = 0
                .BorderStyle = 0
                .BackColor = 4227136
            End With
            
            Set mvarPanel = mvarPDW.AddCtrlWithCode(mvarUniqueCode & "Panel", "VB.PictureBox", mvarBody)
            With mvarPanel
                .Visible = True
                .Appearance = 0
                .BorderStyle = 0
                .BackColor = 4227136
            End With
            Set picHelper.Body = mvarPanel
            
            Set vsc = mvarPDW.AddCtrlWithCode(mvarUniqueCode & "VSC", "VB.VScrollBar", mvarBody)
            vsc.ZOrder 0
            Set hsc = mvarPDW.AddCtrlWithCode(mvarUniqueCode & "HSC", "VB.HScrollBar", mvarBody)
            hsc.ZOrder 0
            
            With picHelper
                pTop = 0
                SetBody picHelper, 0, "農地基本", 0, pTop, GetArray("基本集計;基本集計", "農地経営世帯一覧;農地経営世帯一覧")
                SetBody picHelper, 1, "耕作世帯", 1, pTop, GetArray( _
                "集落別耕作世帯集計;集落別耕作世帯集計", _
                "集落別農地関係世帯集計;集落別集計農地関係者", _
                "１０ａ以上農家一覧;１０ａ以上農家一覧", _
                "指定面積以上農家一覧;指定面積以上農家一覧", _
                "60歳以上の農業従事者;60歳以上の農業従事者", _
                "地区別世帯件数(別表);地区別世帯件数集計", _
                "経営規模別世帯集計;経営規模別世帯集計", _
                "後継者状況別世帯;後継者状況別世帯件数集計表", "年齢別耕作農地一覧;年齢別耕作農地一覧", _
                "規模拡大希望世帯一覧;規模拡大希望世帯一覧", "法人化希望世帯一覧;法人化希望世帯一覧" _
                )
                
                SetBody picHelper, 2, "農地集計", 2, pTop, GetArray( _
                "大字別農地集計;大字別農地集計", _
                "貸借集計;貸借集計", _
                "貸借農地一覧;貸借農地一覧", _
                "小作形態別集計;小作形態別集計", _
                "登記地目別集計;登記地目別集計", _
                "現況地目別集計;現況地目別集計", _
                "死亡借受農地一覧;死亡借受農地一覧", _
                "利用権設定面積;利用権設定面積", _
                "利用権設定筆数;利用権設定筆数", _
                "開始年度別利用権;開始年度別利用権", _
                "面積別集計;面積別集計", _
                "面積未設定エラー;面積未設定エラー", _
                "貸付希望地一覧;貸付希望地一覧", _
                "売渡希望地一覧;売渡希望地一覧")
                
                
                pTop = SetBody(picHelper, 3, "遊休農地", 3, pTop, GetArray( _
                "遊休農地一覧;遊休農地一覧", _
                "遊休農地調査年度指定;遊休農地調査年度指定", _
                "農地状況別農地一覧;農地状況別農地一覧"))
                
                pTop = SetBody(picHelper, 4, "小作地関連", 3, pTop, _
                GetArray("小作農地所有状況一覧;小作農地所有状況一覧", _
                "小作地所有集計;小作地所有集計"))
                pTop = SetBody(picHelper, 5, "選挙関連", 3, pTop, GetArray("集落別選挙有資格世帯数;集落別選挙有資格世帯数", "集落別選挙有資格者数;集落別選挙有資格者数"))
                
                SetBody picHelper, 6, "エラー関連", 3, pTop, GetArray("世帯と世帯主の情報エラー;世帯と世帯主の情報エラー")
            End With
        End If
        Set CTabPage_Body = mvarBody
    End Property

    Private Function SetBody(picHelper As CPictureBoxHelper, nGroup As Long, sGroup As String, nLeft As Single, nTop As Single, Ar As Variant) As Single
        Dim St As String
        Dim n As Long
        Dim Cm As Variant
        Dim pFrame As Object
        
        With picHelper
            Set pFrame = .AddCtrl("VB.Frame", mvarUniqueCode & nGroup, "Caption=" & sGroup & ";BackColor=8454016;Move=" & nLeft * 2500 & "," & nTop & ",2480," & UBound(Ar) * 400 + 600)
            For n = 0 To UBound(Ar)
                Cm = Split(Ar(n), ";")
                .AddCtrlEH Me, "VB.CommandButton", mvarUniqueCode & Cm(1), "Caption=" & Cm(0) & ";Move=50," & n * 400 + 200 & ",2400,360;FontSize=10;Tag=" & Cm(1), pFrame
                If mvarPanel.Width < nGroup * 2500 + 2600 Then mvarPanel.Width = nGroup * 2500 + 2600
                If mvarPanel.Height < n * 400 + 800 Then mvarPanel.Height = n * 400 + 800
            Next
        End With
        SetBody = pFrame.Top + pFrame.Height
    End Function



    Private Function CTabPage_DoCommand(ByVal sCommand As String, pArray As Variant) As Variant

    End Function

    Private Sub CTabPage_Init(ByVal sParam As String, Optional ByVal sKey As String = ""): End Sub

    Private Property Let CTabPage_Key(ByVal RHS As String)

    End Property

    Private Property Get CTabPage_Key() As String: CTabPage_Key = "一覧／集計": End Property



    Private Property Set CTabPage_Parent(ByVal RHS As ADBasicLIB2.CTabPageCol)

    End Property

    Private Property Get CTabPage_Parent() As ADBasicLIB2.CTabPageCol

    End Property

    Private Sub CTabPage_Refresh(Optional ByVal sParam As String)
        '
    End Sub

    Private Sub CTabPage_Remove()
        picHelper.RemoveALLCtrl
        mvarPDW.RemoveCtrlwithCode mvarUniqueCode
        mvarPDW.RemoveCtrlwithCode "集計一覧BODY"
    End Sub

    Private Property Get CTabPage_Title() As String
        CTabPage_Title = mvarTitle
    End Property

    Private Property Let CTabPage_Title(ByVal RHS As String): mvarTitle = RHS: End Property


    Private Sub CTabPage_ToExcel(Optional ByVal sFile As String, Optional sPaperSize As String, Optional nOrientation As Long = 0&): End Sub
    
    Private Property Get CTabPage_Visible() As Boolean: End Property
    Private Property Let CTabPage_Visible(ByVal RHS As Boolean): mvarBody.Visible = RHS: End Property


    Private Sub mvarBody_Resize()
        Dim dX, dY
        On Error Resume Next
        
        dY = -hsc.Visible * 250
        
        If mvarBody.ScaleHeight - dY < mvarPanel.Height Then
            vsc.Visible = True
            vsc.Max = (mvarPanel.Height - dY) - mvarBody.ScaleHeight
            vsc.LargeChange = vsc.Max * ((mvarBody.ScaleHeight - dY) / mvarPanel.Height)
            vsc.LargeChange = vsc.SmallChange / 10
            vsc.Move mvarBody.ScaleWidth - 250, 0, 250, mvarBody.ScaleHeight - dY
        Else
            vsc.Visible = False
        End If
                
        dX = -vsc.Visible * 250
                
        If mvarBody.ScaleWidth - dX < mvarPanel.Width Then
            hsc.Visible = True
            hsc.Max = (mvarPanel.Width - dX) - mvarBody.ScaleWidth
            hsc.LargeChange = hsc.Max * ((mvarBody.ScaleWidth - dX) / mvarPanel.Width)
            hsc.LargeChange = hsc.SmallChange / 10
            hsc.Move 0, mvarBody.ScaleHeight - 250, mvarBody.ScaleWidth - dX, 250
        Else
            hsc.Visible = False
        End If
                
                
    End Sub

    Private Sub vsc_Change()
        mvarPanel.Top = -Abs(vsc.Value)
    End Sub

    Private Sub hsc_Change()
        mvarPanel.Left = -Abs(hsc.Value)
    End Sub


End Class










Class CObjectMan
    Option Explicit
    Implements ADBasicLIB2.CObjectManSK

    Private Function CObjectManSK_GetObject(ByVal sKey As String, Optional ByVal sParam As String = "", Optional ByVal sParentKey As String = "") As Object
        Dim Key As String
        Dim Rs As ADBasicLIB2.RecordsetEx

        Set CObjectManSK_GetObject = SysAD.Common.GetObject(sKey, sParam)
        If Not CObjectManSK_GetObject Is Nothing Then Exit Function
        If InStr(sKey, "_") Then sKey = Left$(sKey, InStr(sKey, "_") - 1)
        Key = sKey

        Select Case Fnc.GetKeyHead(Key)
        'フォルダコマンド
            Case "農家検索": Set CObjectManSK_GetObject = New C検索
            Case "農地検索": Set CObjectManSK_GetObject = New C検索
        'フォルダオブジェクト+
            Case "世帯管理", "農地管理": Set CObjectManSK_GetObject = New CFol各種管理
            Case "町内管理", "転用農地": Set CObjectManSK_GetObject = New CObj各種
            Case "農地追加", "農地追加個人": Set CObjectManSK_GetObject = New CObj各種
            Case "町外管理": Set CObjectManSK_GetObject = New CFol各種管理
            Case "市町村内その他": Set CObjectManSK_GetObject = New CFol各種管理
            Case "担い手農家": Set CObjectManSK_GetObject = New CObj各種
            Case "県外管理", "その他管理": Set CObjectManSK_GetObject = New CFol各種管理
            Case "県内管理": Set CObjectManSK_GetObject = New CFol各種管理
                Key = "都道府県." & SystemDB.DBProperty("都道府県ID")
            Case "マスタ管理": Set CObjectManSK_GetObject = New CFol各種管理
            Case "証明管理": Set CObjectManSK_GetObject = New CFol各種管理
            Case "認定農業者管理", "担い手農家管理", "年金受給者": Set CObjectManSK_GetObject = New CFol各種管理


    '/************ 年金関連 ************/
            Case "老齢年金受給者": Set CObjectManSK_GetObject = New CFol各種管理
            Case "経営移譲年金受給者": Set CObjectManSK_GetObject = New CFol各種管理
            Case "特例不可年金受給者": Set CObjectManSK_GetObject = New CFol各種管理
            Case "年金受給個人": Set CObjectManSK_GetObject = New CObj各種
            Case "年金受付簿": Set CObjectManSK_GetObject = New CPrint年金受付簿

            Case "申請管理": Set CObjectManSK_GetObject = New CFol各種管理

            Case "土地管理": Set CObjectManSK_GetObject = New C土地管理情報

            Case "利用権終期台帳", "農地法終期台帳": Set CObjectManSK_GetObject = New CFol各種管理
            Case "利用権終期": Set CObjectManSK_GetObject = New CFol各種管理
            Case "農地法終期": Set CObjectManSK_GetObject = New CFol各種管理
            Case "最近使ったページ": Set CObjectManSK_GetObject = New CFol各種管理
            Case "カスタム書式": Set CObjectManSK_GetObject = New CFol各種管理
            Case "最近使用": Set CObjectManSK_GetObject = New CFol各種管理
            Case "印刷管理": Set CObjectManSK_GetObject = New CFol各種管理
            Case "地方管理": Set CObjectManSK_GetObject = New CFol各種管理
            Case "都道府県": Set CObjectManSK_GetObject = New CFol各種管理
            Case "合併世帯管理": Set CObjectManSK_GetObject = New CFol各種管理
            Case "選挙申請書": Set CObjectManSK_GetObject = New C選挙申請書
            Case "選挙人一覧表": Set CObjectManSK_GetObject = New CPrint選挙一覧表

            Case "地域": Set CObjectManSK_GetObject = New CFol各種管理
            Case "受付中": Set CObjectManSK_GetObject = New CFol各種管理
            Case "審査中": Set CObjectManSK_GetObject = New CFol各種管理
            Case "許可済": Set CObjectManSK_GetObject = New CFol各種管理

            Case "３条受付中", "解約受付中": Set CObjectManSK_GetObject = New CFol各受付中
            Case "県３条受付中": Set CObjectManSK_GetObject = New CFol各受付中
            Case "４条受付中": Set CObjectManSK_GetObject = New CFol各受付中
            Case "５条受付中": Set CObjectManSK_GetObject = New CFol各受付中
            Case "利用権設定受付中": Set CObjectManSK_GetObject = New CFol各受付中
            Case "利用権移転受付中": Set CObjectManSK_GetObject = New CFol各受付中
            Case "所有権移転受付中": Set CObjectManSK_GetObject = New CFol各受付中
            Case "所有権設定受付中": Set CObjectManSK_GetObject = New CFol各受付中
            Case "農用地計画変更受付中": Set CObjectManSK_GetObject = New CFol各受付中
            Case "事業計画変更受付中": Set CObjectManSK_GetObject = New CFol各受付中
         
            Case "奨励金受付中": Set CObjectManSK_GetObject = New CFol各受付中
            Case "非農地受付中": Set CObjectManSK_GetObject = New CFol各受付中
            Case "農地利用変更受付中": Set CObjectManSK_GetObject = New CFol各受付中

            Case "３条審査中", "県３条審査中": Set CObjectManSK_GetObject = New CFol各種管理
            Case "４条審査中", "５条審査中": Set CObjectManSK_GetObject = New CFol各種管理
            Case "利用権移転審査中": Set CObjectManSK_GetObject = New CFol各種管理
            Case "利用権設定審査中": Set CObjectManSK_GetObject = New CFol各種管理
            Case "所有権移転審査中": Set CObjectManSK_GetObject = New CFol各種管理
            Case "農地利用変更審査中": Set CObjectManSK_GetObject = New CFol各種管理
            Case "事業計画変更審査中": Set CObjectManSK_GetObject = New CFol各種管理
            Case "農用地計画変更審査中": Set CObjectManSK_GetObject = New CFol各種管理
            Case "あっせん申出審査中": Set CObjectManSK_GetObject = New CFol各種管理
            Case "非農地審査中": Set CObjectManSK_GetObject = New CFol各種管理
            
            Case "３条許可済", "４条許可済", "５条許可済": Set CObjectManSK_GetObject = New CFol各種管理
            Case "県３条許可済": Set CObjectManSK_GetObject = New CFol各種管理
            Case "利用権移転承認済": Set CObjectManSK_GetObject = New CFol各種管理
            Case "所有権移転承認済": Set CObjectManSK_GetObject = New CFol各種管理
            Case "利用権設定承認済": Set CObjectManSK_GetObject = New CFol各種管理
            Case "解約適用済": Set CObjectManSK_GetObject = New CFol各種管理
            Case "奨励金許可済": Set CObjectManSK_GetObject = New CFol各種管理
            Case "農地利用変更許可済": Set CObjectManSK_GetObject = New CFol各種管理
            Case "事業計画変更許可済": Set CObjectManSK_GetObject = New CFol各種管理
            Case "農用地計画変更許可済": Set CObjectManSK_GetObject = New CFol各種管理
            Case "農用地計画変更許可済"
            Case "解約許可済": Set CObjectManSK_GetObject = New CFol各種管理
            Case "農地利用変更承認済": Set CObjectManSK_GetObject = New CFol各種管理
            Case "非農地承認済": Set CObjectManSK_GetObject = New CFol各種管理
        '印刷オブジェクト
            Case "許可書": Set CObjectManSK_GetObject = New CPrint許可書

            Case "営農計画書": Set CObjectManSK_GetObject = New CPrint営農計画書
            Case "小作形態別集計": Set CObjectManSK_GetObject = New Cprint集計
            Case "基本台帳": Set CObjectManSK_GetObject = New C農家基本台帳
            Case "利用権終期通知書": Set CObjectManSK_GetObject = New C利用権終期通知書
            Case "利用権印刷": Set CObjectManSK_GetObject = New CPrint利用権終期台帳
            Case "利用権表紙": Set CObjectManSK_GetObject = New CPrn議案書鏡
            Case "耕作証明書": Set CObjectManSK_GetObject = New CPrint耕作証明書
            Case "耕作証明多筆", "耕作証明品目対応": Set CObjectManSK_GetObject = New CPrint耕作証明多筆型
'            Case "利用権終期農地一覧": Set CObjectManSK_GetObject = New CPrint一覧
            Case "農地現況調査": Set CObjectManSK_GetObject = New C枕崎現地調査
            Case "農家基本台帳New": Set CObjectManSK_GetObject = New C農家基本台帳
            Case "農家基本台帳New2": Set CObjectManSK_GetObject = New C農家基本台帳2
            Case "選挙権確定者": Set CObjectManSK_GetObject = New C選挙権確定者
            Case "選挙入場整理券": '枕崎用
                Set CObjectManSK_GetObject = New CPrint入場券
            Case "選挙人名簿":
                Select Case SystemDB.DBProperty("市町村名")
                    Case "枕崎市": Set CObjectManSK_GetObject = New C選挙人名簿
                End Select
            Case "C3条許可": Set CObjectManSK_GetObject = New CPrint許可書
            Case "買受適格証明願": Set CObjectManSK_GetObject = New CPrint買受適格証明願
            Case "受理通知書": Set CObjectManSK_GetObject = New CPrint受理通知書
            Case "適格要件届出書": Set CObjectManSK_GetObject = New CPrint適格要件届出書
            Case "３条届出書": Set CObjectManSK_GetObject = New CPrint3条届出書
            Case "転用申請チェック表": Set CObjectManSK_GetObject = New CPrint転用申請チェック表
            Case "営農計画書": Set CObjectManSK_GetObject = New CPrint営農計画書
            Case "奨励金交付申請書": Set CObjectManSK_GetObject = New CPrint奨励金交付申請書
            Case "奨励金総括表": Set CObjectManSK_GetObject = New CPrint奨励金総括表
            Case "奨励金交付通知書": Set CObjectManSK_GetObject = New CPrint奨励金交付通知書
        '各種オブジェクト
            Case "農家台帳": Set CObjectManSK_GetObject = ADApp
            Case "市町村", "行政区", "農地大字": Set CObjectManSK_GetObject = New CObj各種
            Case "農家": Set CObjectManSK_GetObject = New CObj農家
            Case "営農情報": Set CObjectManSK_GetObject = New CObj農家
            Case "世帯員", "対象者", "選挙世帯員": Set CObjectManSK_GetObject = New CObj世帯員
            Case "認定農業者": Set CObjectManSK_GetObject = New CObj各種

            Case "農地", "申請農地": Set CObjectManSK_GetObject = New CObj農地
        
            Case "筆":
                Set Rs = SystemDB.GetRecordsetEx("SELECT [ID] FROM [D:農地Info] WHERE [地図ID]=" & Fnc.GetKeyCode(Key), , , Me)
                If Rs.EOF Then
                    MsgBox "該当する農地が見つかりません", vbExclamation
                Else
                    Key = "農地." & Rs.ID
                    Set CObjectManSK_GetObject = ObjectMan.GetObject(Key)
                End If
            Case "履歴追加": Set CObjectManSK_GetObject = New CFol各種管理
            Case "申請": Set CObjectManSK_GetObject = New CObj申請
            Case "住民区分管理", "農年区分管理", "専兼区分管理", "都市計画区分管理": Set CObjectManSK_GetObject = New CObjマスタCtrl
            Case "自小作区分管理": Set CObjectManSK_GetObject = New CObjマスタCtrl
            Case "農業委員管理": Set CObjectManSK_GetObject = New CObjマスタCtrl
            Case "続柄管理": Set CObjectManSK_GetObject = New CObjマスタCtrl
            Case "投票所管理": Set CObjectManSK_GetObject = New CObjマスタCtrl
            Case "適用法区分管理": Set CObjectManSK_GetObject = New CObjマスタCtrl

            Case "大字管理", "小字管理", "地目管理", "性別コード", "従事区分管理": Set CObjectManSK_GetObject = New CObjマスタCtrl
            Case "農機具コード", "農用施設コード": Set CObjectManSK_GetObject = New CObjマスタCtrl
            Case "町外大字管理", "マスタグループ": Set CObjectManSK_GetObject = New CObjマスタCtrl
            Case "利用権種類管理": Set CObjectManSK_GetObject = New CObjマスタCtrl
            Case "年金受給者会管理": Set CObjectManSK_GetObject = New CObjマスタCtrl
            Case "農機具管理", "家畜管理": Set CObjectManSK_GetObject = New CObjマスタCtrl

            Case "住民区分", "農年区分", "専兼区分", "性別": Set CObjectManSK_GetObject = ADApp.Common.GetCodeObject(Key)
            Case "農業委員", "投票所", "従事区分": Set CObjectManSK_GetObject = ADApp.Common.GetCodeObject(Key)
            Case "農委地目管理", "農地状況管理": Set CObjectManSK_GetObject = New CObjマスタCtrl

            Case "大字", "小字", "地目", "続柄", "性別", "農委地目", "都市計画区分", "農地状況": Set CObjectManSK_GetObject = ADApp.Common.GetCodeObject(Key)
            Case "農機具", "家畜": Set CObjectManSK_GetObject = ADApp.Common.GetCodeObject(Key)
            Case "年金受給者会": Set CObjectManSK_GetObject = ADApp.Common.GetCodeObject(Key)

            Case "町外大字": Set CObjectManSK_GetObject = ADApp.Common.GetCodeObject(Key)
            Case "適用法令": Set CObjectManSK_GetObject = ADApp.Common.GetCodeObject(Key)

            Case "利用権種類": Set CObjectManSK_GetObject = ADApp.Common.GetCodeObject(Key)
            Case "自小作区分": Set CObjectManSK_GetObject = ADApp.Common.GetCodeObject(Key)
            Case "小作形態管理", "利用PC管理": Set CObjectManSK_GetObject = New CObjマスタCtrl
            Case "小作形態": Set CObjectManSK_GetObject = ADApp.Common.GetCodeObject(Key)
            Case "土地異動事由管理": Set CObjectManSK_GetObject = New CObjマスタCtrl
            Case "土地異動事由": Set CObjectManSK_GetObject = ADApp.Common.GetCodeObject(Key)
            Case "営農農機具": Set CObjectManSK_GetObject = New CObj各種
            Case "土地": Set CObjectManSK_GetObject = New CObj各種
            Case "利用PC": Set CObjectManSK_GetObject = ADApp.Common.GetCodeObject(Key)
            Case "老齢年金受給者地区": Set CObjectManSK_GetObject = New CFol各種管理
            Case "経営移譲年金受給者地区": Set CObjectManSK_GetObject = New CFol各種管理
            Case "土地履歴": Set CObjectManSK_GetObject = New CObj各種
            Case "後継者状況別世帯件数集計表": Set CObjectManSK_GetObject = New Cprint集計
            Case "地区別世帯件数集計": Set CObjectManSK_GetObject = New Cprint集計
            Case "農業法人研修希望": Set CObjectManSK_GetObject = New CFol各種管理
            Case "パソコン研修管理": Set CObjectManSK_GetObject = New CFol各種管理
            Case "買受希望者リスト": Set CObjectManSK_GetObject = New CFol各種管理
            Case "家族経営協定管理": Set CObjectManSK_GetObject = New CFol各種管理
            Case "印刷グループ": Set CObjectManSK_GetObject = New CFol各種管理
            Case "年金被保険者": Set CObjectManSK_GetObject = New CFol各種管理
            Case "拡張書式":
'            Case "一覧印刷": Set CObjectManSK_GetObject = New CPrint一覧
            Case "印刷": Set CObjectManSK_GetObject = New CFol印刷管理
            Case "名簿登載候補一覧": Set CObjectManSK_GetObject = New CPrint選挙一覧表
            Case "受付交付簿３条": Set CObjectManSK_GetObject = New CPrint受付交付簿3条
            Case "受付交付簿４条": Set CObjectManSK_GetObject = New CPrint受付交付簿4条
            Case "受付交付簿５条": Set CObjectManSK_GetObject = New CPrint受付交付簿5条
            Case "受付交付簿非農地": Set CObjectManSK_GetObject = New CPrint受付交付簿非農地
            Case "受付交付簿農地変更": Set CObjectManSK_GetObject = New CPrint受付交付簿農地変更
            Case "受付交付簿事業計画": Set CObjectManSK_GetObject = New CPrint受付交付簿事業計画
            Case "受付交付簿買受適格": Set CObjectManSK_GetObject = New CPrint受付交付簿買受適格
            Case "現地調査日程表", "現地調査担当委員": Set CObjectManSK_GetObject = New CPrint現地調査
            Case "現地調査報告書": Set CObjectManSK_GetObject = New CPrint現地調査報告書
            Case "耕作・公売", "転用・競売", "転用・公売", "耕作・競売": Set CObjectManSK_GetObject = New CFol各受付中

            Case "あっせん希望": Set CObjectManSK_GetObject = New CFol各種管理
            Case "貸付希望者リスト": Set CObjectManSK_GetObject = New CFol各種管理
            Case "売渡希望者リスト": Set CObjectManSK_GetObject = New CFol各種管理
            
            Case "集計機能": Set CObjectManSK_GetObject = New CFol各種管理
            Case "集計機能農地": Set CObjectManSK_GetObject = New CFol各種管理
            Case "農振農用地内一覧": Set CObjectManSK_GetObject = New CFol各種管理

    
            Case "年金受付管理": Set CObjectManSK_GetObject = New CFol各種管理
            Case "農業者年金受付管理": Set CObjectManSK_GetObject = New CFol各種管理
            Case "一時金請求受付管理": Set CObjectManSK_GetObject = New CFol各種管理
            Case "固定": Set CObjectManSK_GetObject = New CObj各種
            Case "住基": Set CObjectManSK_GetObject = New CObj各種
            Case "農用地管理": Set CObjectManSK_GetObject = New CFol各種管理
            Case "小作地実態調査": Set CObjectManSK_GetObject = New CFol各種管理
            Case "小作地実態調査票": Set CObjectManSK_GetObject = New CPrn小作地実態調査
            Case "３条許可済月別", "３条許可済年別", "県３条許可済月別", "県３条許可済年別", "４条許可済年別", "４条許可済月別", "５条許可済年別", "５条許可済月別" _
            , "農地利用変更承認済月別", "農地利用変更承認済年別", "利用権移転承認済年別", "利用権移転承認済月別", "所有権移転承認済月別", "所有権移転承認済年別", "利用権設定承認済年別", "利用権設定承認済月別", "解約適用済月別", "解約適用済年別", "非農地承認済月別", "非農地承認済年別", "農用地計画変更許可済月別"
                Set CObjectManSK_GetObject = New CFol各種管理

    '/************ 議案書関連 ************/
            Case "議案書": Set CObjectManSK_GetObject = New CPrint議案書
            Case "総会資料": Set CObjectManSK_GetObject = New CFol各種管理
            Case Else
                Debug.Assert CaseAssertPrint(Fnc.GetKeyHead(Key), "NK97.CObjectman(CObjectmanSK_GetObject)")
        End Select

        On Error Resume Next
        CObjectManSK_GetObject.Key = Key
    End Function

    Private Function CObjectManSK_GetObjectDVP(ByVal sKey As String, Optional ByVal sParam As String = "", Optional ByVal sParentKey As String = "") As ADBasicLIB2.CDataviewSK
        Set CObjectManSK_GetObjectDVP = CObjectManSK_GetObject(sKey, sParam)
        If Not CObjectManSK_GetObjectDVP Is Nothing And Len(sParentKey) > 0 Then
            Set CObjectManSK_GetObjectDVP.DVProperty.Parent = SysAD.Common.GetObject(sParentKey)
        End If
    End Function

End Class










Class CObjマスタCtrl
    Option Explicit
    Implements ADBasicLIB2.CDataviewSK

    '住民区分管理
    '農業委員管理
    
    Private DVProperty As CDataviewProperty
    Private Sub Class_Initialize(): Set DVProperty = mvarPDW.DataviewCol.GetNewDVP: End Sub
            
    Public Property Get Key() As String: Key = DVProperty.Key: End Property
    Public Property Let Key(ByVal RHS As String): DVProperty.Key = RHS: End Property

    Private Sub CDataviewSK_CloseRecordset(): End Sub

    Private Property Set CDataviewSK_Container(ByVal RHS As ADBasicLIB2.CPDW)
        Debug.Assert False 'Non Code
    End Property

    Private Sub CDataviewSK_DblClick()
        Dim sClass As String
        Dim sIcon As String
        
        Select Case Fnc.GetKeyHead(DVProperty.Key)
            Case "住民区分管理": sClass = "住民区分": sIcon = "Unit"
            Case "農年区分管理": sClass = "農年区分": sIcon = "Unit"
            Case "都市計画区分管理": sClass = "都市計画区分": sIcon = "Unit"
            Case "農業委員管理": sClass = "農業委員": sIcon = "Unit"
            Case "大字管理": sClass = "大字": sIcon = "Unit"
            Case "小字管理": sClass = "小字": sIcon = "Unit"
            Case "町外大字管理": sClass = "町外大字": sIcon = "Unit"
            Case "利用権種類管理": sClass = "利用権種類": sIcon = "Unit"
            Case "自小作区分管理": sClass = "自小作区分": sIcon = "Unit"
            Case "地目管理": sClass = "地目": sIcon = "Unit"
            Case "続柄管理": sClass = "続柄": sIcon = "Unit"
            Case "専兼区分管理": sClass = "専兼区分": sIcon = "Unit"
            Case "投票所管理": sClass = "投票所": sIcon = "Unit"
            Case "適用法区分管理": sClass = "適用法令": sIcon = "Unit"
            Case "性別コード": sClass = "性別": sIcon = "Unit"
            Case "農機具コード": sClass = "農機具": sIcon = "Unit"
            Case "農用施設コード": sClass = "農用施設": sIcon = "Unit"
            Case "小作形態管理": sClass = "小作形態": sIcon = "Unit"
            Case "土地異動事由管理": sClass = "土地異動事由": sIcon = "Unit"
            Case "従事区分管理": sClass = "従事区分": sIcon = "Unit"
            Case "年金受給者会管理": sClass = "年金受給者会": sIcon = "Unit"
            Case "利用PC管理": sClass = "利用PC": sIcon = "Unit"
            Case "農機具管理": sClass = "農機具": sIcon = "Unit"
            Case "家畜管理": sClass = "家畜": sIcon = "Unit"
            Case "農委地目管理": sClass = "農委地目": sIcon = "Unit"
            Case "農地状況管理": sClass = "農地状況": sIcon = "Unit"
            Case Else
        End Select
        
        mvarPDW.SQLListview.SQLListviewCHead "SELECT [Class] & '.' & [ID] AS [KEY], IIF([ID]>=0,RIGHT$('00000000000000' & [ID],10),'-' & RIGHT$('00000000000000' & ABS([ID]),9)) AS [キー],[名称] ,'" & sIcon & "' AS ICON FROM [M_BASICALL] WHERE [Class] ='" & sClass & "' ORDER BY [ID]", "キー;キー;名称;名称", Fnc.GetKeyHead(DVProperty.Key)
    End Sub

    Private Function CDataviewSK_DoCommand2(sCmd As String, Optional sParam As String = "") As Variant
        Debug.Assert False 'Non Code
    End Function

    Private Sub CDataviewSK_DropDown(sSourceList As String, Optional sOption As String = "")
        Dim Ar As Variant
        Dim i As Long
        Dim sName As String
        Dim ID As Long
        
        Ar = Split(sSourceList, ";")
        
        For i = LBound(Ar) To UBound(Ar)
            Select Case Fnc.GetKeyHead(Me.Key) & "-" & Fnc.GetKeyHead(CStr(Ar(i)))
                Case "マスタグループ-大字管理", "マスタグループ-小字管理", "マスタグループ-地目管理", "マスタグループ-町外大字管理", "マスタグループ-住民区分管理", "マスタグループ-性別コード", "マスタグループ-農機具コード", "マスタグループ-自小作区分管理", "マスタグループ-続柄管理"
                    SystemDB.ExecuteSQL "UPDATE S_Folder SET S_Folder.ParentKey = '" & Me.Key & "' WHERE (((S_Folder.Key) = '" & Ar(i) & "'));"
                    mvarPDW.Folder.Redraw mvarPDW.Folder.ExpandedList
                Case "大字管理-町外大字":
                    SystemDB.SetDirectDataWithClass "M_BASICALL", "Class", "町外大字", "大字", Fnc.GetKeyCode(CStr(Ar(i)))
                Case "町外大字管理-大字":
                    SystemDB.SetDirectDataWithClass "M_BASICALL", "Class", "大字", "町外大字", Fnc.GetKeyCode(CStr(Ar(i)))
                Case "農業委員管理-世帯員":
                    ID = Fnc.GetKeyCode(CStr(Ar(i)))
                    sName = SystemDB.GetDirectData("D:個人Info", "氏名", ID)
                    On Error Resume Next
                    SystemDB.ExecuteSQL "INSERT INTO [M_BASICALL] VALUES(" & ID & ",'農業委員','" & sName & "','農業委員管理',NULL,0,'" & Format$(Now(), "GGGEE/MM/DD") & "に設定')"
                Case Else
                    Debug.Print Fnc.GetKeyHead(Me.Key) & "-" & Fnc.GetKeyHead(CStr(Ar(i)))
            End Select
        Next
        CDataviewSK_DblClick
    End Sub

    Private Property Set CDataviewSK_DVProperty(ByVal RHS As ADBasicLIB2.CDataviewProperty): Set DVProperty = RHS: End Property
    Private Property Get CDataviewSK_DVProperty() As ADBasicLIB2.CDataviewProperty: Set CDataviewSK_DVProperty = DVProperty: End Property

    Private Function CDataviewSK_GetProperty2(sPropName As String, Optional sParam As String = "") As Variant
        Debug.Assert False 'Non Code
    End Function

    Private Property Get CDataviewSK_IconName() As String
        Debug.Assert False 'Non Code
    End Property

    Private Property Let CDataviewSK_Key(ByVal RHS As String): DVProperty.Key = RHS: End Property
    Private Property Get CDataviewSK_Key() As String: CDataviewSK_Key = DVProperty.Key: End Property

    Private Property Get CDataviewSK_ParentKey() As String
        Debug.Assert False 'Non Code
    End Property

    Private Sub LoadMasterText(sDlgTitle As String, Ar As Variant, sClass As String, sParentKey As String)
        Dim pRs As ADBasicLIB2.RecordsetEx
        Dim St As String
        
        Set pRs = SystemDB.GetRecordsetEx("SELECT * FROM [M_BASICALL]", 0, , Me)
        
        St = SysAD.MDIForm.OpenFileDlg(sDlgTitle, sDlgTitle & "(*.TXT)|*.TXT")
        If Not St = "No Select" Then
            SysAD.LoadCodeFile pRs.Body, St, Ar
            SystemDB.ExecuteSQL "UPDATE M_BASICALL SET M_BASICALL.Class = '" & sClass & "', M_BASICALL.ParentKey = '" & sParentKey & "' WHERE (((M_BASICALL.Class) Is Null));"
        End If
        pRs.CloseRs
    End Sub

    Private Function CDataviewSK_PopupMenu(Optional ByVal sParam As String = "", Optional vParam As Variant) As String
        Dim St As String
        Dim Rs As ADBasicLIB2.RecordsetEx
        
        Select Case Fnc.GetKeyHead(DVProperty.Key)
            Case "住民区分管理": St = "住民区分の追加;"
            Case "農年区分管理": St = "農年区分の追加;"
            Case "従事区分管理": St = "農業従事区分の追加;"
            Case "都市計画区分管理": St = "都市計画区分の追加;"
            Case "専兼区分管理": St = "専兼区分の追加;"
            Case "農業委員管理": St = "農業委員の追加;"
            Case "大字管理": St = "大字の追加;-;旧大字マスタからのコンバ−ト;"
            Case "小字管理": St = "小字の追加;-;旧小字マスタからのコンバ−ト;農地情報から大字の当込み;"
            Case "利用権種類管理": St = "利用権種類の追加;"
            Case "自小作区分管理": St = "自小作区分の追加;-;基本自小作区分の追加;"
            Case "地目管理": St = "地目の追加;-;地目マスタテキストからのコンバ−ト;"
            Case "続柄管理": St = "続柄の追加;"
            Case "投票所管理": St = "投票所の追加;"
            Case "適用法区分管理": St = "適用法令の追加;"
            Case "農機具コード": St = "農機具コードの追加;"
            Case "小作形態管理": St = "小作形態コードの追加;"
            Case "土地異動事由管理": St = "土地異動事由コードの追加;"
            Case "年金受給者会管理": St = "年金受給者会の追加;"
            Case "農機具管理": St = "農機具の追加;"
            Case "家畜管理": St = "家畜の追加;"
            Case "農委地目管理": St = "農委地目の追加;最新情報を読込む;"
            Case "マスタグループ"
            Case Else
                Debug.Assert CaseAssertPrint(Fnc.GetKeyHead(DVProperty.Key))
        End Select
        
        St = St & "-;エクスポート;最下位置に移動する;"
        
        St = SysAD.PopupMenu(St)
        Select Case St
            Case "住民区分の追加": ADApp.Common.AddCode "住民区分", "新しい住民区分", "住民管理": CDataviewSK_DblClick
            Case "農年区分の追加": ADApp.Common.AddCode "農年区分", "新しい農年区分", "農年管理": CDataviewSK_DblClick
            Case "都市計画区分の追加": ADApp.Common.AddCode "都市計画区分", "新しい都市計画区分", "都市計画管理": CDataviewSK_DblClick
            Case "農業従事区分の追加": ADApp.Common.AddCode "従事区分", "新しい農業従事区分", "従事区分管理": CDataviewSK_DblClick
            Case "専兼区分の追加": ADApp.Common.AddCode "専兼区分", "新しい専兼区分", "専兼管理": CDataviewSK_DblClick
            Case "農業委員の追加": ADApp.Common.AddCode "農業委員", "新しい農業委員", "農業委員": CDataviewSK_DblClick
            Case "投票所の追加": ADApp.Common.AddCode "投票所", "新しい投票所", "投票所": CDataviewSK_DblClick
            Case "地目の追加": ADApp.Common.AddCode "地目", "新しい地目", "地目": CDataviewSK_DblClick
            Case "大字の追加": ADApp.Common.AddCode "大字", "新しい大字", "大字": CDataviewSK_DblClick
            Case "小字の追加": ADApp.Common.AddCode "小字", "新しい小字", "小字": CDataviewSK_DblClick
            Case "農地情報から大字の当込み": SystemDB.ExecuteSQL "UPDATE [D:農地Info] INNER JOIN M_BASICALL ON [D:農地Info].小字ID = M_BASICALL.ID SET M_BASICALL.nParam = [大字ID] WHERE (((M_BASICALL.Class)='小字') AND (([D:農地Info].大字ID)>0) AND ((M_BASICALL.nParam) Is Null Or (M_BASICALL.nParam)=0));"
            Case "続柄の追加": ADApp.Common.AddCode "続柄", "新しい続柄", "続柄": CDataviewSK_DblClick
            Case "適用法令の追加": ADApp.Common.AddCode "適用法令", "新しい適用法令", "適用法令": CDataviewSK_DblClick
            Case "利用権種類の追加": ADApp.Common.AddCode "利用権種類", "新しい利用権種類", "利用権種類": CDataviewSK_DblClick
            Case "地目マスタテキストからのコンバ−ト": LoadMasterText "地目コードマスタファイル", GetArray("地目", "Class", "ID", "名称"), "地目", "地目管理"
            Case "旧大字マスタからのコンバ−ト": SystemDB.ExecuteSQL "INSERT INTO M_BASICALL ( ID, 名称, Class ) SELECT [V_大字].ID, [V_大字].大字, '大字' AS 大字名称 FROM [V_大字] LEFT JOIN M_BASICALL ON ([V_大字].大字 = M_BASICALL.名称) AND ([V_大字].ID = M_BASICALL.ID) WHERE ((([V_大字].ID)>0) AND ((M_BASICALL.ID) Is Null));"
            Case "旧小字マスタからのコンバ−ト": SystemDB.ExecuteSQL "INSERT INTO M_BASICALL ( ID, 名称, Class, nParam ) SELECT [V_小字].ID, [V_小字].名称, '小字' AS 小字名称, [OazaID] FROM [V_小字] LEFT JOIN M_BASICALL ON ([V_小字].名称 = M_BASICALL.名称) AND ([V_小字].ID = M_BASICALL.ID) WHERE ((([V_小字].ID)>0) AND ((M_BASICALL.ID) Is Null));"
            Case "自小作区分の追加": ADApp.Common.AddCode "自小作区分", "新しい自小作区分", "自小作区分": CDataviewSK_DblClick
            Case "農機具コードの追加": ADApp.Common.AddCode "農機具", "新しい農機具", "農機具コード": CDataviewSK_DblClick
            Case "土地異動事由コードの追加": ADApp.Common.AddCode "土地異動事由", "新しい土地異動事由", "土地異動事由管理.0": CDataviewSK_DblClick
            Case "年金受給者会の追加": ADApp.Common.AddCode "年金受給者会", "新しい年金受給者会", "年金受給者会管理.0": CDataviewSK_DblClick
            Case "農機具の追加": ADApp.Common.AddCode "農機具", "新しい農機具", "農機具管理.0": CDataviewSK_DblClick
            Case "家畜の追加": ADApp.Common.AddCode "家畜", "新しい家畜", "家畜管理.0": CDataviewSK_DblClick
            Case "農委地目の追加": ADApp.Common.AddCode "農委地目", "新しい農委地目", "農委地目.0": CDataviewSK_DblClick
            Case "最新情報を読込む":
            Case "基本自小作区分の追加":
                ADApp.Common.AddCode "自小作区分", "自作", "自小作区分管理":
                ADApp.Common.AddCode "自小作区分", "小作", "自小作区分管理":
                ADApp.Common.AddCode "自小作区分", "農年", "自小作区分管理": CDataviewSK_DblClick
            Case "小作形態コードの追加"
                ADApp.Common.AddCode "小作形態", "賃貸借", "小作形態管理":
                ADApp.Common.AddCode "小作形態", "使用貸借", "小作形態管理":
                ADApp.Common.AddCode "小作形態", "その他", "小作形態管理": CDataviewSK_DblClick
            Case "エクスポート"
                Dim sKeyPat As String
                Select Case Fnc.GetKeyHead(DVProperty.Key)
                    Case "専兼区分管理": sKeyPat = "専兼区分"
                    Case "住民区分管理": sKeyPat = "住民区分"
                    Case Else
                        Debug.Assert False
                End Select
                Dim Ts As ADBasicLIB2.CTextStream
                
                Set Rs = SystemDB.GetRecordsetEx("SELECT * FROM [M_BASICALL] WHERE [Class]='" & sKeyPat & "'", 0, , Me)
                If Not Rs.EOF Then
                    Rs.MoveFirst
                    Set Ts = Fnc.Fs.OpenTextFile(Fnc.Fs.GetSpecialFolderSH("MyDocuments") & "\" & SystemDB.GetDirectData("S_システムデータ", "Data", , "市町村名") & "_" & sKeyPat & ".CSV", ForWriting, True)
                    Do Until Rs.EOF
                        Ts.WriteS Rs.ID & "," & Rs.Value("Class") & "," & Rs.Value("名称")
                        Ts.WriteS "," & Rs.Value("ParentKey") & "," & Rs.Value("sParam") & "," & Rs.Value("nParam")
                        Ts.WriteS "," & Rs.Value("説明")
                        Ts.WriteBlankLines 1
                        Rs.MoveNext
                    Loop
                    Ts.CloseFile
                End If
                SystemDB.CloseRs Rs
            Case "最下位置に移動する": mvarPDW.Folder.NodeMoveLast Key
        End Select
    End Function

    Private Sub CDataviewSK_Refresh(Optional bReLoad As Boolean = False)
        Debug.Assert False 'Non Code
    End Sub


End Class










Class CObj各種
    Option Explicit
    Implements ADBasicLIB2.CDataviewSK
    
    Private DVProperty As CDataviewProperty
    Private Sub Class_Initialize(): Set DVProperty = mvarPDW.DataviewCol.GetNewDVP: End Sub
    
    Public Property Get Key() As String: Key = DVProperty.Key: End Property
    
    Public Property Let Key(ByVal RHS As String)
        Select Case Fnc.GetKeyHead(RHS)
            Case "担い手農家": DVProperty.SetDVP RHS, SystemDB, "SELECT * FROM [D:個人Info] WHERE [ID]=%DVP.ID%", Me
            Case "認定農業者": DVProperty.SetDVP RHS, SystemDB, "SELECT * FROM [D:個人Info] WHERE [ID]=%DVP.ID%", Me
            Case "農地大字": DVProperty.SetDVP RHS, SystemDB, "SELECT * FROM [V_大字] WHERE [ID]=%DVP.ID%", Me
            Case "市町村": DVProperty.SetDVP RHS
            Case "年金受給個人": DVProperty.SetDVP RHS, SystemDB, "SELECT [D:個人Info].[ID] AS [ID],'年金受給個人.' & [D:個人Info].[ID] AS [Key], [D:個人Info].氏名, [D:個人Info].生年月日, [D:個人Info].住所, D_年金受給者.被保険者記号番号, D_年金受給者.資格取得年月日 FROM [D:個人Info] INNER JOIN D_年金受給者 ON [D:個人Info].ID = D_年金受給者.ID WHERE [D:個人Info].[ID]=%DVP.ID%", Me
            Case "行政区": DVProperty.SetDVP RHS: DVProperty.Name = SystemDB.GetDirectData("S_Folder", "名称", , RHS)
            Case "町内管理": DVProperty.SetDVP RHS: DVProperty.Name = "町内"
            Case "転用農地": DVProperty.SetDVP RHS, SystemDB, "SELECT * FROM [D_転用農地] WHERE [ID]=%DVP.ID%", Me: DVProperty.Name = "転用農地"
            Case "土地履歴": DVProperty.SetDVP RHS, SystemDB, "SELECT * FROM [D_土地履歴] WHERE [ID]=%DVP.ID%", Me
            Case "主要農機具": DVProperty.SetDVP RHS, SystemDB, "SELECT * FROM [D_営農情報] WHERE [AutoID]=%DVP.ID%", Me
            Case "農地追加": DVProperty.SetDVP RHS
            Case "固定": DVProperty.SetDVP RHS
            Case "住基": DVProperty.SetDVP RHS
            Case "土地": DVProperty.SetDVP RHS, SystemDB, "SELECT [M_固定情報].*,IsNull([D:農地Info].[ID]) AS [非農地] FROM [M_固定情報] LEFT JOIN [D:農地Info] ON [M_固定情報].nID = [D:農地Info].[固定資産番号] WHERE [M_固定情報].[ID]='%DVP.ID%'", Me
            Case Else
                DVProperty.SetDVP RHS
                Debug.Assert CaseAssertPrint(DVProperty.Key, "")
        End Select
    End Property

    Private Sub CDataviewSK_CloseRecordset(): DVProperty.CloseRs: End Sub

    Private Property Set CDataviewSK_DVProperty(ByVal RHS As ADBasicLIB2.CDataviewProperty): Set DVProperty = RHS: End Property
    Private Property Get CDataviewSK_DVProperty() As ADBasicLIB2.CDataviewProperty: Set CDataviewSK_DVProperty = DVProperty: End Property

    Private Property Get CDataviewSK_ParentKey() As String: End Property

    Private Property Set CDataviewSK_Container(ByVal RHS As ADBasicLIB2.CPDW)
        Select Case Fnc.GetKeyHead(DVProperty.Key)
            Case Else
                Set DVProperty.Controls.Recordset = DVProperty.Rs
                Set DVProperty.Controls.Parent = Me
                Set DVProperty.Containner = RHS
                ADApp.Common.SetDataView DVProperty.ClassStr, DVProperty.Controls
                DVProperty.Controls.AttachData
        End Select
    End Property

    Private Sub CDataviewSK_DblClick()
        Select Case DVProperty.ClassStr
            Case "市町村": mvarPDW.SQLListview.SQLListviewCHead "SELECT '世帯員.' & [D:個人INFO].[ID] AS [KEY],[D:個人INFO.氏名] AS [名称],'Farmer' AS [Icon],'Farmer' AS [SelectIcon],[住所] FROM [D:個人INFO] WHERE [D:個人INFO].[市町村ID]=" & DVProperty.ID, "%2000,氏名;名称;住所;住所", "市町村別世帯一覧:" & DVProperty.ID
            Case "行政区": view世帯List DVProperty.StrReplace("WHERE ([都道府県ID] = 0 Or [都道府県ID] Is Null) AND [農地との関連]=TRUE AND [D:個人Info].[行政区ID]=%DVP.ID%"), DVProperty.Name & ":農家一覧" '/** 農地0001-0001-0001
            Case "町内管理": SQLListフォルダ "[ParentKey]='" & DVProperty.Key & "'", "町内"
            Case "転用農地": ADApp.DataviewCol.Add Me
            Case "担い手農家": ADApp.DataviewCol.Add Me
            Case "認定農業者": ADApp.DataviewCol.Add Me
            Case "年金受給個人": ADApp.DataviewCol.Add Me
            Case "土地履歴": ADApp.DataviewCol.Add Me
            Case "農地大字": view農地List "WHERE [大字ID]=" & DVProperty.ID, "大字:" & DVProperty.Rs.Value("大字") '/** 農地0001-0001-0002
            Case "農地追加": ADApp.DataviewCol.Add Me
            Case Else
                Debug.Assert CaseAssertPrint(DVProperty.ClassStr, "CObj各種_DblClick")
        End Select
    End Sub

    Private Function CDataviewSK_DoCommand2(sCmd As String, Optional sParam As String = "") As Variant
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim sSQL As String
        Dim St As String
        Dim ID As Long
        Dim n As Long
        Dim sHead As String
        
        Select Case DVProperty.ClassStr & "-" & sCmd
            Case "市町村-農家の追加": CreateFarmer
            Case "市町村-基本台帳の一括印刷": CDataviewSK_DoCommand2 "基本台帳の一括印刷"
            Case "市町村-削除"
                If MsgBox("この市町村を削除しますか", vbYesNo) = vbYes Then
                    mvarPDW.Folder.RemoveNode DVProperty.Key, True
                    mvarPDW.SQLListview.Refresh
                End If
            Case "認定農業者-世帯を呼ぶ", "担い手農家-世帯を呼ぶ"
                St = "農家." & SystemDB.GetDirectData("D:個人Info", "世帯ID", DVProperty.ID)
                mvarPDW.DataviewCol.Add ADApp.ObjectMan.GetObject(St)
            Case "認定農業者-個人情報を呼ぶ", "担い手農家-個人情報を呼ぶ"
                mvarPDW.DataviewCol.Add ADApp.ObjectMan.GetObject("世帯員." & DVProperty.ID)
            Case "市町村-市町村データの再サンプル"
                St = SystemDB.GetDirectData("S_Folder", "名称", , DVProperty.Key)
                If Len(St) Then
                    SystemDB.ExecuteSQL "UPDATE [D:個人Info] SET [D:個人Info].市町村ID = " & DVProperty.ID & " WHERE ((([D:個人Info].住所) Like '" & St & "%'));"
                End If
            Case "行政区-年金受給者一覧":
                Debug.Assert False
            Case "行政区-選挙確認リスト": mvarPDW.PrintGo New CPrint選挙一覧表, CStr(DVProperty.ID)
            Case "認定農業者-削除":
                If MsgBox("認定農業者を取り消しますか", vbYesNo) = vbYes Then
                    CDataviewSK_DoCommand2 "閉じる"
                    SystemDB.ExecuteSQL "UPDATE [D:個人Info] SET [D:個人Info].農業改善計画認定 = 0 WHERE ((([D:個人Info].ID)=%DVP.ID%));", , , DVProperty
                    mvarPDW.SQLListview.Refresh
                End If
            Case "担い手農家-削除":
                If MsgBox("担い手農家を取り消しますか", vbYesNo) = vbYes Then
                    CDataviewSK_DoCommand2 "閉じる"
                    SystemDB.ExecuteSQL "UPDATE [D:個人Info] SET [D:個人Info].農業改善計画認定 = 0 WHERE ((([D:個人Info].ID)=%DVP.ID%));", , , DVProperty
                    mvarPDW.SQLListview.Refresh
                End If
            Case "農地大字-遊休農地一覧": view農地List "WHERE [遊休化]=TRUE AND [大字ID]=" & DVProperty.ID, "遊休農地一覧" '/** 農地0001-0001-0002
            Case "土地履歴-農地を呼ぶ": mvarPDW.DataviewCol.Add ADApp.ObjectMan.GetObject("農地." & DVProperty.Rs.Value("LID"))

            Case "転用農地-農地履歴": mvarPDW.SQLListview.SQLListviewCHead "SELECT '土地履歴.' & D_土地履歴.ID AS [KEY], D_土地履歴.異動日,'Unit' AS Icon,'Unit' AS SelectIcon,M_BASICALL.名称 AS [異動事由], D_土地履歴.内容 FROM D_土地履歴 LEFT JOIN V_土地異動事由 ON D_土地履歴.異動事由 = V_土地異動事由.ID WHERE (((D_土地履歴.LID)=" & DVProperty.ID & ")) ORDER BY [異動日] DESC;", "=異動日;異動日;%3000,異動事由;異動事由;%3500,内容;内容", "履歴一覧"
            Case "行政区-農家番号の振分け":
                SystemDB.Execute "UPDATE [D:世帯Info] INNER JOIN [D:個人Info] ON [D:個人Info].ID = [D:世帯Info].世帯主ID SET [農家番号]=0 WHERE [D:個人Info].行政区ID=" & DVProperty.ID
                Set Rs = SystemDB.GetRecordsetEx("SELECT [D:世帯Info].[ID],[D:世帯Info].農家番号 FROM [D:個人Info] INNER JOIN [D:世帯Info] ON [D:個人Info].ID = [D:世帯Info].世帯主ID WHERE ((([D:個人Info].行政区ID)=" & DVProperty.ID & ") AND (([D:世帯Info].農地との関連)=True)) AND [D:個人Info].[住民区分]=" & Val(SystemDB.DBProperty("記録住民コード")) & " ORDER BY [D:個人Info].フリガナ;", , , Me)
                n = 1
                Do Until Rs.EOF
                    SystemDB.Execute "UPDATE [D:世帯Info] SET [農家番号]=" & n & " WHERE [ID]=" & Rs.ID
                    Rs.MoveNext
                    n = n + 1
                Loop
                Rs.CloseRs
                MsgBox "振り直しました"
            Case "土地履歴-削除": CDataviewSK_DoCommand2 "閉じる": SystemDB.ExecuteSQL "DELETE D_土地履歴.ID FROM D_土地履歴 WHERE (((D_土地履歴.ID)=%DVP.ID%));", , , DVProperty: mvarPDW.SQLListview.Refresh
            Case "転用農地-削除": CDataviewSK_DoCommand2 "閉じる": SystemDB.ExecuteSQL "DELETE D_転用農地.ID FROM D_転用農地 WHERE [ID]=%DVP.ID%;", , , DVProperty: mvarPDW.SQLListview.Refresh
            Case "担い手農家-メニュー": CDataviewSK_PopupMenu
            Case "行政区-世帯の追加": Sub行政区_農家追加
            Case "農地追加-農地追加ボタン"
                If Not Val(DVProperty.Controls.Value("所有者ID")) = 0 Then
                    CreateLand DVProperty.Controls.Value("所有者ID"), DVProperty.ID, False
                End If
                DVProperty.Controls.Refresh "Grid農地追加"
            Case "農地追加個人-農地追加ボタン"
                CreateLand DVProperty.ID, SystemDB.GetDirectData("D:個人Info", "世帯ID", DVProperty.ID), False
                DVProperty.Controls.Refresh "Grid農地追加"
            Case "農地追加-最新情報ボタン", "農地追加個人-最新情報ボタン"
                DVProperty.Controls.Refresh "Grid農地追加"
            Case "農地追加-農地削除ボタン", "農地追加個人-農地削除ボタン" 'CObj各種_DoCommand2
                DVProperty.Controls.Value("Grid農地追加") = "DeleteNowKey"
            Case "農地大字-フォルダから削除"
                SystemDB.ExecuteSQL "DELETE S_Folder.Key FROM S_Folder WHERE (((S_Folder.Key)='" & DVProperty.Key & "'));"
                mvarPDW.Folder.Redraw mvarPDW.Folder.ExpandedList

            Case "行政区-台帳一括印刷"
                sSQL = "SELECT '農家.' & [D:世帯INFO].[ID] AS [Key], [D:個人INFO.氏名] AS [名称],[D:個人INFO].住民区分, 'House' AS Icon, 'House' AS SelectIcon, [D:個人INFO].[住所] AS 住所, [D:世帯INFO].農家番号,[D:個人Info].[フリガナ], M_BASICALL.名称 AS [専兼区分],[D:世帯INFO].確認日時, M_BASICALL.Class,IIF([住民区分]=" & Val(SystemDB.DBProperty("記録住民コード")) & ",0,-2147483631) AS ForeColor"
                sHead = Replace(SysAD.GetSettingData("農地基本台帳", "世帯リスト", ADApp.Common.AppData("世帯リスト")), ",", ";")
                Set Rs = SystemDB.GetRecordsetEx(sSQL & " FROM ([D:世帯INFO] LEFT JOIN [D:個人INFO] ON [D:世帯INFO].世帯主ID = [D:個人INFO].ID) LEFT JOIN (SELECT * FROM [M_BASICALL] WHERE [Class]='専兼区分') AS [M_BASICALL] ON [D:世帯INFO].兼業区分 = M_BASICALL.ID WHERE [D:個人Info].[住民区分]=" & Val(SystemDB.DBProperty("記録住民コード")) & " AND [D:個人Info].[行政区ID]=" & DVProperty.ID & " ORDER BY [D:個人Info].[フリガナ]")
                    
                Select Case Fnc.s市町村名
                    Case "日置市", "姶良市", "枕崎市", "南種子町", "長島町"
                        Do Until Rs.EOF
                            mvarPDW.PrintGo ADApp.ObjectMan.GetObject("農家基本台帳New2.0"), Rs.Key & "|" & Format(Now(), "GGGEE年MM月DD日"), True
                            Rs.MoveNext
                        Loop
                    Case Else
                        Do Until Rs.EOF
                            mvarPDW.PrintGo ADApp.ObjectMan.GetObject("農家基本台帳New.0"), Rs.Key & "|" & Format(Now(), "GGGEE年MM月DD日"), True
                            Rs.MoveNext
                        Loop
                End Select
                Rs.CloseRs
            Case "行政区-世帯経営面積一覧"
                 view世帯集計List "[D:個人Info].[行政区ID]=" & DVProperty.ID, "世帯経営面積一覧"
'                mvarPDW.SQLListview.SQLListviewCHead DVProperty.StrReplace(ADApp.Common.AppData("世帯経営面積一覧SQL")), "世帯主名;氏名;フリガナ;フリガナ;住所;住所;@自作田;自作田;@自作畑;自作畑;@自作計;自作計;@小作田;小作田;@小作畑;小作畑;@小作計;小作計;@経営計;経営計", "世帯経営面積一覧:" & DVProperty.Name

               
            Case "住基-世帯員データを一時作成"
                If MsgBox("世帯員に一次変換しますか", vbYesNo) = vbYes Then
                    SystemDB.ExecuteSQL "INSERT INTO [D:個人Info] ( ID, 世帯ID, 氏名, フリガナ, 住所, 住民区分, 生年月日, 性別, 続柄1, 続柄2, 続柄3, 行政区ID, 更新日時 ) " & _
                    "SELECT M_住民情報.ID, IIf(IsNull([M_住民情報].[世帯ID]),IIf(IsNull([M_住民情報].[世帯No]),0,[M_住民情報].[世帯No]),Val([M_住民情報].[世帯ID])), M_住民情報.氏名, M_住民情報.フリガナ, M_住民情報.住所, M_住民情報.住民区分, M_住民情報.生年月日, M_住民情報.性別, M_住民情報.続柄, M_住民情報.続柄2, M_住民情報.続柄3, M_住民情報.行政区, M_住民情報.異動年月日 " & _
                    "FROM M_住民情報 WHERE [M_住民情報].ID=" & DVProperty.ID
                    mvarPDW.DataviewCol.Add ADApp.ObjectMan.GetObject("世帯員." & DVProperty.ID)
                End If
            Case "転用農地-関連申請"
                Set Rs = SystemDB.GetRecordsetEx(DVProperty.StrReplace("SELECT Max(D_申請.ID) as [ID] FROM D_申請 WHERE (((D_申請.農地リスト) Like '%.%DVP.ID%;%')) OR (((D_申請.農地リスト) Like '%.%DVP.ID%'));"), 0, , Me)
                If Rs.IsNoRecord Then
                    MsgBox "対応する申請履歴がありません", vbCritical
                ElseIf Rs.ID > 0 Then
                    ObjectMan.GetObjectDVP("申請." & Rs.ID).DblClick
                Else
                    MsgBox "対応する申請履歴がありません", vbCritical
                End If
            Case Else
                Select Case sCmd
                    Case ""
                    Case "選挙権入力一覧"
                        Dim sWhere As String
                        Dim n死亡 As Long
                        Dim n記録住民CD As Long
                        
                        n記録住民CD = Val(SystemDB.DBProperty("記録住民コード"))
                            
                            n死亡 = SystemDB.DBProperty("死亡住民コード")
                            sWhere = "WHERE (IIF(IIF(IsNull([D:個人Info].[生年月日]),0,[D:個人Info].[生年月日])=0,Now(),[D:個人Info].[生年月日]) < #" & Year(Now()) - (Month(Now()) > 7) - 20 & "/4/2# AND [D:個人Info].[行政区ID]=" & DVProperty.ID & "AND (([D:個人Info].住民区分)=" & n記録住民CD & ")) "
                            
                            sSQL = "SELECT '選挙世帯員.' & [D:個人Info].[ID] AS [KEY],[農家番号],[世帯ID], [D:個人Info].氏名 AS 名称, IIf([D:個人Info].[住民区分]=1,'DeadFarmer','Farmer') AS ICON, [D:個人Info].フリガナ, [D:個人Info].住所, [V_続柄].[続柄] & IIf(IsNull([D:個人Info].続柄2) Or ([D:個人Info].続柄2=0),'','の' & [続柄_2].[続柄]) AS 全続柄, IIf([D:個人Info].[選挙権の有無],'○','×') AS 選挙権表示,[選挙申請耕作面積], [D:個人Info].住民区分, IIf(IsNull([D:個人Info].[生年月日]),'-',IIf([D:個人Info].[生年月日]>0,Format$([D:個人Info].[生年月日],'gggee/mm/dd'),'-')) AS 生年月日, IIf([D:個人Info].[生年月日]>0,IIf(DateAdd('yyyy',DateDiff('yyyy',[D:個人Info].[生年月日],Now()),[D:個人Info].[生年月日])>Now(),DateDiff('yyyy',[D:個人Info].[生年月日],Now())-1,DateDiff('yyyy',[D:個人Info].[生年月日],Now())),'-') AS 年齢, [D:個人Info].住民区分,IIF([前年選挙権],'○','×') AS [前年選挙権表示] "
                            
                            sSQL = sSQL & "FROM (([D:個人Info] LEFT JOIN [V_続柄] ON [D:個人Info].続柄1 = [V_続柄].ID) LEFT JOIN [V_続柄] AS 続柄_2 ON [D:個人Info].続柄2 = 続柄_2.ID) LEFT JOIN [D:世帯Info] ON [D:個人Info].世帯ID = [D:世帯Info].[ID] "
                            sSQL = sSQL & sWhere
                            sSQL = sSQL & "ORDER BY 世帯ID,[続柄1],[生年月日] "
                            sHead = "%2200,名称;名称;@農家番号;農家番号;世帯ID;世帯ID;フリガナ;フリガナ;続柄;全続柄;住所;住所;=生年月日;生年月日;年齢;年齢;選挙権;選挙権表示;前年選挙権;前年選挙権表示;@選挙申請耕作面積;選挙申請耕作面積"
                            
                            mvarPDW.SQLListview.SQLListviewCHead sSQL, sHead, "選挙名簿"
                    Case "メニュー": CDataviewSK_PopupMenu
                    Case "コードの表示": MsgBox "Key:" & DVProperty.Key, vbOKOnly, "コードの表示"
                    Case "開く": CDataviewSK_DblClick
                    Case "閉じる": ADApp.DataviewCol.Remove DVProperty.Key
                    Case "貸出農家": mvarPDW.SQLListview.SQLListviewCHead "SELECT '農家.' & [D:世帯INFO].[ID] AS [KEY],[D:個人Info].氏名 AS [名称],'House' AS [Icon],'House' AS [SelectIcon], [D:世帯Info].住所 FROM [D:個人Info] INNER JOIN ([D:農地info] INNER JOIN [D:世帯Info] ON [D:農地info].所有世帯ID = [D:世帯Info].ID) ON [D:個人Info].ID = [D:世帯Info].世帯主ID Where ((([D:農地info].自小作別) > 0) And (([D:農地info].借受世帯ID) <> [D:世帯Info]![ID]) And (([D:世帯Info].行政区ID) = " & DVProperty.ID & ")) GROUP BY [D:世帯Info].ID, [D:個人Info].氏名, [D:個人Info].住所;", "%2000,名称;名称", "貸出農家"
                    Case "住民の追加": ADApp.DoCommand "住民の追加"
                    Case "最上位に移動する": mvarPDW.Folder.NodeMoveFirst DVProperty.Key
                    Case "最下位置に移動する": mvarPDW.Folder.NodeMoveLast DVProperty.Key
                    Case "更新": DVProperty.Controls.UpdateControlValues
                    Case "GotFocus":
                    Case Else
                        Debug.Assert CaseAssertPrint(DVProperty.ClassStr & "-" & sCmd, "CObj各種_DoCommand2")
                End Select
        End Select
    End Function
    
    Private Sub CDataviewSK_DropDown(sSourceList As String, Optional sOption As String = "")
        Dim Ar As Variant
        Dim pID As Long
        Dim n As Long
        Dim SID As String
        Dim St As String
        
        Select Case DVProperty.ClassStr & "-" & Fnc.GetKeyHead(sSourceList)
            Case "市町村-農家":
            Case "市町村-世帯員":
                SystemDB.Execute "UPDATE [D:個人Info] SET [D:個人Info].市町村ID = " & DVProperty.ID & " WHERE [D:個人Info].ID IN (" & GetKeyCodeList(sSourceList, "世帯員") & ");"
                mvarPDW.SQLListview.Refresh
            Case "行政区-行政区": 'Nop
            Case "行政区-農家台帳": 'Nop
            Case "町内管理-農家台帳": 'Nop
            Case "行政区-農業委員":
            Case "土地履歴-申請"
                Stop
                SystemDB.Execute "UPDATE [D_土地履歴] SET [申請ID]=" & Fnc.GetKeyCode(sSourceList) & " WHERE [ID]=" & DVProperty.ID
                mvarPDW.SQLListview.Refresh
            Case "行政区-農家"
                mvarPDW.WaitMessage = "** 移動中 **"
                
                SID = SystemDB.GetDirectData("S_システムデータ", "Data", , "市町村ID")
                Ar = Split(sSourceList, ";")
                For n = LBound(Ar) To UBound(Ar)
                    SystemDB.SetDirectData "D:世帯Info", "市町村ID", SID, Fnc.GetKeyCode(CStr(Ar(n)))
                    mvarPDW.WaitMessage = "** " & n & "/" & UBound(Ar) & " **"
                Next
                
                mvarPDW.WaitMessage = ""
            Case Else
                Debug.Assert CaseAssertPrint(DVProperty.ClassStr & "-" & Fnc.GetKeyHead(sSourceList), "CObj各種_DropDown")
        End Select
    End Sub

    Private Function CDataviewSK_GetProperty2(sPropName As String, Optional sParam As String = "") As Variant
        Select Case DVProperty.ClassStr & "-" & sPropName
            Case "転用農地-名称": CDataviewSK_GetProperty2 = DVProperty.Rs.Value("地番")
            Case "認定農業者-名称": CDataviewSK_GetProperty2 = "認定農業者:" & SystemDB.GetDirectData("D:個人Info", "氏名", DVProperty.ID)
            Case "担い手農家-名称": CDataviewSK_GetProperty2 = "担い手農家:" & SystemDB.GetDirectData("D:個人Info", "氏名", DVProperty.ID)
            Case "依頼-名称": CDataviewSK_GetProperty2 = DVProperty.Rs.Value("件名")
            Case "年金受給個人-名称": CDataviewSK_GetProperty2 = DVProperty.Rs.Value("氏名")
            Case "行政区-メニュー": CDataviewSK_GetProperty2 = PopSub()
            Case "土地履歴-名称": CDataviewSK_GetProperty2 = "土地履歴"
            Case "農地追加-名称": CDataviewSK_GetProperty2 = "農地追加"
            Case "農地追加個人-名称": CDataviewSK_GetProperty2 = "農地追加個人"
            Case Else
                Debug.Assert CaseAssertPrint(DVProperty.ClassStr & "-" & sPropName, "CObj各種_GetProperty2")
        End Select
    End Function
    
    Private Property Get CDataviewSK_IconName() As String
        Select Case DVProperty.ClassStr
            Case "認定農業者", "担い手農家": CDataviewSK_IconName = "Farmer"
            Case "土地履歴": CDataviewSK_IconName = "Unit"
            Case "農地追加", "農地追加個人": CDataviewSK_IconName = "Unit"
            Case "転用農地": CDataviewSK_IconName = "NOTLAND"
            Case Else
                Debug.Assert CaseAssertPrint(DVProperty.ClassStr, "CObj各種_IconName")
                CDataviewSK_IconName = "Unit"
        End Select
    End Property

    Private Property Let CDataviewSK_Key(ByVal RHS As String): End Property
    Private Property Get CDataviewSK_Key() As String: CDataviewSK_Key = DVProperty.Key: End Property

    Private Function CDataviewSK_PopupMenu(Optional ByVal sParam As String = "", Optional vParam As Variant) As String
        Dim St As String
        St = PopSub()
        If Not Len(St) Then CDataviewSK_DoCommand2 SysAD.PopupMenu(St)
    End Function

    Private Function PopSub() As String
        Dim St As String
        
        Select Case DVProperty.ClassStr
            Case "行政区": St = "開く;世帯の追加;>一覧;世帯経営面積一覧;選挙権入力一覧;選挙確認リスト;-;年金受給者一覧;貸出農家;<;台帳一括印刷;農家番号の振分け;-;最上位に移動する;最下位置に移動する;"
            Case "町内管理": St = "開く;-;住民の追加;-;最上位に移動する;最下位置に移動する;"
            Case "市町村": St = "開く;農家の追加;-;基本台帳の一括印刷;市町村データの再サンプル;-;コードの表示;最下位置に移動する;削除;"
            Case "担い手農家": St = "開く;世帯を呼ぶ;個人情報を呼ぶ;-;削除;-;閉じる;"
            Case "認定農業者": St = "開く;世帯を呼ぶ;個人情報を呼ぶ;-;削除;-;閉じる;"
            Case "年金受給個人": St = "開く;世帯を呼ぶ;個人情報を呼ぶ;-;削除;"
            Case "土地履歴": St = "開く;農地を呼ぶ;削除;"
            Case "農地追加", "農地追加個人": St = ""
            Case "農地大字": St = "遊休農地一覧;フォルダから削除;"

            Case "固定": St = "農地データを一時作成;"
            Case "住基": St = "世帯員データを一時作成;"
            Case "転用農地": St = "農地への復活;農地履歴;関連申請;-;削除;-;閉じる;"
            Case Else
                Debug.Assert CaseAssertPrint(DVProperty.ClassStr, "NK97.CObj各種エラー")
        End Select
        PopSub = St
    End Function
    
    Private Sub CDataviewSK_Refresh(Optional bReLoad As Boolean = False): End Sub

    Private Sub Sub行政区_農家追加()
        Dim St As String
        Dim n As Long
        Dim Rs As ADBasicLIB2.RecordsetEx
        
        n = Fnc.DBGetMinID(SystemDB, "D:世帯INFO")
        St = InputBox("世帯番号を入力してください", "世帯の追加", n)
        n = Val(St)
        
        If n Then
            Set Rs = SystemDB.GetRecordsetEx("SELECT * FROM [D:世帯INFO] WHERE [ID]=" & n, , , Me)
            If Rs.EOF Then
                Set Rs = SystemDB.GetRecordsetEx("SELECT * FROM [D:世帯INFO]", 2, 3, Me)
                Rs.UpdateValues GetArray("ID", "行政区ID", "農地との関連"), GetArray(n, DVProperty.ID, True)
                SystemDB.CloseRs Rs
                mvarPDW.DataviewCol.Add ADApp.ObjectMan.GetObject("農家." & n)
            Else
                mvarPDW.DataviewCol.Add ADApp.ObjectMan.GetObject("農家." & n)
            End If
            Rs.CloseRs
        End If
    End Sub
    
    Private Sub Class_Terminate(): DVProperty.CloseRs: End Sub

End Class










Class CObj申請
    Option Explicit
    Implements ADBasicLIB2.CDataviewSK
    Private mvarState As Long
    Private DVProperty As CDataviewProperty
    
    Private Sub Class_Initialize(): Set DVProperty = mvarPDW.DataviewCol.GetNewDVP: End Sub

    Public Property Get Key() As String: Key = DVProperty.Key: End Property
    Public Property Let Key(ByVal RHS As String)
        Dim ID As Long
        DVProperty.SetDVP RHS
        If DVProperty.ID = -1 Then
            DVProperty.GetRecordset SystemDB, "SELECT * FROM [D_申請]", , , Me
            DVProperty.Rs.AddNew
            DVProperty.Rs.Update
            DVProperty.Key = "申請." & DVProperty.Rs.ID
        Else
            DVProperty.GetRecordset SystemDB, "SELECT * FROM [D_申請] WHERE [ID]=%DVP.ID%", , , Me
        End If
        mvarState = DVProperty.V("状態", 0)
    End Property

    Private Sub CDataviewSK_CloseRecordset(): DVProperty.CloseRs: End Sub

    Private Property Set CDataviewSK_Container(ByVal RHS As ADBasicLIB2.CPDW)
        Dim nType As Long
        Dim SID As Long
        Dim MID As Long
        Dim sLst As String
        Dim St As String

        Set DVProperty.Containner = RHS
        Set DVProperty.Controls.Parent = Me
        Set DVProperty.Controls.Recordset = DVProperty.Rs.Body

        nType = DVProperty.V("法令", 0)
        With ADApp.Common
            Select Case nType
                Case state3条所有権, state県3条所有権: .SetDataView "3条所有権設定", DVProperty.Controls
                Case state3条賃借権, state県3条賃借権: .SetDataView "3条耕作権設定", DVProperty.Controls
                Case state4条転用: .SetDataView "4条転用", DVProperty.Controls
                Case state5条所有権: .SetDataView "5条所有権設定", DVProperty.Controls
                Case state5条賃借権: .SetDataView "5条賃借権設定", DVProperty.Controls
                Case state基盤所有権設定: .SetDataView "基盤法所有権設定", DVProperty.Controls
                Case state基盤利用権設定: .SetDataView "利用権設定", DVProperty.Controls
                Case state基盤利用権移転: .SetDataView "利用権移転", DVProperty.Controls
                Case state20条解約, state合意解約: .SetDataView "20条解約", DVProperty.Controls
                Case state農用地計画変更: .SetDataView "農用地計画変更", DVProperty.Controls
                Case state事業計画変更: .SetDataView "事業計画変更", DVProperty.Controls
                Case stateあっせん出手: .SetDataView "あっせん申出渡", DVProperty.Controls
               
                Case state奨励金交付A, state奨励金交付B: .SetDataView "流動化奨励金", DVProperty.Controls
                Case state農地利用変更: .SetDataView "農地利用変更", DVProperty.Controls
            End Select
        End With
        DVProperty.Controls.AttachData
    End Property

    Private Sub CDataviewSK_DblClick(): CDataviewSK_DoCommand2 "開く": End Sub
    Private Function CDataviewSK_DoCommand2(sCmd As String, Optional sParam As String = "") As Variant
        Dim pInputView As CInputView
        Dim pDic As CDataDictionary
        Dim n As Long
        Dim St As String
        Select Case sCmd
            Case "開く", "データを開く":
                mvarPDW.DataviewCol.Add Me
            Case "名称": DVProperty.Rs.Update "名称", sParam
            Case "メニュー": CDataviewSK_PopupMenu
            Case "法令": DVProperty.Rs.Update "法令", Val(sParam)
            Case "状態": DVProperty.Rs.Update "状態", Val(sParam)
            Case "申請世帯A": DVProperty.Rs.Update "申請世帯A", Val(sParam)
            Case "申請者A": DVProperty.Rs.Update "申請者A", Val(sParam)
            Case "住所A": DVProperty.Rs.Update "住所A", sParam
            Case "申請者B": DVProperty.Rs.Update "申請者B", Val(sParam)
            Case "受付年月日": DVProperty.Rs.Update "受付年月日", CDate(sParam)
            Case "譲渡人を呼ぶ": mvarPDW.DataviewCol.Add ADApp.ObjectMan.GetObject("世帯員." & DVProperty.Controls.Value("譲渡人ID"))
            Case "譲受人を呼ぶ": mvarPDW.DataviewCol.Add ADApp.ObjectMan.GetObject("世帯員." & DVProperty.Controls.Value("譲受人ID"))
            Case "申請Cを呼ぶ": If DVProperty.Controls.Value("申請CID") <> 0 Then mvarPDW.DataviewCol.Add ADApp.ObjectMan.GetObject("世帯員." & DVProperty.Controls.Value("申請CID"))
            Case "申請人を呼ぶ": If DVProperty.Controls.Value("申請人ID") <> 0 Then mvarPDW.DataviewCol.Add ADApp.ObjectMan.GetObject("世帯員." & DVProperty.Controls.Value("申請人ID"))
            Case "更新":
                If Not DVProperty.Controls Is Nothing Then DVProperty.Controls.UpdateControlValues
                If DVProperty.Rs.Value("法令") = 303 Then DVProperty.Rs.Update "名称", Fnc.NullCast(DVProperty.Rs.Value("氏名A"), "") & "（事業計画変更）"
                Select Case DVProperty.Rs.Value("法令")
                    Case 30, 31 '３条
                        If DVProperty.Rs.Value("経営面積B") = 0 Then DVProperty.Rs.Update "現地調査区分", 2
                    Case 32, 33: DVProperty.Rs.Update "現地調査区分", 2 '県３条
                    Case 40, 50, 51 '４・５条
                        If DVProperty.Rs.Value("農地区分") = 3 Then
                            DVProperty.Rs.Update "現地調査区分", 1
                        Else
                            DVProperty.Rs.Update "現地調査区分", 2
                        End If
                    Case 60, 61, 62 '経営基盤
                        If DVProperty.Rs.Value("経営面積B") = 0 Then
                            DVProperty.Rs.Update "現地調査区分", 2
                        Else
                            DVProperty.Rs.Update "現地調査区分", 1
                        End If
                    Case 301, 302, 303  '農地改良,農用地計画変更,事業計画変更
                            DVProperty.Rs.Update "現地調査区分", 2

                End Select
                If Not mvarPDW.TabPages("申請受付") Is Nothing Then
                    mvarPDW.TabPages("申請受付").Refresh
                End If
            Case "閉じる": ADApp.DataviewCol.Remove DVProperty.Key
            Case "申請農地を地図に表示"
                St = Replace(Replace(Replace(DVProperty.Rs.Value("農地リスト"), "転用", ""), "農地.", ""), ";", ",")
                SysAD.SendMessTo地図 St
            Case "４条：転用済み農地の一覧":
                If Not DVProperty.Rs.IsNull("申請者A") Then view転用農地List "WHERE ([所有者ID]=" & DVProperty.Rs.Value("申請者A") & ")", DVProperty.Name & ":転用農地一覧"
            Case "４条：申請者を呼ぶ": mvarPDW.DataviewCol.Add ADApp.ObjectMan.GetObject("世帯員." & DVProperty.Rs.Value("申請者A"))
            Case "部分設定"
                Dim sName As String, ID As Long, nArea As Double
                
                St = DVProperty.Controls.SelectedList("土地一覧Lst")
                If Len(St) Then
                    nArea = Val(DVProperty.Controls.GetSubItem("土地一覧Lst", "部分面積"))
                    ID = Fnc.GetKeyCode(St)
                    If nArea Then
                        SystemDB.ExecuteSQL "DELETE FROM [D_部分申請] WHERE [申請ID]=" & DVProperty.ID & " AND [農地ID]=" & ID & " AND [部分面積]=" & nArea
                    Else
                        sName = SystemDB.GetDirectData("V_農地", "土地所在", ID)
                    
                        St = Fnc.InputText("部分面積", "[" & sName & "]に設定する部分面積を入力してください", 0, 1, 3)
                        If Val(St) > 0 Then
                            SystemDB.ExecuteSQL "INSERT INTO D_部分申請 ( 申請ID, 農地ID, 部分面積 ) VALUES(" & DVProperty.ID & "," & ID & "," & Val(St) & ");"
                        End If
                    End If
                    DVProperty.Controls.Refresh "土地一覧Lst"
                End If
            Case "土地一覧Lst_OLEDragDropKeyList"
                DVProperty.Rs.Update "農地リスト", IIf(IsNull(DVProperty.Rs.Value("農地リスト")), sParam, IIf(Len(DVProperty.Rs.Value("農地リスト")) = 0, sParam, DVProperty.Rs.Value("農地リスト") & ";" & sParam))
                DVProperty.Controls.Value("土地一覧Lst") = DVProperty.Rs.Value("農地リスト")
                DVProperty.Controls.Refresh "土地一覧Lst"
            Case "土地一覧Lst_ListRefresh": DVProperty.Controls.Refresh "土地一覧Lst"

            Case "対象者一覧Lst_ListRefresh": DVProperty.Controls.Refresh "対象者一覧Lst"
            
            Case "削除":
                If MsgBox("削除しますよろしいですか", vbYesNo) = vbYes Then
                    CDataviewSK_DoCommand2 "閉じる"
                    
                    SystemDB.ExecuteSQL "Delete * FROM [D_申請] WHERE [ID]=" & DVProperty.ID
                    mvarPDW.SQLListview.Refresh
                End If
            Case "期間設定"
                n = DVProperty.Containner.GetAddDate(DVProperty.Controls.Value("開始年月日DT"), 5, 0, 0)
                
                If n Then DVProperty.Controls.Value("終了年月日DT") = n - 1
                DVProperty.Controls.Value("TX期間") = DateDiff("yyyy", DVProperty.Controls.Value("開始年月日DT"), DVProperty.Controls.Value("終了年月日DT"))
            Case "始期変更", "終期変更"
                If IsDate(DVProperty.Controls.Value("開始年月日DT")) And DVProperty.Controls.Value("開始年月日DT") <> "0:00:00" And IsDate(DVProperty.Controls.Value("終了年月日DT")) And DVProperty.Controls.Value("終了年月日DT") <> "0:00:00" Then
                    DVProperty.Controls.Value("TX期間") = DateDiff("yyyy", DVProperty.Controls.Value("開始年月日DT"), DVProperty.Controls.Value("終了年月日DT"))
                Else
                    DVProperty.Controls.Value("TX期間") = 0
                End If
            Case "土地一覧Lst_DblClick": mvarPDW.DataviewCol.Add ADApp.ObjectMan.GetObject(sParam, , DVProperty.Key)
            Case "対象者一覧Lst_DblClick": mvarPDW.DataviewCol.Add ADApp.ObjectMan.GetObject(sParam)
            Case "土地一覧Lst_BodyDblClick"
            Case "受付・交付簿"
                Set pDic = Fnc.InputMulti("受付交付簿", "対象となる総会番号と受付範囲を入力してください", "総会番号;数値;" & DVProperty.Rs.Value("総会番号") & ";|受付範囲;日付;" & ADApp.Common.AppData("受付範囲") & ";")
                If pDic Is Nothing Then
                ElseIf pDic.Item("総会番号") = 0 Then
                    MsgBox "総会番号が入力されてません。"
                Else
                    n = pDic.Item("総会番号")
                    ADApp.Common.AppData("受付範囲") = pDic.Item("受付範囲")
                    Select Case DVProperty.Rs.Value("法令")
                        Case state3条所有権, state3条賃借権, state県3条所有権, state県3条賃借権:
                                mvarPDW.PrintGo ObjectMan.GetObject("受付交付簿３条"), n & ";" & ADApp.Common.AppData("受付範囲")
                        Case state4条転用:  mvarPDW.PrintGo ObjectMan.GetObject("受付交付簿４条"), n & ";" & ADApp.Common.AppData("受付範囲")
                        Case state5条所有権, state5条賃借権: mvarPDW.PrintGo ObjectMan.GetObject("受付交付簿５条"), n & ";" & ADApp.Common.AppData("受付範囲")
                        Case state農地利用変更: mvarPDW.PrintGo ObjectMan.GetObject("受付交付簿農地変更"), n & ";" & ADApp.Common.AppData("受付範囲")
                        Case state事業計画変更: mvarPDW.PrintGo ObjectMan.GetObject("受付交付簿事業計画"), n & ";" & ADApp.Common.AppData("受付範囲")
                        Case state買受適格耕公, state買受適格耕競: mvarPDW.PrintGo ObjectMan.GetObject("受付交付簿買受適格"), n & ";1" & ";" & ADApp.Common.AppData("受付範囲")
                        Case state買受適格転公, state買受適格転競: mvarPDW.PrintGo ObjectMan.GetObject("受付交付簿買受適格"), n & ";2" & ";" & ADApp.Common.AppData("受付範囲")
                    End Select
                End If
            Case "まとめて許可": sub許可 True
            Case "交付決定通知書": mvarPDW.PrintGo ADApp.ObjectMan.GetObject("奨励金交付通知書"), CStr(DVProperty.ID)
            Case "申請書一括印刷": mvarPDW.PrintGo New CPrint奨励金交付申請書, "総会番号=" & SystemDB.DBProperty("今月総会番号")
            Case "受付設定"
                Set pDic = SysAD.MDIForm.InputMulti("受付設定", "以下の項目を入力してください", "受付番号;数値;" & mod農家台帳.Get受付番号Ex("990,991", DVProperty.Rs.Value("総会番号")) & ";|受付年月日;日付;" & Date & ";")
                If Not pDic Is Nothing Then
                    If IsDate(pDic.Item("受付年月日")) Then
                        DVProperty.Rs.Update "受付年月日", CStr(CDate(pDic.Item("受付年月日")))
                        DVProperty.Rs.Update "受付番号", Val(pDic.Item("受付番号"))
                        mvarPDW.SQLListview.Refresh
                    End If
                End If
            Case "交付設定"
                Set pDic = SysAD.MDIForm.InputMulti("交付設定", "以下の項目を入力してください", "交付決定番号;数値;" & DVProperty.Rs.Value("許可番号") & ";|交付決定年月日;日付;" & DVProperty.Rs.Value("許可年月日") & ";")
                If Not pDic Is Nothing Then
                    If IsDate(pDic.Item("交付決定年月日")) Then
                        DVProperty.Rs.Update "許可年月日", CStr(CDate(pDic.Item("交付決定年月日")))
                        DVProperty.Rs.Update "許可番号", Val(pDic.Item("交付決定番号"))
                        mvarPDW.SQLListview.Refresh
                    End If
                End If
            Case "承認する": sub許可
            Case "履歴だけ作成して許可状態": sub履歴のみ
            Case "変更前複写":
                With DVProperty.Controls
                    .Value("申請世帯ID") = .Value("変更前世帯ID")
                    .Value("申請人ID") = .Value("変更前申請人ID")
                    .Value("TX申請人名") = .Value("変更前申請人名")
                    .Value("譲渡人職業") = ""
                    .Value("住所AText") = .Value("変更前住所")
                    .Value("集落AText") = ""
                    .Value("年齢AText") = 0
                    .Value("土地一覧Grid") = .Value("変更前土地一覧Grid")
                    .Value("転用目的TX") = .Value("変更前転用目的TX")
                End With
            Case "事業計画変更申請": mod農家台帳.事業計画変更 Me
            Case "土地管理情報": mvarPDW.DataviewCol.Add ObjectMan.GetObject("土地管理." & DVProperty.ID)
            Case "土地管理再作成":
                Stop
                'mod農家台帳.Sub土地管作成 DVProperty.ID, 0, 0, 0, 0
                mod農家台帳.Sub土地管作成 DVProperty.ID, 0, 0, 0, 0
                mvarPDW.DataviewCol.Add ADApp.ObjectMan.GetObject("土地管理." & DVProperty.ID)
            Case "GotFocus"
            Case Else
                Debug.Assert CaseAssertPrint(sCmd, sParam)
        End Select
    End Function

    Private Sub CDataviewSK_DropDown(sSourceList As String, Optional sOption As String = "")
        Dim pPerson As ADBasicLIB2.CDataviewSK
        Dim p世帯 As ADBasicLIB2.CDataviewSK
        
        With DVProperty.Controls
            Select Case sOption
                Case "TX代理人名"
                    Set pPerson = ADApp.ObjectMan.GetObject(sSourceList)
                    Select Case Fnc.GetKeyHead(pPerson.Key)
                        Case "農家":
                        Case "世帯員":
                            If pPerson.GetProperty2("世帯の有無") Then
                                .Value("TX経営面積A") = pPerson.GetProperty2("世帯経営面積")
                            Else
                                .Value("TX経営面積A") = pPerson.GetProperty2("個人経営面積")
                            End If
                            
                            .Value("代理人ID") = Fnc.GetKeyCode(pPerson.Key)
                            .Value("TX代理人名") = pPerson.GetProperty2("氏名")
                            .Value("譲渡人職業") = pPerson.GetProperty2("職業")
                            .Value("住所AText") = pPerson.GetProperty2("住所")
                            .Value("年齢AText") = pPerson.GetProperty2("年齢")
                            .Value("集落AText") = pPerson.GetProperty2("集落名")
                    End Select
                Case "TX代理人名転用"
                    Set pPerson = ADApp.ObjectMan.GetObject(sSourceList)
                    Select Case Fnc.GetKeyHead(pPerson.Key)
                        Case "農家":
                        Case "世帯員":
                            .Value("代理人ID") = Fnc.GetKeyCode(pPerson.Key)
                            .Value("TX代理人名転用") = pPerson.GetProperty2("氏名")
                            .Value("譲渡人職業") = pPerson.GetProperty2("職業")
                            .Value("住所AText") = pPerson.GetProperty2("住所")
                            .Value("集落AText") = pPerson.GetProperty2("集落名")
                    End Select
                Case "TX譲渡人名", "譲渡人ID", "譲渡世帯ID"
                    Set pPerson = ADApp.ObjectMan.GetObject(sSourceList)
                    Select Case Fnc.GetKeyHead(pPerson.Key)
                        Case "農家":
                            If MsgBox("譲渡世帯を変更しますか", vbYesNo) = vbYes Then
                                Set pPerson = ADApp.ObjectMan.GetObject("世帯員." & pPerson.GetProperty2("世帯主ID"))
                                .Value("譲渡人ID") = Fnc.GetKeyCode(pPerson.Key)
                                .Value("TX譲渡人名") = pPerson.GetProperty2("氏名")
                                .Value("譲渡人職業") = pPerson.GetProperty2("職業")
                                .Value("住所AText") = pPerson.GetProperty2("住所")
                                .Value("年齢AText") = pPerson.GetProperty2("年齢")
                                .Value("集落AText") = pPerson.GetProperty2("集落名")
                            End If
                        Case "世帯員":
                            If MsgBox("譲渡人を変更しますか", vbYesNo) = vbYes Then
                                If pPerson.GetProperty2("世帯の有無") Then
                                    .Value("譲渡世帯ID") = pPerson.GetProperty2("世帯ID")
                                    .Value("TX経営面積A") = pPerson.GetProperty2("世帯経営面積")
                                Else
                                    .Value("譲渡世帯ID") = 0
                                    .Value("TX経営面積A") = pPerson.GetProperty2("個人経営面積")
                                End If
                                .Value("譲渡人ID") = Fnc.GetKeyCode(pPerson.Key)
                                .Value("TX譲渡人名") = pPerson.GetProperty2("氏名")
                                .Value("譲渡人職業") = pPerson.GetProperty2("職業")
                                .Value("住所AText") = pPerson.GetProperty2("住所")
                                .Value("年齢AText") = pPerson.GetProperty2("年齢")
                                .Value("集落AText") = pPerson.GetProperty2("集落名")
                            End If
                    End Select
                Case "TX譲受人名", "譲受人ID"
                    Select Case Fnc.GetKeyHead(sSourceList)
                        Case "農家":
                            If MsgBox("譲受世帯を変更しますか", vbYesNo) = vbYes Then
                                Set p世帯 = ADApp.ObjectMan.GetObject(sSourceList)
                                .Value("TX経営面積B") = p世帯.GetProperty2("経営面積")
                                Set pPerson = p世帯.GetProperty2("世帯主")
                                .Value("譲受人ID") = pPerson.GetProperty2("ID")
                                .Value("TX譲受人名") = pPerson.GetProperty2("氏名")
                                .Value("譲受人職業") = pPerson.GetProperty2("職業")
                                .Value("住所BText") = pPerson.GetProperty2("住所")
                                .Value("集落BText") = pPerson.GetProperty2("集落名")
                            End If
                        Case "世帯員":
                            If MsgBox("譲受人を変更しますか", vbYesNo) = vbYes Then
                                Set pPerson = ADApp.ObjectMan.GetObject(sSourceList)
                                If pPerson.GetProperty2("世帯の有無") Then
                                    .Value("TX経営面積B") = pPerson.GetProperty2("世帯経営面積")
                                Else
                                    .Value("TX経営面積B") = pPerson.GetProperty2("個人経営面積")
                                End If
                                
                                .Value("譲受人ID") = Fnc.GetKeyCode(pPerson.Key)
                                .Value("TX譲受人名") = pPerson.GetProperty2("氏名")
                                .Value("住所BText") = pPerson.GetProperty2("住所")
                                .Value("年齢BText") = pPerson.GetProperty2("年齢")
                                .Value("集落BText") = pPerson.GetProperty2("集落名")
                            End If
                    End Select
                Case "TX譲渡人名5条"
                    Set pPerson = ADApp.ObjectMan.GetObject(sSourceList)
                    Select Case Fnc.GetKeyHead(pPerson.Key)
                        Case "農家":
                        Case "世帯員":
                            If pPerson.GetProperty2("世帯の有無") Then
                                .Value("譲渡世帯ID") = pPerson.GetProperty2("世帯ID")
                            Else
                                .Value("譲渡世帯ID") = 0
                             End If
                            .Value("譲渡人ID") = Fnc.GetKeyCode(pPerson.Key)
                            .Value("TX譲渡人名5条") = pPerson.GetProperty2("氏名")
                            .Value("譲渡人職業") = pPerson.GetProperty2("職業")
                            .Value("住所AText") = pPerson.GetProperty2("住所")
                    End Select
                Case "TX譲受人名5条"
                    Set pPerson = ADApp.ObjectMan.GetObject(sSourceList)
                    Select Case Fnc.GetKeyHead(pPerson.Key)
                        Case "農家":
                            .Value("譲受人ID") = pPerson.GetProperty2("世帯主ID")
                            .Value("TX譲受人名5条") = pPerson.GetProperty2("世帯主名")
                            .Value("譲受人職業") = pPerson.GetProperty2("世帯主職業")
                            .Value("住所BText") = pPerson.GetProperty2("住所")
                        Case "世帯員":
                            .Value("譲受人ID") = Fnc.GetKeyCode(pPerson.Key)
                            .Value("TX譲受人名5条") = pPerson.GetProperty2("氏名")
                            .Value("譲受人職業") = pPerson.GetProperty2("職業")
                            .Value("住所BText") = pPerson.GetProperty2("住所")
                    End Select
                Case "調査員"
                    If Fnc.GetKeyHead(sSourceList) = "農業委員" Then
                        Set pPerson = ADApp.ObjectMan.GetObject("世帯員." & Fnc.GetKeyCode(sSourceList))
                        .Value("調査員") = pPerson.GetProperty2("氏名")
                    End If
                Case "TX経由法人名"
                    Set pPerson = ADApp.ObjectMan.GetObject(sSourceList)
                    .Value("経由法人ID") = Fnc.GetKeyCode(pPerson.Key)
                    .Value("TX経由法人名") = pPerson.GetProperty2("氏名")
                Case "TX申請人名", "申請人ID"
                    Set pPerson = ADApp.ObjectMan.GetObject(sSourceList)
                    Select Case Fnc.GetKeyHead(pPerson.Key)
                        Case "農家":
                        Case "世帯員":
                            If pPerson.GetProperty2("世帯の有無") Then
                                .Value("申請世帯ID") = pPerson.GetProperty2("世帯ID")
                            Else
                                .Value("申請世帯ID") = 0
                            End If
                            .Value("申請人ID") = Fnc.GetKeyCode(pPerson.Key)
                            .Value("TX申請人名") = pPerson.GetProperty2("氏名")
                            .Value("住所AText") = pPerson.GetProperty2("住所")
                            .Value("年齢AText") = pPerson.GetProperty2("年齢")
                            .Value("集落AText") = pPerson.GetProperty2("集落名")
                    End Select
                Case "変更前申請人ID"
                    Set pPerson = ADApp.ObjectMan.GetObject(sSourceList)
                    Select Case Fnc.GetKeyHead(pPerson.Key)
                        Case "世帯員":
                            If pPerson.GetProperty2("世帯の有無") Then
                                .Value("変更前世帯ID") = pPerson.GetProperty2("世帯ID")
                            Else
                                .Value("変更前世帯ID") = 0
                            End If
                            .Value("変更前申請人ID") = Fnc.GetKeyCode(pPerson.Key)
                            .Value("変更前申請人名") = pPerson.GetProperty2("氏名")
                            .Value("変更前住所") = pPerson.GetProperty2("住所")
                    End Select
                Case ""
                    Set pPerson = ADApp.ObjectMan.GetObject(sSourceList)
                    Select Case Fnc.GetKeyHead(pPerson.Key)
                        Case "申請"
                            If DVProperty.Rs.Value("法令") = state事業計画変更 Then
                                If pPerson.GetProperty2("法令") = state4条転用 Or pPerson.GetProperty2("法令") = state5条所有権 Or pPerson.GetProperty2("法令") = state5条賃借権 Then
                                Dim Rs As ADBasicLIB2.RecordsetEx
                                Dim sSQL As String
                                Dim n As Long
                                Dim i As Long
                                Dim St As String
                                Dim sTable As String
                    
                                Select Case pPerson.GetProperty2("法令")
                                    Case state4条転用:
                                        .Value("変更前世帯ID") = pPerson.GetProperty2("申請世帯A")
                                        .Value("変更前申請人ID") = pPerson.GetProperty2("申請者A")
                                        .Value("変更前申請人名") = pPerson.GetProperty2("氏名A")
                                        .Value("変更前住所") = pPerson.GetProperty2("住所A")
                                    Case state5条所有権, state5条賃借権:
                                        .Value("変更前世帯ID") = pPerson.GetProperty2("申請世帯B")
                                        .Value("変更前申請人ID") = pPerson.GetProperty2("申請者B")
                                        .Value("変更前申請人名") = pPerson.GetProperty2("氏名B")
                                        .Value("変更前住所") = pPerson.GetProperty2("住所B")
                                End Select
                                .Value("変更前転用目的TX") = pPerson.GetProperty2("申請理由A")
                                If pPerson.GetProperty2("状態") = 2 Then
                                    .Value("変更前許可日TX") = Format(pPerson.GetProperty2("許可年月日"), "GEE/MM/DD")
                                Else
                                    .Value("変更前許可日TX") = ""
                                End If
                                If IsNull(pPerson.GetProperty2("農地リスト")) Then
                                    .Value("変更前土地一覧Grid") = ""
                                Else
                                    If pPerson.GetProperty2("状態") = 2 Then
                                        St = Replace(Replace(pPerson.GetProperty2("農地リスト"), "転用農地.", ""), ";", ",")
                                        sTable = "V_転用農地"
                                    Else
                                        St = Replace(Replace(pPerson.GetProperty2("農地リスト"), "農地.", ""), ";", ",")
                                        sTable = "V_農地"
                                    End If
                                    
                                    sSQL = "SELECT [" & sTable & "].[土地所在],[" & sTable & "].[実面積],[" & sTable & "].[田面積],[" & sTable & "].[畑面積],[V_地目].名称 AS 登記地目,[地目2].名称 AS [現況],[V_農委地目].名称 AS [農委地目]" & _
                                    " FROM ((([" & sTable & "] LEFT JOIN [V_地目] ON [" & sTable & "].[登記簿地目]=[V_地目].ID) LEFT JOIN V_地目 AS 地目2 ON [" & sTable & "].[現況地目]=[地目2].ID) LEFT JOIN [V_農委地目] ON [" & sTable & "].[農委地目ID]=[V_農委地目].ID) " & _
                                    " WHERE [" & sTable & "].[ID] IN (" & St & ") ORDER BY [" & sTable & "].[大字ID],[" & sTable & "].[小字ID],val(IIf(IsNull([地番]),0,IIf(InStr([地番],'-')=0,Val([地番]),val(Left([地番],InStr([地番],'-')-1)))) *1000 + Val(IIf(IsNull([地番]),0,IIf(InStr([地番],'-')=0,0,val(Mid([地番],InStr([地番],'-')+1))))))"
                                    Set Rs = SystemDB.GetRecordsetEx(sSQL, 1, , "事業計画変更申請")
                                    St = "": i = 0
                                    Do Until Rs.EOF
                                        n = Rs.NullCast("田面積", 0) + Rs.NullCast("畑面積", 0)
                                        If n = 0 Then n = Rs.NullCast("実面積", 0)
                                        If i > 0 Then St = St & vbCrLf
                                        St = St & Rs.V("土地所在") & ";" & Rs.V("登記地目") & ";" & Rs.V("現況") & ";" & n
                                        i = i + 1
                                        Rs.MoveNext
                                    Loop
                                    SystemDB.CloseRs Rs
                                    .Value("変更前土地一覧Grid") = St
                                End If
                            End If
                        End If
                    End Select
                Case Else
                    Debug.Assert CaseAssertPrint(sOption, "")
            End Select
        End With
    End Sub

    Private Property Set CDataviewSK_DVProperty(ByVal RHS As ADBasicLIB2.CDataviewProperty): Set DVProperty = RHS: End Property
    Private Property Get CDataviewSK_DVProperty() As ADBasicLIB2.CDataviewProperty: Set CDataviewSK_DVProperty = DVProperty: End Property

    Private Function CDataviewSK_GetProperty2(sPropName As String, Optional sParam As String = "") As Variant
        Dim St As String
        
        Select Case sPropName
            Case "名称":
                If Len(DVProperty.Rs.Value("名称")) Then
                    CDataviewSK_GetProperty2 = DVProperty.Rs.Value("名称")
                Else
                    Select Case DVProperty.Rs.Value("法令")
                        Case state4条転用: CDataviewSK_GetProperty2 = DVProperty.Rs.Value("氏名A") & "(４条転用)"
                        Case Else
                            Debug.Assert False
                    End Select
                    DVProperty.Rs.Update "名称", CDataviewSK_GetProperty2
                End If
            Case "申請世帯A":  CDataviewSK_GetProperty2 = IIf(DVProperty.Rs.Value("申請世帯A") = "", 0, DVProperty.Rs.Value("申請世帯A"))
            Case "土地IDリスト":
                St = Fnc.NullCast(DVProperty.Rs.Value("農地リスト"), "NULL")
                CDataviewSK_GetProperty2 = Replace(Replace(Replace(St, "転用農地.", ""), "農地.", ""), ";", ",")
            Case "メニュー"
                St = "開く;-;"
                Select Case mvarState
                    Case 0: St = St & "審査にする;"
                    Case 1: St = St & "受付に戻す;"
                    Case 2: St = St & "許可書の再発行;"
                End Select
                CDataviewSK_GetProperty2 = St
            Case "個人リスト": CDataviewSK_GetProperty2 = Replace(Replace(DVProperty.Rs.Value("個人リスト"), "対象者.", ""), ";", ",")
            Case Else: CDataviewSK_GetProperty2 = Fnc.NullCast(DVProperty.Rs.Value(sPropName), "")
        End Select
    End Function

    Private Property Get CDataviewSK_IconName() As String: CDataviewSK_IconName = "Apply": End Property

    Private Property Let CDataviewSK_Key(ByVal RHS As String): DVProperty.Key = RHS: End Property
    Private Property Get CDataviewSK_Key() As String: CDataviewSK_Key = DVProperty.Key: End Property

    Private Property Get CDataviewSK_ParentKey() As String
        Debug.Assert False 'Non Code
    End Property

    Private Sub sub許可(Optional bCont As Boolean = False)
        Dim St As String
        Dim StX As String
        Dim pObj As Object
        Dim SD As String
        Dim pDic As CDataDictionary
        Dim n As Long
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim s法令 As String
        
        If Not IsDate(DVProperty.Rs.Value("受付年月日")) Then
            MsgBox "受付年月日が設定されていません。", vbCritical
            Exit Sub
        ElseIf IsNull(DVProperty.Rs.Value("農地リスト")) Then
            MsgBox "農地が登録されていません。", vbCritical
            Exit Sub
        End If
        
        CDataviewSK_DoCommand2 "更新"
        If bCont Then
            SD = CStr(DateSerial(Year(DVProperty.Rs.Value("受付年月日")), Month(DVProperty.Rs.Value("受付年月日")), 28))
        Else
            Set Rs = SystemDB.GetRecordsetEx("SELECT * FROM [D_PSTRING] WHERE [開始日]<=#" & DVProperty.Rs.Value("受付年月日") & "# AND [終了日]>=#" & DVProperty.Rs.Value("受付年月日") & "#", 0, , Me)
            If Not Rs.EOF Then
                St = CStr(Rs.NullCast("総会日", ""))
            End If
            Rs.CloseRs
            If Len(St) = 0 Then
                St = CStr(DateSerial(DVProperty.Rs.Year("受付年月日"), DVProperty.Rs.Month("受付年月日"), 28))
            End If
            Select Case DVProperty.Rs.Value("法令")
                Case state奨励金交付A, state奨励金交付B:
                    Set pDic = SysAD.MDIForm.InputMulti("交付決定", "以下の項目を入力してください", "交付決定番号;数値;" & DVProperty.Rs.Value("受付番号") & ";|交付決定年月日;日付;" & St & ";")
                    If Not pDic Is Nothing Then
                        If IsDate(pDic.Item("交付決定年月日")) Then
                            DVProperty.Rs.Update "許可番号", Val(pDic.Item("交付決定番号"))
                            SD = pDic.Item("交付決定年月日")
                        End If
                    End If
                Case Else
                    SD = Fnc.InputText("許可年月日", "許可年月日を入力してください", St, 0, 0)
            End Select
        End If
        
        If IsDate(SD) Then
            Select Case DVProperty.Rs.Value("法令")
                Case state3条所有権, state県3条所有権: sub異動from農地法3条 CDate(SD), DVProperty.Rs.Value("農地リスト"), SystemDB.GetDirectData("D:個人Info", "世帯ID", DVProperty.Rs.Value("申請者B")), DVProperty.Rs.Value("申請者B"), DVProperty.ID: s法令 = "3条"
                Case state3条賃借権, state県3条賃借権: LandRent CDate(SD), DVProperty.Rs.Value("法令"): s法令 = "3条"
                Case state4条転用: mod農家台帳.sub農地転用 DVProperty.Key, 10040: s法令 = "4条"
                Case state5条所有権: mod農家台帳.sub農地転用 DVProperty.Key, 10050: s法令 = "5条"
                Case state5条賃借権: mod農家台帳.sub農地転用 DVProperty.Key, 10050: s法令 = "5条"
                Case state基盤所有権設定: sub異動from基盤強化法 CDate(SD), DVProperty.Rs.Value("農地リスト"), Val(SystemDB.GetDirectData("D:個人Info", "世帯ID", DVProperty.Rs.Value("申請者B"))), DVProperty.Rs.Value("申請者B"), DVProperty.ID
                Case state基盤利用権移転, state基盤利用権設定: LandRent CDate(SD), DVProperty.Rs.Value("法令")
                Case state20条解約: RentEnd CDate(SD), "20条解約"
                Case state合意解約: RentEnd CDate(SD), "合意解約"
                Case state農地利用変更, state農用地計画変更: UseChange CDate(SD), DVProperty.Rs.Value("法令"), DVProperty.Rs.Value("区分")
                Case state事業計画変更:
                Case Else
                    Debug.Assert CaseAssertPrint(DVProperty.Rs.Value("法令"), "")
            End Select
            DVProperty.Rs.Update "許可年月日", CStr(CDate(SD))
            DVProperty.Rs.Update "許可補助記号", IIf(IsNull(ADApp.User.v支所符号), Null, ADApp.User.v支所符号)

            If Not (DVProperty.Rs.Value("法令") = 30 Or DVProperty.Rs.Value("法令") = 31 Or DVProperty.Rs.Value("法令") = 40 Or DVProperty.Rs.Value("法令") = 50 Or DVProperty.Rs.Value("法令") = 51 Or DVProperty.Rs.Value("法令") = 61) Then
            ElseIf bCont Then
            ElseIf DVProperty.Rs.Value("法令") = 61 Then
                If MsgBox("通知書を発行しますか", vbYesNo) = vbYes Then
                    If Val(SystemDB.DBProperty("決定通知番号指定")) > 0 Then
                        Select Case SystemDB.DBProperty("許可番号生成ルール")
                            Case 0:    n = DVProperty.Rs.Value("通年受付番号")
                            Case 1:    n = SystemDB.MaxID("D_申請", "許可番号", "[法令]=61 AND [状態]=2") + 1
                            Case Else: n = DVProperty.Rs.Value("受付番号")
                        End Select
                    End If
                    With Fnc.InputData("通知書発行", "発行番号等を入力してください", Me, GetArray("発行番号;数値;" & n, "発効日;日付;" & Now(), "公告年月日;日付;" & DVProperty.Rs.NullCast("公告年月日", Now)))
                        If .IsObtained Then
                            If .Exists("発行番号") Then DVProperty.Rs.Update "許可番号", Val(.Item("発行番号"))
                            If .IsDate("公告年月日") Then DVProperty.Rs.Update "公告年月日", .Item("公告年月日")
                            SysAD.ApplicationDLL.Form.PrintGo SysAD.ApplicationDLL.ObjectMan.GetObject("許可書"), "利用権." & Fnc.GetKeyCode(DVProperty.Key) & vbFormFeed & .Item("発効日")
                        End If
                    End With
                End If
            Else
                If (Not Val(SystemDB.DBProperty("県許可"))) And (DVProperty.Rs.Value("法令") = "40" Or DVProperty.Rs.Value("法令") = "50" Or DVProperty.Rs.Value("法令") = "51") Then
                Else
                    Select Case Val(SystemDB.DBProperty("許可番号生成ルール"))
                        Case 0:    n = DVProperty.Rs.NullCast("通年受付番号", 0)
                        Case 1:    n = SystemDB.MaxID("D_申請", "許可番号", "([法令]=30 OR [法令]=31) AND [状態]=2") + 1
                        Case Else: n = DVProperty.Rs.NullCast("受付番号", 0)
                    End Select
                    If MsgBox("許可書を発行しますか", vbYesNo) = vbYes Then
                        With Fnc.InputData("許可書発行", "発行番号等を入力してください", Me, GetArray("発行番号;数値;" & n, "発効日;日付;" & Now(), "公告年月日;日付;" & DVProperty.Rs.NullCast("公告年月日", Now)))
                            If .IsObtained Then
                                If .Exists("発行番号") Then DVProperty.Rs.Update "許可番号", Val(.Item("発行番号"))
                                If .IsDate("公告年月日") Then DVProperty.Rs.Update "公告年月日", .Item("公告年月日")
                                SysAD.ApplicationDLL.Form.PrintGo SysAD.ApplicationDLL.ObjectMan.GetObject("許可書"), s法令 & "." & Fnc.GetKeyCode(DVProperty.Key) & vbFormFeed & .Item("発効日")
                            End If
                        End With
                    Else
                        St = Fnc.InputText("許可番号", "許可番号を入力してください", n, 1, 0)
                        If Val(St) > 0 Then
                            DVProperty.Rs.Update "許可番号", Val(St)
                        End If
                    End If
                End If
            End If
            
            DVProperty.Rs.Update "状態", 2
            mvarState = 2
        End If
        CDataviewSK_DoCommand2 "閉じる"
        mvarPDW.SQLListview.Refresh
        If Not bCont Then GridRefresh
    End Sub

    Private Sub sub履歴のみ(Optional bCont As Boolean = False)
        Dim St As String
        Dim StX As String
        Dim pObj As Object
        Dim SD As String
        Dim pDic As CDataDictionary
        Dim n As Long
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim s法令 As String
        
        If Not IsDate(DVProperty.Rs.Value("受付年月日")) Then
            MsgBox "受付年月日が設定されていません。", vbCritical
            Exit Sub
        ElseIf IsNull(DVProperty.Rs.Value("農地リスト")) Then
            MsgBox "農地が登録されていません。", vbCritical
            Exit Sub
        End If
        
        CDataviewSK_DoCommand2 "更新"
        If bCont Then
            SD = CStr(DateSerial(Year(DVProperty.Rs.Value("受付年月日")), Month(DVProperty.Rs.Value("受付年月日")), 28))
        Else
            Set Rs = SystemDB.GetRecordsetEx("SELECT * FROM [D_PSTRING] WHERE [開始日]<=#" & DVProperty.Rs.Value("受付年月日") & "# AND [終了日]>=#" & DVProperty.Rs.Value("受付年月日") & "#", 0, , Me)
            If Not Rs.EOF Then
                St = CStr(Rs.NullCast("総会日", ""))
            End If
            Rs.CloseRs
            If Len(St) = 0 Then
                St = CStr(DateSerial(DVProperty.Rs.Year("受付年月日"), DVProperty.Rs.Month("受付年月日"), 28))
            End If
            
'            Select Case DVProperty.Rs.Value("法令")
'                Case state奨励金交付A, state奨励金交付B:
'                    Set pDic = SysAD.MDIForm.InputMulti("交付決定", "以下の項目を入力してください", "交付決定番号;数値;" & DVProperty.Rs.Value("受付番号") & ";|交付決定年月日;日付;" & St & ";")
'                    If Not pDic Is Nothing Then
'                        If IsDate(pDic.Item("交付決定年月日")) Then
'                            DVProperty.Rs.Update "許可番号", Val(pDic.Item("交付決定番号"))
'                            SD = pDic.Item("交付決定年月日")
'                        End If
'                    End If
'                Case Else
                    SD = Fnc.InputText("許可年月日", "許可年月日を入力してください", St, 0, 0)
'            End Select
        End If
        
        If IsDate(SD) Then
            Select Case DVProperty.Rs.Value("法令")
                Case state3条所有権, state県3条所有権: sub異動from農地法3条 CDate(SD), DVProperty.Rs.Value("農地リスト"), SystemDB.GetDirectData("D:個人Info", "世帯ID", DVProperty.Rs.Value("申請者B")), DVProperty.Rs.Value("申請者B"), DVProperty.ID, True: s法令 = "3条"
                Case state3条賃借権, state県3条賃借権: LandRent CDate(SD), DVProperty.Rs.Value("法令"), True: s法令 = "3条"
                Case state4条転用: mod農家台帳.sub農地転用 DVProperty.Key, 10040, True: s法令 = "4条"
                Case state5条所有権: mod農家台帳.sub農地転用 DVProperty.Key, 10050, True: s法令 = "5条"
                Case state5条賃借権: mod農家台帳.sub農地転用 DVProperty.Key, 10050, True: s法令 = "5条"
                Case state基盤所有権設定: sub異動from基盤強化法 CDate(SD), DVProperty.Rs.Value("農地リスト"), Val(SystemDB.GetDirectData("D:個人Info", "世帯ID", DVProperty.Rs.Value("申請者B"))), DVProperty.Rs.Value("申請者B"), DVProperty.ID
                Case state基盤利用権移転, state基盤利用権設定: LandRent CDate(SD), DVProperty.Rs.Value("法令"), True
'                Case state20条解約: RentEnd CDate(SD), "20条解約"
'                Case state合意解約: RentEnd CDate(SD), "合意解約"
'                Case state農地利用変更, state農用地計画変更: UseChange CDate(SD), DVProperty.Rs.Value("法令"), DVProperty.Rs.Value("区分")
'                Case state事業計画変更:
                Case Else
                    Debug.Assert CaseAssertPrint(DVProperty.Rs.Value("法令"), "")
            End Select
            
            DVProperty.Rs.Update "許可年月日", CStr(CDate(SD))
            DVProperty.Rs.Update "許可補助記号", IIf(IsNull(ADApp.User.v支所符号), Null, ADApp.User.v支所符号)

            DVProperty.Rs.Update "状態", 2
            mvarState = 2
        End If
        CDataviewSK_DoCommand2 "閉じる"
'        mvarPDW.SQLListview.Refresh
'        If Not bCont Then GridRefresh
    End Sub

    Private Sub sub不許可(Optional bCont As Boolean = False)
        Dim St As String
        Dim pObj As Object
        Dim SD As String
        Dim n As Long
        
        CDataviewSK_DoCommand2 "更新"
        If bCont Then
            SD = CStr(DateSerial(Year(DVProperty.Rs.Value("受付年月日")), Month(DVProperty.Rs.Value("受付年月日")), 28))
        Else
            SD = Fnc.InputText("不許可決定の年月日", "不許可を決定した年月日を入力してください", CStr(DateSerial(Year(DVProperty.Rs.Value("受付年月日")), Month(DVProperty.Rs.Value("受付年月日")), 28)), 0, 0)
        End If
        
        If IsDate(SD) Then
            
            DVProperty.Rs.Update "許可年月日", CStr(CDate(SD))
            DVProperty.Rs.Update "許可補助記号", IIf(IsNull(ADApp.User.v支所符号), Null, ADApp.User.v支所符号)
            
            If Not (DVProperty.Rs.Value("法令") = 30 Or DVProperty.Rs.Value("法令") = 31) Then
            ElseIf bCont Then
            ElseIf MsgBox("不許可に関する書類を発行しますか", vbYesNo) = vbYes Then
                n = DVProperty.Rs.Value("受付番号")
                With Fnc.InputData("不許可番号", "不許可の発行番号を入力してください", Me, GetArray("発行番号;数値;" & n, "発効日;日付;" & Now()))
                    If .IsObtained Then
                        If .Exists("発行番号") Then DVProperty.Rs.Update "許可番号", Val(.Item("発行番号"))
                        SysAD.ApplicationDLL.Form.PrintGo SysAD.ApplicationDLL.ObjectMan.GetObject("許可書"), "3条." & Fnc.GetKeyCode(DVProperty.Key) & "不許可" & vbFormFeed & .Item("発効日")
                    End If
                End With
            End If
            
            DVProperty.Rs.Update "状態", 42
            mvarState = 42
        End If
        CDataviewSK_DoCommand2 "閉じる"
        mvarPDW.SQLListview.Refresh
        If Not bCont Then GridRefresh
    End Sub

    Private Function CDataviewSK_PopupMenu(Optional ByVal sParam As String = "", Optional vParam As Variant) As String
        Dim St As String
        Dim pObj As Object
        Dim SD As String
        Dim b県許可 As Boolean
        Dim b土地管理 As Boolean
        Dim Rs As ADBasicLIB2.RecordsetEx

        Set Rs = SystemDB.GetRecordsetEx("SELECT * FROM D_土地管理 WHERE [ID]=" & DVProperty.ID & ";", , , Me)
            b土地管理 = Not Rs.IsNoRecord
        SystemDB.CloseRs Rs
        
        If sParam = "シフト" Then
            St = "データを開く;-;"
        Else
            St = "開く;-;"
        End If
        If DVProperty.Rs.Value("法令") <= state5条賃借権 Or DVProperty.Rs.Value("法令") = state非農地証明 Or DVProperty.Rs.Value("法令") = state農地利用変更 Or DVProperty.Rs.Value("法令") = state事業計画変更 Or (DVProperty.Rs.Value("法令") >= state買受適格耕公 And DVProperty.Rs.Value("法令") <= state買受適格転競) Then
            St = St & "受付・交付簿;-;"
        End If
        
        Select Case mvarState
            Case 0:
                Select Case DVProperty.Rs.Value("法令")
                    Case state3条所有権, state3条賃借権, state県3条所有権, state県3条賃借権:
                        St = St & "審査にする;許可する;-;履歴だけ作成して許可状態;"
                    Case state4条転用:
                        St = St & "４条：申請者を呼ぶ;４条：転用済み農地の一覧;-;審査にする;許可する;"
                    Case state5条所有権, state5条賃借権:
                        St = St & "審査にする;許可する;-;履歴だけ作成して許可状態;"
                    Case state基盤利用権設定, state基盤所有権設定, state基盤利用権移転:
                        St = St & "審査にする;許可する;-;履歴だけ作成して許可状態;"
                    Case state20条解約, state合意解約
                        St = St & "処理する;"
                    Case state奨励金交付A, state奨励金交付B
                        St = St & "申請書一括印刷;-;受付設定;-;許可する;"
                    Case state事業計画変更, state農地利用変更, state農用地計画変更:
                        St = St & "審査にする;承認する;"
                    Case stateあっせん出手, stateあっせん受手:
                        St = St & "審査にする;"
                    Case Else
                        St = St & "審査にする;許可する;"
                End Select
            Case 1:
                Select Case DVProperty.Rs.Value("法令")
                    Case state3条所有権, state3条賃借権
                        St = St & "許可する;不許可にする;受付に戻す;"
                    Case state4条転用
                        St = St & "許可する;不許可にする;受付に戻す;"
                    Case state5条所有権, state5条賃借権
                        St = St & "許可する;不許可にする;受付に戻す;"
                    Case state基盤利用権設定
                        St = St & "承認する;受付に戻す;"
                    Case state事業計画変更, state農用地計画変更, state農地利用変更:
                        St = St & "承認する;受付に戻す;"
                    Case stateあっせん出手, stateあっせん受手: St = St & "受付に戻す;"
                    Case Else
                        St = St & "許可する;受付に戻す;"
                End Select
            Case 2:
                b県許可 = SystemDB.DBProperty("県許可")
                Select Case DVProperty.Rs.Value("法令")
                    Case state3条所有権, state3条賃借権: St = St & "審査に戻す;-;許可書の再発行;-;土地管理情報;" & IIf(b土地管理, "土地管理再作成;", "")
                    Case state県3条所有権, state県3条賃借権
                        If b県許可 Then
                            St = St & "審査に戻す;-;許可書の再発行;-;土地管理情報;" & IIf(b土地管理, "土地管理再作成;", "")
                        Else
                            St = St & "審査に戻す;-;土地管理情報;" & IIf(b土地管理, "土地管理再作成;", "")
                        End If
                    Case state4条転用
                        If b県許可 Then
                            St = St & "４条：申請者を呼ぶ;４条：転用済み農地の一覧;-;審査に戻す;-;許可書の再発行;-;事業計画変更申請;-;土地管理情報;" & IIf(b土地管理, "土地管理再作成;", "")
                        Else
                            St = St & "４条：申請者を呼ぶ;４条：転用済み農地の一覧;-;審査に戻す;-;事業計画変更申請;-;土地管理情報;" & IIf(b土地管理, "土地管理再作成;", "")
                        End If
                    Case state5条所有権, state5条賃借権
                        If b県許可 Then
                            St = St & "審査に戻す;-;事業計画変更申請;-;許可書の再発行;-;土地管理情報;" & IIf(b土地管理, "土地管理再作成;", "")
                        Else
                            St = St & "審査に戻す;-;事業計画変更申請;-;土地管理情報;" & IIf(b土地管理, "土地管理再作成;", "")
                        End If
                    Case state奨励金交付A, state奨励金交付B: St = St & "審査に戻す;-;交付設定;交付決定通知書;"
                    Case state20条解約, state合意解約: St = St & "土地管理情報;" & IIf(b土地管理, "土地管理再作成;", "")
                    Case state農地利用変更:
                        St = St & "土地管理情報;" & IIf(b土地管理, "土地管理再作成;", "")
                    Case state農用地計画変更:
                        St = St & "受付に戻す;"
                    Case Else:  St = St & "審査に戻す;"
                End Select
            Case 42:
                St = St & "審査に戻す;-;不許可書の再発行;"
        End Select
        If Val(SysAD.ApplicationDLL.Common.AppData("内部地図")) Then
            St = St & "-;地図呼び出し;"
        ElseIf SysAD.地図の有無 Then
            St = St & "-;申請農地を地図に表示;"
        End If
        St = St & "-;名称の修正;エクスポート;削除;"
        
        If Not DVProperty.Body Is Nothing Then St = St & "閉じる;"
        
        St = SysAD.PopupMenu(St)
        CDataviewSK_PopupMenu = St
        Select Case St
            Case "審査に戻す"
                SystemDB.SetDirectData "D_申請", "状態", 1, Fnc.GetKeyCode(DVProperty.Key)
                mvarState = 1
                mvarPDW.SQLListview.Refresh
                GridRefresh
            Case "審査にする":
                SystemDB.SetDirectData "D_申請", "状態", 1, Fnc.GetKeyCode(DVProperty.Key)
                mvarState = 1
                mvarPDW.SQLListview.Refresh
                GridRefresh
            Case "受付に戻す":
                SystemDB.SetDirectData "D_申請", "状態", 0, Fnc.GetKeyCode(DVProperty.Key)
                mvarState = 0
                mvarPDW.SQLListview.Refresh
                GridRefresh
            Case "許可する", "処理する": sub許可
            Case "エクスポート":
                FileExport
            Case "不許可にする": sub不許可
            Case "不許可書の再発行": sub不許可
            Case "許可書の再発行":
                With Fnc.InputData("発効日", "発効日を入力してください", Me, "発効日;日付;" & Now())
                    If .IsObtained And .IsDate("発効日") Then SysAD.ApplicationDLL.Form.PrintGo SysAD.ApplicationDLL.ObjectMan.GetObject("許可書"), Left(DVProperty.Rs.Value("法令"), 1) & "条." & Fnc.GetKeyCode(DVProperty.Key) & vbFormFeed & .Item("発効日")
                End With
            Case "決定通知書":
                With Fnc.InputData("発効日", "発効日を入力してください", Me, "発効日;日付;" & Now())
                    If .IsObtained And .IsDate("発効日") Then SysAD.ApplicationDLL.Form.PrintGo SysAD.ApplicationDLL.ObjectMan.GetObject("許可書"), "利用権." & Fnc.GetKeyCode(DVProperty.Key) & vbFormFeed & .Item("発効日")
                End With
            Case "閉じる": ADApp.DataviewCol.Remove DVProperty.Key
            Case ""
            Case "名称の修正"
                With DVProperty.Rs
                    Select Case .Value("法令")
                        Case state3条所有権: .Update "名称", .NullCast("氏名A", "") & "(３条所有権)→" & .NullCast("氏名B", "")
                        Case state3条賃借権: .Update "名称", .NullCast("氏名A", "") & "(３条貸借権)→" & .NullCast("氏名B", "")
                        Case state県3条所有権: .Update "名称", .NullCast("氏名A", "") & "(県３条所有権)→" & .NullCast("氏名B", "")
                        Case state県3条賃借権: .Update "名称", .NullCast("氏名A", "") & "(県３条貸借権)→" & .NullCast("氏名B", "")
                        Case state5条所有権: .Update "名称", .NullCast("氏名A", "") & "(５条所有権)→" & .NullCast("氏名B", "")
                        Case state5条賃借権: .Update "名称", .NullCast("氏名A", "") & "(５条貸借権)→" & .NullCast("氏名B", "")
                        Case state基盤利用権設定: .Update "名称", .NullCast("氏名A", "") & "(利用権設定)→" & .NullCast("氏名B", "")
                        
                        Case Else
                            Debug.Assert CaseAssertPrint(.Value("法令"))
                    End Select
                End With
                mvarPDW.SQLListview.Refresh
            Case Else
                CDataviewSK_DoCommand2 St
        End Select
    End Function

    Private Sub CDataviewSK_Refresh(Optional bReLoad As Boolean = False)
        Debug.Assert False 'Non Code
    End Sub

    Private Sub GridRefresh()
        If Not mvarPDW.TabPages("申請受付") Is Nothing Then
            mvarPDW.TabPages("申請受付").Refresh
        End If
    End Sub

    Private Sub LandRent(ByVal dt許可日 As Date, ByVal nState As Long, Optional b無異動 As Boolean = False)
        Dim St As String
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim sNameA As String
        Dim sNameB As String
        Dim n小作形態 As Long

        St = Replace(Replace(DVProperty.Rs.Value("農地リスト"), "農地.", ""), ";", ",")
        
        Set Rs = SystemDB.GetRecordsetEx("SELECT * FROM [D:農地Info] Where [ID] In (" & St & ")", , , Me)
        Do Until Rs.EOF
            If Not b無異動 Then
                Rs.Value("自小作別") = IIf(DVProperty.Rs.Value("年金関連"), 2, 1)
                Rs.Value("借受人ID") = DVProperty.Rs.Value("申請者B")
                Rs.Value("借受世帯ID") = SystemDB.GetDirectData("D:個人Info", "世帯ID", DVProperty.Rs.Value("申請者B"))
                Select Case nState
                    Case 30, 31: Rs.Value("小作地適用法") = 1
                    Case Else: Rs.Value("小作地適用法") = 2
                End Select
                If DVProperty.Rs.Value("筆優先") = False Then
                    Rs.Value("小作形態") = DVProperty.Rs.Value("権利種類")
                    Rs.Value("小作開始年月日") = DVProperty.Rs.Value("始期")
                    Rs.Value("小作終了年月日") = DVProperty.Rs.Value("終期")
                    Rs.Value("小作料") = Val(DVProperty.Rs.Value("小作料"))
                    Rs.Value("小作料単位") = DVProperty.Rs.Value("小作料単位")
                    n小作形態 = Val(DVProperty.Rs.Value("権利種類"))
                Else
                    Rs.Value("小作形態") = DVProperty.Rs.Value("権利種類")
                    Rs.Value("小作開始年月日") = DVProperty.Rs.Value("始期")
                    Rs.Value("小作終了年月日") = DVProperty.Rs.Value("終期")
'                    Rs.Value("小作料") = Val(DVProperty.Rs.Value("小作料"))
'                    Rs.Value("小作料単位") = DVProperty.Rs.Value("小作料単位")
                    n小作形態 = Val(DVProperty.Rs.Value("権利種類"))
'
'                    Rs.Value("小作開始年月日") = Rs.Value("利用権開始申請日")
'                    Rs.Value("小作終了年月日") = Rs.Value("利用権終了申請日")
                    n小作形態 = Rs.Value("小作形態")
                End If
                Rs.Value("公告年月日") = IIf(IsDate(DVProperty.Rs.Value("公告年月日")), DVProperty.Rs.Value("公告年月日"), dt許可日)
                
                sNameA = SystemDB.GetDirectData("D:個人Info", "氏名", DVProperty.Rs.Value("申請者A"))
                sNameB = SystemDB.GetDirectData("D:個人Info", "氏名", DVProperty.Rs.Value("申請者B"))
                
                If Not IsNull(DVProperty.Rs.Value("経由法人ID")) And Val(DVProperty.Rs.Value("経由法人ID")) <> 0 Then
                    Rs.Value("農業生産法人経由貸借") = True
                    Rs.Value("経由農業生産法人ID") = DVProperty.Rs.Value("経由法人ID")
                Else
                    Rs.Value("農業生産法人経由貸借") = False
                    Rs.Value("経由農業生産法人ID") = 0
                End If
                
                Rs.Update
            End If
            If DVProperty.Rs.Value("再設定") Then
                SystemDB.ExecuteSQL "INSERT INTO D_土地履歴 ( LID, 更新日, 異動日, 異動事由, 行政区, 内容 ) VALUES(" & Rs.Value("ID") & ",CDate('" & Format(dt許可日, "GEE/MM/DD") & "'),CDate('" & Format(dt許可日, "GEE/MM/DD") & "'), " & (10000 + nState) & ",0, '" & sNameA & "→" & sNameB & "へ" & SystemDB.GetDirectDataWithClass("M_BASICALL", "名称", "小作形態", n小作形態) & "[再設定] " & DVProperty.Rs.FormatS("始期", "GE.M.D") & "-" & DVProperty.Rs.FormatS("終期", "GE.M.D") & "');"
            Else
                SystemDB.ExecuteSQL "INSERT INTO D_土地履歴 ( LID, 更新日, 異動日, 異動事由, 行政区, 内容 ) VALUES(" & Rs.Value("ID") & ",CDate('" & Format(dt許可日, "GEE/MM/DD") & "'),CDate('" & Format(dt許可日, "GEE/MM/DD") & "'), " & (10000 + nState) & ",0, '" & sNameA & "→" & sNameB & "へ" & SystemDB.GetDirectDataWithClass("M_BASICALL", "名称", "小作形態", n小作形態) & " " & DVProperty.Rs.FormatS("始期", "GE.M.D") & "-" & DVProperty.Rs.FormatS("終期", "GE.M.D") & "');"
            End If
            
            Rs.MoveNext
        Loop
        Rs.CloseRs
    End Sub

    Private Sub RentEnd(ByVal dt解約日 As Date, ByVal st解約 As String)
        Dim St As String
        Dim Rs As ADBasicLIB2.RecordsetEx

        St = Replace(Replace(DVProperty.Rs.NullCast("農地リスト", ""), "農地.", ""), ";", ",")
        If Len(St) Then
        Set Rs = SystemDB.GetRecordsetEx("SELECT * FROM [D:農地Info] Where [ID] In (" & St & ")", , , Me)
        If Not Rs.EOF Then Rs.MoveFirst
        Do Until Rs.EOF
            Rs.Value("自小作別") = 0
            Rs.Value("公告年月日") = dt解約日
            SystemDB.ExecuteSQL "INSERT INTO D_土地履歴 ( LID, 更新日, 異動日, 異動事由, 行政区, 内容 ) VALUES(" & Rs.Value("ID") & ",#" & dt解約日 & "#,#" & dt解約日 & "#, 10020,0, '" & st解約 & "');"
            Rs.Update
            Rs.MoveNext
        Loop
        End If
    End Sub

    Private Sub UseChange(ByVal dt許可日 As Date, ByVal nState As Long, ByVal n区分 As Long)
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim s区分 As String
        Dim s変更前 As String
        Dim s履歴 As String
        Dim St As String
        
        Select Case nState
            Case state非農地証明
                St = Replace(Replace(DVProperty.Rs.Value("農地リスト"), "転用農地.", ""), ";", ",")
                St = Replace(Replace(St, "農地.", ""), ";", ",")
                Set Rs = SystemDB.GetRecordsetEx("SELECT * FROM [D:農地Info] Where [ID] In (" & St & ")", , , Me)
                Do Until Rs.EOF
                    SystemDB.ExecuteSQL "INSERT INTO D_転用農地 SELECT [D:農地Info].* FROM [D:農地Info] WHERE ((([D:農地Info].ID)=" & Rs.ID & "));"
                    SystemDB.ExecuteSQL "INSERT INTO D_土地履歴 ( LID, 更新日, 異動日, 異動事由, 行政区, 内容 ) VALUES(" & Rs.ID & ",#" & dt許可日 & "#,#" & dt許可日 & "#, 0,0, '非農地証明');"
                    SystemDB.ExecuteSQL "DELETE [D:農地Info].ID FROM [D:農地Info] WHERE ((([D:農地Info].ID)=" & Rs.ID & "));"
                    
                    Rs.MoveNext
                Loop
                Rs.CloseRs
            
            Case state農地利用変更
                s区分 = SystemDB.GetDirectDataWithClass("M_BASICALL", "名称", "農地地目", n区分)
                St = Replace(Replace(DVProperty.Rs.Value("農地リスト"), "農地.", ""), ";", ",")
                Set Rs = SystemDB.GetRecordsetEx("SELECT * FROM [D:農地Info] Where [ID] In (" & St & ")", , , Me)
                Do Until Rs.EOF
                    s変更前 = SystemDB.GetDirectDataWithClass("M_BASICALL", "名称", "地目", Rs.Value("現況地目"))
                    If n区分 <> 0 Then
                        Rs.Value("現況地目") = n区分
                        Rs.Value("田面積") = 0
                        Rs.Value("畑面積") = 0
                        Rs.Value("樹園地") = 0
                        Rs.Value("採草放牧面積") = 0
                        Select Case s区分
                            Case "田": Rs.Value("田面積") = Rs.Value("実面積")
                            Case "畑": Rs.Value("畑面積") = Rs.Value("実面積")
                        End Select
                        Rs.Update
                    End If
                    If s区分 <> "" And s変更前 <> "" Then
                        s履歴 = "(" & s変更前 & "から" & s区分 & "へ）"
                    Else
                        s履歴 = ""
                    End If
                    SystemDB.ExecuteSQL "INSERT INTO D_土地履歴 ( LID, 更新日, 異動日, 異動事由, 行政区, 内容 ) VALUES(" & Rs.Value("ID") & ",#" & dt許可日 & "#,#" & dt許可日 & "#, 0,0, '" & "農地利用変更" & s履歴 & "');"
                    Rs.MoveNext
                Loop
                SystemDB.CloseRs Rs
                
            Case state農用地計画変更
                s区分 = SystemDB.GetDirectDataWithClass("M_BASICALL", "名称", "農用地変更区分", n区分)
                St = Replace(Replace(DVProperty.Rs.Value("農地リスト"), "農地.", ""), ";", ",")
                Set Rs = SystemDB.GetRecordsetEx("SELECT * FROM [D:農地Info] Where [ID] In (" & St & ")", , , Me)
                Do Until Rs.EOF
                    If n区分 <> 0 And s区分 <> "" Then
                        s履歴 = "(" & s区分 & "）"
                    Else
                        s履歴 = ""
                    End If
                    SystemDB.ExecuteSQL "INSERT INTO D_土地履歴 ( LID, 更新日, 異動日, 異動事由, 行政区, 内容 ) VALUES(" & Rs.Value("ID") & ",#" & dt許可日 & "#,#" & dt許可日 & "#, 0,0, '" & "農用地計画変更" & s履歴 & "');"
                    Rs.MoveNext
                Loop
                SystemDB.CloseRs Rs
        End Select
    End Sub

    Private Sub FileExport()
        Dim sFile     As String
        Dim St As String
        sFile = SysAD.MDIForm.SaveFileDlg("申請情報のエクスポート", "*.RRQ|*.RRQ", Fnc.Fs.GetSpecialFolderSH("DeskTop"))
        If Len(Replace(sFile, "No Select", "")) Then
            SystemDB.RecordsExport _
            GetArray("SELECT * FROM [D_申請] WHERE [ID]=" & DVProperty.ID _
            , "SELECT * FROM [D:農地Info] WHERE [ID] IN (" & Replace(Replace(DVProperty.V("農地リスト", ""), "転用農地.", ""), "農地.", "") & ")" _
            ), sFile
        End If
    End Sub

    Private Sub Class_Terminate()
        'If Not DVProperty.Containner Is Nothing Then DVProperty.Containner.RemoveCtrlwithCode DVProperty.UniqueCode
    End Sub

End Class










Class CObj世帯員
    Option Explicit
    Implements ADBasicLIB2.CDataviewSK
    
    Private DVProperty As CDataviewProperty
    Private Sub Class_Initialize(): Set DVProperty = mvarPDW.DataviewCol.GetNewDVP: End Sub

    '/****** ID型General_Key ******/
    Public Property Get Key() As String: Key = DVProperty.Key: End Property
    Public Property Let Key(ByVal RHS As String): DVProperty.SetDVP RHS, SystemDB, "SELECT * FROM [D:個人Info] WHERE [ID]=%DVP.ID%", Me: End Property
    '/****** ID型General_Key ******/
 
    '各DLL共通↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓
    Private Sub CDataviewSK_CloseRecordset(): DVProperty.CloseRs: End Sub

    Private Sub CDataviewSK_DblClick(): mvarPDW.DataviewCol.Add Me: End Sub
    '各DLL共通↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑
    
    Private Property Set CDataviewSK_Container(ByVal RHS As ADBasicLIB2.CPDW)
        Set DVProperty.Controls.Parent = Me
        Set DVProperty.Controls.Recordset = DVProperty.Rs
        Set DVProperty.Containner = RHS
         
        ADApp.Common.SetDataView "世帯員", DVProperty.Controls
        DVProperty.Controls.AttachData
    End Property

    Private Function CDataviewSK_DoCommand2(sCmd As String, Optional sParam As String = "") As Variant
        Dim St As String
        Dim n As Long
        Dim sSQL As String
        Dim sHeader As String
        Dim Rs As ADBasicLIB2.RecordsetEx
        
        On Error GoTo ExtDoCmd2
        Select Case sCmd
            '/*必須
            Case "開く": CDataviewSK_DblClick
            Case "閉じる": ADApp.DataviewCol.Remove DVProperty.Key
            Case "更新":
                DVProperty.Rs.Update "検索フリガナ", Fnc.あいまいカナ文字列(DVProperty.Rs.V("フリガナ"))
                DVProperty.Name = DVProperty.Rs.Value("氏名")
                DVProperty.Controls.UpdateControlValues
            Case "メニュー": CDataviewSK_PopupMenu
            '/*必須
            Case "基本台帳印刷":
                Select Case Fnc.s市町村名
                    Case "阿久根市", "日置市", "姶良市", "枕崎市", "南種子町", "長島町", "大崎町"
                        mvarPDW.PrintGo ADApp.ObjectMan.GetObject("農家基本台帳New2.0"), DVProperty.Key
                    Case Else
                        mvarPDW.PrintGo ADApp.ObjectMan.GetObject("農家基本台帳New.0"), DVProperty.Key
                End Select
            Case "選挙権の有無", "スペース":
                DVProperty.Rs.Update "選挙権の有無", Not DVProperty.Rs.Value("選挙権の有無")
                mvarPDW.SQLListview.Refresh DVProperty.Key
            Case "農業委員に設定": SystemDB.ExecuteSQL "INSERT INTO [M_BASICALL] VALUES(" & DVProperty.ID & ",'農業委員','" & DVProperty.Rs.Value("氏名") & "','農業委員管理',NULL,0,'" & Format$(Now(), "GGGEE/MM/DD") & "に設定')"
            Case "関連する議案一覧"
                St = "SELECT  '申請.' & [D_申請].[ID] AS [KEY],D_申請.名称, M_BASICALL.名称 AS 状態, D_申請.受付年月日, D_申請.許可年月日 " & _
                "FROM ([D:個人Info] LEFT JOIN D_申請 ON [D:個人Info].ID = D_申請.申請者A) LEFT JOIN M_BASICALL ON D_申請.状態 = M_BASICALL.ID " & _
                "WHERE ((([D:個人Info].ID)=" & DVProperty.ID & ") AND ((M_BASICALL.Class)='申請状況')) " & _
                "UNION SELECT '申請.' & [D_申請].[ID] AS [KEY], D_申請.名称, M_BASICALL.名称, D_申請.受付年月日, D_申請.許可年月日 " & _
                "FROM [D:個人Info] LEFT JOIN (D_申請 LEFT JOIN M_BASICALL ON D_申請.状態 = M_BASICALL.ID) ON [D:個人Info].ID = D_申請.申請者B " & _
                "WHERE ((([D:個人Info].ID)=" & DVProperty.ID & ") AND ((M_BASICALL.Class)='申請状況'));"

                mvarPDW.SQLListview.SQLListviewCHead St, "名称;名称;状態;状態;受付年月日;受付年月日;許可年月日;許可年月日", "関連申請"
            Case "削除":
                If Not DVProperty.Controls Is Nothing Then
                    MsgBox "操作画面が開いているので削除できません", vbCritical
                ElseIf MsgBox("本当に削除しますか", vbYesNo) = vbYes Then
                    CDataviewSK_DoCommand2 "閉じる"
                    DVProperty.CloseRs
                    SystemDB.ExecuteSQL "DELETE FROM [D:個人Info] WHERE [ID]=" & DVProperty.ID, "削除中"
                    mvarPDW.SQLListview.Refresh
                End If
            Case "認定農業者に設定": SystemDB.ExecuteSQL "UPDATE [D:個人Info] SET [農業改善計画認定] = 1 WHERE [ID] = " & DVProperty.ID & ";": mvarPDW.DoubleMessage "認定農業者に設定しました"
            Case "担い手農家に設定": SystemDB.ExecuteSQL "UPDATE [D:個人Info] SET [農業改善計画認定] = 2 WHERE [ID] = " & DVProperty.ID & ";": mvarPDW.DoubleMessage "担い手農家に設定しました"
            Case "農業生産法人に設定": SystemDB.ExecuteSQL "UPDATE [D:個人Info] SET [農業改善計画認定] = 3 WHERE [ID] = " & DVProperty.ID & ";": mvarPDW.DoubleMessage "農業生産法人に設定しました"
            Case "認定農業者＋担い手農家に設定": SystemDB.ExecuteSQL "UPDATE [D:個人Info] SET [農業改善計画認定] = 4 WHERE [ID] = " & DVProperty.ID & ";": mvarPDW.DoubleMessage "認定農業者＋担い手農家に設定しました"
            Case "世帯を呼ぶ": OpenParent
            Case "世帯の作成":
                If DVProperty.Rs.Value("世帯ID") = 0 Then
                    n = Fnc.DBGetMinID(SystemDB, "D:世帯INFO")
                ElseIf SystemDB.RecordExists("D:世帯Info", "[ID]=" & DVProperty.Rs.Value("世帯ID")) Then
                    Exit Function
                Else
                    n = DVProperty.Rs.Value("世帯ID")
                End If
                St = InputBox("世帯番号を入力してください", "世帯の追加", n)
                
                n = Val(St)
                If n Then
                    Dim pRs As ADBasicLIB2.RecordsetEx
                    Set pRs = SystemDB.GetRecordsetEx("SELECT * FROM [D:世帯INFO] WHERE [ID]=" & n, , , "世帯員DoCommand")
                    If pRs.EOF Then
                        SystemDB.CloseRs pRs
                        
                        Set pRs = SystemDB.GetRecordsetEx("SELECT * FROM [D:世帯INFO]", , , "世帯員DoCommand")
                        pRs.AddNewArray GetArray("ID", n, "世帯主ID", DVProperty.ID, "住所", DVProperty.Rs.Value("住所"), "行政区ID", DVProperty.Rs.Value("行政区ID"), "農地との関連", True)
                        mvarPDW.DataviewCol.Add ADApp.ObjectMan.GetObject("農家." & n)
                        SystemDB.ExecuteSQL "UPDATE [D:個人Info] SET [D:個人Info].世帯ID = " & n & " WHERE ((([D:個人Info].ID)=" & DVProperty.ID & "));"
                        SystemDB.CloseRs pRs
                        
                        St = ""
                        Set pRs = SystemDB.GetRecordsetEx("SELECT ID, 世帯ID FROM [D:個人Info] WHERE [世帯ID] = " & n, , , "世帯員DoCommand")
                        Do Until pRs.EOF
                            St = St & "," & pRs.Value("ID")
                            pRs.MoveNext
                        Loop
                        St = MID(St, 2)
                        SystemDB.ExecuteSQL "UPDATE [D:世帯Info] RIGHT JOIN [D:農地Info] ON [D:世帯Info].ID = [D:農地Info].所有者ID SET [D:農地Info].所有世帯ID = " & n & " WHERE [D:農地Info].所有者ID In (" & St & ")"
                    Else
                        MsgBox "指定された番号の世帯はすでに存在します。", vbExclamation
                        mvarPDW.DataviewCol.Add ADApp.ObjectMan.GetObject("農家." & n)
                    End If
                End If
            Case "農地の所有権移動−３条": 農地法3条所有権移転 Me, ""
            Case "農地の追加": Fnc農地追加 Fnc.InputText("農地の追加", "追加する農地の地番を入力してください"), 0, IIf(IsNull(DVProperty.Rs.Value("世帯ID")), 0, DVProperty.Rs.Value("世帯ID")), DVProperty.ID, True
            Case "経営農地の一覧": ADApp.DoCommand "農地一覧", "WHERE ([自小作別]<=0 AND [管理人ID]=" & DVProperty.ID & ") OR ([自小作別]>0 AND [借受人ID]=" & DVProperty.ID & ") "
            Case "所有農地の一覧": ADApp.DoCommand "農地一覧", "WHERE ([管理人ID]=" & DVProperty.ID & ")"
            Case "貸出農地の一覧": ADApp.DoCommand "農地一覧", "WHERE ([自小作別]>0 AND [管理人ID]=" & DVProperty.ID & " AND [借受人ID]<>" & DVProperty.ID & " )"
            Case "関連農地の一覧": ADApp.DoCommand "農地一覧", "WHERE (((V_農地.所有者ID)=" & DVProperty.ID & ")) OR (((V_農地.管理者ID)=" & DVProperty.ID & ")) OR (((V_農地.借受人ID)=" & DVProperty.ID & ")) OR (((V_農地.管理人ID)=" & DVProperty.ID & ")) OR (((V_農地.耕作者ID)=" & DVProperty.ID & "))"
            Case "転用農地": view転用農地List "所有者ID = " & DVProperty.ID, "転用農地一覧:" & DVProperty.Name
            Case "認定情報の呼出"
                ADApp.DataviewCol.Add ObjectMan.GetObjectDVP("認定農業者." & DVProperty.ID)
            Case "所有地一覧"
                mvarPDW.SQLListview.SQLListviewCHead "SELECT '土地.' & [nID] AS [Key],M_固定情報.nID AS [名称], 'Unit' AS Icon, 'Unit' AS SelectIcon, M_固定情報.nID AS 一筆コード, V_大字.名称 AS 大字, V_小字.名称 AS 小字, M_固定情報.地番, M_固定情報.一部現況, V_地目.名称 AS 登記地目, V_現況地目.名称 AS 現況地目, M_固定情報.登記面積, M_固定情報.現況面積, [D:個人Info].氏名 AS 所有者,IIf(IsNull([D:農地Info].[ID]),0,-2147483631) AS ForeColor " & _
                "FROM ((V_地目 INNER JOIN (V_大字 INNER JOIN ((M_固定情報 INNER JOIN [D:個人Info] ON M_固定情報.所有者ID = [D:個人Info].ID) INNER JOIN V_小字 ON M_固定情報.小字ID = V_小字.ID) ON V_大字.ID = M_固定情報.大字ID) ON V_地目.ID = M_固定情報.登記地目) INNER JOIN V_現況地目 ON M_固定情報.現況地目 = V_現況地目.ID) LEFT JOIN [D:農地Info] ON M_固定情報.nID = [D:農地Info].固定資産番号 " & _
                "WHERE [M_固定情報].[所有者ID]=" & DVProperty.ID & " ORDER BY [M_固定情報].[nID]", "一筆コード;一筆コード;大字;大字;小字;小字;地番;地番;登記地目;登記地目;現況地目;現況地目;登記面積;登記面積;現況面積;現況面積;所有者;所有者", "所有地一覧"
            Case "合併世帯の解除":
                Select Case MsgBox("他の家族も解除しますか", vbYesNoCancel)
                    Case vbYes:
                        Set Rs = SystemDB.GetRecordsetEx("SELECT [ID] , [氏名] FROM [D:個人Info] WHERE [世帯ID]=" & DVProperty.Rs.Value("世帯ID"), , , Me)
                        St = Fnc.SelectMultiString(Rs.GetString(":", ";"), "選択してください")
                    Case vbNo:
                        St = DVProperty.ID
                    Case Else
                        St = ""
                End Select
                If Len(St) Then 合併世帯解除 St
   
            Case "vbKey":
                If DVProperty.ClassStr = "選挙世帯員" Then
                    St = Fnc.InputText("選挙申請面積", "申請面積を入力してください", sParam, 1, vbIMEOff)
                    If Val(St) Then
                        SystemDB.ExecuteSQL "UPDATE [D:個人Info] Set [選挙申請耕作面積]=" & Val(St) & " WHERE [世帯ID]=" & DVProperty.Rs.Value("世帯ID")
                        mvarPDW.SQLListview.Refresh
                    ElseIf Trim(St) = "0" Then
                        SystemDB.ExecuteSQL "UPDATE [D:個人Info] Set [選挙申請耕作面積]=NULL WHERE [世帯ID]=" & DVProperty.Rs.Value("世帯ID")
                        mvarPDW.SQLListview.Refresh
                    End If
                End If
            Case "GotFocus"
            Case Else
                Debug.Assert CaseAssertPrint(sCmd)
            End Select
            Exit Function
    ExtDoCmd2:
        End Function

    Private Sub CDataviewSK_DropDown(sSourceList As String, Optional sOption As String = "")
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim p農地 As ADBasicLIB2.CDataviewSK
        Dim p所有者 As ADBasicLIB2.CDataviewSK
        Dim p借受者 As ADBasicLIB2.CDataviewSK
        Dim sSQL As String
        Dim pDic As CDataDictionary
        
        Select Case Fnc.GetKeyHead(sSourceList)
            Case "世帯員":
                If MsgBox("同定処理しますか", vbYesNo) = vbYes Then
                    Dim sKey As String
                    sKey = Fnc.GetKeyCode(sSourceList)
                    SystemDB.Execute "UPDATE [D:農地Info] SET [D:農地Info].所有者ID = " & DVProperty.ID & " WHERE ((([D:農地Info].所有者ID)=" & sKey & "));"
                    SystemDB.Execute "UPDATE [D:農地Info] SET [D:農地Info].管理者ID = " & DVProperty.ID & " WHERE ((([D:農地Info].管理者ID)=" & sKey & "));"
                    SystemDB.Execute "UPDATE [D:農地Info] SET [D:農地Info].借受人ID = " & DVProperty.ID & " WHERE ((([D:農地Info].借受人ID)=" & sKey & "));"
                    SystemDB.Execute "UPDATE D_申請 SET D_申請.申請者A = " & DVProperty.ID & " WHERE (((D_申請.申請者A)=" & sKey & "));"
                    SystemDB.Execute "UPDATE D_申請 SET D_申請.申請者B = " & DVProperty.ID & " WHERE (((D_申請.申請者B)=" & sKey & "));"
                    SystemDB.Execute "UPDATE D_申請 SET D_申請.申請者C = " & DVProperty.ID & " WHERE (((D_申請.申請者C)=" & sKey & "));"
                    SystemDB.Execute "UPDATE D_土地履歴 SET D_土地履歴.関係者A = " & DVProperty.ID & " WHERE (((D_土地履歴.関係者A)=" & sKey & "));"
                    SystemDB.Execute "UPDATE D_土地履歴 SET D_土地履歴.関係者B = " & DVProperty.ID & " WHERE (((D_土地履歴.関係者B)=" & sKey & "));"
                    SystemDB.Execute "UPDATE [D:農地Info] INNER JOIN [D:個人Info] ON [D:農地Info].所有者ID = [D:個人Info].ID SET [D:農地Info].所有世帯ID = [世帯ID] WHERE ((([D:農地Info].所有世帯ID)<>[世帯ID]));"
                    SystemDB.Execute "UPDATE [D:農地Info] INNER JOIN [D:個人Info] ON [D:農地Info].管理者ID = [D:個人Info].ID SET [D:農地Info].管理世帯ID = [世帯ID] WHERE ((([D:農地Info].管理世帯ID)<>[世帯ID]));"
                    SystemDB.Execute "UPDATE [D:農地Info] INNER JOIN [D:個人Info] ON [D:農地Info].借受人ID = [D:個人Info].ID SET [D:農地Info].借受世帯ID = [世帯ID] WHERE ((([D:農地Info].借受世帯ID)<>[世帯ID]));"
                End If
            
            Case "農地":
                Dim sStart As String
                Dim sEnd As String
                
                Set p農地 = ADApp.ObjectMan.GetObject(Left$(sSourceList, InStr(sSourceList & ";", ";") - 1))
                Set p所有者 = ADApp.ObjectMan.GetObject("世帯員." & IIf(p農地.GetProperty2("管理者ID") <> 0, p農地.GetProperty2("管理者ID"), p農地.GetProperty2("所有者ID")))
                
                Select Case Fnc.OptionSelect("所有権移転(3条)の申請受付;耕作権設定(3条)の申請受付;転用を伴う所有権移転(5条)の申請受付;転用を伴う賃借権設定(5条)の申請受付;利用権設定の申請受付;経営基盤法による所有権移転受付;利用権移転の申請受付;職権による所有権移転;職権による相続移転;職権による貸借設定;職権による時効取得設定", "設定する内容を選択してください。", "所有権移転(3条)の申請受付;耕作権設定(3条)の申請受付")
                    Case "所有権移転(3条)の申請受付": 農地法3条所有権移転 p所有者, sSourceList, Me
                    Case "耕作権設定(3条)の申請受付": 農地法3条耕作権移転 p所有者, sSourceList, Me
                    Case "利用権設定の申請受付": 経営基盤法利用権設定 p所有者, sSourceList, Me
                    Case "経営基盤法による所有権移転受付": 経営基盤法所有権移転 p所有者, sSourceList, Me
                    Case "利用権移転の申請受付":
                        If p農地.GetProperty2("自小作別") < 1 Or p農地.GetProperty2("借受人ID") = 0 Then
                            MsgBox "貸借設定がされていません。"
                            Exit Sub
                        End If
                        Set p借受者 = ADApp.ObjectMan.GetObject("世帯員." & p農地.GetProperty2("借受人ID"))
                        経営基盤法利用権移転 p借受者, sSourceList, Me, p所有者
                    Case "転用を伴う所有権移転(5条)の申請受付": mod農家台帳.農地法5条所有権移転 p所有者, sSourceList, Me
          
                    Case Else
                        Debug.Assert False
                End Select
            Case Else
                Debug.Assert CaseAssertPrint(sSourceList)
        End Select
    End Sub

    Private Property Set CDataviewSK_DVProperty(ByVal RHS As ADBasicLIB2.CDataviewProperty): Set DVProperty = RHS: End Property
    Private Property Get CDataviewSK_DVProperty() As ADBasicLIB2.CDataviewProperty: Set CDataviewSK_DVProperty = DVProperty: End Property

    Private Function CDataviewSK_GetProperty2(sPropName As String, Optional sParam As String = "") As Variant
        Dim Rs As ADBasicLIB2.RecordsetEx
        Select Case sPropName
            Case "名称": CDataviewSK_GetProperty2 = DVProperty.Rs.Value("氏名")
            Case "世帯の有無": CDataviewSK_GetProperty2 = SystemDB.RecordExists("D:世帯Info", "[ID]=" & DVProperty.Rs.Value("世帯ID"))
            Case "経営面積":
                If DVProperty.Rs.Value("世帯ID") <> 0 Then CDataviewSK_GetProperty2 = CDataviewSK_GetProperty2("世帯経営面積") Else CDataviewSK_GetProperty2 = CDataviewSK_GetProperty2("個人経営面積")
            Case "借入面積":
                If DVProperty.Rs.Value("世帯ID") <> 0 Then CDataviewSK_GetProperty2 = CDataviewSK_GetProperty2("世帯借入面積") Else CDataviewSK_GetProperty2 = CDataviewSK_GetProperty2("個人借入面積")
            Case "世帯経営面積":
                Set Rs = SystemDB.GetRecordsetEx("SELECT Sum([V_農地].田面積+[V_農地].畑面積+[V_農地].樹園地) AS 耕作面積 FROM [V_農地] WHERE [V_農地].耕作世帯ID=" & DVProperty.Rs.Value("世帯ID"), 0, , "世帯員")
                If Not Rs Is Nothing Then CDataviewSK_GetProperty2 = Rs.Value("耕作面積"): SystemDB.CloseRs Rs
            Case "世帯借入面積":
                Set Rs = SystemDB.GetRecordsetEx("SELECT Sum([V_農地].田面積+[V_農地].畑面積) AS 耕作面積 FROM [V_農地] WHERE [V_農地].所有世帯ID<>" & DVProperty.Rs.Value("世帯ID") & " AND [V_農地].借受世帯ID=" & DVProperty.Rs.Value("世帯ID") & " AND [V_農地].自小作別>0", 0, , "世帯員")
                If Not Rs Is Nothing Then CDataviewSK_GetProperty2 = Rs.Value("耕作面積"): SystemDB.CloseRs Rs
            Case "個人経営面積":
                Set Rs = SystemDB.GetRecordsetEx("SELECT Sum([V_農地].田面積+[V_農地].畑面積+[V_農地].樹園地) AS 耕作面積 FROM [V_農地] WHERE [耕作者ID]=" & DVProperty.ID, , , "耕作者")
                If Not Rs Is Nothing Then CDataviewSK_GetProperty2 = Rs.Value("耕作面積"): SystemDB.CloseRs Rs
            Case "個人借入面積":
                Set Rs = SystemDB.GetRecordsetEx("SELECT Sum([V_農地].田面積+[V_農地].畑面積) AS 耕作面積 FROM [V_農地] WHERE [借受人ID]=" & DVProperty.ID & " AND [V_農地].自小作別>0", , , "耕作者")
                If Not Rs Is Nothing Then CDataviewSK_GetProperty2 = Rs.Value("耕作面積"): SystemDB.CloseRs Rs
            Case "集落名": CDataviewSK_GetProperty2 = SystemDB.GetDirectData("V_行政区", "名称", Val(DVProperty.Rs.Value("行政区ID")))
            Case "メニュー": CDataviewSK_GetProperty2 = PopSub
            Case "年齢"
                If DVProperty.Rs.IsDate("生年月日", False) Then
                    CDataviewSK_GetProperty2 = DVProperty.Rs.年齢("生年月日")
                Else
                    CDataviewSK_GetProperty2 = 0
                End If
            Case "世帯員数":
                If DVProperty.Rs.Value("世帯ID") <> 0 Then
                    Set Rs = SystemDB.GetRecordsetEx("SELECT Count([D:個人Info].ID) AS [世帯員数] FROM [D:個人Info] WHERE [D:個人Info].世帯ID=" & DVProperty.Rs.Value("世帯ID"), 0, , "世帯員")
                    If Not Rs Is Nothing Then CDataviewSK_GetProperty2 = Rs.Value("世帯員数"): SystemDB.CloseRs Rs
                End If
            Case Else
                CDataviewSK_GetProperty2 = DVProperty.Rs.NullCast(sPropName, "")
        End Select
    End Function

    Private Property Get CDataviewSK_IconName() As String
        Select Case True
            Case IIf(IsNull(DVProperty.Rs.Value("住民区分")), 0, DVProperty.Rs.Value("住民区分")) = SystemDB.DBProperty("死亡住民コード")
                CDataviewSK_IconName = "DeadFarmer"
            Case Else
                CDataviewSK_IconName = "Farmer"
        End Select
    End Property

    Private Property Get CDataviewSK_IsUpdated() As Boolean: CDataviewSK_IsUpdated = DVProperty.Controls.IsUpdated: End Property

    Private Property Let CDataviewSK_Key(ByVal RHS As String): DVProperty.Key = RHS: End Property
    Private Property Get CDataviewSK_Key() As String: CDataviewSK_Key = DVProperty.Key: End Property

    Private Function PopSub() As String
        Dim St As String
        
        St = "開く;-;世帯を呼ぶ;基本台帳印刷;世帯の作成;総括表;-;世帯番号の修正;-;" & _
        ">農地一覧;経営農地の一覧;所有農地の一覧;貸出農地の一覧;" & IIf(Fnc.s市町村名 = "大崎町", "-;関連農地の一覧;", "") & "-;転用農地;<;" & _
        ">設定;認定農業者に設定;担い手農家に設定;農業生産法人に設定;認定農業者＋担い手農家に設定;" & IIf(DVProperty.Rs.Value("農業改善計画認定") = 1, "認定情報の呼出;", "") & "-;農業委員に設定;" & IIf(DVProperty.Rs.Value("合併異動"), "", "~") & "合併世帯の解除;<;"
        St = St & ">所有地の移動;農地の所有権移動−３条;農地の貸借−３条;農地の転用−４条;転用目的の所有権移動−５条;所有権移転;利用権設定;利用権移転;解約;<;"
        St = St & IIf(DVProperty.Rs.Value("選挙権の有無"), "^", "") & "選挙権の有無;"
        St = St & "関連する議案一覧;"
        St = St & "-;農地の追加;"
        St = St & "-;所有地一覧;-;あっせん申出;-;削除;"
        If Not DVProperty.Body Is Nothing Then St = St & "-;閉じる;"
        PopSub = St
    End Function

    Private Function CDataviewSK_PopupMenu(Optional ByVal sParam As String = "", Optional vParam As Variant) As String
        Dim St As String
        Dim pID As Long
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim n As Long
        
        St = SysAD.PopupMenu(PopSub)
        
        Select Case St
            Case "総括表": Sub総括表 Me
            Case "耕作証明書"
                St = Fnc.InputText("耕作証明書", "発行年月日を入力してください", Format(Now(), "GGGEE/MM/DD"), 1, 3)
                If Not IsDate(St) Then Exit Function
                n = Val(Fnc.InputText("耕作証明書発行番号", "耕作証明書発行番号を入力してください", Val(SystemDB.DBProperty("耕作証明番号")) + 1, 1, 3))
                If n Then
                    SystemDB.DBProperty("耕作証明番号") = CStr(n)
                    mvarPDW.PrintGo ADApp.ObjectMan.GetObject("耕作証明書.0"), DVProperty.Key & ";" & CDate(St) & ";" & n
                End If
            Case "耕作証明書世帯":
                St = Fnc.InputText("耕作証明書", "発行年月日を入力してください", Format(Now(), "GGGEE/MM/DD"), 1, 3)
                If Not IsDate(St) Then Exit Function
                n = Val(Fnc.InputText("耕作証明書発行番号", "耕作証明書発行番号を入力してください", Val(SystemDB.DBProperty("耕作証明番号")) + 1, 1, 3))
                If n Then
                    SystemDB.DBProperty("耕作証明番号") = CStr(n)
                    mvarPDW.PrintGo ADApp.ObjectMan.GetObject("耕作証明書.0"), "農家." & DVProperty.Rs.Value("世帯ID") & ";" & CDate(St) & ";" & n & ";" & DVProperty.Key
                End If
            Case "耕作証明多筆型":
                St = Fnc.InputText("耕作証明書", "発行年月日を入力してください", Format(Now(), "GGGEE/MM/DD"), 1, 3)
                If Not IsDate(St) Then Exit Function
                n = Val(Fnc.InputText("耕作証明書発行番号", "耕作証明書発行番号を入力してください", Val(SystemDB.DBProperty("耕作証明番号")) + 1, 1, 3))
                If n Then
                    SystemDB.DBProperty("耕作証明番号") = CStr(n)
                    mvarPDW.PrintGo ADApp.ObjectMan.GetObject("耕作証明多筆.0"), DVProperty.Key & ";" & CDate(St) & ";" & n
                End If
            Case "耕作証明多筆型世帯":
                St = Fnc.InputText("耕作証明書", "発行年月日を入力してください", Format(Now(), "GGGEE/MM/DD"), 1, 3)
                If Not IsDate(St) Then Exit Function
                n = Val(Fnc.InputText("耕作証明書発行番号", "耕作証明書発行番号を入力してください", Val(SystemDB.DBProperty("耕作証明番号")) + 1, 1, 3))
                If n Then
                    SystemDB.DBProperty("耕作証明番号") = CStr(n)
                    mvarPDW.PrintGo ADApp.ObjectMan.GetObject("耕作証明多筆.0"), "農家." & DVProperty.Rs.Value("世帯ID") & ";" & CDate(St) & ";" & n & ";" & DVProperty.Key
                End If
'            Case "耕作証明書", "耕作証明多筆型"
'                Dim p証明 As ADBasicLIB2.CPrintObject
'                Set p証明 = ADApp.ObjectMan.GetObject("耕作証明書." & DVProperty.ID)
'                p証明.Printview "GType=1" & vbCrLf & "SelID=" & Chr$(34) & DVProperty.ID & Chr$(34)
            Case "世帯番号の修正": MsgBox "現在この機能は使えません", vbCritical
            Case Else
                CDataviewSK_DoCommand2 St
        End Select
    End Function

    Private Sub CDataviewSK_Refresh(Optional bReLoad As Boolean = False)
        Debug.Assert False 'Non Code
    End Sub

    Private Sub OpenParent()
        With SysAD
            Dim Rs As ADBasicLIB2.RecordsetEx
            Dim pParent As CDataviewSK
            
            Set Rs = SystemDB.GetRecordsetEx("SELECT * FROM [D:世帯INFO] WHERE [ID]=" & DVProperty.Rs.Value("世帯ID"), , , "世帯を呼ぶ")
            If Rs.EOF Then
                MsgBox "指定された農家は住記上、" & vbCrLf & "世帯の記録がありませんでした｡", vbInformation
            Else
                Set pParent = ADApp.ObjectMan.GetObject("農家." & DVProperty.Rs.Value("世帯ID"))
                .MDIForm.ActivePDW.DataviewCol.Add pParent
            End If
            SystemDB.CloseRs Rs
        End With
    End Sub
    
    '各DLL共通↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓
    '各DLL共通↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑

    Private Sub Class_Terminate()
        If Not DVProperty.Rs Is Nothing Then
            SystemDB.CloseRs DVProperty.Rs
        End If
        Set DVProperty = Nothing
    End Sub

End Class










Class CObj農家
    Option Explicit
    Implements ADBasicLIB2.CDataviewSK
    
    Private DVProperty As CDataviewProperty
    Private Sub Class_Initialize(): Set DVProperty = mvarPDW.DataviewCol.GetNewDVP: End Sub
    
    '/****** ID型General_Key ******/
    Public Property Get Key() As String: Key = DVProperty.Key: End Property
    Public Property Let Key(ByVal RHS As String)
        Select Case Fnc.GetKeyHead(RHS)
            Case "農家"
                DVProperty.SetDVP RHS, SystemDB, "SELECT [D:世帯INFO].*,[D:個人Info].[氏名] AS [氏名],[D:個人Info].[職業] AS [世帯主職業] FROM [D:世帯INFO] LEFT JOIN [D:個人Info] ON [D:個人Info].ID = [D:世帯Info].世帯主ID  WHERE [D:世帯Info].ID=%DVP.ID%", , "氏名"
            Case "営農情報":
                DVProperty.SetDVP RHS, SystemDB, "SELECT [D_世帯営農].*,[D:個人Info].[氏名] AS [氏名],[D:個人Info].[フリガナ] AS [フリガナ],[D:個人Info].[住所],[D:世帯Info].[兼業区分],[D:個人Info].[検索フリガナ] AS [検索フリガナ] FROM ([D_世帯営農] LEFT JOIN [D:世帯Info] ON [D_世帯営農].ID = [D:世帯Info].ID) LEFT JOIN [D:個人Info] ON [D:世帯Info].世帯主ID = [D:個人Info].ID WHERE [D_世帯営農].ID=%DVP.ID%"
                If DVProperty.Rs.IsNoRecord Then
                    DVProperty.CloseRs
                    SystemDB.ExecuteSQL "INSERT INTO [D_世帯営農] ( ID ) VALUES(" & DVProperty.ID & ");"
                    DVProperty.SetDVP RHS, SystemDB, "SELECT [D_世帯営農].*,[D:個人Info].[氏名] AS [氏名],[D:個人Info].[フリガナ] AS [フリガナ],[D:個人Info].[住所],[D:世帯Info].[兼業区分],[D:個人Info].[検索フリガナ] AS [検索フリガナ] FROM ([D_世帯営農] LEFT JOIN [D:世帯Info] ON [D_世帯営農].ID = [D:世帯Info].ID) LEFT JOIN [D:個人Info] ON [D:世帯Info].世帯主ID = [D:個人Info].ID WHERE [D_世帯営農].ID=%DVP.ID%"
                End If
            Case Else
                Debug.Assert CaseAssertPrint(DVProperty.Key, "")
        End Select
    End Property
    '/****** ID型General_Key ******/
    
    '各DLL共通↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓
    Private Sub CDataviewSK_CloseRecordset(): DVProperty.CloseRs: End Sub
    
    Private Sub CDataviewSK_DblClick(): CDataviewSK_DoCommand2 "開く": End Sub
    '各DLL共通↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑
    
    Private Property Set CDataviewSK_Container(ByVal RHS As ADBasicLIB2.CPDW)
        Dim n As Integer
        
        On Error GoTo Ext
        n = 1
        Set DVProperty.Controls.Recordset = DVProperty.Rs.Body
        n = 2
        Set DVProperty.Controls.Parent = Me
        n = 3
        Set DVProperty.Containner = RHS
        
        n = 4
        Set DVProperty.Body.ChildDataControls = DVProperty.Controls
        n = 5
        DVProperty.Body.VariableFitWidth = True
        n = 6
        ADApp.Common.SetDataView DVProperty.ClassStr, DVProperty.Controls

        n = 7
        DVProperty.Controls.AttachData
        Exit Property
    Ext:
        MsgBox n & ":" & Err.Description, vbCritical
    End Property

    Private Function CDataviewSK_DoCommand2(sCmd As String, Optional sParam As String = "") As Variant
        Dim n As Long
        Dim s使用目的 As String
        Dim s提出先 As String
        Dim St As String
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim pDic As CDataDictionary
        Dim nID As Long
        Dim pDicID As CDataDictionary

        Select Case sCmd
            '/*必須
            Case "開く": ADApp.DataviewCol.Add Me
            Case "閉じる": ADApp.DataviewCol.Remove DVProperty.Key
            Case "更新": DVProperty.Controls.UpdateControlValues True, True
                ADApp.DataviewCol.RefreshIcon DVProperty.Key
            Case "メニュー": CDataviewSK_PopupMenu
            '/*必須
            Case "農地追加": Fnc農地追加 Fnc.InputText("農地の追加", "追加する農地の地番を入力してください"), 0, DVProperty.ID, DVProperty.Rs.V("世帯主ID"), True
            Case "確認日時設定", "スペース": DVProperty.Rs.Update "確認日時", Now(): mvarPDW.SQLListview.Refresh DVProperty.Key
            Case "地図を呼ぶ"
            Case "経営農地を地図に表示": sub地図 "([耕作世帯ID]=" & DVProperty.ID & ")"
            Case "所有農地を地図に表示": sub地図 "([農家世帯ID]=" & DVProperty.ID & ")"
            Case "小作農地を地図に表示": sub地図 "([耕作世帯ID]=" & DVProperty.ID & ") AND ([農家世帯ID]<>" & DVProperty.ID & ")"
            Case "貸出農地を地図に表示": sub地図 "([自小作別]>0 AND [農家世帯ID]=" & DVProperty.ID & " AND [借受世帯ID]<>" & DVProperty.ID & " )"
            Case "転用農地を地図に表示": sub地図転用 "([農家世帯ID]=" & DVProperty.ID & ")"
            
            Case "農地との関連": DVProperty.Rs.Update "農地との関連", Not DVProperty.Rs.Value("農地との関連")
            Case "基本台帳印刷":
                '市町村ごとに旧と新を切り替える
                Select Case Fnc.s市町村名
                    Case "阿久根市", "日置市", "姶良市", "枕崎市", "南種子町", "長島町", "三股町", "大崎町"
                        If MsgBox("新基本台帳の形式で印刷しますか？", vbYesNo) = vbYes Then
                            mvarPDW.PrintGo ADApp.ObjectMan.GetObject("農家基本台帳New2.0"), DVProperty.Key
                        Else
                            mvarPDW.PrintGo ADApp.ObjectMan.GetObject("農家基本台帳New.0"), DVProperty.Key
                        End If
                    Case Else
                        mvarPDW.PrintGo ADApp.ObjectMan.GetObject("農家基本台帳New.0"), DVProperty.Key
                End Select
            Case "家族一覧": SQLList世帯員 "([世帯ID]=" & DVProperty.ID & ")", DVProperty.Name & ":家族一覧", False
            Case "経営農地の一覧": view農地List "WHERE ([耕作世帯ID]=" & DVProperty.ID & ")", DVProperty.Name & ":経営農地一覧 " '/** 農地0001-0001-0002
            Case "所有農地の一覧": view農地List "WHERE ([農家世帯ID]=" & DVProperty.ID & ")", DVProperty.Name & ":所有農地一覧" '/** 農地0001-0001-0002
            Case "小作農地の一覧": view農地List "WHERE ([耕作世帯ID]=" & DVProperty.ID & ") AND ([農家世帯ID]<>" & DVProperty.ID & ")", DVProperty.Name & ":小作農地一覧" '/** 農地0001-0001-0002
            Case "貸出農地の一覧": view農地List "WHERE ([自小作別]>0 AND [農家世帯ID]=" & DVProperty.ID & " AND [借受世帯ID]<>" & DVProperty.ID & " )", DVProperty.Name & ":貸出農地一覧" '/** 農地0001-0001-0002
            Case "転用農地の一覧": view転用農地List "WHERE ([農家世帯ID]=" & DVProperty.ID & ")", DVProperty.Name & ":転用農地一覧"
            Case "関連農地の一覧": view農地List "WHERE (((V_農地.所有世帯ID)=" & DVProperty.ID & ")) OR (((V_農地.管理世帯ID)=" & DVProperty.ID & ")) OR (((V_農地.借受世帯ID)=" & DVProperty.ID & ")) OR (((V_農地.農家世帯ID)=" & DVProperty.ID & ")) OR (((V_農地.耕作世帯ID)=" & DVProperty.ID & "))", DVProperty.Name & ": 関連農地一覧 "
            Case "家族一覧Lst_DblClick": mvarPDW.DataviewCol.Add ADApp.ObjectMan.GetObject(sParam)
            Case "土地一覧Lst_DblClick": mvarPDW.DataviewCol.Add ADApp.ObjectMan.GetObject(sParam)
            Case "家族の追加": CreateFarmer -1, DVProperty.ID, , , "家族の追加"
            Case "耕作面積証明書", "耕作証明印刷"
                If DVProperty.Rs.V("兼業区分") = 4 Then
                    MsgBox "非農家の耕作証明は発行できません", vbCritical
                    Exit Function
                End If
                With Fnc.InputMulti("耕作証明書", "入力してください", "発行年月日;日付;" & Date & "|発行番号;数値;" & (Val(SystemDB.DBProperty("耕作証明番号")) + 1), , True)
                    If .IsALLEmpty Then Exit Function
                    If Not .IsDate("発行年月日") Then Exit Function
                    SystemDB.DBProperty("耕作証明番号") = .Item("発行番号")
                    mvarPDW.PrintGo ADApp.ObjectMan.GetObject("耕作証明書.0"), .StrReplace(DVProperty.Key & ";%DD.発行年月日%;%DD.発行番号%")
                End With
            Case "耕作証明多筆型", "耕作証明願":
                If DVProperty.Rs.Value("兼業区分") = 4 Then
                    MsgBox "非農家の耕作証明は発行できません", vbCritical
                    Exit Function
                End If
                St = Fnc.InputText("耕作証明書", "発行年月日を入力してください", Format(Now(), "GGGEE/MM/DD"), 1, 3)
                If Not IsDate(St) Then Exit Function
                n = Val(Fnc.InputText("耕作証明書発行番号", "耕作証明書発行番号を入力してください", Val(SystemDB.DBProperty("耕作証明番号")) + 1, 1, 3))
                If n Then
                    SystemDB.DBProperty("耕作証明番号") = CStr(n)
                        
                    Select Case Val(SystemDB.DBProperty("耕作証明種類"))
                        Case 1: mvarPDW.PrintGo ADApp.ObjectMan.GetObject("耕作証明品目対応.0"), DVProperty.Key & ";" & CDate(St) & ";" & n
                        Case Else: mvarPDW.PrintGo ADApp.ObjectMan.GetObject("耕作証明多筆.0"), DVProperty.Key & ";" & CDate(St) & ";" & n
                    End Select
                End If
            Case "削除":
                Select Case DVProperty.ClassStr
                    Case "農家": subOBJ削除 "農家の削除", "世帯を削除しますか", "DELETE * FROM [D:世帯Info] WHERE [ID]=%DVP.ID%", Me
                    Case "営農情報"
                        If DVProperty.Rs.V("兼業区分") = 4 Then
                            MsgBox "非農家の営農情報は監理できません", vbCritical
                            Exit Function
                        End If
                        If MsgBox("営農情報を削除しますか", vbYesNo) = vbYes Then
                            CDataviewSK_DoCommand2 "閉じる"
                            SystemDB.ExecuteSQL "DELETE * FROM [D_世帯営農] WHERE [ID]=" & DVProperty.ID
                            mvarPDW.SQLListview.Refresh
                        End If
                End Select
            Case "農家番号の入力":
                n = Val(Fnc.InputText("農家番号", "農家番号を入力してください", Val(DVProperty.Rs.V("農家番号")), 1, 3))
                If n Then DVProperty.Rs.Update "農家番号", n: mvarPDW.SQLListview.Refresh DVProperty.Key
            Case "転用農地": view転用農地一覧 DVProperty.ID
            Case "農機具の追加": SystemDB.ExecuteSQL "INSERT INTO D_営農情報 ( SID, Class ) VALUES(" & DVProperty.ID & ",1);"
            Case "農機具の一覧": mvarPDW.SQLListview.SQLListviewCHead "SELECT '営農農機具.' & [ID] AS [KEY],'農機具' AS [名称],'Unit' AS [Icon] FROM [D_営農情報] WHERE [CLASS]=1;", "名称;名称", "農機具の一覧"
'申請関連
            Case "営農計画書": mvarPDW.PrintGo ObjectMan.GetObject("営農計画書.0"), DVProperty.Key
            Case "農地の所有権移動−３条": 農地法3条所有権移転 Me, ""
            Case "農地の耕作権移動−３条": 農地法3条耕作権移転 Me, ""
            Case "農地の転用−４条": 農地法4条設定 Me
            Case "関連申請"
                St = "SELECT  '申請.' & [D_申請].[ID] AS [KEY],D_申請.名称, M_BASICALL.名称 AS 状態, D_申請.受付年月日, D_申請.許可年月日 " & _
                "FROM ([D:個人Info] LEFT JOIN D_申請 ON [D:個人Info].ID = D_申請.申請者A) LEFT JOIN M_BASICALL ON D_申請.状態 = M_BASICALL.ID " & _
                "WHERE ((([D:個人Info].世帯ID)=" & DVProperty.ID & ") AND ((M_BASICALL.Class)='申請状況')) " & _
                "UNION SELECT '申請.' & [D_申請].[ID] AS [KEY], D_申請.名称, M_BASICALL.名称, D_申請.受付年月日, D_申請.許可年月日 " & _
                "FROM [D:個人Info] LEFT JOIN (D_申請 LEFT JOIN M_BASICALL ON D_申請.状態 = M_BASICALL.ID) ON [D:個人Info].ID = D_申請.申請者B " & _
                "WHERE ((([D:個人Info].世帯ID)=" & DVProperty.ID & ") AND ((M_BASICALL.Class)='申請状況'));"

                mvarPDW.SQLListview.SQLListviewCHead St, "名称;名称;状態;状態;受付年月日;受付年月日;許可年月日;許可年月日", "関連申請"
            Case ""
            Case "総括表": mod農家台帳.Sub総括表 Me
            Case "家族農地の連動"
                mvarPDW.WaitMessage = "家族の農地の結び付け処理中・・・"
                SystemDB.ExecuteSQL "UPDATE [D:農地Info] INNER JOIN [D:個人Info] ON [D:農地Info].所有者ID = [D:個人Info].ID SET [D:農地Info].所有世帯ID = [世帯ID] WHERE ((([D:農地Info].所有世帯ID)=0 Or ([D:農地Info].所有世帯ID) Is Null) AND (([D:個人Info].世帯ID)>0));"
                SystemDB.ExecuteSQL "UPDATE [D:農地Info] INNER JOIN [D:個人Info] ON [D:農地Info].借受人ID = [D:個人Info].ID SET [D:農地Info].借受世帯ID = [世帯ID] WHERE ((([D:個人Info].世帯ID)>0) AND (([D:農地Info].借受世帯ID)=0 Or ([D:農地Info].借受世帯ID) Is Null));"
                mvarPDW.WaitMessage = ""
            Case "家族一覧Lst_OLEDragDropKeyList": DVProperty.Controls.AddList "世帯主Combo", "n.123", "中村", "Unit"
            Case "合併世帯の解除":
                Set Rs = SystemDB.GetRecordsetEx("SELECT [ID] , [氏名] FROM [D:個人Info] WHERE [合併異動]=TRUE AND [世帯ID]=" & DVProperty.ID, , , Me)
                St = Fnc.SelectMultiString(Rs.GetString(":", ";"), "選択してください")
                SystemDB.CloseRs Rs
                
                If Len(St) Then 合併世帯解除 St
            Case "所有地一覧"
                mvarPDW.SQLListview.SQLListviewCHead "SELECT '土地.' & [nID] AS [Key],M_固定情報.nID AS [名称], 'Unit' AS Icon, 'Unit' AS SelectIcon, M_固定情報.nID AS 一筆コード, V_大字.名称 AS 大字, V_小字.名称 AS 小字, M_固定情報.地番, M_固定情報.一部現況, V_地目.名称 AS 登記地目, V_現況地目.名称 AS 現況地目, M_固定情報.登記面積, M_固定情報.現況面積, [D:個人Info].氏名 AS 所有者,IIf(IsNull([D:農地Info].[ID]),0,-2147483631) AS ForeColor " & _
                "FROM ((V_地目 INNER JOIN (V_大字 INNER JOIN ((M_固定情報 INNER JOIN [D:個人Info] ON M_固定情報.所有者ID = [D:個人Info].ID) INNER JOIN V_小字 ON M_固定情報.小字ID = V_小字.ID) ON V_大字.ID = M_固定情報.大字ID) ON V_地目.ID = M_固定情報.登記地目) INNER JOIN V_現況地目 ON M_固定情報.現況地目 = V_現況地目.ID) LEFT JOIN [D:農地Info] ON M_固定情報.nID = [D:農地Info].固定資産番号 " & _
                "WHERE [M_固定情報].[所有世帯ID]=" & DVProperty.ID & " ORDER BY [M_固定情報].[nID]", "一筆コード;一筆コード;大字;大字;小字;小字;地番;地番;登記地目;登記地目;現況地目;現況地目;登記面積;登記面積;現況面積;現況面積;所有者;所有者", "所有地一覧"
            Case "営農情報": ADApp.DataviewCol.Add ObjectMan.GetObject("営農情報." & DVProperty.ID)
            Case "世帯情報": ADApp.DataviewCol.Add ObjectMan.GetObject("農家." & DVProperty.ID)
          
            Case "営農世帯員Lst_DblClick":
                Dim s職業 As String
                Set Rs = SystemDB.GetRecordsetEx("SELECT [氏名],[職業],[農業従事日数] FROM [D:個人Info] WHERE [ID]=" & Fnc.GetKeyCode(sParam), , , Me)
                If Not Rs.EOF Then
                    s職業 = SystemDB.DBProperty("職業")
                    St = s職業
                    If InStr(";" & St, ";" & Rs.Value("職業") & ";") = 0 Then
                        St = St & Rs.Value("職業") & ";"
                    End If
                    ADApp.Common.MasterTable.Add "職業一覧", St
                    Set pDic = SysAD.MDIForm.InputMulti("世帯員", "以下の項目を入力してください　［ " & Rs.Value("氏名") & " ］", "職業;文字選択;" & Rs.Value("職業") & ";職業一覧;|農業従事日数;数値;" & Rs.Value("農業従事日数") & ";")
                    If Not pDic Is Nothing Then
                        Rs.Update "職業", pDic.Item("職業")
                        Rs.Update "農業従事日数", Val(pDic.Item("農業従事日数"))
                        If Len(pDic.Item("職業")) > 0 And InStr(";" & s職業, ";" & pDic.Item("職業") & ";") = 0 Then
                            St = s職業 & pDic.Item("職業") & ";"
                            SystemDB.SetDirectData "S_システムデータ", "DATA", St, , "職業"
                        End If
                        DVProperty.Controls.Refresh "営農世帯員Lst"
                    End If
                End If
                SystemDB.CloseRs Rs
            Case "営農世帯員Lst_ListRefresh": DVProperty.Controls.Refresh "営農世帯員Lst"
            Case "農機具追加ボタン":
                Set pDicID = New CDataDictionary
                nID = SystemDB.MinID("M_BASICALL", "ID", "[Class]='農機具'")
                If nID > 0 Then nID = -1
                Set Rs = SystemDB.GetRecordsetEx("SELECT [ID],[名称] FROM [M_BASICALL] WHERE [Class]='農機具' ORDER BY [ID];", 0, , "農機具")
                Do Until Rs.EOF
                    St = St & Right$("       " & CStr(Rs.Value("ID")), 7) & " : " & Rs.Value("名称") & vbCrLf
                    pDicID.Add Rs.Value("ID"), Rs.Value("名称")
                    Rs.MoveNext
                Loop
                SystemDB.CloseRs Rs
                
                Set pDic = SysAD.MDIForm.InputMulti("農機具･施設追加", "追加する農機具･施設を以下に入力してください" & vbCrLf & St, "ID;数値;" & nID & ";|名称;文字;;")
                If Not pDic Is Nothing Then
                    If pDicID.Exists(pDic.Item("ID")) = False Then
                        SysAD.SystemDB.ExecuteSQL "INSERT INTO M_BASICALL(ID, Class, 名称, ParentKey ) VALUES(" & pDic.Item("ID") & ",'農機具','" & pDic.Item("名称") & "','農機具');"
                        For n = 1 To 10: DVProperty.Controls.Refresh "農機具Combo" & n: Next
                    ElseIf MsgBox("IDの[ " & pDic.Item("ID") & " ]番は既に登録されています。上書きしますか", vbYesNo, "追加確認") = vbYes Then
                        SysAD.SystemDB.ExecuteSQL "UPDATE M_BASICALL SET 名称='" & pDic.Item("名称") & "' WHERE [ID] = " & pDic.Item("ID") & " AND [Class]='農機具';"
                        For n = 1 To 10: DVProperty.Controls.Refresh "農機具Combo" & n: Next
                    End If
                   Set pDic = Nothing
                End If
                If Not pDicID Is Nothing Then Set pDicID = Nothing
            Case "家畜追加ボタン":
                Set pDicID = New CDataDictionary
                nID = SystemDB.MinID("M_BASICALL", "ID", "[Class]='家畜'")
                If nID > 0 Then nID = -1
                Set Rs = SystemDB.GetRecordsetEx("SELECT [ID],[名称] FROM [M_BASICALL] WHERE [Class]='家畜' ORDER BY [ID];", 0, , "家畜")
                Do Until Rs.EOF
                    St = St & Right$("       " & CStr(Rs.Value("ID")), 7) & " : " & Rs.Value("名称") & vbCrLf
                    pDicID.Add Rs.Value("ID"), Rs.Value("名称")
                    Rs.MoveNext
                Loop
                SystemDB.CloseRs Rs
                Set pDic = SysAD.MDIForm.InputMulti("家畜追加", "追加する家畜を以下に入力してください" & vbCrLf & St, "ID;数値;" & nID & ";|名称;文字;;")
                If Not pDic Is Nothing Then
                    If pDicID.Exists(pDic.Item("ID")) = False Then
                        SysAD.SystemDB.ExecuteSQL "INSERT INTO M_BASICALL(ID, Class, 名称, ParentKey ) VALUES(" & pDic.Item("ID") & ",'家畜','" & pDic.Item("名称") & "','家畜');"
                        For n = 1 To 8: DVProperty.Controls.Refresh "家畜Combo" & n: Next
                    Else
                        MsgBox "IDの[ " & pDic.Item("ID") & " ]番は既に登録されています", vbCritical, "追加エラー"
                    End If
                   Set pDic = Nothing
                End If
                If Not pDicID Is Nothing Then Set pDicID = Nothing
            Case "GotFocus"
            Case Else
                Debug.Assert CaseAssertPrint(sCmd, TypeName(Me))
        End Select
    End Function

    Private Sub CDataviewSK_DropDown(sSourceList As String, Optional sOption As String = "")
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim p農地 As ADBasicLIB2.CDataviewSK
        Dim p所有者 As ADBasicLIB2.CDataviewSK
        Dim ID As Long
        Dim St As String
        Dim sAnd As String
        Dim n As Long

        Select Case Fnc.GetKeyHead(sSourceList)
            Case "行政区":
                If Fnc.GetKeyCode(sSourceList) = 0 Then
                ElseIf MsgBox("行政区を変更しますか?", vbYesNoCancel) = vbYes Then
                    DVProperty.Rs.Value("行政区ID") = Fnc.GetKeyCode(sSourceList)
                End If
            Case "世帯員"
                Dim Ar As Variant
                If Right$(sSourceList, 1) = ";" Then sSourceList = Left$(sSourceList, Len(sSourceList) - 1)
                
                Ar = Split(sSourceList, ";")
                If MsgBox("世帯員 " & UBound(Ar) + 1 & "人を移動します。よろしいですか", vbYesNo) = vbYes Then
                    For n = 0 To UBound(Ar)
                        If Len(Ar(n)) Then
                            ID = Fnc.GetKeyCode(CStr(Ar(n)))
                            
                            Set Rs = SystemDB.GetRecordsetEx("SELECT * FROM [D:個人INFO] WHERE [ID]=" & ID, , , Me)
                            If Not Rs.EOF Then
                                If Rs.IsNull("世帯ID") Then
                                    Rs.UpdateArray GetArray("合併世帯ID", 0, "世帯固定", True, "世帯ID", DVProperty.ID, "合併世帯", False)
                                ElseIf Rs.Value("世帯ID") = 0 Then
                                    Rs.UpdateArray GetArray("合併世帯ID", 0, "世帯固定", True, "世帯ID", DVProperty.ID, "合併世帯", False)
                                Else
                                    Rs.UpdateArray GetArray("合併世帯ID", Rs.Value("世帯ID"), "世帯固定", True, "世帯ID", DVProperty.ID, "合併世帯", False)
                                End If
                                SystemDB.ExecuteSQL "UPDATE [D:農地Info] SET [D:農地Info].所有世帯ID = " & DVProperty.ID & " WHERE ((([D:農地Info].所有者ID)=" & ID & "));"
                                SystemDB.ExecuteSQL "UPDATE [D:農地Info] SET [D:農地Info].管理世帯ID = " & DVProperty.ID & " WHERE ((([D:農地Info].管理者ID)=" & ID & "));"
                                SystemDB.ExecuteSQL "UPDATE [D:農地Info] SET [D:農地Info].借受世帯ID = " & DVProperty.ID & " WHERE ((([D:農地Info].借受人ID)=" & ID & ") AND (([D:農地Info].自小作別)>0));"
                            End If
                            SystemDB.CloseRs Rs
                        End If
                    Next
                    mvarPDW.SQLListview.Refresh
                End If
            Case "農家"
                Dim ZID As Long
                
                If InStr(sSourceList, ";") Then
                    MsgBox "複数の世帯のドロップには対応しておりません", vbCritical, "ドロップの失敗"
                ElseIf DVProperty.ID = Fnc.GetKeyCode(sSourceList) Then
                    SysAD.MDIForm.Message = "同じ世帯にドロップしました!"
                ElseIf MsgBox("合併世帯として結び付けますか？", vbYesNo) = vbYes Then
                    With SystemDB
                        Set Rs = .GetRecordsetEx("SELECT ID, 続柄 FROM [V_続柄] WHERE [ID]>0;", , , Me)
                        
                        ZID = Val(Fnc.OptionSelect("-1:変更しない;" & Rs.GetString(":", ";"), "移動先の世帯主から見た移動元の世帯主との続柄を入力してください", "子"))
                        .CloseRs Rs
                        If ZID = 0 Then Exit Sub
                        
                        ID = Fnc.GetKeyCode(sSourceList)
                        '世帯員の移動
                        .ExecuteSQL "INSERT INTO D_個人履歴 ( PID, 異動事由, 内容, 異動日時 ) SELECT [D:個人Info].ID, 1000008 AS 式1, '合併世帯による世帯移動[" & ID & "]→[" & DVProperty.ID & "]' AS 式2, Now() AS 式3 FROM [D:個人Info] WHERE ((([D:個人Info].世帯ID)=" & ID & "));"
                        .ExecuteSQL "UPDATE [D:個人Info] SET [D:個人Info].住記世帯番号 = [D:個人Info].世帯ID, [D:個人Info].住記続柄1 = [D:個人Info].続柄1, [D:個人Info].住記続柄2 = [D:個人Info].[続柄2], [D:個人Info].住記続柄3 = [D:個人Info].[続柄3] WHERE ((([D:個人Info].世帯ID)=" & ID & "));", "世帯員"
                        
                        If ZID = (-1) Then
                            .ExecuteSQL "UPDATE [D:個人Info] SET [D:個人Info].世帯ID = " & DVProperty.ID & ",[D:個人Info].合併異動 = True,[D:個人Info].合併異動日=Now() WHERE ((([D:個人Info].世帯ID)=" & ID & "));", "世帯員の移動"
                        Else
                            .ExecuteSQL "UPDATE [D:個人Info] SET [D:個人Info].世帯ID = " & DVProperty.ID & ",[D:個人Info].続柄1 = " & ZID & ", [D:個人Info].続柄2 = [続柄1], [D:個人Info].続柄3 = [続柄2], [D:個人Info].続柄4 = [続柄3], [D:個人Info].合併異動 = True,[D:個人Info].合併異動日=Now() WHERE ((([D:個人Info].世帯ID)=" & ID & "));", "世帯員の移動"
                            .ExecuteSQL "UPDATE [D:個人Info] SET [D:個人Info].続柄2 = 0 WHERE ((([D:個人Info].続柄2)=" & Val(.GetDirectData("S_システムデータ", "DATA", , "世帯主続柄コード")) & "));"
                        End If
    
                        '所有地の移動
                        .ExecuteSQL "INSERT INTO D_土地履歴 ( LID, 更新日, 異動日, 異動事由, 内容 ) SELECT [D:農地Info].ID, Date() AS 式1, Date() AS 式2, 10008 AS 式3, '合併世帯による管理世帯変更[" & ID & "]→[" & DVProperty.ID & "]' AS 式4 FROM [D:農地Info] WHERE ((([D:農地Info].所有世帯ID)=" & ID & ")) OR ((([D:農地Info].[管理世帯ID])=" & ID & "));", "所有農地の履歴作成"
                        .ExecuteSQL "UPDATE [D:農地Info] SET [D:農地Info].[管理世帯ID] = " & DVProperty.ID & " WHERE ((([D:農地Info].[管理世帯ID])=" & ID & ")) OR ((([D:農地Info].所有世帯ID)=" & ID & "));", "所有農地の移動"
                        
                        '小作地の移動
                        .ExecuteSQL "INSERT INTO D_土地履歴 ( LID, 更新日, 異動日, 異動事由, 内容 ) SELECT [D:農地Info].ID, Date() AS 式1, Date() AS 式2, 10009 AS 式3, '合併世帯による借受世帯変更[" & ID & "]→[" & DVProperty.ID & "]' AS 式4 FROM [D:農地Info] WHERE ((([D:農地Info].借受世帯ID)=" & ID & "));", "小作農地の履歴作成"
                        .ExecuteSQL "UPDATE [D:農地Info] SET [D:農地Info].借受世帯ID = " & DVProperty.ID & " WHERE ((([D:農地Info].借受世帯ID)=" & ID & "));", "小作農地の移動"
                        
                        '合併異動
                        .ExecuteSQL "UPDATE [D:世帯Info] SET [D:世帯Info].農地との関連 = False, [D:世帯Info].合併異動 = True, [D:世帯Info].関連世帯 = " & DVProperty.ID & ",[D:世帯Info].合併異動日=Now() WHERE ((([D:世帯Info].ID)=" & ID & "));", "元世帯の処理"
                        .ExecuteSQL "UPDATE [D:世帯Info] SET [D:世帯Info].合併異動 = True,[D:世帯Info].合併異動日=Now() WHERE (([D:世帯Info].ID)=" & DVProperty.ID & ");", "先世帯の処理"
                    End With
                End If
            Case "農地"
                Dim vDate As Date
                Dim sSQL As String
                
                Set p農地 = ADApp.ObjectMan.GetObject(Left$(sSourceList, InStr(sSourceList & ";", ";") - 1))
                Set p所有者 = ADApp.ObjectMan.GetObject("世帯員." & IIf(p農地.GetProperty2("管理者ID") <> 0, p農地.GetProperty2("管理者ID"), p農地.GetProperty2("所有者ID")))
                
                St = Fnc.OptionSelect("所有権移転(3条)の申請受付;貸借設定(3条)の申請受付;転用を伴う所有権移転(5条)の申請受付;転用を伴う賃借権設定(5条)の申請受付;利用権設定の申請受付;経営基盤法による所有権移転受付;利用権移転の申請受付;職権による管理者変更;職権による所有権移転;職権による貸借設定;職権による相続移転;時効取得", "設定する内容を選択してください。", SysAD.GetSettingData("農地基本台帳", "農地→世帯Drop", "所有権移転(3条)の申請受付"))
                If Len(St) Then ADApp.Common.RegData("農地→世帯Drop") = St
                Select Case St
                    Case "所有権移転(3条)の申請受付": 農地法3条所有権移転 p所有者, sSourceList, Me
                    Case "貸借設定(3条)の申請受付": 農地法3条耕作権移転 p所有者, sSourceList, Me
                    Case "利用権設定の申請受付": 経営基盤法利用権設定 p所有者, sSourceList, Me
                    Case "経営基盤法による所有権移転受付": 経営基盤法所有権移転 p所有者, sSourceList, CDataviewSK_GetProperty2("世帯主")
                    Case "利用権移転の申請受付":
                        Dim p借受者 As ADBasicLIB2.CDataviewSK
                        If p農地.GetProperty2("自小作別") < 1 Or p農地.GetProperty2("借受人ID") = 0 Then
                            MsgBox "貸借設定がされていません。"
                            Exit Sub
                        End If
                        Set p借受者 = ADApp.ObjectMan.GetObject("世帯員." & p農地.GetProperty2("借受人ID"))
                        経営基盤法利用権移転 p借受者, sSourceList, CDataviewSK_GetProperty2("世帯主"), p所有者
                    Case "転用を伴う所有権移転(5条)の申請受付": mod農家台帳.農地法5条所有権移転 p所有者, sSourceList, CDataviewSK_GetProperty2("世帯主")
                    Case "転用を伴う賃借権設定(5条)の申請受付": mod農家台帳.農地法5条賃借権設定 p所有者, sSourceList, CDataviewSK_GetProperty2("世帯主")
                        
                End Select
            Case Else
                Debug.Print "農家に" & Fnc.GetKeyHead(sSourceList) & "が落とされました。"
                Debug.Print "定義:Case " & Chr$(34) & Fnc.GetKeyHead(sSourceList) & Chr$(34)
        End Select
    End Sub

    Private Property Set CDataviewSK_DVProperty(ByVal RHS As ADBasicLIB2.CDataviewProperty): Set DVProperty = RHS: End Property
    Private Property Get CDataviewSK_DVProperty() As ADBasicLIB2.CDataviewProperty: Set CDataviewSK_DVProperty = DVProperty: End Property

    Private Function CDataviewSK_GetProperty2(sPropName As String, Optional sParam As String = "") As Variant
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim pDate As Date
        
        Select Case sPropName
            Case "名称": CDataviewSK_GetProperty2 = Fnc.NullCast(DVProperty.Rs.Value("氏名"), "-")
            Case "氏名": CDataviewSK_GetProperty2 = Fnc.NullCast(DVProperty.Rs.Value("氏名"), "-")
            Case "住所":
                If DVProperty.Rs.V("世帯主ID") <> 0 Then CDataviewSK_GetProperty2 = SystemDB.GetDirectData("D:個人Info", "住所", DVProperty.Rs.V("世帯主ID"))
            Case "世帯主KEY": CDataviewSK_GetProperty2 = "世帯員." & ADApp.DB.GetDirectData("D:世帯Info", "世帯主ID", DVProperty.ID)
            Case "世帯主名": CDataviewSK_GetProperty2 = Fnc.NullCast(DVProperty.Rs.Value("氏名"), "-")
            Case "世帯主ID": CDataviewSK_GetProperty2 = Fnc.NullCast(DVProperty.Rs.Value("世帯主ID"), 0)
            Case "世帯主": Set CDataviewSK_GetProperty2 = IIf(IsNull(DVProperty.Rs.Value("世帯主ID")), Null, ADApp.ObjectMan.GetObject("世帯員." & DVProperty.Rs.Value("世帯主ID")))
            Case "世帯主集落": CDataviewSK_GetProperty2 = IIf(IsNull(DVProperty.Rs.Value("世帯主ID")), Null, ADApp.ObjectMan.GetObjectDVP("世帯員." & DVProperty.Rs.Value("世帯主ID")).GetProperty2("集落名"))
            Case "世帯主職業": CDataviewSK_GetProperty2 = DVProperty.Rs.Value("世帯主職業")
            Case "住所": CDataviewSK_GetProperty2 = DVProperty.Rs.Value("住所")
            Case "メニュー": CDataviewSK_GetProperty2 = PopSub()
            Case "住民区分": CDataviewSK_GetProperty2 = 0
            Case "経営面積":
                Set Rs = SystemDB.GetRecordsetEx("SELECT Sum([田面積]+[畑面積]) AS 面積 FROM V_農地 INNER JOIN [D:個人Info] ON V_農地.耕作者ID = [D:個人Info].ID WHERE [D:個人Info].世帯ID=" & DVProperty.ID, 0, , Me)
                CDataviewSK_GetProperty2 = Rs.Value("面積")
                SystemDB.CloseRs Rs
            Case "借入面積":
                Set Rs = SystemDB.GetRecordsetEx("SELECT Sum([V_農地].田面積+[V_農地].畑面積) AS 耕作面積 FROM [V_農地] WHERE [V_農地].所有世帯ID<>" & DVProperty.ID & " AND [V_農地].借受世帯ID=" & DVProperty.ID & " AND [V_農地].自小作別>0", 0, , Me)
                If Not Rs Is Nothing Then CDataviewSK_GetProperty2 = Rs.Value("耕作面積"): SystemDB.CloseRs Rs
            Case "世帯員数":
                If DVProperty.ID <> 0 Then
                    Set Rs = SystemDB.GetRecordsetEx("SELECT Count([D:個人Info].ID) AS [世帯員数] FROM [D:個人Info] WHERE [D:個人Info].世帯ID=" & DVProperty.ID, 0, , Me)
                    CDataviewSK_GetProperty2 = Rs.Value("世帯員数")
                    SystemDB.CloseRs Rs
                End If
            Case "年齢":
                pDate = SystemDB.GetDirectData("D:個人Info", "生年月日", DVProperty.Rs.Value("世帯主ID"))
                CDataviewSK_GetProperty2 = IIf(IsDate(pDate), Fnc.年齢計算(pDate), 0)
            Case Else
                Debug.Assert CaseAssertPrint(sPropName, TypeName(Me))
        End Select
    End Function

    Private Property Get CDataviewSK_IconName() As String
        Select Case DVProperty.ClassStr
            Case "農家": CDataviewSK_IconName = "House"
            Case "営農情報": CDataviewSK_IconName = "Apply"
        End Select
    End Property

    Private Function PopSub() As String
        Dim St As String
        
        St = "開く;-;"
        Select Case DVProperty.ClassStr
            Case "農家"
                St = St & IIf(DVProperty.Rs.Value("兼業区分") = 4, "~基本台帳印刷;~耕作証明願;~耕作面積証明書;~営農計画書;", "基本台帳印刷;耕作証明願;耕作面積証明書;営農計画書;") & _
                "-;家族一覧;家族の追加;-;総括表;農家番号の入力;-;"
                
                St = St & "営農情報;-;" & _
                ">農地一覧;経営農地の一覧;所有農地の一覧;小作農地の一覧;貸出農地の一覧;" & IIf(Fnc.s市町村名 = "大崎町", "-;関連農地の一覧;", "") & "-;転用農地の一覧;<;" & _
                ">所有地の移動;農地の所有権移動−３条;農地の耕作権移動−３条;農地の転用−４条;転用目的の所有権移動−５条;利用権設定−基盤強化法;所有権移転;利用権移転;解約;<;"
                St = St & ">設定;家族農地の連動;合併世帯の解除;<"
                St = St & "-;" & IIf(DVProperty.Rs.Value("農地との関連"), "^", "") & "農地との関連"
                St = St & ";確認日時設定;関連申請"
                St = St & ";-;農地追加"
                If Val(SysAD.ApplicationDLL.Common.AppData("内部地図")) Then
                    St = St & ";-;地図呼び出し;"
                ElseIf SysAD.地図の有無 Then
                    St = St & ";-;>地図連動;経営農地を地図に表示;所有農地を地図に表示;小作農地を地図に表示;-;貸付農地を地図に表示;<"
                End If
                St = St & ";-;所有地一覧"
                St = St & ";-;あっせん申出"
            Case "営農情報"
                St = St & "世帯情報"
        End Select
        St = St & ";-;削除;"
        If Val(SysAD.ApplicationDLL.DB.DBProperty("地図情報")) Then St = St & "-;地図を呼ぶ;"
        If Not DVProperty.Body Is Nothing Then St = St & "-;閉じる;"
        PopSub = St
    End Function

    Private Function CDataviewSK_PopupMenu(Optional ByVal sParam As String = "", Optional vParam As Variant) As String
        Dim St As String
        Dim pDV As ADBasicLIB2.CDataviewSK
        Dim Rs As ADBasicLIB2.RecordsetEx
        
        St = SysAD.PopupMenu(PopSub())
        Select Case St
            Case "利用権設定−基盤強化法":
                Set pDV = ADApp.ObjectMan.GetObject("申請.-1")
                
                Set Rs = SystemDB.GetRecordsetEx("SELECT *,[D:個人Info].[氏名] AS [氏名] FROM [D:世帯INFO] INNER JOIN [D:個人Info] ON [D:個人Info].ID = [D:世帯Info].世帯主ID  WHERE [D:世帯Info].ID=" & DVProperty.ID)
                
                With pDV
                    .DoCommand2 "名称", DVProperty.Rs.Value("氏名") & "→"
                    .DoCommand2 "法令", state基盤利用権設定
                    .DoCommand2 "状態", 0
                    .DoCommand2 "申請者A", DVProperty.Rs.Value("世帯主ID")
                    .DoCommand2 "申請世帯A", DVProperty.Rs.Value("ID")
                    .DoCommand2 "住所A", DVProperty.Rs.Value("住所")
                    .DoCommand2 "受付年月日", CStr(Date)
                    .DoCommand2 "Update"
                End With
                mvarPDW.DataviewCol.Add pDV
                SystemDB.CloseRs Rs
            Case "利用権移転":
                Set pDV = ADApp.ObjectMan.GetObject("申請.-1")
                
                Set Rs = SystemDB.GetRecordsetEx("SELECT *,[D:個人Info].[氏名] AS [氏名] FROM [D:世帯INFO] INNER JOIN [D:個人Info] ON [D:個人Info].ID = [D:世帯Info].世帯主ID  WHERE [D:世帯Info].ID=" & DVProperty.ID)
                With pDV
                    .DoCommand2 "名称", DVProperty.Rs.Value("氏名") & "→"
                    .DoCommand2 "法令", state基盤利用権移転
                    .DoCommand2 "状態", 0
                    .DoCommand2 "申請世帯A", DVProperty.Rs.Value("ID")
                    .DoCommand2 "申請者A", DVProperty.Rs.Value("世帯主ID")
                    .DoCommand2 "住所A", DVProperty.Rs.Value("住所")
                    .DoCommand2 "受付年月日", CStr(Date)
                    .DoCommand2 "Update"
                End With
                mvarPDW.DataviewCol.Add pDV
                SystemDB.CloseRs Rs
            Case Else
                CDataviewSK_DoCommand2 St
        End Select
    End Function

    Private Sub CDataviewSK_Refresh(Optional bReLoad As Boolean = False)
        Debug.Assert False 'Non Code
    End Sub

    '各DLL共通↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓
    Private Property Let CDataviewSK_Key(ByVal RHS As String): DVProperty.Key = RHS: End Property
    Private Property Get CDataviewSK_Key() As String: CDataviewSK_Key = DVProperty.Key: End Property
    '各DLL共通↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑
    Private Sub Class_Terminate()
        Set DVProperty = Nothing
    End Sub

End Class










Class CObj農地
    Option Explicit
    Implements ADBasicLIB2.CDataviewSK
    
    Private DVProperty As CDataviewProperty
    Private Sub Class_Initialize(): Set DVProperty = mvarPDW.DataviewCol.GetNewDVP: End Sub
    
    '/****** ID型General_Key ******/
    Public Property Get Key() As String: Key = DVProperty.Key: End Property
    Public Property Let Key(ByVal RHS As String)
        DVProperty.SetDVP RHS, SystemDB, "SELECT *,IIF([管理世帯ID]<>0,[管理世帯ID],[所有世帯ID]) AS [農家世帯ID] FROM [D:農地INFO] WHERE [D:農地Info].ID=%DVP.ID%"
    End Property
    '/****** ID型General_Key ******/

    '各DLL共通↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓
    Private Sub CDataviewSK_CloseRecordset(): DVProperty.CloseRs: End Sub

    Private Sub CDataviewSK_DblClick(): CDataviewSK_DoCommand2 "開く": End Sub
    '各DLL共通↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑
    
    Private Property Set CDataviewSK_Container(ByVal RHS As ADBasicLIB2.CPDW)
        Set DVProperty.Containner = RHS
        
        Set DVProperty.Controls.Parent = Me
        Set DVProperty.Controls.Recordset = DVProperty.Rs
        
        ADApp.Common.SetDataView "農地", DVProperty.Controls
        DVProperty.Controls.AttachData
        
        If Val(DVProperty.Controls.Value("自小作ID")) <> 0 Then
            DVProperty.Body.GroupVisible("G小作") = True
            DVProperty.Body.ReLocateDVCtrl Me
        Else
            DVProperty.Body.GroupVisible("G小作") = False
            DVProperty.Body.ReLocateDVCtrl Me
        End If
    End Property
    
    Private Function CDataviewSK_DoCommand2(sCmd As String, Optional sParam As String = "") As Variant
        Dim pObj As Object
        Dim St As String
        Dim St2 As String
        Dim St3 As String
        Dim ID As Long
        Dim nArea As Single
        Dim pDate As Date
        Dim Rs As ADBasicLIB2.RecordsetEx
        
        Select Case sCmd
            '/*必須
            Case "開く": ADApp.DataviewCol.Add Me
            Case "閉じる": ADApp.DataviewCol.Remove DVProperty.Key
            Case "更新": DVProperty.Controls.UpdateControlValues True, True
                ADApp.DataviewCol.RefreshIcon DVProperty.Key
            Case "部分農地の分割"
  
                mvarPDW.SQLListview.Refresh
            Case "樹園地設定":
                If DVProperty.Rs.Value("田面積") > 0 Then
                    nArea = DVProperty.Rs.Value("田面積")
                ElseIf DVProperty.Rs.Value("畑面積") > 0 Then
                    nArea = DVProperty.Rs.Value("畑面積")
                Else
                    nArea = DVProperty.Rs.Value("登記簿面積")
                End If
                Make農地履歴 DVProperty.ID, Now, Now, 997, "樹園地へ変換", , , , "UPDATE [D:農地Info] SET [農委地目ID]=997,[田面積]=0,[畑面積]=0,[樹園地]=" & nArea & " WHERE [ID]=" & DVProperty.ID
            Case "地図システムを呼ぶ":
                On Error Resume Next
                SysAD.SendMessTo地図 DVProperty.ID
            Case "地図呼び出し"
                If DVProperty.Rs.Value("地図ID") = 0 Then
                    ID = mvarPDW.MapView.AttachLandInfo(DVProperty.Rs.Value("大字ID"), DVProperty.Rs.Value("小字ID"), DVProperty.Rs.Value("地番"))
                    If ID > 0 Then DVProperty.Rs.Update "地図ID", ID
                Else
                    ID = DVProperty.Rs.Value("地図ID")
                End If

                If ID = -1 Then
                    MsgBox "指定された土地は地図上で見つかりません", vbInformation, "地図情報"
                Else
                    mvarPDW.MapView.SelectLand "土地." & ID
                End If
            Case "メニュー": CDataviewSK_PopupMenu
            Case "小作法令＝農地法": DVProperty.Rs.Update "小作地適用法", 1
            Case "小作法令＝基盤強化法": DVProperty.Rs.Update "小作地適用法", 2
            Case "貸借形態＝賃貸借": DVProperty.Rs.Update "小作形態", 1
            Case "貸借形態＝使用貸借": DVProperty.Rs.Update "小作形態", 2
            Case "履歴追加"
                Set Rs = SystemDB.GetRecordsetEx("SELECT * FROM [D_土地履歴]", , , "土地履歴の追加")
                Rs.AddNewArray GetArray("LID", DVProperty.ID, "更新日", Date, "異動日", Date, "異動事由", 0)
                mvarPDW.DataviewCol.Add ADApp.ObjectMan.GetObject("土地履歴." & Rs.ID), Me
                SystemDB.CloseRs Rs
            Case "４条申請": mod農家台帳.農地法4条設定 Me
            Case "５条所有権申請": mod農家台帳.農地法5条所有権移転 CDataviewSK_GetProperty2("所有者"), Me.Key
            Case "５条貸借申請":: mod農家台帳.農地法5条賃借権設定 CDataviewSK_GetProperty2("所有者"), Me.Key
            '/*必須

            Case "４条転用", "５条転用":
                CDataviewSK_DoCommand2 "閉じる"

                If MsgBox("転用しますか", vbYesNo) = vbYes Then
                    SystemDB.ExecuteSQL "INSERT INTO D_土地履歴 ( LID, 更新日, 内容 ) VALUES (" & DVProperty.ID & ",Now(),'職権による転用修正')"
                    SystemDB.ExecuteSQL "INSERT INTO D_転用農地 SELECT [D:農地Info].* FROM [D:農地Info] WHERE ((([D:農地Info].ID)=" & DVProperty.ID & "));"
                    SystemDB.ExecuteSQL "DELETE [D:農地Info].ID FROM [D:農地Info] WHERE [D:農地Info].ID=" & DVProperty.ID
                    mvarPDW.SQLListview.Refresh
                End If
            Case "貸借の再設定": mod農家台帳.経営基盤法利用権設定 CDataviewSK_GetProperty2("管理者"), DVProperty.Key, CDataviewSK_GetProperty2("Obj受人"), "再設定"
            Case "削除":
                DVProperty.CloseRs
                SystemDB.ExecuteSQL "INSERT INTO D_削除農地 SELECT [D:農地Info].* FROM [D:農地Info] WHERE ((([D:農地Info].ID)=" & DVProperty.ID & "));"
                CDataviewSK_DoCommand2 "閉じる"
                SystemDB.ExecuteSQL "DELETE * FROM [D:農地Info] WHERE [ID]=" & DVProperty.ID
                If Not StrConv(sParam, vbLowerCase) = "nosearch" Then
                    mvarPDW.SQLListview.Refresh
                End If
            Case "確認日時設定", "スペース": DVProperty.Rs.Update "確認日時", IIf(IsNull(DVProperty.Rs.V("確認日時")), Date, Null): mvarPDW.SQLListview.Refresh
            Case "履歴一覧": mvarPDW.SQLListview.SQLListviewCHead "SELECT '土地履歴.' & D_土地履歴.ID AS [KEY], D_土地履歴.異動日,'Unit' AS Icon,'Unit' AS SelectIcon,V_土地異動事由.名称 AS [異動事由], D_土地履歴.内容 FROM D_土地履歴 LEFT JOIN V_土地異動事由 ON D_土地履歴.異動事由 = V_土地異動事由.ID WHERE ((D_土地履歴.LID)=" & DVProperty.ID & ") ORDER BY [異動日] DESC;", "No;!;=異動日;異動日;%3000,異動事由;異動事由;%3500,内容;内容", "履歴一覧"
            Case "履歴一覧Lst_DblClick": mvarPDW.DataviewCol.Add ADApp.ObjectMan.GetObject(sParam)
            Case "管理世帯を呼ぶ": mvarPDW.DataviewCol.Add ADApp.ObjectMan.GetObject("農家." & DVProperty.Rs.Value("管理世帯ID"))
            Case "所有世帯を呼ぶ":
                If DVProperty.Rs.Value("所有世帯ID") = 0 Then
                ElseIf SystemDB.RecordExists("D:世帯Info", "[ID]=" & DVProperty.Rs.Value("所有世帯ID")) Then
                    mvarPDW.DataviewCol.Add ADApp.ObjectMan.GetObject("農家." & DVProperty.Rs.Value("農家世帯ID"))
                Else
                    MsgBox "農地基本台帳がありません。", vbInformation
                End If
            Case "所有者を呼ぶ": mvarPDW.DataviewCol.Add ADApp.ObjectMan.GetObject("世帯員." & DVProperty.Rs.Value("所有者ID"))
            Case "管理者を呼ぶ": mvarPDW.DataviewCol.Add ADApp.ObjectMan.GetObject("世帯員." & DVProperty.Rs.Value("管理者ID"))
            Case "借受世帯を呼ぶ": mvarPDW.DataviewCol.Add ADApp.ObjectMan.GetObject("農家." & DVProperty.Rs.Value("借受世帯ID"))
            Case "借受者を呼ぶ":
                Set pObj = ObjectMan.GetObject("世帯員." & DVProperty.Rs.Value("借受人ID"))
                If Not pObj Is Nothing Then mvarPDW.DataviewCol.Add pObj
            Case "同所有者の所有地検索": view農地List "WHERE [所有者ID]=" & DVProperty.Rs.Value("所有者ID"), "同所有者の所有地検索", True '/** 農地0001-0001-0002
            Case "関連申請": List関連申請 DVProperty.ID
            Case "自小作別切替":
                If Val(DVProperty.Controls.Value("自小作ID")) <> 0 Then
                    DVProperty.Body.GroupVisible("G小作") = True
                    DVProperty.Body.ReLocateDVCtrl Me
                Else
                    DVProperty.Body.GroupVisible("G小作") = False
                    DVProperty.Body.ReLocateDVCtrl Me
                End If
            Case "期間設定":
                Dim n As Long
                n = DVProperty.Containner.GetAddDate(DVProperty.Controls.Value("始期DT"), 3, 0, 0)
                If n Then DVProperty.Controls.Value("終期DT") = n - 1
            Case "遊休化"
                DVProperty.Rs.Update "遊休化", Not DVProperty.Rs.Value("遊休化")
                If IsDate(sParam) Then DVProperty.Rs.Update "遊休時期", IIf(DVProperty.Rs.Value("遊休化"), CDate(sParam), Null)
            Case "無断転用"
                DVProperty.Rs.Update "無断転用", Not DVProperty.Rs.Value("無断転用")
                If IsDate(sParam) Then DVProperty.Rs.Update "無断転用調査日", IIf(DVProperty.Rs.Value("無断転用"), CDate(sParam), Null)
            Case ""
            Case "議案書付解約": 農地法20条解約 DVProperty.Key
            Case "貸借の解約", "議案書無し合意解約", "職権解約": 解約
            Case "共有持分の分割":
                Dim pFrm As New frm共有分割
                If pFrm.分割(DVProperty.ID) Then
                    CDataviewSK_DoCommand2 "閉じる"
                End If
            Case "Set農委地目"
                If Val(DVProperty.Controls.Text("農委地目ID")) > 0 Then
                    DVProperty.Controls.Value("DT農委地目認定日") = Date
                Else
                    DVProperty.Controls.Value("DT農委地目認定日") = 0
                End If
            Case "耕作目的−公売", "耕作目的−競売", "転用目的−公売", "転用目的−競売": mod農家台帳.買受適格 CDataviewSK_GetProperty2("管理者"), DVProperty.Key, sCmd
            Case "農用地利用計画変更": mod農家台帳.農用地利用計画変更 Me
            Case "あっせん申出": mod農家台帳.あっせん申出渡 Me
            Case "農地利用変更": mod農家台帳.農地利用変更 Me
            Case "履歴一覧Lst_ListRefresh": mvarPDW.DataviewCol.Refresh
            Case "期間満了の終了": sub農地期間満了の終了 DVProperty.ID ' 農地-8060-321              Stop
            Case "GotFocus"
            Case "小作料設定"
                Dim pDic As CDataDictionary
                Dim StX As String
                StX = Replace(ADApp.DB.DBProperty("小作料単位"), ";", ",")
                Set pDic = Fnc.InputMulti("小作料設定", "小作料を入力してください", "小作料;文字;" & DVProperty.V("小作料", "") & "|単価;文字選択;" & DVProperty.V("小作料単位", "") & ";;" & StX)
                If Not pDic Is Nothing Then
          
                    If Len(pDic.Item("小作料")) Then DVProperty.Rs.Update "小作料", pDic.Item("小作料") Else DVProperty.Rs.Update "小作料", Null
                    If Len(pDic.Item("単価")) Then DVProperty.Rs.Update "小作料単位", pDic.Item("単価") Else DVProperty.Rs.Update "小作料単位", Null
                    
                    'mvarPDW.PrintGo ObjectMan.GetObject("利用権印刷"), pDic.Item("開始日") & ";" & pDic.Item("終了日")
                End If

            Case Else
                Debug.Assert CaseAssertPrint(sCmd, "CObj農地")
        End Select
    End Function
      
    Private Sub CDataviewSK_DropDown(sSourceList As String, Optional sOption As String = "")
        Dim ID As Long
        Dim pID As Long
        Dim Ar As Variant
        
        With DVProperty.Controls
            Select Case sOption
                Case "TX所有世帯ID", "TX所有者ID", "TX所有者名":
                    Select Case Fnc.GetKeyHead(sSourceList)
                        Case "農家":
                            If MsgBox("所有世帯を変更しますか", vbYesNo) = vbYes Then
                                ID = Fnc.GetKeyCode(sSourceList)
                                pID = SystemDB.GetDirectData("D:世帯Info", "世帯主ID", ID)
                                .Value("TX所有世帯ID") = ID
                                .Value("TX所有者ID") = pID
                                .Value("TX所有者名") = SystemDB.GetDirectData("D:個人Info", "氏名", pID)
                            End If
                        Case "世帯員":
                            If MsgBox("所有者を変更しますか", vbYesNo) = vbYes Then
                                pID = Fnc.GetKeyCode(sSourceList)
                                ID = Fnc.NullCast(SystemDB.GetDirectData("D:個人Info", "世帯ID", pID), 0)
                                .Value("TX所有世帯ID") = ID
                                .Value("TX所有者ID") = pID
                                .Value("TX所有者名") = SystemDB.GetDirectData("D:個人Info", "氏名", pID)
                            End If
                    End Select
                Case "TX管理世帯ID", "TX管理者ID"
                    Select Case Fnc.GetKeyHead(sSourceList)
                        Case "農家":
                            If MsgBox("管理世帯を変更しますか", vbYesNo) = vbYes Then
                                ID = Fnc.GetKeyCode(sSourceList)
                                .Value("TX管理世帯ID") = ID
                            End If
                        Case "世帯員":
                            If MsgBox("管理者を変更しますか", vbYesNo) = vbYes Then
                                pID = Fnc.GetKeyCode(sSourceList)
                                ID = Fnc.NullCast(SystemDB.GetDirectData("D:個人Info", "世帯ID", pID), 0)
                                .Value("TX管理者ID") = pID
                                .Value("TX管理者名") = SystemDB.GetDirectData("D:個人Info", "氏名", pID)
                                .Value("TX管理世帯ID") = ID
                            End If
                    End Select
                Case "TX管理者名"
                    Select Case Fnc.GetKeyHead(sSourceList)
                        Case "農家":
                            If MsgBox("管理者を変更しますか", vbYesNo) = vbYes Then
                                ID = Fnc.GetKeyCode(sSourceList)
                                pID = SystemDB.GetDirectData("D:世帯Info", "世帯主ID", ID)
                                .Value("TX管理者ID") = pID
                                .Value("TX管理者名") = SystemDB.GetDirectData("D:個人Info", "氏名", pID)
                                .Value("TX管理世帯ID") = ID
                            End If
                        Case "世帯員":
                            If MsgBox("管理者を変更しますか", vbYesNo) = vbYes Then
                                pID = Fnc.GetKeyCode(sSourceList)
                                ID = SystemDB.GetDirectData("D:個人Info", "世帯ID", pID)
                                .Value("TX管理者ID") = pID
                                .Value("TX管理者名") = SystemDB.GetDirectData("D:個人Info", "氏名", pID)
                                .Value("TX管理世帯ID") = ID
                            End If
                    End Select
                Case "TX小作世帯ID", "TX小作者", "TX小作者ID":
                    Select Case Fnc.GetKeyHead(sSourceList)
                        Case "農家":
                            If MsgBox("借受世帯を変更しますか", vbYesNo) = vbYes Then
                                ID = Fnc.GetKeyCode(sSourceList)
                                pID = SystemDB.GetDirectData("D:世帯Info", "世帯主ID", ID)
                                .Value("TX小作世帯ID") = ID
                                .Value("TX小作者ID") = pID
                                .Value("TX小作者") = SystemDB.GetDirectData("D:個人Info", "氏名", pID)
                            End If
                        Case "世帯員":
                            If MsgBox("借受者を変更しますか", vbYesNo) = vbYes Then
                                pID = Fnc.GetKeyCode(sSourceList)
                                ID = Val(SystemDB.GetDirectData("D:個人Info", "世帯ID", pID))
                                .Value("TX小作世帯ID") = ID
                                .Value("TX小作者ID") = pID
                                .Value("TX小作者") = SystemDB.GetDirectData("D:個人Info", "氏名", pID)
                            End If
                    End Select
                Case "TX生産法人ID", "TX生産法人名"
                    Select Case Fnc.GetKeyHead(sSourceList)
                        Case "農家":
                            If MsgBox("経由者を変更しますか", vbYesNo) = vbYes Then
                                pID = SystemDB.GetDirectData("D:世帯Info", "世帯主ID", Fnc.GetKeyCode(sSourceList))
                                .Value("TX生産法人ID") = pID
                                .Value("TX生産法人名") = SystemDB.GetDirectData("D:個人Info", "氏名", pID)
                            End If
                        Case "世帯員":
                            If MsgBox("経由者を変更しますか", vbYesNo) = vbYes Then
                                pID = Fnc.GetKeyCode(sSourceList)
                                .Value("TX生産法人ID") = pID
                                .Value("TX生産法人名") = SystemDB.GetDirectData("D:個人Info", "氏名", pID)
                            End If
                    End Select
                Case ""
                    Select Case Fnc.GetKeyHead(sSourceList)
                        Case "世帯員"
                            Ar = Split(sSourceList, ";")
                            If Not UBound(Ar) = 0 Then
                            ElseIf Len(Ar(0)) Then
                                
                            End If
                    End Select
                Case Else
                    Debug.Assert False
            End Select
        End With
    End Sub

    Private Property Set CDataviewSK_DVProperty(ByVal RHS As ADBasicLIB2.CDataviewProperty): Set DVProperty = RHS: End Property
    Private Property Get CDataviewSK_DVProperty() As ADBasicLIB2.CDataviewProperty: Set CDataviewSK_DVProperty = DVProperty: End Property

    Private Function CDataviewSK_PopupMenu(Optional ByVal sParam As String = "", Optional vParam As Variant) As String
        CDataviewSK_DoCommand2 SysAD.PopupMenu(PopSub)
    End Function

    Private Sub CDataviewSK_Refresh(Optional bReLoad As Boolean = False)
        Debug.Assert False 'Non Code
    End Sub

    Private Function CDataviewSK_GetProperty2(sPropName As String, Optional sParam As String = "") As Variant
        Dim Rs As ADBasicLIB2.RecordsetEx
        Select Case sPropName
            Case "名称"
                Set Rs = SystemDB.GetRecordsetEx("SELECT * FROM [V_農地] WHERE [V_農地].ID=" & DVProperty.ID & ";", , , "農地Obj.名称")
                CDataviewSK_GetProperty2 = Rs.Value("土地所在")
                SystemDB.CloseRs Rs
            Case "メニュー": CDataviewSK_GetProperty2 = PopSub(True)
            Case "Obj貸人"
                Set Rs = SystemDB.GetRecordsetEx("SELECT * FROM [D:個人Info] WHERE [ID]=" & IIf(DVProperty.Rs.Value("管理者ID") <> 0, DVProperty.Rs.Value("管理者ID"), DVProperty.Rs.Value("所有者ID")), , , "農地の所有者")
                If Not Rs.EOF Then
                    Set CDataviewSK_GetProperty2 = ADApp.ObjectMan.GetObject("世帯員." & IIf(DVProperty.Rs.Value("管理者ID") <> 0, DVProperty.Rs.Value("管理者ID"), DVProperty.Rs.Value("所有者ID")))
                End If
                SystemDB.CloseRs Rs
            Case "Obj受人"
                Set Rs = SystemDB.GetRecordsetEx("SELECT * FROM [D:個人Info] WHERE [ID]=" & DVProperty.Rs.Value("借受人ID"), , , "農地の借受人")
                If Not Rs.EOF Then
                    Set CDataviewSK_GetProperty2 = ADApp.ObjectMan.GetObject("世帯員." & DVProperty.Rs.Value("借受人ID"))
                End If
                SystemDB.CloseRs Rs
            Case "所有者":
                Set CDataviewSK_GetProperty2 = ADApp.ObjectMan.GetObject("世帯員." & DVProperty.Rs.Value("所有者ID"))
            Case "所有者名":
                Set Rs = SystemDB.GetRecordsetEx("SELECT * FROM [D:個人Info] WHERE [ID]=" & DVProperty.Rs.Value("所有者ID"), , , "農地の所有者")
                CDataviewSK_GetProperty2 = Rs.NullCast("氏名", "")
            Case "管理者":
                Set CDataviewSK_GetProperty2 = ADApp.ObjectMan.GetObject("世帯員." & IIf(DVProperty.Rs.Value("管理者ID") <> 0, DVProperty.Rs.Value("管理者ID"), DVProperty.Rs.Value("所有者ID")))
            Case Else
                CDataviewSK_GetProperty2 = DVProperty.Rs.Value(sPropName)
        End Select
    End Function

    Private Property Get CDataviewSK_IconName() As String: CDataviewSK_IconName = "LAND": End Property

    Private Property Let CDataviewSK_Key(ByVal RHS As String): Me.Key = RHS: End Property
    Private Property Get CDataviewSK_Key() As String: CDataviewSK_Key = Me.Key: End Property

    Private Function PopSub(Optional bPluralMenu As Boolean = False) As String
        Dim St As String
        
        Select Case DVProperty.ClassStr
            Case "農地"
                St = "開く;履歴一覧;-;"
                If DVProperty.Rs.Value("管理世帯ID") <> 0 Then St = St & "管理世帯を呼ぶ;"
                If DVProperty.Rs.Value("所有世帯ID") = 0 Then St = St & "~所有世帯を呼ぶ;" Else St = St & "所有世帯を呼ぶ;"
                St = St & ">所有者;所有者を呼ぶ;同所有者の所有地検索;<;"
                '地図を呼ぶ"
                If DVProperty.Rs.Value("自小作別") > 0 Then
                    If DVProperty.Rs.Value("借受世帯ID") = 0 Then St = St & "-;~借受世帯を呼ぶ;" Else St = St & "-;借受世帯を呼ぶ;"
                    St = St & "借受者を呼ぶ;-;"
                    Select Case Fnc.NullCast(DVProperty.Rs.Value("小作地適用法"), 0)
                        Case 1: St = St & ">適用法令;@小作法令＝農地法;小作法令＝基盤強化法;<;"
                        Case 2: St = St & ">適用法令;小作法令＝農地法;@小作法令＝基盤強化法;<;"
                        Case Else: St = St & ">適用法令;小作法令＝農地法;小作法令＝基盤強化法;<;"
                    End Select
                    Select Case Fnc.NullCast(DVProperty.Rs.Value("小作形態"), 0)
                        Case 1: St = St & ">貸借形態;@貸借形態＝賃貸借;貸借形態＝使用貸借;<;"
                        Case 2: St = St & ">貸借形態;貸借形態＝賃貸借;@貸借形態＝使用貸借;<;"
                        Case Else: St = St & ">貸借形態;貸借形態＝賃貸借;貸借形態＝使用貸借;<;"
                    End Select
                    St = St & ">解約／再設定;議案書付解約;議案書無し合意解約;職権解約;-;期間満了の終了;-;"
                    If DVProperty.Rs.Value("小作地適用法") = 2 Then St = St & "貸借の再設定;"
                    St = St & "<;"
                End If
                    St = St & "小作料設定;"
                St = St & "-;部分農地の分割;"
                If DVProperty.Rs.Value("共有持分分母") > 0 Then St = St & "~共有持分の分割;" Else St = St & "共有持分の分割;"
                If Val(SysAD.ApplicationDLL.Common.AppData("内部地図")) Then
                    St = St & "-;地図呼び出し;"
                ElseIf SysAD.地図の有無 Then
                    St = St & "-;地図システムを呼ぶ;"
                End If
                If Not bPluralMenu Then
                    St = St & "-;>転用;４条申請;５条所有権申請;５条貸借申請;-;>直接転用;４条転用;５条転用;<;<;"
                    If Val(SystemDB.DBProperty("買受適格使用")) = -1 Then: St = St & ">買受適格申請;耕作目的−公売;耕作目的−競売;-;転用目的−公売;転用目的−競売;<;"
                    St = St & "農用地利用計画変更;あっせん申出;農地利用変更;非農地証明願;"
                    St = St & "-;;遊休化;無断許可;樹園地設定;確認日時設定;関連申請;-;"
                    St = St & "削除;"
                    If Not DVProperty.Body Is Nothing Then St = St & "-;閉じる;"
                End If
            Case "申請農地"
            
        End Select
        PopSub = St
    End Function

    Private Sub Class_Terminate()
        Set DVProperty = Nothing
    End Sub

    '/*********************** チェック済み ***************************/
    Private Sub sub農地期間満了の終了(ByVal nID As Long) '農基:農地-20080328-01 最終確認[2008/03/28]
        If MsgBox("指定農地と同条件の貸借を期間満了で終了しますか？", vbYesNo) = vbYes Then
            SystemDB.ExecuteSQL "INSERT INTO D_土地履歴 ( LID, 内容, 異動日,更新日, 関係者A, 関係者B, 異動事由 ) SELECT [D:農地Info_1].ID, [氏名] & 'への利用権設定[' & Format$([D:農地Info].[小作開始年月日],'gggee\年mm\月dd\日') & ']〜[' & Format$([D:農地Info].[小作終了年月日],'gggee\年mm\月dd\日') & ']を期間満了で終了。' AS 式1, Date() AS 式2, Date() AS 式3, [D:農地Info_1].所有者ID, [D:農地Info].借受人ID, 10201 AS 式4 FROM ([D:農地Info] INNER JOIN [D:農地Info] AS [D:農地Info_1] ON ([D:農地Info].小作終了年月日 = [D:農地Info_1].小作終了年月日) AND ([D:農地Info].小作開始年月日 = [D:農地Info_1].小作開始年月日) AND ([D:農地Info].小作地適用法 = [D:農地Info_1].小作地適用法) AND ([D:農地Info].借受人ID = [D:農地Info_1].借受人ID) AND ([D:農地Info].自小作別 = [D:農地Info_1].自小作別)) INNER JOIN [D:個人Info] ON [D:農地Info_1].借受人ID = [D:個人Info].ID WHERE ((([D:農地Info].ID)=" & nID & ") AND (([D:農地Info].自小作別)<>0));"
            SystemDB.ExecuteSQL "UPDATE [D:農地Info] INNER JOIN [D:農地Info] AS [D:農地Info_1] ON ([D:農地Info].小作終了年月日 = [D:農地Info_1].小作終了年月日) AND ([D:農地Info].小作開始年月日 = [D:農地Info_1].小作開始年月日) AND ([D:農地Info].小作地適用法 = [D:農地Info_1].小作地適用法) AND ([D:農地Info].借受人ID = [D:農地Info_1].借受人ID) AND ([D:農地Info].自小作別 = [D:農地Info_1].自小作別) SET [D:農地Info_1].自小作別 = 0 WHERE ((([D:農地Info].ID)=" & nID & ") AND (([D:農地Info].自小作別)<>0));"
        End If
    End Sub


End Class










Class CPrint3条届出書
    Option Explicit
    Implements CPrintCls
    Private mvarKey As String
    Private mvarPRP As CPrintProperty

    Private Sub Class_Initialize(): Set mvarPRP = New CPrintProperty: End Sub

    Private Property Get CPrintCls_CanCancelPrint() As Boolean: End Property
    Private Property Get CPrintCls_CanPrintNowPage() As Boolean: End Property
    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean: End Function
    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property

    Private Property Let CPrintCls_Key(ByVal RHS As String): End Property
    Private Property Get CPrintCls_Key() As String: CPrintCls_Key = mvarKey: End Property
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants: CPrintCls_Orientation = vbPRORPortrait: End Property

    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&): End Sub
    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Set CPrintCls_Parent(RHS As ADBasicLIB2.CPrintFormSK): Set mvarPRP.Parent = RHS: End Property

    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        CPrintCls_Repaint
        mvarPRP.Parent.EndDoc
    End Sub

    Private Sub CPrintCls_Repaint()
        Dim nFsize As Integer
        Dim Ar As Variant
        Dim Ar2 As Variant
        
        nFsize = 10
        Ar = GetArray(18, 30, 12, 20, 57, 26)
        Ar2 = GetArray(44, 12, 12, 13, 15, 11, 16, 17, 13, 10)
        
        With mvarPRP.Parent
            .ClearScreen
            .Offset 0, 0
            
            .TextOut "様式第10号", 20, 20, nFsize, 0, 0
            .TextOut "農地法第３条第１項第７号の３の規定による届出書", 101.5, 25, 13, 2, 0
            .TextOut "平成　　　年　　　月　　　日", 183, 39, nFsize, 1, 0
            .TextOut "農業委員会", 48, 46, nFsize, 0, 0
            .TextOut "殿", 70, 46, 11, 0, 0
            .TextOut "届出者（譲受人）名　　　称", 88, 52, nFsize, 0, 0
            .TextOut "　　　　　　　　代表者氏名署名", 88, 59, nFsize, 0, 0
            .TextOut "譲　　渡　　人　氏名（名称及び代表者名）署名", 88, 65, nFsize, 0, 0
            .TextOut "　下記農地（採草放牧地）の（に）　　　　　　　を　　　　　　　したいので、農地法第３条第１項", 20, 78, nFsize, 0, 0
            .TextOut "第７号の３及び同法施行規則第２条の７の規定により届け出ます。", 20, 85, nFsize, 0, 0
            .TextOut "記", 101.5, 97, nFsize, 2, 2
            .TextOut "１　当事者の氏名（名称）、住所、職業及び年齢", 20, 105, nFsize, 0, 0
            .TextOut "当事者", 29, 115.5, nFsize, 2, 2
            .TextOut "氏　　　名", 53, 115.5, nFsize, 2, 2
            .TextOut "年齢", 74, 115.5, nFsize, 2, 2
            .TextOut "職業", 90, 115.5, nFsize, 2, 2
            .TextOut "現　　住　　所", 128.5, 115.5, nFsize, 2, 2
            .TextOut "備　　考", 170, 115.5, nFsize, 2, 2
            .TextOut "譲受人", 29, 124, nFsize, 2, 2
            .TextOut "譲渡人", 29, 134, nFsize, 2, 2
            .TextOut "２　届出に係る土地の所在、地番、地目、面積、利用状況、普通収穫高及び耕作者の氏名又は名称", 20, 150, nFsize, 0, 0
            .TextOut "土 地 の 所 在", 42, 165.5, nFsize, 2, 2
            .TextOut "地　目", 76, 160.5, nFsize, 2, 2
            .TextOut "登記簿", 70, 169, nFsize, 2, 2
            .TextOut "現況", 82, 169, nFsize, 2, 2
            .DrawText "面積\nu", 88, 166, 13, 5, nFsize, 2, 2
            .DrawText "10a当り\n普　通\n収穫高", 101, 166, 15, 4, nFsize, 2, 2
            .DrawText "利用\n状況", 116, 166, 11, 5, nFsize, 2, 2
            .DrawText "所有者\n氏　名\n（名称）", 127, 165.5, 16, 4, nFsize, 2, 2
            .TextOut "利 用 者", 158, 160.5, nFsize, 2, 2
            .DrawText "氏　名\n（名称）", 143, 169.5, 17, 4, nFsize, 2, 2
            .DrawText "利 用\n権 原", 160, 169.5, 13, 4, nFsize, 2, 2
            .TextOut "備考", 178, 165.5, nFsize, 2, 2
            .TextOut "３　権利を設定し、又は移転しようとする事由の詳細", 20, 201, nFsize, 0, 0
            .TextOut "４　権利を設定し、又は移転しようとする契約の内容", 20, 214, nFsize, 0, 0
            .TextOut "［記載事項］", 20, 227, nFsize, 0, 0
            .TextOut "  １　届出者又は譲渡人が個人の場合は、署名は必ず本人が自署する。", 20, 234, nFsize, 0, 0
            .TextOut "　　　届出者又は譲渡人が法人の場合は、代表者の署名は必ず代表者本人が自署する。", 20, 239, nFsize, 0, 0
            .TextOut "　２　記１については、法人の場合にあっては名称、代表者の氏名、主たる業務の内容及び主たる事務", 20, 244, nFsize, 0, 0
            .TextOut "　　所の所在地を記載のこと。ただし、その法人が市町村、農業協同組合及び農地保有合理化法人にあ", 20, 249, nFsize, 0, 0
            .TextOut "　　っては、主たる業務の内容は記載しなくてもよい。", 20, 254, nFsize, 0, 0
            .TextOut "　３　記２については、土地登記簿上の所有名義人と現在の所有者が異なるときは備考欄に土地登記簿", 20, 259, nFsize, 0, 0
            .TextOut "　　上の所有者を記入する。", 20, 264, nFsize, 0, 0
            .TextOut "　４　記４については、権利を移転し、又は設定しようとする時期、対価、賃借料等の給付の種類及び", 20, 269, nFsize, 0, 0
            .TextOut "　　額、契約期間などを明示すること。", 20, 274, nFsize, 0, 0

            .LineBoxDX 20, 112, 7, 2, 10, Ar
            .DLine 68, 119, 80, 129
            .DLine 80, 119, 100, 129
            .DBox 20, 112, 183, 139, , 4
            .LineBoxDX 20, 174, 0, 1, 17, Ar2
            .DLine 64, 164, 88, 164
            .DLine 143, 164, 173, 164
            .DLine 64, 157, 64, 174
            .DLine 76, 164, 76, 174
            .DLine 88, 157, 88, 174
            .DLine 101, 157, 101, 174
            .DLine 116, 157, 116, 174
            .DLine 127, 157, 127, 174
            .DLine 143, 157, 143, 174
            .DLine 160, 164, 160, 174
            .DLine 173, 157, 173, 174
            .DBox 20, 157, 183, 191, , 4
       End With

    End Sub

    Private Sub CPrintCls_TargetChange(sKey As String): End Sub

End Class










Class CPrintSubあっせん申出
    Option Explicit
    Implements CPrintSub
    Private mvarKey As String
    Private mvarData As String
    Private mvarPData As CPrintDatas
    Private mvarNowPage As Long
    Private HMax As Long                '基本データMAX
    Private StartX As Single            ' データ始点(X)
    Private StartY As Single            ' データ始点(Y)
    Private FontSize As Integer         ' フォントサイズ
    Private RowHeight As Long           '１行の高さ
    Private ColWidth As Variant         ' 表枠の幅
    Private s支所 As String
    Private s都道府県名 As String
    Private s郡部 As String
    Private p支所番号 As New CDataDictionary
    Private LX As Long
    Private mvarStartPage As Integer
    
    Private Property Let CPrintSub_StartPage(RHS As Long): mvarStartPage = RHS: End Property
    Private Property Get CPrintSub_StartPage() As Long: CPrintSub_StartPage = mvarStartPage: End Property
    Private Property Let CPrintSub_Data(ByVal RHS As String): Dim Cm As Variant: mvarData = RHS: Cm = Split(mvarData, ";"): mvarStartPage = Val(Cm(2)) - (Val(Cm(2)) = 2) * (Val(Cm(3)) - 2): End Property
    Private Property Get CPrintSub_Data() As String: CPrintSub_Data = mvarData: End Property

    Private Property Let CPrintSub_Key(ByVal RHS As String): mvarKey = RHS: End Property
    Private Property Get CPrintSub_Key() As String: CPrintSub_Key = mvarKey: End Property

    Private Property Get CPrintSub_MaxPage() As Long
        CPrintSub_MaxPage = mvarPData.Count \ 8 + IIf((mvarPData.Count Mod 8) > 0, 1, 0)
    End Property
    
    Private Property Get CPrintSub_NowPage() As Long: CPrintSub_NowPage = mvarNowPage: End Property

    Private Sub CPrintSub_PrintSub(ByVal sKey As String, ByVal nPage As Long, mvarParent As ADBasicLIB2.CPrintFormSK)
        Select Case sKey
            Case "n400": Print出手 nPage, mvarParent
            Case "n401": Print受手 nPage, mvarParent
        End Select
    End Sub
    
    Private Sub Print受手(ByVal nPage As Long, mvarParent As ADBasicLIB2.CPrintFormSK)
        Dim Ar As Variant, Cm As Variant
        Dim n As Long, i As Long
        Dim dX(20) As Single, hX(20) As Single, Xcnt As Single
        Dim nStart As Long, nEnd As Long
        Dim dY As Long
        Dim nRows As Long
        Dim St As String
        
        If mvarPData.Count = 0 Then
            mvarParent.ClearScreen
            Exit Sub
        End If
        mvarNowPage = nPage
        
        With mvarParent
            .ClearScreen
            
            Ar = Split(mvarData, vbCrLf)
            Cm = Split(Ar(0), ";")
            
            ColWidth = GetArray(12, 58, 20, 22, 18, 76, 50)
            dX(0) = StartX: hX(0) = dX(0) + ColWidth(0) / 2
            n = dX(0)
            For i = 0 To UBound(ColWidth)
                dX(i + 1) = dX(i) + ColWidth(i)
                If i < UBound(ColWidth) Then hX(i + 1) = dX(i + 1) + ColWidth(i + 1) / 2
            Next
            Xcnt = UBound(ColWidth) + 1

            .Offset 0, 0
            .TextOut "議案第" & StrConv(Cm(0), vbWide) & "号", dX(0) - 4, 13, 13, 0, 2
            .TextOut "あっせん申出（買受・借受　希望）", dX(0), 25, 14, 0, 0
            .TextOut "番号", hX(0), 43, FontSize, 2, 2
            .DrawText "氏　　　　名\n住　　　　所", dX(1), 39, ColWidth(1), RowHeight, FontSize, 2, 0
            .TextOut "希望地目", hX(2), 43, FontSize, 2, 2
            .TextOut "希望面積", hX(3), 43, FontSize, 2, 2
            .TextOut "内 容", hX(4), 43, FontSize, 2, 2
            .TextOut "条　　　　　件", hX(5), 43, FontSize, 2, 2
            .TextOut "備　　　考", hX(6), 43, FontSize, 2, 2
            .LineBoxDX dX(0), 35, 16, 8, 16, ColWidth
            
            nRows = 8
            If mvarPData.Count < 1 Then Exit Sub
            nStart = (nPage - 1) * nRows + 1
            nEnd = (nPage - 1) * nRows + nRows
            If nEnd > mvarPData.Count Then nEnd = mvarPData.Count
            dY = StartY
            For n = nStart To nEnd
                .DrawText mvarPData.Data(n, "受付番号"), dX(0), dY + 2, ColWidth(0), RowHeight, FontSize, 2, 0
                '.DrawText mvarPData.Data(n, "受付補助記号"), dX(0), dY + 10, ColWidth(0), RowHeight, FontSize, 2, 0
                St = Fnc.GetShortAddress(mvarPData.Data(n, "住所"), s都道府県名, s郡部, , , True)
                .DrawText mvarPData.Data(n, "氏名") & "\n" & St, dX(1) + 1, dY, ColWidth(1) - 1, RowHeight, FontSize, 0, 0
                .DrawText mvarPData.Data(n, "希望地目"), dX(2), dY + 6, ColWidth(2), RowHeight, FontSize, 2, 0
                .DrawText Format(mvarPData.Data(n, "希望面積"), "#,##0"), dX(3), dY + 6, ColWidth(3) - 1, RowHeight, FontSize, 1, 0
                .DrawText mvarPData.Data(n, "内容"), dX(4), dY + 6, ColWidth(4), RowHeight, FontSize, 2, 0
                .DrawText Left(mvarPData.Data(n, "条件"), 54), dX(5) + 1, dY, ColWidth(5) - 1, RowHeight, FontSize, 0, 0
                .DrawText Left(mvarPData.Data(n, "備考"), 36), dX(6) + 1, dY, ColWidth(6) - 1, RowHeight, FontSize, 0, 0
                dY = dY + 16
            Next
            If mvarStartPage > 0 Then .TextOut "- " & mvarStartPage - 1 + nPage & " - ", .PaperWidth / 2, .PaperHeight - 4
        End With
                    
    End Sub

    Private Sub Print出手(ByVal nPage As Long, mvarParent As ADBasicLIB2.CPrintFormSK)
        Dim Ar As Variant, Cm As Variant
        Dim n As Long, i As Long
        Dim dX(20) As Single, hX(20) As Single, Xcnt As Single
        Dim nStart As Long, nEnd As Long
        Dim dY As Long
        Dim nRows As Long
        Dim St As String

        If mvarPData.Count = 0 Then
            mvarParent.ClearScreen
            Exit Sub
        End If
        mvarNowPage = nPage

        With mvarParent
            .ClearScreen

            Ar = Split(mvarData, vbCrLf)
            Cm = Split(Ar(0), ";")
            ColWidth = GetArray(12, 60, 12, 17, 15, 20, 52, 72)

            dX(0) = StartX: hX(0) = dX(0) + ColWidth(0) / 2
            n = dX(0)
            For i = 0 To UBound(ColWidth)
                dX(i + 1) = dX(i) + ColWidth(i)
                If i < UBound(ColWidth) Then hX(i + 1) = dX(i + 1) + ColWidth(i + 1) / 2
            Next
            Xcnt = UBound(ColWidth) + 1

            .Offset 0, 0
            .TextOut "議案第" & StrConv(Cm(0), vbWide) & "号", dX(0) - 4, 20, 13, 0, 2
            .TextOut "あっせん申出（売渡・貸付　希望）", dX(0), 25, 14, 0, 0
            .DrawText "番号", dX(0), 35, ColWidth(0), RowHeight, FontSize, 2, 2, 18
            .TextOut "希望する農用地", (dX(1) + dX(6)) / 2, 38.5, FontSize, 2, 2
            .TextOut "土　地　の　所　在", hX(1), 46.5, FontSize, 2, 2
            .TextOut "地 目", hX(2), 46.5, FontSize, 2, 2
            .TextOut "面 積", hX(3), 46.5, FontSize, 2, 2
            .TextOut "期 間", hX(4), 46.5, FontSize, 2, 2
            .TextOut "内　容", hX(5), 46.5, FontSize, 2, 2
            .TextOut "申　請　人", (dX(6) + dX(8)) / 2, 38.5, FontSize, 2, 2
            .DrawText "氏　　　　名\n住　　　　所", dX(6), 43, ColWidth(6), 4, FontSize, 2, 0
            .TextOut "条　　　　件", hX(7), 46.5, FontSize, 2, 2
            .DLine dX(0), 35, dX(Xcnt), 35
            .DLine dX(1), 42, dX(Xcnt), 42
            For i = 0 To Xcnt
                Select Case i
                    Case 0, 1, 6, Xcnt: .DLine dX(i), 35, dX(i), 51
                    Case Else: .DLine dX(i), 42, dX(i), 51
                End Select
            Next
            .LineBoxDX dX(0), 51, 0, 8, 16, ColWidth

            nRows = 8
            If mvarPData.Count < 1 Then Exit Sub
            nStart = (nPage - 1) * nRows + 1
            nEnd = (nPage - 1) * nRows + nRows
            If nEnd > mvarPData.Count Then nEnd = mvarPData.Count
            dY = StartY
            For n = nStart To nEnd
                .DrawText mvarPData.Data(n, "受付番号"), dX(0), dY + 2, ColWidth(0), RowHeight, FontSize, 2, 0
                '.DrawText mvarPData.Data(n, "受付補助記号"), dX(0), dY + 10, ColWidth(0), RowHeight, FontSize, 2, 0
                For i = 0 To 3
                    .DrawText mvarPData.Data(n & ":農地." & i, "土地所在"), dX(1) + 1, dY + 0.5 + 4 * i, ColWidth(1) - 1, RowHeight, FontSize - 1, 0, 0
                    .DrawText mvarPData.Data(n & ":農地." & i, "現況地目"), dX(2), dY + 0.5 + 4 * i, ColWidth(2), RowHeight, FontSize, 2
                    .DrawText Format(mvarPData.Data(n & ":農地." & i, "面積"), "#,##0"), dX(3), dY + 0.5 + 4 * i, ColWidth(3) - 1, RowHeight, FontSize, 1
                Next
                .DrawText mvarPData.Data(n, "期間"), dX(4), dY + 8, ColWidth(4), RowHeight, FontSize, 2, 0
'                .DrawText mvarPData.Data(n, "内容"), dX(5), dY + 8, ColWidth(5), RowHeight, FontSize, 2, 0
                .TextOut mvarPData.Data(n, "内容"), hX(5), dY + 8, FontSize, 2, 2
                St = Fnc.GetShortAddress(mvarPData.Data(n, "住所"), s都道府県名, s郡部, , , True)
                .DrawText mvarPData.Data(n, "氏名") & "\n" & St, dX(6) + 1, dY + 0.5, ColWidth(6) - 1, RowHeight, FontSize, 0, 0
                .DrawText mvarPData.Data(n, "条件"), dX(7) + 1, dY + 0.5, ColWidth(7) - 1, RowHeight, FontSize, 0, 0
                dY = dY + 16
            Next
            If mvarStartPage > 0 Then .TextOut "- " & mvarStartPage - 1 + nPage & " - ", .PaperWidth / 2, .PaperHeight - 4
        End With

    End Sub

    Private Sub CPrintSub_SetData(ByVal sKey As String, Optional ByVal sParam1 As String = "", Optional ByVal sParam2 As String = "")

    End Sub
    
    Private Sub Class_Initialize()
        Dim n As Long
        Dim Rs As ADBasicLIB2.RecordsetEx
        
        Set mvarPData = New CPrintDatas
        mvarPData.Headers = _
        "受付番号;受付補助記号;" & _
        "氏名;住所;希望地目;希望面積;条件;備考;期間;内容;" & _
        ">農地;土地所在;登記地目;現況地目;面積;"
        mvarNowPage = 1
        LX = 1
        HMax = 4
        StartX = 15
        StartY = 51
        FontSize = 11
        RowHeight = 5

        Set Rs = SystemDB.GetRecordsetEx("SELECT ID,名称 FROM [M_BASICALL] WHERE [Class]='支所番号'", 0, , Me)
        Do Until Rs.EOF
            p支所番号.Add Rs.Value("ID"), Rs.Value("名称")
            Rs.MoveNext
        Loop
        SystemDB.CloseRs Rs
    End Sub

    Private Sub CPrintSub_SetRsData(pRs As Object)
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim RsT As ADBasicLIB2.RecordsetEx
        Dim RsA As ADBasicLIB2.RecordsetEx
        Dim n As Long
        Dim i As Long
        Dim St As String
        Dim n面積 As Double
        Dim s受付 As String
        Dim b支所 As Boolean
        Dim b支所改頁 As Boolean
        Dim Ar As Variant, Cm As Variant
        Dim sSQL As String
        Dim n行 As Long
        Dim W As Long
        
        Ar = Split(mvarData, vbCrLf)
        Cm = Split(Ar(1), ";")
        s都道府県名 = Cm(0)
        s郡部 = Cm(1)
        If Cm(2) = "" Then b支所改頁 = False Else b支所改頁 = CBool(Cm(2))
        If Cm(3) = "" Then b支所 = False Else b支所 = CBool(Cm(3))
        
        With mvarPData
            Set Rs = pRs
            If b支所 Then
                If p支所番号.Exists(Rs.Value("支所番号")) Then
                    s受付 = p支所番号.Item(Rs.Value("支所番号"))
                Else
                    s受付 = ""
                End If
            Else
                s受付 = s受付 = Rs.NullCast("受付補助記号", "")
            End If
                                    
            If Rs.Value("法令") = stateあっせん受手 Then
                n = .NewLine
                .SetRsData n, "受付番号", Rs
                .Data(n, "受付補助記号") = s受付
                If (Not Rs.IsNull("氏名A")) And Rs.Value("氏名A") <> "" Then
                    .SetRsData n, "氏名", Rs, "氏名A"
                Else
                    .SetRsData n, "氏名", Rs, "参照A"
                End If
                .SetRsData n, "住所", Rs, "住所A"
                .SetRsData n, "希望地目", Rs, "用途"
                .SetRsData n, "希望面積", Rs, "数量"
                .SetRsData n, "条件", Rs, "条件A"
                .SetRsData n, "備考", Rs
                Select Case Rs.Value("区分")
                    Case 1: .Data(n, "内容") = "買受"
                    Case 2: .Data(n, "内容") = "借受"
                End Select
            Else
                If Rs.IsNull("農地リスト") Then
                ElseIf Len(Rs.Value("農地リスト")) > 3 Then
                    n = .NewLine
                    .Data(n, "受付番号") = LX: LX = LX + 1
                    .Data(n, "受付補助記号") = s受付
                    If (Not Rs.IsNull("氏名A")) And (Rs.Value("氏名A") <> "") Then
                        .SetRsData n, "氏名", Rs, "氏名A"
                    Else
                        .SetRsData n, "氏名", Rs, "参照A"
                    End If
                    .SetRsData n, "住所", Rs, "住所A"
                    .SetRsData n, "条件", Rs, "条件A"
                    .SetRsData n, "備考", Rs
                    .SetRsData n, "期間", Rs, "条件B"
                    Select Case Rs.Value("区分")
                        Case 1: .Data(n, "内容") = "売渡"
                        Case 2: .Data(n, "内容") = "貸付"
                    End Select
                    
                    St = Replace(Replace(Rs.Value("農地リスト"), "農地.", ""), ";", ",")
                    sSQL = sSQL & " ORDER BY [V_農地].[管理人ID],[V_農地].[土地所在];"
                    Set RsT = SystemDB.GetRecordsetEx("SELECT [V_農地].*,[V_農地].[現況地目] AS [現況地目ID],[V_地目].名称 AS 登記地目,[地目2].名称  AS [現況],[V_農委地目].名称 AS [農委地目] FROM (([V_農地] LEFT JOIN [V_地目] ON [V_農地].[登記簿地目]=[V_地目].ID) LEFT JOIN V_現況地目 AS 地目2 ON [V_農地].[現況地目]=[地目2].ID) LEFT JOIN [V_農委地目] ON [V_農地].[農委地目ID]=[V_農委地目].ID WHERE [V_農地].[ID] IN (" & St & ")" & sSQL, 1, , "議案書")
                    n行 = 0: i = 0
                    Do Until RsT.EOF
                        i = i + 1
                        n行 = n行 + 1
                        If n行 > 4 Then n = .NewLine: n行 = 1: i = 1
                        .SetRsData n & ":農地." & i, "土地所在", RsT
                        .SetRsData n & ":農地." & i, "登記地目", RsT
                        If (Not RsT.IsNull("農委地目ID")) And (RsT.Value("農委地目ID") <> 0) And (Not RsT.IsNull("農委地目認定日")) And (RsT.Value("農委地目認定日") <> "0:00:00") Then
                            .SetRsData n & ":農地." & i, "現況地目", RsT, "農委地目"
                        Else
                            .SetRsData n & ":農地." & i, "現況地目", RsT, "現況"
                        End If
                        
                        n面積 = 0
                        If Fnc.s市町村名 = "南種子町" Then
                            n面積 = Fnc.NullCast(RsT.Value("契約面積"), 0)
                        End If
                        If n面積 = 0 Then
                            Set RsA = SystemDB.GetRecordsetEx("SELECT * FROM [D_部分申請] WHERE [申請ID]=" & Rs.Value("ID") & " AND [農地ID]=" & RsT.Value("ID"), 0, , "議案書")
                            If Not RsA.EOF Then
                                n面積 = RsA.Value("部分面積")
                            Else
                                n面積 = Fnc.NullCast(RsT.Value("田面積"), 0) + Fnc.NullCast(RsT.Value("畑面積"), 0) + Fnc.NullCast(RsT.Value("樹園地"), 0) + Fnc.NullCast(RsT.Value("採草放牧面積"), 0)
                            End If
                            SystemDB.CloseRs RsA
                            If n面積 = 0 Then n面積 = RsT.Value("実面積")
                        End If
                        n面積 = Fix(n面積)
                        .Data(n & ":農地." & i, "面積") = n面積
                        RsT.MoveNext
                    Loop
                    SystemDB.CloseRs RsT
                    If n行 < 4 Then
                        For W = n行 To 4
                            i = i + 1
                            .Data(n & ":農地." & i, "土地所在") = ""
                        Next
                    End If
                End If
            End If
'            s支所 = Rs.value("受付補助記号")
            Set Rs = Nothing
        End With
    End Sub

End Class










Class CPrintSub事業計画変更
    Option Explicit
    Implements CPrintSub
    Private mvarKey As String
    Private mvarData As String
    Private mvarPData As CPrintDatas
    Private Const PGMAX As Long = 100   'ページ切替ＭＡＸ
    Private PgChgSt(PGMAX) As Long      'ページ切替開始番号
    Private PgChgEn(PGMAX) As Long      'ページ切替終了番号
    Private DataCnt As Long             'データカウント
    Private PageCnt As Long             'ページカウント
    Private HMax As Long                '基本データMAX
    Private LMax As Long                '１ページの行数
    Private PageMax As Long             'ページＭＡＸ
    Private PageNow As Long             '現在のページ
    Private StartX As Single            ' データ始点(X)
    Private StartY As Single            ' データ始点(Y)
    Private FontS As Integer         ' フォントサイズ
    Private RowH As Long           '１行の高さ
    Private ColW As Variant         ' 表枠の幅
    Private s都道府県名 As String
    Private s郡部 As String
    Private p支所番号 As New CDataDictionary
    Private mvarStartPage As Integer
    
    Private Property Let CPrintSub_StartPage(RHS As Long): mvarStartPage = RHS: End Property
    Private Property Get CPrintSub_StartPage() As Long: CPrintSub_StartPage = mvarStartPage: End Property
    Private Property Let CPrintSub_Data(ByVal RHS As String): Dim Cm As Variant: mvarData = RHS: Cm = Split(mvarData, ";"): mvarStartPage = Val(Cm(2)) - (Val(Cm(2)) = 2) * (Val(Cm(3)) - 2): End Property
    Private Property Get CPrintSub_Data() As String: CPrintSub_Data = mvarData: End Property

    Private Property Let CPrintSub_Key(ByVal RHS As String): mvarKey = RHS: End Property
    Private Property Get CPrintSub_Key() As String: CPrintSub_Key = mvarKey: End Property

    Private Property Get CPrintSub_MaxPage() As Long: CPrintSub_MaxPage = PageMax: End Property

    Private Property Get CPrintSub_NowPage() As Long: CPrintSub_NowPage = PageNow: End Property

    Private Sub CPrintSub_PrintSub(ByVal sKey As String, ByVal nPage As Long, mvarParent As ADBasicLIB2.CPrintFormSK)
        Dim Ar As Variant
        Dim Cm As Variant
        Dim n As Long
        Dim i As Long
        Dim dX(20) As Single, hX(20) As Single
        Dim Xcnt As Long
         
        If mvarPData.Count = 0 Then
            mvarParent.ClearScreen
            Exit Sub
        End If
        PageNow = nPage
       
        With mvarParent
            .ClearScreen
            .Offset 0, 0
            
            Ar = Split(mvarData, vbCrLf)
            Cm = Split(Ar(0), ";")
            
            dX(0) = StartX: hX(0) = dX(0) + ColW(0) / 2
            For i = 0 To UBound(ColW)
                dX(i + 1) = dX(i) + ColW(i)
                If i < UBound(ColW) Then hX(i + 1) = dX(i + 1) + ColW(i + 1) / 2
            Next
            Xcnt = UBound(ColW) + 1
            
            .Offset 0, 3
            .TextOut "議案第" & StrConv(Cm(0), vbWide) & "号", dX(0) - 4, 15, 13, 0, 2
            .TextOut "農地転用事業計画変更申請明細", dX(0), 22, 14, 0, 2
            .DrawText "番号", dX(0), 35, ColW(0), RowH, FontS, 2, 0
            .DrawText "区\n分", dX(1), 33, ColW(1), RowH, FontS, 2, 0
            .DrawText "申　　請　　人", dX(2), 35, ColW(2), RowH, FontS, 2, 0
            .DrawText "土 地 の 所 在", dX(3), 35, ColW(3), RowH, FontS, 2, 0
            .DrawText "地　目", dX(4), 31.5, ColW(4) + ColW(5), RowH, FontS, 2, 0
            .DrawText "登記", dX(4), 38.5, ColW(4), RowH, FontS, 2, 0
            .DrawText "現況", dX(5), 38.5, ColW(5), RowH, FontS, 2, 0
            .DrawText "地　積\n(u)", dX(6), 33, ColW(6), 5, FontS, 2, 0
            .DrawText "転 用 目 的", dX(7), 35, ColW(7), RowH, FontS, 2, 0
            .DrawText "理　　　由", dX(8), 35, ColW(8), RowH, FontS, 2, 0
            .DrawText "承認\n区分", dX(9), 33, ColW(9), RowH, FontS, 2, 0

            .DLine dX(0), 30, dX(Xcnt), 30
            .DLine dX(4), 37, dX(6), 37
            .DLine dX(0), 44, dX(Xcnt), 44
            For i = 0 To Xcnt
                If i = 5 Then .DLine dX(i), 37, dX(i), 44 Else .DLine dX(i), 30, dX(i), 44
            Next
            PrintSubMain mvarParent, dX(), hX()
            If mvarStartPage > 0 Then .TextOut "- " & mvarStartPage - 1 + nPage & " - ", .PaperWidth / 2, .PaperHeight - 4
        End With
    End Sub
        
    Private Sub PrintSubMain(ByRef mvarParent As ADBasicLIB2.CPrintFormSK, ByRef dX() As Single, ByRef hX() As Single)
        Dim hY As Single
        Dim dY As Single
        Dim Rcnt As Long
        Dim nMainStart As Long
        Dim nMainEnd As Long
        Dim nSubStart As Long
        Dim nSubEnd As Long
        Dim n As Long
        Dim i As Long
        Dim nWork As Single
        Dim nPage As Long
        Dim Xcnt As Long
        
        nPage = PageNow

        Xcnt = UBound(ColW) + 1

        With mvarParent
            nMainStart = PgChgSt(nPage) \ 1000
            nMainEnd = PgChgEn(nPage) \ 1000
       
            dY = StartY + 1
            hY = StartY + 1

            For n = nMainStart To nMainEnd
                ' 土地データ開始番号設定
                If n = nMainStart Then
                    nSubStart = PgChgSt(nPage) - nMainStart * 1000
                Else
                    nSubStart = 0
                End If
                
                '土地データ終了番号設定
                If n = nMainEnd Then
                    nSubEnd = PgChgEn(nPage) - nMainEnd * 1000
                Else
                    nSubEnd = mvarPData.SubCount(n & ":農地")
                End If
                
                ' 罫線
                Rcnt = nSubEnd - nSubStart + 1
                If Rcnt < HMax Then
                    nWork = hY + HMax * RowH
                Else
                    nWork = dY + Rcnt * RowH
                End If
                For i = 0 To Xcnt
                    .DLine dX(i), dY - 1, dX(i), nWork, vbBlack
                Next
                
                ' データ出力
                For i = nSubStart To nSubEnd
                    PrintSubData mvarParent, n, i, dX, hX, dY, nSubStart, nSubEnd
                    dY = dY + RowH
                Next
                
                Rcnt = nSubEnd - nSubStart + 1
                If Rcnt < HMax Then   ' 土地データ行数が基本データ行数より少ないとき
                    dY = hY + HMax * RowH
                End If
                .DLine dX(0), dY, dX(Xcnt), dY, vbBlack
                dY = dY + 1
                hY = dY
            Next
        End With
    End Sub
    
    Private Sub PrintSubData(ByRef mvarParent As ADBasicLIB2.CPrintFormSK, pNo As Long, pSubNo As Long, ByRef dX() As Single, ByRef hX() As Single, dY As Single, pSubStart As Long, pSubEnd As Long)
        Dim n As Long
        Dim i As Long
        Dim W As Single
        
        With mvarParent
            If pSubNo = pSubStart Then
                .TextOut pNo, (dX(0) + dX(1)) / 2, dY + RowH, FontS, 2
                .TextOut mvarPData.Data(pNo, "受付補助記号"), (dX(0) + dX(1)) / 2, dY + RowH * 3, FontS, 2
                .DrawText "変\n更\n前", dX(1), dY, ColW(1), RowH, FontS, 2, 2, 18
                .DrawText Left(mvarPData.Data(pNo, "変更前氏名"), 26), dX(2) + 1, dY, ColW(2) - 1, RowH, FontS, 0, 0
                .DrawText Left(Fnc.GetShortAddress(mvarPData.Data(pNo, "変更前住所"), s都道府県名, s郡部, , , True), 39), dX(2) + 1, dY + RowH * 2, ColW(2) - 1, RowH, FontS, 0, 0
                .DrawText mvarPData.Data(pNo, "変更前目的") & " \n" & mvarPData.Data(pNo, "当初許可日"), dX(7) + 1, dY, ColW(7) - 1, RowH, FontS, 0, 0
                .DrawText mvarPData.Data(pNo, "理由"), dX(8) + 1, dY, ColW(8) - 1, RowH, FontS, 0, 0
            End If
            If mvarPData.Data(pNo & ":農地." & pSubNo, "変更前終了") = "1" Then
                W = dY + RowH
                .DLine dX(1), W - 0.5, dX(8), dY + RowH - 0.5
                .DrawText "変\n更\n後", dX(1), W, ColW(1), RowH, FontS, 2, 2, 18
                .DrawText Left(mvarPData.Data(pNo, "氏名"), 26), dX(2) + 1, W, ColW(2) - 1, RowH, FontS
                .DrawText Left(Fnc.GetShortAddress(mvarPData.Data(pNo, "住所"), s都道府県名, s郡部, , , True), 39), dX(2) + 1, W + RowH * 2, ColW(2) - 1, RowH, FontS
                .DrawText mvarPData.Data(pNo, "変更後目的"), dX(7) + 1, W, ColW(7) - 1, RowH, FontS

            End If
            If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then  '合計行
                .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(3) + 3, dY, ColW(3), RowH, FontS
                .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(3), dY, ColW(3) - 2, RowH, FontS, 1
                If Val(mvarPData.Data(pNo, "小数点")) = 0 Then
                    .DrawText Format(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), "#,##0"), dX(6), dY, ColW(6) - 1, RowH, FontS, 1
                Else
                    .DrawText Format(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), "#,##0.00"), dX(6), dY, ColW(6) - 1, RowH, FontS, 1
                End If
            Else
                .DrawText StrConv(mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), vbNarrow), dX(3) + 1, dY, ColW(3) - 2, RowH, FontS
                .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 2), dX(4), dY, ColW(4), RowH, FontS, 2
                .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 2), dX(5), dY, ColW(5), RowH, FontS, 2
                If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                    If Val(mvarPData.Data(pNo, "小数点")) = 0 Then
                        .DrawText Format(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), "#,##0"), dX(6), dY, ColW(6) - 1, RowH, FontS, 1
                    Else
                        .DrawText Format(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), "#,##0.00"), dX(6), dY, ColW(6) - 1, RowH, FontS, 1
                    End If
                End If
            End If
        End With
    End Sub

    Private Sub CPrintSub_SetData(ByVal sKey As String, Optional ByVal sParam1 As String = "", Optional ByVal sParam2 As String = ""): End Sub

    Private Sub Class_Initialize()
        Dim n As Long
        Dim Rs As ADBasicLIB2.RecordsetEx
        
        Set mvarPData = New CPrintDatas
        mvarPData.Headers = _
        "受付番号;受付補助記号;" & _
        "変更前氏名;変更前住所;変更前目的;当初許可日;" & _
        "氏名;住所;集落;職業;年齢;変更前目的;当初許可日;変更後目的;理由;共有持分;小数点;" & _
        ">農地;土地所在;登記地目;現況地目;面積;持分;所有者名;所有者住所;変更前終了;"
    
        For n = 0 To PGMAX
            PgChgSt(n) = 0
            PgChgEn(n) = 0
        Next
        DataCnt = 0
        PageCnt = 0
        PageMax = 0
        PageNow = 1
        
        Set Rs = SystemDB.GetRecordsetEx("SELECT ID,名称 FROM [M_BASICALL] WHERE [Class]='支所番号'", 0, , Me)
        Do Until Rs.EOF
            p支所番号.Add Rs.Value("ID"), Rs.Value("名称")
            Rs.MoveNext
        Loop
        SystemDB.CloseRs Rs
    End Sub

    Private Sub CPrintSub_SetRsData(pRs As Object)
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim n As Long
        Dim i As Long
        Dim St As String, St1 As String
        Dim W As Long
        Dim nSubCount As Long
        Dim n面積計 As Double
        Dim n筆数計 As Long
        Dim n行数 As Long
        Dim n最大行数 As Long
        Dim n理由文字数 As Long
        Dim nWork As Long
        Dim b支所 As Boolean
        Dim b支所改頁 As Boolean
        Dim Ar As Variant, Cm As Variant
        Dim sSQL As String
        
        Ar = Split(mvarData, vbCrLf)
        Cm = Split(Ar(1), ";")
        s都道府県名 = Cm(0)
        s郡部 = Cm(1)
        If Cm(2) = "" Then b支所改頁 = False Else b支所改頁 = CBool(Cm(2))
        If Cm(3) = "" Then b支所 = False Else b支所 = CBool(Cm(3))

        n理由文字数 = 0
        
        HMax = 10
        LMax = 35
        ColW = GetArray(10, 8, 46, 58, 11, 10, 22, 32, 52, 10)
        StartX = 20
        StartY = 44
        FontS = 10
        RowH = 4
        n理由文字数 = 13

        ' データ作成
        With mvarPData
            Set Rs = pRs
            n = .NewLine
            .SetRsData n, "受付番号", Rs
            If b支所 Then
                If p支所番号.Exists(Rs.Value("支所番号")) Then
                    .Data(n, "受付補助記号") = p支所番号.Item(Rs.Value("支所番号"))
                Else
                    .Data(n, "受付補助記号") = ""
                End If
            Else
                .Data(n, "受付補助記号") = Rs.NullCast("受付補助記号", "")
            End If
            
            .SetRsData n, "氏名", Rs, "代理人名"
            If (Not Rs.IsNull("代理人名")) And (Rs.Value("代理人名") <> "") Then
                .SetRsData n, "氏名", Rs, "代理人名"
            ElseIf (Not Rs.IsNull("氏名A")) And (Rs.Value("氏名A") <> "") Then
                .SetRsData n, "氏名", Rs, "氏名A"
            ElseIf (Not Rs.IsNull("参照A")) And (Rs.Value("参照A") <> "") Then
                .SetRsData n, "氏名", Rs, "参照A"
            End If
           
            .SetRsData n, "住所", Rs, "住所A"
            .SetRsData n, "集落", Rs, "集落A"
            .SetRsData n, "職業", Rs, "職業A"
            .SetRsData n, "年齢", Rs, "年齢A"
            .SetRsData n, "変更後目的", Rs, "申請理由A"
            .SetRsData n, "理由", Rs, "申請理由B"
            
            .SetRsData n, "変更前氏名", Rs, "氏名C"
            .SetRsData n, "変更前住所", Rs, "住所C"
            .SetRsData n, "変更前目的", Rs, "予備2"
            .SetRsData n, "当初許可日", Rs, "予備3"
            
            i = 0
            If (Not Rs.IsNull("予備1")) And (Rs.Value("予備1") <> "") Then
                Ar = Split(Rs.Value("予備1"), vbCrLf)
                For W = 0 To UBound(Ar)
                    i = i + 1
                    Cm = Split(Ar(W), ";")
                    .Data(n & ":農地." & i, "土地所在") = Cm(0)
                    .Data(n & ":農地." & i, "登記地目") = Cm(1)
                    .Data(n & ":農地." & i, "現況地目") = Cm(2)
                    .Data(n & ":農地." & i, "面積") = Cm(3)
                Next
            End If
            
            If i < HMax / 2 Then
                Do While i < HMax / 2
                    i = i + 1
                    .Data(n & ":農地." & i, "土地所在") = ""
                Loop
            Else
                HMax = i + HMax / 2
            End If
            .Data(n & ":農地." & i, "変更前終了") = "1"
            n面積計 = 0
            n筆数計 = 0

            If Rs.IsNull("農地リスト") Then
            ElseIf Len(Rs.Value("農地リスト")) > 0 Then
                Ar = Split(Rs.Value("農地リスト"), vbCrLf)
                For W = 0 To UBound(Ar)
                    i = i + 1
                    Cm = Split(Ar(W), ";")
                    .Data(n & ":農地." & i, "土地所在") = Cm(0)
                    .Data(n & ":農地." & i, "登記地目") = Cm(1)
                    .Data(n & ":農地." & i, "現況地目") = Cm(2)
                    .Data(n & ":農地." & i, "面積") = Cm(3)
                    n筆数計 = n筆数計 + 1
                    n面積計 = n面積計 + Val(Cm(3))
                Next
            End If
            Set Rs = Nothing
    
            nSubCount = .SubCount(n & ":農地")
            
            ' 文字数チェックチェック
            If HMax > nSubCount + 1 Then
                n行数 = HMax
            Else
                n行数 = nSubCount + 1
            End If
            n最大行数 = LenCheck(.Data(n, "理由"), n理由文字数, n行数)
            If n最大行数 > LMax Then
                n最大行数 = LMax
                St = Left(.Data(n, "理由"), n理由文字数 * LMax)
                .Data(n, "理由") = St
            End If
                                    
            ' 合計行作成
            If n筆数計 > 1 Then
                If nSubCount + 2 < n最大行数 Then
                    i = n最大行数
                Else
                    i = nSubCount + 2
                End If
                .Data(n & ":農地." & i, "土地所在") = "( 計 )"
                .Data(n & ":農地." & i, "登記地目") = n筆数計
                .Data(n & ":農地." & i, "現況地目") = "99999"      'データ行との区分：合計行に"99999"セット
                .Data(n & ":農地." & i, "面積") = n面積計
            Else
                i = nSubCount + 1
                Do While i < HMax
                    i = i + 1
                    .Data(n & ":農地." & i, "土地所在") = ""
                Loop
            End If
            
            ' ページ切替番号設定
            SetPageNo n, n最大行数
        End With
    End Sub

    Private Sub SetPageNo(nDataNo As Long, pHMax)
        Dim n As Long
        Dim i As Long
        Dim nSubCount As Long
        Dim nCount As Long
        Dim wCount As Long
        
        n = nDataNo
        nSubCount = mvarPData.SubCount(n & ":農地")

        nCount = DataCnt + nSubCount + 1      ' .SubCountは 0からみているため
        wCount = nSubCount + 1                '             件数として扱うときは１プラス

        If nCount > LMax Then
            nCount = nSubCount + 1
            i = 0
            Do While nCount > 0
                i = i + 1
                PageCnt = PageCnt + 1
                PgChgSt(PageCnt) = n * 1000 + (i - 1) * LMax
                PgChgEn(PageCnt) = n * 1000 + i * LMax - 1
                nCount = nCount - LMax
            Loop
            DataCnt = 0
            wCount = nCount + LMax
            If wCount < pHMax Then
                wCount = pHMax
            End If
        ElseIf n = 1 Then
            PageCnt = PageCnt + 1
            PgChgSt(PageCnt) = n * 1000
        End If

        PgChgEn(PageCnt) = n * 1000 + nSubCount
        DataCnt = DataCnt + wCount
        PageMax = PageCnt
    End Sub

    Private Function LenCheck(pStr As String, pWLen As Long, pLenMax As Long) As Long
        Dim n As Long
        Dim nAscCode As Integer
        Dim nCount As Long
        Dim nLen As Long
        Dim nLen2 As Long
       
        LenCheck = pLenMax
        If pWLen = 0 Then Exit Function
        If Len(pStr) = 0 Then Exit Function
                   
        nCount = 0
         
        For n = 1 To Len(pStr)
            nCount = nCount + 1
            nAscCode = Asc(MID(pStr, n, 1))
            If Len(Hex(nAscCode)) > 2 Then
                nCount = nCount + 1
            End If
        Next
        nLen = (nCount \ pWLen) + IIf((nCount Mod pWLen) = 0, 0, 1)
        nLen2 = (nLen \ 2) + IIf((nLen Mod 2) = 0, 0, 1)
        If nLen2 > pLenMax Then LenCheck = nLen2
    End Function

End Class










Class CPrintSub所有権移転
    Option Explicit
    Implements CPrintSub
    Private mvarKey As String
    Private mvarData As String
    Private mvarPData As CPrintDatas
    Private mvarNowPage As Long
    Private mvarMaxPage As Long
    Private Const PGMAX As Long = 100   'ページ切替データＭＡＸ
    Private PgChgSt(PGMAX) As Long      'ページ切替開始番号
    Private PgChgEn(PGMAX) As Long      'ページ切替終了番号
    Private DataCnt As Long             'データカウント
    Private PageCnt As Long             'ページカウント
    Private HMax As Long                '基本データMAX
    Private LMax As Long                '１ページの行数
    Private mvarRows As Long
    Private StartX As Single            'データ始点(X)
    Private StartY As Single            'データ始点(Y)
    Private nFsize As Integer
    Private RowH As Long
    Private ColW As Variant             '表枠の幅
    Private b総括表出力 As Boolean
    Private s支所 As String
    Private s都道府県名 As String
    Private s郡部 As String
    Private p支所番号 As New CDataDictionary
    Private mvarStartPage As Integer
    
    Private Type dt総括表
        s公告日 As String
        s対価支払日 As String
        s引渡時期 As String
        n期間 As Long
        n面積(5) As Double
        n人数(2) As Long
    End Type
    
    Private Type dt合計
        s地目(4) As String
        n筆数(4) As Long
        n面積(4) As Double
    End Type
    Private T総合計 As dt合計

    Private Property Let CPrintSub_StartPage(RHS As Long): mvarStartPage = RHS: End Property
    Private Property Get CPrintSub_StartPage() As Long: CPrintSub_StartPage = mvarStartPage: End Property
    Private Property Let CPrintSub_Data(ByVal RHS As String): Dim Cm As Variant: mvarData = RHS: Cm = Split(mvarData, ";"): mvarStartPage = Val(Cm(2)) - (Val(Cm(2)) = 2) * (Val(Cm(3)) - 2): End Property
    Private Property Get CPrintSub_Data() As String: CPrintSub_Data = mvarData: End Property

    Private Property Let CPrintSub_Key(ByVal RHS As String): mvarKey = RHS: End Property
    Private Property Get CPrintSub_Key() As String: CPrintSub_Key = mvarKey: End Property

    Private Property Get CPrintSub_MaxPage() As Long
        If mvarPData.Count > 0 Then
            If b総括表出力 = True Then
                CPrintSub_MaxPage = mvarMaxPage + 1
            Else
                CPrintSub_MaxPage = mvarMaxPage
            End If
        Else
            CPrintSub_MaxPage = 0
        End If
    End Property

    Private Property Get CPrintSub_NowPage() As Long
        CPrintSub_NowPage = mvarNowPage
    End Property

    Private Sub CPrintSub_PrintSub(ByVal sKey As String, ByVal nPage As Long, mvarParent As ADBasicLIB2.CPrintFormSK)
        Dim Ar As Variant
        Dim Cm As Variant
        Dim dX(20) As Single, hX(20) As Single
        Dim n As Long, i As Long
        Dim St As String
        Dim Xcnt As Long

        mvarNowPage = nPage
        If mvarPData.Count = 0 Then
            mvarParent.ClearScreen
            Exit Sub
        End If
       
        If b総括表出力 = True And nPage = 1 Then
            Print総括表 mvarParent
        Else
            With mvarParent
                .ClearScreen
                .Offset 0, 0
                Ar = Split(mvarData, vbCrLf)
                Cm = Split(Ar(0), ";")
                
                If IsEmpty(ColW) Then Exit Sub
                dX(0) = StartX: hX(0) = dX(0) + ColW(0) / 2
                For i = 0 To UBound(ColW)
                    dX(i + 1) = dX(i) + ColW(i)
                    If i < UBound(ColW) Then hX(i + 1) = dX(i + 1) + ColW(i + 1) / 2
                Next
                Xcnt = UBound(ColW) + 1
                
                Select Case Fnc.s市町村名
                Case "南種子町"
                    .Offset 0, 0
                    .TextOut "計画内訳書（経営面積等）", dX(0) + 5, 25, nFsize, 0, 0
                    .TextOut "整理", hX(0), 35, nFsize, 2, 2
                    .TextOut "番号", hX(0), 41, nFsize, 2, 2
                    .TextOut "所有権移転等をする者", (dX(1) + dX(4)) / 2, 34.5, nFsize, 2, 2
                    .TextOut "氏　　名", hX(1), 41.5, nFsize, 2, 2
                    .TextOut "年齢", hX(2), 41.5, nFsize, 2, 2
                    .TextOut "経営面積", hX(3), 41.5, nFsize, 2, 2
                    .TextOut "所有権移転等を受ける者", (dX(4) + dX(7)) / 2, 34.5, nFsize, 2, 2
                    .TextOut "氏　　名", hX(4), 41.5, nFsize, 2, 2
                    .TextOut "年齢", hX(5), 41.5, nFsize, 2, 2
                    .TextOut "経営面積", hX(6), 41.5, nFsize, 2, 2
                    .TextOut "土地の所在", hX(7), 38, nFsize, 2, 2
                    .TextOut "登記", hX(8), 35, nFsize, 2, 2
                    .TextOut "地目", hX(8), 41, nFsize, 2, 2
                    .TextOut "現況", hX(9), 35, nFsize, 2, 2
                    .TextOut "地目", hX(9), 41, nFsize, 2, 2
                    .TextOut "面 積", hX(10), 35, nFsize, 2, 2
                    .TextOut "(u)", hX(10), 41, nFsize, 2, 2
                    .TextOut "権利内容", hX(11), 35, nFsize, 2, 2
                    .TextOut "(作物名)", hX(11), 41, nFsize, 2, 2
                    .TextOut "権利の", hX(12), 35, nFsize, 2, 2
                    .TextOut "種　類", hX(12), 41, nFsize, 2, 2
                    .TextOut "対　価", hX(13), 35, nFsize, 2, 2
                    .TextOut "（円）", hX(13), 41, nFsize, 2, 2
                    .TextOut "対価支払い", hX(14), 35, nFsize, 2, 2
                    .TextOut "年　月　日", hX(14), 41, nFsize, 2, 2
                    .TextOut "備　　考", hX(15), 38, nFsize, 2, 2

                    .DLine dX(0), 31, dX(Xcnt), 31
                    .DLine dX(1), 38, dX(7), 38
                    .DLine dX(0), 45, dX(Xcnt), 45
                    For i = 0 To Xcnt
                        Select Case i
                            Case 2, 3, 5, 6: .DLine dX(i), 38, dX(i), 45
                            Case Else:       .DLine dX(i), 31, dX(i), 45
                        End Select
                    Next
                    
                Case "三股町"
                    .Offset 0, 0
                    .TextOut "所有権移転各筆明細", dX(1), 16, 14
                    .TextOut "公告年月日", 180, 18, nFsize
                    .TextOut IIf(IsDate(mvarPData.Data(1, "公告日")), Format(mvarPData.Data(1, "公告日"), "GGG EE年 M月 D日"), ""), 200, 18, nFsize
                    .TextOut "三股町", dX(Xcnt) - 5, 18, nFsize, 1
                    .DrawText "番\n\n号", dX(0), 28, ColW(0), RowH, nFsize, 2, 2
                    .DrawText "受付\n年\n月日", dX(1), 28, ColW(1), RowH, nFsize, 2, 2
                    .DrawText "所 有 権 の 移 転 を\nを 受 け る 者\n（住 所・氏 名）", dX(2), 28, ColW(2), RowH, nFsize, 2, 2
                    .DrawText "所 有 権 の 移 転 を\nす る 者\n（住 所・氏 名）", dX(3), 28, ColW(3), RowH, nFsize, 2, 2
                    .TextOut "所有権を移転する土地", (dX(4) + dX(7)) / 2, 27.5, nFsize, 2, 2
                    .TextOut "所　　　　在", hX(4), 35, nFsize, 2, 2
                    .DrawText "現況\n地目", dX(5), 32, ColW(5), RowH, nFsize, 2, 2
                    .DrawText "面積\n(u)", dX(6), 32, ColW(6), RowH, nFsize, 2, 2
                    .TextOut "所有権移転の内容", (dX(7) + dX(10)) / 2, 27.5, nFsize, 2, 2
                    .TextOut "利 用 目 的", hX(7), 35, nFsize, 2, 2
                    .DrawText "所有権の\n移転時期", dX(8), 32, ColW(8), RowH, nFsize, 2, 2
                    .TextOut "引渡の時期", hX(9), 35, nFsize, 2, 2
                    .TextOut "備　考", hX(10), 32.5, nFsize, 2, 2
    
    
                    .DLine 180, 21.5, 230, 21.5
                    .DLine dX(0), 25, dX(Xcnt), 25
                    .DLine dX(4), 30, dX(10), 30
                    .DLine dX(0), 39, dX(Xcnt), 39
                    
                    For i = 0 To Xcnt
                        Select Case i
                            Case 5, 6, 8, 9: .DLine dX(i), 30, dX(i), 40
                            Case Else:       .DLine dX(i), 25, dX(i), 40
                        End Select
                    Next
                    
                Case "大崎町"
                    .Offset 0, 5
                    .TextOut "第" & StrConv(Cm(0), vbWide) & "号議案", dX(0) - 4, 13, 13, 0, 2
                    .TextOut "農用地利用集積計画", dX(0), 22, 14, 0, 2
    
                    .DrawText "番\n\n号", dX(0), 25, ColW(0), 4, nFsize, 2, 2, 24
                    .DrawText "譲　　受　　人", dX(1), 25, dX(4) - dX(1), 4, nFsize, 2, 2, 6
                    .DrawText "譲　　渡　　人", dX(4), 25, dX(7) - dX(4), 4, nFsize, 2, 2, 6
                    .DrawText "氏　　　名", dX(1), 33, ColW(1), 4, nFsize, 2
                    .DrawText "集　　　落", dX(1), 37.5, ColW(1), 4, nFsize, 2
                    .DrawText "職業・年齢", dX(1), 42, ColW(1), 4, nFsize, 2
                    .DrawText "経 営", dX(2), 33, ColW(2), 4, nFsize, 2
                    .DrawText "面 積", dX(2), 42, ColW(2), 4, nFsize, 2
                    .DrawText "労", dX(3), 33, ColW(3), 4, nFsize, 2
                    .DrawText "力", dX(3), 42, ColW(3), 4, nFsize, 2
                    .DrawText "氏　　　名", dX(4), 33, ColW(4), 4, nFsize, 2
                    .DrawText "集　　　落", dX(4), 37.5, ColW(4), 4, nFsize, 2
                    .DrawText "職業・年齢", dX(4), 42, ColW(4), 4, nFsize, 2
                    .DrawText "経 営", dX(5), 33, ColW(5), 4, nFsize, 2
                    .DrawText "面 積", dX(5), 42, ColW(5), 4, nFsize, 2
                    .DrawText "申請", dX(6), 33, ColW(6), 4, nFsize, 2
                    .DrawText "理由", dX(6), 42, ColW(6), 4, nFsize, 2
                    .DrawText "土 地 の 所 在", dX(7), 25, ColW(7), 4, nFsize, 2, 2, 24
                    .DrawText "地目", dX(8), 25, ColW(8) + ColW(9), 4, nFsize, 2, 2, 6
                    .DrawText "台\n\n帳", dX(8), 31, ColW(8), 4, nFsize, 2, 2, 18
                    .DrawText "現\n\n況", dX(9), 31, ColW(9), 4, nFsize, 2, 2, 18
                    .DrawText "面積\n\n(u)", dX(10), 25, ColW(10), RowH, nFsize, 2, 2, 24
                    .DrawText "農\n\n振", dX(11), 25, ColW(11), RowH, nFsize, 2, 2, 24
                    .DrawText "契約内容", dX(12), 25, ColW(12), RowH, nFsize, 2, 2, 24
                    .DrawText "結\n\n果", dX(13), 25, ColW(13), RowH, nFsize, 2, 2, 24
                    .DrawText "備  考", dX(14), 25, ColW(14), RowH, nFsize, 2, 2, 24
                        
                    .DLine dX(0), 25, dX(Xcnt), 25
                    .DLine dX(1), 30, dX(7), 30
                    .DLine dX(8), 30, dX(10), 30
                    .DLine dX(0), 49, dX(Xcnt), 49
                    
                    For i = 0 To Xcnt
                        Select Case i
                            Case 2, 3, 5, 6, 9: .DLine dX(i), 30, dX(i), 49
                            Case Else:       .DLine dX(i), 25, dX(i), 49
                        End Select
                    Next
                
                Case Else
                    .Offset 0, 0
                    .TextOut "第" & StrConv(Cm(0), vbWide) & "号議案", dX(0) - 5, 13, 13, 0, 2
                    .TextOut "農用地利用集積計画（所有権移転）", dX(0), 18, 14

                    If Fnc.s市町村名 = "日置市" Then
                        Select Case mvarPData.Data(PgChgSt(nPage) \ 1000, "受付補助記号")
                            Case "本": St = "伊集院地域"
                            Case "東": St = "東市来地域"
                            Case "日": St = "日吉地域"
                            Case "吹": St = "吹上地域"
                            Case Else: St = ""
                        End Select
                        .TextOut "[ " & St & " ]", dX(Xcnt), 24, 14, 1, 1
                    End If
    
                    .DrawText "番\n号", dX(0), 26, ColW(0), 4, nFsize, 2, 2, 14
                    .TextOut "譲　受　人", dX(1) + (dX(3) - dX(1)) / 2, 27.5, nFsize, 2, 2
                    .TextOut "住所・氏名・年齢", hX(1), 35, nFsize, 2, 2
                    .DrawText "経営面積\n(u)", dX(2), 31, ColW(2), RowH, nFsize, 2, 2, 10
                    .TextOut "譲　渡　人", (dX(3) + dX(5)) / 2, 27.5, nFsize, 2, 2
                    .TextOut "住所・氏名・年齢", hX(3), 35, nFsize, 2, 2
                    .DrawText "経営面積\n(u)", dX(4), 31, ColW(4), RowH, nFsize, 2, 2, 10
                    .TextOut "土　　　　　　地", (dX(5) + dX(8)) / 2, 27.5, nFsize, 2, 2
                    .TextOut "所　　　　在", hX(5), 35, nFsize, 2, 2
                    .TextOut "地 目", hX(6), 35, nFsize, 2, 2
                    .DrawText "面 積\n(u)", dX(7), 31, ColW(7), RowH, nFsize, 2, 2, 10
                    .TextOut "対　価", hX(8), 32.5, nFsize, 2, 2
                    .TextOut "備　考", hX(9), 32.5, nFsize, 2, 2

                    .DLine dX(0), 25, dX(Xcnt), 25
                    .DLine dX(1), 30, dX(8), 30
                    .DLine dX(0), 40, dX(Xcnt), 40
                    
                    For i = 0 To Xcnt
                        Select Case i
                            Case 2, 4, 6, 7: .DLine dX(i), 30, dX(i), 40
                            Case Else: .DLine dX(i), 25, dX(i), 40
                        End Select
                    Next

                End Select
                PrintSubMain mvarParent, dX(), hX()
            If mvarStartPage > 0 Then .TextOut "- " & mvarStartPage - 1 + nPage & " - ", .PaperWidth / 2, .PaperHeight - 4
            End With
        End If
    End Sub

    Private Sub CPrintSub_SetData(ByVal sKey As String, Optional ByVal sParam1 As String = "", Optional ByVal sParam2 As String = "")
    End Sub
    
    Private Sub PrintSubMain(ByRef mvarParent As ADBasicLIB2.CPrintFormSK, ByRef dX() As Single, ByRef hX() As Single)
        Dim hY As Single        ' 基本データY座標
        Dim dY As Single        ' 土地データY座標
        Dim Rcnt As Long        ' 行カウント
        Dim nMainStart As Long  ' データ開始番号
        Dim nMainEnd As Long    ' データ終了番号
        Dim nSubStart As Long   ' 土地データ開始番号
        Dim nSubEnd As Long     ' 土地データ終了番号
        Dim n As Long
        Dim i As Long
        Dim nWork As Single
        Dim nPage As Long
        Dim Xcnt As Long
        
        nPage = mvarNowPage
        If b総括表出力 = True Then nPage = nPage - 1

        Xcnt = UBound(ColW) + 1

        With mvarParent
            nMainStart = PgChgSt(nPage) \ 1000
            nMainEnd = PgChgEn(nPage) \ 1000
       
            dY = StartY + 1
            hY = StartY + 1

            For n = nMainStart To nMainEnd
                ' 土地データ開始番号設定
                If n = nMainStart Then
                    nSubStart = PgChgSt(nPage) - nMainStart * 1000
                Else
                    nSubStart = 0
                End If
                
                '土地データ終了番号設定
                If n = nMainEnd Then
                    nSubEnd = PgChgEn(nPage) - nMainEnd * 1000
                Else
                    nSubEnd = mvarPData.SubCount(n & ":農地")
                End If
                
                ' 罫線
                Rcnt = nSubEnd - nSubStart + 1
                If Rcnt < HMax Then
                    nWork = hY + HMax * RowH
                Else
                    nWork = dY + Rcnt * RowH
                End If
                For i = 0 To Xcnt
                    .DLine dX(i), dY - 1, dX(i), nWork, vbBlack
                Next
                
                ' データ出力
                For i = nSubStart To nSubEnd
                    PrintSubData mvarParent, n, i, dX, hX, dY, nSubStart, nSubEnd
                    dY = dY + RowH
                Next
                
                Rcnt = nSubEnd - nSubStart + 1
                If Rcnt < HMax Then   ' 土地データ行数が基本データ行数より少ないとき
                    dY = hY + HMax * RowH
                End If
                .DLine dX(0), dY, dX(Xcnt), dY
                dY = dY + 1
                hY = dY
            Next
            If nPage = mvarMaxPage Then PrintSubTotal mvarParent, dX, hX, dY
        End With
    End Sub
    
    Private Sub PrintSubData(ByRef mvarParent As ADBasicLIB2.CPrintFormSK, pNo As Long, pSubNo As Long, ByRef dX() As Single, ByRef hX() As Single, dY As Single, pSubStart As Long, pSubEnd As Long)
        Dim St As String
        Dim n As Long
        Dim nWork(2) As Long

        With mvarParent
            Select Case Fnc.s市町村名
            Case "三股町"
                If pSubNo = pSubStart Then
                    .TextOut mvarPData.Data(pNo, "通年受付番号"), (dX(0) + dX(1)) / 2, dY, nFsize, 2
                    St = Format(mvarPData.Data(pNo, "受付年月日"), "EEMMDD")
                    If Len(St) > 0 Then .DrawText Val(Left(St, 2)) & "\n" & Val(MID(St, 3, 2)) & "\n" & Val(MID(St, 5, 2)), dX(1), dY, ColW(1), 4, nFsize, 2
                    .DrawText Left(StrConv(mvarPData.Data(pNo, "住所B"), vbNarrow), 24), dX(2) + 1, dY, ColW(2) - 1, RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo, "氏名B"), 12), dX(2), dY + RowH * 2, ColW(2), RowH, nFsize, 2
                    .DrawText Left(StrConv(mvarPData.Data(pNo, "住所A"), vbNarrow), 24), dX(3) + 1, dY, ColW(3) - 1, RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo, "氏名A"), 12), dX(3), dY + RowH * 2, ColW(3), RowH, nFsize, 2
                    
                    .DrawText Left(mvarPData.Data(pNo, "利用権内容"), 21), dX(7) + 1, dY, ColW(7) - 1, RowH, nFsize, 2
                    
                    .DrawText IIf(IsDate(mvarPData.Data(pNo, "引渡時期")), Format(mvarPData.Data(pNo, "引渡時期"), "GEE.MM.DD"), ""), dX(9), dY, ColW(9), RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo, "対価")) > 0 Then
                        .DrawText "売買", dX(10), dY, ColW(10), RowH, nFsize, 2
                    End If
                End If

                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(4) + 2, dY, ColW(4), RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(4), dY, ColW(4) - 2, RowH, nFsize, 1
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(6), dY, ColW(6) - 1, RowH, nFsize, 1
                Else
                    .DrawText StrConv(mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), vbNarrow), dX(4) + 1, dY, ColW(4) - 1, RowH, nFsize, 0
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 3), dX(5), dY, ColW(5), RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(6), dY, ColW(6) - 1, RowH, nFsize, 1
                    End If
                End If

            Case "大崎町"
                If pSubNo = pSubStart Then
                    .TextOut pNo, (dX(0) + dX(1)) / 2, dY, nFsize, 2, 0
                    .DrawText Left(mvarPData.Data(pNo, "氏名B"), 16), dX(1) + 1, dY, ColW(1) - 1, RowH, nFsize, 0
                    If Len(mvarPData.Data(pNo, "集落B")) = 0 Or mvarPData.Data(pNo, "集落B") = "-" Then
                        .DrawText Left(Fnc.GetShortAddress(mvarPData.Data(pNo, "住所B"), s都道府県名, s郡部, , , True), 16), dX(1) + 1, dY + RowH * 2, ColW(1) - 1, RowH, nFsize, 0
                    Else
                        .DrawText Left(mvarPData.Data(pNo, "集落B"), 16), dX(1) + 1, dY + RowH * 2, ColW(1) - 1, RowH, nFsize, 0
                    End If
                    .DrawText Left(mvarPData.Data(pNo, "職業B"), 6), dX(1) + 1, dY + RowH * 4, ColW(1) - 1, RowH, nFsize, 0
                    .DrawText IIf(Val(mvarPData.Data(pNo, "年齢B")) = 0, "", mvarPData.Data(pNo, "年齢B") & "歳"), dX(1), dY + RowH * 4, ColW(1) - 1, RowH, nFsize, 1
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo, "経営面積B")), 0), dX(2), dY, ColW(2) - 1, RowH, nFsize, 1
                    .DrawText mvarPData.Data(pNo, "稼動人数"), dX(3), dY, ColW(3), RowH, nFsize, 2

                    .DrawText Left(mvarPData.Data(pNo, "氏名A"), 16), dX(4) + 1, dY, ColW(4) - 1, RowH, nFsize, 0
                    If Len(mvarPData.Data(pNo, "集落A")) = 0 Or mvarPData.Data(pNo, "集落A") = "-" Then
                        .DrawText Left(Fnc.GetShortAddress(mvarPData.Data(pNo, "住所A"), s都道府県名, s郡部, , , True), 16), dX(4) + 1, dY + RowH * 2, ColW(4) - 1, RowH, nFsize, 0
                    Else
                        .DrawText Left(mvarPData.Data(pNo, "集落A"), 16), dX(4) + 1, dY + RowH * 2, ColW(4) - 1, RowH, nFsize, 0
                    End If
                    .DrawText Left(mvarPData.Data(pNo, "職業A"), 6), dX(4) + 1, dY + RowH * 4, ColW(4) - 1, RowH, nFsize
                    .DrawText IIf(Val(mvarPData.Data(pNo, "年齢A")) = 0, "", mvarPData.Data(pNo, "年齢A") & "歳"), dX(4), dY + RowH * 4, ColW(4) - 1, RowH, nFsize, 1
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo, "経営面積A")), 0), dX(5), dY, ColW(5) - 1, RowH, nFsize, 1
                    .DrawText Left(mvarPData.Data(pNo, "申請理由A"), 12), dX(6), dY, ColW(6), RowH, nFsize, 2
                    .DrawText "所有権移転", dX(12), dY, ColW(12), RowH, nFsize, 2
                    If Len(mvarPData.Data(pNo, "対価")) > 0 Then .DrawText mvarPData.Data(pNo, "対価") & mvarPData.Data(pNo, "対価単位"), dX(12), dY + RowH * 2, ColW(12), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo, "備考"), 45), dX(14) + 1, dY, ColW(14) - 1, RowH, nFsize
                End If
                    
                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(7) + 2, dY, ColW(7), RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(7), dY, ColW(7) - 2, RowH, nFsize, 1
                    .TextOut FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(11) - 1, dY, nFsize, 1
                ElseIf Val(mvarPData.Data(pNo & ":農地." & pSubNo, "一部")) = 1 Then
                    .TextOut "(" & FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0) & "の内)", dX(11) - 1, dY, nFsize - 2, 1
                Else
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(7) + 1, dY, ColW(7) - 2, RowH, nFsize, 0
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 1), dX(8), dY, ColW(8), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 1), dX(9), dY, ColW(9), RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        .TextOut FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(11) - 1, dY, nFsize, 1, 0
                    End If
                    If Len(mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在")) > 0 Then
                        Select Case mvarPData.Data(pNo & ":農地." & pSubNo, "農振区分")
                            Case 1:    St = "地内"
                            Case 2:    St = "振外"
                            Case Else: St = "地外"
                        End Select
                        .DrawText St, dX(11), dY, ColW(11), RowH, nFsize, 2
                    End If
               End If

            Case "南種子町"
                If pSubNo = pSubStart Then
                    .TextOut pNo, (dX(0) + dX(1)) / 2, dY, nFsize, 2, 0
                    .DrawText Left(Fnc.GetShortAddress(mvarPData.Data(pNo, "住所A"), s都道府県名, s郡部, , , True), 14), dX(1) + 1, dY, ColW(1) - 1, RowH, nFsize
                    .DrawText Left(mvarPData.Data(pNo, "氏名A"), 14), dX(1) + 1, dY + RowH * 2, ColW(1) - 1, RowH, nFsize, 0
                    If Val(mvarPData.Data(pNo, "年齢A")) > 0 Then .DrawText mvarPData.Data(pNo, "年齢A"), dX(2), dY, ColW(2), RowH, nFsize, 2
                    .DrawText Format$(mvarPData.Data(pNo, "経営面積A"), "#,##0"), dX(3), dY, ColW(3) - 1, RowH, nFsize, 1
                    .DrawText Left(Fnc.GetShortAddress(mvarPData.Data(pNo, "住所B"), s都道府県名, s郡部, , , True), 14), dX(4) + 1, dY, ColW(4) - 1, RowH, nFsize
                    .DrawText Left(mvarPData.Data(pNo, "氏名B"), 14), dX(4) + 1, dY + RowH * 2, ColW(4) - 1, RowH, nFsize, 0
                    If Val(mvarPData.Data(pNo, "年齢B")) > 0 Then .DrawText mvarPData.Data(pNo, "年齢B"), dX(5), dY, ColW(5), RowH, nFsize, 2
                    .DrawText Format$(mvarPData.Data(pNo, "経営面積B"), "#,##0"), dX(6), dY, ColW(6) - 1, RowH, nFsize, 1
                    .DrawText Left(mvarPData.Data(pNo, "備考"), 20), dX(15) + 1, dY, ColW(15) - 1, RowH, nFsize, 0
                End If
                    
                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(7) + 2, dY, ColW(7), RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(7), dY, ColW(7) - 2, RowH, nFsize, 1
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(10), dY, ColW(10) - 1, RowH, nFsize, 1
                Else
                    .DrawText StrConv(mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), vbNarrow), dX(7) + 1, dY, ColW(7) - 1, RowH, nFsize - 1, 0
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 2), dX(8), dY, ColW(8), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 2), dX(9), dY, ColW(9), RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(10), dY, ColW(10) - 1, RowH, nFsize, 1
                    End If
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "利用状況"), 5), dX(11), dY, ColW(11), RowH, nFsize - 1, 2
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "権利種類"), 5), dX(12), dY, ColW(12), RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "対価")) > 0 Then .DrawText Format(mvarPData.Data(pNo & ":農地." & pSubNo, "対価"), "#,##0"), dX(13), dY, ColW(13) - 1, RowH, nFsize, 1
                    If mvarPData.Data(pNo & ":農地." & pSubNo, "対価支払日") <> "" Then .DrawText Format(mvarPData.Data(pNo, "対価支払日"), "GEE.M.D"), dX(14), dY, ColW(14), RowH, nFsize, 2
                End If

            Case Else
                If pSubNo = pSubStart Then
                    .TextOut mvarPData.Data(pNo, "受付番号"), (dX(0) + dX(1)) / 2, dY, nFsize, 2
                    .DrawText Left(StrConv(mvarPData.Data(pNo, "住所B"), vbNarrow), 22), dX(1) + 1, dY, ColW(1) - 1, RowH, nFsize
                    .DrawText Left(mvarPData.Data(pNo, "氏名B"), 20), dX(1) + 1, dY + RowH * 2, ColW(1) - 1, RowH, nFsize
                    .DrawText IIf(Val(mvarPData.Data(pNo, "年齢B")) <> 0, mvarPData.Data(pNo, "年齢B") & "歳", ""), dX(1) + 1, dY + RowH * 3, ColW(1) - 2, RowH, nFsize, 1
                    .DrawText Format(Val(mvarPData.Data(pNo, "経営面積B")), "#,##0"), dX(2), dY, ColW(2) - 1, RowH, nFsize, 1
                    .DrawText Left(StrConv(mvarPData.Data(pNo, "住所A"), vbNarrow), 22), dX(3) + 1, dY, ColW(3) - 1, RowH, nFsize
                    .DrawText Left(mvarPData.Data(pNo, "氏名A"), 20), dX(3) + 1, dY + RowH * 2, ColW(3) - 1, RowH, nFsize
                    .DrawText IIf(Val(mvarPData.Data(pNo, "年齢A")) <> 0, mvarPData.Data(pNo, "年齢A") & "歳", ""), dX(3) + 1, dY + RowH * 3, ColW(3) - 2, RowH, nFsize, 1
                    .DrawText Format(Val(mvarPData.Data(pNo, "経営面積A")), "#,##0"), dX(4), dY, ColW(4) - 1, RowH, nFsize, 1
                    
                    If Val(mvarPData.Data(pNo, "対価")) > 0 Then
                        .DrawText Format(Val(mvarPData.Data(pNo, "対価")), "#,##0") & mvarPData.Data(pNo, "対価単位"), dX(8), dY, ColW(8), RowH, nFsize, 2
                    End If
                    .DrawText mvarPData.Data(pNo, "備考"), dX(9) + 1, dY, ColW(9) - 1, RowH, nFsize
                End If

                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(5) + 2, dY, ColW(5), RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(5), dY, ColW(5) - 2, RowH, nFsize, 1
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(7), dY, ColW(7) - 1, RowH, nFsize, 1
                Else
                    .DrawText StrConv(mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), vbNarrow), dX(5) + 1, dY, ColW(5) - 1, RowH, nFsize, 0
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 3), dX(6), dY, ColW(6), RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(7), dY, ColW(7) - 1, RowH, nFsize, 1
                    End If
                End If

            End Select
        End With
    End Sub
    
    Private Sub PrintSubTotal(ByRef mvarParent As ADBasicLIB2.CPrintFormSK, ByRef dX() As Single, ByRef hX() As Single, dY As Single)
        Dim n As Long
        Dim i As Single
        Dim wdy As Single
        Dim Xcnt As Long
        Dim nArea(5) As Double
        Dim nWork(2) As Long
        Dim sWork(2) As String

        
        If T総合計.n筆数(4) = 0 Then Exit Sub
        wdy = dY
        Xcnt = UBound(ColW) + 1
                
        With mvarParent
            Select Case Fnc.s市町村名
             Case "三股町"
                For n = 0 To 4
                    If T総合計.n筆数(n) > 0 Then
                        .DrawText T総合計.s地目(n), dX(4) + 2, dY, ColW(4), RowH, nFsize
                        .DrawText T総合計.n筆数(n) & " 筆", dX(4), dY, ColW(4) - 2, RowH, nFsize, 1
                        .DrawText FormatNumber(Val(T総合計.n面積(n)), 0), dX(6), dY, ColW(6) - 1, RowH, nFsize, 1
                        dY = dY + RowH
                    End If
                Next
                .DrawText "［ 総 合 計 ］", dX(0), wdy + (dY - wdy) / 2, dX(4) - dX(0), RowH, nFsize, 2, 2
                .DLine dX(0), wdy - 1, dX(0), dY
                .DLine dX(4), wdy - 1, dX(4), dY
                .DLine dX(5), wdy - 1, dX(5), dY
                .DLine dX(7), wdy - 1, dX(7), dY
                .DLine dX(Xcnt), wdy - 1, dX(Xcnt), dY
                .DLine dX(0), dY, dX(Xcnt), dY

            Case "南種子町"
                wdy = wdy - 1
                .TextOut "人", dX(2) - 2, wdy + 2, nFsize, 1, 0
                .TextOut "(         )", hX(1), wdy + 8, nFsize, 2, 2
                .TextOut "人", dX(5) - 2, wdy + 2, nFsize, 1, 0
                .TextOut "(         )", hX(4), wdy + 8, nFsize, 2, 2
                .TextOut "u", dX(11) - 2, wdy + 2, nFsize, 1, 0
                .TextOut "田", dX(11) + 10, wdy + 4, nFsize, 2, 2
                .TextOut "u", dX(11) + 44, wdy + 1, nFsize, 1, 0
                .TextOut "樹園地", dX(11) + 56, wdy + 4, nFsize, 2, 2
                .TextOut "u", dX(Xcnt) - 2, wdy + 1, nFsize, 1, 0
                .TextOut "畑", dX(11) + 10, wdy + 12, nFsize, 2, 2
                .TextOut "u", dX(11) + 44, wdy + 9, nFsize, 1, 0
                .TextOut "その他", dX(11) + 56, wdy + 12, nFsize, 2, 2
                .TextOut "u", dX(Xcnt) - 2, wdy + 9, nFsize, 1, 0
                i = wdy + 16
                For n = 0 To 7
                    .DLine dX(n), wdy, dX(n), i
                Next
                .DLine dX(11), wdy, dX(11), i
                .DLine dX(11) + 20, wdy, dX(11) + 20, i
                .DLine dX(11) + 46, wdy, dX(11) + 46, i
                .DLine dX(11) + 66, wdy, dX(11) + 66, i
                .DLine dX(Xcnt), wdy, dX(Xcnt), i
                .DLine dX(11), wdy + 8, dX(Xcnt), wdy + 8
                .DLine dX(0), wdy + 16, dX(Xcnt), wdy + 16

                For n = 0 To 5: nArea(n) = 0: Next
                nWork(0) = 0: nWork(1) = 0
                sWork(0) = ";": sWork(1) = ";"
                For n = 1 To mvarPData.Count
                        nWork(0) = nWork(0) + 1
                        nWork(1) = nWork(1) + 1
'                       同じ人を数えないとき
'                       If InStr(sWork(0), mvarPData.Data(n, "氏名A")) = 0 Then nWork(0) = nWork(0) + 1: sWork(0) = sWork(0) & mvarPData.Data(n, "氏名A") & ";"
'                       If InStr(sWork(1), mvarPData.Data(n, "氏名B")) = 0 Then nWork(1) = nWork(1) + 1: sWork(1) = sWork(1) & mvarPData.Data(n, "氏名B") & ";"
                    nArea(1) = nArea(1) + Val(mvarPData.Data(n, "田面積"))
                    nArea(2) = nArea(2) + Val(mvarPData.Data(n, "畑面積"))
                    nArea(3) = nArea(3) + Val(mvarPData.Data(n, "樹面積"))
                    nArea(4) = nArea(4) + Val(mvarPData.Data(n, "他面積"))
                Next
                .TextOut nWork(0), hX(1), wdy + 8, nFsize, 2, 2
                .TextOut nWork(1), hX(4), wdy + 8, nFsize, 2, 2
                .TextOut FormatNumber(nArea(1) + nArea(2) + nArea(3) + nArea(4), 0), dX(11) - 10, wdy + 8, nFsize, 1, 2
                .TextOut IIf(nArea(1) = 0, "−", FormatNumber(nArea(1), 0)), dX(11) + 38, wdy + 4, nFsize, 1, 2
                .TextOut IIf(nArea(2) = 0, "−", FormatNumber(nArea(2), 0)), dX(11) + 38, wdy + 12, nFsize, 1, 2
                .TextOut IIf(nArea(3) = 0, "−", FormatNumber(nArea(3), 0)), dX(Xcnt) - 8, wdy + 4, nFsize, 1, 2
                .TextOut IIf(nArea(4) = 0, "−", FormatNumber(nArea(4), 0)), dX(Xcnt) - 8, wdy + 12, nFsize, 1, 2
            End Select
        End With
    End Sub

    Private Sub Class_Initialize()
        Dim n As Long
        Dim Rs As ADBasicLIB2.RecordsetEx
        
        Set mvarPData = New CPrintDatas
        mvarPData.Headers = _
        "通年受付番号;受付年月日;受付番号;受付補助記号;" & _
        "氏名A;住所A;年齢A;集落A;職業A;経営面積A;申請理由A;" & _
        "氏名B;住所B;年齢B;集落B;職業B;経営面積B;申請理由B;稼動人数;" & _
        "権利種類;利用権内容;期間;対価;対価単位;引渡時期;対価支払日;備考;" & _
        "田筆;畑筆;樹園筆;他筆;田面積;畑面積;樹面積;他面積;公告日;始期;終期;他地目;" & _
        ">農地;土地所在;登記地目;現況地目;面積;等級;農振区分;利用状況;権利種類;対価;対価支払日;都市計画;土地改良;一部;"

        mvarNowPage = 1
        For n = 0 To PGMAX
            PgChgSt(n) = 0
            PgChgEn(n) = 0
        Next
        DataCnt = 0
        PageCnt = 0
        mvarMaxPage = 0
        s支所 = ""
        
        For n = 0 To 4
            T総合計.s地目(n) = ""
            T総合計.n筆数(n) = 0
            T総合計.n面積(n) = 0
        Next
        
        Set Rs = SystemDB.GetRecordsetEx("SELECT ID,名称 FROM [M_BASICALL] WHERE [Class]='支所番号'", 0, , Me)
        Do Until Rs.EOF
            p支所番号.Add Rs.Value("ID"), Rs.Value("名称")
            Rs.MoveNext
        Loop
        SystemDB.CloseRs Rs
                
        b総括表出力 = False
        Select Case Fnc.s市町村名
            Case "南種子町":
                LMax = 32
                HMax = 4
                ColW = GetArray(9, 24, 8, 15, 24, 8, 15, 36, 7, 7, 14, 22, 18, 18, 20, 18)
                StartX = 15
                StartY = 45
                nFsize = 9
                RowH = 4
                b総括表出力 = True
                
            Case "三股町"
                LMax = 32
                HMax = 3
                ColW = GetArray(8, 9, 40, 40, 45, 10, 15, 24, 24, 24, 20)
                nFsize = 9
                StartX = 15
                StartY = 39
                RowH = 4
                
            Case "大崎町"
                HMax = 5        '基本データMAX
                LMax = 30       '１ページの行数
                StartX = 12
                StartY = 49
                nFsize = 10
                RowH = 4
                ColW = GetArray(6, 30, 15, 6, 30, 15, 10, 47, 5, 5, 16, 10, 26, 7, 34)
                b総括表出力 = True
                
            Case "さつま町"
                LMax = 36
                HMax = 4
                ColW = GetArray(10, 42, 16, 42, 16, 56, 12, 18, 24, 30)
                nFsize = 10
                StartX = 12
                StartY = 40
                RowH = 4
                b総括表出力 = True
            
            Case Else
                LMax = 36
                HMax = 4
                ColW = GetArray(10, 42, 16, 42, 16, 56, 12, 18, 24, 30)
                nFsize = 10
                StartX = 12
                StartY = 40
                RowH = 4
        End Select
    End Sub

    Private Sub CPrintSub_SetRsData(pRs As Object)
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim RsT As ADBasicLIB2.RecordsetEx
        Dim St As String
        Dim n As Long, i As Long
        Dim W As Long
        Dim nFlag(4) As Long
        Dim n面積 As Double
        Dim n部分面積 As Double
        Dim n集計面積 As Double
        Dim n地目区分 As Long
        Dim b合計出力 As Boolean
        Dim p合計 As dt合計
        Dim nSubCount As Long
        Dim b支所 As Boolean
        Dim b支所改頁 As Boolean
        Dim Ar As Variant, Cm As Variant
        Dim sSQL As String
        Dim b一部現況 As Boolean
        
        Ar = Split(mvarData, vbCrLf)
        Cm = Split(Ar(1), ";")
        s都道府県名 = Cm(0)
        s郡部 = Cm(1)
        If Cm(2) = "" Then b支所改頁 = False Else b支所改頁 = CBool(Cm(2))
        If Cm(3) = "" Then b支所 = False Else b支所 = CBool(Cm(3))
        
        b一部現況 = False
        b合計出力 = True
        Select Case Fnc.s市町村名
            Case "三股町":  b合計出力 = False
            Case "大崎町": b一部現況 = True
        End Select

        T総合計.s地目(0) = "( 田 )"
        T総合計.s地目(1) = "( 畑 )"
        T総合計.s地目(2) = "( 樹 )"
        T総合計.s地目(3) = "( 他 )"
        T総合計.s地目(4) = "( 計 )"

        With mvarPData
            Set Rs = pRs
            n = .NewLine
            If b支所改頁 And (s支所 <> Rs.Value("受付補助記号")) Then DataCnt = LMax
    
            .SetRsData n, "通年受付番号", Rs
            .SetRsData n, "受付番号", Rs
            .SetRsData n, "受付年月日", Rs
  
            If b支所 Then
                If p支所番号.Exists(Rs.Value("支所番号")) Then
                    .Data(n, "受付補助記号") = p支所番号.Item(Rs.Value("支所番号"))
                Else
                    .Data(n, "受付補助記号") = ""
                End If
            Else
                .Data(n, "受付補助記号") = Rs.NullCast("受付補助記号", "")
            End If

            If (Rs.IsNull("氏名B") Or Rs.Value("氏名B") = "") And Rs.Value("申請者B") <> 0 Then
                .Data(n, "氏名B") = SystemDB.GetDirectData("D:個人Info", "氏名", Rs.Value("申請者B"))
            Else
                .SetRsData n, "氏名B", Rs
            End If
    
            If (Not Rs.IsNull("代理人名")) And (Rs.Value("代理人名") <> "") Then
                .SetRsData n, "氏名A", Rs, "代理人名"
            ElseIf (Not Rs.IsNull("氏名A")) And (Rs.Value("氏名A") <> "") Then
                .SetRsData n, "氏名A", Rs
            Else
                .SetRsData n, "氏名A", Rs, "参照A"
            End If
    
            .SetRsData n, "住所A", Rs
            .Data(n, "年齢A") = IIf(Rs.Value("年齢A") = 0 Or Rs.IsNull("年齢A"), "", Rs.Value("年齢A"))
            .SetRsData n, "集落A", Rs
            .SetRsData n, "職業A", Rs
            .SetRsData n, "経営面積A", Rs
            .SetRsData n, "申請理由A", Rs
            .SetRsData n, "住所B", Rs
            .Data(n, "年齢B") = IIf(Rs.Value("年齢B") = 0 Or Rs.IsNull("年齢B"), "", Rs.Value("年齢B"))
            .SetRsData n, "集落B", Rs
            .SetRsData n, "職業B", Rs
            .SetRsData n, "経営面積B", Rs
            .SetRsData n, "申請理由B", Rs
            .SetRsData n, "稼動人数", Rs
            .Data(n, "権利種類") = "所有権移転"
            .SetRsData n, "利用権内容", Rs
            .Data(n, "対価") = Rs.NullCast("小作料", 0)
            .Data(n, "対価単位") = Rs.NullCast("小作料単位", "")
            .Data(n, "引渡時期") = IIf(Rs.IsNull("時期") Or Rs.Value("時期") = "0:00:00", "", Rs.Value("時期"))
            .Data(n, "公告日") = IIf(IsNull(Rs.Value("公告年月日")) Or Rs.Value("公告年月日") = "0:00:00", "", Rs.Value("公告年月日"))
            .Data(n, "対価支払日") = IIf(Rs.IsNull("対価支払年月日") Or Rs.Value("対価支払年月日") = "0:00:00", "", Rs.Value("対価支払年月日"))
            .SetRsData n, "備考", Rs
    
            For W = 0 To 4
                p合計.n筆数(W) = 0: p合計.n面積(W) = 0
            Next
            i = 0
            St = Replace(Replace(Rs.NullCast("農地リスト", ""), "農地.", ""), ";", ",")
            If Len(St) Then
                sSQL = "SELECT [V_農地].*,[V_地目].名称 AS [登記地目],[地目2].名称 AS [現況],[V_農委地目].名称 AS [農委地目],[D_部分申請].部分面積 AS [部分面積T] "
                sSQL = sSQL & "FROM ((([V_農地] LEFT JOIN [V_地目] ON [V_農地].[登記簿地目]=[V_地目].ID) LEFT JOIN V_現況地目 AS 地目2 ON [V_農地].[現況地目]=[地目2].ID) LEFT JOIN [V_農委地目] ON [V_農地].[農委地目ID]=[V_農委地目].ID) LEFT JOIN [D_部分申請] ON [V_農地].ID = [D_部分申請].農地ID "
                sSQL = sSQL & "WHERE [V_農地].[ID] IN (" & St & ")"
                sSQL = sSQL & " ORDER BY [V_農地].[管理人ID],[V_農地].[土地所在];"
                
                Set RsT = SystemDB.GetRecordsetEx(sSQL, 1, , "基盤利用権設定")
                Do Until RsT.EOF
                    i = i + 1
                    .SetRsData n & ":農地." & i, "土地所在", RsT
                    .SetRsData n & ":農地." & i, "登記地目", RsT
                    .SetRsData n & ":農地." & i, "等級", RsT
                    .SetRsData n & ":農地." & i, "農振区分", RsT, "農業振興地域"
                    .SetRsData n & ":農地." & i, "都市計画", RsT, "都市計画法"
                    .SetRsData n & ":農地." & i, "土地改良", RsT, "土地改良法"

                    If (Not RsT.IsNull("農委地目ID")) And (RsT.Value("農委地目ID") <> 0) And (Not RsT.IsNull("農委地目認定日")) And (RsT.Value("農委地目認定日") <> "0:00:00") Then
                        .SetRsData n & ":農地." & i, "現況地目", RsT, "農委地目"
                    Else
                        .SetRsData n & ":農地." & i, "現況地目", RsT, "現況"
                    End If
                    
                    n部分面積 = 0
                    If Fnc.s市町村名 = "南種子町" Then
                        n部分面積 = Fnc.NullCast(RsT.Value("契約面積"), 0)
                        .SetRsData n & ":農地." & i, "利用状況", RsT
                        .Data(n & ":農地." & i, "権利種類") = "所有権移転"
                        .Data(n & ":農地." & i, "対価") = Fnc.NullCast(RsT.Value("小作料"), 0)
                        .Data(n & ":農地." & i, "対価支払日") = IIf(Rs.IsNull("対価支払年月日") Or Rs.Value("対価支払年月日") = "0:00:00", "", Rs.Value("対価支払年月日"))
                    End If
                    
                    If n部分面積 = 0 And Not RsT.IsNull("部分面積T") Then n部分面積 = RsT.Value("部分面積T")
                    
                    n面積 = 0
                    If RsT.Value("田面積") <> 0 Then
                        n面積 = RsT.Value("田面積")
                        n地目区分 = 0
                    ElseIf RsT.Value("畑面積") <> 0 Then
                        n面積 = RsT.Value("畑面積")
                        n地目区分 = 1
                    ElseIf RsT.Value("樹園地") <> 0 Then
                        n面積 = RsT.Value("樹園地")
                        n地目区分 = 2
                    Else
                        If RsT.Value("採草放牧面積") <> 0 Then n面積 = RsT.Value("採草放牧面積")
                        n地目区分 = 3
                    End If
                    If n面積 = 0 Then n面積 = RsT.Value("実面積")
                    
                    If n部分面積 = 0 Then
                        n集計面積 = n面積
                    Else
                        n集計面積 = n部分面積
                    End If
                    n集計面積 = Fix(n集計面積)
                    .Data(n & ":農地." & i, "面積") = n集計面積
                    
                    .Data(n & ":農地." & i, "一部") = 0
                    If RsT.IsNull("一部現況") Then
                    ElseIf b一部現況 And Val(RsT.Value("一部現況")) > 0 Then
                        i = i + 1
                        .Data(n & ":農地." & i, "一部") = 1
                        .Data(n & ":農地." & i, "面積") = Fix(Fnc.NullCast(RsT.Value("登記簿面積"), 0))
                    End If
                    
                    p合計.n筆数(n地目区分) = p合計.n筆数(n地目区分) + 1
                    p合計.n面積(n地目区分) = p合計.n面積(n地目区分) + n集計面積
                    RsT.MoveNext
                Loop
            End If
            SystemDB.CloseRs RsT
            s支所 = Rs.NullCast("受付補助記号", "")
            .Data(n, "田筆") = p合計.n筆数(0): .Data(n, "畑筆") = p合計.n筆数(1): .Data(n, "樹園筆") = p合計.n筆数(2): .Data(n, "他筆") = p合計.n筆数(3)
            .Data(n, "田面積") = p合計.n面積(0): .Data(n, "畑面積") = p合計.n面積(1): .Data(n, "樹面積") = p合計.n面積(2): .Data(n, "他面積") = p合計.n面積(3)
            
            p合計.n筆数(4) = p合計.n筆数(0) + p合計.n筆数(1) + p合計.n筆数(2) + p合計.n筆数(3)
            p合計.n面積(4) = p合計.n面積(0) + p合計.n面積(1) + p合計.n面積(2) + p合計.n面積(3)
            
            ' 総合計
            For W = 0 To 4
                T総合計.n筆数(W) = T総合計.n筆数(W) + p合計.n筆数(W)
                T総合計.n面積(W) = T総合計.n面積(W) + p合計.n面積(W)
            Next

            If b合計出力 Then
                For i = 0 To 3
                    If p合計.n筆数(i) > 0 Then nFlag(i) = 1
                Next
                nFlag(4) = nFlag(0) + nFlag(1) + nFlag(2) + nFlag(3)
                      
                nSubCount = .SubCount(n & ":農地")
                If nFlag(4) = 1 Then
                    For i = 0 To 4: nFlag(i) = 0: Next
                End If
                nFlag(4) = nFlag(4) + 1
                
                If nSubCount + nFlag(4) < HMax Then
                   i = HMax - nFlag(4)
                Else
                    i = nSubCount + 1
                End If
                For W = 0 To 4
                    If nFlag(W) > 0 Then
                        i = i + 1
                        .Data(n & ":農地." & i, "土地所在") = T総合計.s地目(W)
                        .Data(n & ":農地." & i, "登記地目") = p合計.n筆数(W)
                        .Data(n & ":農地." & i, "現況地目") = "99999"      'データ行との区分：合計行に"99999"セット
                        .Data(n & ":農地." & i, "面積") = p合計.n面積(W)
                    End If
                Next
            Else
                nSubCount = .SubCount(n & ":農地") + 1
                If nSubCount < HMax Then
                    For i = nSubCount + 1 To HMax
                        .Data(n & ":農地." & i, "土地所在") = ""
                    Next
                End If
            End If
            If LMax <> 0 And HMax <> 0 Then SetPageNo n
        End With
        Set Rs = Nothing
    End Sub
    
    Private Sub SetPageNo(nDataNo As Long)
        Dim n As Long
        Dim i As Long
        Dim nSubCount As Long
        Dim nCount As Long
        Dim wCount As Long
        
        n = nDataNo
        nSubCount = mvarPData.SubCount(n & ":農地")
        
        nCount = DataCnt + nSubCount + 1      ' .SubCountは 0からみているため
        wCount = nSubCount + 1                '          件数として扱うときは１プラス
        
        If nCount > LMax Then
            nCount = nSubCount + 1
            i = 0
            Do While nCount > 0
                i = i + 1
                PageCnt = PageCnt + 1
                PgChgSt(PageCnt) = n * 1000 + (i - 1) * LMax
                PgChgEn(PageCnt) = n * 1000 + i * LMax - 1
                nCount = nCount - LMax
            Loop
            DataCnt = 0
            wCount = nCount + LMax
            If wCount < HMax Then
                wCount = HMax
            End If
        ElseIf n = 1 Then
            PageCnt = PageCnt + 1
            PgChgSt(PageCnt) = n * 1000
        End If
        PgChgEn(PageCnt) = n * 1000 + nSubCount
        DataCnt = DataCnt + wCount
        mvarMaxPage = PageCnt
    End Sub

    Private Sub Print総括表(mvarParent As ADBasicLIB2.CPrintFormSK)
        Dim nPit As Single
        Dim T As Single
        Dim n As Long, i As Long
        Dim dX(20) As Single
        Dim Ay As Variant
        Dim nArea(10) As Double, pPage As Long
        Dim nWork(10) As Long, sWork(10) As String
        Dim dbWork As Double
        Dim pData(10) As dt総括表
        Dim pDataS As dt総括表
        Dim bFlag As Boolean
        Dim Xcnt As Long
        
        nFsize = 9
        
        With mvarParent
            .ClearScreen
            .Offset 0, 0

             Ay = GetArray(30, 26, 26, 22, 18, 18, 18, 18, 18, 26, 26)
            dX(0) = 30
            For i = 0 To UBound(Ay): dX(i + 1) = dX(i) + Ay(i): Next
            Xcnt = UBound(Ay) + 1
            .TextOut "２．農用地利用集積計画総括表（所有権の移転）", dX(0), 25, 13, 0, 0
            .TextOut "（市町村名：" & Fnc.s市町村名 & "）", dX(Xcnt), 30, nFsize, 1, 0
            .TextOut "公告年月日", Ay(0) / 2 + dX(0), 45, nFsize, 2, 2
            .TextOut "対価支払", Ay(1) / 2 + dX(1), 41, nFsize, 2, 2
            .TextOut "年 月 日", Ay(1) / 2 + dX(1), 49, nFsize, 2, 2
            .TextOut "引渡時期", Ay(2) / 2 + dX(2), 45, nFsize, 2, 2
            .TextOut "存続期間", Ay(3) / 2 + dX(3), 45, nFsize, 2, 2
            .TextOut "面　　　　　　　　積", (dX(9) - dX(4)) / 2 + dX(4), 40, nFsize, 2, 2
            .TextOut "（u）", dX(9) - 5, 40, nFsize, 1, 2
            .TextOut "田", Ay(4) / 2 + dX(4), 50, nFsize, 2, 2
            .TextOut "畑", Ay(5) / 2 + dX(5), 50, nFsize, 2, 2
            .TextOut "樹園地", Ay(6) / 2 + dX(6), 50, nFsize, 2, 2
            .TextOut "その他", Ay(7) / 2 + dX(7), 50, nFsize, 2, 2
            .TextOut "計", Ay(8) / 2 + dX(8), 50, nFsize, 2, 2
            .TextOut "所有権移転を", Ay(9) / 2 + dX(9), 41, nFsize, 2, 2
            .TextOut "する人の数", Ay(9) / 2 + dX(9), 47, nFsize, 2, 2
            .TextOut "(人）", dX(10), 54, nFsize, 1, 1
            .TextOut "所有権移転を", Ay(10) / 2 + dX(10), 41, nFsize, 2, 2
            .TextOut "受ける人の数", Ay(10) / 2 + dX(10), 47, nFsize, 2, 2
            .TextOut "(人）", dX(11), 54, nFsize, 1, 1
            .TextOut "計", Ay(0) / 2 + dX(0), 175.5, nFsize, 2, 2

            .DBox dX(0), 35, dX(Xcnt), 184
            .DLine dX(4), 45, dX(9), 45
            .DLine dX(0), 55, dX(Xcnt), 55
            .DLine dX(0), 167, dX(Xcnt), 167
            For i = 0 To 6: .DotLine dX(0), 14 * i + 69, dX(Xcnt), 14 * i + 69, vbBlack: Next
            For i = 1 To Xcnt
                Select Case i
                    Case 1, 2, 3, 4, 9, 10
                        .DLine dX(i), 35, dX(i), 184
                    Case 5, 6, 7, 8
                        .DLine dX(i), 45, dX(i), 184
                End Select
            Next
            
            For i = 0 To 10: pData(i).n期間 = (-1): Next

            For n = 1 To mvarPData.Count
                ' 出力データ作成・集計
                bFlag = False
                For i = 0 To 10
                    If pData(i).s公告日 = mvarPData.Data(n, "公告日") And pData(i).s対価支払日 = mvarPData.Data(n, "対価支払日") And pData(i).s引渡時期 = mvarPData.Data(n, "引渡時期") Then
                        pData(i).n面積(0) = pData(i).n面積(0) + Val(mvarPData.Data(n, "田面積"))
                        pData(i).n面積(1) = pData(i).n面積(1) + Val(mvarPData.Data(n, "畑面積"))
                        pData(i).n面積(2) = pData(i).n面積(2) + Val(mvarPData.Data(n, "樹面積"))
                        pData(i).n面積(3) = pData(i).n面積(3) + Val(mvarPData.Data(n, "他面積"))
                        dbWork = Val(mvarPData.Data(n, "田面積")) + Val(mvarPData.Data(n, "畑面積")) + Val(mvarPData.Data(n, "樹面積")) + Val(mvarPData.Data(n, "他面積"))
                        pData(i).n面積(4) = pData(i).n面積(4) + dbWork
                        pData(i).n人数(0) = pData(i).n人数(0) + 1
                        pData(i).n人数(1) = pData(i).n人数(1) + 1
'                               同じ人を数えないとき
'                                If InStr(sWork(0), mvarPData.Data(n, "氏名A")) = 0 Then
'                                    pData(i).n人数(0) = pData(i).n人数(0) + 1
'                                    sWork(0) = sWork(0) & mvarPData.Data(n, "氏名A") & ";"
'                                End If
'                                If InStr(sWork(1), mvarPData.Data(n, "氏名B")) = 0 Then
'                                    pData(i).n人数(1) = pData(i).n人数(1) + 1
'                                    sWork(1) = sWork(1) & mvarPData.Data(n, "氏名B") & ";"
'                                End If
                        bFlag = True
                        If pData(i).n期間 = (-1) Then pData(i).n期間 = Val(mvarPData.Data(n, "期間"))
                        Exit For
                    End If
                Next
                If bFlag = False Then
                    For i = 0 To 10
                        If pData(i).n期間 = (-1) Then Exit For
                    Next
                    If i > 10 Then Exit For
                    pData(i).s公告日 = mvarPData.Data(n, "公告日")
                    pData(i).s対価支払日 = mvarPData.Data(n, "対価支払日")
                    pData(i).s引渡時期 = mvarPData.Data(n, "引渡時期")
                    pData(i).n期間 = Val(mvarPData.Data(n, "期間"))
                    pData(i).n面積(0) = pData(i).n面積(0) + Val(mvarPData.Data(n, "田面積"))
                    pData(i).n面積(1) = pData(i).n面積(1) + Val(mvarPData.Data(n, "畑面積"))
                    pData(i).n面積(2) = pData(i).n面積(2) + Val(mvarPData.Data(n, "樹面積"))
                    pData(i).n面積(3) = pData(i).n面積(3) + Val(mvarPData.Data(n, "他面積"))
                    dbWork = Val(mvarPData.Data(n, "田面積")) + Val(mvarPData.Data(n, "畑面積")) + Val(mvarPData.Data(n, "樹面積")) + Val(mvarPData.Data(n, "他面積"))
                    pData(i).n面積(4) = pData(i).n面積(4) + dbWork
                    pData(i).n人数(0) = pData(i).n人数(0) + 1
                    pData(i).n人数(1) = pData(i).n人数(1) + 1
    '                            同じ人を数えないとき
    '                            If InStr(sWork(0), mvarPData.Data(n, "氏名A")) = 0 Then
    '                                pData(i).n人数(0) = pData(i).n人数(0) + 1
    '                                sWork(0) = sWork(0) & mvarPData.Data(n, "氏名A") & ";"
    '                            End If
    '                            If InStr(sWork(1), mvarPData.Data(n, "氏名B")) = 0 Then
    '                                pData(i).n人数(1) = pData(i).n人数(1) + 1
    '                                sWork(1) = sWork(1) & mvarPData.Data(n, "氏名B") & ";"
    '                            End If
                End If
            Next

            ' 期間・公告日・始期順ソート
            For n = 0 To 10
                For i = 0 To 9
                    If IsDate(pData(i).s公告日) And IsDate(pData(i + 1).s公告日) Then
                        If pData(i).s公告日 > pData(i + 1).s公告日 Then
                            pDataS = pData(i)
                            pData(i) = pData(i + 1)
                            pData(i + 1) = pDataS
                        ElseIf pData(i).s公告日 = pData(i + 1).s公告日 Then
                            If IsDate(pData(i).s対価支払日) And IsDate(pData(i + 1).s対価支払日) Then
                                If CDate(pData(i).s対価支払日) > CDate(pData(i + 1).s対価支払日) Then
                                    pDataS = pData(i)
                                    pData(i) = pData(i + 1)
                                    pData(i + 1) = pDataS
                                ElseIf pData(i).s対価支払日 = pData(i + 1).s対価支払日 Then
                                    If IsDate(pData(i).s引渡時期) And IsDate(pData(i + 1).s引渡時期) Then
                                        If CDate(pData(i).s引渡時期) > CDate(pData(i + 1).s引渡時期) Then
                                            pDataS = pData(i)
                                            pData(i) = pData(i + 1)
                                            pData(i + 1) = pDataS
                                        End If
                                    End If
                                End If
                            ElseIf IsDate(pData(i).s引渡時期) And IsDate(pData(i + 1).s引渡時期) Then
                                If CDate(pData(i).s引渡時期) > CDate(pData(i + 1).s引渡時期) Then
                                    pDataS = pData(i)
                                    pData(i) = pData(i + 1)
                                    pData(i + 1) = pDataS
                                End If
                            End If
                        End If
                    ElseIf IsDate(pData(i).s対価支払日) And IsDate(pData(i + 1).s対価支払日) Then
                        If CDate(pData(i).s対価支払日) > CDate(pData(i + 1).s対価支払日) Then
                            pDataS = pData(i)
                            pData(i) = pData(i + 1)
                            pData(i + 1) = pDataS
                        ElseIf pData(i).s対価支払日 = pData(i + 1).s対価支払日 Then
                            If IsDate(pData(i).s引渡時期) And IsDate(pData(i + 1).s引渡時期) Then
                                If CDate(pData(i).s引渡時期) > CDate(pData(i + 1).s引渡時期) Then
                                    pDataS = pData(i)
                                    pData(i) = pData(i + 1)
                                    pData(i + 1) = pDataS
                                End If
                            End If
                        End If
                    ElseIf IsDate(pData(i).s引渡時期) And IsDate(pData(i + 1).s引渡時期) Then
                        If CDate(pData(i).s引渡時期) > CDate(pData(i + 1).s引渡時期) Then
                            pDataS = pData(i)
                            pData(i) = pData(i + 1)
                            pData(i + 1) = pDataS
                        End If
                    End If
                Next
            Next

            ' 出力
            T = 61.5: nPit = 4
            For i = 0 To 5: nArea(i) = 0: Next
            For i = 0 To 3: nWork(i) = 0: Next
            For n = 0 To 10
                If pData(n).n期間 <> (-1) Then
                    .DrawText IIf(Len(pData(n).s公告日) = 0, "", Format(pData(n).s公告日, "GGGEE年M月D日")), dX(0), T, Ay(0), nPit, nFsize, 2, 0
    '                            .DrawText IIf(Len(pData(n).s公告日) = 0, "−", Format(pData(n).s公告日, "GGGEE年M月D日")), dX(0), T, Ay(0), nPit, nFsize, 2, 0
                    .DrawText IIf(Len(pData(n).s対価支払日) = 0, "−", Format(pData(n).s対価支払日, "GEE.M.D")), dX(1), T, Ay(1), nPit, nFsize, 2, 0
                    .DrawText IIf(Len(pData(n).s引渡時期) = 0, "−", Format(pData(n).s引渡時期, "GEE.M.D")), dX(2), T, Ay(2), nPit, nFsize, 2, 0
                    .DrawText IIf(Val(pData(n).n期間) = 0, "−", pData(n).n期間), dX(3), T, Ay(3), nPit, nFsize, 2, 0
                    For i = 0 To 4
                        .DrawText IIf(pData(n).n面積(i) = 0, "−", FormatNumber(pData(n).n面積(i), 0)), dX(4 + i), T, Ay(4 + i) - 1, nPit, nFsize, 1, 0
                        nArea(i) = nArea(i) + pData(n).n面積(i)
                    Next
                    For i = 0 To 1
                        .DrawText IIf(pData(n).n人数(i) = 0, "−", FormatNumber(pData(n).n人数(i), 0)), dX(9 + i), T, Ay(9 + i) - 3, nPit, nFsize, 1, 0
                        nWork(i) = nWork(i) + pData(n).n人数(i)
                    Next
                    T = T + 14
                End If
            Next
            For i = 0 To 4
                .DrawText IIf(nArea(i) = 0, "−", FormatNumber(nArea(i), 0)), dX(4 + i), 175.5, Ay(4 + i) - 1, nPit, nFsize, 1, 2
            Next
            For i = 0 To 1
                .DrawText IIf(nWork(i) = 0, "−", FormatNumber(nWork(i), 0)), dX(9 + i), 175.5, Ay(9 + i) - 3, nPit, nFsize, 1, 2
            Next
        End With
    End Sub

End Class










Class CPrintSub奨励金交付
    Option Explicit
    Implements CPrintSub
    Private mvarKey As String
    Private mvarData As String
    Private mvarPData As CPrintDatas
    Private mvarNowPage As Long
    Private mvarMaxPage As Long
    Private mvarMaxLine As Long
    Private mvarStartPage As Integer
    
    Private Property Let CPrintSub_StartPage(RHS As Long): mvarStartPage = RHS: End Property
    Private Property Get CPrintSub_StartPage() As Long: CPrintSub_StartPage = mvarStartPage: End Property
    Private Property Let CPrintSub_Data(ByVal RHS As String): Dim Cm As Variant: mvarData = RHS: Cm = Split(mvarData, ";"): mvarStartPage = Val(Cm(2)) - (Val(Cm(2)) = 2) * (Val(Cm(3)) - 2): End Property
    Private Property Get CPrintSub_Data() As String: CPrintSub_Data = mvarData: End Property

    Private Property Let CPrintSub_Key(ByVal RHS As String): mvarKey = RHS: End Property
    Private Property Get CPrintSub_Key() As String: CPrintSub_Key = mvarKey: End Property

    Private Property Get CPrintSub_MaxPage() As Long
        Dim n As Long
        Dim i As Long
        Dim nPage As Long
        
        i = 0: nPage = 0
        For n = 1 To mvarPData.Count
            i = i + mvarPData.SubCount(n & ":農地") + 1
            If i = mvarMaxLine Then
                nPage = nPage + 1
                i = 0
            ElseIf i > mvarMaxLine Then
                nPage = nPage + 1
                i = mvarPData.SubCount(n & ":農地") + 1
            End If
        Next
        If i > 0 Then
            nPage = nPage + 1
        End If
        mvarMaxPage = nPage
        CPrintSub_MaxPage = mvarMaxPage
    End Property

    Private Property Get CPrintSub_NowPage() As Long: CPrintSub_NowPage = mvarNowPage: End Property

    Private Sub CPrintSub_PrintSub(ByVal sKey As String, ByVal nPage As Long, mvarParent As ADBasicLIB2.CPrintFormSK)
        Dim Rows As Long
        Dim nFsize As Integer
        Dim Ar As Variant, Cm As Variant
        Dim Ay As Variant
        Dim n As Long, i As Long
        Dim dX(15) As Single, hX(15) As Single
        Dim nStart As Long, nEnd As Long
        Dim nY As Long, nTotal(2) As Long
        Dim bFlag As Boolean
        Dim St As String
        Dim Xcnt As Long
        Dim SY As Long
        
        mvarNowPage = nPage
        nFsize = 10
        Rows = 12
        
        Ay = GetArray(10, 34, 10, 22, 56, 10, 12, 14, 20, 20, 22, 30)
        dX(0) = 20: hX(0) = dX(0) + Ay(0) / 2
        For n = 0 To UBound(Ay)
            dX(n + 1) = dX(n) + Ay(n)
            If n < UBound(Ay) Then hX(n + 1) = dX(n + 1) + Ay(n + 1) / 2
        Next
        Xcnt = UBound(Ay) + 1
        
        With mvarParent
            .ClearScreen
            .Offset 0, 0
            Ar = Split(mvarData, vbCrLf)
            Cm = Split(Ar(0), ";")
            
            .TextOut "議案第" & StrConv(Cm(0), vbWide) & "号", dX(0) - 3, 18, nFsize, 0, 0
            .TextOut "農地流動化奨励金交付申請について", dX(0) + 15, 25, 14, 0, 0
            .TextOut "このことについて、農地流動化奨励金交付要綱の規定により農業委員会の議決を求める。", dX(0), 34, nFsize, 0, 0
            .TextOut "農地流動化奨励金交付申請総括表", dX(0), 40, nFsize, 0, 0
            .TextOut "番号", hX(0), 53, nFsize, 2, 2
            .TextOut "申 請 人 氏 名", hX(1), 53, nFsize, 2, 2
            .TextOut "年齢", hX(2), 53, nFsize, 2, 2
            .TextOut "利用権設定", hX(3), 50, nFsize, 2, 2
            .TextOut "年　月　日", hX(3), 56, nFsize, 2, 2
            .TextOut "土地の所在", hX(4), 53, nFsize, 2, 2
            .TextOut "地目", hX(5), 53, nFsize, 2, 2
            .TextOut "契約", hX(6), 50, nFsize, 2, 2
            .TextOut "期間", hX(6), 56, nFsize, 2, 2
            .TextOut "新　規", hX(7), 49, nFsize, 2, 2
            .TextOut "再設定", hX(7), 53, nFsize, 2, 2
            .TextOut "の　別", hX(7), 57, nFsize, 2, 2
            .TextOut "地積(ａ)", hX(8), 53, nFsize, 2, 2
            .TextOut "10ａ当り", hX(9), 50, nFsize, 2, 2
            .TextOut "奨 励 金", hX(9), 56, nFsize, 2, 2
            .TextOut "交付金額", hX(10), 53, nFsize, 2, 2
            .TextOut "備　　　　考", hX(11), 53, nFsize, 2, 2
'            .TextOut "計", hX(1), 185, nFsize, 2, 2
    
            .LineBoxDX dX(0), 46, 0, 1, 14, Ay
            .DLine dX(0), 44, dX(0) + 53, 44
            
            If mvarPData.Count < 1 Then Exit Sub
            GetNo nPage, nStart, nEnd
'            nStart = (nPage - 1) * Rows + 1
'            nEnd = (nPage - 1) * Rows + Rows
'            If nEnd > mvarPData.Count Then nEnd = mvarPData.Count
            SY = 60: nY = 61: bFlag = True
            For n = nStart To nEnd
                .DrawText n, dX(0), nY, Ay(0), 4, nFsize, 2
                .DrawText mvarPData.Data(n, "申請人"), dX(1) + 2, nY, Ay(1) - 2, 4, nFsize
                .DrawText IIf(mvarPData.Data(n, "年齢") = 0, "", mvarPData.Data(n, "年齢")), dX(2), nY, Ay(2), 4, nFsize, 2
                .DrawText Format(mvarPData.Data(n, "設定年月日"), "yyyy/mm/dd"), dX(3), nY, Ay(3), 4, nFsize, 2
                .DrawText FormatNumber(Val(mvarPData.Data(n, "地積")), 1), dX(8), nY, Ay(8) - 1, 4, nFsize, 1
                .DrawText FormatNumber(Val(mvarPData.Data(n, "奨励金")), 0), dX(9), nY, Ay(9) - 1, 4, nFsize, 1
                .DrawText FormatNumber(Val(mvarPData.Data(n, "交付金額")), 0), dX(10), nY, Ay(10) - 1, 4, nFsize, 1
                .DrawText mvarPData.Data(n, "備考"), dX(11) + 2, nY, Ay(11) - 2, 4, nFsize
                For i = 0 To mvarPData.SubCount(n & ":農地")
                    If mvarPData.Data(n & ":農地." & i, "地目") = "99999" Then
                        .TextOut StrConv(mvarPData.Data(n & ":農地." & i, "土地所在"), vbNarrow), dX(5) - 5, nY, nFsize, 1
                    Else
                        .DrawText StrConv(mvarPData.Data(n & ":農地." & i, "土地所在"), vbNarrow), dX(4) + 1, nY, Ay(4) - 1, 4, nFsize
                        .DrawText Left(mvarPData.Data(n & ":農地." & i, "地目"), 2), dX(5), nY, Ay(5), 4, nFsize, 2
'                        .DrawText Format(mvarPData.Data(n & ":農地." & i, "期間"), "#"), dX(6), nY, Ay(6), 4, nFsize, 2
                        .DrawText PDataComp(n & ":農地.", i, "期間", "〃"), dX(6), nY, Ay(6), 4, nFsize, 2
                        .DrawText PDataComp(n & ":農地.", i, "再設定", "〃"), dX(7), nY, Ay(7), 4, nFsize, 2
                    End If
                    nY = nY + 4
                Next
                .LineBoxDX dX(0), CSng(SY), 0, 1, CSng(nY - SY), Ay
                SY = nY
                '.DLine dX(0), CSng(nY), dX(Xcnt), CSng(nY)
                nY = nY + 1
                bFlag = False
            Next

            If mvarNowPage = mvarMaxPage Then
                nY = nY - 1
                nTotal(0) = 0: nTotal(1) = 0
                .LineBoxDX dX(0), CSng(nY), 0, 1, 10, Ay
                For n = 1 To mvarPData.Count
                    nTotal(0) = nTotal(0) + Val(mvarPData.Data(n, "地積"))
                    nTotal(1) = nTotal(1) + Val(mvarPData.Data(n, "交付金額"))
                Next
                .DrawText "計", dX(1), nY + 5, Ay(1), 4, nFsize, 2, 2
                .DrawText FormatNumber(nTotal(0), 0), dX(8), nY + 5, Ay(8) - 1, 4, nFsize, 1, 2
                .DrawText FormatNumber(nTotal(1), 0), dX(10), nY + 5, Ay(10) - 1, 4, nFsize, 1, 2
            End If
            If mvarStartPage > 0 Then .TextOut "- " & mvarStartPage - 1 + nPage & " - ", .PaperWidth / 2, .PaperHeight - 4
        End With
    End Sub

    Private Sub CPrintSub_SetData(ByVal sKey As String, Optional ByVal sParam1 As String = "", Optional ByVal sParam2 As String = "")

    End Sub
    
    Private Sub Class_Initialize()
        Set mvarPData = New CPrintDatas
        mvarPData.Headers = _
        "申請人ID;申請人;年齢;設定年月日;地積;奨励金;交付金額;備考;" & _
        ">農地;土地所在;地目;期間;再設定;"

        mvarNowPage = 1
        mvarMaxLine = 28
    End Sub
    
    Private Sub CPrintSub_SetRsData(pRs As Object)
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim RsT As ADBasicLIB2.RecordsetEx
        Dim n As Long
        Dim i As Long
        Dim St As String
        Dim St1 As String, St2 As String
        
        Set Rs = pRs
        With mvarPData
            n = .NewLine
            .SetRsData n, "申請人", Rs, "氏名A"
            .SetRsData n, "年齢", Rs, "年齢A"
            .SetRsData n, "設定年月日", Rs, "公告年月日"
            .SetRsData n, "地積", Rs, "数量"
            .SetRsData n, "奨励金", Rs, "条件B"
            .Data(n, "交付金額") = Val(Rs.Value("条件B")) * Val(Rs.Value("数量")) / 100
            If Rs.Value("法令") = "991" Then
                .Data(n, "備考") = IIf(Rs.Value("条件A") = "Null", "担い手農家", "認定農業者")
            Else
                .Data(n, "備考") = ""
            End If
                
            St = Replace(Replace(Rs.Value("農地リスト"), "農地.", ""), ";", ",")
            If Len(St) Then
                St2 = ";"
                i = 0
                Set RsT = SystemDB.GetRecordsetEx("SELECT [V_農地].*,[V_地目].名称  AS [現況],[V_農委地目].名称 AS [農委地目] FROM ([V_農地] LEFT JOIN V_地目 ON [V_農地].[現況地目]=[V_地目].ID) LEFT JOIN [V_農委地目] ON [V_農地].[農委地目ID]=[V_農委地目].ID WHERE [V_農地].[ID] IN (" & St & ")", 1, , "奨励金交付")
                Do Until RsT.EOF
                    i = i + 1
                    .SetRsData n & ":農地." & i, "土地所在", RsT
                    If (Not RsT.IsNull("農委地目ID")) And (RsT.Value("農委地目ID") <> 0) And (Not RsT.IsNull("農委地目認定日")) And (RsT.Value("農委地目認定日") <> "0:00:00") Then
                        .SetRsData n & ":農地." & i, "地目", RsT, "農委地目"
                    Else
                        .SetRsData n & ":農地." & i, "地目", RsT, "現況"
                    End If
                    .Data(n & ":農地." & i, "再設定") = IIf(Rs.Value("再設定") = True, "再設定", "新規")
                    If (Not RsT.IsNull("小作開始年月日")) And (RsT.Value("小作開始年月日") <> "0:00:00") And (Not RsT.IsNull("小作終了年月日")) And (RsT.Value("小作終了年月日") <> "0:00:00") Then
                        .Data(n & ":農地." & i, "期間") = DateDiff("yyyy", RsT.Value("小作開始年月日"), RsT.Value("小作終了年月日"))
                    Else
                        .Data(n & ":農地." & i, "期間") = 0
                    End If

                    RsT.MoveNext
                Loop
                SystemDB.CloseRs RsT
            End If
            If i > 0 Then
                .Data(n & ":農地." & i + 1, "土地所在") = ""
                If i > 1 Then
                    .Data(n & ":農地." & i + 2, "地目") = "99999"
                    .Data(n & ":農地." & i + 2, "土地所在") = "（計)" & Right("            " & CStr(i), 12) & "筆"
                End If
            End If
        End With
        Set Rs = Nothing
       
    End Sub
    
    Private Function PDataComp(sNo As String, No As Long, sItem As String, St As String) As String
        If No = 0 Then
            PDataComp = mvarPData.Data(sNo & No, sItem)
            Exit Function
        End If
        
        If mvarPData.Data(sNo & No, sItem) <> mvarPData.Data(sNo & No - 1, sItem) Then
            PDataComp = mvarPData.Data(sNo & No, sItem)
        ElseIf Len(mvarPData.Data(sNo & No, sItem)) > 0 Then
            PDataComp = St
        Else
            PDataComp = ""
        End If
    End Function

    Private Sub GetNo(pPage As Long, ByRef pStart As Long, ByRef pEnd As Long)
        Dim n As Long
        Dim i As Long
        Dim nPage As Long
        
        i = 0: nPage = 1
        pStart = 1: pEnd = 0
        For n = 1 To mvarPData.Count
            i = i + mvarPData.SubCount(n & ":農地") + 1
            If i = mvarMaxLine Then
                If nPage = pPage Then
                    pEnd = n
                    Exit For
                End If
                nPage = nPage + 1
                i = 0
                pStart = n + 1
            ElseIf i > mvarMaxLine Then
                If nPage = pPage Then
                    pEnd = n - 1
                    Exit For
                End If
                nPage = nPage + 1
                i = mvarPData.SubCount(n & ":農地") + 1
                pStart = n
            End If
        Next
        If pEnd = 0 Then pEnd = mvarPData.Count
    End Sub

End Class

Class CPrintSub農地法3条
    Option Explicit
    Implements CPrintSub
    Private mvarKey As String
    Private mvarData As String
    Private mvarPData As CPrintDatas
    
    Private mvarStartPage As Integer
    Private Const PGMAX As Long = 100   'ページ切替データＭＡＸ
    Private PgChgSt(PGMAX) As Long      'ページ切替開始番号
    Private PgChgEn(PGMAX) As Long      'ページ切替終了番号
    Private DataCnt As Long             'データカウント
    Private PageCnt As Long             'ページカウント
    Private HMax As Long                '基本データMAX
    Private LMax As Long                '１ページの行数
    Private PageMax As Long             'ページＭＡＸ
    Private PageNow As Long             '現在のページ
    Private StartX As Single            'データ始点(X)
    Private StartY As Single            'データ始点(Y)
    Private nFsize As Integer           'フォントサイズ
    Private RowH As Long                '１行の高さ
    Private ColW As Variant             '表枠の幅
    Private s支所 As String
    Private p経営面積A As New CDataDictionary
    Private p経営面積B As New CDataDictionary
    Private s都道府県名 As String
    Private s郡部 As String
    Private pTableSize As New CTableSize
   
    Private Type TotalData
        s地目(4) As String
        n筆数(4) As Long
        n面積(4) As Double
    End Type
    Private mvarXMLData As CXMLDoc
    
    
    Private T総合計 As TotalData

    Private Sub Class_Terminate()
        Set mvarPData = Nothing
    End Sub

    Private Property Let CPrintSub_Data(ByVal RHS As String): Dim Cm As Variant: mvarData = RHS: Cm = Split(mvarData, ";"): mvarStartPage = Val(Cm(2)) - (Val(Cm(2)) = 2) * (Val(Cm(3)) - 2): End Property
    Private Property Get CPrintSub_Data() As String: CPrintSub_Data = mvarData: End Property

    Private Property Let CPrintSub_Key(ByVal RHS As String): mvarKey = RHS: End Property
    Private Property Get CPrintSub_Key() As String: CPrintSub_Key = mvarKey: End Property

    Private Property Get CPrintSub_MaxPage() As Long: CPrintSub_MaxPage = PageMax: End Property
    
    Private Property Get CPrintSub_NowPage() As Long: CPrintSub_NowPage = PageNow: End Property

    Private Sub CPrintSub_PrintSub(ByVal sKey As String, ByVal nPage As Long, ByRef mvarParent As ADBasicLIB2.CPrintFormSK)
        Dim Ar As Variant, Cm As Variant
        Dim St As String
        Dim n As Long
        Dim i As Long
        Dim dX(20) As Single, hX(20) As Single
        Dim Xcnt As Long
        
        On Error Resume Next
        If mvarPData.Count = 0 Then
            mvarParent.ClearScreen
            Exit Sub
        End If
        PageNow = nPage
        
        With mvarParent
            .ClearScreen
            .Offset 0, 0
            
            Select Case sKey
                Case "n30": St = "委員会"
                Case "n31": St = "委員会"
                Case "n32": St = "県知事"
                Case "n33": St = "県知事"
            End Select
            Ar = Split(mvarData, vbCrLf)
            Cm = Split(Ar(0), ";")
            
            '表の項目幅(ColW)より縦線設定
            dX(0) = StartX: hX(0) = dX(0) + ColW(0) / 2
            n = dX(0)
            For i = 0 To UBound(ColW)
                dX(i + 1) = dX(i) + ColW(i)
                If i < UBound(ColW) Then hX(i + 1) = dX(i + 1) + ColW(i + 1) / 2
            Next
            Xcnt = UBound(ColW) + 1
            
            Select Case Fnc.s市町村名
            Case "姶良市"
                .DrawWidth = 2
                .Offset 0, -2
                
                .TextOut "議案第" & StrConv(Cm(0), vbWide) & "号          農地法第３条申請（" & St & "許可）", dX(0) - 4, 22, 13, 0, 2
                .DrawText "番\n\n号", dX(0), 31, ColW(0), RowH, nFsize, 2, 0
                .DrawText "譲     受     人（借人）", dX(1), 25, dX(5) - dX(1), 4, nFsize, 2, 2, RowH
                .DrawText "譲   渡   人（貸人）", dX(5), 25, dX(8) - dX(5), 4, nFsize, 2, 2, RowH
                .DrawText "氏      名", dX(1), 33, ColW(1), RowH, nFsize, 2
                .DrawText "住      所", dX(1), 42, ColW(1), RowH, nFsize, 2
                .DrawText "経 営\n面 積\n(u)", dX(2), 33, ColW(2), RowH, nFsize, 2
                .DrawText "労", dX(3), 33, ColW(3), RowH, nFsize, 2
                .DrawText "力", dX(3), 42, ColW(3), RowH, nFsize, 2
                .DrawText "申請", dX(4), 33, ColW(4), RowH, nFsize, 2
                .DrawText "理由", dX(4), 42, ColW(4), RowH, nFsize, 2
                .DrawText "氏    　名", dX(5), 33, ColW(5), RowH, nFsize, 2
                .DrawText "住   　 所", dX(5), 42, ColW(5), RowH, nFsize, 2
                .DrawText "経 営\n面 積\n(u)", dX(6), 33, ColW(6), RowH, nFsize, 2
                .DrawText "申請", dX(7), 33, ColW(7), RowH, nFsize, 2
                .DrawText "理由", dX(7), 42, ColW(7), RowH, nFsize, 2
                .DrawText "土 地 の 所 在", dX(8), 35, ColW(8), RowH, nFsize, 2, 0
                .DrawText "地目", dX(9), 26, ColW(9) + ColW(10), RowH, nFsize, 2, 2
                .DrawText "登\n記\n簿", dX(9), 33, ColW(9), RowH, nFsize, 2
                .DrawText "現\n況", dX(10), 33, ColW(10), 8, nFsize, 2
                .DrawText "面積\n(u)", dX(11), 33, ColW(11), 10, nFsize, 2, 0
                .DrawText "契約内容", dX(12), 35, ColW(12), RowH, nFsize, 2, 0
                .DrawText "契\n約\n期\n間", dX(13), 29, ColW(13), RowH, nFsize, 2
                
                If Fnc.s市町村名 = "姶良市" Then
                    .DrawText "担当委員", dX(14), 35, ColW(14), RowH, nFsize, 2, 0
                Else
                    .DrawText "調査員", dX(14), 35, ColW(14), RowH, nFsize, 2, 0
                End If
                    
                .DLine dX(0), 25, dX(Xcnt), 25
                .DLine dX(1), 30, dX(8), 30
                .DLine dX(9), 30, dX(11), 30
                .DLine dX(0), 49, dX(Xcnt), 49
                
                For i = 0 To Xcnt
                    Select Case i
                        Case 2, 3, 4, 6, 7, 10: .DLine dX(i), 30, dX(i), 49
                        Case Else:          .DLine dX(i), 25, dX(i), 49
                    End Select
                Next
            Case "枕崎市"
                .Offset 0, -15
                .TextOut "日程第" & StrConv(Cm(1), vbWide) & "号" & "　" & "第" & StrConv(Cm(0), vbWide) & "号議案", StartX, 35, 14, 0, 2
                .TextOut "農地法第３条許可申請について", (dX(Xcnt) - StartX) / 2 + StartX, 42, 18, 2, 2
                .TextOut "（" & St & "許可）", 20, 47, 14, 0, 1

                .hTextOut "整理番号", 21, 50, 2, 8, 11
                .TextOut "土　地　の　所　在", 60, 56, 11, 2, 2
                .hTextOut "登記地目", 91, 50, 2, 8, 11
                .hTextOut "現況地目", 101, 50, 2, 8, 11
                .DrawText "面　　積\n(u)", 110, 52, 30, 5, 11, 2
                .TextOut "譲　受　人", 157.5, 56, 11, 2, 2
                .TextOut "譲　渡　人", 192.5, 56, 11, 2, 2
                .TextOut "譲 渡 事 由", 230, 56, 11, 2, 2
                .TextOut "調 査 員", 265, 56, 11, 2, 2
                .LineBoxDX StartX, 48, 16, 0, 0, ColW
                
                PrintSubMain mvarParent, dX()

            Case "さつま町"
                .Offset 0, 0
                .TextOut "議案第" & StrConv(Cm(0), vbWide) & "号", 16, 13, 13, 0, 2
                .TextOut "農地法第３条申請（" & St & "許可）", 20, 22, 14, 0, 2

                .hTextOut "番号", 22, 29, 1, 11
                .TextOut "申                    請                    人", (dX(8) - dX(1)) / 2 + dX(1), 27.5, 11, 2, 2
                .TextOut "譲    受    人(借  人)", (dX(5) - dX(1)) / 2 + dX(1), 32, 11, 2, 2
                .TextOut "譲    渡    人(貸人)", (dX(8) - dX(5)) / 2 + dX(5), 32, 11, 2, 2
                .TextOut "氏      名", ColW(1) / 2 + dX(1), 37, 11, 2, 2
                .TextOut "住      所", ColW(1) / 2 + dX(1), 41, 11, 2, 2
                .TextOut "年齢  職業", ColW(1) / 2 + dX(1), 45, 11, 2, 2
                .DrawText "経 営\n面 積\nu", dX(2), 35, ColW(2), 4, 11, 2, 0
                .DrawText "労\n\n力", dX(3), 35, ColW(3), 4, 11, 2, 0
                .DrawText "申 請\n\n理 由", dX(4), 35, ColW(4), 4, 11, 2, 0
                .TextOut "氏    名", ColW(5) / 2 + dX(5), 37, 11, 2, 2
                .TextOut "住    所", ColW(5) / 2 + dX(5), 41, 11, 2, 2
                .TextOut "年齢　職業", ColW(5) / 2 + dX(5), 45, 11, 2, 2
                .DrawText "経 営\n面 積\nu", dX(6), 35, ColW(6), 4, 11, 2, 0
                .DrawText "申 請\n\n理 由", dX(7), 35, ColW(7), 4, 11, 2, 0
                .TextOut "申             請             地", (dX(13) - dX(8)) / 2 + dX(8), 27.5, 11, 2, 2
                .TextOut "土地の所在", ColW(8) / 2 + dX(8), 40, 11, 2, 2
                .DrawText "台\n\n帳", dX(9), 33, ColW(9), 4, 11, 2, 0
                .DrawText "現\n\n況", dX(10), 33, ColW(10), 4, 11, 2, 0
                .DrawText "面積\n\nu", dX(11), 33, ColW(11), 4, 11, 2, 0
                .DrawText "区\n\n分", dX(12), 33, ColW(12), 4, 11, 2, 0
                .TextOut "契 約 内 容", ColW(13) / 2 + dX(13), 37, 11, 2, 2
                .DrawText "契\n約\n期\n間", dX(14), 27, ColW(14), 5, 11, 2, 0
                .TextOut "備  考", ColW(15) / 2 + dX(15), 35, 11, 2, 0
                .TextOut "(調査員)", ColW(15) / 2 + dX(15), 41, 11, 2, 0

                .DLine dX(0), 25, dX(Xcnt), 25
                .DLine dX(1), 30, dX(13), 30
                .DLine dX(1), 34, dX(8), 34
                .DLine dX(0), 48, dX(Xcnt), 48
                For n = 0 To Xcnt
                    Select Case n
                    Case 0, 1, 8, 13, 14, 15, 16
                        .DLine dX(n), 25, dX(n), 48
                    Case 2, 3, 4, 6, 7
                        .DLine dX(n), 34, dX(n), 48
                    Case 5, 6, 9, 10, 11, 12
                        .DLine dX(n), 30, dX(n), 48
                    End Select
                Next
                
            Case "三股町"
                .Offset 0, 0
                .TextOut "農地法第３条", (dX(16) - dX(14)) / 2 + dX(14), 30, nFsize, 2, 0
                .DrawText "受\n付\n番\n号", dX(0), 38, ColW(0), 5, nFsize, 2, 2
                .DrawText "受\n付\n年\n月\n日", dX(1), 38, ColW(1), 4, nFsize, 2, 2
                .DrawText "受\n人", dX(2), 38, ColW(2), 4, nFsize, 2, 2
                .DrawText "渡\n人", dX(2), 50, ColW(2), 4, nFsize, 2, 2
                .TextOut "住　所", dX(3) + 6, 39, nFsize, 0, 2
                .TextOut "氏　名（地区支部）", dX(3) + 6, 45, nFsize, 0, 2
                .TextOut "住　所", dX(3) + 6, 51, nFsize, 0, 2
                .TextOut "氏　名（地区支部）", dX(3) + 6, 57, nFsize, 0, 2
                .DrawText "土 地 の 表 示 等", dX(4), 42, dX(7) - dX(4), 4, nFsize, 2, 2
                .DrawText "所　　　在", dX(4), 54, ColW(4), 4, nFsize, 2, 2
                .DrawText "地\n目", dX(5), 50, ColW(5), 4, nFsize, 2, 2
                .DrawText "地積", dX(6), 54, ColW(6), 4, nFsize, 2, 2
                .DrawText "譲　渡\n事　由", dX(7), 42, ColW(7), 10, nFsize, 2, 0
                .DrawText "売\n贈\n使\n賃\n別", dX(8), 38, ColW(8), 4, nFsize, 2, 2
                .DrawText "世\n帯\n員\n数", dX(9), 38, ColW(9), 5.4, nFsize, 2, 0
                .DrawText "稼\n動\n力", dX(10), 38, ColW(10), 8, nFsize, 2, 0
                .DrawText "受人経\n営面積", dX(11), 42, ColW(11), 10, nFsize, 2, 0
                .DrawText "交\n付\n年\n月\n日", dX(12), 38, ColW(12), 4, nFsize, 2, 2
                .DrawText "指\n令\n番\n号", dX(13), 38, ColW(13), 5.4, nFsize, 2, 0
                .DrawText "受\n領\n年\n月\n日", dX(14), 38, ColW(14), 4, nFsize, 2, 2
                .DrawText "受\n領\n印", dX(15), 38, ColW(15), 8, nFsize, 2, 0
                
                .DBox dX(14), 28, dX(16), 36
                .DLine dX(0), 36, dX(14), 36
                .DotLine dX(3), 42, dX(4), 42, RGB(0, 0, 0)
                .DLine dX(2), 48, dX(7), 48
                .DotLine dX(3), 54, dX(4), 54, RGB(0, 0, 0)
                .DLine dX(0), 60, dX(Xcnt), 60
                
                For i = 0 To Xcnt
                    If i = 5 Or i = 6 Then
                        .DLine dX(i), 48, dX(i), 60
                    Else
                        .DLine dX(i), 36, dX(i), 60
                    End If
                Next
            
            Case "日置市"
                .Offset 0, 0
                .TextOut "第" & StrConv(Cm(0), vbWide) & "号議案", 16, 13, 13, 0, 2
                .TextOut "農地法第３条申請（" & St & "許可）", 20, 22, 14, 0, 2
                
                n = PgChgSt(nPage) \ 1000
                Select Case mvarPData.Data(n, "受付補助記号")
                    Case "本": St = "伊集院地域"
                    Case "東": St = "東市来地域"
                    Case "日": St = "日吉地域"
                    Case "吹": St = "吹上地域"
                    Case Else: St = ""
                End Select
                .TextOut "[ " & St & " ]", dX(Xcnt), 22, 14, 1, 2
                
                .DrawText "番\n号", dX(0), 30, ColW(0), 10, 11, 2, 0
                .TextOut "申　　　　　　請　　　　　　人", (dX(8) - dX(1)) / 2 + dX(1), 27.5, 11, 2, 2
                .TextOut "譲　　　　受　　　　人", (dX(5) - dX(1)) / 2 + dX(1), 32, 11, 2, 2
                .TextOut "譲　　　　渡　　　　人", (dX(8) - dX(5)) / 2 + dX(5), 32, 11, 2, 2
                .TextOut "氏      名", ColW(1) / 2 + dX(1), 37, 11, 2, 2
                .TextOut "住      所", ColW(1) / 2 + dX(1), 41, 11, 2, 2
                .TextOut "年      齢", ColW(1) / 2 + dX(1), 45, 11, 2, 2
                .DrawText "経 営\n面 積\nu", dX(2), 35, ColW(2), 4, 11, 2, 0
                .DrawText "労\n\n力", dX(3), 35, ColW(3), 4, 11, 2, 0
                .DrawText "申 請\n\n理 由", dX(4), 35, ColW(4), 4, 11, 2, 0
                .TextOut "氏    名", ColW(5) / 2 + dX(5), 37, 11, 2, 2
                .TextOut "住    所", ColW(5) / 2 + dX(5), 41, 11, 2, 2
                .TextOut "年    齢", ColW(5) / 2 + dX(5), 45, 11, 2, 2
                .DrawText "経 営\n面 積\nu", dX(6), 35, ColW(6), 4, 11, 2, 0
                .DrawText "申 請\n\n理 由", dX(7), 35, ColW(7), 4, 11, 2, 0
                .TextOut "申　　　請　　　地", (dX(13) - dX(8)) / 2 + dX(8), 27.5, 11, 2, 2
                .TextOut "土地の所在", ColW(8) / 2 + dX(8), 40, 11, 2, 2
                .DrawText "台\n\n帳", dX(9), 33, ColW(9), 4, 11, 2, 0
                .DrawText "現\n\n況", dX(10), 33, ColW(10), 4, 11, 2, 0
                .DrawText "面積\n\nu", dX(11), 33, ColW(11), 4, 11, 2, 0
                .DrawText "区\n\n分", dX(12), 33, ColW(12), 4, 11, 2, 0
                .TextOut "契 約 内 容", ColW(13) / 2 + dX(13), 37, 11, 2, 2
                .DrawText "契\n約\n期\n間", dX(14), 27, ColW(14), 5, 11, 2, 0
                .TextOut "備  考", ColW(15) / 2 + dX(15), 35, 11, 2, 0
                .TextOut "(調査員)", ColW(15) / 2 + dX(15), 41, 11, 2, 0
                
                .DLine dX(0), 25, dX(Xcnt), 25
                .DLine dX(1), 30, dX(13), 30
                .DLine dX(1), 34, dX(8), 34
                For n = 0 To Xcnt
                    Select Case n
                    Case 0, 1, 8, 13, 14, 15, 16
                        .DLine dX(n), 25, dX(n), 48
                    Case 2, 3, 4, 6, 7
                        .DLine dX(n), 34, dX(n), 48
                    Case 5, 6, 9, 10, 11, 12
                        .DLine dX(n), 30, dX(n), 48
                    End Select
                Next
            
            Case "南種子町"
                .Offset 0, 0
                .TextOut "議案第" & StrConv(Cm(0), vbWide) & "号", 27, 22, 13, 0, 0
                If sKey = "n30" Or sKey = "n31" Then
                    .TextOut "農地法第３条の規定による許可申請（委員会許可）について　資料", 60, 22, 13, 0, 0
                Else
                    .TextOut "農地法第３条の規定による許可申請（県知事許可）に対する意見決定　資料", 60, 22, 13, 0, 0
                End If
                .TextOut "整理", ColW(0) / 2 + dX(0), 32.5, nFsize, 2, 2
                .TextOut "番号", ColW(0) / 2 + dX(0), 37.5, nFsize, 2, 2
                .TextOut "調 査", ColW(1) / 2 + dX(1), 32.5, nFsize, 2, 2
                .TextOut "委 員", ColW(1) / 2 + dX(1), 37.5, nFsize, 2, 2
                .TextOut "譲　受　人", ColW(2) / 2 + dX(2), 32.5, nFsize, 2, 2
                .TextOut "（借　人）", ColW(2) / 2 + dX(2), 37.5, nFsize, 2, 2
                .TextOut "年", ColW(3) / 2 + dX(3), 32.5, nFsize, 2, 2
                .TextOut "齢", ColW(3) / 2 + dX(3), 37.5, nFsize, 2, 2
                .TextOut "譲　渡　人", (dX(6) - dX(4)) / 2 + dX(4), 32.5, nFsize, 2, 2
                .TextOut "（貸　人）", (dX(6) - dX(4)) / 2 + dX(4), 37.5, nFsize, 2, 2
                .TextOut "年", ColW(6) / 2 + dX(6), 32.5, nFsize, 2, 2
                .TextOut "齢", ColW(6) / 2 + dX(6), 37.5, nFsize, 2, 2
                .TextOut "土地の所在", ColW(7) / 2 + dX(7), 35, nFsize, 2, 2
                .TextOut "持分", ColW(8) / 2 + dX(8), 35, nFsize, 2, 2
                .TextOut "登記", ColW(9) / 2 + dX(9), 32.5, nFsize, 2, 2
                .TextOut "地目", ColW(9) / 2 + dX(9), 37.5, nFsize, 2, 2
                .TextOut "現況", ColW(10) / 2 + dX(10), 32.5, nFsize, 2, 2
                .TextOut "地目", ColW(10) / 2 + dX(10), 37.5, nFsize, 2, 2
                .TextOut "地 積", ColW(11) / 2 + dX(11), 32.5, nFsize, 2, 2
                .TextOut "(u)", ColW(11) / 2 + dX(11), 37.5, nFsize, 2, 2
                .TextOut "経 営 面 積 (u)", (dX(14) - dX(12)) / 2 + dX(12), 32.5, nFsize, 2, 2
                .TextOut "渡", ColW(12) / 2 + dX(12), 37.5, nFsize, 2, 2
                .TextOut "受", ColW(13) / 2 + dX(13), 37.5, nFsize, 2, 2
                .TextOut "労働", ColW(14) / 2 + dX(14), 32.5, nFsize, 2, 2
                .TextOut "力受", ColW(14) / 2 + dX(14), 37.5, nFsize, 2, 2
                .TextOut "理　　　由", (dX(17) - dX(15)) / 2 + dX(15), 32.5, nFsize, 2, 2
                .TextOut "渡", ColW(15) / 2 + dX(15), 37.5, nFsize, 2, 2
                .TextOut "受", ColW(16) / 2 + dX(16), 37.5, nFsize, 2, 2
                .TextOut "備　考", ColW(17) / 2 + dX(17), 35, nFsize, 2, 2
                
                .DLine dX(0), 30, dX(Xcnt), 30
                .DLine dX(12), 35, dX(14), 35
                .DLine dX(15), 35, dX(17), 35
                .DLine dX(0), 40, dX(Xcnt), 40

                For n = 0 To Xcnt
                    Select Case n
                        Case 5:
                        Case 13, 16: .DLine dX(n), 35, dX(n), 40
                        Case Else:   .DLine dX(n), 30, dX(n), 40
                    End Select
                Next
                              
            Case "大崎町"
                .Offset 0, 5
                .TextOut "第" & StrConv(Cm(0), vbWide) & "号議案", dX(0) - 4, 13, 13, 0, 2
                .TextOut "農地法第３条申請（" & St & "許可）", dX(0), 22, 14, 0, 2

                .DrawText "番\n\n号", dX(0), 25, ColW(0), 4, nFsize, 2, 2, 24
                .DrawText "譲     受     人（借人）", dX(1), 26, dX(5) - dX(1), RowH, nFsize, 2, 2, RowH
                .DrawText "譲   渡   人（貸人）", dX(5), 26, dX(8) - dX(5), RowH, nFsize, 2, 2, RowH
                .DrawText "氏　　　名", dX(1), 33, ColW(1), RowH, nFsize, 2
                .DrawText "集　　　落", dX(1), 37.5, ColW(1), RowH, nFsize, 2
                .DrawText "職業・年齢", dX(1), 42, ColW(1), RowH, nFsize, 2
                .DrawText "経 営", dX(2), 33, ColW(2), RowH, nFsize, 2
                .DrawText "面 積", dX(2), 42, ColW(2), RowH, nFsize, 2
                .DrawText "労", dX(3), 33, ColW(3), RowH, nFsize, 2
                .DrawText "力", dX(3), 42, ColW(3), RowH, nFsize, 2
                .DrawText "申請", dX(4), 33, ColW(4), RowH, nFsize, 2
                .DrawText "理由", dX(4), 42, ColW(4), RowH, nFsize, 2
                .DrawText "氏　　　名", dX(5), 33, ColW(5), RowH, nFsize, 2
                .DrawText "集　　　落", dX(5), 37.5, ColW(5), RowH, nFsize, 2
                .DrawText "職業・年齢", dX(5), 42, ColW(5), RowH, nFsize, 2
                .DrawText "経 営", dX(6), 33, ColW(6), RowH, nFsize, 2
                .DrawText "面 積", dX(6), 42, ColW(6), RowH, nFsize, 2
                .DrawText "申請", dX(7), 33, ColW(7), RowH, nFsize, 2
                .DrawText "理由", dX(7), 42, ColW(7), RowH, nFsize, 2
                .DrawText "土 地 の 所 在", dX(8), 25, ColW(8), RowH, nFsize, 2, 2, 24
                .DrawText "地目", dX(9), 26, ColW(9) + ColW(10), RowH, nFsize, 2, 2, RowH
                .DrawText "台\n\n帳", dX(9), 30, ColW(9), 4, nFsize, 2, 2, 19
                .DrawText "現\n\n況", dX(10), 30, ColW(10), 4, nFsize, 2, 2, 19
                .DrawText "面積\n(u)", dX(11), 25, ColW(11), 4, nFsize, 2, 2, 24
                .DrawText "農\n\n振", dX(12), 25, ColW(12), RowH, nFsize, 2, 2, 24
                .DrawText "契約内容", dX(13), 25, ColW(13), RowH, nFsize, 2, 2, 24
                .DrawText "契\n約\n期\n間\n⌒\n年", dX(14), 25, ColW(14), RowH, nFsize - 1, 2, 2, 24
                .DrawText "結\n\n果", dX(15), 25, ColW(15), RowH, nFsize, 2, 2, 24
                .DrawText "備  考", dX(16), 25, ColW(16), RowH, nFsize, 2, 2, 24
                    
                .DLine dX(0), 25, dX(Xcnt), 25
                .DLine dX(1), 30, dX(8), 30
                .DLine dX(9), 30, dX(11), 30
                .DLine dX(0), 49, dX(Xcnt), 49
                
                For i = 0 To Xcnt
                    Select Case i
                        Case 2, 3, 4, 6, 7, 10: .DLine dX(i), 30, dX(i), 49
                        Case Else:          .DLine dX(i), 25, dX(i), 49
                    End Select
                Next
            Case "阿久根市"
                .Offset 0, 0
                .TextOut "第" & StrConv(Cm(0), vbWide) & "号議案", 16, 13, 13, 0, 2
                .TextOut mvarXMLData.Root.Attributes("議案書3条タイトル"), 22, 18, 13, 0, 0

                .hTextOut "番号", 22, 29, 1, 11
                .TextOut "申                    請                    人", 88, 27.5, 11, 2, 2
                .TextOut "譲         受         人", 61, 32, 11, 2, 2
                .TextOut "譲       渡       人", 123.5, 32, 11, 2, 2
                .TextOut "氏      名", 44.5, 37, 11, 2, 2
                .TextOut "住      所", 44.5, 41, 11, 2, 2
                .hTextOut "経  営面  積", 63.5, 35, 4, 8
                .TextOut "申 請", 84.5 - 6, 35, 11
                .TextOut "理 由", 84.5 - 6, 43, 11
                .TextOut "氏    名", 109.5 - 6, 37, 11, 2, 2
                .TextOut "住    所", 109.5 - 6, 41, 11, 2, 2
                .hTextOut "経  営面  積", 124.5 - 6, 35, 4, 8
                .hTextOut "申 請理 由", 139.5 - 6, 35, 3, 8
                .TextOut "申             請             地", 188.5 - 6, 27.5, 11, 2, 2
                .TextOut "土地の所在", 175 - 6, 40, 11, 2, 2
                .hTextOut "台帳", 198.5 - 6, 34, 1, 6
                .hTextOut "現況", 203.5 - 6, 34, 1, 6
                .hTextOut "面積     u", 210.5 - 3, 33, 5, 8
                .hTextOut "区分", 221.5, 34, 1, 6
                .TextOut "契 約 内 容", 239, 37, 11, 2, 2
                .hTextOut "契約期間", 254, 25.5, 1, 6
                .TextOut "備  考", 266, 35, 11
                    
                .DLine pTableSize.x(0), 25, dX(Xcnt), 25
                .DLine pTableSize.x(1), 30, dX(13), 30
                .DLine pTableSize.x(1), 34, dX(8), 34
                .DLine pTableSize.x(0), 48, dX(Xcnt), 48
                .DBox pTableSize.x(0), 25, dX(Xcnt), 48, vbBlack, 4
                For i = 0 To Xcnt
                    Select Case i
                        Case 2, 3, 4, 6, 7: .DLine dX(i), 34, dX(i), 48
                        Case 5, 9, 10, 11:  .DLine dX(i), 30, dX(i), 48
                        Case Else:          .DLine dX(i), 25, dX(i), 48
                    End Select
                Next
            
                PrintSubMain mvarParent, dX()

            
            Case Else
                .Offset 0, 0
                .TextOut "第" & StrConv(Cm(0), vbWide) & "号議案", 16, 13, 13, 0, 2
'                .TextOut mvarXMLData.Root.Attributes("議案書３条タイトル"), 22, 18, 13, 0, 0
                .TextOut SystemDB.DBProperty("議案書3条タイトル"), 22, 18, 13, 0, 0

                .hTextOut "番号", 22, 29, 1, 11
                .TextOut "申                    請                    人", 88, 27.5, 11, 2, 2
                .TextOut "譲         受         人", 61, 32, 11, 2, 2
                .TextOut "譲       渡       人", 123.5, 32, 11, 2, 2
                .TextOut "氏      名", 44.5, 37, 11, 2, 2
                .TextOut "住      所", 44.5, 41, 11, 2, 2
                .TextOut "職      業", 44.5, 45, 11, 2, 2
                .hTextOut "経  営面  積", 63.5, 35, 4, 8
                .hTextOut "労力", 78, 35, 1, 8
                .TextOut "申 請", 84.5, 35, 11
                .TextOut "理 由", 84.5, 43, 11
                .TextOut "氏    名", 109.5, 37, 11, 2, 2
                .TextOut "住    所", 109.5, 41, 11, 2, 2
                .TextOut "職    業", 109.5, 45, 11, 2, 2
                .hTextOut "経  営面  積", 124.5, 35, 4, 8
                .hTextOut "申 請理 由", 139.5, 35, 3, 8
                .TextOut "申             請             地", 188.5, 27.5, 11, 2, 2
                .TextOut "土地の所在", 175, 40, 11, 2, 2
                .hTextOut "台帳", 198.5, 34, 1, 6
                .hTextOut "現況", 203.5, 34, 1, 6
                .hTextOut "面積     u", 210.5, 33, 5, 8
                .hTextOut "区分", 221.5, 34, 1, 6
                .TextOut "契 約 内 容", 239, 37, 11, 2, 2
                .hTextOut "契約期間", 254, 25.5, 1, 6
                .TextOut "備  考", 266, 35, 11
                    
                .DLine dX(0), 25, dX(Xcnt), 25
                .DLine dX(1), 30, dX(13), 30
                .DLine dX(1), 34, dX(8), 34
                .DLine dX(0), 48, dX(Xcnt), 48
                
                For i = 0 To Xcnt
                    Select Case i
                        Case 2, 3, 4, 6, 7: .DLine dX(i), 34, dX(i), 48
                        Case 5, 9, 10, 11:  .DLine dX(i), 30, dX(i), 48
                        Case Else:          .DLine dX(i), 25, dX(i), 48
                    End Select
                Next
            End Select
            
            PrintSubMain mvarParent, dX()
        End With

    End Sub
        
    Private Sub PrintSubMain(ByRef mvarParent As ADBasicLIB2.CPrintFormSK, ByRef dX() As Single)
        Dim hY As Single        ' 基本データY座標
        Dim dY As Single        ' 土地データY座標
        Dim Rcnt As Long        ' 行カウント
        Dim nMainStart As Long  ' データ開始番号
        Dim nMainEnd As Long    ' データ終了番号
        Dim nSubStart As Long   ' 土地データ開始番号
        Dim nSubEnd As Long     ' 土地データ終了番号
        Dim n As Long
        Dim i As Long
        Dim nWork As Single
        Dim nPage As Long
        Dim Xcnt As Long
        
        On Error Resume Next
        nPage = PageNow
        Xcnt = UBound(ColW) + 1

        With mvarParent
            nMainStart = PgChgSt(nPage) \ 1000
            nMainEnd = PgChgEn(nPage) \ 1000
       
            dY = StartY + 2
            hY = StartY + 1

            For n = nMainStart To nMainEnd
                ' 土地データ開始番号設定
                If n = nMainStart Then
                    nSubStart = PgChgSt(nPage) - nMainStart * 1000
                Else
                    nSubStart = 0
                End If
                
                '土地データ終了番号設定
                If n = nMainEnd Then
                    nSubEnd = PgChgEn(nPage) - nMainEnd * 1000
                Else
                    nSubEnd = mvarPData.SubCount(n & ":農地")
                End If
                
                ' 罫線
                Rcnt = nSubEnd - nSubStart + 1
                If Rcnt < HMax Then
                    nWork = hY + HMax * RowH
                Else
                    nWork = dY + Rcnt * RowH
                End If
                For i = 0 To Xcnt
                    .DLine dX(i), dY - 1, dX(i), nWork, vbBlack
                Next
                
                '背景色設定
                If Fnc.s市町村名 = "日置市" Then
                    For i = 0 To Xcnt
                        Select Case i
                        Case 0, 4, 7, 13, 14
                            .DBox dX(i), dY - 1, dX(i + 1), nWork, RGB(230, 230, 230), , True
                        End Select
                        .DLine dX(i), hY - 1, dX(i), nWork, vbBlack
                    Next
                    .DLine dX(0), dY - 1, dX(Xcnt), dY - 1, vbBlack
                End If

                ' データ出力
                For i = nSubStart To nSubEnd
                    PrintSubData mvarParent, n, i, dX, dY, nSubStart, nSubEnd
                    dY = dY + RowH
                Next
                
                Rcnt = nSubEnd - nSubStart + 1
                If Rcnt < HMax Then   ' 土地データ行数が基本データ行数より少ないとき
                    dY = hY + 1 + HMax * RowH
                End If
                .DLine dX(0), dY, dX(Xcnt), dY, vbBlack
                Debug.Print "  n" & ":" & n & ":" & dY
                dY = dY + 1
                hY = dY
            Next
            If nPage = PageMax Then PrintSubTotal mvarParent, dX, dY
            If mvarStartPage > 0 Then .TextOut "- " & mvarStartPage - 1 + nPage & " - ", .PaperWidth / 2, .PaperHeight - 4
        End With
    End Sub
    
    Private Sub PrintSubData(ByRef mvarParent As ADBasicLIB2.CPrintFormSK, pNo As Long, pSubNo As Long, ByRef dX() As Single, dY As Single, pSubStart As Long, pSubEnd As Long)
        Dim St As String
        Dim StX As String
        Dim nWk(3) As Long
        Dim i As Long
        Dim n As Long
        Dim K As Long

        On Error Resume Next
        With mvarParent
            Select Case Fnc.s市町村名
            Case "姶良市"
                If pSubNo = pSubStart Then
                    .TextOut mvarPData.Data(pNo, "通年受付番号"), (dX(0) + dX(1)) / 2, dY + RowH, nFsize, 2
                    '.TextOut mvarPData.Data(pNo, "受付補助記号"), (dX(0) + dX(1)) / 2, dY + RowH * 3, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo, "氏名B"), 16), dX(1) + 1, dY, ColW(1) - 2, RowH, nFsize, 0
                    Debug.Print "pNo" & ":" & pNo & ":" & dY
                    .DrawText Fnc.GetShortAddress(mvarPData.Data(pNo, "住所B"), s都道府県名, s郡部, , , True), dX(1) + 1, dY + RowH * 2, ColW(1) - 2, RowH, nFsize - 1, 0
                    .DrawText Left(mvarPData.Data(pNo, "職業B"), 6), dX(1) + 1, dY + RowH * 5, ColW(1) - 1, RowH, nFsize, 0
                    .DrawText IIf(Val(mvarPData.Data(pNo, "年齢B")) = 0, "", mvarPData.Data(pNo, "年齢B") & "歳"), dX(1), dY + RowH * 5, ColW(1) - 1, RowH, nFsize, 1
                    .DrawText Left(mvarPData.Data(pNo, "集落B"), 8), dX(1) + 1, dY + RowH * 6, ColW(1) - 1, RowH, nFsize, 0
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo, "経営面積B")), 0), dX(2), dY, ColW(2) - 1, RowH, nFsize, 1
                    .DrawText Format(Val(mvarPData.Data(pNo, "稼動人数")), "#"), dX(3), dY, ColW(3), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo, "申請理由B"), 12), dX(4) + 1, dY, ColW(4) - 1, RowH, nFsize

                    If CBool(mvarPData.Data(pNo, "複数申請人A")) = False Then
                        .DrawText Left(mvarPData.Data(pNo, "氏名A"), 16), dX(5) + 1, dY, ColW(5) - 2, RowH, nFsize, 0
                        .DrawText Fnc.GetShortAddress(mvarPData.Data(pNo, "住所A"), s都道府県名, s郡部, , , True), dX(5) + 1, dY + RowH * 2, ColW(5) - 2, RowH, nFsize - 1, 0
                        .DrawText Left(mvarPData.Data(pNo, "職業A"), 6), dX(5) + 1, dY + RowH * 5, ColW(5) - 2, RowH, nFsize
                        .DrawText IIf(Val(mvarPData.Data(pNo, "年齢A")) = 0, "", mvarPData.Data(pNo, "年齢A") & "歳"), dX(5), dY + RowH * 5, ColW(5) - 1, RowH, nFsize, 1
                        .DrawText Left(mvarPData.Data(pNo, "集落A"), 8), dX(5) + 1, dY + RowH * 6, ColW(5) - 1, RowH, nFsize, 0
                    End If
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo, "経営面積A")), 0), dX(6), dY, ColW(6) - 1, RowH, nFsize, 1
                    .DrawText Left(mvarPData.Data(pNo, "申請理由A"), 12), dX(7) + 1, dY, ColW(7) - 1, RowH, nFsize
                                       
                    Select Case Val(mvarPData.Data(pNo, "法令"))
                        Case 30, 32
                            .TextOut "所有権移転", ColW(12) / 2 + dX(12), dY, nFsize, 2
                        Case 31, 33
                            Select Case Val(mvarPData.Data(pNo, "権利種類"))
                                Case 1
                                    .TextOut "賃借権設定", ColW(12) / 2 + dX(12), dY, nFsize, 2
                                Case 2
                                    .TextOut "使用貸借権", ColW(12) / 2 + dX(12), dY, nFsize, 2
                            End Select
                            If Val(mvarPData.Data(pNo, "期間")) > 0 Then .DrawText Fnc.NullCast(mvarPData.Data(pNo, "期間"), ""), dX(13), dY, ColW(13), RowH, nFsize, 2
                    End Select
                    .DrawText Left(mvarPData.Data(pNo, "調査員"), 30), dX(14) + 1, dY, ColW(14) - 1, RowH, nFsize
                End If
                    
                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(8) + 2, dY, ColW(8), RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(8), dY, ColW(8) - 2, RowH, nFsize, 1
                    .TextOut FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(12) - 1, dY, nFsize, 1
                ElseIf Val(mvarPData.Data(pNo & ":農地." & pSubNo, "一部")) = 1 Then
                    .TextOut "(" & FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0) & "の内)", dX(12) - 1, dY, nFsize - 2, 1
                Else
                    If CBool(mvarPData.Data(pNo, "複数申請人A")) Then
                        .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "所有者名"), 8), dX(5) + 1, dY, ColW(5) - 2, RowH, nFsize - 1
                        .DrawText Fnc.GetShortAddress(mvarPData.Data(pNo & ":農地." & pSubNo, "所有者住所"), s都道府県名, "姶良郡", , , True), dX(5) + 1, dY + RowH, ColW(5) - 2, RowH, nFsize - 2, 0
                        If mvarPData.Data(pNo & ":農地." & pSubNo, "線") = "1" Then
                            .DotLine dX(5), dY - 0.5, dX(6), dY - 0.5, vbBlack
                            .DotLine dX(8), dY - 0.5, dX(12), dY - 0.5, vbBlack
                        End If
                    End If
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(8) + 1, dY, ColW(8) - 2, RowH, nFsize - 1
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 1), dX(9), dY, ColW(9), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 1), dX(10), dY, ColW(10), RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        .TextOut FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(12) - 1, dY, nFsize, 1
                    End If
                End If
                           
            Case "枕崎市"
                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then  ' 合計行
                    .TextOut mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(1) + 5, dY, nFsize, 0, 0
                    .TextOut mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(2) - 2, dY, nFsize, 1, 0
                    .TextOut FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(5) - 2, dY, nFsize, 1
                Else
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(1) + 1, dY, ColW(1) - 2, RowH, nFsize, 0
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 1), dX(2) + 1, dY, ColW(2) - 2, RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 1), dX(3) + 1, dY, ColW(3) - 2, RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        .TextOut FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(5) - 2, dY, nFsize, 1
                    End If
                End If
    
                If (pSubNo = pSubStart) Then
                    .TextOut pNo, dX(1) - 2, dY, nFsize, 1, 0     '番号
                    .DrawText mvarPData.Data(pNo, "職業B"), dX(5) + 1, dY, ColW(5) - 2, RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo, "氏名B"), dX(5) + 1, dY + RowH, ColW(5) - 2, RowH, nFsize, 0
                    .TextOut FormatNumber(Val(mvarPData.Data(pNo, "経営面積B")), 0) & "u", dX(6) - 2, dY + RowH * 2, nFsize, 1
        
                    .DrawText mvarPData.Data(pNo, "職業A"), dX(6) + 1, dY, ColW(6) - 2, RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo, "氏名A"), dX(6) + 1, dY + RowH, ColW(6) - 2, RowH, nFsize, 0
                    .TextOut FormatNumber(Val(mvarPData.Data(pNo, "経営面積A")), 0) & "u", dX(7) - 2, dY + RowH * 2, nFsize, 1
                    .DrawText mvarPData.Data(pNo, "申請理由A"), dX(7) + 1, dY, ColW(7), RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo, "調査員"), dX(8) + 1, dY, ColW(8) - 2, RowH, nFsize, 2
                End If
            
            Case "さつま町"
                If (pSubNo = pSubStart) Then
                    .TextOut mvarPData.Data(pNo, "通年受付番号"), (dX(1) - dX(0)) / 2 + dX(0), dY, nFsize, 2, 0   '番号
                    
                    .DrawText mvarPData.Data(pNo, "氏名B"), dX(1) + 1, dY, ColW(1) - 2, RowH, nFsize, 0
                    .DrawText StrConv(mvarPData.Data(pNo, "住所B"), vbNarrow), dX(1) + 1, dY + RowH * 3, ColW(1) - 2, RowH, nFsize - 1, 0
                    .DrawText IIf(Val(mvarPData.Data(pNo, "年齢B")) > 0, mvarPData.Data(pNo, "年齢B") & "歳", ""), dX(1) + 1, dY + RowH * 6, ColW(1) - 1, RowH, nFsize, 0
                    .DrawText Left(mvarPData.Data(pNo, "職業B"), 5), dX(1) + 13, dY + RowH * 6, ColW(1) - 11, RowH, nFsize
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo, "経営面積B")), 0), dX(2), dY, ColW(2) - 1, RowH, nFsize, 1
                    .DrawText mvarPData.Data(pNo, "稼動人数"), dX(3), dY, ColW(3), RowH, nFsize, 2
                    .DrawText mvarPData.Data(pNo, "申請理由B"), dX(4) + 2, dY, ColW(4) - 2, RowH, nFsize, 0

                    .DrawText mvarPData.Data(pNo, "氏名A"), dX(5) + 1, dY, ColW(5) - 2, RowH, nFsize, 0
                    .DrawText StrConv(mvarPData.Data(pNo, "住所A"), vbNarrow), dX(5) + 1, dY + RowH * 3, ColW(5) - 2, RowH, nFsize - 1, 0
                    .DrawText IIf(Val(mvarPData.Data(pNo, "年齢A")) > 0, mvarPData.Data(pNo, "年齢A") & "歳", ""), dX(5) + 1, dY + RowH * 6, ColW(5) - 1, RowH, nFsize, 0
                    .DrawText Left(mvarPData.Data(pNo, "職業A"), 3), dX(5) + 12, dY + RowH * 6, ColW(5) - 13, RowH, nFsize
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo, "経営面積A")), 0), dX(6), dY, ColW(6) - 1, RowH, nFsize, 1
                    .DrawText mvarPData.Data(pNo, "申請理由A"), dX(7) + 2, dY, ColW(7) - 2, RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo, "備考"), dX(15) + 1, dY, ColW(15) - 1, RowH, nFsize
                End If

                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(8) + 2, dY, ColW(8), RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(8), dY, ColW(8) - 2, RowH, nFsize, 1
                    .TextOut FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(12) - 1, dY, nFsize, 1
                Else
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(8) + 1, dY, ColW(8) - 2, RowH, nFsize, 0
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 1), dX(9), dY, ColW(9), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 1), dX(10), dY, ColW(10), RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        .TextOut FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(12) - 1, dY, nFsize, 1, 0
                    End If
                End If
                
                If pSubNo = 0 Then
                    Select Case Val(mvarPData.Data(pNo, "法令"))
                        Case 30, 32
                            .TextOut "所有権移転", ColW(13) / 2 + dX(13), dY, nFsize, 2, 0
                        Case 31, 33
                            Select Case Val(mvarPData.Data(pNo, "権利種類"))
                                Case 1: .TextOut "賃借権設定", ColW(13) / 2 + dX(13), dY, nFsize, 2, 0
                                Case 2: .TextOut "使用貸借権", ColW(13) / 2 + dX(13), dY, nFsize, 2, 0
                            End Select
                            St = p期間設定(mvarPData.Data(pNo, "始期"), mvarPData.Data(pNo, "終期"), mvarPData.Data(pNo, "永久"), "GGGEE/MM/DD")
                            .DrawText St, dX(13), dY + RowH * 2, ColW(13), RowH, nFsize, 2, 0
                            If Val(mvarPData.Data(pNo, "期間")) <> 0 Then .DrawText Fnc.NullCast(mvarPData.Data(pNo, "期間"), ""), dX(14), dY + RowH * 3, ColW(14), 5, 11, 2, 0
                    End Select
                End If
                    
                If (pSubNo = pSubEnd) And Len(mvarPData.Data(pNo, "調査員")) Then
                    .DrawText "(" & mvarPData.Data(pNo, "調査員") & ")", dX(15) + 1, dY, ColW(13) - 2, RowH, nFsize - 2, 0
                End If

            Case "三股町"
                If (pSubNo = pSubStart) Then
                    .DrawText pNo, dX(0), dY + RowH * 1.5, ColW(0), RowH, nFsize, 2
                    St = Format(mvarPData.Data(pNo, "受付年月日"), "EEMMDD")
                    .DrawText Val(Left(St, 2)) & "\n・\n" & Val(MID(St, 3, 2)) & "\n・\n" & Val(MID(St, 5, 2)), dX(1), dY, ColW(1), 4, nFsize, 2
                    .TextOut Left(mvarPData.Data(pNo, "住所B"), 15), dX(3) + 1, dY, nFsize - 1, 0
                    .DotLine dX(3), dY - 1 + RowH, dX(4), dY - 1 + RowH, RGB(0, 0, 0)
                    .TextOut Left(mvarPData.Data(pNo, "氏名B"), 15), dX(3) + 1, dY + RowH, nFsize, 0
                    nWk(0) = Val(mvarPData.Data(pNo, "行政区IDB"))
                    If Val(nWk(0)) <> 0 Then
                        nWk(1) = nWk(0) \ 1000
                        nWk(2) = nWk(0) - (nWk(0) \ 1000) * 1000
                        St = "(" & CStr(nWk(1)) & "-" & Right("00" & CStr(nWk(2)), 2) & ")"
                        .TextOut St, dX(4) - 1, dY + RowH, nFsize, 1
                    End If
                    .DLine dX(3), dY - 1 + RowH * 2, dX(4), dY - 1 + RowH * 2, RGB(0, 0, 0)
                    .TextOut Left(mvarPData.Data(pNo, "住所A"), 15), dX(3) + 1, dY + RowH * 2, nFsize - 1, 0
                    .DotLine dX(3), dY - 1 + RowH * 3, dX(4), dY - 1 + RowH * 3, RGB(0, 0, 0)
                    .TextOut Left(mvarPData.Data(pNo, "氏名A"), 15), dX(3) + 1, dY + RowH * 3, nFsize, 0
                    nWk(0) = Val(mvarPData.Data(pNo, "行政区IDA"))
                    If Val(nWk(0)) <> 0 Then
                        nWk(1) = nWk(0) \ 1000
                        nWk(2) = nWk(0) - (nWk(0) \ 1000) * 1000
                        St = "(" & CStr(nWk(1)) & "-" & Right("00" & CStr(nWk(2)), 2) & ")"
                        .TextOut St, dX(4) - 1, dY + RowH * 3, nFsize, 1
                    End If
                    
                    .DrawText mvarPData.Data(pNo, "申請理由A"), dX(7) + 1, dY, ColW(7), RowH, nFsize, 0
                    St = ""
                    Select Case Val(mvarPData.Data(pNo, "法令"))
                        Case 30, 32: St = "所有権移転"
                        Case 31, 33:
                            Select Case Val(mvarPData.Data(pNo, "権利種類"))
                                Case 1: St = "賃借権"
                                Case 2: St = "使用貸借権"
                            End Select
                    End Select
                    .DrawText St, dX(8), dY, ColW(8), 4, nFsize, 2, 0

                    .DrawText mvarPData.Data(pNo, "世帯員数"), dX(9), dY, ColW(9), RowH, nFsize, 2
                    .DrawText mvarPData.Data(pNo, "稼動人数"), dX(10), dY, ColW(10), RowH, nFsize, 2
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo, "経営面積B")), 0), dX(11), dY, ColW(11) - 1, RowH, nFsize, 1
                End If

                 If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then      '合計行
                     .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(4), dY, ColW(4) - 5, RowH, nFsize, 1
                     .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(5), dY, ColW(5) - 1, RowH, nFsize, 1
                     .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(6), dY, ColW(6) - 1, RowH, nFsize, 1
                 Else
                     .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(4) + 1, dY, ColW(4), 4, nFsize, 0
                     .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 2), dX(5), dY, ColW(5), RowH, nFsize, 2
                     If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                         .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(6), dY, ColW(6) - 1, RowH, nFsize, 1
                     End If
                End If
            
            Case "日置市"
                If (pSubNo = pSubStart) Then
                    .TextOut mvarPData.Data(pNo, "受付番号"), (dX(1) - dX(0)) / 2 + dX(0), dY, nFsize, 2, 0
                    If Len(mvarPData.Data(pNo, "氏名B")) <= 16 Then
                        .DrawText mvarPData.Data(pNo, "氏名B"), dX(1) + 1, dY, ColW(1) - 1, RowH, nFsize, 0
                    ElseIf Len(mvarPData.Data(pNo, "氏名B")) <= 20 Then
                        .DrawText mvarPData.Data(pNo, "氏名B"), dX(1) + 1, dY, ColW(1) - 1, RowH - 1, nFsize - 2, 0
                    Else
                        .DrawText mvarPData.Data(pNo, "氏名B"), dX(1) + 1, dY, ColW(1) - 1, RowH - 2, nFsize - 4, 0
                    End If
                    If Len(mvarPData.Data(pNo, "住所B")) <= 16 Then
                        .DrawText StrConv(mvarPData.Data(pNo, "住所B"), vbNarrow), dX(1) + 1, dY + RowH * 2, ColW(1) - 1, RowH, nFsize - 1, 0
                    ElseIf Len(mvarPData.Data(pNo, "住所B")) <= 20 Then
                        .DrawText StrConv(mvarPData.Data(pNo, "住所B"), vbNarrow), dX(1) + 1, dY + RowH * 2, ColW(1) - 1, RowH - 1, nFsize - 2, 0
                    Else
                        .DrawText StrConv(mvarPData.Data(pNo, "住所B"), vbNarrow), dX(1) + 1, dY + RowH * 2, ColW(1) - 1, RowH - 2, nFsize - 4, 0
                    End If
                    .DrawText IIf(Val(mvarPData.Data(pNo, "年齢B")) <> 0, mvarPData.Data(pNo, "年齢B") & "歳", ""), dX(1) + 2, dY + RowH * 4, ColW(1) - 2, RowH, nFsize, 0
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo, "経営面積B")), 0), dX(2), dY, ColW(2) - 1, RowH, nFsize, 1
                    .DrawText mvarPData.Data(pNo, "稼動人数"), dX(3), dY, ColW(3), RowH, nFsize, 2
                    .DrawText mvarPData.Data(pNo, "申請理由B"), dX(4) + 2, dY, ColW(4) - 2, RowH, nFsize, 0

                    If Len(mvarPData.Data(pNo, "氏名A")) <= 12 Then
                        .DrawText mvarPData.Data(pNo, "氏名A"), dX(5) + 1, dY, ColW(5) - 1, RowH, nFsize, 0
                    Else
                        .DrawText mvarPData.Data(pNo, "氏名A"), dX(5) + 1, dY, ColW(5) - 1, RowH - 2, nFsize - 2, 0
                    End If
                    If Len(mvarPData.Data(pNo, "住所A")) <= 14 Then
                        .DrawText StrConv(mvarPData.Data(pNo, "住所A"), vbNarrow), dX(5) + 1, dY + RowH * 2, ColW(5) - 1, RowH, nFsize - 1, 0
                    Else
                        .DrawText StrConv(mvarPData.Data(pNo, "住所A"), vbNarrow), dX(5) + 1, dY + RowH * 2, ColW(5) - 1, RowH - 1.5, nFsize - 3, 0
                    End If
                    .DrawText IIf(Val(mvarPData.Data(pNo, "年齢A")) <> 0, mvarPData.Data(pNo, "年齢A") & "歳", ""), dX(5) + 2, dY + RowH * 4, ColW(5) - 2, RowH, nFsize, 0
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo, "経営面積A")), 0), dX(6), dY, ColW(6) - 1, RowH, nFsize, 1
                    .DrawText mvarPData.Data(pNo, "申請理由A"), dX(7) + 2, dY, ColW(7) - 2, RowH, nFsize, 0
                    
                    StX = mvarPData.Data(pNo, "調査員")
                    If InStr(StX, "\n") = 0 Then
                        St = "": i = 0
                        If Len(StX) > 0 Then
                            For n = Len(StX) To 0 Step (-4)
                                St = St & MID(StX, i * 4 + 1, 4) & "\n"
                                i = i + 1
                            Next
                            If Right(St, 2) = "\n" Then St = Left(St, Len(St) - 2)
                            .DrawText St, dX(15), dY, ColW(15), RowH, nFsize, 2
                        End If
                    Else
                        .DrawText StX, dX(15), dY, ColW(15), RowH, nFsize, 2
                    End If
                    
                    Select Case Val(mvarPData.Data(pNo, "法令"))
                        Case 30, 32
                            .TextOut "所有権移転", ColW(13) / 2 + dX(13), dY, nFsize, 2, 0
                        Case 31, 33
                            Select Case Val(mvarPData.Data(pNo, "権利種類"))
                                Case 1: .TextOut "賃借権設定", ColW(13) / 2 + dX(13), dY, nFsize, 2, 0
                                Case 2: .TextOut "使用貸借権", ColW(13) / 2 + dX(13), dY, nFsize, 2, 0
                            End Select
                            St = p期間設定(mvarPData.Data(pNo, "始期"), mvarPData.Data(pNo, "終期"), mvarPData.Data(pNo, "永久"), "GGGEE/MM/DD")
                            .DrawText St, dX(13), dY + 4, ColW(13), RowH, nFsize, 2, 0
                            If Val(mvarPData.Data(pNo, "期間")) <> 0 Then .DrawText Fnc.NullCast(mvarPData.Data(pNo, "期間"), ""), dX(14), dY + 8, ColW(14), 5, 11, 2, 0
                    End Select
                End If
                
                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(8) + 2, dY, ColW(8), RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(8), dY, ColW(8) - 2, RowH, nFsize, 1
                    .TextOut FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(12) - 1, dY, nFsize, 1
                Else
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(8) + 1, dY, ColW(8) - 2, RowH, nFsize, 0
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 1), dX(9), dY, ColW(9), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 1), dX(10), dY, ColW(10), RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        .TextOut FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(12) - 1, dY, nFsize, 1, 0
                    End If
                End If
                    
            Case "南種子町"
                Const nRowH = 4
                K = RowH * HMax / 2
                If (pSubNo = pSubStart) Then
                    .TextOut pNo, ColW(0) / 2 + dX(0), dY + K, nFsize, 2, 2
                    If Len(mvarPData.Data(pNo, "調査員")) Then .DrawText mvarPData.Data(pNo, "調査員"), dX(1), dY + K, ColW(1), nRowH, nFsize, 2, 2
                    .DrawText StrConv(mvarPData.Data(pNo, "住所B"), vbNarrow), dX(2) + 0.5, dY, ColW(2) - 1, nRowH, nFsize
                    .DrawText Left(mvarPData.Data(pNo, "氏名B"), 32), dX(2) + 1, dY + RowH * 2, ColW(2) - 1, nRowH, nFsize - IIf(Len(mvarPData.Data(pNo, "氏名B")) > 24, 2, 0)
                    .DrawText mvarPData.Data(pNo, "年齢B"), dX(3), dY, ColW(3), nRowH, nFsize, 2
                    If mvarPData.Data(pNo, "共有持分") = "0" And CBool(mvarPData.Data(pNo, "複数申請人A")) = False Then
                        .DrawText StrConv(mvarPData.Data(pNo, "住所A"), vbNarrow), dX(4) + 0.5, dY, ColW(4) - 1, nRowH, nFsize
                        .DrawText mvarPData.Data(pNo, "氏名A"), dX(5) + 1, dY, ColW(5) - 1, nRowH, nFsize - IIf(Len(mvarPData.Data(pNo, "氏名A")) > 12, 2, 0), 0, 0
                        .DrawText mvarPData.Data(pNo, "年齢A"), dX(6), dY, ColW(6), nRowH, nFsize, 2
                    End If
                    
                    .TextOut Replace(mvarPData.Data(pNo, "行政区B"), "-", ""), dX(2), dY + RowH * 3, nFsize
                    .TextOut Replace(mvarPData.Data(pNo, "行政区A"), "-", ""), dX(4), dY + RowH * 3, nFsize
                    
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo, "経営面積A")), 0), dX(12), dY, ColW(12) - 2, nRowH, nFsize, 1
                    .TextOut "(", dX(12) + 1, dY + RowH, nFsize
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo, "経営面積残A")), 0), dX(12), dY + RowH, ColW(12) - 2, nRowH, nFsize, 1
                    .TextOut ")", dX(13) - 2, dY + RowH, nFsize
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo, "経営面積B")), 0), dX(13), dY, ColW(13) - 2, nRowH, nFsize, 1
                    .TextOut "(", dX(13) + 1, dY + RowH, nFsize
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo, "経営面積残B")), 0), dX(13), dY + RowH, ColW(13) - 2, nRowH, nFsize, 1
                    .TextOut ")", dX(14) - 2, dY + RowH, nFsize
                    .DrawText Format(Val(mvarPData.Data(pNo, "稼動人数")), "#"), dX(14), dY, ColW(14), nRowH, nFsize, 2
                    .DrawText mvarPData.Data(pNo, "申請理由A"), dX(15) + 1, dY, ColW(15) - 1, nRowH, nFsize
                    .DrawText mvarPData.Data(pNo, "申請理由B"), dX(16) + 1, dY, ColW(16) - 1, nRowH, nFsize
                    .DrawText mvarPData.Data(pNo, "備考"), dX(17), dY, ColW(17), nRowH, nFsize - 1, 2
                End If
                
                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(7) + 2, dY + nRowH, ColW(7), nRowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(7), dY + nRowH, ColW(7) - 1, nRowH, nFsize, 1
                    .DrawText pFormatN(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積"))), dX(11), dY + nRowH, ColW(11) - 1, nRowH, nFsize, 1
                Else
                    If mvarPData.Data(pNo, "共有持分") = "1" Or CBool(mvarPData.Data(pNo, "複数申請人A")) Then
                        .DrawText StrConv(mvarPData.Data(pNo & ":農地." & pSubNo, "所有者住所"), vbNarrow), dX(4) + 0.5, dY, ColW(4) - 1, nRowH, nFsize
                        .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "所有者名"), dX(5) + 1, dY, ColW(5) - 2, nRowH, nFsize - IIf(Len(mvarPData.Data(pNo & ":農地." & pSubNo, "所有者名")) > 12, 2, 0), 0, 0
                        .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "所有者年齢"), dX(6), dY, ColW(6), nRowH, nFsize, 2
                    End If
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(7) + 1, dY, ColW(7) - 1, nRowH, nFsize
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "持分"), dX(8), dY, ColW(8), nRowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 4), dX(9), dY, ColW(9), nRowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 4), dX(10), dY, ColW(10), nRowH, nFsize, 2
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "登記面積")) <> 0 Then
                        .DrawText pFormatN(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "登記面積"))), dX(11), dY, ColW(11) - 1, nRowH, nFsize, 1
                        .DrawText "の内" & pFormatN(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積"))), dX(11), dY + nRowH, ColW(11) - 1, nRowH, nFsize, 1
                    ElseIf Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        .DrawText pFormatN(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積"))), dX(11), dY, ColW(11) - 1, nRowH, nFsize, 1
                    End If
                End If
                
            Case "大崎町"
                If pSubNo = pSubStart Then
                    .TextOut pNo, (dX(1) - dX(0)) / 2 + dX(0), dY, nFsize, 2, 0
                    .DrawText Left(mvarPData.Data(pNo, "氏名B"), 16), dX(1) + 1, dY, ColW(1) - 1, RowH, nFsize, 0
                    If Len(mvarPData.Data(pNo, "集落B")) = 0 Or mvarPData.Data(pNo, "集落B") = "-" Then
                        .DrawText Left(Fnc.GetShortAddress(mvarPData.Data(pNo, "住所B"), s都道府県名, s郡部, , , True), 16), dX(1) + 1, dY + RowH * 2, ColW(1) - 1, RowH, nFsize, 0
                    Else
                        .DrawText Left(mvarPData.Data(pNo, "集落B"), 16), dX(1) + 1, dY + RowH * 2, ColW(1) - 1, RowH, nFsize, 0
                    End If
                    .DrawText Left(mvarPData.Data(pNo, "職業B"), 6), dX(1) + 1, dY + RowH * 4, ColW(1) - 1, RowH, nFsize, 0
                    .DrawText IIf(Val(mvarPData.Data(pNo, "年齢B")) = 0, "", mvarPData.Data(pNo, "年齢B") & "歳"), dX(1), dY + RowH * 4, ColW(1) - 1, RowH, nFsize, 1
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo, "経営面積B")), 0), dX(2), dY, ColW(2) - 1, RowH, nFsize, 1
                    .DrawText mvarPData.Data(pNo, "稼動人数"), dX(3), dY, ColW(3), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo, "申請理由B"), 12), dX(4), dY, ColW(4), RowH, nFsize, 2

                    .DrawText Left(mvarPData.Data(pNo, "氏名A"), 16), dX(5) + 1, dY, ColW(5) - 1, RowH, nFsize, 0
                    If Len(mvarPData.Data(pNo, "集落A")) = 0 Or mvarPData.Data(pNo, "集落A") = "-" Then
                        .DrawText Left(Fnc.GetShortAddress(mvarPData.Data(pNo, "住所A"), s都道府県名, s郡部, , , True), 16), dX(5) + 1, dY + RowH * 2, ColW(5) - 1, RowH, nFsize, 0
                    Else
                        .DrawText Left(mvarPData.Data(pNo, "集落A"), 16), dX(5) + 1, dY + RowH * 2, ColW(5) - 1, RowH, nFsize, 0
                    End If
                    .DrawText Left(mvarPData.Data(pNo, "職業A"), 6), dX(5) + 1, dY + RowH * 4, ColW(5) - 1, RowH, nFsize
                    .DrawText IIf(Val(mvarPData.Data(pNo, "年齢A")) = 0, "", mvarPData.Data(pNo, "年齢A") & "歳"), dX(5), dY + RowH * 4, ColW(5) - 1, RowH, nFsize, 1
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo, "経営面積A")), 0), dX(6), dY, ColW(6) - 1, RowH, nFsize, 1
                    .DrawText Left(mvarPData.Data(pNo, "申請理由A"), 12), dX(7), dY, ColW(7), RowH, nFsize, 2
                                       
                    Select Case Val(mvarPData.Data(pNo, "法令"))
                        Case 30, 32: .TextOut "所有権移転", ColW(13) / 2 + dX(13), dY, nFsize, 2
                        Case 31, 33
                            Select Case Val(mvarPData.Data(pNo, "権利種類"))
                                Case 1: .TextOut "賃借権設定", ColW(13) / 2 + dX(13), dY, nFsize, 2
                                Case 2: .TextOut "使用貸借権", ColW(13) / 2 + dX(13), dY, nFsize, 2
                            End Select
                            If Val(mvarPData.Data(pNo, "期間")) > 0 Then .DrawText Fnc.NullCast(mvarPData.Data(pNo, "期間"), ""), dX(14), dY, ColW(14), RowH, nFsize, 2
                    End Select
                    If Len(mvarPData.Data(pNo, "小作料")) > 0 Then .DrawText mvarPData.Data(pNo, "小作料") & mvarPData.Data(pNo, "小作料単位"), dX(13), dY + RowH * 2, ColW(13), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo, "備考"), 25), dX(16) + 1, dY, ColW(16) - 1, RowH, nFsize
                End If
                    
                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(8) + 2, dY, ColW(8), RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(8), dY, ColW(8) - 2, RowH, nFsize, 1
                    .TextOut FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(12) - 1, dY, nFsize, 1
                ElseIf Val(mvarPData.Data(pNo & ":農地." & pSubNo, "一部")) = 1 Then
                    .TextOut "(" & FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0) & "の内)", dX(12) - 1, dY, nFsize - 2, 1
                Else
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(8) + 1, dY, ColW(8) - 2, RowH, nFsize, 0
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 1), dX(9), dY, ColW(9), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 1), dX(10), dY, ColW(10), RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        .TextOut FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(12) - 1, dY, nFsize, 1, 0
                    End If
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "農振区分"), dX(12), dY, ColW(12), RowH, nFsize, 2
               End If
            Case "阿久根市"
                If (pSubNo = pSubStart) Then
                    .TextOut pNo, (dX(1) - dX(0)) / 2 + dX(0), dY, nFsize, 2, 0
                    
'                    .DrawText Left(mvarPData.Data(pNo, "氏名B"), 27) & "\n\n" & Left(mvarPData.Data(pNo, "住所B"), 27), dX(1) + 1, dY, ColW(1) - 2, RowH, nFsize - 1, 0
                    .DrawText Left(mvarPData.Data(pNo, "氏名B"), 27) & "\n\n" & Left(Fnc.GetShortAddress(mvarPData.Data(pNo, "住所B"), s都道府県名, s郡部, , , True), 27), dX(1) + 1, dY, ColW(1) - 2, RowH, nFsize - 1, 0
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo, "経営面積B")), 0), dX(2), dY, ColW(2) - 1, RowH, nFsize, 1
                    .DrawText mvarPData.Data(pNo, "申請理由B"), dX(4) + 2, dY, ColW(4) - 2, RowH, nFsize, 0

                    .DrawText Left(mvarPData.Data(pNo, "氏名A"), 27) & "\n\n" & Left(Fnc.GetShortAddress(mvarPData.Data(pNo, "住所A"), s都道府県名, s郡部, , , True), 21), dX(5) + 1, dY, ColW(5) - 2, RowH, nFsize - 1, 0
'                    .DrawText Left(mvarPData.Data(pNo, "氏名A"), 27) & "\n\n" & Left(mvarPData.Data(pNo, "住所A"), 21), dX(5) + 1, dY, ColW(5) - 2, RowH, nFsize - 1, 0
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo, "経営面積A")), 0), dX(6), dY, ColW(6) - 1, RowH, nFsize, 1
                    .DrawText mvarPData.Data(pNo, "申請理由A"), dX(7) + 2, dY, ColW(7) - 2, RowH, nFsize, 0
                    
                    '.TextOut mvarPData.Data(pNo, "備考"), ColW(15) / 2 + dX(15), dY, nFsize, 2, 0
                    .DrawText mvarPData.Data(pNo, "備考"), dX(15) + 1, dY, ColW(15), RowH, 10, 0
                End If
                    
                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(8) + 2, dY, ColW(8), RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(8), dY, ColW(8) - 2, RowH, nFsize, 1
                    .TextOut FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(12) - 1, dY, nFsize, 1
                Else
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(8) + 1, dY, ColW(8) - 2, RowH, nFsize, 0
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 3), dX(9), dY, ColW(9), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 3), dX(10), dY, ColW(10), RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        .TextOut FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(12) - 1, dY, nFsize, 1, 0
                    End If
                    If pSubNo = 0 Then
                        Select Case Val(mvarPData.Data(pNo, "権利種類"))
                            Case 1: St = "賃借権"
                            Case 2: St = "使用貸借権"
                            Case Else: St = "所有権移転"
                        End Select
                        .TextOut St, ColW(13) / 2 + dX(13), dY, nFsize, 2, 0
                    End If
                End If
                                       
            Case "長島町"
                If (pSubNo = pSubStart) Then
                    .TextOut pNo, (dX(1) - dX(0)) / 2 + dX(0), dY, nFsize, 2, 0
                    
                    .DrawText Left(mvarPData.Data(pNo, "氏名B"), 27) & "\n" & Left(Fnc.GetShortAddress(mvarPData.Data(pNo, "住所B"), s都道府県名, s郡部, , , True), 27), dX(1) + 1, dY, ColW(1) - 2, RowH, nFsize - 1, 0
'                    .DrawText Fnc.GetShortAddress(mvarPData.Data(pNo, "住所B"), s都道府県名, s郡部, , , True), dX(1) + 1, dY + RowH * 2, ColW(1) - 2, RowH, nFsize - 1, 0
                    
                    '.DrawText Left(mvarPData.Data(pNo, "住所B"), 27), dX(1) + 1, dY + RowH, ColW(1) - 2, RowH, nFsize - 1, 0
                    .DrawText Left(mvarPData.Data(pNo, "職業B"), 8), dX(1) + 1, dY + RowH * 4, ColW(1) - 2, RowH, nFsize, 0
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo, "経営面積B")), 0), dX(2), dY, ColW(2) - 1, RowH, nFsize, 1
                    .DrawText mvarPData.Data(pNo, "稼動人数"), dX(3), dY, ColW(3), RowH, nFsize, 2
                    .DrawText mvarPData.Data(pNo, "申請理由B"), dX(4) + 2, dY, ColW(4) - 2, RowH, nFsize, 0

                    .DrawText Left(mvarPData.Data(pNo, "氏名A"), 27) & "\n" & Left(mvarPData.Data(pNo, "住所A"), 21), dX(5) + 1, dY, ColW(5) - 2, RowH, nFsize - 1, 0
                    '.DrawText Left(mvarPData.Data(pNo, "住所A"), 21), dX(5) + 1, dY + RowH, ColW(5) - 2, RowH, nFsize - 1, 0
                    .DrawText Left(mvarPData.Data(pNo, "職業A"), 6), dX(5) + 1, dY + RowH * 4, ColW(5) - 2, RowH, nFsize, 0
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo, "経営面積A")), 0), dX(6), dY, ColW(6) - 1, RowH, nFsize, 1
                    .DrawText mvarPData.Data(pNo, "申請理由A"), dX(7) + 2, dY, ColW(7) - 2, RowH, nFsize, 0
                    
                    '.TextOut mvarPData.Data(pNo, "備考"), ColW(15) / 2 + dX(15), dY, nFsize, 2, 0
                    .DrawText mvarPData.Data(pNo, "備考"), dX(15) + 1, dY, ColW(15), RowH, 10, 0
                End If
                    
                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(8) + 2, dY, ColW(8), RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(8), dY, ColW(8) - 2, RowH, nFsize, 1
                    .TextOut FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(12) - 1, dY, nFsize, 1
                Else
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(8) + 1, dY, ColW(8) - 2, RowH, nFsize, 0
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 1), dX(9), dY, ColW(9), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 1), dX(10), dY, ColW(10), RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        .TextOut FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(12) - 1, dY, nFsize, 1, 0
                    End If
                    If pSubNo = 0 Then
                        Select Case Val(mvarPData.Data(pNo, "権利種類"))
                            Case 1: St = "賃借権"
                            Case 2: St = "使用貸借権"
                            Case Else: St = "所有権移転"
                        End Select
                        .TextOut St, ColW(13) / 2 + dX(13), dY, nFsize, 2, 0
                    End If
                End If
            
            Case Else
                If (pSubNo = pSubStart) Then
                    .TextOut pNo, (dX(1) - dX(0)) / 2 + dX(0), dY, nFsize, 2, 0
                    
                    .DrawText Left(mvarPData.Data(pNo, "氏名B"), 27) & "\n" & Left(mvarPData.Data(pNo, "住所B"), 27), dX(1) + 1, dY, ColW(1) - 2, RowH, nFsize - 1, 0
                    '.DrawText Left(mvarPData.Data(pNo, "住所B"), 27), dX(1) + 1, dY + RowH, ColW(1) - 2, RowH, nFsize - 1, 0
                    .DrawText Left(mvarPData.Data(pNo, "職業B"), 8), dX(1) + 1, dY + RowH * 4, ColW(1) - 2, RowH, nFsize, 0
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo, "経営面積B")), 0), dX(2), dY, ColW(2) - 1, RowH, nFsize, 1
                    .DrawText mvarPData.Data(pNo, "稼動人数"), dX(3), dY, ColW(3), RowH, nFsize, 2
                    .DrawText mvarPData.Data(pNo, "申請理由B"), dX(4) + 2, dY, ColW(4) - 2, RowH, nFsize, 0

                    .DrawText Left(mvarPData.Data(pNo, "氏名A"), 27) & "\n" & Left(mvarPData.Data(pNo, "住所A"), 21), dX(5) + 1, dY, ColW(5) - 2, RowH, nFsize - 1, 0
                    '.DrawText Left(mvarPData.Data(pNo, "住所A"), 21), dX(5) + 1, dY + RowH, ColW(5) - 2, RowH, nFsize - 1, 0
                    .DrawText Left(mvarPData.Data(pNo, "職業A"), 6), dX(5) + 1, dY + RowH * 4, ColW(5) - 2, RowH, nFsize, 0
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo, "経営面積A")), 0), dX(6), dY, ColW(6) - 1, RowH, nFsize, 1
                    .DrawText mvarPData.Data(pNo, "申請理由A"), dX(7) + 2, dY, ColW(7) - 2, RowH, nFsize, 0
                    
                    '.TextOut mvarPData.Data(pNo, "備考"), ColW(15) / 2 + dX(15), dY, nFsize, 2, 0
                    .DrawText mvarPData.Data(pNo, "備考"), dX(15) + 1, dY, ColW(15), RowH, 10, 0
                End If
                    
                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(8) + 2, dY, ColW(8), RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(8), dY, ColW(8) - 2, RowH, nFsize, 1
                    .TextOut FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(12) - 1, dY, nFsize, 1
                Else
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(8) + 1, dY, ColW(8) - 2, RowH, nFsize, 0
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 1), dX(9), dY, ColW(9), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 1), dX(10), dY, ColW(10), RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        .TextOut FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(12) - 1, dY, nFsize, 1, 0
                    End If
                    If pSubNo = 0 Then
                        Select Case Val(mvarPData.Data(pNo, "権利種類"))
                            Case 1: St = "賃借権"
                            Case 2: St = "使用貸借権"
                            Case Else: St = "所有権移転"
                        End Select
                        .TextOut St, ColW(13) / 2 + dX(13), dY, nFsize, 2, 0
                    End If
                End If

            End Select
        End With
    End Sub
    
    Private Sub PrintSubTotal(ByRef mvarParent As ADBasicLIB2.CPrintFormSK, ByRef dX() As Single, dY As Single)
        Dim n As Long
        Dim wdy As Single
        Dim Xcnt As Long
        
        If T総合計.n筆数(3) = 0 Then Exit Sub
        wdy = dY
        Xcnt = UBound(ColW) + 1
                
        With mvarParent
            Select Case Fnc.s市町村名
            Case "姶良市"
                For n = 0 To 3
                    If T総合計.n筆数(n) > 0 Then
                        .DrawText T総合計.s地目(n), dX(8) + 2, dY, ColW(8), RowH, nFsize
                        .DrawText T総合計.n筆数(n) & " 筆", dX(8), dY, ColW(8) - 2, RowH, nFsize, 1
                        .TextOut FormatNumber(Val(T総合計.n面積(n)), 0), dX(12) - 1, dY, nFsize, 1
                        dY = dY + RowH
                    End If
                Next
                .DrawText "［　総　合　計　］", dX(0), wdy + (dY - wdy) / 2, dX(8) - dX(0), RowH, nFsize, 2, 2
                .DLine dX(0), wdy - 1, dX(0), dY
                .DLine dX(8), wdy - 1, dX(8), dY
                .DLine dX(9), wdy - 1, dX(9), dY
                .DLine dX(12), wdy - 1, dX(12), dY
                .DLine dX(Xcnt), wdy - 1, dX(Xcnt), dY
                .DLine dX(0), dY, dX(Xcnt), dY
            
            Case "南種子町"
                .TextOut "※経営面積の（ ）内は、議決後の面積", dX(0) + 3, dY + 3
            End Select
        End With
    End Sub
    
    Private Sub Class_Initialize()
        Dim n As Long
        
        Set mvarPData = New CPrintDatas
        mvarPData.Headers = _
        "法令;受付番号;通年受付番号;受付年月日;受付補助記号;" & _
        "氏名B;住所B;申請世帯B;集落B;年齢B;職業B;行政区IDB;行政区B;経営面積B;稼動人数;稼動男数;稼動女数;申請理由B;世帯員数;" & _
        "自作田面積;自作畑面積;小作田面積;小作畑面積;農機1;農機2;農機3;農機4;主要家畜1;主要家畜2;" & _
        "氏名A;住所A;申請世帯A;集落A;年齢A;職業A;行政区IDA;行政区A;経営面積A;申請理由A;経営面積残A;経営面積残B;複数申請人A;" & _
        "小作料;小作料単位;始期;終期;期間;永久;権利種類;調査員;対価;番号;同;備考;共有持分;" & _
        ">農地;土地所在;登記地目;現況地目;面積;農振区分;等級;持分;所有者名;所有者住所;所有者年齢;一部;線;登記面積;"
        
        For n = 0 To PGMAX
            PgChgSt(n) = 0
            PgChgEn(n) = 0
        Next
        DataCnt = 0
        PageCnt = 0
        PageMax = 0
        PageNow = 1
        s支所 = ""
        
        For n = 0 To 3
            T総合計.s地目(n) = ""
            T総合計.n筆数(n) = 0
            T総合計.n面積(n) = 0
        Next
        
        Set mvarXMLData = New CXMLDoc
        
    End Sub
    
    Private Sub CPrintSub_SetRsData(pRs As Object)
        On Error Resume Next
        
        mvarXMLData.Root.AppendAttributes "議案書3条タイトル", SystemDB.DBProperty("議案書3条タイトル")
        
        Select Case Fnc.s市町村名
            Case "姶良市"
                HMax = 7        '基本データMAX
                LMax = 27       '１ページの行数
                StartX = 8
                StartY = 48
                nFsize = 11
                RowH = 5
                ColW = GetArray(8, 35, 15, 6, 11, 35, 15, 11, 56, 5, 5, 20, 22, 7, 24)

            Case "枕崎市"
                HMax = 3        '基本データMAX
                LMax = 28       '１ページの行数
                StartX = 20
                StartY = 64
                nFsize = 11
                RowH = 5
                ColW = GetArray(10, 60, 10, 10, 30, 35, 35, 40, 30)
            
            Case "南種子町"
                HMax = 4        '基本データMAX
                LMax = 18       '１ページの行数
                StartX = 15
                StartY = 40
                nFsize = 9
                RowH = 8
                ColW = GetArray(8, 10, 22, 6, 22, 22, 6, 36, 8, 8, 8, 20, 16, 16, 7, 15, 15, 24)
       
            Case "さつま町"
                HMax = 7        '基本データMAX
                LMax = 28       '１ページの行数
                StartX = 21
                StartY = 48
                nFsize = 11
                RowH = 5
                ColW = GetArray(6, 35, 15, 6, 13, 27, 15, 13, 47, 5, 5, 13, 5, 25, 9, 24)
           
            Case "三股町"
                HMax = 4        '基本データMAX
                LMax = 20       '１ページの行数
                StartX = 20
                StartY = 60
                nFsize = 11
                RowH = 6
                ColW = GetArray(9, 9, 7, 55, 48, 10, 16, 22, 6, 6, 6, 17, 10, 12, 10, 16)
           
            Case "日置市"
                HMax = 5        '基本データMAX
                LMax = 26       '１ページの行数
                StartX = 10
                StartY = 48
                nFsize = 11
                RowH = 5
                ColW = GetArray(6, 35, 15, 6, 13, 27, 15, 13, 58, 5, 5, 13, 5, 25, 9, 24)
               
            Case "大崎町"
                HMax = 5        '基本データMAX
                LMax = 30       '１ページの行数
                StartX = 12
                StartY = 49
                nFsize = 10
                RowH = 4
                ColW = GetArray(6, 30, 15, 6, 10, 30, 15, 10, 47, 5, 5, 16, 10, 26, 7, 7, 20)
            
            Case "阿久根市"
                HMax = 5        '基本データMAX
                LMax = 30       '１ページの行数
                StartX = 21
                StartY = 48
                nFsize = 11
                RowH = 5
                ColW = GetArray(6, 35, 15, 0, 13, 27, 15, 13, 47, 5, 5, 19, 5, 25, 9, 24)
                pTableSize.StartX = 21
                pTableSize.SetWidth 6, 35, 15, 0, 13, 27, 15, 13, 47, 5, 5, 19, 5, 25, 9, 24
            Case Else
                HMax = 5        '基本データMAX
                LMax = 30       '１ページの行数
                StartX = 21
                StartY = 48
                nFsize = 11
                RowH = 5
                ColW = GetArray(6, 35, 15, 6, 13, 27, 15, 13, 47, 5, 5, 13, 5, 25, 9, 24)
         End Select
        
        ' データ作成
        SetData pRs
    End Sub
    
    Private Sub CPrintSub_SetData(ByVal sKey As String, Optional ByVal sParam1 As String = "", Optional ByVal sParam2 As String = "")
        Debug.Assert False
    End Sub

    Private Sub SetData(pRs As Object)
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim RsT As ADBasicLIB2.RecordsetEx
        Dim RsA As ADBasicLIB2.RecordsetEx
        Dim St As String
        Dim sSQL As String
        Dim n As Long, nWork As Long
        Dim i As Long
        Dim nFlag(3) As Integer
        Dim W As Long
        Dim nSubCount As Long
        Dim n面積 As Double
        Dim n集計面積 As Double
        Dim n部分面積 As Double
        Dim n世帯ID As Long
        Dim n地目区分 As Long
        Dim p合計 As TotalData
        Dim s氏名A As String
        Dim s氏名B As String
        Dim n所有者 As Long
        Dim n分母(3) As Long
        Dim n分子(3) As Long
        Dim n経営面積A As Double
        Dim Ar As Variant, Cm As Variant
        Dim b支所 As Boolean
        Dim b支所改頁 As Boolean
        Dim b一部現況 As Boolean
        Dim n所有者住所 As String
        Dim n所有者筆 As Long
        Dim ErrStr As String

'        On Error Resume Next
        On Error GoTo Er_Ext
        Ar = Split(mvarData, vbCrLf)
        Cm = Split(Ar(1), ";")
        s都道府県名 = Cm(0)
        s郡部 = Cm(1)
        If Cm(2) = "" Then b支所改頁 = False Else b支所改頁 = CBool(Cm(2))
        If Cm(3) = "" Then b支所 = False Else b支所 = CBool(Cm(3))

        T総合計.s地目(0) = "( 田 )"
        T総合計.s地目(1) = "( 畑 )"
        T総合計.s地目(2) = "( 他 )"
        T総合計.s地目(3) = "( 計 )"

        For n = 0 To 3
            n分母(n) = 0
            n分子(n) = 0
        Next
        b一部現況 = False

        Select Case Fnc.s市町村名
            Case "姶良市", "大崎町": b一部現況 = True
        End Select

        ' データ作成
    ErrStr = "データセット開始"
        With mvarPData
            Set Rs = pRs
            n = .NewLine
            If b支所改頁 And (s支所 <> Rs.Value("受付補助記号")) Then DataCnt = LMax

            .SetRsData n, "法令", Rs
            .SetRsData n, "受付番号", Rs

            If b支所 Then
                .Data(n, "受付補助記号") = SystemDB.GetDirectDataWithClass("M_BASICALL", "名称", "支所番号", Rs.Value("支所番号"))
            Else
                .Data(n, "受付補助記号") = Rs.NullCast("受付補助記号", "")
            End If
            .SetRsData n, "通年受付番号", Rs
            .SetRsData n, "受付年月日", Rs
            .SetRsData n, "小作料", Rs
            .SetRsData n, "小作料単位", Rs
            .SetRsData n, "備考", Rs

            If Rs.Value("永久") Then
                .Data(n, "期間") = 0
            ElseIf (Not Rs.IsNull("期間")) And (Rs.Value("期間") <> 0) Then
                .SetRsData n, "期間", Rs
            ElseIf IsDate(Rs.Value("始期")) And IsDate(Rs.Value("終期")) Then
                .Data(n, "期間") = DateDiff("yyyy", Rs.Value("始期"), Rs.Value("終期"))
            Else
                .Data(n, "期間") = 0
            End If
            .Data(n, "始期") = IIf(Rs.IsNull("始期") Or Rs.Value("始期") = "0:00:00", "", Rs.Value("始期"))
            .Data(n, "終期") = IIf(Rs.IsNull("終期") Or Rs.Value("終期") = "0:00:00", "", Rs.Value("終期"))
            .Data(n, "永久") = IIf(Rs.Value("永久"), "1", "0")

    ErrStr = "データセット（氏名B）"
            .SetRsData n, "権利種類", Rs
            .SetRsData n, "住所B", Rs
            .SetRsData n, "集落B", Rs
            .SetRsData n, "申請世帯A", Rs
            .SetRsData n, "申請世帯B", Rs
            .Data(n, "年齢B") = IIf(Rs.Value("年齢B") = 0 Or Rs.IsNull("年齢B"), "", Rs.Value("年齢B"))
            .SetRsData n, "職業B", Rs
            .SetRsData n, "経営面積B", Rs
            .SetRsData n, "稼動人数", Rs
            .SetRsData n, "稼動男数", Rs, "働手男数B"
            .SetRsData n, "稼動女数", Rs, "働手女数B"
            .SetRsData n, "申請理由B", Rs
            .SetRsData n, "世帯員数", Rs, "世帯員数B"

            s氏名B = ""
            If (Not Rs.IsNull("氏名B")) And (Rs.Value("氏名B") <> "") And (Not IsNull(Rs.Value("集落B"))) And (Rs.Value("集落B") <> "") Then
                .SetRsData n, "氏名B", Rs
                .SetRsData n, "行政区B", Rs, "集落B"
                s氏名B = Rs.Value("氏名B")
            Else
                Set RsA = SystemDB.GetRecordsetEx("SELECT [D:個人Info].氏名,[D:個人Info].行政区ID,[V_行政区].行政区 FROM [D:個人Info] LEFT JOIN [V_行政区] ON [D:個人Info].行政区ID = [V_行政区].ID WHERE [D:個人Info].[ID]=" & Rs.Value("申請者B"), 0, , "議案書")
                If Not RsA.EOF Then
                    .SetRsData n, "氏名B", RsA, "氏名"
                    .SetRsData n, "行政区IDB", RsA, "行政区ID"
                    .SetRsData n, "行政区B", RsA, "行政区"
                    s氏名B = Fnc.NullCast(RsA.Value("氏名"), "")
                End If
                SystemDB.CloseRs RsA
            End If
            If s氏名B <> "" And p経営面積B.Exists(s氏名B) = False Then
                p経営面積B.Add s氏名B, Rs.NullCast("経営面積B", 0)
            End If

    ErrStr = "データセット（氏名A）"
            s氏名A = ""
            If (Not Rs.IsNull("代理人名")) And (Rs.Value("代理人名") <> "") Then
                .SetRsData n, "氏名A", Rs, "代理人名"
                s氏名A = Rs.Value("代理人名")
            ElseIf (Not Rs.IsNull("氏名A")) And (Rs.Value("氏名A") <> "") Then
                .SetRsData n, "氏名A", Rs, "氏名A"
                s氏名A = Rs.Value("氏名A")
            ElseIf (Not Rs.IsNull("参照A")) And (Rs.Value("参照A") <> "") Then
                .SetRsData n, "氏名A", Rs, "参照A"
                s氏名A = Rs.Value("参照A")
            End If
            .SetRsData n, "行政区A", Rs, "集落A"
            .SetRsData n, "行政区IDA", Rs, "参照集落IDA"
            .SetRsDataList n, "住所A;集落A;年齢A;職業A;経営面積A;申請理由A;備考;複数申請人A", Rs
            .Data(n, "共有持分") = 0

            If Fnc.s市町村名 = "南種子町" Then
                .SetRsData n, "調査員", Rs, "調査員A"
            ElseIf Not Rs.IsNull("調査員A") Then
                .Data(n, "調査員") = Replace(Replace(StrConv(Rs.Value("調査員A"), vbNarrow), ",", "\n"), "､", "\n")
            End If

            .Data(n, "対価") = IIf(IsNull(Rs.Value("小作料")) Or Rs.Value("小作料") = 0, "", Rs.Value("小作料") & Rs.NullCast("小作料単位", ""))

            For W = 0 To 3
                p合計.n面積(W) = 0
                p合計.n筆数(W) = 0
                nFlag(W) = 0
            Next
            n所有者 = 0: n所有者住所 = 0: n所有者筆 = 0
            n経営面積A = 0
            i = 0

    ErrStr = "データセット（農地リスト作成）"
            St = Replace(Replace(Rs.NullCast("農地リスト", ""), "農地.", ""), ";", ",")
            If Len(St) Then
                sSQL = "SELECT [V_農地].*,[V_地目].名称 AS [登記地目],[地目2].名称 AS [現況],[V_農委地目].名称 AS [農委地目],[D:個人Info].氏名 AS [所有者名],[D:個人Info].住所 AS [所有者住所],[D:個人Info].生年月日, [D_部分申請].部分面積 AS [部分面積T],[面積変動の有無] "
                sSQL = sSQL & "FROM ((((([V_農地] LEFT JOIN [V_地目] ON [V_農地].[登記簿地目]=[V_地目].ID) LEFT JOIN V_現況地目 AS 地目2 ON [V_農地].[現況地目]=[地目2].ID) LEFT JOIN [V_農委地目] ON [V_農地].[農委地目ID]=[V_農委地目].ID) LEFT JOIN [D:個人Info] ON [V_農地].[管理人ID]=[D:個人Info].ID) LEFT JOIN [D_部分申請] ON [V_農地].ID = [D_部分申請].農地ID) LEFT JOIN [wk申請補助] ON [V_農地].ID = [wk申請補助].農地ID "
                sSQL = sSQL & "WHERE (([wk申請補助].[申請ID]=" & Rs.ID & ") OR ([wk申請補助].[申請ID] IS NULL) OR (wk申請補助.申請ID)=-1) AND (([V_農地].[ID]) IN (" & St & ")) "
                If Fnc.s市町村名 = "姶良市" Then
                    sSQL = sSQL & "ORDER BY [V_農地].[大字ID],[V_農地].[小字ID],val(IIf(IsNull([地番]),0,IIf(InStr([地番],'-')=0,Val([地番]),val(Left([地番],InStr([地番],'-')-1)))) *1000 + Val(IIf(IsNull([地番]),0,IIf(InStr([地番],'-')=0,0,val(Mid([地番],InStr([地番],'-')+1))))))"
                Else
                    sSQL = sSQL & "ORDER BY [V_農地].[管理人ID],[V_農地].[土地所在];"
                End If

                Set RsT = SystemDB.GetRecordsetEx(sSQL, 1, , "議案書")
                Do Until RsT.EOF
                    i = i + 1
                    If i > 1 Then .Data(n & ":農地." & i, "線") = 0
                    If n所有者 <> RsT.Value("管理人ID") Then
                        If Fnc.s市町村名 = "姶良市" And n所有者 <> 0 And Rs.Value("複数申請人A") Then
                            i = i + 1: .Data(n & ":農地." & i, "土地所在") = "": .Data(n & ":農地." & i, "線") = 0
                            i = i + 1: .Data(n & ":農地." & i, "土地所在") = "": .Data(n & ":農地." & i, "線") = 1
                        ElseIf Fnc.s市町村名 = "南種子町" And n所有者 <> 0 Then
                            ' 譲渡人複数印刷の時の住所行数設定（住所枠 半角14文字）
                            W = (i - n所有者筆) * 14
                            If n所有者住所 > W Then
                                W = n所有者住所 - W
                                Do While W > 0
                                    .Data(n & ":農地." & i, "土地所在") = ""
                                    i = i + 1
                                    W = W - 14
                                Loop
                            End If
                        End If
                        .SetRsData n & ":農地." & i, "所有者名", RsT
                        .SetRsData n & ":農地." & i, "所有者住所", RsT
                        If RsT.IsNull("生年月日") Or RsT.Value("生年月日") = "0:00:00" Then
                            .Data(n & ":農地." & i, "所有者年齢") = ""
                        Else
                            .Data(n & ":農地." & i, "所有者年齢") = Fnc.年齢計算(RsT.Value("生年月日"))
                        End If
                        n所有者 = RsT.Value("管理人ID")
                        n所有者住所 = pLen(StrConv(RsT.Value("所有者住所"), vbNarrow))  '南種子用
                        n所有者筆 = i                                                  ' 南種子用
                    End If
                    
                    .SetRsData n & ":農地." & i, "土地所在", RsT
                    .SetRsData n & ":農地." & i, "登記地目", RsT

                    If (Not RsT.IsNull("農委地目ID")) And (RsT.Value("農委地目ID") <> 0) And (Not RsT.IsNull("農委地目認定日")) And (RsT.Value("農委地目認定日") <> "0:00:00") Then
                        .SetRsData n & ":農地." & i, "現況地目", RsT, "農委地目"
                    Else
                        .SetRsData n & ":農地." & i, "現況地目", RsT, "現況"
                    End If

                    Select Case RsT.Value("農業振興地域")
                        Case 1:    .Data(n & ":農地." & i, "農振区分") = "地内"
                        Case 2:    .Data(n & ":農地." & i, "農振区分") = "振外"
                        Case Else: .Data(n & ":農地." & i, "農振区分") = "地外"
                    End Select
                    .SetRsData n & ":農地." & i, "等級", RsT

                    n部分面積 = 0
                    If Not RsT.IsNull("部分面積T") Then n部分面積 = RsT.Value("部分面積T")

                    n地目区分 = 2                   '他
                    n面積 = 0
                    If RsT.Value("田面積") <> 0 Then
                        n面積 = RsT.Value("田面積")
                        n地目区分 = 0               '田
                    ElseIf RsT.Value("畑面積") <> 0 Then
                        n面積 = RsT.Value("畑面積")
                        n地目区分 = 1               '畑
                    Else
                        If RsT.Value("樹園地") <> 0 Then n面積 = RsT.Value("樹園地")
                        If RsT.Value("採草放牧面積") <> 0 Then n面積 = RsT.Value("採草放牧面積")
                    End If
                    If n面積 = 0 Or Fnc.s市町村名 = "南種子町" Then n面積 = Fnc.NullCast(RsT.Value("登記簿面積"), 0)
                    n集計面積 = n面積

                    If n部分面積 > 0 Then
                        If Fnc.s市町村名 = "南種子町" Then
                            .Data(n & ":農地." & i, "登記面積") = n集計面積
                        End If
                        n集計面積 = n部分面積
                    End If
                    If Fnc.s市町村名 <> "南種子町" Then n集計面積 = Fix(n集計面積)
                    .Data(n & ":農地." & i, "面積") = n集計面積

                    .Data(n & ":農地." & i, "一部") = 0
                    If RsT.IsNull("一部現況") Then
                    ElseIf b一部現況 And Val(RsT.Value("一部現況")) > 0 Then
                        i = i + 1
                        .Data(n & ":農地." & i, "面積") = Fix(Fnc.NullCast(RsT.Value("登記簿面積"), 0))
                        .Data(n & ":農地." & i, "一部") = 1
                    End If

                    If Not RsT.IsNull("共有持分分母") And RsT.Value("共有持分分母") <> 0 Then
                        If n分子(n地目区分) = 0 And n分母(n地目区分) = 0 Then
                            n分子(n地目区分) = RsT.Value("共有持分分子")
                            n分母(n地目区分) = RsT.Value("共有持分分母")
                        Else
                            n分子(n地目区分) = n分子(n地目区分) * RsT.Value("共有持分分母")
                            n分子(n地目区分) = n分子(n地目区分) + RsT.Value("共有持分分子") * n分母(n地目区分)
                            n分母(n地目区分) = n分母(n地目区分) * RsT.Value("共有持分分母")
                        End If
                    Else
                        If n分子(n地目区分) = 0 And n分母(n地目区分) = 0 Then
                            n分子(n地目区分) = 1
                            n分母(n地目区分) = 1
                        Else
                            n分子(n地目区分) = n分子(n地目区分) + n分母(n地目区分)
                        End If
                    End If
                    p合計.n面積(n地目区分) = p合計.n面積(n地目区分) + n集計面積
                    nFlag(n地目区分) = 1

                    If Not RsT.IsNull("共有持分分母") And RsT.Value("共有持分分母") <> 0 Then
                        .Data(n & ":農地." & i, "持分") = RsT.Value("共有持分分子") & "/" & RsT.Value("共有持分分母")
                        .Data(n, "共有持分") = 1
    '                        If s氏名A = RsT.Value("所有者名") Then n経営面積A = n経営面積A + n集計面積
                        If s氏名A = RsT.Value("所有者名") Then n経営面積A = n経営面積A + IIf(RsT.V("面積変動の有無") = True, 0, n集計面積)
                    Else
    '                        n経営面積A = n経営面積A + n集計面積
                        n経営面積A = n経営面積A + IIf(RsT.V("面積変動の有無") = True, 0, n集計面積)
                    End If
                    
                    If s氏名B <> "" And Rs.V("申請世帯A") = 0 And Rs.V("申請世帯B") = 0 Then
    '                        p経営面積B.Item(s氏名B) = p経営面積B.Item(s氏名B) + n集計面積
                        p経営面積B.Item(s氏名B) = p経営面積B.Item(s氏名B) + IIf(RsT.V("面積変動の有無") = True, 0, n集計面積)
                    ElseIf s氏名B <> "" And Rs.V("申請世帯A") <> Rs.V("申請世帯B") Then
    '                        p経営面積B.Item(s氏名B) = p経営面積B.Item(s氏名B) + n集計面積
                        p経営面積B.Item(s氏名B) = p経営面積B.Item(s氏名B) + IIf(RsT.V("面積変動の有無") = True, 0, n集計面積)
                    End If
                    
                    RsT.MoveNext
                Loop
                If Rs.Value("複数申請人A") Then
                    i = i + 1: .Data(n & ":農地." & i, "土地所在") = ""
                    i = i + 1: .Data(n & ":農地." & i, "土地所在") = ""
                End If
                SystemDB.CloseRs RsT
            End If
            For W = 0 To 2
                If nFlag(W) = 1 Then
                    p合計.n筆数(W) = n分子(W) \ n分母(W)
                    n分子(W) = n分子(W) Mod n分母(W)
                End If
            Next

            s支所 = Rs.NullCast("受付補助記号", "")

            ' 合計行作成
            p合計.n筆数(3) = p合計.n筆数(0) + p合計.n筆数(1) + p合計.n筆数(2)
            p合計.n面積(3) = p合計.n面積(0) + p合計.n面積(1) + p合計.n面積(2)
            nFlag(3) = nFlag(0) + nFlag(1) + nFlag(2)

            If p経営面積A.Exists(s氏名A) = False Then
                W = Rs.NullCast("経営面積A", 0)
                p経営面積A.Add s氏名A, W
            End If
            
            If p経営面積A.Item(s氏名A) <> 0 And Rs.V("申請世帯A") = 0 And Rs.V("申請世帯B") = 0 Then
                p経営面積A.Item(s氏名A) = p経営面積A.Item(s氏名A) - n経営面積A
            ElseIf p経営面積A.Item(s氏名A) <> 0 And Rs.V("申請世帯A") <> Rs.V("申請世帯B") Then
                p経営面積A.Item(s氏名A) = p経営面積A.Item(s氏名A) - n経営面積A
            End If
            
            If p経営面積A.Item(s氏名A) < 0 Then p経営面積A.Item(s氏名A) = 0
            .Data(n, "経営面積残A") = p経営面積A.Item(s氏名A)

            If p経営面積B.Item(s氏名B) > 0 Then
                .Data(n, "経営面積残B") = p経営面積B.Item(s氏名B)
            Else
                .Data(n, "経営面積残B") = 0
            End If

            For W = 0 To 3
                T総合計.n筆数(W) = T総合計.n筆数(W) + p合計.n筆数(W)
                T総合計.n面積(W) = T総合計.n面積(W) + p合計.n面積(W)
            Next

    ErrStr = "データセット（農地登録中）"
            nSubCount = .SubCount(n & ":農地")
            If nFlag(3) = 1 Then
                nFlag(0) = 0: nFlag(1) = 0: nFlag(2) = 0: nFlag(3) = 0
            End If
            nFlag(3) = nFlag(3) + 1

            If nSubCount + nFlag(3) < HMax Then
               i = HMax - nFlag(3)
            End If
            For W = 0 To 3
                If nFlag(W) > 0 Then
                    i = i + 1
                    .Data(n & ":農地." & i, "土地所在") = T総合計.s地目(W)
                    St = Format(p合計.n筆数(W), "#")
                    If n分子(W) <> 0 And W < 3 Then
                        If p合計.n筆数(W) > 0 Then St = St & "・"
                        計算A n分子(W), n分母(W)
                        St = St & n分子(W) & "/" & n分母(W)
                    End If
'                    .Data(n & ":農地." & i, "登記地目") = p合計.n筆数(w)
                    .Data(n & ":農地." & i, "登記地目") = St
                    .Data(n & ":農地." & i, "現況地目") = "99999"      'データ行との区分：合計行に"99999"セット
                    .Data(n & ":農地." & i, "面積") = p合計.n面積(W)
                End If
            Next
            ' ページ切替番号設定
            SetPageNo n
            Set Rs = Nothing
        End With
    Exit Sub
    Er_Ext:
    MsgBox ""
    
    End Sub

    Private Sub SetPageNo(nDataNo As Long)
        Dim n As Long
        Dim i As Long
        Dim nSubCount As Long
        Dim nCount As Long
        Dim wCount As Long
        
        On Error Resume Next
        n = nDataNo
        nSubCount = mvarPData.SubCount(n & ":農地")
        
        nCount = DataCnt + nSubCount + 1      ' .SubCountは 0からみているため
        wCount = nSubCount + 1                '          件数として扱うときは１プラス
        
        If nCount > LMax Then
            nCount = nSubCount + 1
            i = 0
            Do While nCount > 0
                i = i + 1
                PageCnt = PageCnt + 1
                PgChgSt(PageCnt) = n * 1000 + (i - 1) * LMax
                PgChgEn(PageCnt) = n * 1000 + i * LMax - 1
                nCount = nCount - LMax
            Loop
            DataCnt = 0
            wCount = nCount + LMax
            If wCount < HMax Then
                wCount = HMax
            End If
        ElseIf n = 1 Then
            PageCnt = PageCnt + 1
            PgChgSt(PageCnt) = n * 1000
        End If
        PgChgEn(PageCnt) = n * 1000 + nSubCount
        DataCnt = DataCnt + wCount
        PageMax = PageCnt
    End Sub

    Private Function p期間設定(s始期 As String, s終期 As String, s永久 As String, pFormat As String) As String
        Dim St As String
        
        St = ""
        If IsDate(s始期) Then
            St = Format(CDate(s始期), pFormat)
        End If
        
        If s永久 = "1" Then
            St = St & "\n" & "〜" & "\n" & "永久"
        ElseIf IsDate(s終期) Then
            St = St & "\n" & "〜" & "\n" & Format(CDate(s終期), pFormat)
        End If
        p期間設定 = St
    End Function

    Private Sub 計算A(pDataA As Long, pDataB As Long)
        Dim n As Long
        
        n = 2
        Do While (n < pDataA And n < pDataB)
            If (pDataA Mod n = 0) And (pDataB Mod n = 0) Then
                pDataA = pDataA / n
                pDataB = pDataB / n
                Exit Do
            End If
            n = n + 1
        Loop
    End Sub

    Private Function pLen(pStr As String) As Long
        Dim n As Long
        Dim nAscCode As Integer
        Dim nCount As Long
                   
        nCount = 0
        For n = 1 To Len(pStr)
            nCount = nCount + 1
            nAscCode = Asc(MID(pStr, n, 1))
            If Len(Hex(nAscCode)) > 2 Then
                nCount = nCount + 1
            End If
        Next
        pLen = nCount
    End Function

    Private Property Let CPrintSub_StartPage(RHS As Long): mvarStartPage = RHS: End Property
    Private Property Get CPrintSub_StartPage() As Long: CPrintSub_StartPage = mvarStartPage: End Property

End Class










Class CPrintSub農地法4条
    Option Explicit
    Implements CPrintSub
    Private mvarKey As String
    Private mvarData As String
    Private mvarPData As CPrintDatas
    Private Const PGMAX As Long = 100   'ページ切替ＭＡＸ
    Private PgChgSt(PGMAX) As Long      'ページ切替開始番号
    Private PgChgEn(PGMAX) As Long      'ページ切替終了番号
    Private DataCnt As Long             'データカウント
    Private PageCnt As Long             'ページカウント
    Private HMax As Long                '基本データMAX
    Private LMax As Long                '１ページの行数
    Private PageMax As Long             'ページＭＡＸ
    Private PageNow As Long             '現在のページ
    Private StartX As Single            'データ始点(X)
    Private StartY As Single            'データ始点(Y)
    Private nFsize As Integer           'フォントサイズ
    Private RowH As Long                '行の高さ
    Private ColW As Variant             '表枠の幅
    Private s支所 As String
    Private s都道府県名 As String
    Private s郡部 As String
    Private p農地区分 As New CDataDictionary
    Private p農振区分 As New CDataDictionary
    Private p都計区分 As New CDataDictionary
    Private p支所番号 As New CDataDictionary
    Private mvarStartPage As Integer
    Private mvarTitle As String
    
    Private Type TotalData
        s地目(4) As String
        n筆数(4) As Long
        n面積(4) As Double
    End Type
    Private T総合計 As TotalData

    Private Property Let CPrintSub_Data(ByVal RHS As String): Dim Cm As Variant: mvarData = RHS: Cm = Split(mvarData, ";"): mvarStartPage = Val(Cm(2)) - (Val(Cm(2)) = 2) * (Val(Cm(3)) - 2): End Property
    Private Property Get CPrintSub_Data() As String: CPrintSub_Data = mvarData: End Property

    Private Property Let CPrintSub_Key(ByVal RHS As String): mvarKey = RHS: End Property
    Private Property Get CPrintSub_Key() As String: CPrintSub_Key = mvarKey: End Property

    Private Property Get CPrintSub_MaxPage() As Long: CPrintSub_MaxPage = PageMax: End Property

    Private Property Get CPrintSub_NowPage() As Long: CPrintSub_NowPage = PageNow: End Property

    Private Sub CPrintSub_PrintSub(ByVal sKey As String, ByVal nPage As Long, mvarParent As ADBasicLIB2.CPrintFormSK)
        Dim Ar As Variant
        Dim Cm As Variant
        Dim n As Long
        Dim i As Long
        Dim K As Long
        Dim hY As Single        ' 基本データY座標
        Dim dY As Single        ' 土地データY座標
        Dim dX(20) As Single, hX(20) As Single
        Dim wX As Integer
        Dim Rcnt As Long        ' 行カウント
        Dim MainStart As Long   ' データ開始番号
        Dim MainEnd As Long     ' データ終了番号
        Dim SubStart As Long    ' 土地データ開始番号
        Dim SubEnd As Long      ' 土地データ終了番号
        Dim Xcnt As Long
        Dim St1 As String
        
        If mvarPData.Count = 0 Then
            mvarParent.ClearScreen
            Exit Sub
        End If
        PageNow = nPage
       
        MainStart = PgChgSt(nPage) \ 1000
        MainEnd = PgChgEn(nPage) \ 1000

        With mvarParent
            .ClearScreen
            .Offset 0, 0
            
            Ar = Split(mvarData, vbCrLf)
            Cm = Split(Ar(0), ";")
            
            '表の項目幅(ColW)より縦線設定
            dX(0) = StartX: hX(0) = dX(0) + ColW(0) / 2
            For i = 0 To UBound(ColW)
                dX(i + 1) = dX(i) + ColW(i)
                If i < UBound(ColW) Then hX(i + 1) = dX(i + 1) + ColW(i + 1) / 2
            Next
            Xcnt = UBound(ColW) + 1
            
            Select Case Fnc.s市町村名
            Case "姶良市"
                .Offset 0, -2
                .DrawWidth = 2
                .TextOut "議案第" & StrConv(Cm(0), vbWide) & "号            農地法第４条申請", dX(0) - 4, 20, 13, 0, 2
                .DrawText "番\n号", dX(0), 32, ColW(0), 10, nFsize, 2, 0
                .DrawText "氏　　　名", dX(1), 30, ColW(1), 4, nFsize, 2, 0
                .DrawText "住　　　所", dX(1), 39, ColW(1), 4, nFsize, 2, 0
                .DrawText "土 地 の 所 在", dX(2), 34, ColW(2), 4, nFsize, 2, 0
                .DrawText "地 目", dX(3), 25.5, ColW(3) + ColW(4), 4, nFsize, 2, 0
                .DrawText "登\n記\n簿", dX(3), 33.5, ColW(3), 5, nFsize, 2, 0
                .DrawText "現\n況", dX(4), 33.5, ColW(4), 6, nFsize, 2, 0
                .DrawText "面 積\n(u)", dX(5), 32, ColW(5), 6, nFsize, 2, 0
                .DrawText "農地区分", dX(6), 34, ColW(6), 4, nFsize, 2, 2
                .DrawText "転用内容", dX(7), 34, ColW(7), 4, nFsize, 2, 2
                .DrawText "申請理由\n\n資金計画", dX(8), 34, ColW(8), 4, nFsize, 2, 2
                .DrawText "備考", dX(9), 34, ColW(9), 5, 11, 2, 0
    '                .DrawText "法令により義務\n付けられている\n協議内容", dX(9), 34, ColW(9), 5, 11, 2, 0
    '                .DrawText "棟数", dX(8), 34, ColW(8), 4, nFsize, 2, 0
    '                .DrawText "建築等\n面積\n(u)", dX(9), 30, ColW(9), 6, nFsize, 2, 0
    '                .DrawText "始末書", dX(10), 30, ColW(10), 6, nFsize, 2, 0
    '                .DrawText "面\n積\n超\nの\n理\n由\n書", dX(11), 25, ColW(11), 3.1, 9, 2, 0
    '                .DrawText "備　　　考", dX(12), 34, ColW(12), 4, nFsize, 2, 0

                .DLine dX(0), 24, dX(Xcnt), 24
                .DLine dX(3), 31, dX(5), 31
                .DLine dX(0), 48, dX(Xcnt), 48
               
                For i = 0 To Xcnt
                    If i = 4 Then
                        .DLine dX(i), 31, dX(i), 48
                    Else
                        .DLine dX(i), 24, dX(i), 48
                    End If
                Next
                
            Case "枕崎市"
                .Offset 0, 10
                .TextOut "日程第" & StrConv(Cm(1), vbWide) & "号" & "　" & "第" & StrConv(Cm(0), vbWide) & "号議案", StartX, 13, 14, 0, 2
                .TextOut "農地法第４条許可申請について", (StartX + dX(Xcnt)) / 2, 20, 18, 2, 2
                .DrawText "整理\n番号", dX(0), 28, ColW(0), 6, nFsize, 2
                .DrawText "土 地 の 所 在 地", dX(1), 31, ColW(1), 5, nFsize, 2
                .DrawText "地目", dX(2), 31, ColW(2), 5, nFsize, 2
                .DrawText "面　積\n( u )", dX(3), 28, ColW(3), 6, nFsize, 2
                .DrawText "転 用 目 的", dX(4), 31, ColW(4), 5, nFsize, 2
                .DrawText "申　請　人", dX(5), 31, ColW(5), 5, nFsize, 2
                .DrawText "申　　請　　事　　由", dX(6), 31, ColW(6), 5, nFsize, 2
                .DrawText "調 査 員", dX(7), 31, ColW(7), 5, nFsize, 2
                .LineBoxDX dX(0), 25, 16, 0, 20, ColW

                            
              Case "南種子町"
                .Offset 0, 0
                .TextOut "議案第" & StrConv(Cm(0), vbWide) & "号", 27, 22, 12, 0, 0
                .TextOut "農地法第４条の規定による許可申請に対する意見決定について　資料", 70, 22, 12, 0, 0
                .TextOut "番", hX(0), 37, nFsize, 2, 2
                .TextOut "号", hX(0), 43, nFsize, 2, 2
                .TextOut "調査員", hX(1), 40, nFsize, 2, 2
                .TextOut "申　請　人", hX(2), 40, nFsize, 2, 2
                .TextOut "土　　地　　の　　表　　示", (dX(3) + dX(7)) / 2, 35, nFsize, 2, 2
                .TextOut "所　　　在", hX(3), 45, nFsize, 2, 2
                .TextOut "持分", hX(4), 45, nFsize, 2, 2
                .TextOut "登記", hX(5), 45, nFsize, 2, 2
                .TextOut "現況", hX(6), 45, nFsize, 2, 2
                .TextOut "地積(u)", hX(7), 45, nFsize, 2, 2
                .TextOut "転　　用　　計　　画", (dX(8) + dX(12)) / 2, 35, nFsize, 2, 2
                .TextOut "用　途", hX(8), 45, nFsize, 2, 2
                .TextOut "工事着工", hX(9), 45, nFsize, 2, 2
                .TextOut "資　金", hX(10), 45, nFsize, 2, 2
                .TextOut "目　的", hX(11), 45, nFsize, 2, 2
                .TextOut "転用事由の詳細", hX(12), 40, nFsize, 2, 2
                .TextOut "隣接地等に対する被害", hX(13), 38, nFsize, 2, 2
                .TextOut "防除施設の概要　　　", hX(13), 42, nFsize, 2, 2
                .TextOut "備　　考", hX(14), 40, nFsize, 2, 2
    '                .TextOut "建ぺい率", hX(14), StartY + RowH * 10, nFsize, 2, 2
                .TextOut "建ぺい率", hX(14), StartY + 4 * 10, nFsize, 2, 2
                
                .DBox dX(0), 30, dX(Xcnt), 50
                .DLine dX(3), 40, dX(12), 40
                .DLine dX(0), 50, dX(Xcnt), 50
    '                .DLine dX(14), StartY + RowH * 9, dX(15), StartY + RowH * 9
    '                .DLine dX(14), StartY + RowH * 11, dX(15), StartY + RowH * 11
                .DLine dX(14), StartY + 4 * 9, dX(15), StartY + 4 * 9
                .DLine dX(14), StartY + 4 * 11, dX(15), StartY + 4 * 11
               
                For i = 1 To UBound(ColW)
                    Select Case i
                        Case 4, 5, 6, 7, 9, 10, 11
                            .DLine dX(i), 40, dX(i), 50
                        Case Else
                            .DLine dX(i), 30, dX(i), 50
                    End Select
                Next

            Case "三股町"
                .Offset 0, -5
                .TextOut "個別申請一覧表　第４条", dX(2), 27.5, nFsize, 0, 1
                .TextOut "三股町農業委員会　　", dX(12), 27.5, nFsize, 0, 1
                .DrawText "受\n付\n番\n号", dX(0), 35, ColW(0), 4, nFsize, 2, 2
                .DrawText "受\n付\n年\n月\n日", dX(1), 33, ColW(1), 4, nFsize, 2, 2
                .DrawText "申　請　人", dX(2), 28, ColW(2), 4, nFsize, 2, 2
                .DrawText "住　　所", dX(2), 35, ColW(2), 4, nFsize, 2, 2
                .DrawText "氏　　名", dX(2), 45, ColW(2), 4, nFsize, 2, 2
                .DrawText "申　請　地", dX(3), 28, dX(8) - dX(3), 4, nFsize, 2, 2
                .DrawText "土 地 所 在", dX(3), 40, ColW(3), 4, nFsize, 2, 2
                .DrawText "地目", dX(4), 35, ColW(4) + ColW(5), 4, nFsize, 2, 2
                .DrawText "台帳", dX(4), 45, ColW(4), 4, nFsize, 2, 2
                .DrawText "現況", dX(5), 45, ColW(5), 4, nFsize, 2, 2
                .DrawText "地積", dX(6), 35, ColW(6), 4, nFsize, 2, 2
                .DrawText "u", dX(6), 45, ColW(6), 4, nFsize, 2, 2
                .DrawText "農地\n区分", dX(7), 38, ColW(7), 4, nFsize, 2, 2
                .DrawText "権\n利\nの\n種\n類", dX(8), 32, ColW(8), 4, nFsize, 2, 2
                .DrawText "転用目的", dX(9), 40, ColW(9), 4, nFsize, 2, 2
                .DrawText "申請理由", dX(10), 40, ColW(10), 4, nFsize, 2, 2
                .DrawText "棟数", dX(11), 40, ColW(11), 4, nFsize, 2, 2
                .DrawText "面積u", dX(12), 40, ColW(12), 4, nFsize, 2, 2
                .DrawText "資\n金\n計\n画", dX(13), 35, ColW(13), 4, nFsize, 2, 2
                .DrawText "区\n域\n区\n分", dX(14), 35, ColW(14), 4, nFsize, 2, 2
                .DrawText "指\n令\n年\n月\n日", dX(15), 35, ColW(15), 4, nFsize, 2, 2
                .DrawText "指\n令\n番\n号", dX(16), 35, ColW(16), 4, nFsize, 2, 2
                .DrawText "受領\n印\n交付\n日", dX(17), 35, ColW(17), 4, nFsize, 2, 2
                .DrawText "備　　　　　　　　　　　　　　　　　　　　　　　　　考", dX(2), 52, dX(15) - dX(2), 4, nFsize, 2, 2
                
                .DBox dX(0), 28, dX(Xcnt), 56, , 4
                .DLine dX(2), 32, dX(8), 32
                .DLine dX(2), 42, dX(3), 42
                .DLine dX(4), 42, dX(7), 42
                .DLine dX(2), 52, dX(15), 52
                For i = 0 To Xcnt
                    Select Case i
                    Case 1, 2, 15, 16, 17
                        .DLine dX(i), 28, dX(i), 56
                    Case 3, 8, 9, 10, 11, 12, 13, 14
                        .DLine dX(i), 28, dX(i), 52
                    Case 4, 6, 7
                        .DLine dX(i), 32, dX(i), 52
                    Case 5
                        .DLine dX(i), 42, dX(i), 52
                    End Select
                Next

                dY = StartY
                For n = 1 To 5
                    .DBox dX(0), dY, dX(Xcnt), dY + 25, , 4
                    .DLine dX(2), dY + 10, dX(3), dY + 10
                    .DLine dX(2), dY + 20, dX(15), dY + 20
                    For i = 0 To Xcnt
                        Select Case i
                        Case 1, 2, 15, 16, 17
                            .DLine dX(i), dY, dX(i), dY + 25
                        Case 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14
                            .DLine dX(i), dY, dX(i), dY + 20
                        End Select
                    Next
                    .DrawText "\n・\n\n・\n", dX(15), dY + 11, ColW(15), 4, nFsize, 2, 2
                    dY = dY + 25
                Next
                .TextOut "資金計画", dX(2) + 1, 186, nFsize, 0, 2
                .TextOut "自己、借入、その他", dX(2) + 31, 186, nFsize, 0, 2
                .TextOut "区域区分", dX(2) + 1, 190, nFsize, 0, 2
                .TextOut "都市計画区域内　（用途地域　その他）　都市計画区域外", dX(2) + 31, 190, nFsize, 0, 2
                .TextOut "　　　　　　　　　　Ａ　　　　Ｂ　　　　Ｃ", dX(2) + 31, 194, nFsize, 0, 2
                .TextOut "権利の種類", dX(2) + 1, 198, nFsize, 0, 2
                .TextOut "所有権移転（売買・贈与）、賃借権、使用貸借", dX(2) + 31, 198, nFsize, 0, 2
                .DLine dX(2), 184, dX(7), 184, , 4
                .DLine dX(2), 188, dX(7), 188
                .DLine dX(2), 192, dX(7), 192
                .DLine dX(2), 196, dX(7), 196
                .DLine dX(2), 200, dX(7), 200, , 4
                .DLine dX(2), 184, dX(2), 200, , 4
                .DLine dX(2) + 30, 184, dX(2) + 30, 200
                .DLine dX(7), 184, dX(7), 200, , 4

                hY = StartY + 1 '基本データY座標
                dY = StartY + 1 '土地データY座標

                For n = MainStart To MainEnd
                     ' 土地データ開始番号設定
                    If n = MainStart Then
                        SubStart = PgChgSt(nPage) - MainStart * 1000
                    Else
                        SubStart = 0
                    End If

                    '土地データ終了番号設定
                    If n = MainEnd Then
                        SubEnd = PgChgEn(nPage) - MainEnd * 1000
                    Else
                        SubEnd = mvarPData.SubCount(n & ":農地")
                    End If

                    .DrawText n, dX(0), dY + RowH * 2, ColW(0), RowH, nFsize, 2
                    St1 = Format(mvarPData.Data(n, "受付年月日"), "EEMMDD")
                    .DrawText Val(Left(St1, 2)) & "\n・\n" & Val(MID(St1, 3, 2)) & "\n・\n" & Val(MID(St1, 5, 2)), dX(1), hY, ColW(1), 4, nFsize, 2
                    .DrawText mvarPData.Data(n, "住所"), dX(2) + 1, hY, ColW(2) - 1, RowH, nFsize + (Len(mvarPData.Data(n, "住所")) > 16), 0
                    .DrawText mvarPData.Data(n, "氏名"), dX(2) + 1, hY + RowH * 2, ColW(2) - 1, RowH, nFsize + (Len(mvarPData.Data(n, "氏名")) > 16), 0
                    .DrawText "-", dX(8), hY, ColW(8), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(n, "転用目的"), 16), dX(9), hY, ColW(9), RowH, nFsize, 0
                    .DrawText Left(mvarPData.Data(n, "転用事由"), 16), dX(10), hY, ColW(10), RowH, nFsize, 0
                    If Val(mvarPData.Data(n, "棟数")) > 0 Then
                        .DrawText mvarPData.Data(n, "棟数"), dX(11), hY, ColW(11), RowH, nFsize, 2
                    End If
                    If Val(mvarPData.Data(n, "建築面積")) <> 0 Then
                        .TextOut FormatNumber(Val(mvarPData.Data(n, "建築面積")), 0), dX(13) - 2, hY, nFsize, 1
                    End If
                    .DrawText Left(mvarPData.Data(n, "資金計画"), 4), dX(13), hY, ColW(13), RowH, nFsize, 2
                    .DrawText mvarPData.Data(n, "備考"), dX(2) + 1, hY + 20, 210, RowH, nFsize, 0
              
                    Rcnt = 0
                    For K = SubStart To SubEnd
                        .DrawText mvarPData.Data(n & ":農地." & K, "土地所在"), dX(3) + 1, dY, ColW(3) - 2, 4, nFsize, 0
                        .DrawText Left(mvarPData.Data(n & ":農地." & K, "登記地目"), 2), dX(4), dY, ColW(4), RowH, nFsize, 2
                        .DrawText Left(mvarPData.Data(n & ":農地." & K, "現況地目"), 2), dX(5), dY, ColW(5), RowH, nFsize, 2
                        If Val(mvarPData.Data(n & ":農地." & K, "面積")) <> 0 Then
                            .DrawText FormatNumber(Val(mvarPData.Data(n & ":農地." & K, "面積")), 0), dX(6), dY, ColW(6) - 1, 4, nFsize, 1
                        End If
                        .DrawText Left(mvarPData.Data(n & ":農地." & K, "農振区分"), 2), dX(7), dY, ColW(7), RowH, nFsize, 2
                        If Len(mvarPData.Data(n & ":農地." & K, "土地所在")) > 0 Then
                            Select Case Val(mvarPData.Data(n & ":農地." & K, "都市計画法ID"))
                                Case 0: St1 = "C"
                                Case 2: St1 = "A"
                                Case Else: St1 = "B"
                            End Select
                            .DrawText St1, dX(14), dY, ColW(14), 4, nFsize, 2, 0
                        End If
                        Rcnt = Rcnt + 1
                        If (Rcnt Mod 4) = 0 Then
                            dY = dY + 5
                        End If
                        dY = dY + RowH
                    Next

                    If Rcnt < HMax Then
                        dY = hY + HMax * RowH + 5
                    End If
                    hY = dY
                Next
            
            Case "さつま町"
                .Offset -5, 5
                .TextOut "議案第" & StrConv(Cm(0), vbWide) & "号", 10, 10, 13, 0, 0
                .TextOut "農地法第４条の規定による許可申請に対する意見について", 148, 15, 16, 2, 0
                .TextOut "農地法第４条の規定により、下記農地の申請があったので意見を求める", 148, 25, 10, 2, 0
                
                .VText "番 号", hX(0), 40, nFsize, 2, 0
                .DrawText "土　　　　　　地", dX(1), 36.5, dX(8) - dX(1), 4, nFsize, 2
                .DrawText "農 地 の 所 在", dX(1), 47, ColW(1), 4, nFsize, 2
                .DrawText "地　目", dX(2), 43, ColW(2) + ColW(3), 4, nFsize, 2
                .DrawText "登記", dX(2), 50, ColW(2), 4, nFsize, 2
                .DrawText "現況", dX(3), 50, ColW(3), 4, nFsize, 2
                .DrawText "農振区分", dX(4), 45, ColW(4), 4, nFsize, 2, 0
                .DrawText "都市計画", dX(5), 45, ColW(5), 4, nFsize, 2, 0
                .DrawText "土地改良", dX(6), 45, ColW(6), 4, nFsize, 2, 0
                .DrawText "面積(u)", dX(7), 47, ColW(7), 4, nFsize, 2
                .DrawText "申　請　人", dX(8), 36.5, ColW(8), 4, nFsize, 2
                .DrawText "氏名、住所", dX(8), 45, ColW(8), 4, nFsize, 2
                .DrawText "職　業", dX(8), 50, ColW(8), 4, nFsize, 2
                .DrawText "転 用 目 的", dX(9), 44, ColW(9), 4, nFsize, 2
                .DrawText "棟数", dX(10), 44, ColW(10), 4, nFsize, 2
                .DrawText "転 用 理 由", dX(11), 44, ColW(11), 4, nFsize, 2
                .DrawText "備　考", dX(12), 44, ColW(12), 4, nFsize, 2
                .DrawText "審議結果", dX(13), 38, ColW(13), 4, nFsize, 2, 0
                .DrawText "(調査員)", dX(12), 48, ColW(12), 4, nFsize, 2
                
                '横線
                .DLine dX(0), 35, dX(Xcnt), 35, vbBlack
                .DLine dX(1), 42, dX(9), 42, vbBlack
                .DLine dX(2), 48, dX(4), 48, vbBlack
                .DLine dX(0), 57, dX(Xcnt), 57, vbBlack

                '縦線
                For n = 0 To 14
                    Select Case n
                    Case 2, 4, 5, 6, 7
                        .DLine dX(n), 42, dX(n), 57, vbBlack
                    Case 3
                        .DLine dX(n), 48, dX(n), 57, vbBlack
                    Case Else
                        .DLine dX(n), 35, dX(n), 57, vbBlack
                    End Select
                Next
                
             Case "日置市"
                .Offset 0, 0
                .TextOut "第" & StrConv(Cm(0), vbWide) & "号議案", 16, 13, 13, 0, 2
                .TextOut "農地法第４条申請", 20, 20, 14, 0, 2
                
                Select Case mvarPData.Data(MainStart, "受付補助記号")
                    Case "本": St1 = "伊集院地域"
                    Case "東": St1 = "東市来地域"
                    Case "日": St1 = "日吉地域"
                    Case "吹": St1 = "吹上地域"
                    Case Else: St1 = ""
                End Select
                .TextOut "[ " & St1 & " ]", dX(Xcnt), 20, 14, 1, 2
                
                .DrawText "番号", dX(0), 31, ColW(0), 10, nFsize, 2
                .DrawText "申　請　人", dX(1), 25, ColW(1), 4, nFsize, 2
                .DrawText "氏　　名", dX(1), 31, ColW(1), 4, nFsize, 2
                .DrawText "(職　業)", dX(1), 37, ColW(1), 4, nFsize, 2
                .DrawText "住    所", dX(1), 46, ColW(1), 4, nFsize, 2
                .DrawText "申        請        地", dX(2), 25, dX(7) - dX(2), 4, nFsize, 2
                .DrawText "所     在", dX(2), 40, ColW(2), 4, nFsize, 2
                .DrawText "地 目", dX(3), 31, dX(5) - dX(3), 4, nFsize, 2
                .DrawText "台帳", dX(3), 40, ColW(3), 6, nFsize, 2
                .DrawText "現況", dX(4), 40, ColW(4), 6, nFsize, 2
                .DrawText "面 積\n(u)", dX(5), 37, ColW(5), 6, nFsize, 2
                .DrawText "区\n分", dX(6), 37, ColW(6), 6, nFsize, 2
                .DrawText "申  請  事  由", dX(7), 25, dX(10) - dX(7), 4, nFsize, 2
                .DrawText "転用目的", dX(7), 40, ColW(7), 4, nFsize, 2
                .DrawText "棟数", dX(8), 40, ColW(8), 4, nFsize, 2
                .DrawText "建築等\n面積\n(u)", dX(9), 34, ColW(9), 6, nFsize, 2
                .DrawText "調査員", dX(10), 37, ColW(10), 4, nFsize, 2
                .DrawText "同意書", dX(11), 30, ColW(11), 6, nFsize, 2
                .DrawText "始末書", dX(12), 30, ColW(12), 6, nFsize, 2
                .DrawText "被害防除計画書", dX(13), 25, ColW(13), 4, nFsize, 2
                
                .DLine dX(0), 24, dX(Xcnt), 24
                .DLine dX(1), 30, dX(10), 30
                .DLine dX(1), 42, dX(2), 42
                .DLine dX(3), 36, dX(5), 36
                .DLine dX(0), 54, dX(Xcnt), 54
                For i = 0 To Xcnt
                    Select Case i
                        Case 3, 5, 6, 8, 9: .DLine dX(i), 30, dX(i), 54
                        Case 4:             .DLine dX(i), 36, dX(i), 54
                        Case Else:          .DLine dX(i), 24, dX(i), 54
                    End Select
                Next
            
            Case "大崎町"
                .Offset -5, 3
                .TextOut "第" & StrConv(Cm(0), vbWide) & "号議案", dX(0) - 4, 13, 13, 0, 2
                .TextOut "農地法第４条申請", dX(0), 20, 14, 0, 2
                .DrawText "番\n\n号", dX(0), 25, ColW(0), 4, nFsize, 2, 2, 24
    '                .DrawText "氏　　　名", dX(1), 30, ColW(1), 4, nFsize, 2
    '                .DrawText "集　　　落", dX(1), 34.5, ColW(1), 4, nFsize, 2
    '                .DrawText "職業・年齢", dX(1), 39, ColW(1), 4, nFsize, 2
                .DrawText "氏　　　名\n集　　　落\n職業・年齢", dX(1), 25, ColW(1), 4, nFsize, 2, 2, 24
                .DrawText "土 地 の 所 在", dX(2), 25, ColW(2), 4, nFsize, 2, 2, 24
                .DrawText "地 目", dX(3), 25, ColW(3) + ColW(4), 4, nFsize, 2, 2, 6
                .DrawText "台\n\n帳", dX(3), 31, ColW(3), 4, nFsize, 2, 2, 17
                .DrawText "現\n\n況", dX(4), 31, ColW(4), 4, nFsize, 2, 2, 17
                .DrawText "面 積\n(u)", dX(5), 25, ColW(5), 4, nFsize, 2, 2, 24
                .DrawText "申 請 事 由", dX(6), 25, ColW(6) + ColW(7), 4, nFsize, 2, 2, 6
                .DrawText "転用目的", dX(6), 31, ColW(6), 4, nFsize, 2, 2, 18
                .DrawText "面積\n(u)", dX(7), 31, ColW(7), 4, nFsize, 2, 2, 18
                .DrawText "転 用\n\n時 期", dX(8), 25, ColW(8), 4, nFsize, 2, 2, 24
                .DrawText "資金計画", dX(9), 25, ColW(9), 4, nFsize, 2, 2, 24
                .DrawText "農\n\n振", dX(10), 25, ColW(10), 4, nFsize, 2, 2, 24
                .DrawText "農　地\n\n区　分", dX(11), 25, ColW(11), 4, nFsize, 2, 2, 24
                .DrawText "結\n\n果", dX(12), 25, ColW(12), 4, nFsize, 2, 2, 24
                .DrawText "備　考", dX(13), 25, ColW(13), 4, nFsize, 2, 2, 24

                .DLine dX(0), 24, dX(Xcnt), 24
                .DLine dX(3), 31, dX(5), 31
                .DLine dX(6), 31, dX(8), 31
                .DLine dX(0), 48, dX(Xcnt), 48

                For i = 0 To Xcnt
                    Select Case i
                        Case 4, 7: .DLine dX(i), 31, dX(i), 48
                        Case Else:      .DLine dX(i), 24, dX(i), 48
                    End Select
                Next
                
            Case Else
                .Offset -7, 10
                .TextOut "第" & StrConv(Cm(0), vbWide) & "号議案", 16, 13, 13, 0, 2
                .TextOut mvarTitle, 20, 20, 14, 0, 2
                .DrawText "番号", dX(0), 31, ColW(0), 10, nFsize, 2
                .DrawText "申　請　人", dX(1), 25, ColW(1), 4, nFsize, 2
                .DrawText "氏　　名", dX(1), 31, ColW(1), 4, nFsize, 2
                .DrawText "(職　業)", dX(1), 37, ColW(1), 4, nFsize, 2
                .DrawText "住    所", dX(1), 46, ColW(1), 4, nFsize, 2
                .DrawText "申        請        地", dX(2), 25, dX(7) - dX(2), 4, nFsize, 2
                .DrawText "所     在", dX(2), 40, ColW(2), 4, nFsize, 2
                .DrawText "地 目", dX(3), 31, ColW(3) + ColW(4), 4, nFsize, 2
                .DrawText "台帳", dX(3), 40, ColW(3), 6, nFsize, 2
                .DrawText "現況", dX(4), 40, ColW(4), 6, nFsize, 2
                .DrawText "面 積\n(u)", dX(5), 37, ColW(5), 6, nFsize, 2
                .DrawText "区\n分", dX(6), 37, ColW(6), 6, nFsize, 2
                .DrawText "申     請     事     由", dX(7), 25, dX(11) - dX(7), 4, nFsize, 2
                .DrawText "転 用 目 的", dX(7), 40, ColW(7), 4, nFsize, 2
                .DrawText "棟数", dX(8), 40, ColW(8), 4, nFsize, 2
                .DrawText "建築等\n面積\n(u)", dX(9), 34, ColW(9), 6, nFsize, 2
                .DrawText "事　　　由", dX(10), 40, ColW(10), 4, nFsize, 2
                .DrawText "同意書", dX(11), 30, ColW(11), 6, nFsize, 2
                .DrawText "始末書", dX(12), 30, ColW(12), 6, nFsize, 2
                .DrawText "被害防除計画書", dX(13), 25, ColW(13), 4, nFsize, 2
                
                .DLine dX(0), 24, dX(Xcnt), 24
                .DLine dX(1), 30, dX(11), 30
                .DLine dX(1), 42, dX(2), 42
                .DLine dX(3), 36, dX(5), 36
                .DLine dX(0), 54, dX(Xcnt), 54
                
                For i = 0 To Xcnt
                    Select Case i
                        Case 3, 5, 6, 8, 9, 10: .DLine dX(i), 30, dX(i), 54
                        Case 4:                 .DLine dX(i), 36, dX(i), 54
                        Case Else:              .DLine dX(i), 24, dX(i), 54
                    End Select
                Next
            
            End Select
            If Fnc.s市町村名 <> "三股町" Then PrintSubMain mvarParent, dX(), hX()
        End With
    End Sub
        
    Private Sub PrintSubMain(ByRef mvarParent As ADBasicLIB2.CPrintFormSK, ByRef dX() As Single, ByRef hX() As Single)
        Dim hY As Single        ' 基本データY座標
        Dim dY As Single        ' 土地データY座標
        Dim Rcnt As Long        ' 行カウント
        Dim nMainStart As Long  ' データ開始番号
        Dim nMainEnd As Long    ' データ終了番号
        Dim nSubStart As Long   ' 土地データ開始番号
        Dim nSubEnd As Long     ' 土地データ終了番号
        Dim n As Long
        Dim i As Long
        Dim nWork As Single
        Dim nPage As Long
        Dim Xcnt As Long
        
        nPage = PageNow

        Xcnt = UBound(ColW) + 1

        With mvarParent
            nMainStart = PgChgSt(nPage) \ 1000
            nMainEnd = PgChgEn(nPage) \ 1000
       
            dY = StartY + 1
            hY = StartY + 1

            For n = nMainStart To nMainEnd
                ' 土地データ開始番号設定
                If n = nMainStart Then
                    nSubStart = PgChgSt(nPage) - nMainStart * 1000
                Else
                    nSubStart = 0
                End If
                
                '土地データ終了番号設定
                If n = nMainEnd Then
                    nSubEnd = PgChgEn(nPage) - nMainEnd * 1000
                Else
                    nSubEnd = mvarPData.SubCount(n & ":農地")
                End If
                
                ' 罫線
                Rcnt = nSubEnd - nSubStart + 1
                If Rcnt < HMax Then
                    nWork = hY + HMax * RowH
                Else
                    nWork = dY + Rcnt * RowH
                End If
                For i = 0 To Xcnt
                    .DLine dX(i), dY - 1, dX(i), nWork, vbBlack
                Next
                
                '背景色設定
                If Fnc.s市町村名 = "日置市" Then
                    For i = 0 To Xcnt
                        Select Case i
                        Case 0, 7
                            .DBox dX(i), hY - 1, dX(i + 1), nWork, RGB(230, 230, 230), , True
                        End Select
                        .DLine dX(i), hY - 1, dX(i), nWork, vbBlack
                    Next
                    .DLine dX(0), dY - 1, dX(Xcnt), dY - 1, vbBlack
                End If

                ' データ出力
                For i = nSubStart To nSubEnd
                    PrintSubData mvarParent, n, i, dX, hX, dY, nSubStart, nSubEnd
                    dY = dY + RowH
                Next
                
                Rcnt = nSubEnd - nSubStart + 1
                If Rcnt < HMax Then   ' 土地データ行数が基本データ行数より少ないとき
                    dY = hY + 1 + HMax * RowH
                End If
                .DLine dX(0), dY, dX(Xcnt), dY, vbBlack
                dY = dY + 1
                hY = dY
            Next
            If nPage = PageMax Then PrintSubTotal mvarParent, dX, hX, dY
            If mvarStartPage > 0 Then .TextOut "- " & mvarStartPage - 1 + nPage & " - ", .PaperWidth / 2, .PaperHeight - 4
        End With
    End Sub
    
    Private Sub PrintSubData(ByRef mvarParent As ADBasicLIB2.CPrintFormSK, pNo As Long, pSubNo As Long, ByRef dX() As Single, ByRef hX() As Single, dY As Single, pSubStart As Long, pSubEnd As Long)
        Dim St1 As String
        Dim St2 As String
        Dim nWk As Long
        Dim n As Long
        Dim i As Long
        
        With mvarParent
            Select Case Fnc.s市町村名
            Case "姶良市"
                If pSubNo = pSubStart Then
                    .TextOut mvarPData.Data(pNo, "通年受付番号"), (dX(0) + dX(1)) / 2, dY + RowH, nFsize, 2, 0
                    .TextOut mvarPData.Data(pNo, "受付補助記号"), (dX(0) + dX(1)) / 2, dY + RowH * 3, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo, "氏名"), 24), dX(1) + 1, dY, ColW(1) - 1, RowH, nFsize
                    .DrawText Left(Fnc.GetShortAddress(mvarPData.Data(pNo, "住所"), s都道府県名, s郡部, , , True), 26), dX(1) + 1, dY + RowH * 2 + 1, ColW(1) - 1, RowH - 1, nFsize - 1, 0
                    .DrawText Left(mvarPData.Data(pNo, "職業"), 9), dX(1) + 1, dY + RowH * 4, ColW(1) - 1, RowH, nFsize
                    .DrawText IIf(Val(mvarPData.Data(pNo, "年齢")) > 0, mvarPData.Data(pNo, "年齢") & "歳", ""), dX(1), dY + RowH * 4, ColW(1) - 1, RowH, nFsize, 1
                    .DrawText Left(mvarPData.Data(pNo, "集落"), 12), dX(1) + 1, dY + RowH * 5, ColW(1) - 1, RowH, nFsize
                    .DrawText Left(mvarPData.Data(pNo, "農地区分") & "\n" & mvarPData.Data(pNo, "農地区分補足"), 30), dX(6) + 1, dY, ColW(6) - 1, RowH, nFsize - 1
                    .DrawText mvarPData.Data(pNo, "転用目的") & IIf(Val(mvarPData.Data(pNo, "棟数")) <> 0, "\n\n" & mvarPData.Data(pNo, "棟数") & "棟", "") & IIf(Val(mvarPData.Data(pNo, "建築面積")) <> 0, "\n\n" & FormatNumber(Val(mvarPData.Data(pNo, "建築面積")), 0) & "u", ""), dX(7) + 1, dY, ColW(7) - 2, RowH, nFsize
                    .DrawText IIf(Len(mvarPData.Data(pNo, "転用事由")) > 0, mvarPData.Data(pNo, "転用事由") & "\n\n", "") & mvarPData.Data(pNo, "資金計画"), dX(8) + 0.5, dY, ColW(8) - 1, RowH, 10, 0, 0
                    .DrawText IIf(Len(mvarPData.Data(pNo, "協議状況")) > 0, mvarPData.Data(pNo, "協議状況") & "\n", "") & mvarPData.Data(pNo, "備考"), dX(9) + 0.5, dY, ColW(9) - 1, RowH, 10, 0, 0
              '      .DrawText IIf(Val(mvarPData.Data(pNo, "棟数")) = 0, "", mvarPData.Data(pNo, "棟数")), dX(8) + 1, dY, ColW(8) - 2, RowH, nFsize, 2
              '      .DrawText IIf(Val(mvarPData.Data(pNo, "建築面積")) = 0, "", FormatNumber(Val(mvarPData.Data(pNo, "建築面積")), 0)), dX(9), dY, ColW(9) - 1, RowH, nFsize, 1
              '      .DrawText mvarPData.Data(pNo, "始末書"), dX(10), dY + RowH * 2, ColW(10), 4, nFsize, 2
              '      .DrawText mvarPData.Data(pNo, "理由書"), dX(11), dY + RowH * 2, ColW(11), 4, nFsize, 2
              '      .DrawText mvarPData.Data(pNo, "調査員"), dX(12) + 1, dY, ColW(12) - 1, 4, nFsize - 1
                End If

                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then  '合計行
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(2) + 1, dY, ColW(2), RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(2), dY, ColW(2) - 2, RowH, nFsize, 1
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "小数点")) = 0 Then
                        .DrawText Format(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), "#,##0"), dX(5), dY, ColW(5) - 1, RowH, nFsize, 1
                    Else
                        .DrawText Format(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), "#,##0.00"), dX(5), dY, ColW(5) - 1, RowH, nFsize, 1
                    End If
'                    .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(5), dY, ColW(5) - 1, RowH, nFsize, 1
                ElseIf Val(mvarPData.Data(pNo & ":農地." & pSubNo, "一部")) = 1 Then
                    .TextOut "(" & FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0) & "の内)", dX(6) - 1, dY, nFsize - 2, 1
                Else
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(2) + 1, dY, ColW(2) - 2, RowH, nFsize, 0
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 1), dX(3), dY, ColW(3), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 1), dX(4), dY, ColW(4), RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "小数点")) = 0 Then
                            .DrawText Format(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), "#,##0"), dX(5), dY, ColW(5) - 1, RowH, nFsize, 1
                        Else
                            .DrawText Format(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), "#,##0.00"), dX(5), dY, ColW(5) - 1, RowH, nFsize, 1
                        End If
    '                        .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(5), dY, ColW(5) - 1, RowH, nFsize, 1
                    End If
                End If

            Case "枕崎市"
                If pSubNo = pSubStart Then
                    .TextOut pNo, dX(1) - 4, dY, nFsize, 1, 0   '番号
                    .DrawText mvarPData.Data(pNo, "転用目的"), dX(4) + 1, dY, ColW(4) - 2, RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo, "氏名"), dX(5) + 1, dY, ColW(5) - 2, RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo, "転用事由"), dX(6) + 1, dY, ColW(6) - 2, RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo, "調査員"), dX(7) + 1, dY, ColW(7) - 2, RowH, nFsize, 2
                End If
                        
                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then  ' 合計行
                    .TextOut mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(1) + 5, dY, nFsize, 0, 0
                    .TextOut mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(2) - 2, dY, nFsize, 1, 0
                    .TextOut FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(4) - 2, dY, nFsize, 1
                Else
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(1) + 1, dY, ColW(1) - 2, RowH, nFsize, 0
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 1), dX(2) + 1, dY, ColW(2) - 2, RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        .TextOut FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(4) - 2, dY, nFsize, 1
                    End If
                End If
                
            Case "南種子町"
                nWk = 4
                If pSubNo = pSubStart Then
                    .TextOut pNo, hX(0), dY + nWk, nFsize, 2, 0
                    St1 = Replace(mvarPData.Data(pNo, "調査員"), "\t", "")
                    .DrawText St1, dX(1), dY, ColW(1), nWk, nFsize, 2, 0
                    .TextOut "住所", dX(2) + 0.5, dY, nFsize, 0, 0
                    .DrawText StrConv(mvarPData.Data(pNo, "住所"), vbNarrow), dX(2) + 0.5, dY + RowH, ColW(2) - 1, 4, nFsize, 0, 0
                    .DrawText "氏名\n" & mvarPData.Data(pNo, "氏名"), dX(2) + 0.5, dY + RowH * 5, ColW(2) - 1, 4, nFsize, 0, 0
                
                    .DrawText mvarPData.Data(pNo, "用途"), dX(8), dY, ColW(8), nWk, nFsize, 2, 0
                   
                    St1 = IIf(Len(mvarPData.Data(pNo, "工事開始年2")) > 0, mvarPData.Data(pNo, "工事開始年2") & ".", "")
                    St2 = IIf(mvarPData.Data(pNo, "工事開始月2") > 0, mvarPData.Data(pNo, "工事開始月2"), "")
                    .DrawText St1 & St2, dX(9), dY + nWk * 4, ColW(9), nWk, nFsize, 2, 0
                    .DrawText IIf(Len(St1 & St2), "〜", ""), dX(9), dY + nWk * 5, ColW(9), nWk, nFsize, 2, 0
                    St1 = IIf(Len(mvarPData.Data(pNo, "工事終了年2")) > 0, mvarPData.Data(pNo, "工事終了年2") & ".", "")
                    St2 = IIf(mvarPData.Data(pNo, "工事終了月2") > 0, mvarPData.Data(pNo, "工事終了月2"), "")
                    .DrawText St1 & St2, dX(9), dY + nWk * 6, ColW(9), nWk, nFsize, 2, 0
                    .DrawText mvarPData.Data(pNo, "資金計画"), dX(10) + 0.5, dY, ColW(10), nWk, nFsize, 0, 0
                    .DrawText mvarPData.Data(pNo, "転用目的"), dX(11), dY, ColW(11), nWk, nFsize, 2, 0
                    .DrawText mvarPData.Data(pNo, "転用事由"), dX(12) + 0.5, dY, ColW(12) - 1, nWk, nFsize, 0, 0
                    .DrawText mvarPData.Data(pNo, "被害防除概要"), dX(13) + 0.5, dY, ColW(13), nWk, nFsize, 0, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & 0, "農振区分"), dX(14) + 0.5, dY, ColW(14), nWk, nFsize, 0, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & 0, "都市計画法"), dX(14) + 0.5, dY + nWk * 3, ColW(14), nWk, nFsize, 0, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & 0, "等級"), dX(14) + 0.5, dY + nWk * 6, ColW(14), nWk, nFsize, 0, 0

                    .DrawText IIf(Val(mvarPData.Data(pNo, "建ぺい率")) = 0, "", FormatNumber(Val(mvarPData.Data(pNo, "建ぺい率")), 1) & "％"), dX(14), dY + nWk * 12, ColW(14) - 1, nWk, nFsize, 1, 0
                    If Val(mvarPData.Data(pNo, "棟数")) <> 0 Then
                        .TextOut "棟数", dX(14) + 1, dY + nWk * 13.5, nFsize, 0, 0
                        .DrawText Val(mvarPData.Data(pNo, "棟数")) & "棟", dX(14), dY + nWk * 13.5, ColW(14) - 1, nWk, nFsize, 1, 0
                    End If
                    If Val(mvarPData.Data(pNo, "所要面積")) <> 0 Then
                        .TextOut "所要面積", dX(14) + 1, dY + nWk * 15, nFsize, 0, 0
                        .DrawText FormatNumber(Val(mvarPData.Data(pNo, "所要面積")), 1) & "u", dX(14), dY + nWk * 16, ColW(14) - 1, nWk, nFsize, 1, 0
                    End If
                    If Val(mvarPData.Data(pNo, "建築面積")) <> 0 Then
                        .TextOut "建築面積", dX(14) + 1, dY + nWk * 17.5, nFsize, 0, 0
                        .DrawText FormatNumber(Val(mvarPData.Data(pNo, "建築面積")), 1) & "u", dX(14), dY + nWk * 18.5, ColW(14) - 1, nWk, nFsize, 1, 0
                    End If
                End If
                
                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(3), dY, ColW(3) - 2, RowH, nFsize, 1, 0
                    .DrawText pFormatN(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積"))), dX(7), dY, ColW(7) - 1, RowH, nFsize, 1
                Else
                    If Len(mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在")) > 0 Then
'                        .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(3) + 1, dY, ColW(3) - 2, RowH, nFsize - IIf(Len(mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在")) > 11, 1, 0)
                        .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(3) + 1, dY, ColW(3) - 2, 3, nFsize
                        .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "持分"), dX(4), dY, ColW(4), RowH, nFsize, 2
                        .DrawText Left$(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 3), dX(5), dY, ColW(5), RowH, nFsize - IIf(Len(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目")) > 2, 1, 0), 2, 0
                        .DrawText Left$(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 3), dX(6), dY, ColW(6), RowH, nFsize - IIf(Len(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目")) > 2, 1, 0), 2, 0
                        If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                            .DrawText pFormatN(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積"))), dX(7), dY, ColW(7) - 1, RowH, nFsize, 1, 0
                        End If
                    ElseIf Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        .DrawText "の内" & pFormatN(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積"))), dX(7), dY, ColW(7) - 1, RowH, nFsize - 1, 1, 0
                    End If
                End If

                If pSubNo = pSubEnd Then
                    .TextOut "※参考図面は裏面", dX(0) + 1, dY + 8, nFsize, 0, 0
                End If
            
            Case "さつま町"
                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then  '合計行
                    .TextOut mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(2) - 5, dY, nFsize, 1, 0
                    .TextOut mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(3) - 1, dY, nFsize, 1, 0
                    .TextOut FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(8) - 2, dY, nFsize, 1
                Else
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(1) + 1, dY, ColW(1) - 2, 4, nFsize, 0
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 2), dX(2) + 1, dY, ColW(2) - 2, RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 2), dX(3) + 1, dY, ColW(3) - 2, RowH, nFsize, 2
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "農振区分"), dX(4), dY, ColW(4), RowH, nFsize, 2
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "都市計画法"), dX(5), dY, ColW(5), RowH, nFsize, 2
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地改良法"), dX(6), dY, ColW(6), RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        .TextOut FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(8) - 2, dY, nFsize, 1
                    End If
                End If
                
                If pSubNo = pSubStart Then
                    .DrawText mvarPData.Data(pNo, "通年受付番号"), dX(0), dY, ColW(0), RowH, nFsize, 1
                    .DrawText mvarPData.Data(pNo, "氏名"), dX(8) + 1, dY, ColW(8) - 2, RowH, nFsize, 0
                    .DrawText StrConv(mvarPData.Data(pNo, "住所"), vbNarrow), dX(8) + 1, dY + RowH * 2, ColW(8) - 1, RowH, nFsize - 1, 0
                    .DrawText mvarPData.Data(pNo, "職業"), dX(8) + 1, dY + RowH * 5, ColW(8) - 2, RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo, "転用目的"), dX(9) + 1, dY, ColW(9) - 2, RowH, nFsize, 0
                    .TextOut IIf(Val(mvarPData.Data(pNo, "棟数")) = 0, "", mvarPData.Data(pNo, "棟数")), dX(11) - 2, dY, nFsize, 1
                    .DrawText mvarPData.Data(pNo, "転用事由"), dX(11) + 1, dY, ColW(11) - 1, RowH, nFsize, 0
                    .DrawText "可\n・\n否\n", dX(13), dY + 2, ColW(13), RowH, nFsize, 2, 0
                    .DrawText mvarPData.Data(pNo, "備考"), dX(12) + 1, dY, ColW(12) - 1, RowH, nFsize - 1, 0
                End If
                
                If pSubNo = pSubEnd And Len(mvarPData.Data(pNo, "調査員")) > 0 Then
                    .DrawText "(" & Left(mvarPData.Data(pNo, "調査員"), 5) & ")", dX(12), dY, ColW(12), RowH, nFsize - 1, 2
                End If
                    
            Case "日置市"
                If pSubNo = pSubStart Then
                    .TextOut mvarPData.Data(pNo, "受付番号"), (dX(0) + dX(1)) / 2, dY, nFsize, 2, 0  '番号
                    If Len(mvarPData.Data(pNo, "氏名")) <= 20 Then
                        .DrawText mvarPData.Data(pNo, "氏名"), dX(1) + 1, dY + 1, ColW(1) - 1, RowH, nFsize, 0
                    Else
                        .DrawText mvarPData.Data(pNo, "氏名"), dX(1) + 1, dY + 1, ColW(1) - 1, RowH - 1, nFsize - 2, 0
                    End If
                    .DrawText IIf(Len(mvarPData.Data(pNo, "職業")), "(" & mvarPData.Data(pNo, "職業") & ")", ""), dX(1) + 1, dY + 1 + RowH * 2, ColW(1) - 2, RowH, nFsize, 2
                    .DLine dX(1), dY + (RowH * 3) + (RowH / 2), dX(2), dY + (RowH * 3) + (RowH / 2), vbBlack
                    .DrawText StrConv(mvarPData.Data(pNo, "住所"), vbNarrow), dX(1) + 1, dY + RowH * 4 - 1, ColW(1) - 2, RowH, nFsize - 1, 0
                    .DrawText mvarPData.Data(pNo, "転用目的"), dX(7) + 1, dY, ColW(7) - 2, RowH, nFsize, 2
                    .DrawText IIf(Val(mvarPData.Data(pNo, "棟数")) > 0, mvarPData.Data(pNo, "棟数"), ""), dX(8) + 1, dY, ColW(8) - 2, RowH, nFsize, 2
                    .DrawText IIf(Val(mvarPData.Data(pNo, "建築面積")) > 0, FormatNumber(Val(mvarPData.Data(pNo, "建築面積")), 0), ""), dX(9), dY, ColW(9) - 1, RowH, nFsize, 1
                    
                    St2 = mvarPData.Data(pNo, "調査員")
                    If InStr(St2, "\n") = 0 Then
                        i = 0: St1 = ""
                        If Len(St2) > 0 Then
                            For n = Len(St2) To 0 Step (-4)
                                St1 = St1 & MID(St2, i * 4 + 1, 4) & "\n"
                                i = i + 1
                            Next
                            If Right(St1, 2) = "\n" Then St1 = Left(St1, Len(St1) - 2)
                            .DrawText St1, dX(10), dY, ColW(10), RowH, nFsize, 2
                        End If
                    Else
                        .DrawText St2, dX(10), dY, ColW(10), RowH, nFsize, 2
                    End If

                    .DrawText mvarPData.Data(pNo, "同意書"), dX(11), dY + RowH * 2, ColW(11), 4, nFsize, 2
                    .DrawText mvarPData.Data(pNo, "始末書"), dX(12), dY + RowH * 2, ColW(12), 4, nFsize, 2
                    .DrawText mvarPData.Data(pNo, "被害防除計画書"), dX(13), dY + RowH * 2, ColW(13), 4, nFsize, 2
                End If
                        
                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then  '合計行
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(2) + 1, dY, ColW(2), RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(2), dY, ColW(2) - 2, RowH, nFsize, 1
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(5), dY, ColW(5) - 1, RowH, nFsize, 1
                Else
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(2) + 1, dY, ColW(2) - 2, RowH, nFsize, 0
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 1), dX(3), dY, ColW(3), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 1), dX(4), dY, ColW(4), RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(5), dY, ColW(5) - 1, RowH, nFsize, 1
                    End If
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "農振区分"), dX(6), dY, ColW(6), RowH, nFsize, 2
                End If
                
            Case "大崎町"
                If pSubNo = pSubStart Then
                    .TextOut pNo, (dX(0) + dX(1)) / 2, dY, nFsize, 2, 0
                    .DrawText Left(mvarPData.Data(pNo, "氏名"), 12), dX(1) + 1, dY, ColW(1) - 1, RowH, nFsize
                    If Len(mvarPData.Data(pNo, "集落")) = 0 Or mvarPData.Data(pNo, "集落") = "-" Then
                        .DrawText Left(Fnc.GetShortAddress(mvarPData.Data(pNo, "住所"), s都道府県名, s郡部, , , True), 24), dX(1) + 1, dY + RowH, ColW(1) - 1, RowH, nFsize, 0
                    Else
                        .DrawText Left(mvarPData.Data(pNo, "集落"), 24), dX(1) + 1, dY + RowH, ColW(1) - 1, RowH, nFsize
                    End If
                    .DrawText Left(mvarPData.Data(pNo, "職業"), 9), dX(1) + 1, dY + RowH * 3, ColW(1) - 1, RowH, nFsize
                    .DrawText IIf(Val(mvarPData.Data(pNo, "年齢")) > 0, mvarPData.Data(pNo, "年齢") & "歳", ""), dX(1), dY + RowH * 3, ColW(1) - 1, RowH, nFsize, 1

                    .DrawText mvarPData.Data(pNo, "転用目的"), dX(6) + 1, dY, ColW(6) - 1, RowH, nFsize, 2
                    .DrawText IIf(Val(mvarPData.Data(pNo, "建築面積")) = 0, "", FormatNumber(Val(mvarPData.Data(pNo, "建築面積")), 0)), dX(7), dY, ColW(7) - 1, RowH, nFsize, 1
                    If Len(mvarPData.Data(pNo, "時期")) > 0 Then .DrawText Format(mvarPData.Data(pNo, "時期"), "ge年") & "\n" & Format(mvarPData.Data(pNo, "時期"), "m月"), dX(8), dY, ColW(8), 4, nFsize, 2
                    .DrawText mvarPData.Data(pNo, "資金計画"), dX(9) + 1, dY, ColW(9) - 2, 4, nFsize, 2
                    .DrawText mvarPData.Data(pNo, "備考"), dX(13) + 1, dY, ColW(13) - 1, 4, nFsize
                End If

                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then  '合計行
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(2) + 1, dY, ColW(2), RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(2), dY, ColW(2) - 2, RowH, nFsize, 1
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(5), dY, ColW(5) - 1, RowH, nFsize, 1
                ElseIf Val(mvarPData.Data(pNo & ":農地." & pSubNo, "一部")) = 1 Then
                    .TextOut "(" & FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0) & "の内)", dX(6) - 1, dY, nFsize - 2, 1
                Else
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(2) + 1, dY, ColW(2) - 2, RowH, nFsize, 0
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 1), dX(3), dY, ColW(3), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 1), dX(4), dY, ColW(4), RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(5), dY, ColW(5) - 1, RowH, nFsize, 1
                    End If
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "農振区分"), dX(10), dY, ColW(10), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "等級"), 5), dX(11), dY, ColW(11), RowH, nFsize, 2
                End If
            
            Case "長島町", "阿久根市"
                If pSubNo = pSubStart Then
                    .TextOut pNo, (dX(0) + dX(1)) / 2, dY, nFsize, 2, 0  '番号
                    .DrawText Left(mvarPData.Data(pNo, "氏名"), 12), dX(1) + 1, dY + 1, ColW(1) - 2, RowH, nFsize, 2
                    .DrawText IIf(Len(mvarPData.Data(pNo, "職業")), "(" & mvarPData.Data(pNo, "職業") & ")", ""), dX(1) + 1, dY + 1 + RowH, ColW(1) - 2, RowH, nFsize, 2
                    .DLine dX(1), dY + (RowH * 2) + (RowH / 2), dX(2), dY + (RowH * 2) + (RowH / 2), vbBlack
                    .DrawText Left(Fnc.GetShortAddress(mvarPData.Data(pNo, "住所"), s都道府県名, s郡部, , , True), 26), dX(1) + 1, dY + RowH * 3 - 1, ColW(1) - 2, RowH, nFsize - 1, 0
'                    .DrawText Left(mvarPData.Data(pNo, "住所"), 26), dX(1) + 1, dY + RowH * 3 - 1, ColW(1) - 2, RowH, nFsize - 1, 0
                    .DrawText mvarPData.Data(pNo, "転用目的"), dX(7) + 1, dY, ColW(7) - 2, RowH, nFsize, 2
                    .DrawText IIf(Val(mvarPData.Data(pNo, "棟数")) = 0, "", mvarPData.Data(pNo, "棟数")), dX(8) + 1, dY, ColW(8) - 2, RowH, nFsize, 2
                    .DrawText IIf(Val(mvarPData.Data(pNo, "建築面積")) = 0, "", FormatNumber(Val(mvarPData.Data(pNo, "建築面積")), 2)), dX(9), dY, ColW(9) - 1, RowH, nFsize, 1
                    .DrawText mvarPData.Data(pNo, "転用事由"), dX(10) + 1, dY, ColW(10) - 2, RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo, "同意書"), dX(11), dY + RowH * 2, ColW(11), 4, nFsize, 2
                    .DrawText mvarPData.Data(pNo, "始末書"), dX(12), dY + RowH * 2, ColW(12), 4, nFsize, 2
                    .DrawText mvarPData.Data(pNo, "被害防除計画書"), dX(13), dY + RowH * 2, ColW(13), 4, nFsize, 2
                End If
                
                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(2) + 1, dY, ColW(2), RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(2), dY, ColW(2) - 2, RowH, nFsize, 1
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(5), dY, ColW(5) - 1, RowH, nFsize, 1
                Else
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(2) + 1, dY, ColW(2) - 2, RowH, nFsize, 0
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 1), dX(3), dY, ColW(3), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 1), dX(4), dY, ColW(4), RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(5), dY, ColW(5) - 1, RowH, nFsize, 1
                    End If
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "農振区分"), dX(6), dY, ColW(6), RowH, nFsize, 2
                End If
            
            Case Else
                If pSubNo = pSubStart Then
                    .TextOut pNo, (dX(0) + dX(1)) / 2, dY, nFsize, 2, 0  '番号
                    .DrawText Left(mvarPData.Data(pNo, "氏名"), 12), dX(1) + 1, dY + 1, ColW(1) - 2, RowH, nFsize, 2
                    .DrawText IIf(Len(mvarPData.Data(pNo, "職業")), "(" & mvarPData.Data(pNo, "職業") & ")", ""), dX(1) + 1, dY + 1 + RowH, ColW(1) - 2, RowH, nFsize, 2
                    .DLine dX(1), dY + (RowH * 2) + (RowH / 2), dX(2), dY + (RowH * 2) + (RowH / 2), vbBlack
                    .DrawText Left(mvarPData.Data(pNo, "住所"), 26), dX(1) + 1, dY + RowH * 3 - 1, ColW(1) - 2, RowH, nFsize - 1, 0
                    .DrawText mvarPData.Data(pNo, "転用目的"), dX(7) + 1, dY, ColW(7) - 2, RowH, nFsize, 2
                    .DrawText IIf(Val(mvarPData.Data(pNo, "棟数")) = 0, "", mvarPData.Data(pNo, "棟数")), dX(8) + 1, dY, ColW(8) - 2, RowH, nFsize, 2
                    .DrawText IIf(Val(mvarPData.Data(pNo, "建築面積")) = 0, "", FormatNumber(Val(mvarPData.Data(pNo, "建築面積")), 2)), dX(9), dY, ColW(9) - 1, RowH, nFsize, 1
                    .DrawText mvarPData.Data(pNo, "転用事由"), dX(10) + 1, dY, ColW(10) - 2, RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo, "同意書"), dX(11), dY + RowH * 2, ColW(11), 4, nFsize, 2
                    .DrawText mvarPData.Data(pNo, "始末書"), dX(12), dY + RowH * 2, ColW(12), 4, nFsize, 2
                    .DrawText mvarPData.Data(pNo, "被害防除計画書"), dX(13), dY + RowH * 2, ColW(13), 4, nFsize, 2
                End If
                
                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(2) + 1, dY, ColW(2), RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(2), dY, ColW(2) - 2, RowH, nFsize, 1
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(5), dY, ColW(5) - 1, RowH, nFsize, 1
                Else
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(2) + 1, dY, ColW(2) - 2, RowH, nFsize, 0
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 1), dX(3), dY, ColW(3), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 1), dX(4), dY, ColW(4), RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(5), dY, ColW(5) - 1, RowH, nFsize, 1
                    End If
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "農振区分"), dX(6), dY, ColW(6), RowH, nFsize, 2
                End If

            End Select
        End With
    End Sub

    Private Sub PrintSubTotal(ByRef mvarParent As ADBasicLIB2.CPrintFormSK, ByRef dX() As Single, ByRef hX() As Single, dY As Single)
        Dim n As Long
        Dim wdy As Single
        Dim Xcnt As Long
        Dim b表示 As Boolean
        
        If T総合計.n筆数(3) = 0 Then Exit Sub
        wdy = dY
        Xcnt = UBound(ColW) + 1
                
        With mvarParent
            Select Case Fnc.s市町村名
            Case "姶良市"
                b表示 = False
                For n = 0 To 3
                    If Val(T総合計.n面積(n)) - Fix(Val(T総合計.n面積(n))) <> 0 Then
                        b表示 = True
                        Exit For
                    End If
                Next
                For n = 0 To 3
                    If T総合計.n筆数(n) > 0 Then
                        .DrawText T総合計.s地目(n), dX(2) + 1, dY, ColW(2), RowH, nFsize
                        .DrawText T総合計.n筆数(n) & " 筆", dX(2), dY, ColW(2) - 2, RowH, nFsize, 1
                        If b表示 Then
                            .TextOut Format(Val(T総合計.n面積(n)), "#,##0.00"), dX(6) - 1, dY, nFsize, 1
                        Else
                            .DrawText Format(Val(T総合計.n面積(n)), "#,##0"), dX(5), dY, ColW(5) - 1, RowH, nFsize, 1
                        End If
    '                        .DrawText FormatNumber(Val(T総合計.n面積(n)), 0), dX(5), dY, ColW(5) - 1, RowH, nFsize, 1
                        dY = dY + RowH
                    End If
                Next
                .DrawText "［　総 合 計　］", dX(0), wdy + (dY - wdy) / 2, dX(2) - dX(0), RowH, nFsize, 2, 2
                .DLine dX(0), wdy - 1, dX(0), dY
                .DLine dX(2), wdy - 1, dX(2), dY
                .DLine dX(3), wdy - 1, dX(3), dY
                .DLine dX(6), wdy - 1, dX(6), dY
                .DLine dX(Xcnt), wdy - 1, dX(Xcnt), dY
                .DLine dX(0), dY, dX(Xcnt), dY
                
            End Select
        End With
    End Sub


    Private Sub CPrintSub_SetData(ByVal sKey As String, Optional ByVal sParam1 As String = "", Optional ByVal sParam2 As String = "")
    
    End Sub

    Private Sub Class_Initialize()
        Dim n As Long
        Dim Rs As ADBasicLIB2.RecordsetEx
        
        Set mvarPData = New CPrintDatas
        mvarPData.Headers = _
        "受付番号;受付年月日;受付補助記号;" & _
        "氏名;住所;集落;職業;年齢;転用目的;棟数;建築面積;転用事由;同意書;始末書;被害防除計画書;理由書;調査員;" & _
        "用途;資金計画;被害防除概要;建ぺい率;所要面積;備考;通年受付番号;期間;時期;共有持分;農地区分;農地区分補足;協議状況;" & _
        "工事開始年1;工事開始月1;工事終了年1;工事終了月1;工事開始年2;工事開始月2;工事終了年2;工事終了月2;" & _
        ">農地;土地所在;登記地目;現況地目;面積;農振区分;都市計画法;都市計画法ID;等級;土地改良法;持分;所有者名;所有者住所;小数点;一部;"
    
        For n = 0 To PGMAX
            PgChgSt(n) = 0
            PgChgEn(n) = 0
        Next
        DataCnt = 0
        PageCnt = 0
        PageMax = 0
        PageNow = 1
        s支所 = ""
        
        For n = 0 To 3
            T総合計.s地目(n) = ""
            T総合計.n筆数(n) = 0
            T総合計.n面積(n) = 0
        Next
        
        Set Rs = SystemDB.GetRecordsetEx("SELECT ID,名称 FROM [M_BASICALL] WHERE [Class]='農地区分'", 0, , Me)
        Do Until Rs.EOF
            p農地区分.Add Rs.Value("ID"), Rs.Value("名称")
            Rs.MoveNext
        Loop
        SystemDB.CloseRs Rs
        
        Set Rs = SystemDB.GetRecordsetEx("SELECT ID,名称 FROM [M_BASICALL] WHERE [Class]='都市計画区分'", 0, , Me)
        Do Until Rs.EOF
            p都計区分.Add Rs.Value("ID"), Rs.Value("名称")
            Rs.MoveNext
        Loop
        SystemDB.CloseRs Rs
        
        Set Rs = SystemDB.GetRecordsetEx("SELECT ID,名称 FROM [M_BASICALL] WHERE [Class]='申請時農振区分'", 0, , Me)
        Do Until Rs.EOF
            p農振区分.Add Rs.Value("ID"), Rs.Value("名称")
            Rs.MoveNext
        Loop
        SystemDB.CloseRs Rs
        
        Set Rs = SystemDB.GetRecordsetEx("SELECT ID,名称 FROM [M_BASICALL] WHERE [Class]='支所番号'", 0, , Me)
        Do Until Rs.EOF
            p支所番号.Add Rs.Value("ID"), Rs.Value("名称")
            Rs.MoveNext
        Loop
        SystemDB.CloseRs Rs
    
    End Sub

    Private Sub CPrintSub_SetRsData(pRs As Object)
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim RsT As ADBasicLIB2.RecordsetEx
        Dim n As Long
        Dim i As Long
        Dim St As String
        Dim nFlag(3) As Integer     '合計行作成用フラグ
        Dim W As Long
        Dim nSubCount As Long
        Dim b合計出力 As Boolean
        Dim n面積 As Double
        Dim n集計面積 As Double
        Dim n部分面積 As Double
        Dim n行数 As Long
        Dim n最大行数 As Long
        Dim n転用事由文字数 As Long
        Dim n被害防除文字数 As Long
        Dim n備考文字数 As Long
        Dim n地目区分 As Long
        Dim p合計 As TotalData
        Dim n所有者 As Long
        Dim n分母(3) As Long
        Dim n分子(3) As Long
        Dim nWork As Long
        Dim Ar As Variant, Cm As Variant
        Dim b支所 As Boolean
        Dim b支所改頁 As Boolean
        Dim sSQL As String
        Dim b一部現況 As Boolean
       
        Ar = Split(mvarData, vbCrLf)
        Cm = Split(Ar(1), ";")
        s都道府県名 = Cm(0)
        s郡部 = Cm(1)
        If Cm(2) = "" Then b支所改頁 = False Else b支所改頁 = CBool(Cm(2))
        If Cm(3) = "" Then b支所 = False Else b支所 = CBool(Cm(3))
        mvarTitle = SystemDB.DBProperty("議案書４条タイトル")

        T総合計.s地目(0) = "( 田 )"
        T総合計.s地目(1) = "( 畑 )"
        T総合計.s地目(2) = "( 他 )"
        T総合計.s地目(3) = "( 計 )"
        
        For n = 0 To 3
            n分母(n) = 0
            n分子(n) = 0
        Next
        n所有者 = 0

        b合計出力 = True
        n転用事由文字数 = 0         ' 転用事由１行の文字数
        n被害防除文字数 = 0         ' 被害防除概要１行の文字数
        n備考文字数 = 0
        b一部現況 = False
        Select Case Fnc.s市町村名
            Case "姶良市"
                HMax = 6                '基本データMAX
                LMax = 28               '１ページの行数
                ColW = GetArray(8, 50, 58, 6, 6, 20, 20, 31, 32, 42)
                StartX = 10             'データ始点(X)
                StartY = 48             'データ始点(Y)
                nFsize = 11           'フォントサイズ
                RowH = 5           '行幅
                n備考文字数 = 10
                b一部現況 = True
            Case "枕崎市"
                HMax = 3                '基本データMAX
                LMax = 28               '１ページの行数
                n転用事由文字数 = 15
                ColW = GetArray(12, 56, 12, 22, 32, 32, 65, 30)
                StartX = 20             'データ始点(X)
                StartY = 41             'データ始点(Y)
                nFsize = 11           'フォントサイズ
                RowH = 5           '行幅
               
            Case "南種子町"
                HMax = 22               '基本データMAX
                LMax = 22               '１ページの行数
                StartX = 25             'データ始点(X)
                StartY = 50             'データ始点(Y)
                nFsize = 8           'フォントサイズ
                ColW = GetArray(5, 14, 26, 38, 8, 8, 8, 16, 14, 14, 14, 14, 28, 32, 18) '表のデータ枠幅
                RowH = 6           '行幅
'                n転用事由文字数 = 9
'                n被害防除文字数 = 10
                
            Case "さつま町"
                StartX = 7              'データ始点(X)
                StartY = 57             'データ始点(Y)
                nFsize = 11           'フォントサイズ
                ColW = GetArray(6, 50, 12, 12, 10, 10, 10, 24, 40, 30, 10, 36, 24, 6) '表のデータ枠幅
                RowH = 5           '行幅
                HMax = 6                '基本データMAX
                LMax = 27               '１ページの行数
                n転用事由文字数 = 8
                    
            Case "三股町"
                HMax = 4                '基本データMAX
                LMax = 20               '１ページの行数
                StartX = 20             'データ始点(X)
                StartY = 56             'データ始点(Y)
                nFsize = 10           'フォントサイズ
                ColW = GetArray(5, 5, 62, 46, 8, 8, 16, 8, 5, 16, 16, 8, 14, 5, 5, 5, 13, 10)
                RowH = 5           '行幅
                b合計出力 = False

            Case "日置市"
                HMax = 6                '基本データMAX
                LMax = 26               '１ページの行数
                ColW = GetArray(6, 50, 60, 6, 6, 18, 10, 25, 10, 16, 30, 6, 6, 6)
                StartX = 20
                StartY = 54
                nFsize = 11
                RowH = 5
                
            Case "大崎町"
                HMax = 5                '基本データMAX
                LMax = 30               '１ページの行数
                ColW = GetArray(6, 46, 45, 6, 6, 18, 25, 16, 16, 18, 10, 20, 7, 20)
                StartX = 21             'データ始点(X)
                StartY = 48             'データ始点(Y)
                nFsize = 10           'フォントサイズ
                RowH = 4           '行幅
                b一部現況 = True

            Case Else
                HMax = 5                '基本データMAX
                LMax = 25               '１ページの行数
                ColW = GetArray(6, 50, 45, 6, 6, 15, 10, 25, 10, 16, 55, 6, 6, 6)
                StartX = 21             'データ始点(X)
                StartY = 54             'データ始点(Y)
                nFsize = 11           'フォントサイズ
                RowH = 5           '行幅
                n転用事由文字数 = 13
        End Select

        ' データ作成
        With mvarPData
            Set Rs = pRs
            n = .NewLine
            If b支所改頁 And (s支所 <> Rs.Value("受付補助記号")) Then DataCnt = LMax
            .SetRsDataList n, "受付番号;受付年月日", Rs
            
            If b支所 Then
                If p支所番号.Exists(Rs.Value("支所番号")) Then
                    .Data(n, "受付補助記号") = p支所番号.Item(Rs.Value("支所番号"))
                Else
                    .Data(n, "受付補助記号") = ""
                End If
            Else
                .Data(n, "受付補助記号") = Rs.NullCast("受付補助記号", "")
            End If
           
            If Not Rs.IsNull("代理人名") And Rs.Value("代理人名") <> "" Then
                .SetRsData n, "氏名", Rs, "代理人名"
            ElseIf Not Rs.IsNull("氏名A") And Rs.Value("氏名A") <> "" Then
                .SetRsData n, "氏名", Rs, "氏名A"
            ElseIf Not Rs.IsNull("参照A") And Rs.Value("参照A") <> "" Then
                .SetRsData n, "氏名", Rs, "参照A"
            End If
           
            .SetRsData n, "通年受付番号", Rs
            .SetRsData n, "住所", Rs, "住所A"
            .SetRsData n, "集落", Rs, "集落A"
            .SetRsData n, "職業", Rs, "職業A"
            .SetRsData n, "年齢", Rs, "年齢A"
            .SetRsData n, "転用目的", Rs, "申請理由A"
            .SetRsData n, "棟数", Rs, "数量"
            .SetRsData n, "建築面積", Rs, "建築面積"
            .SetRsData n, "転用事由", Rs, "申請理由B"
            .Data(n, "同意書") = IIf(Rs.Value("同意書") = True, "○", "")
            .Data(n, "始末書") = IIf(Rs.Value("始末書") = True, "○", "")
            .Data(n, "被害防除計画書") = IIf(Rs.Value("被害防除計画書") = True, "○", "")
            .Data(n, "理由書") = IIf(Rs.Value("理由書") = True, "○", "")
            .Data(n, "協議状況") = IIf(Rs.Value("被害防除計画書") = True, "被害防除計画あり", "") & IIf(Rs.Value("同意書") = True, "\n同意書あり", "") & IIf(Rs.Value("始末書") = True, "\n始末書あり", "") & IIf(Rs.Value("理由書") = True, "\n面積越理由書あり", "")

            .SetRsData n, "用途", Rs
            .SetRsData n, "資金計画", Rs
            .SetRsData n, "被害防除概要", Rs
            .SetRsData n, "建ぺい率", Rs
            .SetRsData n, "所要面積", Rs
            .SetRsData n, "工事開始年1", Rs
            .SetRsData n, "工事開始月1", Rs
            .SetRsData n, "工事終了年1", Rs
            .SetRsData n, "工事終了月1", Rs
            .SetRsData n, "工事開始年2", Rs
            .SetRsData n, "工事開始月2", Rs
            .SetRsData n, "工事終了年2", Rs
            .SetRsData n, "工事終了月2", Rs
            .SetRsData n, "備考", Rs
            .SetRsData n, "農地区分補足", Rs
            .Data(n, "時期") = IIf(Rs.IsNull("時期") Or Rs.Value("時期") = "0:00:00", "", Rs.Value("時期"))
            
            If Fnc.s市町村名 = "南種子町" Then
                .SetRsData n, "調査員", Rs, "調査員A"
            ElseIf Not Rs.IsNull("調査員A") Then
                .Data(n, "調査員") = Replace(Replace(StrConv(Rs.Value("調査員A"), vbNarrow), ",", "\n"), "､", "\n")
            End If
            
            .Data(n, "農地区分") = ""
            If Rs.IsNull("農地区分") Then
            ElseIf p農地区分.Exists(Rs.Value("農地区分")) Then
                .Data(n, "農地区分") = p農地区分.Item(Rs.Value("農地区分"))
            End If
            
            If Rs.IsNull("農振区分") Then
            ElseIf p農地区分.Exists(Rs.Value("農振区分")) Then
                .Data(n, "農地区分") = .Data(n, "農地区分") & "\n\n" & p農振区分.Item(Rs.Value("農振区分"))
            End If
            
            If Rs.IsNull("都市計画区分") Then
            ElseIf p都計区分.Exists(Rs.Value("都市計画区分")) Then
                .Data(n, "農地区分") = .Data(n, "農地区分") & "\n\n" & p都計区分.Item(Rs.Value("都市計画区分"))
            End If
                       
            If Rs.Value("永久") Then
                .Data(n, "期間") = 0
            ElseIf Not Rs.IsNull("期間") And Rs.Value("期間") <> 0 Then
                .SetRsData n, "期間", Rs
            ElseIf IsDate(Rs.Value("始期")) And IsDate(Rs.Value("終期")) Then
                .Data(n, "期間") = DateDiff("yyyy", Rs.Value("始期"), Rs.Value("終期"))
            Else
                .Data(n, "期間") = 0
            End If
            .Data(n, "共有持分") = 0
            
            For W = 0 To 3
                p合計.n面積(W) = 0
                p合計.n筆数(W) = 0
            Next
            i = 0

            If Rs.IsNull("農地リスト") Then
            ElseIf Len(Rs.Value("農地リスト")) > 3 Then
                St = Replace(Replace(Rs.Value("農地リスト"), "農地.", ""), ";", ",")
                sSQL = "SELECT [V_農地].*,[V_地目].名称 AS [登記地目],[地目2].名称 AS [現況],[V_農委地目].名称 AS [農委地目],[D:個人Info].氏名 AS [所有者名],[D:個人Info].住所 AS [所有者住所],[D_部分申請].部分面積 AS [部分面積T] "
                sSQL = sSQL & "FROM (((([V_農地] LEFT JOIN [V_地目] ON [V_農地].[登記簿地目]=[V_地目].ID) LEFT JOIN V_現況地目 AS 地目2 ON [V_農地].[現況地目]=[地目2].ID) LEFT JOIN [V_農委地目] ON [V_農地].[農委地目ID]=[V_農委地目].ID) LEFT JOIN [D:個人Info] ON [V_農地].[管理人ID]=[D:個人Info].ID) LEFT JOIN [D_部分申請] ON [V_農地].ID = [D_部分申請].農地ID "
                sSQL = sSQL & "WHERE [V_農地].[ID] IN (" & St & ") "
                If Fnc.s市町村名 = "姶良市" Then
                    sSQL = sSQL & "ORDER BY [V_農地].[大字ID],[V_農地].[小字ID],val(IIf(IsNull([地番]),0,IIf(InStr([地番],'-')=0,Val([地番]),val(Left([地番],InStr([地番],'-')-1)))) *1000 + Val(IIf(IsNull([地番]),0,IIf(InStr([地番],'-')=0,0,val(Mid([地番],InStr([地番],'-')+1))))))"
                Else
                    sSQL = sSQL & "ORDER BY [V_農地].[管理人ID],[V_農地].[土地所在];"
                End If
                
                Set RsT = SystemDB.GetRecordsetEx(sSQL, 1, , "議案書")
                Do Until RsT.EOF
                    i = i + 1
                    .SetRsData n & ":農地." & i, "土地所在", RsT
                    .SetRsData n & ":農地." & i, "登記地目", RsT
                    
                    If (Not RsT.IsNull("農委地目ID")) And (RsT.Value("農委地目ID") <> 0) And (Not RsT.IsNull("農委地目認定日")) And (RsT.Value("農委地目認定日") <> "0:00:00") Then
                        .SetRsData n & ":農地." & i, "現況地目", RsT, "農委地目"
                    Else
                        .SetRsData n & ":農地." & i, "現況地目", RsT, "現況"
                    End If
                    
                    .SetRsData n & ":農地." & i, "等級", RsT
                    .SetRsData n & ":農地." & i, "都市計画法ID", RsT, "都市計画法"
                    
                    If Fnc.s市町村名 = "南種子町" Then
                        Select Case RsT.Value("農業振興地域")
                            Case 1:    .Data(n & ":農地." & i, "農振区分") = "農用地内"
                            Case 2:    .Data(n & ":農地." & i, "農振区分") = "振興地域外"
                            Case Else: .Data(n & ":農地." & i, "農振区分") = "農用地外"
                        End Select
                        
                        Select Case RsT.Value("都市計画法")
                            Case 0:    .Data(n & ":農地." & i, "都市計画法") = "都市計画区域外"
                            Case 1:    .Data(n & ":農地." & i, "都市計画法") = "都市計画区域内"
                            Case 2:    .Data(n & ":農地." & i, "都市計画法") = "用途地域内"
                            Case 3:    .Data(n & ":農地." & i, "都市計画法") = "調整区域内"
                            Case 4:    .Data(n & ":農地." & i, "都市計画法") = "市街化区域内"
                        End Select
                    Else
                        Select Case RsT.Value("農業振興地域")
                            Case 1:    .Data(n & ":農地." & i, "農振区分") = "地内"
                            Case 2:    .Data(n & ":農地." & i, "農振区分") = "振外"
                            Case Else: .Data(n & ":農地." & i, "農振区分") = "地外"
                        End Select
                    
                        Select Case RsT.Value("都市計画法")
                            Case 0:    .Data(n & ":農地." & i, "都市計画法") = "区外"
                            Case 1:    .Data(n & ":農地." & i, "都市計画法") = "区内"
                            Case 2:    .Data(n & ":農地." & i, "都市計画法") = "用途"
                            Case 3:    .Data(n & ":農地." & i, "都市計画法") = "調内"
                            Case 4:    .Data(n & ":農地." & i, "都市計画法") = "区内"   '市街化区域内
        '                    Case 0:    .Data(n & ":農地." & i, "都市計画法") = "区外"
        '                    Case 1:    .Data(n & ":農地." & i, "都市計画法") = "調内"
        '                    Case 2:    .Data(n & ":農地." & i, "都市計画法") = "区内"   '市街化区域内
        '                    Case 3:    .Data(n & ":農地." & i, "都市計画法") = "準住"
        '                    Case 4:    .Data(n & ":農地." & i, "都市計画法") = "区内"
        '                    Case 5:    .Data(n & ":農地." & i, "都市計画法") = "用途"
                            Case Else: .Data(n & ":農地." & i, "都市計画法") = ""
                        End Select
                    End If
        
                    Select Case RsT.Value("土地改良法")
                        Case 0:    .Data(n & ":農地." & i, "土地改良法") = "区外"
                        Case 1:    .Data(n & ":農地." & i, "土地改良法") = "区内"
                        Case Else: .Data(n & ":農地." & i, "土地改良法") = ""
                    End Select
                                        
                    n部分面積 = 0
                    If Not RsT.IsNull("部分面積T") Then n部分面積 = RsT.Value("部分面積T")
                    
                    n地目区分 = 2                   '他
                    n面積 = 0
                    If RsT.Value("田面積") <> 0 Then
                        n面積 = RsT.Value("田面積")
                        n地目区分 = 0               '田
                    ElseIf RsT.Value("畑面積") <> 0 Then
                        n面積 = RsT.Value("畑面積")
                        n地目区分 = 1               '畑
                    Else
                        If RsT.Value("樹園地") <> 0 Then n面積 = RsT.Value("樹園地")
                        If RsT.Value("採草放牧面積") <> 0 Then n面積 = RsT.Value("採草放牧面積")
                    End If
                    If n面積 = 0 Or Fnc.s市町村名 = "南種子町" Then n面積 = Fnc.NullCast(RsT.Value("登記簿面積"), 0)
                    n集計面積 = n面積
                    
                    If n部分面積 > 0 Then
                        If Fnc.s市町村名 = "南種子町" Then
                            .Data(n & ":農地." & i, "面積") = n集計面積
                            i = i + 1
                        End If
                        n集計面積 = n部分面積
                    End If

                    If Fnc.s市町村名 = "姶良市" Then
                        If n集計面積 >= 10 Then
                            n集計面積 = Fix(n集計面積)
                            .Data(n & ":農地." & i, "小数点") = 0
                        Else
                            .Data(n & ":農地." & i, "小数点") = 1
                        End If
                    ElseIf Fnc.s市町村名 <> "南種子町" Then
                        n集計面積 = Fix(n集計面積)
                    End If
                    .Data(n & ":農地." & i, "面積") = n集計面積
    
                    .Data(n & ":農地." & i, "一部") = 0
                    If RsT.IsNull("一部現況") Then
                    ElseIf b一部現況 And Val(RsT.Value("一部現況")) > 0 Then
                        i = i + 1
                        .Data(n & ":農地." & i, "一部") = 1
                        n面積 = Fnc.NullCast(RsT.Value("登記簿面積"), 0)
                        If n面積 >= 10 And Fnc.s市町村名 <> "南種子町" Then
                            .Data(n & ":農地." & i, "面積") = Fix(n面積)
                        Else
                            .Data(n & ":農地." & i, "面積") = n面積
                        End If
                    End If
                    
                    If Not RsT.IsNull("共有持分分母") And RsT.Value("共有持分分母") <> 0 Then
                        If n分子(n地目区分) = 0 And n分母(n地目区分) = 0 Then
                            n分子(n地目区分) = RsT.Value("共有持分分子")
                            n分母(n地目区分) = RsT.Value("共有持分分母")
                        Else
                            n分子(n地目区分) = n分子(n地目区分) * RsT.Value("共有持分分母")
                            n分子(n地目区分) = n分子(n地目区分) + RsT.Value("共有持分分子") * n分母(n地目区分)
                            n分母(n地目区分) = n分母(n地目区分) * RsT.Value("共有持分分母")
                        End If
                    Else
                        If n分子(n地目区分) = 0 And n分母(n地目区分) = 0 Then
                            n分子(n地目区分) = 1
                            n分母(n地目区分) = 1
                        Else
                            n分子(n地目区分) = n分子(n地目区分) + n分母(n地目区分)
                        End If
                    End If
                    p合計.n面積(n地目区分) = p合計.n面積(n地目区分) + n集計面積
                    nFlag(n地目区分) = 1
                    
                    If Not RsT.IsNull("共有持分分母") And RsT.Value("共有持分分母") <> 0 Then
                        .Data(n & ":農地." & i, "持分") = RsT.Value("共有持分分子") & "/" & RsT.Value("共有持分分母")
                        .Data(n, "共有持分") = 1
                    End If
                    If n所有者 <> RsT.Value("管理人ID") Then
                        .SetRsData n & ":農地." & i, "所有者名", RsT
                        .SetRsData n & ":農地." & i, "所有者住所", RsT
                        n所有者 = RsT.Value("管理人ID")
                    End If
                    
                    RsT.MoveNext
                Loop
                SystemDB.CloseRs RsT
            End If
            For W = 0 To 2
                If nFlag(W) = 1 Then
                    p合計.n筆数(W) = n分子(W) \ n分母(W)
                    n分子(W) = n分子(W) Mod n分母(W)
                End If
            Next

            s支所 = Rs.NullCast("受付補助記号", "")
            Set Rs = Nothing
    
            nSubCount = .SubCount(n & ":農地")
            
            ' 文字数チェックチェック
            If HMax > nSubCount + 1 Then
                n行数 = HMax
            Else
                n行数 = nSubCount + 1
            End If
            n最大行数 = LenCheck(.Data(n, "転用事由"), n転用事由文字数, n行数)
            If n最大行数 > LMax Then
                n最大行数 = LMax
                St = Left(.Data(n, "転用事由"), n転用事由文字数 * LMax)
                .Data(n, "転用事由") = St
            End If
            
            n最大行数 = LenCheck(.Data(n, "被害防除概要"), n被害防除文字数, n最大行数)
            If n最大行数 > LMax Then
                n最大行数 = LMax
                St = Left(.Data(n, "被害防除概要"), n被害防除文字数 * LMax)
                .Data(n, "被害防除概要") = St
            End If
            
            n最大行数 = LenCheck(.Data(n, "備考"), n備考文字数, n最大行数)
            If n最大行数 > LMax Then
                n最大行数 = LMax
                St = Left(.Data(n, "備考"), n備考文字数 * LMax)
                .Data(n, "備考") = St
            End If

                        
            ' 合計行作成
            If b合計出力 Then
                p合計.n筆数(3) = p合計.n筆数(0) + p合計.n筆数(1) + p合計.n筆数(2)
                p合計.n面積(3) = p合計.n面積(0) + p合計.n面積(1) + p合計.n面積(2)
                nFlag(3) = nFlag(0) + nFlag(1) + nFlag(2)
                
                For W = 0 To 3
                    T総合計.n筆数(W) = T総合計.n筆数(W) + p合計.n筆数(W)
                    T総合計.n面積(W) = T総合計.n面積(W) + p合計.n面積(W)
                Next
        
                If nFlag(3) = 1 Then
                    nFlag(0) = 0: nFlag(1) = 0: nFlag(2) = 0: nFlag(3) = 0
                End If
                nFlag(3) = nFlag(3) + 1
        
                If nSubCount + nFlag(3) < n最大行数 Then
                    i = n最大行数 - nFlag(3)
                Else
                    i = nSubCount + 1
                End If
                If Fnc.s市町村名 = "南種子町" And nSubCount = 0 Then
                    i = i + 1
                    .Data(n & ":農地." & i, "土地所在") = ""
                Else
                    nWork = 0
                    For W = 0 To 3
                        If p合計.n面積(W) - Fix(p合計.n面積(W)) <> 0 Then
                            nWork = 1
                            Exit For
                        End If
                    Next
                    For W = 0 To 3
                        If nFlag(W) > 0 Then
                            i = i + 1
                            .Data(n & ":農地." & i, "土地所在") = T総合計.s地目(W)
                            St = Format(p合計.n筆数(W), "#")
                            If n分子(W) <> 0 And W < 3 Then
                                If p合計.n筆数(W) > 0 Then St = St & "・"
                                計算A n分子(W), n分母(W)
                                St = St & n分子(W) & "/" & n分母(W)
                            End If
                            .Data(n & ":農地." & i, "登記地目") = St
'                            .Data(n & ":農地." & i, "登記地目") = p合計.n筆数(w)
                            .Data(n & ":農地." & i, "現況地目") = "99999"      'データ行との区分：合計行に"99999"セット
                            .Data(n & ":農地." & i, "面積") = p合計.n面積(W)
                            .Data(n & ":農地." & i, "小数点") = nWork
                        End If
                    Next
                End If
            Else
                i = nSubCount + 1
                If i <= n最大行数 Then
                    W = i
                Else
                    W = i Mod n最大行数
                    If W = 0 Then W = n最大行数
                End If
                Do While W < n最大行数
                    i = i + 1
                    .Data(n & ":農地." & i, "土地所在") = ""
                    W = W + 1
                Loop
                
                If Fnc.s市町村名 = "三股町" Then
                    i = nSubCount + 1
                    W = i Mod HMax
                    If W <> 0 Then
                        Do While W < HMax
                            i = i + 1
                            .Data(n & ":農地." & i, "土地所在") = ""
                            W = W + 1
                        Loop
                    End If
                End If
            End If
            
            ' ページ切替番号設定
            SetPageNo n, n最大行数
        End With
    End Sub

    Private Sub SetPageNo(nDataNo As Long, pHMax)
        Dim n As Long
        Dim i As Long
        Dim nSubCount As Long
        Dim nCount As Long
        Dim wCount As Long
        
        n = nDataNo
        nSubCount = mvarPData.SubCount(n & ":農地")

        nCount = DataCnt + nSubCount + 1      ' .SubCountは 0からみているため
        wCount = nSubCount + 1                '             件数として扱うときは１プラス

        If nCount > LMax Then
            nCount = nSubCount + 1
            i = 0
            Do While nCount > 0
                i = i + 1
                PageCnt = PageCnt + 1
                PgChgSt(PageCnt) = n * 1000 + (i - 1) * LMax
                PgChgEn(PageCnt) = n * 1000 + i * LMax - 1
                nCount = nCount - LMax
            Loop
            DataCnt = 0
            wCount = nCount + LMax
            If wCount < pHMax Then
                wCount = pHMax
            End If
        ElseIf n = 1 Then
            PageCnt = PageCnt + 1
            PgChgSt(PageCnt) = n * 1000
        End If

        PgChgEn(PageCnt) = n * 1000 + nSubCount
        DataCnt = DataCnt + wCount
        PageMax = PageCnt
    End Sub

    Private Function LenCheck(pStr As String, pWLen As Long, pLenMax As Long) As Long
        Dim n As Long
        Dim nAscCode As Integer
        Dim nCount As Long
        Dim nLen As Long
        Dim nLen2 As Long
       
        LenCheck = pLenMax
        If pWLen = 0 Then Exit Function
        If Len(pStr) = 0 Then Exit Function
                   
        nCount = 0
         
        For n = 1 To Len(pStr)
            nCount = nCount + 1
            nAscCode = Asc(MID(pStr, n, 1))
            If Len(Hex(nAscCode)) > 2 Then
                nCount = nCount + 1
            End If
        Next
        nLen = (nCount \ pWLen) + IIf((nCount Mod pWLen) = 0, 0, 1)
        nLen2 = (nLen \ 2) + IIf((nLen Mod 2) = 0, 0, 1)
        If nLen2 > pLenMax Then LenCheck = nLen2
    End Function

    Private Sub 計算A(pDataA As Long, pDataB As Long)
        Dim n As Long
        
        n = 2
        Do While (n < pDataA And n < pDataB)
            If (pDataA Mod n = 0) And (pDataB Mod n = 0) Then
                pDataA = pDataA / n
                pDataB = pDataB / n
                Exit Do
            End If
            n = n + 1
        Loop
    End Sub
    Private Property Let CPrintSub_StartPage(RHS As Long): mvarStartPage = RHS: End Property
    Private Property Get CPrintSub_StartPage() As Long: CPrintSub_StartPage = mvarStartPage: End Property


End Class










Class CPrintSub農地法5条
    Option Explicit
    Implements CPrintSub
    Private mvarKey As String
    Private mvarData As String
    Private mvarPData As CPrintDatas
    Private mvar議案番号 As Long
    Private Const PGMAX As Long = 100   'ページ切替ＭＡＸ
    Private PgChgSt(PGMAX) As Long      'ページ切替開始番号
    Private PgChgEn(PGMAX) As Long      'ページ切替終了番号
    Private DataCnt As Long             'データカウント
    Private PageCnt As Long             'ページカウント
    Private HMax As Long                '基本データMAX
    Private LMax As Long                '１ページの行数
    Private PageMax As Long             'ページＭＡＸ
    Private PageNow As Long             '現在のページ
    Private StartX As Single            'データ始点(X)
    Private StartY As Single            'データ始点(Y)
    Private nFsize As Integer           'フォントサイズ
    Private RowH As Long                '１行の高さ
    Private ColW As Variant             '表枠の幅
    Private s支所 As String
    Private s都道府県名 As String
    Private s郡部 As String
    
    Private p農地区分 As New CDataDictionary
    Private p農振区分 As New CDataDictionary
    Private p都計区分 As New CDataDictionary
    
    Private p支所番号 As New CDataDictionary
    Private mvarStartPage As Integer
    Private mvarTitle As String
    Private UBN As Integer

    Private Type TotalData
        s地目(4) As String
        n筆数(4) As Long
        n面積(4) As Double
    End Type
    Private T総合計 As TotalData
    
    Private Property Let CPrintSub_Data(ByVal RHS As String): Dim Cm As Variant: mvarData = RHS: Cm = Split(mvarData, ";"): mvarStartPage = Val(Cm(2)) - (Val(Cm(2)) = 2) * (Val(Cm(3)) - 2): End Property
    Private Property Get CPrintSub_Data() As String: CPrintSub_Data = mvarData: End Property

    Private Property Let CPrintSub_Key(ByVal RHS As String): mvarKey = RHS: End Property
    Private Property Get CPrintSub_Key() As String: CPrintSub_Key = mvarKey: End Property

    Private Property Get CPrintSub_MaxPage() As Long: CPrintSub_MaxPage = PageMax: End Property
    
    Private Property Get CPrintSub_NowPage() As Long: CPrintSub_NowPage = PageNow: End Property

    Private Sub CPrintSub_PrintSub(ByVal sKey As String, ByVal nPage As Long, mvarParent As ADBasicLIB2.CPrintFormSK)
        Dim Ar As Variant, Cm As Variant
        Dim n As Single
        Dim i As Long
        Dim K As Long
        Dim hY As Single        ' 基本データY座標
        Dim dY As Single        ' 土地データY座標
        Dim dX(20) As Single, hX(20) As Single   ' X座標（縦線）
        Dim Rcnt As Long        ' 行カウント
        Dim MainStart As Long   ' データ開始番号
        Dim MainEnd As Long     ' データ終了番号
        Dim SubStart As Long    ' 土地データ開始番号
        Dim SubEnd As Long      ' 土地データ終了番号
        Dim Xcnt As Long
        Dim St1 As String
        
        If mvarPData.Count = 0 Then
            mvarParent.ClearScreen
            Exit Sub
        End If
        
        MainStart = PgChgSt(nPage) \ 1000
        MainEnd = PgChgEn(nPage) \ 1000
        PageNow = nPage
                
        With mvarParent
            .ClearScreen
            .Offset 0, 0

            Ar = Split(mvarData, vbCrLf)
            Cm = Split(Ar(0), ";")
            
            '表の項目幅(ColW)より縦線設定
            dX(0) = StartX: hX(0) = dX(0) + ColW(0) / 2
            For i = 0 To UBound(ColW)
                dX(i + 1) = dX(i) + ColW(i)
                If i < UBound(ColW) Then hX(i + 1) = dX(i + 1) + ColW(i + 1) / 2
            Next
            Xcnt = UBound(ColW) + 1
            
            Select Case Fnc.s市町村名
            Case "姶良市"
                .Offset 0, 0
                .DrawWidth = 2

                .TextOut "議案第" & StrConv(Cm(0), vbWide) & "号               農地法第５条申請", dX(0) - 4, 20, 13, 0, 2
                
                .DrawText "番\n号", dX(0), 32, ColW(0), 10, 11, 2, 0
                .DrawText "譲受人(借人）", dX(1), 24, ColW(1), 4, 11, 2, 2, 5
                .DrawText "氏　　　名", dX(1), 33, ColW(1), 4, 11, 2, 0
                .DrawText "住　　　所", dX(1), 40, ColW(1), 4, 11, 2, 0
                .DrawText "譲渡人（貸人）", dX(2), 24, ColW(2), 4, 11, 2, 2, 5
                .DrawText "氏　　　名", dX(2), 33, ColW(2), 4, 11, 2, 0
                .DrawText "住　　　所", dX(2), 40, ColW(2), 4, 11, 2, 0
                .DrawText "土 地 の 所 在", dX(3), 34, ColW(3), 4, 11, 2, 0
                .DrawText "地 目", dX(4), 25, dX(6) - dX(4), 4, 11, 2, 0
                .DrawText "登\n記\n簿", dX(4), 32, ColW(4), 5, 11, 2, 0
                .DrawText "現\n況", dX(5), 32, ColW(5), 8, 11, 2, 0
                .DrawText "面 積\n(u)", dX(6), 32, ColW(6), 6, 11, 2, 0
                .DrawText "権\n利\n内\n容", dX(7), 28, ColW(7), 5, 11, 2, 0
                .DrawText "農地区分", dX(8), 34, ColW(8), 4, 10, 2, 2, 0
                .DrawText "転用内容", dX(9), 34, ColW(9), 4, 10, 2, 0
                .DrawText "申請理由\n\n資金計画", dX(10), 30, ColW(10), 4, 11, 2, 0
                .DrawText "\n備　　　考", dX(11), 30, ColW(11), 5, 11, 2, 0 '法令により義務\n付けられている\n協議内容
'                .DrawText "始末書", dX(12), 30, ColW(12), 5, 11, 2, 0
'                .DrawText "面\n積\n超\nの\n理\n由\n書", dX(13), 25, ColW(13), 3.1, 9, 2, 0
'                .DrawText "調査員", dX(14), 34, ColW(14), 6, nFsize, 2, 0
                
                .DLine dX(0), 24, dX(Xcnt), 24
                .DLine dX(1), 29, dX(3), 29
                .DLine dX(4), 29, dX(6), 29
                .DLine dX(0), 48, dX(Xcnt), 48

                For i = 0 To Xcnt
                    If i = 5 Then
                        .DLine dX(i), 29, dX(i), 48
                    Else
                        .DLine dX(i), 24, dX(i), 48
                    End If
                Next
            
            Case "枕崎市"
                .Offset -7, -5
                .TextOut "日程第" & StrConv(Cm(1), vbWide) & "号" & "　" & "議案第" & StrConv(Cm(0), vbWide) & "号", StartX + 10, 30, 14, 0, 2
                .TextOut "農地法第５条許可申請について", (dX(Xcnt) - dX(0)) / 2 + dX(0), 40, 18, 2, 2
                .DrawText "整理\n番号", dX(0), 49, ColW(0), 8, nFsize, 2
                .DrawText "土 地 の 所 在", dX(1), 55, ColW(1), 5, nFsize, 2, 2
                .DrawText "地目", dX(2), 55, ColW(2), 5, nFsize, 2, 2
                .DrawText "面　　積\n( u )", dX(3), 49, ColW(3), 8, nFsize, 2
                .DrawText "転用目的", dX(4), 55, ColW(4), 5, nFsize, 2, 2
                .DrawText "譲　受　人\n(借　人)", dX(5), 49, ColW(5), 8, nFsize, 2
                .DrawText "譲　渡　人\n(貸　人)", dX(6), 49, ColW(6), 8, nFsize, 2
                .DrawText "申　請　事　由", dX(7), 55, ColW(7), 5, nFsize, 2, 2
                .DrawText "調 査 員", dX(8), 55, ColW(8), 5, nFsize, 2, 2
                .LineBoxDX StartX, 45, 0, 1, 20, ColW
                
               
              Case "南種子町"
                .Offset 0, 0
                .TextOut "議案第" & StrConv(Cm(0), vbWide) & "号", 27, 22, 12, 0, 0
                .TextOut "農地法第５条の規定による許可申請に対する意見決定について　資料", 70, 22, 12, 0, 0
                .TextOut "番", hX(0), 37, nFsize, 2, 2
                .TextOut "号", hX(0), 43, nFsize, 2, 2
                .TextOut "調査員", hX(1), 40, nFsize, 2, 2
                Select Case mvarPData.Data(MainStart, "法令")
                    Case "50":
                        .TextOut "譲　受　人", hX(2), 40, nFsize, 2, 2
                        .TextOut "譲　渡　人", (dX(3) + dX(5)) / 2, 35, nFsize, 2, 2
                    Case "51":
                        .TextOut "借　　人", hX(2), 40, nFsize, 2, 2
                        .TextOut "貸　　人", (dX(3) + dX(5)) / 2, 35, nFsize, 2, 2
                End Select
                .TextOut "住　　所", hX(3), 45, nFsize, 2, 2
                .TextOut "氏　名", hX(4), 45, nFsize, 2, 2
                .TextOut "土　　地　　の　　表　　示", (dX(5) + dX(10)) / 2, 35, nFsize, 2, 2
                .TextOut "所　　　　在", hX(5), 45, nFsize, 2, 2
                .TextOut "持分", hX(6), 45, nFsize, 2, 2
                .TextOut "登記", hX(7), 45, nFsize, 2, 2
                .TextOut "現況", hX(8), 45, nFsize, 2, 2
                .TextOut "地積(u)", hX(9), 45, nFsize, 2, 2
                .TextOut "転　　用　　計　　画", (dX(10) + dX(14)) / 2, 35, nFsize, 2, 2
                .TextOut "地　目", hX(10), 45, nFsize, 2, 2
                .TextOut "工事計画", hX(11), 45, nFsize, 2, 2
                .TextOut "資　金", hX(12), 45, nFsize, 2, 2
                .TextOut "目　的", hX(13), 45, nFsize, 2, 2
                .TextOut "理　由", hX(14), 40, nFsize, 2, 2
                .TextOut "隣接地等に", hX(15), 37, nFsize, 2
                .TextOut "対する状況", hX(15), 41, nFsize, 2
                .TextOut "備　　考", hX(16), 40, nFsize, 2, 2
                .TextOut "建ぺい率", hX(16), 92.5, nFsize, 2, 2

                .DBox dX(0), 30, dX(Xcnt), 50
                .DLine dX(3), 40, dX(14), 40
                .DLine dX(0), 50, dX(Xcnt), 50
                .DLine dX(16), 89, dX(17), 89
                .DLine dX(16), 96, dX(17), 96
                
                For i = 1 To Xcnt
                    Select Case i
                        Case 4, 6, 7, 8, 9, 11, 12, 13
                            .DLine dX(i), 40, dX(i), 50
                        Case Else
                            .DLine dX(i), 30, dX(i), 50
                    End Select
                Next
           
             Case "さつま町"
                .Offset -5, 5
                .TextOut "議案第 " & StrConv(Cm(0), vbWide) & "号", 10, 10, 13, 0, 0
                .TextOut "農地法第５条の規定による許可申請に対する意見について", 148, 15, 16, 2, 0
                .TextOut "農地法第５条の規定により、下記農地の申請があったので意見を求める", 148, 25, 10, 2, 0
                
                .hTextOut "番 号", dX(0) + 1, 40, 1, 0, nFsize
                .DrawText "土　　　　　　　地", dX(1), 36, dX(8) - dX(1), 4, nFsize, 2
                .DrawText "農 地 の 所 在", dX(1), 47, ColW(1), 4, nFsize, 2
                .DrawText "地 目", dX(2), 42, ColW(2) + ColW(3), 4, nFsize, 2
                .DrawText "登記", dX(2), 50, ColW(2), 4, nFsize, 2
                .DrawText "現況", dX(3), 50, ColW(3), 4, nFsize, 2
                .DrawText "農振区分", dX(4), 44, ColW(4), 4, nFsize, 2, 0
                .DrawText "都市計画", dX(5), 44, ColW(5), 4, nFsize, 2, 0
                .DrawText "土地改良", dX(6), 44, ColW(6), 4, nFsize, 2, 0
                .DrawText "面積(u)", dX(7), 47, ColW(7), 4, nFsize, 2
                .DrawText "権\n利", dX(8), 40, ColW(8), 8, nFsize, 2
                .DrawText "譲渡人・貸付人", dX(9), 36, ColW(9), 4, nFsize, 2
                .DrawText "氏名、住所", dX(9), 44, ColW(9), 4, nFsize, 2
                .DrawText "職　業", dX(9), 50, ColW(9), 4, nFsize, 2
                .DrawText "譲受人・借受人", dX(10), 36, ColW(10), 4, nFsize, 2
                .DrawText "氏名、住所", dX(10), 44, ColW(10), 4, nFsize, 2
                .DrawText "職　業", dX(10), 50, ColW(10), 4, nFsize, 2
                .DrawText "転用目的", dX(11), 40, ColW(11), 4, nFsize, 2
                .DrawText "棟　数", dX(11), 50, ColW(11), 4, nFsize, 2
                .DrawText "転 用 理 由", dX(12), 44, ColW(12), 4, nFsize, 2
                .DrawText "備　考", dX(13), 44, ColW(13), 4, nFsize, 2
                .VText "審議結果", hX(14), 38, nFsize, 2, 0

                ' 横線
                .DLine dX(0), 35, dX(Xcnt), 35, vbBlack
                .DLine dX(1), 41, dX(8), 41, vbBlack
                .DLine dX(9), 41, dX(11), 41, vbBlack
                .DLine dX(2), 47, dX(4), 47, vbBlack
                .DLine dX(11), 47, dX(12), 47, vbBlack
                .DLine dX(0), 56, dX(Xcnt), 56, vbBlack

                '縦線
                For n = 0 To 15
                    Select Case n
                    Case 2, 4, 5, 6, 7
                        .DLine dX(n), 41, dX(n), 56, vbBlack
                    Case 3
                        .DLine dX(n), 47, dX(n), 56, vbBlack
                    Case Else
                        .DLine dX(n), 35, dX(n), 56, vbBlack
                    End Select
                Next
                
            Case "三股町"
                .Offset 0, -5
                .TextOut "個別申請一覧表　第５条", dX(2), 27.5, nFsize, 0, 1
                .TextOut "三股町農業委員会　　", dX(13), 27.5, nFsize, 0, 1
                .DrawText "受\n付\n番\n号", dX(0), 35, ColW(0), 4, nFsize, 2, 2
                .DrawText "受\n付\n年\n月\n日", dX(1), 33, ColW(1), 4, nFsize, 2, 2
                .DrawText "申　請　人", dX(2), 28, dX(4) - dX(2), 4, nFsize, 2, 2
                .DrawText "住　　所", dX(2), 35, ColW(2), 4, nFsize, 2, 2
                .DrawText "受　　人", dX(2), 45, ColW(2), 4, nFsize, 2, 2
                .DrawText "住　　所", dX(3), 35, ColW(3), 4, nFsize, 2, 2
                .DrawText "渡　　人", dX(3), 45, ColW(3), 4, nFsize, 2, 2
                .DrawText "申　請　地", dX(4), 28, dX(9) - dX(4), 4, nFsize, 2, 2
                .DrawText "土 地 所 在", dX(4), 40, ColW(4), 4, nFsize, 2, 2
                .DrawText "地目", dX(5), 35, ColW(5) + ColW(6), 4, nFsize, 2, 2
                .DrawText "台帳", dX(5), 45, ColW(5), 4, nFsize, 2, 2
                .DrawText "現況", dX(6), 45, ColW(6), 4, nFsize, 2, 2
                .DrawText "地積", dX(7), 35, ColW(7), 4, nFsize, 2, 2
                .DrawText "u", dX(7), 45, ColW(7), 4, nFsize, 2, 2
                .DrawText "農地\n区分", dX(8), 38, ColW(8), 4, nFsize, 2, 2
                .DrawText "権\n利\nの\n種\n類", dX(9), 32, ColW(9), 4, nFsize, 2, 2
                .DrawText "転用目的", dX(10), 40, ColW(10), 4, nFsize, 2, 2
                .DrawText "申請理由", dX(11), 40, ColW(11), 4, nFsize, 2, 2
                .DrawText "棟数", dX(12), 40, ColW(12), 4, nFsize, 2, 2
                .DrawText "面積u", dX(13), 40, ColW(13), 4, nFsize, 2, 2
                .DrawText "資\n金\n計\n画", dX(14), 35, ColW(14), 4, nFsize, 2, 2
                .DrawText "区\n域\n区\n分", dX(15), 35, ColW(15), 4, nFsize, 2, 2
                .DrawText "指\n令\n年\n月\n日", dX(16), 35, ColW(16), 4, nFsize, 2, 2
                .DrawText "指\n令\n番\n号", dX(17), 35, ColW(17), 4, nFsize, 2, 2
                .DrawText "受領\n印\n交付\n日", dX(18), 35, ColW(18), 4, nFsize, 2, 2
                .DrawText "備　　　　　　　　　　　　　　　　　　　　　　　　　考", dX(2), 52, dX(16) - dX(2), 4, nFsize, 2, 2
                
                .DBox dX(0), 28, dX(Xcnt), 56, , 4
                .DLine dX(2), 32, dX(9), 32
                .DLine dX(2), 42, dX(4), 42
                .DLine dX(5), 42, dX(8), 42
                .DLine dX(2), 52, dX(16), 52
                For i = 0 To Xcnt
                    Select Case i
                    Case 1, 2, 16, 17, 18
                        .DLine dX(i), 28, dX(i), 56
                    Case 4, 9, 10, 11, 12, 13, 14, 15
                        .DLine dX(i), 28, dX(i), 52
                    Case 3, 5, 7, 8
                        .DLine dX(i), 32, dX(i), 52
                    Case 6
                        .DLine dX(i), 42, dX(i), 52
                    End Select
                Next
                
                dY = StartY
                For n = 1 To 5
                    .DBox dX(0), dY, dX(Xcnt), dY + 25, , 4
                    .DLine dX(2), dY + 10, dX(4), dY + 10
                    .DLine dX(2), dY + 20, dX(16), dY + 20
                    For i = 0 To Xcnt
                        Select Case i
                        Case 1, 2, 16, 17, 18
                            .DLine dX(i), dY, dX(i), dY + 25
                        Case 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15
                            .DLine dX(i), dY, dX(i), dY + 20
                        End Select
                    Next
                    .DrawText "\n・\n\n・\n", dX(16), dY + 11, ColW(16), 4, nFsize, 2, 2
                    dY = dY + 25
                Next
                .TextOut "資金計画", dX(2) + 1, 186, nFsize, 0, 2
                .TextOut "自己、借入、その他", dX(3) + 1, 186, nFsize, 0, 2
                .TextOut "区域区分", dX(2) + 1, 190, nFsize, 0, 2
                .TextOut "都市計画区域内　（用途地域　その他）　都市計画区域外", dX(3) + 1, 190, nFsize, 0, 2
                .TextOut "　　　　　　　　　　Ａ　　　　Ｂ　　　　Ｃ", dX(3) + 1, 194, nFsize, 0, 2
                .TextOut "権利の種類", dX(2) + 1, 198, nFsize, 0, 2
                .TextOut "所有権移転（売買・贈与）、賃借権、使用貸借", dX(3) + 1, 198, nFsize, 0, 2
                .DLine dX(2), 184, dX(8), 184, , 4
                .DLine dX(2), 188, dX(8), 188
                .DLine dX(2), 192, dX(8), 192
                .DLine dX(2), 196, dX(8), 196
                .DLine dX(2), 200, dX(8), 200, , 4
                .DLine dX(2), 184, dX(2), 200, , 4
                .DLine dX(3), 184, dX(3), 200
                .DLine dX(8), 184, dX(8), 200, , 4
                
                hY = StartY + 1 '基本データY座標
                dY = StartY + 1 '土地データY座標

                For n = MainStart To MainEnd
                     ' 土地データ開始番号設定
                    If n = MainStart Then
                        SubStart = PgChgSt(nPage) - MainStart * 1000
                    Else
                        SubStart = 0
                    End If
                    
                    '土地データ終了番号設定
                    If n = MainEnd Then
                        SubEnd = PgChgEn(nPage) - MainEnd * 1000
                    Else
                        SubEnd = mvarPData.SubCount(n & ":農地")
                    End If
                    
                    .DrawText n, dX(0), dY + RowH * 2, ColW(0), RowH, nFsize, 2
                    St1 = Format(mvarPData.Data(n, "受付年月日"), "EEMMDD")
                    .DrawText Val(Left(St1, 2)) & "\n・\n" & Val(MID(St1, 3, 2)) & "\n・\n" & Val(MID(St1, 5, 2)), dX(1), hY, ColW(1), 4, nFsize, 2
                    .DrawText Left(mvarPData.Data(n, "住所B"), 18), dX(2) + 1, hY, ColW(2) - 1, RowH, nFsize + (Len(mvarPData.Data(n, "住所B")) > 16), 0
                    .DrawText Left(mvarPData.Data(n, "氏名B"), 18), dX(2) + 1, hY + RowH * 2, ColW(2) - 1, RowH, nFsize + (Len(mvarPData.Data(n, "氏名B")) > 16), 0
                    .DrawText Left(mvarPData.Data(n, "住所A"), 18), dX(3) + 1, hY, ColW(3) - 1, RowH, nFsize + (Len(mvarPData.Data(n, "住所A")) > 16), 0
                    .DrawText Left(mvarPData.Data(n, "氏名A"), 18), dX(3) + 1, hY + RowH * 2, ColW(3) - 1, RowH, nFsize + (Len(mvarPData.Data(n, "氏名A")) > 16), 0
                    St1 = ""
                    Select Case Val(mvarPData.Data(n, "法令"))
                        Case 50: St1 = "所有移転"
                        Case 51:
                            Select Case Val(mvarPData.Data(n, "権利種類"))
                                Case 1: St1 = "賃借権"
                                Case 2: St1 = "使用貸借権"
                            End Select
                    End Select
                    .DrawText St1, dX(9), hY, ColW(9), 4, nFsize, 2
                    .DrawText Left(mvarPData.Data(n, "転用目的"), 16), dX(10), hY, ColW(10), RowH, nFsize, 0
                    .DrawText Left(mvarPData.Data(n, "転用事由"), 16), dX(11), hY, ColW(11), RowH, nFsize, 0
                    If Val(mvarPData.Data(n, "棟数")) > 0 Then
                        .DrawText mvarPData.Data(n, "棟数"), dX(12), hY, ColW(12), RowH, nFsize, 2
                    End If
                    If Val(mvarPData.Data(n, "建築面積")) <> 0 Then
                        .TextOut FormatNumber(Val(mvarPData.Data(n, "建築面積")), 2), dX(14) - 2, hY, nFsize, 1
                    End If
                    .DrawText Left(mvarPData.Data(n, "資金計画"), 4), dX(14), hY, ColW(14), RowH, nFsize, 2
                    .DrawText mvarPData.Data(n, "備考"), dX(2) + 1, hY + 20, 210, RowH, nFsize, 0

                    Rcnt = 0
                    For K = SubStart To SubEnd
                        .DrawText mvarPData.Data(n & ":農地." & K, "土地所在"), dX(4) + 1, dY, ColW(4) - 2, 4, nFsize, 0
                        .DrawText Left(mvarPData.Data(n & ":農地." & K, "登記地目"), 2), dX(5), dY, ColW(5), RowH, nFsize, 2
                        .DrawText Left(mvarPData.Data(n & ":農地." & K, "現況地目"), 2), dX(6), dY, ColW(6), RowH, nFsize, 2
                        If Val(mvarPData.Data(n & ":農地." & K, "面積")) <> 0 Then
                            .DrawText FormatNumber(Val(mvarPData.Data(n & ":農地." & K, "面積")), 0), dX(7), dY, ColW(7) - 1, RowH, nFsize, 1
                        End If
                        .DrawText Left(mvarPData.Data(n & ":農地." & K, "農振区分"), 2), dX(8), dY, ColW(8), RowH, nFsize, 2
                        If Len(mvarPData.Data(n & ":農地." & K, "土地所在")) > 0 Then
                            Select Case Val(mvarPData.Data(n & ":農地." & K, "都市計画法ID"))
                                Case 0: St1 = "C"
                                Case 2: St1 = "A"
                                Case Else: St1 = "B"
                            End Select
                            .DrawText St1, dX(15), dY, ColW(15), 4, nFsize, 2, 0
                        End If
                        Rcnt = Rcnt + 1
                        If (Rcnt Mod 4) = 0 Then
                            dY = dY + 5
                        End If
                        dY = dY + RowH
                    Next
                    
                    If Rcnt < HMax Then
                        dY = hY + HMax * RowH + 5
                    End If
                    hY = dY
                Next

             Case "日置市"
                .Offset 0, 0
                .TextOut "第" & StrConv(Cm(0), vbWide) & "号議案", 16, 13, 13, 0, 2
                .TextOut "農地法第５条申請", 20, 20, 14, 0, 2
                
                Select Case mvarPData.Data(MainStart, "受付補助記号")
                    Case "本": St1 = "伊集院地域"
                    Case "東": St1 = "東市来地域"
                    Case "日": St1 = "日吉地域"
                    Case "吹": St1 = "吹上地域"
                    Case Else: St1 = ""
                End Select
                .TextOut "[ " & St1 & " ]", dX(Xcnt), 20, 14, 1, 2
                
                .DrawText "番号", dX(0), 29.5, ColW(0), 10, 11, 2
                .DrawText "申　　　請　　　人", dX(1), 25, dX(3) - dX(1), 4, 11, 2
                .DrawText "譲受人（借人）", dX(1), 30.5, ColW(1), 4, 11, 2
                .DrawText "住　所", dX(1), 36.5, ColW(1), 4, 11, 2
                .DrawText "職　業", dX(1), 42.5, ColW(1), 4, 11, 2
                .DrawText "譲渡人（貸人）", dX(2), 30.5, ColW(2), 4, 11, 2
                .DrawText "住　所", dX(2), 36.5, ColW(2), 4, 11, 2
                .DrawText "職　業", dX(2), 42.5, ColW(2), 4, 11, 2
                .DrawText "申        請        地", dX(3), 25, dX(8) - dX(3), 4, 11, 2
                .DrawText "所　　　在", dX(3), 36.5, ColW(3), 4, 11, 2
                .DrawText "地 目", dX(4), 30.5, dX(6) - dX(4), 4, 11, 2
                .DrawText "登記", dX(4), 37, ColW(4), 5, 11, 2
                .DrawText "現況", dX(5), 37, ColW(5), 5, 11, 2
                .DrawText "面 積\n(u)", dX(6), 34, ColW(6), 6, 11, 2
                .DrawText "区\n分", dX(7), 34, ColW(7), 6, 11, 2
                .DrawText "転用目的", dX(8), 36, ColW(8), 4, 11, 2, 2
                .DrawText "権利種別", dX(9), 36, ColW(9), 4, 11, 2, 2
                .DrawText "期間", dX(10), 36, ColW(10), 4.5, 11, 2, 2
                .DrawText "調査員", dX(11), 36, ColW(11), 4, 11, 2, 2
                .DrawText "同意書", dX(12), 28.5, ColW(12), 5, 11, 2
                .DrawText "始末書", dX(13), 28.5, ColW(13), 5, 11, 2
                .DrawText "被\n害\n防\n除\n計\n画\n書", dX(14), 25, ColW(14), 3.1, 9, 2
                
                .DLine dX(0), 24, dX(Xcnt), 24
                .DLine dX(1), 30, dX(8), 30
                .DLine dX(1), 35, dX(3), 35
                .DLine dX(4), 35, dX(6), 35
                For i = 0 To Xcnt
                    Select Case i
                        Case 2, 4, 6, 7:    .DLine dX(i), 30, dX(i), 48
                        Case 5:             .DLine dX(i), 35, dX(i), 48
                        Case Else:          .DLine dX(i), 24, dX(i), 48
                    End Select
                Next
            
            Case "大崎町"
                .Offset -5, 5
                .TextOut "第" & StrConv(Cm(0), vbWide) & "号議案", dX(0) - 4, 13, 13, 0, 2
                .TextOut "農地法第５条申請", dX(0), 20, 14, 0, 2
                .DrawText "番\n\n号", dX(0), 24, ColW(0), 4, 11, 2, 2, 24
                .DrawText "譲  受  人", dX(1), 24, ColW(1), 4, 11, 2, 2, 6
                .DrawText "氏　　　名", dX(1), 32, ColW(1), 4, 11, 2
                .DrawText "集　　　落", dX(1), 36.5, ColW(1), 4, 11, 2
                .DrawText "職　　　業", dX(1), 41, ColW(1), 4, 11, 2
                .DrawText "譲  渡  人", dX(2), 24, ColW(2), 4, 11, 2, 2, 6
                .DrawText "氏　　　名", dX(2), 32, ColW(2), 4, 11, 2
                .DrawText "集　　　落", dX(2), 36.5, ColW(2), 4, 11, 2
                .DrawText "職　　　業", dX(2), 41, ColW(2), 4, 11, 2
                .DrawText "土 地 の 所 在", dX(3), 24, ColW(3), 4, 11, 2, 2, 24
                .DrawText "地 目", dX(4), 24, dX(6) - dX(4), 4, 11, 2, 2, 6
                .DrawText "台\n\n帳", dX(4), 30, ColW(4), 4, 11, 2, 2, 18
                .DrawText "現\n\n況", dX(5), 30, ColW(5), 4, 11, 2, 2, 18
                .DrawText "面 積\n(u)", dX(6), 24, ColW(6), 4, 11, 2, 2, 24
                .DrawText "価 格", dX(7), 24, ColW(7), 4, 11, 2, 2, 24
                .DrawText "申 請 事 由", dX(8), 24, ColW(8) + ColW(9), 4, nFsize, 2, 2, 6
                .DrawText "転用目的", dX(8), 30, ColW(8), 4, nFsize, 2, 2, 18
                .DrawText "面積\n(u)", dX(9), 30, ColW(9), 6, nFsize, 2, 2, 18
                .DrawText "転 用\n\n時 期", dX(10), 24, ColW(10), 4, nFsize, 2, 2, 24
                .DrawText "資金計画", dX(11), 24, ColW(11), 4, nFsize, 2, 2, 24
                .DrawText "農\n\n振", dX(12), 24, ColW(12), 4, nFsize, 2, 2, 24
                .DrawText "農 地\n\n区 分", dX(13), 24, ColW(13), 4, nFsize, 2, 2, 24
                .DrawText "結\n\n果", dX(14), 24, ColW(14), 4, nFsize, 2, 2, 24
                .DrawText "備 考", dX(15), 24, ColW(15), 4, nFsize, 2, 2, 24
                
                .DLine dX(0), 24, dX(Xcnt), 24
                .DLine dX(1), 29, dX(3), 29
                .DLine dX(4), 29, dX(6), 29
                .DLine dX(8), 29, dX(10), 29
                .DLine dX(0), 48, dX(Xcnt), 48

                For i = 0 To Xcnt
                    Select Case i
                        Case 5, 9: .DLine dX(i), 29, dX(i), 48
                        Case Else: .DLine dX(i), 24, dX(i), 48
                    End Select
                Next
            
            Case Else
                .Offset 0, 10
                .TextOut "第" & StrConv(Cm(0), vbWide) & "号議案", 16, 13, 13, 0, 2
                .TextOut mvarTitle, 20, 20, 14, 0, 2
                .DrawText "番号", dX(0), 29.5, ColW(0), 10, 11, 2
                .DrawText "申　　　請　　　人", dX(1), 25, dX(3) - dX(1), 4, 11, 2
                .DrawText "譲受人(借人)", dX(1), 30.5, ColW(1), 4, 11, 2
                .DrawText "住　所", dX(1), 36.5, ColW(1), 4, 11, 2
                .DrawText "職　業", dX(1), 42.5, ColW(1), 4, 11, 2
                .DrawText "譲渡人(貸人)", dX(2), 30.5, ColW(2), 4, 11, 2
                .DrawText "住　所", dX(2), 36.5, ColW(2), 4, 11, 2
                .DrawText "職　業", dX(2), 42.5, ColW(2), 4, 11, 2
                .DrawText "申        請        地", dX(3), 25, dX(8) - dX(3), 4, 11, 2
                .DrawText "所　　　在", dX(3), 36.5, ColW(3), 4, 11, 2
                .DrawText "地 目", dX(4), 30.5, ColW(4) + ColW(5), 4, 11, 2
                .DrawText "登記", dX(4), 37, ColW(4), 5, 11, 2
                .DrawText "現況", dX(5), 37, ColW(5), 5, 11, 2
                .DrawText "面 積\n(u)", dX(6), 34, ColW(6), 6, 11, 2
                .DrawText "区\n分", dX(7), 34, ColW(7), 6, 11, 2
                .DrawText "申      請      事      由", dX(8), 25, dX(12) - dX(8), 4, 11, 2
                .DrawText "転用目的", dX(8), 36.5, ColW(8), 4, 11, 2
                .DrawText "棟数", dX(9), 36.5, ColW(9), 4, 11, 2
                .DrawText "建築等\n面積\n(u)", dX(10), 33, ColW(10), 4.5, 11, 2
                .DrawText "事   　由", dX(11), 36.5, ColW(11), 4, 11, 2
                .DrawText "同意書", dX(12), 28.5, ColW(12), 5, 11, 2
                .DrawText "始末書", dX(13), 28.5, ColW(13), 5, 11, 2
                .DrawText "被\n害\n防\n除\n計\n画\n書", dX(14), 25, ColW(14), 3.1, 9, 2
                
                .DLine dX(0), 24, dX(Xcnt), 24
                .DLine dX(1), 30, dX(12), 30
                .DLine dX(1), 35, dX(3), 35
                .DLine dX(4), 35, dX(6), 35
                .DLine dX(0), 48, dX(Xcnt), 48

                For i = 0 To Xcnt
                    Select Case i
                        Case 2, 4, 6, 7, 9, 10, 11:  .DLine dX(i), 30, dX(i), 48
                        Case 5:                         .DLine dX(i), 35, dX(i), 48
                        Case Else:                      .DLine dX(i), 24, dX(i), 48
                    End Select
                Next

            End Select
            If Fnc.s市町村名 <> "三股町" Then PrintSubMain mvarParent, dX(), hX()

        End With
    End Sub
    
    Private Sub PrintSubMain(ByRef mvarParent As ADBasicLIB2.CPrintFormSK, ByRef dX() As Single, ByRef hX() As Single)
        Dim hY As Single        ' 基本データY座標
        Dim dY As Single        ' 土地データY座標
        Dim Rcnt As Long        ' 行カウント
        Dim nMainStart As Long  ' データ開始番号
        Dim nMainEnd As Long    ' データ終了番号
        Dim nSubStart As Long   ' 土地データ開始番号
        Dim nSubEnd As Long     ' 土地データ終了番号
        Dim n As Long
        Dim i As Long
        Dim nWork As Single
        Dim nPage As Long
        Dim Xcnt As Long
        
        nPage = PageNow

        Xcnt = UBound(ColW) + 1

        With mvarParent
            nMainStart = PgChgSt(nPage) \ 1000
            nMainEnd = PgChgEn(nPage) \ 1000
       
            dY = StartY + 1
            hY = StartY + 1

            For n = nMainStart To nMainEnd
                ' 土地データ開始番号設定
                If n = nMainStart Then
                    nSubStart = PgChgSt(nPage) - nMainStart * 1000
                Else
                    nSubStart = 0
                End If
                
                '土地データ終了番号設定
                If n = nMainEnd Then
                    nSubEnd = PgChgEn(nPage) - nMainEnd * 1000
                Else
                    nSubEnd = mvarPData.SubCount(n & ":農地")
                End If
                
                ' 罫線
                Rcnt = nSubEnd - nSubStart + 1
                If Rcnt < HMax Then
                    nWork = hY + HMax * RowH
                Else
                    nWork = dY + Rcnt * RowH
                End If
                For i = 0 To Xcnt
                    .DLine dX(i), dY - 1, dX(i), nWork, vbBlack
                Next
                
                '背景色設定
                If Fnc.s市町村名 = "日置市" Then
                    For i = 0 To Xcnt
                        Select Case i
                        Case 0, 8
                            .DBox dX(i), hY - 1, dX(i + 1), nWork, RGB(230, 230, 230), , True
                        End Select
                        .DLine dX(i), hY - 1, dX(i), nWork, vbBlack
                    Next
                    .DLine dX(0), hY - 1, dX(Xcnt), hY - 1, vbBlack
                End If

                ' データ出力
                For i = nSubStart To nSubEnd
                    PrintSubData mvarParent, n, i, dX, hX, dY, nSubStart, nSubEnd
                    dY = dY + RowH
                Next
                
                Rcnt = nSubEnd - nSubStart + 1
                If Rcnt < HMax Then   ' 土地データ行数が基本データ行数より少ないとき
                    dY = hY + 1 + HMax * RowH
                End If
                .DLine dX(0), dY, dX(Xcnt), dY, vbBlack
                dY = dY + 1
                hY = dY
            Next
            If nPage = PageMax Then PrintSubTotal mvarParent, dX, dY
            If mvarStartPage > 0 Then .TextOut "- " & mvarStartPage - 1 + nPage & " - ", .PaperWidth / 2, .PaperHeight - 4
        End With
    End Sub
    
    Private Sub PrintSubData(ByRef mvarParent As ADBasicLIB2.CPrintFormSK, pNo As Long, pSubNo As Long, ByRef dX() As Single, ByRef hX() As Single, dY As Single, pSubStart As Long, pSubEnd As Long)
        Dim St As String
        Dim St1 As String
        Dim St2 As String
        Dim n As Long
        Dim i As Long
        Dim nRH As Long
        Dim 人種別A As String
        Dim 人種別B As String
        
        With mvarParent
            Select Case Fnc.s市町村名
            Case "姶良市"
                If pSubNo = pSubStart Then
                    Select Case Val(mvarPData.Data(pNo, "法令"))
                        Case 50: .TextOut "所", hX(7), dY, 10, 2
                            人種別A = ""
                            人種別B = ""
                        Case 51:
                            人種別A = "(貸人)"
                            人種別B = "(借人)"
                            Select Case Val(mvarPData.Data(pNo, "権利種類"))
                                Case 1: .TextOut "賃", hX(7), dY, 10, 2
                                Case 2: .TextOut "使", hX(7), dY, 10, 2
                            End Select
                    End Select
                    
                    .TextOut mvarPData.Data(pNo, "受付番号"), (dX(0) + dX(1)) / 2, dY + RowH, nFsize, 2
                    .TextOut mvarPData.Data(pNo, "受付補助記号"), (dX(0) + dX(1)) / 2, dY + RowH * 3, nFsize, 2
                    .DrawText mvarPData.Data(pNo, "氏名B") & 人種別B, dX(1) + 1, dY, ColW(1) - 1, RowH, nFsize - 1
                    .DrawText Fnc.GetShortAddress(mvarPData.Data(pNo, "住所B"), s都道府県名, s郡部, , , True), dX(1) + 1, dY + RowH * 3, ColW(1) - 2, RowH, nFsize - 1, 0
                    .DrawText mvarPData.Data(pNo, "職業B"), dX(1) + 1, dY + RowH * 6, ColW(1) - 1, RowH, nFsize
                    .DrawText mvarPData.Data(pNo, "集落B"), dX(1) + 1, dY + RowH * 7, ColW(1) - 1, RowH, nFsize

                    If CBool(mvarPData.Data(pNo, "複数申請人A")) = False Then
                        .DrawText mvarPData.Data(pNo, "氏名A") & 人種別A, dX(2) + 1, dY, ColW(2) - 2, RowH, nFsize - 1
                        .DrawText Fnc.GetShortAddress(mvarPData.Data(pNo, "住所A"), s都道府県名, s郡部, , , True), dX(2) + 1, dY + RowH * 3, ColW(2) - 2, RowH, nFsize, 0
                        .DrawText mvarPData.Data(pNo, "職業A"), dX(2) + 1, dY + RowH * 6, ColW(2) - 1, RowH, nFsize
                        .DrawText mvarPData.Data(pNo, "集落A"), dX(2) + 1, dY + RowH * 7, ColW(2) - 1, RowH, nFsize
                    End If
                    .DrawText mvarPData.Data(pNo, "農地区分"), dX(8) + 1, dY, ColW(8) - 1, RowH, nFsize - 1
                    
                    .DrawText Left(mvarPData.Data(pNo, "転用目的"), 24) & IIf(Val(mvarPData.Data(pNo, "棟数")) <> 0, "\n\n" & mvarPData.Data(pNo, "棟数") & "棟", "") & IIf(Val(mvarPData.Data(pNo, "建築面積")) <> 0, "\n\n" & FormatNumber(Val(mvarPData.Data(pNo, "建築面積")), 0) & "u", ""), dX(9), dY, ColW(9), RowH, 10, 2 - IIf(Len(mvarPData.Data(pNo, "転用目的")) > 4, 2, 0)
                    '.DrawText mvarPData.Data(pNo, "資金計画"), dX(12) + 0.5, dY, ColW(12) - 1, nRH, nFsize, 0, 0
                    .DrawText mvarPData.Data(pNo, "転用事由") & "\n\n" & mvarPData.Data(pNo, "資金計画"), dX(10) + 0.5, dY, ColW(10) - 1, RowH, 10, 0, 0
                    .DrawText mvarPData.Data(pNo, "協議状況") & "\n" & mvarPData.Data(pNo, "備考"), dX(11) + 0.5, dY, ColW(11) - 1, RowH, 10, 0, 0

'                    .DrawText IIf(Val(mvarPData.Data(pNo, "棟数")) <> 0, mvarPData.Data(pNo, "棟数"), ""), dX(10) + 1, dY, ColW(10) - 2, RowH, nFsize, 2
'                    .DrawText IIf(Val(mvarPData.Data(pNo, "建築面積")) <> 0, FormatNumber(Val(mvarPData.Data(pNo, "建築面積")), 0), ""), dX(11), dY, ColW(11) - 1, RowH, nFsize, 1
'                    .DrawText mvarPData.Data(pNo, "始末書"), dX(12), dY + RowH * 2, ColW(12), 4, nFsize, 2
'                    .DrawText mvarPData.Data(pNo, "理由書"), dX(13), dY + RowH * 2, ColW(13), 4, nFsize, 2
'                    .DrawText mvarPData.Data(pNo, "調査員"), dX(14) + 1, dY, ColW(14) - 1, 4, nFsize - 1
                End If
                
                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(3) + 2, dY, ColW(3), RowH, nFsize
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(3), dY, ColW(3) - 2, RowH, nFsize, 1
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "小数点")) = 0 Then
                        .DrawText Format(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), "#,##0"), dX(6), dY, ColW(6) - 1, RowH, nFsize, 1
                    Else
                        .DrawText Format(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), "#,##0.00"), dX(6), dY, ColW(6) - 1, RowH, nFsize, 1
                    End If
                ElseIf Val(mvarPData.Data(pNo & ":農地." & pSubNo, "一部")) = 1 Then
                    .TextOut "(" & FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0) & "の内)", dX(7) - 1, dY, nFsize - 2, 1
                Else
                    If CBool(mvarPData.Data(pNo, "複数申請人A")) Then
                        .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "所有者名"), 11), dX(2) + 1, dY, ColW(2) - 1, RowH, nFsize - 1
                        .DrawText Fnc.GetShortAddress(mvarPData.Data(pNo & ":農地." & pSubNo, "所有者住所"), s都道府県名, s郡部, , , True), dX(2) + 1, dY + RowH, ColW(2) - 1, RowH, nFsize - 2
                        If mvarPData.Data(pNo & ":農地." & pSubNo, "線") = "1" Then .DotLine dX(2), dY - 0.5, dX(7), dY - 0.5, vbBlack
                    End If
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(3) + 1, dY, ColW(3) - 1, RowH, nFsize - 1
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 1), dX(4), dY, ColW(4), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 1), dX(5), dY, ColW(5), RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "小数点")) = 0 Then
                            .DrawText Format(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), "#,##0"), dX(6), dY, ColW(6) - 1, RowH, nFsize, 1
                        Else
                            .DrawText Format(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), "#,##0.00"), dX(6), dY, ColW(6) - 1, RowH, nFsize, 1
                        End If
                    End If
                End If
            
            Case "枕崎市"
                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then  ' 合計行
                    .TextOut mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(1) + 5, dY, nFsize, 0, 0
                    .TextOut mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(2) - 2, dY, nFsize, 1, 0
                    .TextOut FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(4) - 2, dY, nFsize, 1
                Else
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(1) + 1, dY, ColW(1) - 2, RowH, nFsize, 0
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 1), dX(2) + 1, dY, ColW(2) - 2, RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        .TextOut FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(4) - 2, dY, nFsize, 1
                    End If
                End If

                If pSubNo = pSubStart Then
                    .TextOut pNo, hX(0), dY, nFsize, 2, 0
                    .DrawText Left(mvarPData.Data(pNo, "転用目的"), 12), dX(4) + 1, dY, ColW(4) - 2, RowH, nFsize, 0
                    .DrawText Left(mvarPData.Data(pNo, "氏名B"), 21), dX(5) + 1, dY, ColW(5) - 2, RowH, nFsize, 0
                    .DrawText Left(mvarPData.Data(pNo, "氏名A"), 21), dX(6) + 1, dY, ColW(6) - 2, RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo, "転用事由"), dX(7) + 1, dY, ColW(7) - 2, RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo, "調査員"), dX(8) + 1, dY, ColW(8) - 2, RowH, nFsize, 2
                End If

            Case "南種子町"
                nRH = 4
                If pSubNo = pSubStart Then
                    .TextOut pNo, hX(0), dY + nRH, nFsize, 2, 0
                    St1 = Replace(mvarPData.Data(pNo, "調査員"), "\t", "")
                    .DrawText St1, dX(1), dY, ColW(1), nRH, nFsize, 2, 0
                    .TextOut "住所", dX(2) + 0.5, dY, nFsize, 0, 0
                    .DrawText StrConv(mvarPData.Data(pNo, "住所B"), vbNarrow), dX(2) + 0.5, dY + RowH, ColW(2) - 1, 4, nFsize, 0, 0
                    .DrawText "氏名\n" & mvarPData.Data(pNo, "氏名B"), dX(2) + 0.5, dY + RowH * 4, ColW(2) - 1, 4, nFsize, 0, 0
                    If mvarPData.Data(pNo, "共有持分") = "0" And CBool(mvarPData.Data(pNo, "複数申請人A")) = False Then
                        .DrawText StrConv(mvarPData.Data(pNo, "住所A"), vbNarrow), dX(3) + 0.5, dY, ColW(3) - 1, 3, nFsize, 0, 0
                        .DrawText mvarPData.Data(pNo, "氏名A"), dX(4) + 0.5, dY, ColW(4) - 1, 3, nFsize, 0, 0
                    End If
                    .DrawText mvarPData.Data(pNo, "用途"), dX(10), dY, ColW(10), nRH, nFsize, 2, 0
                    If Len(mvarPData.Data(pNo, "予備1")) Then
                        .DrawText mvarPData.Data(pNo, "予備1") & IIf(mvarPData.Data(pNo, "始末書") = "○", "\n\n※始末書等添付あり　", ""), dX(11), dY, ColW(11), nRH, nFsize
                    Else
                        St1 = IIf(Len(mvarPData.Data(pNo, "工事開始年1")) > 0, mvarPData.Data(pNo, "工事開始年1") & ".", "")
                        St2 = IIf(mvarPData.Data(pNo, "工事開始月1") > 0, mvarPData.Data(pNo, "工事開始月1"), "")
                        .DrawText St1 & St2, dX(11), dY, ColW(11), nRH, nFsize, 2, 0
                        .DrawText IIf(Len(St1 & St2), "〜", ""), dX(11), dY + nRH, ColW(11), nRH, nFsize, 2, 0
                        St1 = IIf(Len(mvarPData.Data(pNo, "工事終了年1")) > 0, mvarPData.Data(pNo, "工事終了年1") & ".", "")
                        St2 = IIf(mvarPData.Data(pNo, "工事終了月1") > 0, mvarPData.Data(pNo, "工事終了月1"), "")
                        .DrawText St1 & St2, dX(11), dY + nRH * 2, ColW(11), nRH, nFsize, 2, 0
                        St1 = IIf(Len(mvarPData.Data(pNo, "工事開始年2")) > 0, mvarPData.Data(pNo, "工事開始年2") & ".", "")
                        St2 = IIf(mvarPData.Data(pNo, "工事開始月2") > 0, mvarPData.Data(pNo, "工事開始月2"), "")
                        If Len(St1 & St2) > 0 Then
                            .DrawText St1 & St2, dX(11), dY + nRH * 4, ColW(11), nRH, nFsize, 2, 0
                            .DrawText IIf(Len(St1 & St2), "〜", ""), dX(11), dY + nRH * 5, ColW(11), nRH, nFsize, 2, 0
                            St1 = IIf(Len(mvarPData.Data(pNo, "工事終了年2")) > 0, mvarPData.Data(pNo, "工事終了年2") & ".", "")
                            St2 = IIf(mvarPData.Data(pNo, "工事終了月2") > 0, mvarPData.Data(pNo, "工事終了月2"), "")
                            .DrawText St1 & St2, dX(11), dY + nRH * 6, ColW(11), nRH, nFsize, 2, 0
                            .DrawText IIf(mvarPData.Data(pNo, "始末書") = "○", "\n※始末書等添付あり　", ""), dX(11), dY + nRH * 7, ColW(11), nRH, nFsize, 2, 0
                        Else
                            .DrawText IIf(mvarPData.Data(pNo, "始末書") = "○", "\n※始末書等添付あり　", ""), dX(11), dY + nRH * 3, ColW(11), nRH, nFsize, 2, 0
                        End If
                    End If
                    .DrawText mvarPData.Data(pNo, "資金計画"), dX(12) + 0.5, dY, ColW(12) - 1, nRH, nFsize, 0, 0
                    .DrawText mvarPData.Data(pNo, "転用目的"), dX(13), dY, ColW(13), nRH, nFsize, 2, 0
                    .DrawText mvarPData.Data(pNo, "転用事由"), dX(14), dY, ColW(14), nRH, nFsize, 0, 0
                    .DrawText mvarPData.Data(pNo, "被害防除概要"), dX(15) + 0.5, dY, ColW(15), nRH, nFsize, 0, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & 0, "農振区分"), dX(16) + 0.5, dY, ColW(16), nRH, nFsize, 0, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & 0, "都市計画法"), dX(16) + 0.5, dY + nRH * 2, ColW(16), nRH, nFsize, 0, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & 0, "等級"), dX(16) + 0.5, dY + nRH * 4, ColW(16), nRH, nFsize, 0, 0
                    If mvarPData.Data(pNo, "法令") = 51 Then
                        Select Case Val(mvarPData.Data(pNo, "権利種類"))
                            Case 1: St1 = "賃借権"
                            Case 2: St1 = "使用貸借権"
                            Case Else: St1 = ""
                        End Select
                        .DrawText St1, dX(16) + 0.5, dY + nRH * 6, ColW(16), nRH, nFsize, 0, 0
                    End If
                    
                    If Val(mvarPData.Data(pNo, "小作料")) <> 0 Then
                        .DrawText "対価" & mvarPData.Data(pNo, "小作料") & mvarPData.Data(pNo, "小作料単位"), dX(16) + 0.5, dY + nRH * 7, ColW(16), nRH, nFsize, 0, 0
                    End If
                    If Val(mvarPData.Data(pNo, "期間")) <> 0 Then
                        .DrawText "期間" & mvarPData.Data(pNo, "期間") & "年", dX(16) + 0.5, dY + nRH * 8, ColW(16), nRH, nFsize, 0, 0
                    End If
                    
                    .DrawText IIf(Val(mvarPData.Data(pNo, "建ぺい率")) = 0, "", FormatNumber(Val(mvarPData.Data(pNo, "建ぺい率")), 1) & "％"), dX(16), dY + nRH * 12, ColW(16) - 1, nRH, nFsize, 1, 0
                    If Val(mvarPData.Data(pNo, "棟数")) <> 0 Then
                        .TextOut "棟数", dX(16) + 1, dY + nRH * 13.5, nFsize, 0, 0
                        .DrawText Val(mvarPData.Data(pNo, "棟数")) & "棟", dX(16), dY + nRH * 13.5, ColW(16) - 1, nRH, nFsize, 1, 0
                    End If
                    If Val(mvarPData.Data(pNo, "所要面積")) <> 0 Then
                        .TextOut "所要面積", dX(16) + 1, dY + nRH * 15, nFsize, 0, 0
                        .DrawText FormatNumber(Val(mvarPData.Data(pNo, "所要面積")), 1) & "u", dX(16), dY + nRH * 16, ColW(16) - 1, nRH, nFsize, 1, 0
                    End If
                    If Val(mvarPData.Data(pNo, "建築面積")) <> 0 Then
                        .TextOut "建築面積", dX(16) + 1, dY + nRH * 17.5, nFsize, 0, 0
                        .DrawText FormatNumber(Val(mvarPData.Data(pNo, "建築面積")), 1) & "u", dX(16), dY + nRH * 18.5, ColW(16) - 1, nRH, nFsize, 1, 0
                    End If
                End If
                        
                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(5), dY, ColW(5) - 2, RowH, nFsize, 1, 0
                    .DrawText pFormatN(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積"))), dX(9), dY, ColW(9) - 1, RowH, nFsize, 1
                ElseIf Len(mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在")) > 0 Then
                    If mvarPData.Data(pNo, "共有持分") = "1" Or CBool(mvarPData.Data(pNo, "複数申請人A")) Then
                        .DrawText StrConv(mvarPData.Data(pNo & ":農地." & pSubNo, "所有者住所"), vbNarrow), dX(3) + 0.5, dY, ColW(3) - 1, 3, nFsize
                        .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "所有者名"), 7), dX(4) + 0.5, dY, ColW(4) - 1, 3, nFsize - IIf(Len(mvarPData.Data(pNo & ":農地." & pSubNo, "所有者名")) > 12, 1, 0), 0, 0
                    End If
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(5) + 1, dY, ColW(5) - 1, 3, nFsize
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "持分"), dX(6), dY, ColW(6), RowH, nFsize, 2
                    .DrawText Left$(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 3), dX(7), dY, ColW(7), RowH, nFsize - IIf(Len(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目")) > 2, 1, 0), 2, 0
                    .DrawText Left$(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 3), dX(8), dY, ColW(8), RowH, nFsize - IIf(Len(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目")) > 2, 1, 0), 2, 0
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        .DrawText pFormatN(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積"))), dX(9), dY, ColW(9) - 1, RowH, nFsize, 1, 0
                    End If
                ElseIf Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                    .DrawText "の内" & pFormatN(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積"))), dX(9), dY, ColW(9) - 1, RowH, nFsize - 1, 1, 0
                End If
                
                If pSubNo = pSubEnd Then
                    .TextOut "※参考図面は裏面", dX(0) + 1, dY + 8, nFsize, 0, 0
                End If
            
            Case "さつま町"
                If pSubNo = pSubStart Then
                    .DrawText mvarPData.Data(pNo, "通年受付番号"), dX(0), dY, ColW(0), RowH, nFsize, 1   '番号
                    
                    .DrawText Left(mvarPData.Data(pNo, "氏名A"), 14), dX(9) + 0.5, dY, ColW(9) - 2, RowH - 1, nFsize - 1, 0
                    .DrawText StrConv(Left(mvarPData.Data(pNo, "住所A"), 24), vbNarrow), dX(9) + 0.5, dY + RowH * 2.5, ColW(9) - 1, RowH - 1, nFsize - 1, 0
                    .DrawText Left(mvarPData.Data(pNo, "職業A"), 7), dX(9) + 0.5, dY + RowH * 5, ColW(9) - 2, RowH, nFsize - 1, 0

                    .DrawText mvarPData.Data(pNo, "氏名B"), dX(10) + 0.5, dY, ColW(10) - 2, RowH - 1, nFsize - 1, 0
                    .DrawText StrConv(Left(mvarPData.Data(pNo, "住所B"), 24), vbNarrow), dX(10) + 0.5, dY + RowH * 2.5, ColW(10) - 1, RowH - 1, nFsize - 1, 0
                    .DrawText Left(mvarPData.Data(pNo, "職業B"), 7), dX(10) + 0.5, dY + RowH * 5, ColW(10), RowH, nFsize - 1, 0

                    .DrawText Left(mvarPData.Data(pNo, "転用目的"), 12), dX(11) + 1, dY, ColW(11) - 2, RowH, nFsize, 0
                    .DLine dX(11), dY + RowH * 3, dX(12), dY + RowH * 3, vbBlack
                    If Val(mvarPData.Data(pNo, "棟数")) > 0 Then
                        .DrawText mvarPData.Data(pNo, "棟数"), dX(11), dY + RowH * 4, ColW(11) - 2, RowH, nFsize, 1
                    End If
                    .DrawText mvarPData.Data(pNo, "転用事由"), dX(12) + 0.5, dY, ColW(12), RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo, "備考"), dX(13) + 1, dY, ColW(13) - 1, RowH, nFsize - 1, 0
                    .DrawText "可・否", dX(14), dY + RowH, ColW(14), RowH, nFsize, 2
                End If
                        
                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then      '合計行
                     .TextOut mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(2) - 5, dY, nFsize, 1, 0
                     .TextOut mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(3) - 1, dY, nFsize, 1, 0
                     .TextOut FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(8) - 2, dY, nFsize, 1
                Else
                     .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(1) + 1, dY, ColW(1) - 1, 4, nFsize, 0
                     .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 2), dX(2) + 1, dY, ColW(2) - 2, RowH, nFsize, 2
                     .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 2), dX(3) + 1, dY, ColW(3) - 2, RowH, nFsize, 2
                     .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "農振区分"), dX(4), dY, ColW(4), RowH, nFsize, 2
                     .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "都市計画法"), dX(5), dY, ColW(5), RowH, nFsize, 2
                     .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地改良法"), dX(6), dY, ColW(6), RowH, nFsize, 2
                     If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                         .TextOut FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(8) - 2, dY, nFsize, 1
                     End If
                End If

                If pSubNo = pSubEnd And Len(mvarPData.Data(pNo, "調査員")) > 0 Then
                    If Len(mvarPData.Data(pNo, "調査員")) > 6 Then
                        .DrawText "(" & mvarPData.Data(pNo, "調査員") & ")", dX(13), dY - RowH, ColW(13), RowH, nFsize - 1, 2
                    Else
                        .DrawText "(" & mvarPData.Data(pNo, "調査員") & ")", dX(13), dY, ColW(13), RowH, nFsize - 1, 2
                    End If
                End If
                
            Case "日置市"
                If pSubNo = pSubStart Then
                    .TextOut mvarPData.Data(pNo, "受付番号"), (dX(0) + dX(1)) / 2, dY, nFsize, 2, 0
                    If Len(mvarPData.Data(pNo, "氏名B")) <= 24 Then
                        .DrawText mvarPData.Data(pNo, "氏名B"), dX(1) + 1, dY, ColW(1) - 1, RowH, nFsize, 0
                    ElseIf Len(mvarPData.Data(pNo, "氏名B")) <= 30 Then
                        .DrawText mvarPData.Data(pNo, "氏名B"), dX(1) + 1, dY, ColW(1) - 1, RowH - 1, nFsize - 2, 0
                    Else
                        .DrawText Left(mvarPData.Data(pNo, "氏名B"), 48), dX(1) + 1, dY, ColW(1) - 1, RowH - 1.5, nFsize - 3, 0
                    End If
                    .DrawText Left(StrConv(mvarPData.Data(pNo, "住所B"), vbNarrow), 18), dX(1) + 1, dY + RowH * 3, ColW(1) - 1, RowH, nFsize - 1, 0
                    .DrawText Left(mvarPData.Data(pNo, "職業B"), 8), dX(1) + 1, dY + RowH * 5, ColW(1) - 2, RowH, nFsize, 0
                    If Len(mvarPData.Data(pNo, "氏名A")) <= 24 Then
                        .DrawText mvarPData.Data(pNo, "氏名A"), dX(2) + 1, dY, ColW(2) - 1, RowH, nFsize, 0
                    ElseIf Len(mvarPData.Data(pNo, "氏名A")) <= 30 Then
                        .DrawText mvarPData.Data(pNo, "氏名A"), dX(2) + 1, dY, ColW(2) - 1, RowH - 1, nFsize - 2, 0
                    Else
                        .DrawText Left(mvarPData.Data(pNo, "氏名A"), 48), dX(2) + 1, dY, ColW(2) - 1, RowH - 1.5, nFsize - 3, 0
                    End If
                    .DrawText Left(StrConv(mvarPData.Data(pNo, "住所A"), vbNarrow), 18), dX(2) + 1, dY + RowH * 3, ColW(2) - 1, RowH, nFsize - 1, 0
                    .DrawText Left(mvarPData.Data(pNo, "職業A"), 8), dX(2) + 1, dY + RowH * 5, ColW(2) - 2, RowH, nFsize, 0
                
                    .DrawText mvarPData.Data(pNo, "転用目的"), dX(8) + 1, dY, ColW(8) - 2, RowH, nFsize, 2
                    St1 = ""
                    Select Case Val(mvarPData.Data(pNo, "法令"))
                        Case 50: St1 = "所有権移転"
                        Case 51:
                            Select Case Val(mvarPData.Data(pNo, "権利種類"))
                                Case 1: St1 = "賃借権"
                                Case 2: St1 = "使用貸借権"
                            End Select
                    End Select
                    .DrawText St1, dX(9), dY, ColW(9), RowH, nFsize, 2
                    If mvarPData.Data(pNo, "永久") = "1" Then
                        .DrawText "永久", dX(10), dY, ColW(10), RowH, nFsize, 2
                    Else
                        If Val(mvarPData.Data(pNo, "期間")) > 0 Then
                            .DrawText Val(mvarPData.Data(pNo, "期間")) & "年", dX(10), dY, ColW(10), RowH, nFsize, 2
                        End If
                    End If
                    
                    St2 = mvarPData.Data(pNo, "調査員")
                    If InStr(St2, "\n") = 0 Then
                        i = 0: St1 = ""
                        If Len(St2) > 0 Then
                            For n = Len(St2) To 0 Step (-4)
                                St1 = St1 & MID(St2, i * 4 + 1, 4) & "\n"
                                i = i + 1
                            Next
                            If Right(St1, 2) = "\n" Then St1 = Left(St1, Len(St1) - 2)
                            .DrawText St1, dX(11), dY, ColW(11), RowH, nFsize, 2
                        End If
                    Else
                        .DrawText St2, dX(11), dY, ColW(11), RowH, nFsize, 2
                    End If

                    .DrawText mvarPData.Data(pNo, "同意書"), dX(12), dY + RowH * 2, ColW(12), 4, nFsize, 2
                    .DrawText mvarPData.Data(pNo, "始末書"), dX(13), dY + RowH * 2, ColW(13), 4, nFsize, 2
                    .DrawText mvarPData.Data(pNo, "被害防除計画書"), dX(14), dY + RowH * 2, ColW(14), 4, nFsize, 2
                End If


                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(3) + 2, dY, ColW(3), RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(3), dY, ColW(3) - 2, RowH, nFsize, 1
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(6), dY, ColW(6) - 1, RowH, nFsize, 1
                Else
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(3) + 1, dY, ColW(3) - 2, RowH, nFsize, 0
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 1), dX(4), dY, ColW(4), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 1), dX(5), dY, ColW(5), RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(6), dY, ColW(6) - 1, RowH, nFsize, 1
                    End If
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "農振区分"), dX(7), dY, ColW(7), RowH, nFsize, 0
                End If
            
            Case "大崎町"
                If pSubNo = pSubStart Then
                    .TextOut pNo, (dX(0) + dX(1)) / 2, dY, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo, "氏名B"), 16), dX(1) + 1, dY, ColW(1) - 1, RowH, nFsize
                    If Len(mvarPData.Data(pNo, "集落B")) = 0 Or mvarPData.Data(pNo, "集落B") = "-" Then
                        .DrawText Left(Fnc.GetShortAddress(mvarPData.Data(pNo, "住所B"), s都道府県名, s郡部, , , True), 18), dX(1) + 1, dY + RowH * 2, ColW(1) - 1, RowH, nFsize - 1, 0
                    Else
                        .DrawText Left(mvarPData.Data(pNo, "集落B"), 16), dX(1) + 1, dY + RowH * 2, ColW(1) - 1, RowH, nFsize
                    End If
                    .DrawText Left(mvarPData.Data(pNo, "職業B"), 8), dX(1) + 1, dY + RowH * 4, ColW(1) - 1, RowH, nFsize

                    .DrawText Left(mvarPData.Data(pNo, "氏名A"), 16), dX(2) + 1, dY, ColW(2) - 1, RowH, nFsize
                    If Len(mvarPData.Data(pNo, "集落A")) = 0 Or mvarPData.Data(pNo, "集落A") = "-" Then
                        .DrawText Left(Fnc.GetShortAddress(mvarPData.Data(pNo, "住所A"), s都道府県名, s郡部, , , True), 18), dX(2) + 1, dY + RowH * 2, ColW(2) - 1, RowH, nFsize - 1, 0
                    Else
                        .DrawText Left(mvarPData.Data(pNo, "集落A"), 16), dX(2) + 1, dY + RowH * 2, ColW(2) - 1, RowH, nFsize
                    End If
                    .DrawText Left(mvarPData.Data(pNo, "職業A"), 8), dX(2) + 1, dY + RowH * 4, ColW(2) - 1, RowH, nFsize
                    
                    If Len(mvarPData.Data(pNo, "小作料")) > 0 Then .DrawText mvarPData.Data(pNo, "小作料") & mvarPData.Data(pNo, "小作料単位"), dX(7), dY, ColW(7), RowH, nFsize, 2
                    .DrawText mvarPData.Data(pNo, "転用目的"), dX(8) + 1, dY, ColW(8) - 1, RowH, nFsize, 2
                    .DrawText IIf(Val(mvarPData.Data(pNo, "建築面積")) = 0, "", FormatNumber(Val(mvarPData.Data(pNo, "建築面積")), 0)), dX(9), dY, ColW(9) - 1, RowH, nFsize, 1
                    If Len(mvarPData.Data(pNo, "時期")) > 0 Then .DrawText Format(mvarPData.Data(pNo, "時期"), "ge年") & "\n" & Format(mvarPData.Data(pNo, "時期"), "m月"), dX(10), dY, ColW(10), 4, nFsize, 2
                    .DrawText mvarPData.Data(pNo, "資金計画"), dX(11) + 1, dY, ColW(11) - 1, 4, nFsize, 2
                     
                     If Val(mvarPData.Data(pNo, "法令")) = 51 Then
                        Select Case Val(mvarPData.Data(pNo, "権利種類"))
                            Case 1: .DrawText "賃貸借権", dX(15), dY, ColW(15), 4, nFsize - 1, 2
                            Case 2: .DrawText "使用貸借権", dX(15), dY, ColW(15), 4, nFsize - 1, 2
                        End Select
                        If Val(mvarPData.Data(pNo, "期間")) <> 0 Then .DrawText mvarPData.Data(pNo, "期間") & "年", dX(15), dY + RowH * 2, ColW(15), RowH, nFsize, 2
                    End If
                End If
                
                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(3) + 2, dY, ColW(3), RowH, nFsize
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(3), dY, ColW(3) - 2, RowH, nFsize, 1
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(6), dY, ColW(6) - 1, RowH, nFsize, 1
                ElseIf Val(mvarPData.Data(pNo & ":農地." & pSubNo, "一部")) = 1 Then
                    .TextOut "(" & FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0) & "の内)", dX(7) - 1, dY, nFsize - 2, 1
                Else
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(3) + 1, dY, ColW(3) - 2, RowH, nFsize, 0
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 1), dX(4), dY, ColW(4), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 1), dX(5), dY, ColW(5), RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(6), dY, ColW(6) - 1, RowH, nFsize, 1
                    End If
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "農振区分"), dX(12), dY, ColW(12), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "等級"), 5), dX(13), dY, ColW(13), RowH, nFsize - 1, 2
                End If
            
            Case "長島町", "阿久根市"
                If pSubNo = pSubStart Then
                    .TextOut pNo, (dX(0) + dX(1)) / 2, dY, nFsize, 2, 0  '番号
                    
                    .DrawText Left(mvarPData.Data(pNo, "氏名B"), 16), dX(1) + 1, dY, ColW(1) - 1, RowH, nFsize, 0
                    .DrawText Left(Fnc.GetShortAddress(mvarPData.Data(pNo, "住所B"), s都道府県名, s郡部, , , True), 18), dX(1) + 1, dY + RowH * 2, ColW(1) - 1, RowH, nFsize - 1, 0
    '                    .DrawText Left(mvarPData.Data(pNo, "住所B"), 18), dX(1) + 1, dY + RowH * 2, ColW(1) - 1, RowH, nFsize - 1, 0
                    .DrawText Left(mvarPData.Data(pNo, "職業B"), 8), dX(1) + 1, dY + RowH * 4, ColW(1) - 1, RowH, nFsize, 0

                    .DrawText Left(mvarPData.Data(pNo, "氏名A"), 16), dX(2) + 1, dY, ColW(2) - 1, RowH, nFsize, 0
                    .DrawText Left(Fnc.GetShortAddress(mvarPData.Data(pNo, "住所A"), s都道府県名, s郡部, , , True), 18), dX(2) + 1, dY + RowH * 2, ColW(2) - 1, RowH, nFsize - 1, 0
    '                    .DrawText Left(mvarPData.Data(pNo, "住所A"), 18), dX(2) + 1, dY + RowH * 2, ColW(2) - 1, RowH, nFsize - 1, 0
                    .DrawText Left(mvarPData.Data(pNo, "職業A"), 8), dX(2) + 1, dY + RowH * 4, ColW(2) - 1, RowH, nFsize, 0
                    
                    .DrawText Left(mvarPData.Data(pNo, "転用目的"), 30), dX(8), dY, ColW(8), RowH, nFsize, 2
                    .DrawText mvarPData.Data(pNo, "棟数"), dX(9), dY, ColW(9), RowH, nFsize, 2
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo, "建築面積")), 2), dX(10), dY, ColW(10) - 1, RowH, nFsize, 1
                    .DrawText mvarPData.Data(pNo, "転用事由"), dX(11) + 1, dY, ColW(11) - 2, RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo, "同意書"), dX(12), dY + RowH * 2, ColW(12), 4, nFsize, 2
                    .DrawText mvarPData.Data(pNo, "始末書"), dX(13), dY + RowH * 2, ColW(13), 4, nFsize, 2
                    .DrawText mvarPData.Data(pNo, "被害防除計画書"), dX(14), dY + RowH * 2, ColW(14), 4, nFsize, 2
                End If
                
                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(3) + 2, dY, ColW(3), RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(3), dY, ColW(3) - 2, RowH, nFsize, 1
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(6), dY, ColW(6) - 1, RowH, nFsize, 1
                Else
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(3) + 1, dY, ColW(3) - 2, RowH, nFsize, 0
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 1), dX(4), dY, ColW(4), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 1), dX(5), dY, ColW(5), RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(6), dY, ColW(6) - 1, RowH, nFsize, 1
                    End If
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "農振区分"), dX(7), dY, ColW(7), RowH, nFsize, 0
                End If
            
            Case Else
                If pSubNo = pSubStart Then
                    .TextOut pNo, (dX(0) + dX(1)) / 2, dY, nFsize, 2, 0  '番号
                    
                    .DrawText Left(mvarPData.Data(pNo, "氏名B"), 16), dX(1) + 1, dY, ColW(1) - 1, RowH, nFsize, 0
                    .DrawText Left(mvarPData.Data(pNo, "住所B"), 18), dX(1) + 1, dY + RowH * 2, ColW(1) - 1, RowH, nFsize - 1, 0
                    .DrawText Left(mvarPData.Data(pNo, "職業B"), 8), dX(1) + 1, dY + RowH * 4, ColW(1) - 1, RowH, nFsize, 0

                    .DrawText Left(mvarPData.Data(pNo, "氏名A"), 16), dX(2) + 1, dY, ColW(2) - 1, RowH, nFsize, 0
                    .DrawText Left(mvarPData.Data(pNo, "住所A"), 18), dX(2) + 1, dY + RowH * 2, ColW(2) - 1, RowH, nFsize - 1, 0
                    .DrawText Left(mvarPData.Data(pNo, "職業A"), 8), dX(2) + 1, dY + RowH * 4, ColW(2) - 1, RowH, nFsize, 0
                    
                    .DrawText Left(mvarPData.Data(pNo, "転用目的"), 30), dX(8), dY, ColW(8), RowH, nFsize, 2
                    .DrawText mvarPData.Data(pNo, "棟数"), dX(9), dY, ColW(9), RowH, nFsize, 2
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo, "建築面積")), 2), dX(10), dY, ColW(10) - 1, RowH, nFsize, 1
                    .DrawText mvarPData.Data(pNo, "転用事由"), dX(11) + 1, dY, ColW(11) - 2, RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo, "同意書"), dX(12), dY + RowH * 2, ColW(12), 4, nFsize, 2
                    .DrawText mvarPData.Data(pNo, "始末書"), dX(13), dY + RowH * 2, ColW(13), 4, nFsize, 2
                    .DrawText mvarPData.Data(pNo, "被害防除計画書"), dX(14), dY + RowH * 2, ColW(14), 4, nFsize, 2
                End If
                
                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(3) + 2, dY, ColW(3), RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(3), dY, ColW(3) - 2, RowH, nFsize, 1
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(6), dY, ColW(6) - 1, RowH, nFsize, 1
                Else
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(3) + 1, dY, ColW(3) - 2, RowH, nFsize, 0
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 1), dX(4), dY, ColW(4), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 1), dX(5), dY, ColW(5), RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(6), dY, ColW(6) - 1, RowH, nFsize, 1
                    End If
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "農振区分"), dX(7), dY, ColW(7), RowH, nFsize, 0
                End If
            End Select
        End With
    End Sub
    
    Private Sub PrintSubTotal(ByRef mvarParent As ADBasicLIB2.CPrintFormSK, ByRef dX() As Single, dY As Single)
        Dim n As Long
        Dim wdy As Single
        Dim Xcnt As Long
        Dim b表示 As Boolean
        
        If T総合計.n筆数(3) = 0 Then Exit Sub
        wdy = dY
        Xcnt = UBound(ColW) + 1
                
        With mvarParent
            Select Case Fnc.s市町村名
            Case "姶良市"
                b表示 = False
                For n = 0 To 3
                    If Val(T総合計.n面積(n)) - Fix(Val(T総合計.n面積(n))) <> 0 Then
                        b表示 = True
                        Exit For
                    End If
                Next

                For n = 0 To 3
                    If T総合計.n筆数(n) > 0 Then
                        .DrawText T総合計.s地目(n), dX(3) + 2, dY, ColW(3), RowH, nFsize
                        .DrawText T総合計.n筆数(n) & " 筆", dX(3), dY, ColW(3) - 2, RowH, nFsize, 1
                        If b表示 Then
                            .TextOut Format(Val(T総合計.n面積(n)), "#,##0.00"), dX(7) - 1, dY, nFsize, 1
                        Else
                            .DrawText Format(Val(T総合計.n面積(n)), "#,##0"), dX(6), dY, ColW(6) - 1, RowH, nFsize, 1
                        End If
                        dY = dY + RowH
                    End If
                Next
                .DrawText "［　総 合 計　］", dX(0), wdy + (dY - wdy) / 2, dX(3) - dX(0), RowH, nFsize, 2, 2
                .DLine dX(0), wdy - 1, dX(0), dY
                .DLine dX(3), wdy - 1, dX(3), dY
                .DLine dX(4), wdy - 1, dX(4), dY
                .DLine dX(7), wdy - 1, dX(7), dY
                .DLine dX(Xcnt), wdy - 1, dX(Xcnt), dY
                .DLine dX(0), dY, dX(Xcnt), dY
                
            End Select
        End With
    End Sub


    Private Sub CPrintSub_SetData(ByVal sKey As String, Optional ByVal sParam1 As String = "", Optional ByVal sParam2 As String = "")
        Select Case sKey
            Case "議案番号": mvar議案番号 = Val(sParam1)
        End Select
    End Sub
    
    Private Sub Class_Initialize()
        Dim n As Long
        Dim Rs As ADBasicLIB2.RecordsetEx
        
        Set mvarPData = New CPrintDatas
        mvarPData.Headers = _
        "法令;受付番号;通年受付番号;受付年月日;受付補助記号;" & _
        "氏名B;住所B;集落B;職業B;" & _
        "氏名A;住所A;集落A;職業A;複数申請人A;" & _
        "転用目的;棟数;建築面積;転用事由;同意書;始末書;被害防除計画書;理由書;調査員;" & _
        "用途;資金計画;被害防除概要;建ぺい率;所要面積;備考;権利種類;期間;始期;終期;永久;小作料;小作料単位;予備1;共有持分;" & _
        "工事開始年1;工事開始月1;工事終了年1;工事終了月1;工事開始年2;工事開始月2;工事終了年2;工事終了月2;時期;農地区分;農地区分補足;協議状況;" & _
        ">農地;土地所在;登記地目;現況地目;面積;農振区分;都市計画法;都市計画法ID;等級;土地改良法;持分;所有者名;所有者住所;小数点;一部;線;"

        For n = 0 To PGMAX
            PgChgSt(n) = 0
            PgChgEn(n) = 0
        Next
        DataCnt = 0
        PageCnt = 0
        PageMax = 0
        PageNow = 1
        s支所 = ""
        UBN = 0
        For n = 0 To 3
            T総合計.s地目(n) = ""
            T総合計.n筆数(n) = 0
            T総合計.n面積(n) = 0
        Next
    
        Set Rs = SystemDB.GetRecordsetEx("SELECT ID,名称 FROM [M_BASICALL] WHERE [Class]='農地区分'", 0, , Me)
        Do Until Rs.EOF
            p農地区分.Add Rs.Value("ID"), Rs.Value("名称")
            Rs.MoveNext
        Loop
        SystemDB.CloseRs Rs
        
        Set Rs = SystemDB.GetRecordsetEx("SELECT ID,名称 FROM [M_BASICALL] WHERE [Class]='都市計画区分'", 0, , Me)
        Do Until Rs.EOF
            p都計区分.Add Rs.Value("ID"), Rs.Value("名称")
            Rs.MoveNext
        Loop
        SystemDB.CloseRs Rs
        
        Set Rs = SystemDB.GetRecordsetEx("SELECT ID,名称 FROM [M_BASICALL] WHERE [Class]='申請時農振区分'", 0, , Me)
        Do Until Rs.EOF
            p農振区分.Add Rs.Value("ID"), Rs.Value("名称")
            Rs.MoveNext
        Loop
        SystemDB.CloseRs Rs
        
        
        Set Rs = SystemDB.GetRecordsetEx("SELECT ID,名称 FROM [M_BASICALL] WHERE [Class]='支所番号'", 0, , Me)
        Do Until Rs.EOF
            p支所番号.Add Rs.Value("ID"), Rs.Value("名称")
            Rs.MoveNext
        Loop
        SystemDB.CloseRs Rs
   End Sub

    Private Sub CPrintSub_SetRsData(pRs As Object)
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim RsT As ADBasicLIB2.RecordsetEx
        Dim n As Long
        Dim i As Long
        Dim St As String
        Dim nFlag(3) As Integer     '合計行作成用フラグ
        Dim W As Long
        Dim nSubCount As Long
        Dim pFlag As Long
        Dim sSQL As String
        Dim b合計出力 As Boolean
        Dim n面積 As Double
        Dim n部分面積 As Double
        Dim n集計面積 As Double
        Dim n行数 As Long
        Dim n最大行数 As Long
        Dim n転用事由文字数 As Long
        Dim n被害防除文字数 As Long
        Dim n備考文字数 As Long
        Dim n地目区分 As Long
        Dim p合計 As TotalData
        Dim n所有者 As Long
        Dim n分母(3) As Long
        Dim n分子(3) As Long
        Dim nWork As Long
        Dim Ar As Variant, Cm As Variant
        Dim b支所 As Boolean
        Dim b支所改頁 As Boolean
        Dim b一部現況 As Boolean
        Dim n所有者住所 As String
        Dim n所有者筆 As Long
    
        mvarTitle = SystemDB.DBProperty("議案書５条タイトル")
        Ar = Split(mvarData, vbCrLf)
        Cm = Split(Ar(1), ";")
        s都道府県名 = Cm(0)
        s郡部 = Cm(1)
        If Cm(2) = "" Then b支所改頁 = False Else b支所改頁 = CBool(Cm(2))
        If Cm(3) = "" Then b支所 = False Else b支所 = CBool(Cm(3))

        T総合計.s地目(0) = "( 田 )"
        T総合計.s地目(1) = "( 畑 )"
        T総合計.s地目(2) = "( 他 )"
        T総合計.s地目(3) = "( 計 )"
        
        For n = 0 To 3
            n分母(n) = 0
            n分子(n) = 0
        Next
        n所有者 = 0

        pFlag = 0
        n転用事由文字数 = 0         ' 転用事由１行の文字数
        n被害防除文字数 = 0         ' 被害防除概要１行の文字数
        n備考文字数 = 0
        
        b合計出力 = True
        b一部現況 = False
        Select Case Fnc.s市町村名
            Case "姶良市"
                HMax = 8            '基本データMAX
                LMax = 24           '１ページの行数
                ColW = GetArray(8, 40, 40, 50, 6, 6, 20, 6, 18, 18, 30, 30)
                StartX = 10        'データ始点(X)
                StartY = 48         'データ始点(Y)
                nFsize = 11       'フォントサイズ
                RowH = 5       '行幅
                n備考文字数 = 7
                b一部現況 = True


            Case "枕崎市"
                HMax = 3            '基本データMAX
                LMax = 26           '１ページの行数
                ColW = GetArray(12, 56, 12, 22, 20, 32, 32, 45, 26)
                StartX = 30         'データ始点(X)
                StartY = 65         'データ始点(Y)
                nFsize = 11       'フォントサイズ
                RowH = 5       '行幅
                n転用事由文字数 = 10
                
            Case "南種子町"
                HMax = 22           '基本データMAX
                LMax = 22           '１ページの行数
                StartX = 10         'データ始点(X)
                StartY = 50         'データ始点(Y)
                nFsize = 8        'フォントサイズ
                ColW = GetArray(5, 14, 22, 22, 20, 30, 8, 8, 8, 18, 14, 14, 14, 14, 18, 25, 18) '表のデータ枠幅
                RowH = 6            '行幅
                pFlag = 1
'                n転用事由文字数 = 6
'                n被害防除文字数 = 8
               
            Case "さつま町"
                HMax = 6            '基本データMAX
                LMax = 27           '１ページの行数
                StartX = 6          'データ始点(X)
                StartY = 56         'データ始点(Y)
                nFsize = 11       'フォントサイズ
                ColW = GetArray(6, 50, 12, 12, 10, 10, 10, 22, 6, 30, 30, 20, 36, 24, 6) '表のデータ枠幅
                RowH = 5       '行幅
                n転用事由文字数 = 9
                
            Case "三股町"
                HMax = 4            '基本データMAX
                LMax = 20           '１ページの行数
                StartX = 20         'データ始点(X)
                StartY = 56         'データ始点(Y)
                nFsize = 10       'フォントサイズ
                ColW = GetArray(7, 5, 32, 32, 46, 8, 8, 15, 8, 5, 15, 15, 8, 13, 5, 5, 5, 12, 10) '表のデータ枠幅
                RowH = 5       '行幅
                b合計出力 = False
                
            Case "日置市"
                HMax = 6            '基本データMAX
                LMax = 26           '１ページの行数
                ColW = GetArray(6, 35, 35, 60, 6, 6, 15, 8, 26, 22, 12, 24, 6, 6, 6)
                StartX = 10         'データ始点(X)
                StartY = 48         'データ始点(Y)
                nFsize = 11       'フォントサイズ
                RowH = 5       '行幅
            
            Case "大崎町"
                HMax = 5            '基本データMAX
                LMax = 30           '１ページの行数
                ColW = GetArray(6, 30, 30, 45, 6, 6, 14, 16, 18, 14, 14, 16, 10, 18, 7, 18)
                StartX = 15         'データ始点(X)
                StartY = 48         'データ始点(Y)
                nFsize = 10       'フォントサイズ
                RowH = 4       '行幅
                b一部現況 = True

            Case Else
                HMax = 5            '基本データMAX
                LMax = 25           '１ページの行数
                ColW = GetArray(6, 35, 35, 48, 6, 6, 15, 8, 25, 10, 16, 42, 6, 6, 6)
                StartX = 15         'データ始点(X)
                StartY = 48         'データ始点(Y)
                nFsize = 11       'フォントサイズ
                RowH = 5       '行幅
                n転用事由文字数 = 10
        End Select

        ' データ作成
        Set Rs = pRs
 
        With mvarPData
            n = .NewLine
            If b支所改頁 And (s支所 <> Rs.Value("受付補助記号")) Then DataCnt = LMax
            
            .SetRsData n, "法令", Rs
            If UBN <> Rs.V("受付番号") Then
                .SetRsData n, "受付番号", Rs
                UBN = Rs.V("受付番号")
            Else
                .Data(n, "受付番号") = ""
            End If
            .SetRsData n, "通年受付番号", Rs
            .SetRsData n, "受付年月日", Rs
            
            If b支所 Then
                If p支所番号.Exists(Rs.Value("支所番号")) Then
                    .Data(n, "受付補助記号") = p支所番号.Item(Rs.Value("支所番号"))
                Else
                    .Data(n, "受付補助記号") = ""
                End If
            Else
                .Data(n, "受付補助記号") = Rs.NullCast("受付補助記号", "")
            End If
            
            If Not Rs.IsNull("氏名B") And Rs.Value("氏名B") <> "" Then
                .SetRsData n, "氏名B", Rs
            ElseIf Not Rs.IsNull("申請者B") And Rs.Value("申請者B") <> 0 Then
                .Data(n, "氏名B") = SystemDB.GetDirectData("D:個人Info", "氏名", Rs.Value("申請者B"))
            End If
            
            .SetRsData n, "住所B", Rs
            .SetRsData n, "集落B", Rs
            .SetRsData n, "職業B", Rs
            
            If Not Rs.IsNull("代理人名") And Rs.Value("代理人名") <> "" Then
                .SetRsData n, "氏名A", Rs, "代理人名"
            ElseIf Not Rs.IsNull("氏名A") And Rs.Value("氏名A") <> "" Then
                .SetRsData n, "氏名A", Rs, "氏名A"
            ElseIf Not Rs.IsNull("参照A") And Rs.Value("参照A") <> "" Then
                .SetRsData n, "氏名A", Rs, "参照A"
            End If
           
            .SetRsData n, "住所A", Rs
            .SetRsData n, "集落A", Rs
            .SetRsData n, "職業A", Rs
            .SetRsData n, "転用目的", Rs, "申請理由A"
            .SetRsData n, "棟数", Rs, "数量"
            .SetRsData n, "建築面積", Rs, "建築面積"
            .SetRsData n, "転用事由", Rs, "申請理由B"
            .Data(n, "同意書") = IIf(Rs.Value("同意書") = True, "○", "")
            .Data(n, "始末書") = IIf(Rs.Value("始末書") = True, "○", "")
            .Data(n, "被害防除計画書") = IIf(Rs.Value("被害防除計画書") = True, "○", "")
            .Data(n, "理由書") = IIf(Rs.Value("理由書") = True, "○", "")
            .Data(n, "協議状況") = IIf(Rs.Value("被害防除計画書") = True, "被害防除計画あり", "") & IIf(Rs.Value("同意書") = True, "\n同意書あり", "") & IIf(Rs.Value("始末書") = True, "\n始末書あり", "") & IIf(Rs.Value("理由書") = True, "\n面積越理由書あり", "")
            
            .SetRsData n, "用途", Rs
            .SetRsData n, "資金計画", Rs
            .SetRsData n, "被害防除概要", Rs
            .SetRsData n, "建ぺい率", Rs
            .SetRsData n, "所要面積", Rs
            .SetRsData n, "備考", Rs
            .SetRsData n, "権利種類", Rs
            .SetRsData n, "工事開始年1", Rs
            .SetRsData n, "工事開始月1", Rs
            .SetRsData n, "工事終了年1", Rs
            .SetRsData n, "工事終了月1", Rs
            .SetRsData n, "工事開始年2", Rs
            .SetRsData n, "工事開始月2", Rs
            .SetRsData n, "工事終了年2", Rs
            .SetRsData n, "工事終了月2", Rs
            .SetRsData n, "小作料", Rs
            .SetRsData n, "小作料単位", Rs
            .SetRsData n, "予備1", Rs
            .SetRsData n, "複数申請人A", Rs
            .SetRsData n, "農地区分補足", Rs
            
            If Fnc.s市町村名 = "南種子町" Then
                .SetRsData n, "調査員", Rs, "調査員A"
            ElseIf Not Rs.IsNull("調査員A") Then
                .Data(n, "調査員") = Replace(Replace(StrConv(Rs.Value("調査員A"), vbNarrow), ",", "\n"), "､", "\n")
            End If
            
            .Data(n, "農地区分") = ""
            If Rs.IsNull("農地区分") Then
            ElseIf p農地区分.Exists(Rs.Value("農地区分")) Then
                .Data(n, "農地区分") = p農地区分.Item(Rs.Value("農地区分"))
            End If
            
            If Rs.IsNull("農振区分") Then
            ElseIf p農地区分.Exists(Rs.Value("農振区分")) Then
                .Data(n, "農地区分") = .Data(n, "農地区分") & "\n\n" & p農振区分.Item(Rs.Value("農振区分"))
            End If
            
            If Rs.IsNull("都市計画区分") Then
            ElseIf p都計区分.Exists(Rs.Value("都市計画区分")) Then
                .Data(n, "農地区分") = .Data(n, "農地区分") & "\n\n" & p都計区分.Item(Rs.Value("都市計画区分"))
            End If
            
            
            
            .Data(n, "時期") = IIf(Rs.IsNull("時期") Or Rs.Value("時期") = "0:00:00", "", Rs.Value("時期"))
            
            If Rs.Value("永久") Then
                .Data(n, "期間") = 0
            ElseIf Not Rs.IsNull("期間") And Rs.Value("期間") <> 0 Then
                .SetRsData n, "期間", Rs
            ElseIf IsDate(Rs.Value("始期")) And IsDate(Rs.Value("終期")) Then
                .Data(n, "期間") = DateDiff("yyyy", Rs.Value("始期"), Rs.Value("終期"))
            Else
                .Data(n, "期間") = 0
            End If
            
            .Data(n, "始期") = IIf(Rs.IsNull("始期") Or Rs.Value("始期") = "0:00:00", "", Rs.Value("始期"))
            .Data(n, "終期") = IIf(Rs.IsNull("終期") Or Rs.Value("終期") = "0:00:00", "", Rs.Value("終期"))
            .Data(n, "永久") = IIf(Rs.Value("永久"), "1", "0")
            .Data(n, "共有持分") = 0
            
            For W = 0 To 3
                p合計.n面積(W) = 0
                p合計.n筆数(W) = 0
            Next
            i = 0
            n所有者住所 = 0: n所有者筆 = 0
            If Rs.IsNull("農地リスト") Then
            ElseIf Len(Rs.Value("農地リスト")) > 3 Then
                
                St = Replace(Replace(Rs.Value("農地リスト"), "農地.", ""), ";", ",")
                St = Replace(St, "転用", "")
                
                sSQL = "SELECT [V_農地].*,[V_地目].名称 AS 登記地目,[地目2].名称 AS [現況],[V_農委地目].名称 AS [農委地目],[D:個人Info].氏名 AS [所有者名],[D:個人Info].住所 AS [所有者住所],[D_部分申請].部分面積 AS [部分面積T]"
                sSQL = sSQL & " FROM (((([V_農地] LEFT JOIN [V_地目] ON [V_農地].[登記簿地目]=[V_地目].ID) LEFT JOIN V_現況地目 AS 地目2 ON [V_農地].[現況地目]=[地目2].ID) LEFT JOIN [V_農委地目] ON [V_農地].[農委地目ID]=[V_農委地目].ID) LEFT JOIN [D:個人Info] ON [V_農地].[管理人ID]=[D:個人Info].ID) LEFT JOIN [D_部分申請] ON [V_農地].ID = [D_部分申請].農地ID"
                sSQL = sSQL & " WHERE [V_農地].[ID] IN (" & St & ")"
                If Fnc.s市町村名 = "姶良市" Then
                    sSQL = sSQL & " ORDER BY [V_農地].[大字ID],[V_農地].[小字ID],val(IIf(IsNull([地番]),0,IIf(InStr([地番],'-')=0,Val([地番]),val(Left([地番],InStr([地番],'-')-1)))) *1000 + Val(IIf(IsNull([地番]),0,IIf(InStr([地番],'-')=0,0,val(Mid([地番],InStr([地番],'-')+1))))))"
                Else
                    sSQL = sSQL & " ORDER BY [V_農地].[管理人ID],[V_農地].[土地所在];"
                End If
                Set RsT = SystemDB.GetRecordsetEx(sSQL, 1, , "議案書")
                Do Until RsT.EOF
                    i = i + 1
                    If i > 1 Then .Data(n & ":農地." & i, "線") = 0
                    If n所有者 <> RsT.Value("管理人ID") Then
                        If Fnc.s市町村名 = "姶良市" And n所有者 <> 0 And Rs.Value("複数申請人A") Then
                            i = i + 1: .Data(n & ":農地." & i, "土地所在") = "": .Data(n & ":農地." & i, "線") = 0
                            i = i + 1: .Data(n & ":農地." & i, "土地所在") = "": .Data(n & ":農地." & i, "線") = 1
                        ElseIf Fnc.s市町村名 = "南種子町" And n所有者 <> 0 Then
                            ' 譲渡人複数印刷の時の住所行数設定（住所枠 半角14文字）
                            W = (i - n所有者筆) * 28
                            If n所有者住所 > W Then
                                W = n所有者住所 - W
                                Do While W > 0
                                    .Data(n & ":農地." & i, "土地所在") = ""
                                    i = i + 1
                                    W = W - 28
                                Loop
                            End If
                        End If
                        .SetRsData n & ":農地." & i, "所有者名", RsT
                        .SetRsData n & ":農地." & i, "所有者住所", RsT
                        n所有者 = RsT.Value("管理人ID")
                        n所有者住所 = pLen(StrConv(RsT.Value("所有者住所"), vbNarrow))  '南種子用
                        n所有者筆 = i                                                  ' 南種子用
                    End If
                    
                    .SetRsData n & ":農地." & i, "土地所在", RsT
                    .SetRsData n & ":農地." & i, "登記地目", RsT
                    
                    If (Not RsT.IsNull("農委地目ID")) And (RsT.Value("農委地目ID") <> 0) And (Not RsT.IsNull("農委地目認定日")) And (RsT.Value("農委地目認定日") <> "0:00:00") Then
                        .SetRsData n & ":農地." & i, "現況地目", RsT, "農委地目"
                    Else
                        .SetRsData n & ":農地." & i, "現況地目", RsT, "現況"
                    End If
                    
                    .SetRsData n & ":農地." & i, "等級", RsT
                    .SetRsData n & ":農地." & i, "都市計画法ID", RsT, "都市計画法"
            
                    If pFlag = 1 Then
                        Select Case RsT.Value("農業振興地域")
                            Case 1:    .Data(n & ":農地." & i, "農振区分") = "農用地内"
                            Case 2:    .Data(n & ":農地." & i, "農振区分") = "振興地域外"
                            Case Else: .Data(n & ":農地." & i, "農振区分") = "農用地外"
                        End Select
                        
                        Select Case RsT.Value("都市計画法")
                            Case 0:    .Data(n & ":農地." & i, "都市計画法") = "都市計画区域外"
                            Case 1:    .Data(n & ":農地." & i, "都市計画法") = "都市計画区域内"
                            Case 2:    .Data(n & ":農地." & i, "都市計画法") = "用途地域内"
                            Case 3:    .Data(n & ":農地." & i, "都市計画法") = "調整区域内"
                            Case 4:    .Data(n & ":農地." & i, "都市計画法") = "市街化区域内"
                        End Select
                    Else
                        Select Case RsT.Value("農業振興地域")
                            Case 1:    .Data(n & ":農地." & i, "農振区分") = "地内"
                            Case 2:    .Data(n & ":農地." & i, "農振区分") = "振外"
                            Case Else: .Data(n & ":農地." & i, "農振区分") = "地外"
                        End Select
                    
                        Select Case RsT.Value("都市計画法")
                            Case 0:    .Data(n & ":農地." & i, "都市計画法") = "区外"
                            Case 1:    .Data(n & ":農地." & i, "都市計画法") = "区内"
                            Case 2:    .Data(n & ":農地." & i, "都市計画法") = "用途"
                            Case 3:    .Data(n & ":農地." & i, "都市計画法") = "調内"
                            Case 4:    .Data(n & ":農地." & i, "都市計画法") = "区内"   '市街化区域内
        '                    Case 0:    .Data(n & ":農地." & i, "都市計画法") = "区外"
        '                    Case 1:    .Data(n & ":農地." & i, "都市計画法") = "調内"
        '                    Case 2:    .Data(n & ":農地." & i, "都市計画法") = "区内"   '市街化区域内
        '                    Case 3:    .Data(n & ":農地." & i, "都市計画法") = "準住"
        '                    Case 4:    .Data(n & ":農地." & i, "都市計画法") = "区内"
        '                    Case 5:    .Data(n & ":農地." & i, "都市計画法") = "用途"
                            Case Else: .Data(n & ":農地." & i, "都市計画法") = ""
                        End Select
                    End If
                    Select Case RsT.Value("土地改良法")
                        Case 0:    .Data(n & ":農地." & i, "土地改良法") = "区外"
                        Case 1:    .Data(n & ":農地." & i, "土地改良法") = "区内"
                        Case Else: .Data(n & ":農地." & i, "土地改良法") = ""
                    End Select
                    
                    If Not RsT.IsNull("共有持分分母") And RsT.Value("共有持分分母") <> 0 Then
                        .Data(n & ":農地." & i, "持分") = RsT.Value("共有持分分子") & "/" & RsT.Value("共有持分分母")
                        .Data(n, "共有持分") = 1
                    End If
                    
                    n部分面積 = 0
                    If Not RsT.IsNull("部分面積T") Then n部分面積 = RsT.Value("部分面積T")
                                          
                    n地目区分 = 2                   '他
                    n面積 = 0
                    If RsT.Value("田面積") <> 0 Then
                        n面積 = RsT.Value("田面積")
                        n地目区分 = 0               '田
                    ElseIf RsT.Value("畑面積") <> 0 Then
                        n面積 = RsT.Value("畑面積")
                        n地目区分 = 1               '畑
                    End If
                    If n面積 = 0 Then
                        If RsT.Value("樹園地") <> 0 Then n面積 = RsT.Value("樹園地")
                        If RsT.Value("採草放牧面積") <> 0 Then n面積 = RsT.Value("採草放牧面積")
                        If n面積 = 0 Then n面積 = Fnc.NullCast(RsT.Value("登記簿面積"), 0)
                    End If
                    If Fnc.s市町村名 = "南種子町" Then n面積 = Fnc.NullCast(RsT.Value("登記簿面積"), 0)
                    n集計面積 = n面積
                    
                    If n部分面積 > 0 Then
                        If Fnc.s市町村名 = "南種子町" Then
                            .Data(n & ":農地." & i, "面積") = n集計面積
                            i = i + 1
                        End If
                        n集計面積 = n部分面積
                    End If

                    If Fnc.s市町村名 = "姶良市" Then
                        If n集計面積 >= 10 Then
                            n集計面積 = Fix(n集計面積)
                            .Data(n & ":農地." & i, "小数点") = 0
                        Else
                            .Data(n & ":農地." & i, "小数点") = 1
                        End If
                    ElseIf Fnc.s市町村名 <> "南種子町" Then
                        n集計面積 = Fix(n集計面積)
                    End If
                    .Data(n & ":農地." & i, "面積") = n集計面積
                    
                    .Data(n & ":農地." & i, "一部") = 0
                    If RsT.IsNull("一部現況") Then
                    ElseIf b一部現況 And Val(RsT.Value("一部現況")) > 0 Then
                        i = i + 1
                        .Data(n & ":農地." & i, "一部") = 1
                        n面積 = Fnc.NullCast(RsT.Value("登記簿面積"), 0)
                        If n面積 >= 10 And Fnc.s市町村名 <> "南種子町" Then
                            .Data(n & ":農地." & i, "面積") = Fix(n面積)
                        Else
                            .Data(n & ":農地." & i, "面積") = n面積
                        End If
                    End If
                    
                    If Not RsT.IsNull("共有持分分母") And RsT.Value("共有持分分母") <> 0 Then
                        If n分子(n地目区分) = 0 And n分母(n地目区分) = 0 Then
                            n分子(n地目区分) = RsT.Value("共有持分分子")
                            n分母(n地目区分) = RsT.Value("共有持分分母")
                        Else
                            n分子(n地目区分) = n分子(n地目区分) * RsT.Value("共有持分分母")
                            n分子(n地目区分) = n分子(n地目区分) + RsT.Value("共有持分分子") * n分母(n地目区分)
                            n分母(n地目区分) = n分母(n地目区分) * RsT.Value("共有持分分母")
                        End If
                    Else
                        If n分子(n地目区分) = 0 And n分母(n地目区分) = 0 Then
                            n分子(n地目区分) = 1
                            n分母(n地目区分) = 1
                        Else
                            n分子(n地目区分) = n分子(n地目区分) + n分母(n地目区分)
                        End If
                    End If
                    
                    If Rs.Value("複数申請人A") = False And pLen(RsT.Value("土地所在")) > 26 Then
                        i = i + 1: .Data(n & ":農地." & i, "土地所在") = ""
                    End If
                    
    '                    p合計.n筆数(n地目区分) = p合計.n筆数(n地目区分) + 1
                    p合計.n面積(n地目区分) = p合計.n面積(n地目区分) + n集計面積
                    nFlag(n地目区分) = 1
                    RsT.MoveNext
                Loop
                If Rs.Value("複数申請人A") Then
                    i = i + 1: .Data(n & ":農地." & i, "土地所在") = ""
                    i = i + 1: .Data(n & ":農地." & i, "土地所在") = ""
                End If
                SystemDB.CloseRs RsT
            End If
            For W = 0 To 2
                If nFlag(W) = 1 Then
                    p合計.n筆数(W) = n分子(W) \ n分母(W)
                    n分子(W) = n分子(W) Mod n分母(W)
                End If
            Next

            s支所 = Rs.NullCast("受付補助記号", "")
            Set Rs = Nothing
    
            nSubCount = .SubCount(n & ":農地")
            
            ' 転用事由の行数チェック
            If HMax > nSubCount + 1 Then
                n行数 = HMax
            Else
                n行数 = nSubCount + 1
            End If
            n最大行数 = LenCheck(.Data(n, "転用事由"), n転用事由文字数, n行数)
            If n最大行数 > LMax Then
                n最大行数 = LMax
                St = Left(.Data(n, "転用事由"), n転用事由文字数 * LMax)
                .Data(n, "転用事由") = St
            End If
            
            n最大行数 = LenCheck(.Data(n, "被害防除概要"), n被害防除文字数, n最大行数)
            If n最大行数 > LMax Then
                n最大行数 = LMax
                St = Left(.Data(n, "被害防除概要"), n被害防除文字数 * LMax)
                .Data(n, "被害防除概要") = St
            End If
            
            n最大行数 = LenCheck(.Data(n, "備考"), n備考文字数, n最大行数)
            If n最大行数 > LMax Then
                n最大行数 = LMax
                St = Left(.Data(n, "備考"), n備考文字数 * LMax)
                .Data(n, "備考") = St
            End If
            
            ' 合計行作成
            If b合計出力 Then
                p合計.n筆数(3) = p合計.n筆数(0) + p合計.n筆数(1) + p合計.n筆数(2)
                p合計.n面積(3) = p合計.n面積(0) + p合計.n面積(1) + p合計.n面積(2)
                nFlag(3) = nFlag(0) + nFlag(1) + nFlag(2)
        
                ' 総合計
                For W = 0 To 3
                    T総合計.n筆数(W) = T総合計.n筆数(W) + p合計.n筆数(W)
                    T総合計.n面積(W) = T総合計.n面積(W) + p合計.n面積(W)
                Next
                
                If nFlag(3) = 1 Then
                    nFlag(0) = 0: nFlag(1) = 0: nFlag(2) = 0: nFlag(3) = 0
                End If
                nFlag(3) = nFlag(3) + 1
        
                If nSubCount + nFlag(3) < n最大行数 Then
                   i = n最大行数 - nFlag(3)
                End If
                
                If Fnc.s市町村名 = "南種子町" And nSubCount = 0 Then
                    i = i + 1
                    .Data(n & ":農地." & i, "土地所在") = ""
                Else
                    nWork = 0
                    For W = 0 To 3
                        If p合計.n面積(W) - Fix(p合計.n面積(W)) <> 0 Then
                            nWork = 1
                            Exit For
                        End If
                    Next
                
                    For W = 0 To 3
                        If nFlag(W) > 0 Then
                            i = i + 1
                            .Data(n & ":農地." & i, "土地所在") = T総合計.s地目(W)
                            
                            St = Format(p合計.n筆数(W), "#")
                            If n分子(W) <> 0 And W < 3 Then
                                If p合計.n筆数(W) > 0 Then St = St & "・"
                                計算A n分子(W), n分母(W)
                                St = St & n分子(W) & "/" & n分母(W)
                            End If
                            .Data(n & ":農地." & i, "登記地目") = St
'                            .Data(n & ":農地." & i, "登記地目") = p合計.n筆数(w)
                            .Data(n & ":農地." & i, "現況地目") = "99999"      'データ行との区分：合計行に"99999"セット
                            .Data(n & ":農地." & i, "面積") = p合計.n面積(W)
                            .Data(n & ":農地." & i, "小数点") = nWork
                        End If
                    Next
                End If
            Else
                i = nSubCount + 1
                If i <= n最大行数 Then
                    W = i
                Else
                    W = i Mod n最大行数
                    If W = 0 Then W = n最大行数
                End If
                Do While W < n最大行数
                    i = i + 1
                    .Data(n & ":農地." & i, "土地所在") = ""
                    W = W + 1
                Loop
                
                If Fnc.s市町村名 = "三股町" Then
                    i = nSubCount + 1
                    W = i Mod HMax
                    If W <> 0 Then
                        Do While W < HMax
                            i = i + 1
                            .Data(n & ":農地." & i, "土地所在") = ""
                            W = W + 1
                        Loop
                    End If
                End If
            End If
    
            ' ページ切替番号設定
            SetPageNo n, n最大行数
        End With
    End Sub

    Private Sub SetPageNo(nDataNo As Long, pHMax As Long)
        Dim n As Long
        Dim i As Long
        Dim nSubCount As Long
        Dim nCount As Long
        Dim wCount As Long
        
        n = nDataNo
        nSubCount = mvarPData.SubCount(n & ":農地")

        nCount = DataCnt + nSubCount + 1      ' mvarPData.SubCountは 0からみているため
        wCount = nSubCount + 1                '             件数として扱うときは１プラス

        If nCount > LMax Then
            nCount = nSubCount + 1
            i = 0
            Do While nCount > 0
                i = i + 1
                PageCnt = PageCnt + 1
                PgChgSt(PageCnt) = n * 1000 + (i - 1) * LMax
                PgChgEn(PageCnt) = n * 1000 + i * LMax - 1
                nCount = nCount - LMax
            Loop
            DataCnt = 0
            wCount = nCount + LMax
            If wCount < pHMax Then
                wCount = pHMax
            End If
        ElseIf n = 1 Then
            PageCnt = PageCnt + 1
            PgChgSt(PageCnt) = n * 1000
        End If

        PgChgEn(PageCnt) = n * 1000 + nSubCount
        DataCnt = DataCnt + wCount
        PageMax = PageCnt
    End Sub
    
    Private Function LenCheck(pStr As String, pWLen As Long, pLenMax As Long) As Long
        Dim nCount As Long
        Dim nLen As Long
        Dim nLen2 As Long
       
        LenCheck = pLenMax
        If pWLen = 0 Then Exit Function
        If Len(pStr) = 0 Then Exit Function
                   
        nCount = pLen(pStr)
        nLen = (nCount \ pWLen) + IIf((nCount Mod pWLen) = 0, 0, 1)
        nLen2 = (nLen \ 2) + IIf((nLen Mod 2) = 0, 0, 1)
        If nLen2 > pLenMax Then LenCheck = nLen2
    End Function

    Private Function p期間設定(s始期 As String, s終期 As String, s永久 As String, pFormat As String) As String
        Dim St As String
        
        St = ""
        If IsDate(s始期) Then
            St = Format(CDate(s始期), pFormat) & "\n" & "〜"
        End If
        
        If s永久 = "1" Then
            St = IIf(St = "", "永久", St & "\n" & "永久")
        ElseIf IsDate(s終期) Then
            St = St & "\n" & Format(CDate(s終期), pFormat)
        End If
        p期間設定 = St
    End Function

    Private Sub 計算A(pDataA As Long, pDataB As Long)
        Dim n As Long
        
        n = 2
        Do While (n < pDataA And n < pDataB)
            If (pDataA Mod n = 0) And (pDataB Mod n = 0) Then
                pDataA = pDataA / n
                pDataB = pDataB / n
                Exit Do
            End If
            n = n + 1
        Loop
    End Sub

    Private Function pLen(pStr As String) As Long
        Dim n As Long
        Dim nAscCode As Integer
        Dim nCount As Long
                   
        nCount = 0
        For n = 1 To Len(pStr)
            nCount = nCount + 1
            nAscCode = Asc(MID(pStr, n, 1))
            If Len(Hex(nAscCode)) > 2 Then
                nCount = nCount + 1
            End If
        Next
        pLen = nCount
    End Function

    Private Function pLeft(pStr As String, pLen As Long) As String
        Dim n As Long
        Dim nAscCode As Integer
        Dim nCount As Long
        Dim St As String, St1 As String
        
        nCount = 0
        For n = 1 To Len(pStr)
            nCount = nCount + 1
            St = MID(pStr, n, 1)
            nAscCode = Asc(St)
            If Len(Hex(nAscCode)) > 2 Then
                nCount = nCount + 1
            End If
            If nCount < pLen Then
                St1 = St1 + St
            Else
                If nCount = pLen Then St1 = St1 + St
                Exit For
            End If
        Next
        pLeft = St1
    End Function
    Private Property Let CPrintSub_StartPage(RHS As Long): mvarStartPage = RHS: End Property
    Private Property Get CPrintSub_StartPage() As Long: CPrintSub_StartPage = mvarStartPage: End Property


End Class










Class CPrintSub農地利用変更
    Option Explicit
    Implements CPrintSub
    Private mvarKey As String
    Private mvarData As String
    Private mvarPData As CPrintDatas
    Private Const PGMAX As Long = 100   'ページ切替ＭＡＸ
    Private PgChgSt(PGMAX) As Long      'ページ切替開始番号
    Private PgChgEn(PGMAX) As Long      'ページ切替終了番号
    Private DataCnt As Long             'データカウント
    Private PageCnt As Long             'ページカウント
    Private HMax As Long                '基本データMAX
    Private LMax As Long                '１ページの行数
    Private PageMax As Long             'ページＭＡＸ
    Private PageNow As Long             '現在のページ
    Private StartX As Single            'データ始点(X)
    Private StartY As Single            'データ始点(Y)
    Private FontS As Integer            'フォントサイズ
    Private RowH As Long                '１行の高さ
    Private ColW As Variant             '表枠の幅
    Private s支所 As String
    Private s都道府県名 As String
    Private s郡部 As String
    Private p支所番号 As New CDataDictionary
    Private mvarTitle As String
    
    Private Type TotalData
        s地目(4) As String
        n筆数(4) As Long
        n面積(4) As Double
    End Type
    Private T総合計 As TotalData
    Private mvarStartPage As Integer
    
    Private Property Let CPrintSub_StartPage(RHS As Long): mvarStartPage = RHS: End Property
    Private Property Get CPrintSub_StartPage() As Long: CPrintSub_StartPage = mvarStartPage: End Property
    Private Property Let CPrintSub_Data(ByVal RHS As String): Dim Cm As Variant: mvarData = RHS: Cm = Split(mvarData, ";"): mvarStartPage = Val(Cm(2)) - (Val(Cm(2)) = 2) * (Val(Cm(3)) - 2): End Property
    Private Property Get CPrintSub_Data() As String: CPrintSub_Data = mvarData: End Property

    Private Property Let CPrintSub_Key(ByVal RHS As String): mvarKey = RHS: End Property
    Private Property Get CPrintSub_Key() As String: CPrintSub_Key = mvarKey: End Property

    Private Property Get CPrintSub_MaxPage() As Long: CPrintSub_MaxPage = PageMax: End Property

    Private Property Get CPrintSub_NowPage() As Long: CPrintSub_NowPage = PageNow: End Property

    Private Sub CPrintSub_PrintSub(ByVal sKey As String, ByVal nPage As Long, mvarParent As ADBasicLIB2.CPrintFormSK)
        Dim Ar As Variant
        Dim Cm As Variant
        Dim n As Long
        Dim i As Long
        Dim dX(20) As Single, hX(20) As Single
        Dim Xcnt As Long
         
        If mvarPData.Count = 0 Then
            mvarParent.ClearScreen
            Exit Sub
        End If
        PageNow = nPage
       
        With mvarParent
            .ClearScreen
            .Offset 0, 0
            
            Ar = Split(mvarData, vbCrLf)
            Cm = Split(Ar(0), ";")
            
            dX(0) = StartX: hX(0) = dX(0) + ColW(0) / 2
            For i = 0 To UBound(ColW)
                dX(i + 1) = dX(i) + ColW(i)
                If i < UBound(ColW) Then hX(i + 1) = dX(i + 1) + ColW(i + 1) / 2
            Next
            Xcnt = UBound(ColW) + 1
            Select Case Fnc.s市町村名
                Case "姶良市"
                    .DrawWidth = 2
            End Select
            
            .Offset 0, -10
            .TextOut "議案第" & StrConv(Cm(0), vbWide) & "号", dX(0), 25, 13, 0
            .TextOut mvarTitle, dX(0) + 5, 35, 14, 0, 2
            .DrawText "番\n号", dX(0), 40, ColW(0), RowH, FontS, 2, 2, 14
            .DrawText "届　　出　　人", dX(1), 40, ColW(1), RowH, FontS, 2, 2, 14
            .DrawText "土 地 の 所 在", dX(2), 40, ColW(2), RowH, FontS, 2, 2, 14
            .DrawText "地　目", dX(3), 40, ColW(3) + ColW(4), RowH, FontS, 2, 2, 7
            .DrawText "登記", dX(3), 47, ColW(3), RowH, FontS, 2, 2, 7
            .DrawText "現況", dX(4), 47, ColW(4), RowH, FontS, 2, 2, 7
            .DrawText "地　積\n(u)", dX(5), 40, ColW(5), 4, FontS, 2, 2, 14
            .DrawText "変更後の使用目的", dX(6), 45, ColW(6), RowH, FontS, 2, 2
            If Fnc.s市町村名 = "姶良市" Then
                .DrawText "備　　考", dX(8), 40, ColW(8), RowH, FontS, 2, 2, 14
                .DrawText "申請理由", dX(7), 40, ColW(7), RowH, FontS, 2, 2, 14
            Else
                .DrawText "承認\n区分", dX(8), 40, ColW(8), RowH, FontS, 2, 2, 14
                .DrawText "備　　　考", dX(7), 40, ColW(7), RowH, FontS, 2, 2, 14
            End If
            .DLine dX(0), 40, dX(Xcnt), 40
            .DLine dX(3), 47, dX(5), 47
            .DLine dX(0), 54, dX(Xcnt), 54
            For i = 0 To Xcnt
                If i = 4 Then .DLine dX(i), 47, dX(i), 54 Else .DLine dX(i), 40, dX(i), 54
            Next
            PrintSubMain mvarParent, dX(), hX()
        End With
    End Sub
        
    Private Sub PrintSubMain(ByRef mvarParent As ADBasicLIB2.CPrintFormSK, ByRef dX() As Single, ByRef hX() As Single)
        Dim hY As Single
        Dim dY As Single
        Dim Rcnt As Long
        Dim nMainStart As Long
        Dim nMainEnd As Long
        Dim nSubStart As Long
        Dim nSubEnd As Long
        Dim n As Long
        Dim i As Long
        Dim nWork As Single
        Dim nPage As Long
        Dim Xcnt As Long
        
        nPage = PageNow

        Xcnt = UBound(ColW) + 1

        With mvarParent
            nMainStart = PgChgSt(nPage) \ 1000
            nMainEnd = PgChgEn(nPage) \ 1000
       
            dY = StartY + 1
            hY = StartY + 1

            For n = nMainStart To nMainEnd
                ' 土地データ開始番号設定
                If n = nMainStart Then
                    nSubStart = PgChgSt(nPage) - nMainStart * 1000
                Else
                    nSubStart = 0
                End If
                
                '土地データ終了番号設定
                If n = nMainEnd Then
                    nSubEnd = PgChgEn(nPage) - nMainEnd * 1000
                Else
                    nSubEnd = mvarPData.SubCount(n & ":農地")
                End If
                
                ' 罫線
                Rcnt = nSubEnd - nSubStart + 1
                If Rcnt < HMax Then
                    nWork = hY + HMax * RowH
                Else
                    nWork = dY + Rcnt * RowH
                End If
                For i = 0 To Xcnt
                    .DLine dX(i), dY - 1, dX(i), nWork, vbBlack
                Next
                
    '                '背景色設定
    '                If Fnc.s市町村名 = "日置市" Then
    '                    For i = 0 To Xcnt
    '                        Select Case i
    '                        Case 0, 7
    '                            .DBox dX(i), hY - 1, dX(i + 1), nWork, RGB(230, 230, 230), , True
    '                        End Select
    '                        .DLine dX(i), hY - 1, dX(i), nWork, vbBlack
    '                    Next
    '                    .DLine dX(0), dY - 1, dX(Xcnt), dY - 1, vbBlack
    '                End If

                ' データ出力
                For i = nSubStart To nSubEnd
                    PrintSubData mvarParent, n, i, dX, hX, dY, nSubStart, nSubEnd
                    dY = dY + RowH
                Next
                
                Rcnt = nSubEnd - nSubStart + 1
                If Rcnt < HMax Then   ' 土地データ行数が基本データ行数より少ないとき
                    dY = hY + 1 + HMax * RowH
                End If
                .DLine dX(0), dY, dX(Xcnt), dY, vbBlack
                dY = dY + 1
                hY = dY
            Next
            If nPage = PageMax Then PrintSubTotal mvarParent, dX, hX, dY
            If mvarStartPage > 0 Then .TextOut "- " & mvarStartPage - 1 + nPage & " - ", .PaperWidth / 2, .PaperHeight - 4
        End With
    End Sub
    
    Private Sub PrintSubData(ByRef mvarParent As ADBasicLIB2.CPrintFormSK, pNo As Long, pSubNo As Long, ByRef dX() As Single, ByRef hX() As Single, dY As Single, pSubStart As Long, pSubEnd As Long)
        Dim n As Long
        Dim i As Long
        
        With mvarParent
            If pSubNo = pSubStart Then
                
                '2008/05/18 test
                '.TextOut pNo, (dX(0) + dX(1)) / 2, dY + RowH, FontS, 2
                Select Case Fnc.s市町村名
                    Case "姶良市"
                        .DrawText mvarPData.Data(pNo, "受付番号"), (dX(0) + dX(1)) / 2, dY + RowH, RowH, FontS
                        '.DrawText Replace(Replace(mvarPData.Data(pNo, "調査員"), "・", "\n"), "･", "\n"), dX(8) + 1, dY, ColW(8) - 1, RowH, FontS
                        
                    Case Else
                        .TextOut pNo, (dX(0) + dX(1)) / 2, dY + RowH, FontS, 2
                End Select
                
                
                .TextOut mvarPData.Data(pNo, "受付補助記号"), (dX(0) + dX(1)) / 2, dY + RowH * 3, FontS, 2
                .DrawText Left(mvarPData.Data(pNo, "氏名"), 26), dX(1) + 1, dY, ColW(1) - 1, RowH, FontS
                .DrawText Left(Fnc.GetShortAddress(mvarPData.Data(pNo, "住所"), s都道府県名, s郡部, , , True), 39) & IIf(Len(mvarPData.Data(pNo, "集落")), "\n(" & mvarPData.Data(pNo, "集落") & ")", ""), dX(1) + 1, dY + RowH * 2, ColW(1) - 1, RowH, FontS
                
                .DrawText mvarPData.Data(pNo, "用途"), dX(6) + 1, dY, ColW(6) - 1, RowH, FontS
                .DrawText mvarPData.Data(pNo, "備考"), dX(7) + 1, dY, ColW(7) - 1, RowH, FontS
            End If

            If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then  '合計行
                .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(2) + 3, dY, ColW(2), RowH, FontS
                .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(2), dY, ColW(2) - 2, RowH, FontS, 1
                .DrawText Format(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), "#,##0"), dX(5), dY, ColW(5) - 1, RowH, FontS, 1
            ElseIf Val(mvarPData.Data(pNo & ":農地." & pSubNo, "一部")) = 1 Then
                .TextOut "(" & FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0) & "の内)", dX(6) - 1, dY, FontS - 2, 1
            Else
                .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(2) + 1, dY, ColW(2) - 2, RowH, FontS
                .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 3), dX(3), dY, ColW(3), RowH, FontS, 2
                .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 3), dX(4), dY, ColW(4), RowH, FontS, 2
                If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                    .DrawText Format(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), "#,##0"), dX(5), dY, ColW(5) - 1, RowH, FontS, 1
                End If
            End If
        End With
    End Sub

    Private Sub PrintSubTotal(ByRef mvarParent As ADBasicLIB2.CPrintFormSK, ByRef dX() As Single, ByRef hX() As Single, dY As Single)
        Dim n As Long
        Dim wdy As Single
        Dim Xcnt As Long
        
        If T総合計.n筆数(3) = 0 Then Exit Sub
        wdy = dY
        Xcnt = UBound(ColW) + 1
                
        With mvarParent
            For n = 0 To 3
                If T総合計.n筆数(n) > 0 Then
                    .DrawText T総合計.s地目(n), dX(2) + 3, dY, ColW(2) - 5, RowH, FontS
                    .DrawText T総合計.n筆数(n) & " 筆", dX(2), dY, ColW(2) - 2, RowH, FontS, 1
                    .DrawText Format(Val(T総合計.n面積(n)), "#,##0"), dX(5), dY, ColW(5) - 1, RowH, FontS, 1
                    dY = dY + RowH
                End If
            Next
            .DrawText "［　総 合 計　］", dX(0), wdy + (dY - wdy) / 2, dX(2) - dX(0), RowH, FontS, 2, 2
            .DLine dX(0), wdy - 1, dX(0), dY
            .DLine dX(2), wdy - 1, dX(2), dY
            .DLine dX(3), wdy - 1, dX(3), dY
            .DLine dX(6), wdy - 1, dX(6), dY
            .DLine dX(Xcnt), wdy - 1, dX(Xcnt), dY
            .DLine dX(0), dY, dX(Xcnt), dY
        End With
    End Sub

Private Sub CPrintSub_SetData(ByVal sKey As String, Optional ByVal sParam1 As String = "", Optional ByVal sParam2 As String = ""): End Sub

    Private Sub Class_Initialize()
        Dim n As Long
        Dim Rs As ADBasicLIB2.RecordsetEx
        
        Set mvarPData = New CPrintDatas
        mvarPData.Headers = _
        "受付番号;受付補助記号;" & _
        "氏名;住所;集落;職業;年齢;用途;備考;共有持分;調査員;" & _
        ">農地;土地所在;登記地目;現況地目;面積;持分;所有者名;所有者住所;小数点;一部;"
    
        For n = 0 To PGMAX
            PgChgSt(n) = 0
            PgChgEn(n) = 0
        Next
        DataCnt = 0
        PageCnt = 0
        PageMax = 0
        PageNow = 1
        s支所 = ""
        
        For n = 0 To 3
            T総合計.s地目(n) = ""
            T総合計.n筆数(n) = 0
            T総合計.n面積(n) = 0
        Next

        Set Rs = SystemDB.GetRecordsetEx("SELECT ID,名称 FROM [M_BASICALL] WHERE [Class]='支所番号'", 0, , Me)
        Do Until Rs.EOF
            p支所番号.Add Rs.Value("ID"), Rs.Value("名称")
            Rs.MoveNext
        Loop
        SystemDB.CloseRs Rs
    
    End Sub

    Private Sub CPrintSub_SetRsData(pRs As Object)
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim RsT As ADBasicLIB2.RecordsetEx
        Dim n As Long
        Dim i As Long
        Dim St As String
        Dim nFlag(3) As Integer     '合計行作成用フラグ
        Dim W As Long
        Dim nSubCount As Long
        Dim b合計出力 As Boolean
        Dim n面積 As Double
        Dim n集計面積 As Double
        Dim n部分面積 As Double
        Dim n行数 As Long
        Dim n最大行数 As Long
        Dim n用途文字数 As Long
        Dim n備考文字数 As Long
        Dim n地目区分 As Long
        Dim p合計 As TotalData
        Dim n所有者 As Long
        Dim n分母(3) As Long
        Dim n分子(3) As Long
        Dim nWork As Long
        Dim Ar As Variant, Cm As Variant
        Dim b支所 As Boolean
        Dim b支所改頁 As Boolean
        Dim sSQL As String

        Ar = Split(mvarData, vbCrLf)
        Cm = Split(Ar(1), ";")
        s都道府県名 = Cm(0)
        s郡部 = Cm(1)
        If Cm(2) = "" Then b支所改頁 = False Else b支所改頁 = CBool(Cm(2))
        If Cm(3) = "" Then b支所 = False Else b支所 = CBool(Cm(3))

        T総合計.s地目(0) = "( 田 )"
        T総合計.s地目(1) = "( 畑 )"
        T総合計.s地目(2) = "( 他 )"
        T総合計.s地目(3) = "( 計 )"
        
        For n = 0 To 3
            n分母(n) = 0
            n分子(n) = 0
        Next
        n所有者 = 0
        b合計出力 = True
        n用途文字数 = 0
        n備考文字数 = 0
        
        HMax = 5
        LMax = 30
        ColW = GetArray(10, 48, 60, 10, 10, 22, 46, 46, 18)
        StartX = 15
        StartY = 54
        FontS = 10
        RowH = 4
        n用途文字数 = 13
        n備考文字数 = 13
        mvarTitle = SystemDB.DBProperty("農地利用変更届タイトル")
        If mvarTitle = "" Then
            mvarTitle = SystemDB.DBPropertyEx("農地利用変更届タイトル", vbString, "農地利用変更届")
            SystemDB.DBProperty("農地利用変更届タイトル") = mvarTitle
        End If
        

        ' データ作成
        With mvarPData
            Set Rs = pRs
            n = .NewLine
            If b支所改頁 And (s支所 <> Rs.Value("受付補助記号")) Then DataCnt = LMax
            .SetRsData n, "受付番号", Rs
            If b支所 Then
                If p支所番号.Exists(Rs.Value("支所番号")) Then
                    .Data(n, "受付補助記号") = p支所番号.Item(Rs.Value("支所番号"))
                Else
                    .Data(n, "受付補助記号") = ""
                End If
            Else
                .Data(n, "受付補助記号") = Rs.NullCast("受付補助記号", "")
            End If
           
            If Not Rs.IsNull("代理人名") And Rs.Value("代理人名") <> "" Then
                .SetRsData n, "氏名", Rs, "代理人名"
            ElseIf Not Rs.IsNull("氏名A") And Rs.Value("氏名A") <> "" Then
                .SetRsData n, "氏名", Rs, "氏名A"
            ElseIf Not Rs.IsNull("参照A") And Rs.Value("参照A") <> "" Then
                .SetRsData n, "氏名", Rs, "参照A"
            End If
           
           
           
            .SetRsData n, "住所", Rs, "住所A"
            .SetRsData n, "集落", Rs, "集落A"
            .SetRsData n, "職業", Rs, "職業A"
            .SetRsData n, "年齢", Rs, "年齢A"
            .SetRsData n, "用途", Rs
            .SetRsData n, "備考", Rs
            .SetRsData n, "調査員", Rs, "調査員A"
            '.SetRsData n,
            .Data(n, "共有持分") = 0
            
            For W = 0 To 3
                p合計.n面積(W) = 0
                p合計.n筆数(W) = 0
            Next
            i = 0

            If Rs.IsNull("農地リスト") Then
            ElseIf Len(Rs.Value("農地リスト")) > 3 Then
                St = Replace(Replace(Rs.Value("農地リスト"), "農地.", ""), ";", ",")
                sSQL = "SELECT [V_農地].*,[V_地目].名称 AS [登記地目],[地目2].名称 AS [現況],[V_農委地目].名称 AS [農委地目],[D:個人Info].氏名 AS [所有者名],[D:個人Info].住所 AS [所有者住所], [D_部分申請].部分面積 AS [部分面積T] "
                sSQL = sSQL & "FROM (((([V_農地] LEFT JOIN [V_地目] ON [V_農地].[登記簿地目]=[V_地目].ID) LEFT JOIN V_現況地目 AS 地目2 ON [V_農地].[現況地目]=[地目2].ID) LEFT JOIN [V_農委地目] ON [V_農地].[農委地目ID]=[V_農委地目].ID) LEFT JOIN [D:個人Info] ON [V_農地].[管理人ID]=[D:個人Info].ID) LEFT JOIN [D_部分申請] ON [V_農地].ID = [D_部分申請].農地ID "
                sSQL = sSQL & "WHERE [V_農地].[ID] IN (" & St & " ) "
                sSQL = sSQL & "ORDER BY [V_農地].[管理人ID],[V_農地].[土地所在];"
                Set RsT = SystemDB.GetRecordsetEx(sSQL, 1, , "議案書")
                Do Until RsT.EOF
                    i = i + 1
                    .SetRsData n & ":農地." & i, "土地所在", RsT
                    .SetRsData n & ":農地." & i, "登記地目", RsT
                    
                    If (Not RsT.IsNull("農委地目ID")) And (RsT.Value("農委地目ID") <> 0) And (Not RsT.IsNull("農委地目認定日")) And (RsT.Value("農委地目認定日") <> "0:00:00") Then
                        .SetRsData n & ":農地." & i, "現況地目", RsT, "農委地目"
                    Else
                        .SetRsData n & ":農地." & i, "現況地目", RsT, "現況"
                    End If
                                        
                    n部分面積 = 0
                    If Not RsT.IsNull("部分面積T") Then n部分面積 = RsT.Value("部分面積T")
                   
                    n地目区分 = 2                   '他
                    n面積 = 0
                    If RsT.Value("田面積") <> 0 Then
                        n面積 = RsT.Value("田面積")
                        n地目区分 = 0               '田
                    ElseIf RsT.Value("畑面積") <> 0 Then
                        n面積 = RsT.Value("畑面積")
                        n地目区分 = 1               '畑
                    Else
                        If RsT.Value("樹園地") <> 0 Then n面積 = RsT.Value("樹園地")
                        If RsT.Value("採草放牧面積") <> 0 Then n面積 = RsT.Value("採草放牧面積")
                    End If
                    If n面積 = 0 Then n面積 = Fnc.NullCast(RsT.Value("登記簿面積"), 0)
                    n集計面積 = n面積
                    
                    If n部分面積 > 0 Then
                        If Fnc.s市町村名 = "南種子町" Then
                            .Data(n & ":農地." & i, "面積") = n集計面積
                            i = i + 1
                        End If
                        n集計面積 = n部分面積
                    End If

                    n集計面積 = Fix(n集計面積)
                    .Data(n & ":農地." & i, "面積") = n集計面積
    
                    .Data(n & ":農地." & i, "一部") = 0
                    If RsT.IsNull("一部現況") Then
                    End If
                   
                    If Not RsT.IsNull("共有持分分母") And RsT.Value("共有持分分母") <> 0 Then
                        If n分子(n地目区分) = 0 And n分母(n地目区分) = 0 Then
                            n分子(n地目区分) = RsT.Value("共有持分分子")
                            n分母(n地目区分) = RsT.Value("共有持分分母")
                        Else
                            n分子(n地目区分) = n分子(n地目区分) * RsT.Value("共有持分分母")
                            n分子(n地目区分) = n分子(n地目区分) + RsT.Value("共有持分分子") * n分母(n地目区分)
                            n分母(n地目区分) = n分母(n地目区分) * RsT.Value("共有持分分母")
                        End If
                    Else
                        If n分子(n地目区分) = 0 And n分母(n地目区分) = 0 Then
                            n分子(n地目区分) = 1
                            n分母(n地目区分) = 1
                        Else
                            n分子(n地目区分) = n分子(n地目区分) + n分母(n地目区分)
                        End If
                    End If
    '                    p合計.n筆数(n地目区分) = p合計.n筆数(n地目区分) + 1
                    p合計.n面積(n地目区分) = p合計.n面積(n地目区分) + n集計面積
                    nFlag(n地目区分) = 1
                    
                    If Not RsT.IsNull("共有持分分母") And RsT.Value("共有持分分母") <> 0 Then
                        .Data(n & ":農地." & i, "持分") = RsT.Value("共有持分分子") & "/" & RsT.Value("共有持分分母")
                        .Data(n, "共有持分") = 1
                    End If
                    If n所有者 <> RsT.Value("管理人ID") Then
                        .SetRsData n & ":農地." & i, "所有者名", RsT
                        .SetRsData n & ":農地." & i, "所有者住所", RsT
                        n所有者 = RsT.Value("管理人ID")
                    End If
                    
                    RsT.MoveNext
                Loop
                SystemDB.CloseRs RsT
            End If
            For W = 0 To 2
                If nFlag(W) = 1 Then
                    p合計.n筆数(W) = n分子(W) \ n分母(W)
                    n分子(W) = n分子(W) Mod n分母(W)
                End If
            Next

            s支所 = Rs.NullCast("受付補助記号", "")
            Set Rs = Nothing
    
            nSubCount = .SubCount(n & ":農地")
            
            ' 文字数チェックチェック
            If HMax > nSubCount + 1 Then
                n行数 = HMax
            Else
                n行数 = nSubCount + 1
            End If
            n最大行数 = LenCheck(.Data(n, "用途"), n用途文字数, n行数)
            If n最大行数 > LMax Then
                n最大行数 = LMax
                St = Left(.Data(n, "用途"), n用途文字数 * LMax)
                .Data(n, "用途") = St
            End If
            
            n最大行数 = LenCheck(.Data(n, "備考"), n備考文字数, n最大行数)
            If n最大行数 > LMax Then
                n最大行数 = LMax
                St = Left(.Data(n, "備考"), n備考文字数 * LMax)
                .Data(n, "備考") = St
            End If
                        
            ' 合計行作成
            If b合計出力 Then
                p合計.n筆数(3) = p合計.n筆数(0) + p合計.n筆数(1) + p合計.n筆数(2)
                p合計.n面積(3) = p合計.n面積(0) + p合計.n面積(1) + p合計.n面積(2)
                nFlag(3) = nFlag(0) + nFlag(1) + nFlag(2)
                
                For W = 0 To 3
                    T総合計.n筆数(W) = T総合計.n筆数(W) + p合計.n筆数(W)
                    T総合計.n面積(W) = T総合計.n面積(W) + p合計.n面積(W)
                Next
        
                If nFlag(3) = 1 Then
                    nFlag(0) = 0: nFlag(1) = 0: nFlag(2) = 0: nFlag(3) = 0
                End If
                nFlag(3) = nFlag(3) + 1
        
                If nSubCount + nFlag(3) < n最大行数 Then
                    i = n最大行数 - nFlag(3)
                Else
                    i = nSubCount + 1
                End If
                nWork = 0
                For W = 0 To 3
                    If p合計.n面積(W) - Fix(p合計.n面積(W)) <> 0 Then
                        nWork = 1
                        Exit For
                    End If
                Next
                For W = 0 To 3
                    If nFlag(W) > 0 Then
                        i = i + 1
                        .Data(n & ":農地." & i, "土地所在") = T総合計.s地目(W)
                        St = Format(p合計.n筆数(W), "#")
                        If n分子(W) <> 0 And W < 3 Then
                            If p合計.n筆数(W) > 0 Then St = St & "・"
                            計算A n分子(W), n分母(W)
                            St = St & n分子(W) & "/" & n分母(W)
                        End If
                        .Data(n & ":農地." & i, "登記地目") = St
    '                        .Data(n & ":農地." & i, "登記地目") = p合計.n筆数(w)
                        .Data(n & ":農地." & i, "現況地目") = "99999"      'データ行との区分：合計行に"99999"セット
                        .Data(n & ":農地." & i, "面積") = p合計.n面積(W)
                        .Data(n & ":農地." & i, "小数点") = nWork
                    End If
                Next
            Else
                i = nSubCount + 1
                If i <= n最大行数 Then
                    W = i
                Else
                    W = i Mod n最大行数
                    If W = 0 Then W = n最大行数
                End If
                Do While W < n最大行数
                    i = i + 1
                    .Data(n & ":農地." & i, "土地所在") = ""
                    W = W + 1
                Loop
            End If
            
            ' ページ切替番号設定
            SetPageNo n, n最大行数
        End With
    End Sub

    Private Sub SetPageNo(nDataNo As Long, pHMax)
        Dim n As Long
        Dim i As Long
        Dim nSubCount As Long
        Dim nCount As Long
        Dim wCount As Long
        
        n = nDataNo
        nSubCount = mvarPData.SubCount(n & ":農地")

        nCount = DataCnt + nSubCount + 1      ' .SubCountは 0からみているため
        wCount = nSubCount + 1                ' 件数として扱うときは１プラス

        If nCount > LMax Then
            nCount = nSubCount + 1
            i = 0
            Do While nCount > 0
                i = i + 1
                PageCnt = PageCnt + 1
                PgChgSt(PageCnt) = n * 1000 + (i - 1) * LMax
                PgChgEn(PageCnt) = n * 1000 + i * LMax - 1
                nCount = nCount - LMax
            Loop
            DataCnt = 0
            wCount = nCount + LMax
            If wCount < pHMax Then
                wCount = pHMax
            End If
        ElseIf n = 1 Then
            PageCnt = PageCnt + 1
            PgChgSt(PageCnt) = n * 1000
        End If

        PgChgEn(PageCnt) = n * 1000 + nSubCount
        DataCnt = DataCnt + wCount
        PageMax = PageCnt
    End Sub

    Private Function LenCheck(pStr As String, pWLen As Long, pLenMax As Long) As Long
        Dim n As Long
        Dim nAscCode As Integer
        Dim nCount As Long
        Dim nLen As Long
        Dim nLen2 As Long
       
        LenCheck = pLenMax
        If pWLen = 0 Then Exit Function
        If Len(pStr) = 0 Then Exit Function
                   
        nCount = 0
         
        For n = 1 To Len(pStr)
            nCount = nCount + 1
            nAscCode = Asc(MID(pStr, n, 1))
            If Len(Hex(nAscCode)) > 2 Then
                nCount = nCount + 1
            End If
        Next
        nLen = (nCount \ pWLen) + IIf((nCount Mod pWLen) = 0, 0, 1)
        nLen2 = (nLen \ 2) + IIf((nLen Mod 2) = 0, 0, 1)
        If nLen2 > pLenMax Then LenCheck = nLen2
    End Function

    Private Sub 計算A(pDataA As Long, pDataB As Long)
        Dim n As Long
        
        n = 2
        Do While (n < pDataA And n < pDataB)
            If (pDataA Mod n = 0) And (pDataB Mod n = 0) Then
                pDataA = pDataA / n
                pDataB = pDataB / n
                Exit Do
            End If
            n = n + 1
        Loop
    End Sub

End Class










Class CPrintSub農用地計画変更
    Option Explicit
    Implements CPrintSub
    Private mvarKey As String
    Private mvarData As String
    Private mvarPData As CPrintDatas
    Private Const PGMAX As Long = 100   'ページ切替データＭＡＸ
    Private PgChgSt(PGMAX) As Long      'ページ切替開始番号
    Private PgChgEn(PGMAX) As Long      'ページ切替終了番号
    Private DataCnt As Long             'データカウント
    Private PageCnt As Long             'ページカウント
    Private HMax As Long                '基本データMAX
    Private LMax As Long                '１ページの行数
    Private PageMax As Long             'ページＭＡＸ
    Private PageNow As Long             '現在のページ
    Private StartX As Single            'データ始点(X)
    Private StartY As Single            'データ始点(Y)
    Private nFsize As Integer           'フォントサイズ
    Private RowH As Long                '１行の高さ
    Private ColW As Variant             '表枠の幅
    Private s支所 As String
    Private s都道府県名 As String
    Private s郡部 As String
    Private p支所番号 As New CDataDictionary
    Private Type dt合計
        s地目(4) As String
        n筆数(4) As Long
        n面積(4) As Double
    End Type
    Private T総合計 As dt合計
    Private mvarStartPage As Integer
    Private mvarTitle As String

    Private Property Let CPrintSub_Data(ByVal RHS As String): Dim Cm As Variant: mvarData = RHS: Cm = Split(mvarData, ";"): mvarStartPage = Val(Cm(2)) - (Val(Cm(2)) = 2) * (Val(Cm(3)) - 2): End Property
    Private Property Get CPrintSub_Data() As String: CPrintSub_Data = mvarData: End Property

    Private Property Let CPrintSub_Key(ByVal RHS As String): mvarKey = RHS: End Property
    Private Property Get CPrintSub_Key() As String: CPrintSub_Key = mvarKey: End Property

    Private Property Get CPrintSub_MaxPage() As Long: CPrintSub_MaxPage = PageMax: End Property
    Private Property Get CPrintSub_NowPage() As Long: CPrintSub_NowPage = PageNow: End Property
    Private Property Let CPrintSub_StartPage(RHS As Long): mvarStartPage = RHS: End Property
    Private Property Get CPrintSub_StartPage() As Long: CPrintSub_StartPage = mvarStartPage: End Property
    Private Sub CPrintSub_PrintSub(ByVal sKey As String, ByVal nPage As Long, mvarParent As ADBasicLIB2.CPrintFormSK)
        Dim Ar As Variant, Cm As Variant
        Dim n As Long, i As Long
        Dim dX(20) As Single, hX(20) As Single
        Dim Xcnt As Single
        
        mvarParent.ClearScreen
        If mvarPData.Count = 0 Then Exit Sub
        PageNow = nPage
        
        With mvarParent
            Ar = Split(mvarData, vbCrLf)
            Cm = Split(Ar(0), ";")
            
            dX(0) = StartX
            hX(0) = dX(0) + ColW(0) / 2
            For i = 0 To UBound(ColW)
                dX(i + 1) = dX(i) + ColW(i)
                If i < UBound(ColW) Then hX(i + 1) = dX(i + 1) + ColW(i + 1) / 2
            Next
            Xcnt = UBound(ColW) + 1
            
            Select Case Fnc.s市町村名
                Case "姶良市"
                    .DrawWidth = 2
            End Select

            Select Case Fnc.s市町村名
            Case "南種子町"
                .Offset 0, 0
                 .TextOut "農用地利用計画変更一覧表", dX(0) + 10, 20, 14, 0, 0
                 .TextOut "市町村名［" & Fnc.s市町村名 & "］", dX(0) + 10, 34, 14, 0, 0
                 .TextOut "件　別", hX(0), 47, nFsize, 2, 2
                 .TextOut "番　号", hX(0), 53, nFsize, 2, 2
                 .TextOut "変 更", hX(1), 47, nFsize, 2, 2
                 .TextOut "区 分", hX(1), 53, nFsize, 2, 2
                 .TextOut "変更しようとする区域の土地などの所在", (dX(2) + dX(6)) / 2, 45, nFsize, 2, 2
                 .TextOut "土 地 の 所 在", hX(2), 55, nFsize, 2, 2
                 .TextOut "現況", hX(3), 51, nFsize, 2, 0
                 .TextOut "地目", hX(3), 55, nFsize, 2, 0
                 .TextOut "筆数", hX(4), 55, nFsize, 2, 2
                 .TextOut "面　積", hX(5), 51, nFsize, 2, 0
                 .TextOut "(ａ)", hX(5), 55, nFsize, 2, 0
                 .TextOut "変 更 前", hX(6), 47, nFsize, 2, 2
                 .TextOut "用途区分", hX(6), 53, nFsize, 2, 2
                 .TextOut "変 更 後", hX(7), 47, nFsize, 2, 2
                 .TextOut "の 用 途", hX(7), 53, nFsize, 2, 2
                 .TextOut "申 請 者", hX(8), 50, nFsize, 2, 2
                 .TextOut "住　　　所", hX(9), 50, nFsize, 2, 2
                
                 .DLine dX(0), 40, dX(Xcnt), 40
                 .DLine dX(2), 50, dX(6), 50
                 .DLine dX(0), 60, dX(Xcnt), 60
                 For i = 0 To Xcnt
                     If i > 2 And i < 6 Then
                         .DLine dX(i), 50, dX(i), 60
                     Else
                         .DLine dX(i), 40, dX(i), 60
                     End If
                 Next

            Case Else
                .Offset 0, 0
                .TextOut "議案第" & StrConv(Cm(0), vbWide) & "号", dX(0) - 4, 20, 13, 0, 2
                .TextOut mvarTitle, dX(0), 25, 14
                .DrawText "番\n\n号", dX(0), 31, ColW(0), 4, nFsize, 2, 2, 18
                .DrawText "氏　　　名\n住　　　所", dX(1), 31, ColW(1), 4, nFsize, 2, 2, 18
                .TextOut "土 地 の 所　在", hX(2), 40, nFsize, 2, 2
                .TextOut "地　目", (dX(3) + dX(5)) / 2, 36, nFsize, 2, 2
                .TextOut "登記", hX(3), 44, nFsize, 2, 2
                .TextOut "現況", hX(4), 44, nFsize, 2, 2
                .TextOut "面積(u)", hX(5), 40, nFsize, 2, 2
                .TextOut "目　　　的", (dX(6) + dX(9)) / 2, 36, nFsize, 2, 2
                .TextOut "名　称", hX(6), 44, nFsize, 2, 2
                .TextOut "数量", hX(7), 44, nFsize, 2, 2
                .TextOut "面積(u)", hX(8), 44, nFsize, 2, 2
                .DrawText "区\n分", dX(9), 31, ColW(9), 4, nFsize, 2, 2, 18
                .TextOut "理　　　　由", hX(10), 40, nFsize, 2, 2
                .DrawText "承認\n区分", dX(11), 31, ColW(11), 4, nFsize, 2, 2, 18
                .DBox dX(0), 32, dX(Xcnt), 48
                .DLine dX(3), 40, dX(5), 40
                .DLine dX(6), 40, dX(9), 40
                For i = 0 To Xcnt
                    Select Case i
                        Case 4, 7, 8: .DLine dX(i), 40, dX(i), 48
                        Case Else:    .DLine dX(i), 32, dX(i), 48
                    End Select
                Next
            End Select
            PrintSubMain mvarParent, dX()
            If mvarStartPage > 0 Then .TextOut "- " & mvarStartPage - 1 + nPage & " - ", .PaperWidth / 2, .PaperHeight - 4
        End With
                    
    End Sub
        
    Private Sub PrintSubMain(ByRef mvarParent As ADBasicLIB2.CPrintFormSK, ByRef dX() As Single)
        Dim hY As Single        ' 基本データY座標
        Dim dY As Single        ' 土地データY座標
        Dim Rcnt As Long        ' 行カウント
        Dim nMainStart As Long  ' データ開始番号
        Dim nMainEnd As Long    ' データ終了番号
        Dim nSubStart As Long   ' 土地データ開始番号
        Dim nSubEnd As Long     ' 土地データ終了番号
        Dim n As Long
        Dim i As Long
        Dim nWork As Single
        Dim nPage As Long
        Dim Xcnt As Long
        
        nPage = PageNow

        Xcnt = UBound(ColW) + 1

        With mvarParent
            nMainStart = PgChgSt(nPage) \ 1000
            nMainEnd = PgChgEn(nPage) \ 1000
       
            dY = StartY + 1
            hY = StartY + 1

            For n = nMainStart To nMainEnd
                ' 土地データ開始番号設定
                If n = nMainStart Then
                    nSubStart = PgChgSt(nPage) - nMainStart * 1000
                Else
                    nSubStart = 0
                End If
                
                '土地データ終了番号設定
                If n = nMainEnd Then
                    nSubEnd = PgChgEn(nPage) - nMainEnd * 1000
                Else
                    nSubEnd = mvarPData.SubCount(n & ":農地")
                End If
                
                ' 罫線
                Rcnt = nSubEnd - nSubStart + 1
                If Rcnt < HMax Then
                    nWork = hY + 1 + HMax * RowH
                Else
                    nWork = dY + Rcnt * RowH
                End If
                For i = 0 To Xcnt
                    .DLine dX(i), dY - 1, dX(i), nWork, vbBlack
                Next
                
    '                '背景色設定
    '                If Fnc.s市町村名 = "日置市" Then
    '                    For i = 0 To Xcnt
    '                        Select Case i
    '                        Case 0, 4, 7, 13, 14
    '                            .DBox dX(i), dY - 1, dX(i + 1), nWork, RGB(230, 230, 230), , True
    '                        End Select
    '                        .DLine dX(i), hY - 1, dX(i), nWork, vbBlack
    '                    Next
    '                    .DLine dX(0), dY - 1, dX(Xcnt), dY - 1, vbBlack
    '                End If

                ' データ出力
                For i = nSubStart To nSubEnd
                    PrintSubData mvarParent, n, i, dX, dY, nSubStart, nSubEnd
                    dY = dY + RowH
                Next
                
                Rcnt = nSubEnd - nSubStart + 1
                If Rcnt < HMax Then   ' 土地データ行数が基本データ行数より少ないとき
                    dY = hY + 1 + HMax * RowH
                End If
                .DLine dX(0), dY, dX(Xcnt), dY, vbBlack
                dY = dY + 1
                hY = dY
            Next
    '            If nPage = PageMax Then PrintSubTotal mvarParent, dX, dY
        End With
    End Sub
                    
    Private Sub PrintSubData(ByRef mvarParent As ADBasicLIB2.CPrintFormSK, pNo As Long, pSubNo As Long, ByRef dX() As Single, dY As Single, pSubStart As Long, pSubEnd As Long)
        Dim St As String
        Dim i As Long
        Dim n As Long

        With mvarParent
            Select Case Fnc.s市町村名
            Case "南種子町"
                If pSubNo = pSubStart Then
                    .DrawText pNo, dX(0), dY, ColW(0), RowH, nFsize, 2
                    .DrawText mvarPData.Data(pNo, "変更区分"), dX(1), dY, ColW(1), RowH, nFsize, 2
                    
                    .DrawText FormatNumber(mvarPData.Data(pNo, "筆数計"), 0), dX(4), dY, ColW(4) - 1, RowH, nFsize, 1
                    .DrawText FormatNumber(mvarPData.Data(pNo, "面積計") / 100, 2), dX(5), dY, ColW(5) - 1, RowH, nFsize, 1
                    .DrawText mvarPData.Data(pNo, "変更前用途"), dX(6) + 1, dY, ColW(6) - 1, RowH, nFsize
                    .DrawText mvarPData.Data(pNo, "変更後用途"), dX(7) + 1, dY, ColW(7) - 1, RowH, nFsize
                    .DrawText mvarPData.Data(pNo, "氏名"), dX(8) + 1, dY, ColW(8) - 1, RowH, nFsize
                    .DrawText mvarPData.Data(pNo, "住所"), dX(9) + 1, dY, ColW(9) - 1, RowH, nFsize
                End If
                .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(2) + 1, dY, ColW(2) - 1, RowH, nFsize
                .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), dX(3), dY, ColW(3), RowH, nFsize, 2
            
            Case Else
                If pSubNo = pSubStart Then
                    .DrawText pNo, dX(0), dY + RowH, ColW(0), RowH, nFsize, 2, 0
                    .DrawText mvarPData.Data(pNo, "受付補助記号"), dX(0), dY + RowH * 3, ColW(0), RowH, nFsize, 2
                    .DrawText mvarPData.Data(pNo, "氏名"), dX(1) + 1, dY, ColW(1) - 1, RowH, nFsize
                    .DrawText Fnc.GetShortAddress(mvarPData.Data(pNo, "住所"), s都道府県名, s郡部, , , True), dX(1) + 1, dY + RowH * 2, ColW(1) - 1, RowH, nFsize
                    .DrawText mvarPData.Data(pNo, "変更後用途"), dX(6) + 1, dY, ColW(6) - 1, RowH, nFsize
                    .DrawText Format(mvarPData.Data(pNo, "数量"), "#,###"), dX(7), dY, ColW(7) - 1, RowH, nFsize, 1
                    .DrawText Format(mvarPData.Data(pNo, "建築面積"), "#,###"), dX(8), dY, ColW(8) - 1, RowH, nFsize, 1
                    .DrawText mvarPData.Data(pNo, "変更区分"), dX(9) + 1, dY, dX(10) - dX(9) - 2, RowH, nFsize, 2, 2, RowH * 6
                    .DrawText mvarPData.Data(pNo, "理由"), dX(10) + 1, dY, ColW(10) - 1, RowH, nFsize
                End If
                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(2) + 2, dY, ColW(2) - 2, RowH, nFsize
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(2), dY, ColW(2) - 2, RowH, nFsize, 1
                    .DrawText Format(mvarPData.Data(pNo & ":農地." & pSubNo, "面積"), "#,##0"), dX(5), dY, ColW(5) - 1, RowH, nFsize, 1
                ElseIf Val(mvarPData.Data(pNo & ":農地." & pSubNo, "一部")) = 1 Then
                    .TextOut "(" & FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0) & "の内)", dX(6) - 1, dY, nFsize - 2, 1
                Else
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(2) + 1, dY, ColW(2) - 1, RowH, nFsize
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), dX(3), dY, ColW(3), RowH, nFsize, 2
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), dX(4), dY, ColW(4), RowH, nFsize, 2
                    .DrawText Format(mvarPData.Data(pNo & ":農地." & pSubNo, "面積"), "#,##0"), dX(5), dY, ColW(5) - 1, RowH, nFsize, 1
                End If
            End Select
        End With
    End Sub

    Private Sub CPrintSub_SetData(ByVal sKey As String, Optional ByVal sParam1 As String = "", Optional ByVal sParam2 As String = "")

    End Sub
    
    Private Sub Class_Initialize()
        Dim n As Long
        Dim Rs As ADBasicLIB2.RecordsetEx
        
        Set mvarPData = New CPrintDatas
        mvarPData.Headers = _
        "法令;受付番号;受付補助記号;" & _
        "氏名;住所;変更区分;変更前用途;変更後用途;数量;建築面積;理由;筆数計;面積計;" & _
        ">農地;土地所在;登記地目;現況地目;面積;等級;一部;"
        
        For n = 0 To PGMAX
            PgChgSt(n) = 0
            PgChgEn(n) = 0
        Next
        DataCnt = 0
        PageCnt = 0
        PageMax = 0
        PageNow = 1
        s支所 = ""
        
        For n = 0 To 4
            T総合計.s地目(n) = ""
            T総合計.n筆数(n) = 0
            T総合計.n面積(n) = 0
        Next
       
        Set Rs = SystemDB.GetRecordsetEx("SELECT ID,名称 FROM [M_BASICALL] WHERE [Class]='支所番号'", 0, , Me)
        Do Until Rs.EOF
            p支所番号.Add Rs.Value("ID"), Rs.Value("名称")
            Rs.MoveNext
        Loop
        SystemDB.CloseRs Rs
    End Sub

    Private Sub CPrintSub_SetRsData(pRs As Object)
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim RsT As ADBasicLIB2.RecordsetEx
        Dim n As Long, i As Long
        Dim W As Long
        Dim St As String
        Dim nFlag(4) As Long
        Dim n面積 As Double
        Dim n部分面積 As Double
        Dim n集計面積 As Double
        Dim n地目区分 As Long
        Dim b合計出力 As Boolean
        Dim p合計 As dt合計
        Dim n理由文字数 As Long
        Dim n行数 As Long
        Dim n最大行数 As Long
        Dim nSubCount As Long
        Dim b支所 As Boolean
        Dim b支所改頁 As Boolean
        Dim Ar As Variant, Cm As Variant
        Dim sSQL As String
        
        Ar = Split(mvarData, vbCrLf)
        Cm = Split(Ar(1), ";")
        s都道府県名 = Cm(0)
        s郡部 = Cm(1)
        If Cm(2) = "" Then b支所改頁 = False Else b支所改頁 = CBool(Cm(2))
        If Cm(3) = "" Then b支所 = False Else b支所 = CBool(Cm(3))
        
        mvarTitle = SystemDB.DBProperty("議案書農振計画変更タイトル")
        n理由文字数 = 0
        T総合計.s地目(0) = "( 田 )"
        T総合計.s地目(1) = "( 畑 )"
        T総合計.s地目(2) = "( 樹 )"
        T総合計.s地目(3) = "( 他 )"
        T総合計.s地目(4) = "( 計 )"
        b合計出力 = False
        Set Rs = pRs
        Select Case Fnc.s市町村名
            Case "南種子町"
                HMax = 4        '基本データMAX
                LMax = 28       '１ページの行数
                StartX = 20
                StartY = 60
                nFsize = 11
                RowH = 5
                ColW = GetArray(18, 18, 50, 16, 14, 22, 22, 22, 26, 40)

            Case Else
                LMax = 34
                nFsize = 10
                RowH = 4
                HMax = 6
                StartX = 10
                StartY = 48
                ColW = GetArray(8, 42, 54, 12, 12, 20, 26, 10, 20, 8, 50, 10)
                n理由文字数 = 13
                b合計出力 = True
        End Select
        
        With mvarPData
            n = .NewLine
            .SetRsData n, "法令", Rs
            .SetRsData n, "受付番号", Rs
            If b支所 Then
                If p支所番号.Exists(Rs.Value("支所番号")) Then
                    .Data(n, "受付補助記号") = p支所番号.Item(Rs.Value("支所番号"))
                Else
                    .Data(n, "受付補助記号") = ""
                End If
            Else
                .Data(n, "受付補助記号") = Rs.NullCast("受付補助記号", "")
            End If
            
            .Data(n, "氏名") = IIf(Rs.IsNull("氏名A") Or Rs.Value("氏名A") = "", Rs.Value("参照A"), Rs.Value("氏名A"))
            .SetRsData n, "住所", Rs, "住所A"
            .SetRsData n, "変更前用途", Rs, "申請理由B"
            .SetRsData n, "変更後用途", Rs, "用途"
            .SetRsData n, "理由", Rs, "申請理由A"
            .SetRsData n, "数量", Rs
            .SetRsData n, "建築面積", Rs
                       
            Select Case Rs.Value("区分")
                Case 1: St = "除外"
                Case 2: St = IIf(Fnc.s市町村名 = "南種子町", "用途変更", "用途区分変更")
                Case 3: St = "編入"
                Case Else: St = ""
            End Select
            .Data(n, "変更区分") = St
            
            For W = 0 To 4
                p合計.n筆数(W) = 0: p合計.n面積(W) = 0
            Next
            
            If Rs.IsNull("農地リスト") Then
            ElseIf Len(Rs.Value("農地リスト")) > 3 Then
                St = Replace(Replace(Rs.Value("農地リスト"), "農地.", ""), ";", ",")
                sSQL = "SELECT [V_農地].*,[V_農地].[現況地目] AS [現況地目ID],[V_地目].名称 AS 登記地目,[地目2].名称  AS [現況],[V_農委地目].名称 AS [農委地目], [D_部分申請].部分面積 AS [部分面積T] "
                sSQL = sSQL & "FROM ((([V_農地] LEFT JOIN [V_地目] ON [V_農地].[登記簿地目]=[V_地目].ID) LEFT JOIN V_現況地目 AS 地目2 ON [V_農地].[現況地目]=[地目2].ID) LEFT JOIN [V_農委地目] ON [V_農地].[農委地目ID]=[V_農委地目].ID ) LEFT JOIN [D_部分申請] ON [V_農地].ID = [D_部分申請].農地ID "
                sSQL = sSQL & "WHERE [V_農地].[ID] IN (" & St & ")"
                sSQL = sSQL & "ORDER BY [V_農地].[管理人ID],[V_農地].[土地所在];"
                Set RsT = SystemDB.GetRecordsetEx(sSQL, 1, , "議案書")
                i = 0
                Do Until RsT.EOF
                    i = i + 1
                    .SetRsData n & ":農地." & i, "土地所在", RsT
                    .SetRsData n & ":農地." & i, "登記地目", RsT
                    If (Not RsT.IsNull("農委地目ID")) And (RsT.Value("農委地目ID") <> 0) And (Not RsT.IsNull("農委地目認定日")) And (RsT.Value("農委地目認定日") <> "0:00:00") Then
                        .SetRsData n & ":農地." & i, "現況地目", RsT, "農委地目"
                    Else
                        .SetRsData n & ":農地." & i, "現況地目", RsT, "現況"
                    End If
                    .SetRsData n & ":農地." & i, "等級", RsT
                    
                    n部分面積 = 0
                    If Not RsT.IsNull("部分面積T") Then n部分面積 = RsT.Value("部分面積T")
                    
                    n面積 = 0
                    If RsT.Value("田面積") <> 0 Then
                        n面積 = RsT.Value("田面積")
                        n地目区分 = 0
                    ElseIf RsT.Value("畑面積") <> 0 Then
                        n面積 = RsT.Value("畑面積")
                        n地目区分 = 1
                    ElseIf RsT.Value("樹園地") <> 0 Then
                        n面積 = RsT.Value("樹園地")
                        n地目区分 = 2
                    Else
                        If RsT.Value("採草放牧面積") <> 0 Then n面積 = RsT.Value("採草放牧面積")
                        n地目区分 = 3
                    End If
                    If n面積 = 0 Then n面積 = Fnc.NullCast(RsT.Value("実面積"), 0)
                    
                    If n部分面積 = 0 Then
                        n集計面積 = n面積
                    Else
                        n集計面積 = n部分面積
                    End If
                    n集計面積 = Fix(n集計面積)
                    .Data(n & ":農地." & i, "面積") = n集計面積
                    
                    .Data(n & ":農地." & i, "一部") = 0
                    If RsT.IsNull("一部現況") Then
                    ElseIf Val(RsT.Value("一部現況")) > 0 And Fnc.s市町村名 = "姶良市" Then
                        i = i + 1
                        .Data(n & ":農地." & i, "一部") = 1
                        .Data(n & ":農地." & i, "面積") = Fix(Fnc.NullCast(RsT.Value("登記簿面積"), 0))
                    End If
                    
                    p合計.n筆数(n地目区分) = p合計.n筆数(n地目区分) + 1
                    p合計.n面積(n地目区分) = p合計.n面積(n地目区分) + n集計面積
                    RsT.MoveNext
                Loop
            End If
            SystemDB.CloseRs RsT
            s支所 = Rs.NullCast("受付補助記号", "")
            
            p合計.n筆数(4) = p合計.n筆数(0) + p合計.n筆数(1) + p合計.n筆数(2) + p合計.n筆数(3)
            p合計.n面積(4) = p合計.n面積(0) + p合計.n面積(1) + p合計.n面積(2) + p合計.n面積(3)
            .Data(n, "筆数計") = p合計.n筆数(4)
            .Data(n, "面積計") = p合計.n面積(4)
            
            ' 総合計
            For W = 0 To 4
                T総合計.n筆数(W) = T総合計.n筆数(W) + p合計.n筆数(W)
                T総合計.n面積(W) = T総合計.n面積(W) + p合計.n面積(W)
            Next
            
            nSubCount = .SubCount(n & ":農地")
            ' 文字数チェックチェック
            If HMax > nSubCount + 1 Then
                n行数 = HMax
            Else
                n行数 = nSubCount + 1
            End If
            n最大行数 = LenCheck(.Data(n, "理由"), n理由文字数, n行数)
            If n最大行数 > LMax Then
                n最大行数 = LMax
                St = Left(.Data(n, "理由"), n理由文字数 * LMax)
                .Data(n, "理由") = St
            End If
            
            If b合計出力 Then
                For i = 0 To 3
                    If p合計.n筆数(i) > 0 Then nFlag(i) = 1
                Next
                nFlag(4) = nFlag(0) + nFlag(1) + nFlag(2) + nFlag(3)
                      
                nSubCount = .SubCount(n & ":農地")
                If nFlag(4) = 1 Then
                    For i = 0 To 4: nFlag(i) = 0: Next
                End If
                nFlag(4) = nFlag(4) + 1
                
                If nSubCount + nFlag(4) < n最大行数 Then
                   i = n最大行数 - nFlag(4)
                Else
                    i = nSubCount + 1
                End If
                For W = 0 To 4
                    If nFlag(W) > 0 Then
                        i = i + 1
                        .Data(n & ":農地." & i, "土地所在") = T総合計.s地目(W)
                        .Data(n & ":農地." & i, "登記地目") = p合計.n筆数(W)
                        .Data(n & ":農地." & i, "現況地目") = "99999"      'データ行との区分：合計行に"99999"セット
                        .Data(n & ":農地." & i, "面積") = p合計.n面積(W)
                    End If
                Next
            Else
                i = nSubCount + 1
                If i <= n最大行数 Then
                    W = i
                Else
                    W = i Mod n最大行数
                    If W = 0 Then W = n最大行数
                End If
                Do While W < n最大行数
                    i = i + 1
                    .Data(n & ":農地." & i, "土地所在") = ""
                    W = W + 1
                Loop
            End If

            ' ページ切替番号設定
            SetPageNo n, n最大行数
        End With
        Set Rs = Nothing
    End Sub
    
    Private Sub SetPageNo(nDataNo As Long, pHMax)
        Dim n As Long
        Dim i As Long
        Dim nSubCount As Long
        Dim nCount As Long
        Dim wCount As Long
        
        n = nDataNo
        nSubCount = mvarPData.SubCount(n & ":農地")

        nCount = DataCnt + nSubCount + 1      ' .SubCountは 0からみているため
        wCount = nSubCount + 1                '             件数として扱うときは１プラス

        If nCount > LMax Then
            nCount = nSubCount + 1
            i = 0
            Do While nCount > 0
                i = i + 1
                PageCnt = PageCnt + 1
                PgChgSt(PageCnt) = n * 1000 + (i - 1) * LMax
                PgChgEn(PageCnt) = n * 1000 + i * LMax - 1
                nCount = nCount - LMax
            Loop
            DataCnt = 0
            wCount = nCount + LMax
            If wCount < pHMax Then
                wCount = pHMax
            End If
        ElseIf n = 1 Then
            PageCnt = PageCnt + 1
            PgChgSt(PageCnt) = n * 1000
        End If

        PgChgEn(PageCnt) = n * 1000 + nSubCount
        DataCnt = DataCnt + wCount
        PageMax = PageCnt
    End Sub

    Private Function LenCheck(pStr As String, pWLen As Long, pLenMax As Long) As Long
        Dim n As Long
        Dim nAscCode As Integer
        Dim nCount As Long
        Dim nLen As Long
        Dim nLen2 As Long
       
        LenCheck = pLenMax
        If pWLen = 0 Then Exit Function
        If Len(pStr) = 0 Then Exit Function
                   
        nCount = 0
         
        For n = 1 To Len(pStr)
            nCount = nCount + 1
            nAscCode = Asc(MID(pStr, n, 1))
            If Len(Hex(nAscCode)) > 2 Then
                nCount = nCount + 1
            End If
        Next
        nLen = (nCount \ pWLen) + IIf((nCount Mod pWLen) = 0, 0, 1)
        nLen2 = (nLen \ 2) + IIf((nLen Mod 2) = 0, 0, 1)
        If nLen2 > pLenMax Then LenCheck = nLen2
    End Function

End Class










Class CPrintSub買受適格
    Option Explicit
    Implements CPrintSub
    Private mvarKey As String
    Private mData As String
    Private mvarData As String
    Private mvarPData As CPrintDatas
    Private mvarParent As ADBasicLIB2.CPrintFormSK
    Private mvarStartPage As Integer
    
    Private sData As Variant
    Private Ay As Variant, Ayy As Variant
    Private Ar As Variant, Cm As Variant, Cv As Variant, Cw As Variant, Cww As Variant, Cx As Variant, Cy As Variant, Cyy As Variant, Cz As Variant
    Private dX(9) As Single, hX(9) As Single, dXX(8) As Single, hXX(8) As Single
    Private St As Variant, Stt As Variant
    Private nPit As Single, HH As Single, Rows As Long
    Private nPit2 As Single, HH2 As Single, Rows2 As Long
    Private SX As Single
    Private SY(7) As Single
    Private x As Long, y As Long, z As Long
    Private MaxPage As Long
    Private mPage(3) As Long
    Private nPage As Long
    
    Private PageMax As Long             'ページＭＡＸ
    Private PageNow As Long             '現在のページ
    Private nFsize As Integer           'フォントサイズ
    Private s支所 As String
    Private mvarTitle As String
    
    Private pData(3) As Variant
    Private GNo As Variant
    Private NN As Long
    
    Private Property Get CPrintCls_CanCancelPrint() As Boolean

    End Property
    Private Property Get CPrintCls_CanPrintNowPage() As Boolean:: End Property
    Private Property Let CPrintCls_Key(ByVal RHS As String): mvarKey = RHS: End Property
    Private Property Get CPrintCls_Key() As String: CPrintCls_Key = mvarKey: End Property

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean
    End Function
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants: CPrintCls_Orientation = vbPRORLandscape: End Property
    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&): CPrintCls_Repaint: End Sub
    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property
    Private Property Set CPrintCls_Parent(RHS As ADBasicLIB2.CPrintFormSK): Set mvarParent = RHS: End Property
    Private Property Let CPrintSub_StartPage(RHS As Long): mvarStartPage = RHS: End Property
    Private Property Get CPrintSub_StartPage() As Long: CPrintSub_StartPage = mvarStartPage: End Property
    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        Dim pNode As Object
        Dim nData As Long
        Dim n As Long
        
        mvarParent.KillDoc
        
        mvarParent.ChangeLayout vbPRPSA4, vbPRORLandscape
        For n = 0 To mvarParent.MaxPage
            PrintSub mvarKey, n
        Next
        mvarParent.EndDoc

    End Sub
    Private Sub CPrintCls_Repaint(): PrintSub mvarKey, mvarParent.Page: End Sub
    Private Sub PrintSub(Key As String, nPage As Long)
    End Sub
    
    Private Sub CPrintCls_TargetChange(sKey As String): End Sub

    Private Sub Class_Initialize()
        nFsize = 11
        NN = 0
    End Sub
    Private Sub Class_Terminate(): Set mvarPData = Nothing: End Sub

    Private Property Let CPrintSub_Data(ByVal RHS As String): Dim Cm As Variant: mvarData = RHS: Cm = Split(mvarData, ";"): mvarStartPage = Val(Cm(2)) - (Val(Cm(2)) = 2) * (Val(Cm(3)) - 2): End Property
    Private Property Get CPrintSub_Data() As String: CPrintSub_Data = mvarData: End Property

    Private Property Let CPrintSub_Key(ByVal RHS As String): mvarKey = RHS: End Property

    Private Property Get CPrintSub_Key() As String
        CPrintSub_Key = mvarKey
    End Property
    Private Property Get CPrintSub_MaxPage() As Long:
        
        CPrintSub_MaxPage = PageMax
    End Property

    Private Property Get CPrintSub_NowPage() As Long: CPrintSub_NowPage = PageNow: End Property

    Private Sub CPrintSub_PrintSub(ByVal sKey As String, ByVal nPage As Long, ByRef mvarParent As ADBasicLIB2.CPrintFormSK)
        Dim n As Long
        Dim i As Long
        
        '801:耕公,802:耕競,803:転公,804:転競
        mvarParent.ClearScreen
        
        'If Len(sData) = 0 Then Exit Sub
        Select Case sKey
        Case "n801":
            Ay = GetArray(10, 70, 28, 18, 86, 26, 20, 12)
            Ayy = GetArray(22, 70, 50, 128)
            St = Split("番号,氏　　　　名,住　　　　所,経営面積\n（u）,農　業\n従事者\n（人）,公　売　財　産　の　表　示,土　地　の　所　在,地　目,面積(u),物\n件\n番\n号,", ",")
            Stt = Split("公売の内容,入札期間・期日,売却決定期日,備　　　考,", ",")
            sData = pData(0): MaxPage = mPage(0)
        Case "n802":
            Ay = GetArray(10, 70, 28, 18, 86, 26, 20, 12)
            Ayy = GetArray(22, 64, 44, 70, 70)
            St = Split("番号,氏　　　　名,住　　　　所,経営面積\n（u）,農　業\n従事者\n（人）,特　別　売　却　物　件,土　地　の　所　在,地　目,面積(u),物\n件\n番\n号,", ",")
            Stt = Split("競売の内容,入札期間・期日,売却決定期日,所轄裁判所名,競売事件名,", ",")
            sData = pData(1): MaxPage = mPage(1)
        Case "n803":
            Ay = GetArray(10, 60, 20, 80, 20, 20, 30, 30)
            Ayy = GetArray(22, 34, 44, 50, 50, 40, 30)
            St = Split("番号,氏　　　　名,住　　　　所,職　業,土　地　の　所　在,地　目,面積(u),転用目的,備　　考,", ",")
            Stt = Split("公売の内容,公売原因,売却実施期間,売却の場所,売却決定の日,所轄国税局,売却区分番号", ",")
            sData = pData(2): MaxPage = mPage(2)
        Case "n804":
            Ay = GetArray(10, 60, 20, 80, 20, 20, 30, 30)
            Ayy = GetArray(22, 38, 62, 42, 58, 48)
            St = Split("番号,氏　　　　名,住　　　　所,職　業,土　地　の　所　在,地　目,面積(u),転用目的,備　　考,", ",")
            Stt = Split("競売の内容,競売原因,入札期間・開札期間,売却決定期日,所轄裁判所名,競売事件名", ",")
            sData = pData(3): MaxPage = mPage(3)
        End Select

        If sData = Empty Then Exit Sub
        If Len(sData) <> 0 Then
            Ar = Split(sData, "!$!")
            Cm = Split(Ar(nPage - 1), vbBack)
            Cz = Split(Cm(3), ",")
            
            HH = 16: Rows = 1: nPit = 100
            HH2 = 10: Rows2 = 1: nPit2 = 30
    
            dX(0) = SX: hX(0) = dX(0) + Ay(0) / 2
            dXX(0) = SX: hXX(0) = dXX(0) + Ayy(0) / 2
            
            '表上
            For n = 0 To UBound(Ay)
                dX(n + 1) = dX(n) + Ay(n): If n < UBound(Ay) Then hX(n + 1) = dX(n + 1) + Ay(n + 1) / 2
            Next
            
            '表下
            For n = 0 To UBound(Ayy)
                dXX(n + 1) = dXX(n) + Ayy(n): If n < UBound(Ayy) Then hXX(n + 1) = dXX(n + 1) + Ayy(n + 1) / 2
            Next
    
            SY(0) = 30
            SY(1) = SY(0) + HH / 2
            SY(2) = SY(0) + HH / 4
            SY(3) = SY(0) + (HH / 4 * 3)
            SY(4) = SY(0) + HH + Rows * nPit
            SY(5) = SY(4) + 10 + HH2 / 2
            SY(6) = SY(0) + HH
            
            '表A→耕作目的  表B→転用目的
            GNo = Split(mvarKey, ";")
            Select Case sKey
                Case "n801", "n802": PrintSub_表A sKey, nPage, mvarParent
                Case "n803", "n804": PrintSub_表B sKey, nPage, mvarParent
            End Select
        End If
    End Sub
    Private Sub PrintSub_表A(sKey As String, nPage As Long, ByRef mvarParent As ADBasicLIB2.CPrintFormSK)
        Dim nL As Variant
        Dim XX As Single
        
        nL = GetArray(10, 70, 28, 18, 132, 12)
        
        With mvarParent
            Select Case Fnc.s市町村名
                Case "姶良市"
                    .DrawWidth = 2
            End Select
        
        
            .Offset 0, 0
            
            .TextOut "議案第" & StrConv(GNo(0), vbWide) & "号", dX(0), 13, 13, 0, 2
            .TextOut mvarTitle, dX(1), SY(0) - 10, 11
    '表上---------------
            .LineBoxDX dX(0), SY(0), HH, Rows, nPit, nL
            .DLine dX(4), SY(1), dX(7), SY(1)
            .DLine dX(5), SY(1), dX(5), SY(4)
            .DLine dX(6), SY(1), dX(6), SY(4)
            
            .TextOut St(0), hX(0), SY(1), 11, 2, 2
            .TextOut St(1), hX(1), SY(2), 11, 2, 2
            .TextOut St(2), hX(1), SY(3), 11, 2, 2
            .DrawText St(3), dX(2), SY(0), Ay(2), 4, 11, 2, 2, HH
            .DrawText St(4), dX(3), 30, Ay(3), 4, 11, 2, 2, HH
            .TextOut St(5), (dX(4) + dX(7)) / 2, SY(2), 11, 2, 2
            .TextOut St(6), hX(4), SY(3), 11, 2, 2
            .TextOut St(7), hX(5), SY(3), 11, 2, 2
            .TextOut St(8), hX(6), SY(3), 11, 2, 2
            .DrawText St(9), dX(7), SY(0), Ay(7), 4, 11, 2, 2, HH
            
            Cv = Split(Cm(0), ",")
            Cw = Split(Cm(1), vbTab)
            
            For x = 0 To UBound(Cw)
                Cx = Split(Cw(x), ",")
                .DLine dX(0), SY(0) + HH + x * 20, dX(4), SY(0) + HH + x * 20
                
                .DrawText Cx(1), dX(1) + 1, SY(0) + HH + 1 + x * 20, nL(1) - 1, 4, nFsize, , , 10
                .DrawText Cx(2), dX(1) + 1, SY(0) + HH + 11 + x * 20, nL(1) - 1, 4, nFsize, , , 10
                
                .TextOut Cm(4), hX(0), SY(0) + HH + 7 + x * 20, nFsize, 2
                .TextOut "田", dX(2) + 2, SY(0) + HH + 1 + x * 20, nFsize
                .TextOut "畑", dX(2) + 2, SY(0) + HH + 7 + x * 20, nFsize
                .TextOut "計", dX(2) + 2, SY(0) + HH + 13 + x * 20, nFsize
                If Cx(5) < 10 And Cx(5) <> 0 Then Cx(5) = FormatNumber(Cx(5), 2) Else If Len(Cx(5)) = 0 Then Cx(5) = 0 Else Cx(5) = FormatNumber(Cx(5), 0)
                .TextOut Cx(5), dX(3) - 2, SY(0) + HH + 1 + x * 20, nFsize, 1
                If Cx(6) < 10 And Cx(6) <> 0 Then Cx(6) = FormatNumber(Cx(6), 2) Else If Len(Cx(6)) = 0 Then Cx(6) = 0 Else Cx(6) = FormatNumber(Cx(6), 0)
                .TextOut Cx(6), dX(3) - 2, SY(0) + HH + 7 + x * 20, nFsize, 1
                If Cx(7) < 10 And Cx(7) <> 0 Then Cx(7) = FormatNumber(Cx(7), 2) Else If Len(Cx(7)) = 0 Then Cx(7) = 0 Else Cx(7) = FormatNumber(Cx(7), 0)
                .TextOut Cx(7), dX(3) - 2, SY(0) + HH + 13 + x * 20, nFsize, 1
                .TextOut Cx(4), hX(3), SY(0) + HH + 7 + x * 20, nFsize, 2
            Next
            
            Cy = Split(Left(Cm(2), Len(Cm(2)) - 1), vbTab)
            For x = 0 To UBound(Cy)
                Cyy = Split(Cy(x), ",")
                .TextOut Cyy(0), dX(4) + 1, SY(0) + HH + 1 + x * 5, nFsize
                .TextOut Cyy(1), hX(5) + 1, SY(0) + HH + 1 + x * 5, nFsize, 2
                If Val(Cyy(2)) < 10 And Val(Cyy(2)) <> 0 Then Cyy(2) = FormatNumber(Val(Cyy(2)), 2) Else Cyy(2) = FormatNumber(Val(Cyy(2)), 0)
                .TextOut Cyy(2), dX(7) - 1, SY(0) + HH + 1 + x * 5, nFsize, 1
    '                If UBound(Cy) > 0 Then
    '                    .TextOut Cv(8) & "-" & x + 1, hX(7), SY(0) + HH + 1 + x * 5, nFsize, 2
    '                Else
    '                    .TextOut Cv(8), hX(7), SY(0) + HH + 1 + x * 5, nFsize, 2
    '                End If
            Next
    '表下---------------
            .DBox dX(0), SY(4) + 10, dXX(1), SY(4) + 10 + HH2 + Rows2 * nPit2
            If sKey = "n801" Then
                .LineBoxDX dXX(0) + Ayy(0), SY(4) + 10, HH2, Rows2, nPit2, GetArray(70, 50, 128)
            Else
                .LineBoxDX dXX(0) + Ayy(0), SY(4) + 10, HH2, Rows2, nPit2, GetArray(64, 44, 70, 70)
            End If
            .TextOut Stt(0), hXX(0), SY(4) + 10 + (HH2 + Rows2 * nPit2) / 2, 11, 2, 2
            .TextOut Stt(1), hXX(1), SY(5), 11, 2, 2
            .TextOut Stt(2), hXX(2), SY(5), 11, 2, 2
            .TextOut Stt(3), hXX(3), SY(5), 11, 2, 2
            If sKey = "n802" Then .TextOut Stt(4), hXX(4), SY(5), 11, 2, 2

            If Cv(2) <> #12:00:00 AM# Then
                If sKey = "n801" Then
                    .TextOut Format(Cv(2), "GGG EE年 " & Right$("  " & Month(Cv(2)), 2) & "月  " & Right$("  " & Day(Cv(2)), 2) & "日"), dXX(1) + 2 + 20, SY(4) + 10 + HH2 + (nPit2 / 2), nFsize, , 2
                Else
                    .TextOut Format(Cv(2), "GGG EE年 " & Right$("  " & Month(Cv(2)), 2) & "月  " & Right$("  " & Day(Cv(2)), 2) & "日"), dXX(1) + 2 + 20, SY(4) + 15 + HH2, nFsize, , 2
                End If
            Else
                If sKey = "n801" Then
                    .TextOut "開札期日  平成   年   月   日", dXX(1) + 2, SY(4) + 10 + HH2 + (nPit2 / 2), nFsize, , 2
                Else
                    .TextOut "入札期間  平成   年   月   日", dXX(1) + 2, SY(4) + 15 + HH2, nFsize, , 2
                End If
            End If
            
            If sKey = "n801" Then
                .TextOut "入札期間", dXX(1) + 2, SY(4) + 10 + HH2 + (nPit2 / 2), nFsize, , 2
            Else
                .TextOut "入札期間", dXX(1) + 2, SY(4) + 15 + HH2, nFsize, , 2
                If Cv(3) <> #12:00:00 AM# Then
                    .TextOut Format(Cv(3), "GGG EE年 " & Right$("  " & Month(Cv(3)), 2) & "月  " & Right$("  " & Day(Cv(3)), 2) & "日"), dXX(1) + 22, SY(4) + 10 + HH2 + (nPit2 / 2), nFsize, , 2
                Else
                    .TextOut "平成   年   月   日", dXX(1) + 22, SY(4) + 10 + HH2 + (nPit2 / 2), nFsize, , 2
                End If
                .TextOut "開札期日", dXX(1) + 2, SY(4) + 8 + HH2 + nPit2, nFsize, , 1
                If Cv(4) <> #12:00:00 AM# Then
                    .TextOut Format(Cv(4), "GGG EE年 " & Right$("  " & Month(Cv(4)), 2) & "月  " & Right$("  " & Day(Cv(4)), 2) & "日"), dXX(1) + 2 + 20, SY(4) + 8 + HH2 + nPit2, nFsize, , 1
                Else
                    .TextOut "平成   年   月   日", dXX(1) + 2 + 20, SY(4) + 8 + HH2 + nPit2, nFsize, , 1
                End If
            End If
            
            If CDate(Cv(5)) Then
                .TextOut Format(Cv(5), "GGG EE年   月   日"), hXX(2), SY(4) + 10 + HH2 + (nPit2 / 2), nFsize, 2, 2
                XX = 2
                If sKey = "n802" Then XX = 0
                .TextOut Month(Cv(5)), dXX(2) + 27.5 + XX, SY(4) + 10 + HH2 + (nPit2 / 2), nFsize, 1, 2
                .TextOut Day(Cv(5)), dXX(2) + 37.5 + XX, SY(4) + 10 + HH2 + (nPit2 / 2), nFsize, 1, 2
            Else
                .TextOut "平成   年   月   日", hXX(2), SY(4) + 10 + HH2 + (nPit2 / 2), nFsize, 2, 2
            End If
            
            .DrawText Cv(6), dXX(3) + 1, SY(4) + 11 + HH2, Ayy(3) - 2, 4, nFsize, , , nPit2 - 2
            
            If sKey = "n802" Then .DrawText Cv(7), dXX(4) + 1, SY(4) + 11 + HH2, 126, 4, nFsize, , , nPit2 - 2
            If mvarStartPage > 0 Then .TextOut "- " & mvarStartPage - 1 + nPage & " - ", .PaperWidth / 2, .PaperHeight - 4
        End With
    End Sub
    Private Sub PrintSub_表B(sKey As String, nPage As Long, ByRef mvarParent As ADBasicLIB2.CPrintFormSK)
        Dim nL As Variant
        
        With mvarParent
            .Offset 0, 0
            
            .TextOut "議案第" & StrConv(GNo(0), vbWide) & "号", dX(0), 13, 13, 0, 2
            .TextOut mvarTitle, dX(1), SY(0) - 10, 11
    '表上---------------
            .LineBoxDX dX(0), SY(0), HH, Rows, nPit, Ay
            
            .TextOut St(0), hX(0), SY(1), 11, 2, 2
            .TextOut St(1), hX(1), SY(2), 11, 2, 2
            .TextOut St(2), hX(1), SY(3), 11, 2, 2
            .DrawText St(3), dX(2), SY(0), Ay(2), 4, 11, 2, 2, HH
            .DrawText St(4), dX(3), 30, Ay(3), 4, 11, 2, 2, HH
            .TextOut St(5), hX(4), SY(1), 11, 2, 2
            .TextOut St(6), hX(5), SY(1), 11, 2, 2
            .TextOut St(7), hX(6), SY(1), 11, 2, 2
            .TextOut St(8), hX(7), SY(1), 11, 2, 2
            
            Cw = Split(Cm(1), vbTab)
            
            For x = 0 To UBound(Cw)
                Cx = Split(Cw(x), ",")
                .DLine dX(0), SY(0) + HH + x * 20, dX(4), SY(0) + HH + x * 20
                .TextOut x + 1, hX(0), SY(0) + HH + 7 + x * 20, nFsize, 2
                .DrawText Cx(1), dX(1) + 1, SY(0) + HH + 1 + x * 20, Ay(1) + 0.5, 4, nFsize, , , 10
                .DrawText Cx(2), dX(1) + 1, SY(0) + HH + 11 + x * 20, Ay(1) + 0.5, 4, nFsize, , , 10
                .DrawText Cx(3), dX(2) + 1, SY(0) + HH + 1 + x * 20, Ay(2) + 0.5, 4, nFsize, , , 10
            Next

            Cv = Split(Cm(0), ",")
            Cy = Split(Cm(2), vbTab)
            For x = 0 To UBound(Cy) - 1
                Cyy = Split(Cy(x), ",")
                .TextOut Cyy(0), dX(3) + 1, SY(0) + HH + 1 + x * 5, nFsize
                .TextOut Cyy(1), hX(4), SY(0) + HH + 1 + x * 5, nFsize, 2
                If Val(Cyy(2)) < 10 And Val(Cyy(2)) <> 0 Then Cyy(2) = FormatNumber(Val(Cyy(2)), 2) Else Cyy(2) = FormatNumber(Val(Cyy(2)), 0)
                .TextOut Cyy(2), dX(6) - 1, SY(0) + HH + 1 + x * 5, nFsize, 1
            Next
            .DrawText Cv(2), dX(6) + 1, SY(0) + HH + 1, Ay(6), 4, nFsize, , , nPit - 2
            .DrawText Cv(3), dX(7) + 1, SY(0) + HH + 1, Ay(7) - 1, 4, nFsize, , , nPit - 2
    '表下---------------
            .DBox dXX(0), SY(4) + 10, dXX(1), SY(4) + 10 + HH2 + Rows2 * nPit2
            If sKey = "n803" Then
                .LineBoxDX dXX(0) + Ayy(0), SY(4) + 10, HH2, Rows2, nPit2, GetArray(34, 44, 50, 50, 40, 30)
            Else
                .LineBoxDX dXX(0) + Ayy(0), SY(4) + 10, HH2, Rows2, nPit2, GetArray(38, 62, 42, 58, 48)
            End If
            .TextOut Stt(0), hXX(0), SY(4) + 10 + (HH2 + Rows2 * nPit2) / 2, 11, 2, 2
            .TextOut Stt(1), hXX(1), SY(5), 11, 2, 2
            .TextOut Stt(2), hXX(2), SY(5), 11, 2, 2
            .TextOut Stt(3), hXX(3), SY(5), 11, 2, 2
            .TextOut Stt(4), hXX(4), SY(5), 11, 2, 2
            .TextOut Stt(5), hXX(5), SY(5), 11, 2, 2
            
            If sKey = "n803" Then .TextOut Stt(6), hXX(6), SY(5), 11, 2, 2
            
            .DrawText Cv(4), dXX(1) + 1, SY(4) + 11 + HH2, Ayy(1), 4, nFsize, , , nPit2 - 2
            If sKey = "n803" Then
                If Cv(5) <> #12:00:00 AM# Then
                    .TextOut Format(Cv(5), "平成   年   月   日"), dXX(2) + 1, SY(4) + 10 + HH2 + (nPit2 / 3), nFsize, , 2
                    .TextOut Month(Cv(5)), dXX(2) + 27, SY(4) + 10 + HH2 + (nPit2 / 3), nFsize, 1, 2
                    .TextOut Day(Cv(5)), dXX(2) + 37, SY(4) + 10 + HH2 + (nPit2 / 3), nFsize, 1, 2
                Else
                    .TextOut "平成   年   月   日", dXX(2) + 1, SY(4) + 10 + HH2 + (nPit2 / 3), nFsize, , 2
                End If
                If Cv(6) <> #12:00:00 AM# Then
                    .TextOut Format(Cv(6), "平成   年   月   日"), dXX(2) + 1, SY(4) + 10 + HH2 + (nPit2 / 3) * 2, nFsize, , 2
                    .TextOut Month(Cv(6)), dXX(2) + 27, SY(4) + 10 + HH2 + (nPit2 / 3) * 2, nFsize, 1, 2
                    .TextOut Day(Cv(6)), dXX(2) + 37, SY(4) + 10 + HH2 + (nPit2 / 3) * 2, nFsize, 1, 2
                Else
                    .TextOut "平成   年   月   日", dXX(2) + 1, SY(4) + 10 + HH2 + (nPit2 / 3) * 2, nFsize, , 2
                End If
                .DrawText Cv(7), dXX(3) + 1, SY(4) + 11 + HH2, Ayy(3) - 2, 4, nFsize, , , nPit2 - 2
                
                If Cv(8) <> #12:00:00 AM# And Len(Cv(8)) > 0 Then
                    .TextOut Format(Cv(8), "GGG EE 年   月   日"), dXX(4) + 4, SY(4) + 10 + HH2 + nPit2 / 2, nFsize, , 2
                    .TextOut Month(Cv(8)), dXX(4) + 30, SY(4) + 10 + HH2 + nPit2 / 2, nFsize, 1, 2
                    .TextOut Day(Cv(8)), dXX(4) + 40, SY(4) + 10 + HH2 + nPit2 / 2, nFsize, 1, 2
                Else
                    .TextOut "平成   年   月   日", dXX(4) + 4, SY(4) + 10 + HH2 + nPit2 / 2, nFsize, , 2
                End If
                
                .DrawText Cv(9), dXX(5) + 1, SY(4) + 11 + HH2, Ayy(5) - 2, 4, nFsize, , , nPit2 - 2
                .DrawText Cv(10), dXX(6) + 1, SY(4) + 11 + HH2, Ayy(6) - 2, 4, nFsize, , , nPit2 - 2
            Else
                If Cv(5) <> #12:00:00 AM# Then
                    .TextOut "入札期間　平成   年   月   日", dXX(2) + 1, SY(4) + 11 + HH2, nFsize
                    .TextOut Format(Cv(5), "EE"), dXX(2) + 33, SY(4) + 11 + HH2, nFsize, 1
                    .TextOut Month(Cv(5)), dXX(2) + 43, SY(4) + 11 + HH2, nFsize, 1
                    .TextOut Day(Cv(5)), dXX(2) + 53, SY(4) + 11 + HH2, nFsize, 1
                Else
                    .TextOut "入札期間　平成   年   月   日", dXX(2) + 1, SY(4) + 11 + HH2, nFsize
                End If
                If Cv(6) <> #12:00:00 AM# Then
                    .TextOut "平成   年   月   日", dXX(2) + 20.5, SY(4) + 10 + HH2 + (nPit2 / 2), nFsize, , 2
                    .TextOut Format(Cv(6), "EE"), dXX(2) + 33, SY(4) + 10 + HH2 + (nPit2 / 2), nFsize, 1, 2
                    .TextOut Month(Cv(6)), dXX(2) + 43, SY(4) + 10 + HH2 + (nPit2 / 2), nFsize, 1, 2
                    .TextOut Day(Cv(6)), dXX(2) + 53, SY(4) + 10 + HH2 + (nPit2 / 2), nFsize, 1, 2
                Else
                    .TextOut "　　　　　平成   年   月   日", dXX(2) + 1, SY(4) + 10 + HH2 + (nPit2 / 2), nFsize, , 2
                End If
                If Cv(7) <> #12:00:00 AM# Then
                    .TextOut Format("開札期日　平成   年   月   日"), dXX(2) + 1, SY(4) + 7 + HH2 + nPit2, nFsize, , 2
                    .TextOut Format(Cv(7), "EE"), dXX(2) + 33, SY(4) + 7 + HH2 + nPit2, nFsize, 1, 2
                    .TextOut Month(Cv(7)), dXX(2) + 43, SY(4) + 7 + HH2 + nPit2, nFsize, 1, 2
                    .TextOut Day(Cv(7)), dXX(2) + 53, SY(4) + 7 + HH2 + nPit2, nFsize, 1, 2
                Else
                    .TextOut "開札期日　平成   年   月   日", dXX(2) + 1, SY(4) + 7 + HH2 + nPit2, nFsize, , 2
                End If
                If Cv(8) <> #12:00:00 AM# Then
                    .TextOut "平成   年   月   日", dXX(3) + 1, SY(4) + 10 + HH2 + (nPit2 / 2), nFsize, , 2
                    .TextOut Format(Cv(8), "EE"), dXX(3) + 14, SY(4) + 10 + HH2 + (nPit2 / 2), nFsize, 1, 2
                    .TextOut Month(Cv(8)), dXX(3) + 23, SY(4) + 10 + HH2 + (nPit2 / 2), nFsize, 1, 2
                    .TextOut Day(Cv(8)), dXX(3) + 33, SY(4) + 10 + HH2 + (nPit2 / 2), nFsize, 1, 2
                Else
                    .TextOut "平成   年   月   日", dXX(3) + 1, SY(4) + 10 + HH2 + (nPit2 / 2), nFsize, , 2
                End If
                .DrawText Cv(9), dXX(4) + 1, SY(4) + 11 + HH2, Ayy(4), 4, nFsize, , , nPit2 - 2
                .DrawText Cv(10), dXX(5) + 1, SY(4) + 11 + HH2, Ayy(5), 4, nFsize, , , nPit2 - 2
            End If
            If mvarStartPage > 0 Then .TextOut "- " & mvarStartPage - 1 + nPage & " - ", .PaperWidth / 2, .PaperHeight - 4
        End With
    End Sub

    Private Sub CPrintSub_SetData(ByVal sKey As String, Optional ByVal sParam1 As String = "", Optional ByVal sParam2 As String = "")
    End Sub
    
    Private Sub CPrintSub_SetRsData(pRs As Object)
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim RsS As ADBasicLIB2.RecordsetEx
        Dim RsA As ADBasicLIB2.RecordsetEx
        Dim SH As String
        Dim SQ As String
        Dim St As String, Stt As String
        Dim SP As String
        Dim Sa As String
        Dim Sc As String
        Dim n As Long, i As Long, j As Long
        Dim n面積 As Double
        Dim n部分面積 As Double
        Dim Ar As Variant, Arr As Variant
        
        NN = NN + 1
        SX = 12
        Set Rs = pRs
        mvarTitle = SystemDB.DBProperty("議案書買受適格タイトル")
        If Rs.IsNull("個人リスト") Then: MsgBox "買受適格の申請データで対象者が入っていない申請があります": Exit Sub
        With mvarPData
            Select Case Rs.Value("法令")
                Case "801": SH = Rs.Value("個人リスト") & "," & Rs.Value("農地リスト") & "," & Rs.Value("入札期間A") & ",0:00:00,0:00:00," & Rs.Value("売却決定日") & "," & Rs.Value("事件等") & "," & Null & "," & Rs.Value("物件番号") & vbBack
                Case "802": SH = Rs.Value("個人リスト") & "," & Rs.Value("農地リスト") & "," & Rs.Value("入札期間A") & "," & Rs.Value("入札期間B") & "," & Rs.Value("入札期日") & "," & Rs.Value("売却決定日") & "," & Rs.Value("所轄") & "," & Rs.Value("事件等") & "," & Rs.Value("物件番号") & vbBack
                Case "803": SH = Rs.Value("個人リスト") & "," & Rs.Value("農地リスト") & "," & Rs.Value("申請理由A") & "," & Rs.Value("備考") & "," & Rs.Value("原因") & "," & Rs.Value("入札期間A") & "," & Rs.Value("入札期間B") & "," & Rs.Value("売買の場所") & "," & Rs.Value("売却決定日") & "," & Rs.Value("所轄") & "," & Rs.Value("事件等") & vbBack
                Case "804": SH = Rs.Value("個人リスト") & "," & Rs.Value("農地リスト") & "," & Rs.Value("申請理由A") & "," & Rs.Value("備考") & "," & Rs.Value("原因") & "," & Rs.Value("入札期間A") & "," & Rs.Value("入札期間B") & "," & Rs.Value("入札期日") & "," & Rs.Value("売却決定日") & "," & Rs.Value("所轄") & "," & Rs.Value("事件等") & vbBack
            End Select

            Ar = Split(Replace(Replace(Rs.Value("個人リスト"), ".", ""), "対象者.", ""), ";")
            Arr = Ar
            For i = 0 To UBound(Ar)
                Stt = Stt & "," & Ar(i)
            Next
            Stt = MID(Stt, 2)
            
            SQ = ""
            For i = 0 To UBound(Ar)
                Set RsS = SystemDB.GetRecordsetEx("SELECT 世帯ID,氏名,住所,職業,関連農業者数 FROM D:個人Info WHERE ID =" & Arr(i), , , Me)
                    If RsS.IsNoRecord Then
                    Else
                        SQ = SQ & RsS.Value("世帯ID") & "," & RsS.Value("氏名") & "," & RsS.Value("住所") & "," & RsS.Value("職業") & "," & Rs.NullCast(("関連農業者数"), 0)
                        Set RsA = SystemDB.GetRecordsetEx("SELECT Sum(V_農地.田面積) AS 田合計, Sum(V_農地.畑面積) AS 畑合計 FROM V_農地 WHERE [V_農地].[耕作世帯ID]=" & RsS.Value("世帯ID"), 0, , Me)
                            SQ = SQ & "," & RsA.Value("田合計") & "," & RsA.Value("畑合計") & "," & RsA.Value("田合計") + RsA.Value("畑合計") & vbTab
                        SystemDB.CloseRs RsA
                    End If
                SystemDB.CloseRs RsS
            Next
            
            SQ = Left(SQ, Len(SQ) - 1) & vbBack
            
            If Len(Rs.Value("農地リスト")) = 0 Then Exit Sub
            SP = Replace(Replace(Rs.Value("農地リスト"), "農地.", ""), ";", ",")
            n = 0
            j = 0
            Set RsS = SystemDB.GetRecordsetEx("SELECT V_農地.土地所在, V_農地.農委地目認定日, V_地目.名称 AS 地目1, IIf([地目]=11,[田面積],IIf([地目]=21,[畑面積],0)) AS 面積 FROM V_農地 INNER JOIN V_地目 ON V_農地.現況地目 = V_地目.ID " & _
            "WHERE (((V_農地.ID) In (" & SP & "))) " & "ORDER BY V_農地.土地所在;", 0, , Me)
            
            Do Until RsS.EOF
                Sa = Sa & RsS.Value("土地所在") & "," & IIf(RsS.Value("農委地目認定日") = #12:00:00 AM# Or IsNull(RsS.Value("農委地目認定日")), RsS.Value("地目1"), RsS.Value("地目1")) & "," & RsS.Value("面積") & vbTab
                n = n + RsS.Value("面積")
                j = j + 1
                RsS.MoveNext
            Loop
            RsS.CloseRs
            
            Sa = Sa & "     -            計           -," & j & "筆," & n & "u" & vbTab
            
            '土地のデータをつける
            Select Case Rs.Value("法令")
                Case "801": pData(0) = pData(0) & SH & SQ & Sa & vbBack & n & vbBack & NN & "!$!"
                    mPage(0) = mPage(0) + 1: PageMax = mPage(0)
                Case "802":
                    If UBound(Split(Sa, vbTab)) > 19 Then
                        Do Until UBound(Split(Sa, vbTab)) < 20
                            Ar = Split(Sa, vbTab)
                            Sc = ""
                            For i = 0 To 19
                                Sc = Sc & vbTab & Ar(i)
                            Next
                            Sc = MID$(Sc, 2)
                            
                            Sa = MID$(Sa, Len(Sc) + 2)
                            pData(1) = pData(1) & SH & SQ & Sc & vbBack & n & vbBack & NN & "!$!"
                            mPage(1) = mPage(1) + 1: PageMax = mPage(1)
                        Loop
                    End If
                    If Len(Sa) Then
                        pData(1) = pData(1) & SH & SQ & Sa & vbBack & n & vbBack & NN & "!$!"
                        mPage(1) = mPage(1) + 1: PageMax = mPage(1)
                    End If
                Case "803": pData(2) = pData(2) & SH & SQ & Sa & vbBack & n & vbBack & NN & "!$!"
                    mPage(2) = mPage(2) + 1: PageMax = mPage(2)
                Case "804": pData(3) = pData(3) & SH & SQ & Sa & vbBack & n & vbBack & NN & "!$!"
                    mPage(3) = mPage(3) + 1: PageMax = mPage(3)
            End Select
        End With
        PageNow = 1
    End Sub

End Class











Class CPrintSub利用権設定
    Option Explicit
    Implements CPrintSub
    Private mvarKey As String
    Private mvarData As String
    Private mvarPData As CPrintDatas
    Private mvarNowPage As Long
    Private mvarMaxPage As Long
    Private mvarRows As Long
    Private Const PGMAX As Long = 100   'ページ切替データＭＡＸ
    Private PgChgSt(PGMAX) As Long      'ページ切替開始番号
    Private PgChgEn(PGMAX) As Long      'ページ切替終了番号
    Private DataCnt As Long             'データカウント
    Private PageCnt As Long             'ページカウント
    Private HMax As Long                '基本データMAX
    Private LMax As Long                '１ページの行数
    Private StartX As Single            'データ始点(X)
    Private StartY As Single            'データ始点(Y)
    Private nFsize As Integer           'フォントサイズ
    Private RowH As Long
    Private ColW As Variant             '表枠の幅
    Private s支所 As String
    Private b総括表出力 As Boolean
    Private s都道府県名 As String
    Private s郡部 As String
    Private p支所番号 As New CDataDictionary
    Private 総括Page As Long
    Private 総括Cnt As Long
    Private mvarTB As New CPrintTable
    Private sData(3) As String
    Private mvarStartPage As Integer
        
    Private b総合計出力 As Boolean
    
    
    Private Type dt総括表
        s公告日 As String
        s始期 As String
        s終期 As String
        n期間年 As Long
        n期間月 As Long
        n面積(10) As Double
        n人数(5) As Long
    End Type
    
    Private Type dt合計
        s地目(4) As String
        n筆数(4) As Long
        n面積(4) As Double
    End Type
    Private T総合計 As dt合計
    Private T総括(100) As dt総括表
    
    Private Property Let CPrintSub_Data(ByVal RHS As String): Dim Cm As Variant: mvarData = RHS: Cm = Split(mvarData, ";"): mvarStartPage = Val(Cm(2)) - (Val(Cm(2)) = 2) * (Val(Cm(3)) - 2): End Property
    Private Property Get CPrintSub_Data() As String: CPrintSub_Data = mvarData: End Property

    Private Property Let CPrintSub_Key(ByVal RHS As String): mvarKey = RHS: End Property
    Private Property Get CPrintSub_Key() As String: CPrintSub_Key = mvarKey: End Property

    Private Property Get CPrintSub_MaxPage() As Long
        If mvarPData.Count > 0 Then
            If b総括表出力 = True Then
                CPrintSub_MaxPage = mvarMaxPage + 総括Page
            Else
                CPrintSub_MaxPage = mvarMaxPage
            End If
        Else
            CPrintSub_MaxPage = 0
        End If
    End Property

    Private Property Get CPrintSub_NowPage() As Long: CPrintSub_NowPage = mvarNowPage: End Property

    Private Sub CPrintSub_PrintSub(ByVal sKey As String, ByVal nPage As Long, mvarParent As ADBasicLIB2.CPrintFormSK)
        Dim Ar As Variant, Cm As Variant
        Dim n As Long, i As Long
        Dim St As String
        Dim St1 As String, St2 As String
        Dim dX(20) As Single, hX(20) As Single
        Dim Xcnt As Long

        If nPage = 0 Then
            mvarParent.ClearScreen
            Exit Sub
        End If

        mvarNowPage = nPage
        
        If b総括表出力 = True And nPage <= 総括Page Then
            Print総括表 mvarParent
        Else
            With mvarParent
                .ClearScreen
                .Offset 0, 0
                Ar = Split(mvarData, vbCrLf)
                Cm = Split(Ar(0), ";")
               
                If IsEmpty(ColW) Then Exit Sub
                dX(0) = StartX: hX(0) = dX(0) + ColW(0) / 2
                mvarTB.SX = StartX
                For i = 0 To UBound(ColW)
                    dX(i + 1) = dX(i) + ColW(i)
                    If i < UBound(ColW) Then hX(i + 1) = dX(i + 1) + ColW(i + 1) / 2
                Next
                Xcnt = UBound(ColW) + 1
                            
                Select Case Fnc.s市町村名
                Case "姶良市", "阿久根市"
                    .Offset 0, 5
                    
                    .DrawWidth = 2
                    .TextOut "議案第" & StrConv(Cm(0), vbWide) & "号", dX(0) - 5, 13, 13, 0, 2
                    Select Case mvarKey
                        Case "n61":
                            .TextOut "農用地利用集積計画(貸借）", dX(0), 20, 14, 0, 2
                            .DrawText "借　　　　　人", dX(1), 25.5, dX(2) - dX(1), 4, nFsize, 2, 2
                            .DrawText "貸　　　　　人", dX(2), 25.5, dX(3) - dX(2), 4, nFsize, 2, 2
                        Case "n62":
                            .TextOut "農用地利用集積計画(移転）", dX(0), 20, 14, 0, 2
                            .DrawText "受　　　　　人", dX(1), 25.5, dX(2) - dX(1), 4, nFsize, 2, 2
                            .DrawText "渡　　　　　人", dX(2), 25.5, dX(3) - dX(2), 4, nFsize, 2, 2
                    End Select
                    .DrawText "氏　　　名", dX(1), 32.5, ColW(1), 4, nFsize, 2
                    .DrawText "住　　　所", dX(1), 40, ColW(1), 4, nFsize, 2
                    .DrawText "氏　　　名", dX(2), 32.5, ColW(2), 4, nFsize, 2
                    .DrawText "住　　　所", dX(2), 40, ColW(2), 4, nFsize, 2
                    
                    .DrawText "地目", dX(4), 25.5, ColW(4) + ColW(5), 4, nFsize, 2, 2
                    .DrawText "登\n記\n簿", dX(4), 31, ColW(4), 5, nFsize, 2
                    .DrawText "現\n況", dX(5), 34, ColW(5), 6, nFsize, 2, 0
                    .DrawText "面積\n\n(u)", dX(6), 34, ColW(6), 4, nFsize, 2, 2
    '                    .DrawText "地域区分", dX(7), 25.5, ColW(7) + ColW(8), 4, nFsize - 1, 2, 2
    '                    .DrawText "農\n振\n法", dX(7), 31, ColW(7), 5, nFsize, 2
    '                    .DrawText "土\n地\n改\n良", dX(8), 31, ColW(8), 3.5, 9, 2
                    .DrawText "契\n約\n種\n類", dX(9), 28, ColW(9), 4, nFsize, 2, 0
                    .DrawText "契\n約\n内\n容", dX(10), 28, ColW(10), 4, nFsize, 2, 0
                    .DrawText "始期", dX(11), 28, ColW(11), 4, nFsize, 2, 0
                    .DrawText "終期", dX(11), 28 + 8, ColW(11), 4, nFsize, 2, 0
                    .DrawText "契\n約\n期\n間", dX(12), 28, ColW(12), 4, nFsize, 2, 0
                    .DrawText "賃借/年額", dX(13), 34, ColW(13), 4, nFsize, 2, 0
                    .DrawText "支払方法", dX(14), 34, ColW(14), 4, nFsize, 2, 0
                    .DrawText "設\n定\n内\n容", dX(16), 28, ColW(16), 4, nFsize, 2, 0
                    If Fnc.s市町村名 = "姶良市" Then
                        .DrawText "担当委員", mvarTB.ColumnLeft(17), 34, ColW(17), 4, nFsize, 2, 0
                    Else
                        .DrawText "調査員", mvarTB.ColumnLeft(17), 34, ColW(17), 4, nFsize, 2, 0
                    End If
                    .DLine dX(0), 25, dX(Xcnt), 25
                    .DLine dX(1), 30, dX(3), 30
                    .DLine dX(4), 30, dX(6), 30
                    .DLine dX(7), 30, dX(9), 30
                    .DLine dX(0), 46, dX(Xcnt), 46
                    
                    mvarTB.DrawHeader mvarParent
                    
                    For i = 0 To Xcnt
                        Select Case i
                            Case 5, 8
                                .DLine dX(i), 30, dX(i), 46
                            Case Else
                                .DLine dX(i), 25, dX(i), 46
                        End Select
                    Next
                Case "枕崎市"
                    .Offset 0, 0

                    .TextOut "農用地利用集積計画総括表", dX(0), 19, 11, 0, 1
                    .DrawText "番号", dX(0), 24, ColW(0), RowH, nFsize, 2, 2
                    
                    Select Case mvarKey
                        Case "n61": St1 = "利用権設定等をする者"
                                    St2 = "利用権設定等を受ける者"
                        Case "n62": St1 = "利用権移転等をする者"
                                    St2 = "利用権移転等を受ける者"
                    End Select
                    
                    .DrawText St1, dX(1), 22, ColW(1) + ColW(2), RowH, nFsize, 2, 2
                    .DrawText "氏　名", dX(1), 26, ColW(1), RowH, nFsize, 2, 2
                    .DrawText "住　所", dX(2), 26, ColW(2), RowH, nFsize, 2, 2
                    .DrawText St2, dX(3), 22, ColW(3) + ColW(4), RowH, nFsize, 2, 2
                    .DrawText "氏　名", dX(3), 26, ColW(3), RowH, nFsize, 2, 2
                    .DrawText "住　所", dX(4), 26, ColW(4), RowH, nFsize, 2, 2
                    .DrawText "所　　在", dX(5), 24, ColW(5), RowH, nFsize, 2, 2
                    .DrawText "現況\n地目", dX(6), 24, ColW(6), RowH, nFsize, 2, 2
                    .DrawText "面積\n(u)", dX(7), 24, ColW(7), RowH, nFsize, 2, 2
                    .DrawText "権利の種類", dX(8), 24, ColW(8), RowH, nFsize, 2, 2
                    .DrawText "内容", dX(9), 24, ColW(9), RowH, nFsize, 2, 2
                    .DrawText "始　期", dX(10), 24, ColW(10), RowH, nFsize, 2, 2
                    .DrawText "存続期間\n(終期)", dX(11), 24, ColW(11), RowH, nFsize, 2, 2
                    .DrawText "借賃\n(円)", dX(12), 24, ColW(12), RowH, nFsize, 2, 2
                    .DrawText "借賃の\n支払方法", dX(13), 24, ColW(13), RowH, nFsize, 2, 2
                    .DrawText "法律関係", dX(14), 24, ColW(14), RowH, nFsize, 2, 2
                    
                    .DLine dX(0), 20, dX(Xcnt), 20
                    .DLine dX(1), 24, dX(5), 24
                    .DLine dX(0), 28, dX(Xcnt), 28
                    For i = 0 To Xcnt
                        Select Case i
                            Case 2, 4: .DLine dX(i), 24, dX(i), 28
                            Case Else: .DLine dX(i), 20, dX(i), 28
                        End Select
                    Next
                    
                Case "南種子町"
                    .Offset 0, 0
                    .TextOut "計画内訳書（経営面積等）", dX(0) + 5, 25, nFsize, 0, 0
                    .TextOut "整理", hX(0), 35, nFsize, 2, 2
                    .TextOut "番号", hX(0), 41, nFsize, 2, 2
                    Select Case mvarKey
                        Case "n61": St1 = "利用権設定等をする者"
                                    St2 = "利用権設定等を受ける者"
                        Case "n62": St1 = "利用権移転等をする者"
                                    St2 = "利用権移転等を受ける者"
                    End Select

                    .TextOut St1, (dX(1) + dX(4)) / 2, 34.5, nFsize, 2, 2
                    .TextOut "氏　　名", hX(1), 41.5, nFsize, 2, 2
                    .TextOut "年齢", hX(2), 41.5, nFsize, 2, 2
                    .TextOut "経営面積", hX(3), 41.5, nFsize, 2, 2
                    .TextOut St2, (dX(4) + dX(7)) / 2, 34.5, nFsize, 2, 2
                    .TextOut "氏　　名", hX(4), 41.5, nFsize, 2, 2
                    .TextOut "年齢", hX(5), 41.5, nFsize, 2, 2
                    .TextOut "経営面積", hX(6), 41.5, nFsize, 2, 2
                    .TextOut "土地の所在", hX(7), 38, nFsize, 2, 2
                    .TextOut "登記", hX(8), 35, nFsize, 2, 2
                    .TextOut "地目", hX(8), 41, nFsize, 2, 2
                    .TextOut "現況", hX(9), 35, nFsize, 2, 2
                    .TextOut "地目", hX(9), 41, nFsize, 2, 2
                    .TextOut "面　積", hX(10), 35, nFsize, 2, 2
                    .TextOut "（u）", hX(10), 41, nFsize, 2, 2
                    .TextOut "権利内容", hX(11), 35, nFsize, 2, 2
                    .TextOut "(作物名)", hX(11), 41, nFsize, 2, 2
                    .TextOut "権利の", hX(12), 35, nFsize, 2, 2
                    .TextOut "種　類", hX(12), 41, nFsize, 2, 2
                    If mvarKey = "n61" Then
                        .DrawText "賃借料\n（円）", dX(13), 33.5, ColW(13), 6, nFsize, 2
                    Else
                        .TextOut "賃借料", hX(13), 38, nFsize, 2, 2
                    End If
                    .TextOut "支払方法", hX(14), 38, nFsize, 2, 2
                    .TextOut "存　続", hX(15), 34.5, nFsize, 2, 2
                    .TextOut "(残存)", hX(15), 38, nFsize, 2, 2
                    .TextOut "期　間", hX(15), 42, nFsize, 2, 2
                    .TextOut "設定", hX(16), 35, nFsize, 2, 2
                    .TextOut "内容", hX(16), 41, nFsize, 2, 2
                    .TextOut "備　　考", hX(17), 38, nFsize, 2, 2
                    
                    .DLine dX(0), 31, dX(Xcnt), 31
                    .DLine dX(1), 38, dX(7), 38
                    .DLine dX(0), 45, dX(Xcnt), 45
                    For i = 0 To Xcnt
                        Select Case i
                            Case 2, 3, 5, 6: .DLine dX(i), 38, dX(i), 45
                            Case Else:       .DLine dX(i), 31, dX(i), 45
                        End Select
                    Next
                   
                Case "さつま町", "長島町"
                    .Offset 0, 0
                    .TextOut "農 用 地 利 用 集 積 計 画 各 筆 明 細", (dX(Xcnt) - dX(0)) / 2 + dX(0), 20, 14, 2, 0
                    
                    Select Case mvarKey
                        Case "n61": .TextOut "賃借人氏名", hX(0), 36, nFsize, 2, 2
                                    .TextOut "賃貸人氏名", hX(3), 36, nFsize, 2, 2
                        Case "n62": .TextOut "新受人氏名", hX(0), 36, nFsize, 2, 2
                                    .TextOut "旧受人氏名", hX(3), 36, nFsize, 2, 2
                    End Select
                    .TextOut "住　　所", hX(1), 36, nFsize, 2, 2
                    .TextOut "経営面積", hX(2), 32, nFsize, 2, 0
                    .TextOut "(u)", hX(2), 40, nFsize, 2, 1
                    .TextOut "住　　所", hX(4), 36, nFsize, 2, 2
                    .TextOut "所　　　　在", hX(5), 36, nFsize, 2, 2
                    .TextOut "地　目", hX(6), 36, nFsize, 2, 2
                    .TextOut "地積(u)", hX(7), 36, nFsize, 2, 2
                    .TextOut "期間", hX(8), 36, nFsize, 2, 2
                    .TextOut "小 作 料", hX(9), 36, nFsize, 2, 2
    '                    .TextOut "小 作 料", hX(9), 32, nFsize, 2, 0
    '                    .TextOut "(10a当たり)", hX(9), 40, nFsize - 1, 2, 1
                    .TextOut "新・再", hX(10), 32, nFsize, 2, 0
                    .TextOut "の別", hX(10), 40, nFsize, 2, 1
                    .LineBoxDX dX(0), 30, 0, 1, 12, ColW
                
                Case "日置市"
                    .Offset 0, 0
                    .TextOut "第" & StrConv(Cm(0), vbWide) & "号議案", dX(0) - 5, 13, 13, 0, 2
                    .TextOut "農用地利用集積計画", dX(0), 20, 14, 0, 2
                    
                    Select Case mvarPData.Data(PgChgSt(nPage - 総括Page) \ 1000, "受付補助記号")
                    
                        Case "本": St = "伊集院地域"
                        Case "東": St = "東市来地域"
                        Case "日": St = "日吉地域"
                        Case "吹": St = "吹上地域"
                        Case Else: St = ""
                    End Select
                    .TextOut "[ " & St & " ]", dX(Xcnt), 24, 14, 1, 1

                    .DrawText "番", dX(0), 32.5, ColW(0), RowH, nFsize, 2, 2
                    .DrawText "号", dX(0), 42.5, ColW(0), RowH, nFsize, 2, 2
                    .DrawText "申　　　　　　請　　　　　　人", dX(1), 27.5, dX(6) - dX(1), RowH, nFsize, 2, 2
                    .DrawText "借　　　人", dX(1), 32.5, dX(4) - dX(1), RowH, nFsize, 2, 2
                    .DrawText "氏　　　名", dX(1), 38, ColW(1), RowH, nFsize, 2, 2
                    .DrawText "住　　　所", dX(1), 42.5, ColW(1), RowH, nFsize, 2, 2
                    .DrawText "年　　　齢", dX(1), 47, ColW(1), RowH, nFsize, 2, 2
                    .DrawText "経  営", dX(2), 38, ColW(2), RowH, nFsize, 2, 2
                    .DrawText "面　積", dX(2), 47, ColW(2), RowH, nFsize, 2, 2
                    .DrawText "労", dX(3), 38, ColW(3), RowH, nFsize, 2, 2
                    .DrawText "力", dX(3), 47, ColW(3), RowH, nFsize, 2, 2
                    .DrawText "貸　　　人", dX(4), 32.5, dX(6) - dX(4), RowH, nFsize, 2, 2
                    .DrawText "氏　　　名", dX(4), 38, ColW(4), RowH, nFsize, 2, 2
                    .DrawText "住　　　所", dX(4), 42.5, ColW(4), RowH, nFsize, 2, 2
                    .DrawText "年　　　齢", dX(4), 47, ColW(4), RowH, nFsize, 2, 2
                    .DrawText "経  営", dX(5), 38, ColW(5), RowH, nFsize, 2, 2
                    .DrawText "面　積", dX(5), 47, ColW(5), RowH, nFsize, 2, 2
                    .DrawText "申　　　　請　　　　地", dX(6), 27.5, dX(11) - dX(6), RowH, nFsize, 2, 2
                    .DrawText "土地の所在", dX(6), 40, ColW(6), RowH, nFsize, 2, 2
                    .DrawText "台", dX(7), 37, ColW(7), RowH, nFsize, 2, 2
                    .DrawText "帳", dX(7), 43, ColW(7), RowH, nFsize, 2, 2
                    .DrawText "現", dX(8), 37, ColW(8), RowH, nFsize, 2, 2
                    .DrawText "況", dX(8), 43, ColW(8), RowH, nFsize, 2, 2
                    .DrawText "面積", dX(9), 37, ColW(9), RowH, nFsize, 2, 2
                    .DrawText "　u", dX(9), 43, ColW(9), RowH, nFsize, 2, 2
                    .DrawText "契約内容", dX(10), 40, ColW(10), RowH, nFsize, 2, 2
                    .DrawText "契約\n期間", dX(11), 37.5, ColW(11), RowH + 2, nFsize, 2, 2
                    .DrawText "設\n定\n内\n容", dX(12), 37.5, ColW(12), RowH, nFsize, 2, 2
                    .DrawText "作物名", dX(13), 37.5, ColW(13), RowH, nFsize, 2, 2
                    .DrawText "同\n意\n書", dX(14), 37.5, ColW(14), RowH, nFsize, 2, 2
                    .DrawText "備考", dX(15), 37.5, ColW(15), RowH, nFsize, 2, 2
             
                    .DLine dX(0), 25, dX(Xcnt), 25
                    .DLine dX(1), 30, dX(11), 30
                    .DLine dX(1), 35, dX(6), 35
                    .DLine dX(0), 50, dX(Xcnt), 50
                    
                    For i = 0 To Xcnt
                        Select Case i
                            Case 4, 7, 8, 9, 10:    .DLine dX(i), 30, dX(i), 50
                            Case 2, 3, 5:           .DLine dX(i), 35, dX(i), 50
                            Case Else:              .DLine dX(i), 25, dX(i), 50
                        End Select
                    Next

                Case "三股町"
                    .Offset 0, 0
                    Select Case mvarKey
                        Case "n61": St = "設定"
                                    St1 = "利用権の設定\nを受ける者\n（借受者）"
                                    St2 = "利用権を設定\nする者\n（貸付者）"
                        Case "n62": St = "移転"
                                    St1 = "利用権の移転\nを受ける者"
                                    St2 = "利用権を移転\nする者"
                    End Select

                    .TextOut "利用権" & St & "各筆明細", dX(1), 16, 14
                    .TextOut "公告年月日", 180, 18, nFsize
                    .TextOut IIf(IsDate(mvarPData.Data(1, "公告日")), Format(mvarPData.Data(1, "公告日"), "GGG EE年 M月 D日"), ""), 200, 18, nFsize
                    .TextOut "三股町", dX(Xcnt) - 5, 18, nFsize, 1
                    .DrawText "番\n\n号", dX(0), 28, ColW(0), RowH, nFsize, 2, 2
                    .DrawText "受付\n年\n月日", dX(1), 28, ColW(1), RowH, nFsize, 2, 2
                    .DrawText St1, dX(2), 28, ColW(2), RowH, nFsize, 2, 2
                    .DrawText St2, dX(3), 28, ColW(3), RowH, nFsize, 2, 2
                    .TextOut "利用権を" & St & "する農用地", dX(4) + (dX(7) - dX(4)) / 2, 27.5, nFsize, 2, 2
                    .TextOut "所　　　在", dX(4) + ColW(4) / 2, 35, nFsize, 2, 2
                    .DrawText "現況\n地目", dX(5), 32, ColW(5), RowH, nFsize, 2, 2
                    .DrawText "面積\n(u)", dX(6), 32, ColW(6), RowH, nFsize, 2, 2
                    .TextOut "設 定 す る 利 用 権", dX(7) + (dX(12) - dX(7)) / 2, 27.5, nFsize, 2, 2
                    .DrawText "利用権\nの種類", dX(7), 32, ColW(7), RowH, nFsize, 2, 2
                    .DrawText "主要\n作物", dX(8), 32, ColW(8), RowH, nFsize, 2, 2
                    .DrawText "始　期\n終　期", dX(9), 32, ColW(9), RowH, nFsize, 2, 2
                    .DrawText "期間借地\n(○印)", dX(10), 32, ColW(10), RowH, 9, 2, 2
                    .TextOut "借賃", dX(11) + ColW(11) / 2, 35, nFsize, 2, 2
                    .TextOut "借り手の経営状況", dX(12) + (dX(15) - dX(12)) / 2, 27.5, nFsize, 2, 2
                    .DrawText "経営\n面積", dX(12), 32, ColW(12), RowH, nFsize, 2, 2
                    .TextOut "家族数", dX(13) + ColW(13) / 2, 35, nFsize, 2, 2
                    .DrawText "稼動\n労働者", dX(14), 32, ColW(14), RowH, nFsize, 2, 2
                    .DrawText "更新\n(○)印", dX(15), 29, ColW(15), 6, nFsize, 2
                    .TextOut "関連事情名", dX(16) + ColW(16) / 2, 32.5, nFsize, 2, 2
    
                    .DLine 180, 21.5, 230, 21.5
                    .DLine dX(0), 25, dX(Xcnt), 25
                    .DLine dX(4), 30, dX(15), 30
                    .DLine dX(0), 39, dX(Xcnt), 39
                    
                    For i = 0 To Xcnt
                        Select Case i
                            Case 5, 6, 8, 9, 10, 11, 13, 14: .DLine dX(i), 30, dX(i), 40
                            Case Else:                       .DLine dX(i), 25, dX(i), 40
                        End Select
                    Next
                
                Case Else '"大崎町"
                    .Offset 0, 5
                    .TextOut "第" & StrConv(Cm(0), vbWide) & "号議案", dX(0) - 4, 13, 13, 0, 2
                    .TextOut "農用地利用集積計画", dX(0), 22, 14, 0, 2
    
                    .DrawText "番\n\n号", dX(0), 25, ColW(0), RowH, nFsize, 2, 2, 24
                    Select Case mvarKey
                        Case "n61":
                            .DrawText "借　　　　　人", dX(1), 26, dX(4) - dX(1), RowH, nFsize, 2, 2, 4
                            .DrawText "貸　　　　　人", dX(4), 26, dX(7) - dX(4), RowH, nFsize, 2, 2, 4
                        Case "n62":
                            .DrawText "利用権の移転を受ける者", dX(1), 28, dX(4) - dX(1), RowH, nFsize, 2, 2
                            .DrawText "利用権の移転をする者", dX(4), 28, dX(7) - dX(4), RowH, nFsize, 2, 2
                    End Select

                    .DrawText "氏　　　名", dX(1), 33, ColW(1), RowH, nFsize, 2
                    .DrawText "集　　　落", dX(1), 37.5, ColW(1), RowH, nFsize, 2
                    .DrawText "職業・年齢", dX(1), 42, ColW(1), RowH, nFsize, 2
                    .DrawText "経 営", dX(2), 33, ColW(2), RowH, nFsize, 2
                    .DrawText "面 積", dX(2), 42, ColW(2), RowH, nFsize, 2
                    .DrawText "労", dX(3), 33, ColW(3), RowH, nFsize, 2
                    .DrawText "力", dX(3), 42, ColW(3), RowH, nFsize, 2
                    .DrawText "氏　　　名", dX(4), 33, ColW(4), RowH, nFsize, 2
                    .DrawText "集　　　落", dX(4), 37.5, ColW(4), RowH, nFsize, 2
                    .DrawText "職業・年齢", dX(4), 42, ColW(4), RowH, nFsize, 2
                    .DrawText "経 営", dX(5), 33, ColW(5), RowH, nFsize, 2
                    .DrawText "面 積", dX(5), 42, ColW(5), RowH, nFsize, 2
                    .DrawText "申請", dX(6), 33, ColW(6), RowH, nFsize, 2
                    .DrawText "理由", dX(6), 42, ColW(6), RowH, nFsize, 2
                    .DrawText "土 地 の 所 在", dX(7), 25, ColW(7), RowH, nFsize, 2, 2, 24
                    .DrawText "地目", dX(8), 26, ColW(8) + ColW(9), RowH, nFsize, 2, 2, 4
                    .DrawText "台\n\n帳", dX(8), 30, ColW(8), 4, nFsize, 2, 2, 19
                    .DrawText "現\n\n況", dX(9), 30, ColW(9), 4, nFsize, 2, 2, 19
                    .DrawText "面積\n\n(u)", dX(10), 25, ColW(10), RowH, nFsize, 2, 2, 24
                    .DrawText "農\n\n振", dX(11), 25, ColW(11), RowH, nFsize, 2, 2, 24
                    .DrawText "契約内容", dX(12), 25, ColW(12), RowH, nFsize, 2, 2, 24
                    .DrawText "契\n約\n期\n間", dX(13), 25, ColW(13), RowH, nFsize, 2, 2, 24
                    .DrawText "設\n定\n内\n容", dX(14), 25, ColW(14), RowH, nFsize, 2, 2, 24
                    .DrawText "結\n\n果", dX(15), 25, ColW(15), RowH, nFsize, 2, 2, 24
                    .DrawText "備  考", dX(16), 25, ColW(16), RowH, nFsize, 2, 2, 24
                        
                    .DLine dX(0), 25, dX(Xcnt), 25
                    .DLine dX(1), 30, dX(7), 30
                    .DLine dX(8), 30, dX(10), 30
                    .DLine dX(0), 49, dX(Xcnt), 49
                    
                    For i = 0 To Xcnt
                        Select Case i
                            Case 2, 3, 5, 6, 9: .DLine dX(i), 30, dX(i), 49
                            Case Else: .DLine dX(i), 25, dX(i), 49
                        End Select
                    Next
                End Select
                PrintSubMain mvarParent, dX(), hX()

            If mvarStartPage > 0 Then .TextOut "- " & mvarStartPage - 1 + nPage & " - ", .PaperWidth / 2, .PaperHeight - 12
            End With
        End If
        For i = 0 To 3
            sData(i) = ""
        Next
    End Sub
    
    Private Sub PrintSubMain(ByRef mvarParent As ADBasicLIB2.CPrintFormSK, ByRef dX() As Single, ByRef hX() As Single)
        Dim hY As Single        ' 基本データY座標
        Dim dY As Single        ' 土地データY座標
        Dim Rcnt As Long        ' 行カウント
        Dim nMainStart As Long  ' データ開始番号
        Dim nMainEnd As Long    ' データ終了番号
        Dim nSubStart As Long   ' 土地データ開始番号
        Dim nSubEnd As Long     ' 土地データ終了番号
        Dim n As Long
        Dim i As Long
        Dim nWork As Single
        Dim nPage As Long
        Dim Xcnt As Long
        
        nPage = mvarNowPage
        If b総括表出力 = True Then nPage = nPage - 総括Page

        Xcnt = UBound(ColW) + 1

        With mvarParent
            nMainStart = PgChgSt(nPage) \ 1000
            nMainEnd = PgChgEn(nPage) \ 1000
       
            dY = StartY + 1
            hY = StartY + 1

            If nMainStart = 0 And nMainEnd = 0 Then
            Else
            For n = nMainStart To nMainEnd
                ' 土地データ開始番号設定
                If n = nMainStart Then
                    nSubStart = PgChgSt(nPage) - nMainStart * 1000
                Else
                    nSubStart = 0
                End If
                
                '土地データ終了番号設定
                If n = nMainEnd Then
                    nSubEnd = PgChgEn(nPage) - nMainEnd * 1000
                Else
                    nSubEnd = mvarPData.SubCount(n & ":農地")
                End If
                
                ' 罫線
                Rcnt = nSubEnd - nSubStart + 1
                If Rcnt < HMax Then
                    nWork = hY + HMax * RowH
                Else
                    nWork = dY + Rcnt * RowH
                End If
                For i = 0 To Xcnt
                    .DLine dX(i), dY - 1, dX(i), nWork, vbBlack
                Next
                
                '背景色設定
                If Fnc.s市町村名 = "日置市" Then
                    For i = 0 To Xcnt
                        Select Case i
                        Case 0, 11, 12, 13, 14
                            .DBox dX(i), hY - 1, dX(i + 1), nWork, RGB(230, 230, 230), , True
                        End Select
                        .DLine dX(i), hY - 1, dX(i), nWork, vbBlack
                    Next
                    .DLine dX(0), hY - 1, dX(Xcnt), hY - 1, vbBlack
                End If

                ' データ出力

                For i = nSubStart To nSubEnd
                    PrintSubData mvarParent, n, i, dX, hX, dY, nSubStart, nSubEnd
                    dY = dY + RowH
                Next
                
                
                Rcnt = nSubEnd - nSubStart + 1
                If Rcnt < HMax Then   ' 土地データ行数が基本データ行数より少ないとき
                    dY = hY + 1 + HMax * RowH
                End If
                If Fnc.s市町村名 <> "さつま町" Then
                    .DLine dX(0), dY, dX(Xcnt), dY
                Else
                    If n = nMainEnd Then
                        .DLine dX(0), dY, dX(Xcnt), dY
                    Else
                        .DLine dX(5), dY, dX(Xcnt), dY
                    End If
                End If
                dY = dY + 1
                hY = dY
            Next
            End If
            If nPage = mvarMaxPage Then PrintSubTotal mvarParent, dX, hX, dY
        End With
    End Sub
    
    Private Sub PrintSubData(ByRef mvarParent As ADBasicLIB2.CPrintFormSK, pNo As Long, pSubNo As Long, ByRef dX() As Single, ByRef hX() As Single, dY As Single, pSubStart As Long, pSubEnd As Long)
        Dim St As String
        Dim n As Long
        Dim nWork(2) As Long
        Dim pY As Single

        With mvarParent
            Select Case Fnc.s市町村名
            Case "姶良市", "阿久根市"
                If pSubNo = pSubStart Then
                    .TextOut pNo, hX(0), dY + RowH, nFsize, 2, 0
                    .TextOut mvarPData.Data(pNo, "受付補助記号"), hX(0), dY + RowH * 3, nFsize, 2
                    If Val(mvarPData.Data(pNo, "経由法人ID")) <> 0 Then
                        .DrawText Left(mvarPData.Data(pNo, "経由法人"), 16), dX(1) + 1, dY, ColW(1) - 1, RowH, nFsize, 0
                        .DrawText Left(Fnc.GetShortAddress(mvarPData.Data(pNo, "経由法人住所"), s都道府県名, s郡部, , , True), 16), dX(1) + 1, dY + RowH * 2, ColW(1) - 1, RowH, nFsize
                        .DrawText Left(mvarPData.Data(pNo, "氏名A"), 16), dX(2) + 1, dY, ColW(2) - 1, RowH, nFsize, 0
                        .DrawText Fnc.GetShortAddress(mvarPData.Data(pNo, "住所A"), s都道府県名, s郡部, , , True), dX(2) + 1, dY + RowH * 2, ColW(5) - 1, RowH, nFsize, 0
                        .DrawText Left(mvarPData.Data(pNo, "集落A"), 8), dX(2) + 1, dY + RowH * 6, ColW(2) - 1, RowH, nFsize, 0
                        pY = dY + RowH * HMax
                        .DLine dX(1), pY - 0.5, dX(8), pY - 0.5
                        .DrawText Left(mvarPData.Data(pNo, "氏名B"), 16), dX(1) + 1, pY, ColW(1) - 1, RowH, nFsize, 0
                        .DrawText Fnc.GetShortAddress(mvarPData.Data(pNo, "住所B"), s都道府県名, s郡部, , , True), dX(1) + 1, pY + RowH * 2, ColW(1) - 1, RowH, nFsize
                        .DrawText Left(mvarPData.Data(pNo, "集落B"), 8), dX(1) + 1, pY + RowH * 6, ColW(1) - 1, RowH, nFsize
                        .DrawText Left(mvarPData.Data(pNo, "経由法人"), 16), dX(2) + 1, pY, ColW(2) - 1, RowH, nFsize, 0
                        .DrawText Left(Fnc.GetShortAddress(mvarPData.Data(pNo, "経由法人住所"), s都道府県名, s郡部, , , True), 16), dX(2) + 1, pY + RowH * 2, ColW(2) - 1, RowH, nFsize
                    Else
                        .DrawText Left(mvarPData.Data(pNo, "氏名B"), 16), dX(1) + 1, dY, ColW(1) - 1, RowH, nFsize, 0
                        .DrawText Fnc.GetShortAddress(mvarPData.Data(pNo, "住所B"), s都道府県名, s郡部, , , True), dX(1) + 1, dY + RowH * 2, ColW(1) - 1, RowH, nFsize
                        .DrawText Left(mvarPData.Data(pNo, "集落B"), 8), dX(1) + 1, dY + RowH * 6, ColW(1) - 1, RowH, nFsize
                        .DrawText Left(mvarPData.Data(pNo, "氏名A"), 16), dX(2) + 1, dY, ColW(2) - 1, RowH, nFsize, 0
                        .DrawText Fnc.GetShortAddress(mvarPData.Data(pNo, "住所A"), s都道府県名, s郡部, , , True), dX(2) + 1, dY + RowH * 2, ColW(2) - 1, RowH, nFsize, 0
                        .DrawText Left(mvarPData.Data(pNo, "集落A"), 8), dX(2) + 1, dY + RowH * 6, ColW(2) - 1, RowH, nFsize
                    End If

                    .DrawText mvarPData.Data(pNo, "権利種類"), dX(9), dY, ColW(9), RowH, nFsize, 2
                    .DrawText mvarPData.Data(pNo, "利用権内容"), dX(10), dY, ColW(10), RowH, nFsize, 2
                    .DrawText IIf(Val(mvarPData.Data(pNo, "小作料")) > 0, FormatNumber(Val(mvarPData.Data(pNo, "小作料")), IIf(InStr(mvarPData.Data(pNo, "小作料"), ".") <> 0, 2, 0)) & mvarPData.Data(pNo, "小作料単位"), ""), dX(13), dY + RowH, ColW(13), RowH, nFsize - 1, 1
                    .DrawText Left(mvarPData.Data(pNo, "再設定"), 1), dX(16), dY + 4, ColW(16), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo, "調査員"), 28), dX(17) + 1, dY, ColW(17) - 1, RowH, nFsize
                    If IsDate(mvarPData.Data(pNo, "始期")) Then .TextOut Format(CDate(mvarPData.Data(pNo, "始期")), "GE/M/D"), ColW(11) / 2 + dX(11), dY, nFsize, 2
                    .TextOut "〜", ColW(11) / 2 + dX(11), dY + 4, nFsize, 2
                    If IsDate(mvarPData.Data(pNo, "終期")) Then .TextOut Format(CDate(mvarPData.Data(pNo, "終期")), "GE/M/D"), ColW(11) / 2 + dX(11), dY + 8, nFsize, 2
                    .DrawText Format$(mvarPData.Data(pNo, "期間年"), "#,###"), dX(12), dY + 4, ColW(12), RowH, nFsize, 2
                    .DrawText mvarPData.Data(pNo, "支払方法"), dX(14), dY + 4, ColW(14), RowH, nFsize, 2
                End If
                    
                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(3) + 2, dY, ColW(3), RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(3), dY, ColW(3) - 2, RowH, nFsize, 1
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(6), dY, ColW(6) - 1, RowH, nFsize, 1
                ElseIf Val(mvarPData.Data(pNo & ":農地." & pSubNo, "一部")) = 1 Then
                    .TextOut "(" & FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0) & "の内)", dX(8) - 1, dY, nFsize - 4, 1
                Else
                    .DrawText StrConv(mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), vbNarrow), dX(3) + 1, dY, ColW(3) - 1, RowH, nFsize - 1, 0
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 1), dX(4), dY, ColW(4), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 1), dX(5), dY, ColW(5), RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(6), dY, ColW(6) - 1, RowH, nFsize, 1
                    End If
    '                    If Len(mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在")) > 0 Then
    '                        Select Case mvarPData.Data(pNo & ":農地." & pSubNo, "農振区分")
    '                            Case 1:    St = "内"
    '                            Case 2:    St = "他"
    '                            Case Else: St = "外"
    '                        End Select
    '                        .DrawText St, dX(7), dY, ColW(7), RowH, nFsize, 2
    '                        Select Case mvarPData.Data(pNo & ":農地." & pSubNo, "土地改良")
    '                            Case 1:    St = "内"
    '                            Case Else: St = "外"
    '                        End Select
    '                        .DrawText St, dX(8), dY, ColW(8), RowH, nFsize, 2
    '                    End If
                End If

            Case "枕崎市"
                If pSubNo = pSubStart Then
                    .TextOut pNo, hX(0), dY, nFsize, 2, 0
                    If Val(mvarPData.Data(pNo, "経由法人ID")) <> 0 Then
                        .DrawText Left(mvarPData.Data(pNo, "氏名A"), 10), dX(1) + 1, dY, ColW(1) - 1, RowH, nFsize, 0
                        .DrawText Left(StrConv(mvarPData.Data(pNo, "住所A"), 20), vbNarrow), dX(2) + 1, dY, ColW(2) - 1, RowH, nFsize, 0
                        .DrawText Left(mvarPData.Data(pNo, "経由法人"), 10), dX(3) + 1, dY, ColW(3) - 1, RowH, nFsize, 0
                        .DrawText Left(StrConv(mvarPData.Data(pNo, "経由法人住所"), vbNarrow), 20), dX(4) + 1, dY, ColW(4) - 1, RowH, nFsize, 0
                        pY = dY + RowH * HMax
                        .DLine dX(1), pY - 0.5, dX(5), pY - 0.5
                        .DrawText Left(mvarPData.Data(pNo, "経由法人"), 10), dX(1) + 1, pY, ColW(1) - 1, RowH, nFsize, 0
                        .DrawText Left(StrConv(mvarPData.Data(pNo, "経由法人住所"), vbNarrow), 20), dX(2) + 1, pY, ColW(2) - 1, RowH, nFsize, 0
                        .DrawText Left(mvarPData.Data(pNo, "氏名B"), 10), dX(3) + 1, pY, ColW(3) - 1, RowH, nFsize, 0
                        .DrawText Left(StrConv(mvarPData.Data(pNo, "住所B"), 20), vbNarrow), dX(4) + 1, pY, ColW(4) - 1, RowH, nFsize, 0
                    Else
                        .DrawText Left(mvarPData.Data(pNo, "氏名A"), 10), dX(1) + 1, dY, ColW(1) - 1, RowH, nFsize, 0
                        .DrawText Left(StrConv(mvarPData.Data(pNo, "住所A"), 20), vbNarrow), dX(2) + 1, dY, ColW(2) - 1, RowH, nFsize, 0
                        .DrawText Left(mvarPData.Data(pNo, "氏名B"), 10), dX(3) + 1, dY, ColW(3) - 1, RowH, nFsize, 0
                        .DrawText Left(StrConv(mvarPData.Data(pNo, "住所B"), 20), vbNarrow), dX(4) + 1, dY, ColW(4) - 1, RowH, nFsize, 0
                    End If
                    .DrawText mvarPData.Data(pNo, "権利種類"), dX(8), dY, ColW(8), RowH, nFsize, 2
                    .DrawText mvarPData.Data(pNo, "利用権内容"), dX(9), dY, ColW(9), RowH, nFsize, 2
                    .DrawText IIf(IsDate(mvarPData.Data(pNo, "始期")), Format(mvarPData.Data(pNo, "始期"), "GEE.MM.DD"), ""), dX(10), dY, ColW(10), RowH, nFsize, 2
                    .DrawText IIf(IsDate(mvarPData.Data(pNo, "終期")), Format(mvarPData.Data(pNo, "終期"), "GEE.MM.DD"), ""), dX(11), dY, ColW(11), RowH, nFsize, 2
                    .DrawText IIf(Val(mvarPData.Data(pNo, "小作料")) > 0, FormatNumber(Val(mvarPData.Data(pNo, "小作料")), 0), ""), dX(12), dY, ColW(12) - 1, RowH, nFsize, 1
                    .DrawText mvarPData.Data(pNo, "支払方法"), dX(13) + 1, dY, ColW(13) - 1, RowH, nFsize
    '                   .DrawText mvarPData.Data(pNo, "権利種類"), dX(14), dY, ColW(14), RowH, nFsize, 2
                End If
                
                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(5) + 2, dY, ColW(5), RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(5), dY, ColW(5) - 2, RowH, nFsize, 1
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(7), dY, ColW(7) - 1, RowH, nFsize, 1
                Else
                    .DrawText StrConv(mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), vbNarrow), dX(5) + 1, dY, ColW(5) - 1, RowH, nFsize, 0
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 2), dX(6), dY, ColW(6), RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(7), dY, ColW(7) - 1, RowH, nFsize, 1
                    End If
                End If

            Case "さつま町", "長島町"
                If pSubNo = pSubStart Then
                    If Val(mvarPData.Data(pNo, "経由法人ID")) <> 0 Then
                        .DrawText Left(mvarPData.Data(pNo, "経由法人"), 14), dX(0) + 1, dY, ColW(0), 4, nFsize, 0, 0
                        .DrawText Fnc.GetShortAddress(mvarPData.Data(pNo, "経由法人住所"), s都道府県名, s郡部, , , True), dX(1) + 1, dY, ColW(1), 3, nFsize - 2, 0, 0
                        
                        If sData(0) <> mvarPData.Data(pNo, "氏名A") Then
                            .DLine dX(0), dY - 1, dX(11), dY - 1
                            .DrawText mvarPData.Data(pNo, "氏名A"), dX(3) + 1, dY, ColW(3), 4, nFsize, 0, 0
                            .DrawText mvarPData.Data(pNo, "住所A"), dX(4) + 1, dY, ColW(4), 3, nFsize - 2, 0, 0
                            sData(0) = mvarPData.Data(pNo, "氏名A")
                        End If
                        
                        pY = dY + RowH * HMax
                        .DotLine dX(0), pY - 0.5, dX(5), pY - 0.5, RGB(0, 0, 0)
                        
                        If sData(1) <> mvarPData.Data(pNo, "氏名B") Then
                            .DLine dX(3), dY - 1, dX(11), dY - 1
                            .DrawText Left(mvarPData.Data(pNo, "氏名B"), 14), dX(0) + 1, pY, ColW(0), 4, nFsize, 0, 0
                            .DrawText mvarPData.Data(pNo, "住所B"), dX(1) + 1, pY, ColW(1), 3, nFsize - 2, 0, 0
                            .DrawText FormatNumber(mvarPData.Data(pNo, "経営面積B"), 0), dX(2), pY, ColW(2) - 1, 4, nFsize, 1, 0
                            .DrawText Left(mvarPData.Data(pNo, "経由法人"), 14), dX(3) + 1, pY, ColW(3), 4, nFsize, 0, 0
                            .DrawText Fnc.GetShortAddress(mvarPData.Data(pNo, "経由法人住所"), s都道府県名, s郡部, , , True), dX(4) + 1, pY, ColW(4), 3, nFsize - 2, 0, 0
                            sData(1) = mvarPData.Data(pNo, "氏名A")
                        End If
                    Else
                        If sData(2) <> mvarPData.Data(pNo, "氏名B") Then
                            .DLine dX(0), dY - 1, dX(11), dY - 1
                            .DrawText mvarPData.Data(pNo, "氏名B"), dX(0) + 1, dY, ColW(0), 4, nFsize, 0, 0
                            .DrawText mvarPData.Data(pNo, "住所B"), dX(1) + 0.5, dY, ColW(1), 3, nFsize - 2, 0, 0
                            .DrawText FormatNumber(mvarPData.Data(pNo, "経営面積B"), 0), dX(2), dY, ColW(2) - 1, 4, nFsize, 1, 0
                            sData(2) = mvarPData.Data(pNo, "氏名B")
                        End If
                        
                        If sData(3) <> mvarPData.Data(pNo, "氏名A") Then
                            .DLine dX(3), dY - 1, dX(11), dY - 1
                            .DrawText mvarPData.Data(pNo, "氏名A"), dX(3) + 1, dY, ColW(3), 4, nFsize, 0, 0
                            .DrawText mvarPData.Data(pNo, "住所A"), dX(4) + 0.5, dY, ColW(4), 3, nFsize - 2, 0, 0
                            sData(3) = mvarPData.Data(pNo, "氏名A")
                        End If
                    End If
                    

                    .DrawText IIf(Val(mvarPData.Data(pNo, "期間年")) = 0, "", mvarPData.Data(pNo, "期間年")), dX(8), dY, ColW(8), 4, nFsize, 2, 0
                    If mvarPData.Data(pNo, "権利種類") = "使用貸借" Then
                        .DrawText "使用貸借", dX(9), dY + RowH, ColW(9) - 1, 4, nFsize, 1, 0
                    Else
                        .DrawText Format$(mvarPData.Data(pNo, "小作料"), "###,#"), dX(9), dY, ColW(9) - 1, 4, nFsize, 1, 0
                        .DrawText mvarPData.Data(pNo, "小作料単位"), dX(9), dY + RowH, ColW(9) - 1, 4, nFsize, 1, 0
                    End If
                    .DrawText Left(mvarPData.Data(pNo, "再設定"), 1), dX(10), dY, ColW(10), 4, nFsize, 2, 0
                End If

                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(5) + 2, dY, ColW(5), RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(5), dY, ColW(5) - 2, RowH, nFsize, 1
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(7), dY, ColW(7) - 1, RowH, nFsize, 1
                Else
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(5) + 1, dY, ColW(5), 4, nFsize, 0, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), dX(6), dY, ColW(6), 4, nFsize, 2, 0
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        .DrawText FormatNumber(mvarPData.Data(pNo & ":農地." & pSubNo, "面積"), 0), dX(7), dY, ColW(7) - 1, 4, nFsize, 1, 0
                    End If
                End If

            Case "日置市"
                If pSubNo = pSubStart Then
                    .TextOut mvarPData.Data(pNo, "受付番号"), hX(0), dY, nFsize, 2, 0
                    If Val(mvarPData.Data(pNo, "経由法人ID")) <> 0 Then
                        n = Len(mvarPData.Data(pNo, "経由法人"))
                        .DrawText mvarPData.Data(pNo, "経由法人"), dX(1) + 1, dY, ColW(1) - 2, RowH - IIf(n <= 18, 0, 1.5), nFsize - IIf(n <= 18, 0, 2), 0
                        n = Len(mvarPData.Data(pNo, "経由法人住所"))
                        .DrawText mvarPData.Data(pNo, "経由法人住所"), dX(1) + 1, dY + RowH * 2, ColW(1) - 2, RowH - IIf(n <= 18, 0, 1.5), nFsize - IIf(n <= 18, 1, 2), 0
                        n = Len(mvarPData.Data(pNo, "氏名A"))
                        .DrawText mvarPData.Data(pNo, "氏名A"), dX(4) + 1, dY, ColW(4) - 2, RowH - IIf(n <= 18, 0, 1.5), nFsize - IIf(n <= 18, 0, 2), 0
                        n = Len(mvarPData.Data(pNo, "住所A"))
                        .DrawText mvarPData.Data(pNo, "住所A"), dX(4) + 1, dY + RowH * 2, ColW(4) - 2, RowH - IIf(n <= 18, 0, 1.5), nFsize - IIf(n <= 18, 1, 2), 0
                        .DrawText IIf(Val(mvarPData.Data(pNo, "年齢A")) <> 0, mvarPData.Data(pNo, "年齢A") & "歳", ""), dX(4) + 2, dY + RowH * 4, ColW(4) - 2, RowH, nFsize, 0
                        .DrawText FormatNumber(Val(mvarPData.Data(pNo, "経営面積A")), 0), dX(5), dY, ColW(5) - 1, RowH, nFsize, 1
                        pY = dY + RowH * HMax
                        .DLine dX(1), pY - 0.5, dX(6), pY - 0.5
                        n = Len(mvarPData.Data(pNo, "氏名B"))
                        .DrawText mvarPData.Data(pNo, "氏名B"), dX(1) + 1, pY, ColW(1) - 2, RowH - IIf(n <= 18, 0, 1.5), nFsize - IIf(n <= 18, 0, 2), 0
                        n = Len(mvarPData.Data(pNo, "住所B"))
                        .DrawText mvarPData.Data(pNo, "住所B"), dX(1) + 1, pY + RowH * 2, ColW(1) - 2, RowH - IIf(n <= 18, 0, 1.5), nFsize - IIf(n <= 18, 1, 2), 0
                        .DrawText IIf(Val(mvarPData.Data(pNo, "年齢B")) <> 0, mvarPData.Data(pNo, "年齢B") & "歳", ""), dX(1) + 2, pY + RowH * 4, ColW(1) - 2, RowH, nFsize, 0
                        .DrawText FormatNumber(Val(mvarPData.Data(pNo, "経営面積B")), 0), dX(2), pY, ColW(2) - 1, RowH, nFsize, 1
                        .DrawText Format(mvarPData.Data(pNo, "稼動人数"), "#"), dX(3), pY, ColW(3), RowH, nFsize, 2
                        n = Len(mvarPData.Data(pNo, "経由法人"))
                        .DrawText mvarPData.Data(pNo, "経由法人"), dX(4) + 1, pY, ColW(4) - 2, RowH - IIf(n <= 18, 0, 1.5), nFsize - IIf(n <= 18, 0, 2), 0
                        n = Len(mvarPData.Data(pNo, "経由法人住所"))
                        .DrawText mvarPData.Data(pNo, "経由法人住所"), dX(4) + 1, pY + RowH * 2, ColW(4) - 2, RowH - IIf(n <= 18, 0, 1.5), nFsize - IIf(n <= 18, 1, 2), 0
                    Else
                        n = Len(mvarPData.Data(pNo, "氏名B"))
                        .DrawText mvarPData.Data(pNo, "氏名B"), dX(1) + 1, dY, ColW(1) - 2, RowH - IIf(n <= 18, 0, 1.5), nFsize - IIf(n <= 18, 0, 2), 0
                        n = Len(mvarPData.Data(pNo, "住所B"))
                        .DrawText mvarPData.Data(pNo, "住所B"), dX(1) + 1, dY + RowH * 2, ColW(1) - 2, RowH - IIf(n <= 18, 0, 1.5), nFsize - IIf(n <= 18, 1, 2), 0
                        .DrawText IIf(Val(mvarPData.Data(pNo, "年齢B")) <> 0, mvarPData.Data(pNo, "年齢B") & "歳", ""), dX(1) + 2, dY + RowH * 4, ColW(1) - 2, RowH, nFsize, 0
                        .DrawText FormatNumber(Val(mvarPData.Data(pNo, "経営面積B")), 0), dX(2), dY, ColW(2) - 1, RowH, nFsize, 1
                        .DrawText mvarPData.Data(pNo, "稼動人数"), dX(3), dY, ColW(3), RowH, nFsize, 2
                        n = Len(mvarPData.Data(pNo, "氏名A"))
                        .DrawText mvarPData.Data(pNo, "氏名A"), dX(4) + 1, dY, ColW(4) - 2, RowH - IIf(n <= 18, 0, 1.5), nFsize - IIf(n <= 18, 0, 2), 0
                        n = Len(mvarPData.Data(pNo, "住所A"))
                        .DrawText mvarPData.Data(pNo, "住所A"), dX(4) + 1, dY + RowH * 2, ColW(4) - 2, RowH - IIf(n <= 18, 0, 1.5), nFsize - IIf(n <= 18, 1, 2), 0
                        .DrawText IIf(Val(mvarPData.Data(pNo, "年齢A")) <> 0, mvarPData.Data(pNo, "年齢A") & "歳", ""), dX(4) + 2, dY + RowH * 4, ColW(4) - 2, RowH, nFsize, 0
                        .DrawText FormatNumber(Val(mvarPData.Data(pNo, "経営面積A")), 0), dX(5), dY, ColW(5) - 1, RowH, nFsize, 1
                    End If
                    .DrawText mvarPData.Data(pNo, "権利種類"), dX(10) + 1, dY, ColW(10), RowH, nFsize, 0
                    If Val(mvarPData.Data(pNo, "小作料")) > 0 Then
                        .DrawText FormatNumber(Val(mvarPData.Data(pNo, "小作料")), 0) & mvarPData.Data(pNo, "小作料単位"), dX(10) + 1, dY + RowH, ColW(10), RowH, nFsize, 0
                    End If
                    If Val(mvarPData.Data(pNo, "期間年")) > 0 Then
                        .DrawText mvarPData.Data(pNo, "期間年") & "年", dX(11), dY, ColW(11), RowH, nFsize, 2
                    End If
                    .DrawText Left(mvarPData.Data(pNo, "再設定"), 1), dX(12), dY, ColW(12), RowH, nFsize, 2
                    .DrawText mvarPData.Data(pNo, "利用権内容"), dX(13), dY, ColW(13), RowH, nFsize, 2
                    .DrawText mvarPData.Data(pNo, "同意書"), dX(14), dY, ColW(14), RowH, nFsize, 2
                End If
                            
                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(6) + 2, dY, ColW(6), RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(6), dY, ColW(6) - 2, RowH, nFsize, 1
                    .TextOut FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(10) - 1, dY, nFsize, 1
                Else
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(6) + 1, dY, ColW(6) - 2, RowH, nFsize, 0
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 1), dX(7), dY, ColW(7), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 1), dX(8), dY, ColW(8), RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        .TextOut FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(10) - 1, dY, nFsize, 1, 0
                    End If
                    If mvarPData.Data(pNo, "氏名A") <> mvarPData.Data(pNo & ":農地." & pSubNo, "所有者") Then
                        .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "所有者"), 6), dX(15) + 1, dY, ColW(15), RowH, nFsize - 1
                    End If
                End If
            
            Case "三股町"
                If pSubNo = pSubStart Then
                    .TextOut mvarPData.Data(pNo, "通年受付番号"), hX(0), dY, nFsize, 2
                    St = Format(mvarPData.Data(pNo, "受付年月日"), "EEMMDD")
                    If Len(St) > 0 Then .DrawText Val(Left(St, 2)) & "\n" & Val(MID(St, 3, 2)) & "\n" & Val(MID(St, 5, 2)), dX(1), dY, ColW(1), 4, nFsize, 2
                    
                    If Val(mvarPData.Data(pNo, "経由法人ID")) <> 0 Then
                        .DrawText Left(mvarPData.Data(pNo, "経由法人"), 12), dX(2), dY, ColW(2), RowH, nFsize, 2
                        .DrawText Left(mvarPData.Data(pNo, "氏名A"), 12), dX(3), dY, ColW(3), RowH, nFsize, 2
                        n = Val(mvarPData.Data(pNo, "行政区IDA"))
                        If n <> 0 Then
                            nWork(1) = n \ 1000
                            nWork(2) = n - (n \ 1000) * 1000
                            St = "(" & CStr(nWork(1)) & "-" & Right("00" & CStr(nWork(2)), 2) & ")"
                            .DrawText St, dX(3), dY + RowH * 2, ColW(3), RowH, nFsize, 2
                        End If
                        pY = dY + RowH * HMax
                        .DLine dX(2), pY - 0.5, dX(4), pY - 0.5
                        .DrawText Left(mvarPData.Data(pNo, "氏名B"), 12), dX(2), pY, ColW(2), RowH, nFsize, 2
                        n = Val(mvarPData.Data(pNo, "行政区IDB"))
                        If n <> 0 Then
                            nWork(1) = n \ 1000
                            nWork(2) = n - (n \ 1000) * 1000
                            St = "(" & CStr(nWork(1)) & "-" & Right("00" & CStr(nWork(2)), 2) & ")"
                            .DrawText St, dX(2), pY + RowH * 2, ColW(2), RowH, nFsize, 2
                        End If
                        .DrawText Left(mvarPData.Data(pNo, "経由法人"), 12), dX(3), pY, ColW(3), RowH, nFsize, 2
                    Else
                        .DrawText Left(mvarPData.Data(pNo, "氏名B"), 12), dX(2), dY, ColW(2), RowH, nFsize, 2
                        n = Val(mvarPData.Data(pNo, "行政区IDB"))
                        If n <> 0 Then
                            nWork(1) = n \ 1000
                            nWork(2) = n - (n \ 1000) * 1000
                            St = "(" & CStr(nWork(1)) & "-" & Right("00" & CStr(nWork(2)), 2) & ")"
                            .DrawText St, dX(2), dY + RowH * 2, ColW(2), RowH, nFsize, 2
                        End If
                        .DrawText Left(mvarPData.Data(pNo, "氏名A"), 12), dX(3), dY, ColW(3), RowH, nFsize, 2
                        n = Val(mvarPData.Data(pNo, "行政区IDA"))
                        If n <> 0 Then
                            nWork(1) = n \ 1000
                            nWork(2) = n - (n \ 1000) * 1000
                            St = "(" & CStr(nWork(1)) & "-" & Right("00" & CStr(nWork(2)), 2) & ")"
                            .DrawText St, dX(3), dY + RowH * 2, ColW(3), RowH, nFsize, 2
                        End If
                    End If
                    
                    .DrawText mvarPData.Data(pNo, "権利種類"), dX(7), dY, ColW(7), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo, "利用権内容"), 9), dX(8), dY, ColW(8), RowH, nFsize, 2
                    .DrawText IIf(IsDate(mvarPData.Data(pNo, "始期")), Format(mvarPData.Data(pNo, "始期"), "GEE.MM.DD"), ""), dX(9), dY, ColW(9), RowH, nFsize, 2
                    .DrawText IIf(IsDate(mvarPData.Data(pNo, "終期")), Format(mvarPData.Data(pNo, "終期"), "GEE.MM.DD"), ""), dX(9), dY + RowH, ColW(9), RowH, nFsize, 2
                    .DrawText Format$(Val(mvarPData.Data(pNo, "小作料")), "#,###"), dX(11), dY, ColW(11), RowH, nFsize, 2
                    .DrawText IIf(Len(mvarPData.Data(pNo, "小作料単位")) > 0, "(" & mvarPData.Data(pNo, "小作料単位") & ")", ""), dX(11), dY + RowH, ColW(11), RowH, nFsize, 2
                    .DrawText FormatNumber(mvarPData.Data(pNo, "経営面積B"), 0), dX(12), dY, ColW(12) - 1, RowH, nFsize, 1
                    .DrawText Format$(Val(mvarPData.Data(pNo, "世帯員数")), "#"), dX(13), dY, ColW(13), RowH, nFsize, 2
                    .DrawText Format$(Val(mvarPData.Data(pNo, "稼動人数")), "#"), dX(14), dY, ColW(14), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo, "再設定"), 1), dX(15), dY, ColW(15), RowH, nFsize, 2
                End If

                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(4) + 2, dY, ColW(4), RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(4), dY, ColW(4) - 2, RowH, nFsize, 1
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(6), dY, ColW(6) - 1, RowH, nFsize, 1
                Else
                    .DrawText StrConv(mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), vbNarrow), dX(4) + 1, dY, ColW(4) - 1, RowH, nFsize, 0
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 3), dX(5), dY, ColW(5), RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(6), dY, ColW(6) - 1, RowH, nFsize, 1
                    End If
                End If
            
            Case "南種子町"
                If pSubNo = pSubStart Then
                    .TextOut pNo, hX(0), dY, nFsize, 2, 0
                    .DrawText Fnc.GetShortAddress(mvarPData.Data(pNo, "住所A"), s都道府県名, s郡部, , , True), dX(1) + 1, dY, ColW(1) - 1, RowH, nFsize
                    .DrawText mvarPData.Data(pNo, "氏名A"), dX(1) + 1, dY + RowH * 3, ColW(1) - 1, RowH, nFsize, 0
                    If Val(mvarPData.Data(pNo, "年齢A")) > 0 Then .DrawText mvarPData.Data(pNo, "年齢A"), dX(2), dY, ColW(2), RowH, nFsize, 2
                    .DrawText Format$(mvarPData.Data(pNo, "経営面積A"), "#,##0"), dX(3), dY, ColW(3) - 1, RowH, nFsize, 1
                    
                    pY = dY
                    If Val(mvarPData.Data(pNo, "経由法人ID")) <> 0 Then
                        .DrawText Left(Fnc.GetShortAddress(mvarPData.Data(pNo, "経由法人住所"), s都道府県名, s郡部, , , True), 14), dX(4) + 1, pY, ColW(4) - 1, RowH, nFsize
                        .DrawText Left(mvarPData.Data(pNo, "経由法人"), 14), dX(4) + 1, pY + RowH * 2, ColW(4) - 1, RowH, nFsize, 0
                        pY = pY + RowH * HMax
                        .DLine dX(1), pY - 0.5, dX(7), pY - 0.5
                        .DrawText Left(Fnc.GetShortAddress(mvarPData.Data(pNo, "経由法人住所"), s都道府県名, s郡部, , , True), 14), dX(1) + 1, pY, ColW(1) - 1, RowH, nFsize
                        .DrawText Left(mvarPData.Data(pNo, "経由法人"), 14), dX(1) + 1, pY + RowH * 2, ColW(1) - 1, RowH, nFsize, 0
                    End If
                    .DrawText Fnc.GetShortAddress(mvarPData.Data(pNo, "住所B"), s都道府県名, s郡部, , , True), dX(4) + 1, pY, ColW(4) - 1, RowH, nFsize
                    .DrawText mvarPData.Data(pNo, "氏名B"), dX(4) + 1, pY + RowH * 3, ColW(4) - 1, RowH, nFsize, 0
                    If Val(mvarPData.Data(pNo, "年齢B")) > 0 Then .DrawText mvarPData.Data(pNo, "年齢B"), dX(5), pY, ColW(5), RowH, nFsize, 2
                    .DrawText Format$(mvarPData.Data(pNo, "経営面積B"), "#,##0"), dX(6), pY, ColW(6) - 1, RowH, nFsize, 1
                    If mvarPData.Data(pNo, "法令") = state基盤利用権移転 Then
                        .DrawText Left(mvarPData.Data(pNo, "支払方法"), 24), dX(14), dY, ColW(14), RowH, nFsize, 2
                        St = ""
                        If Val(mvarPData.Data(pNo, "期間年")) > 0 Then St = mvarPData.Data(pNo, "期間年") & "年"
                        If Val(mvarPData.Data(pNo, "期間月")) > 0 Then St = IIf(Len(St), St & "\n" & mvarPData.Data(pNo, "期間月") & "ヶ月", mvarPData.Data(pNo, "期間月") & "ヶ月")
                        .DrawText St, dX(15), dY, ColW(15), RowH, nFsize, 2
                    End If
                    .DrawText Left(mvarPData.Data(pNo, "備考"), 20), dX(17) + 1, dY, ColW(17) - 1, RowH, nFsize, 0
                End If
                    
                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(7) + 2, dY, ColW(7), RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(7), dY, ColW(7) - 2, RowH, nFsize, 1
                    .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(10), dY, ColW(10) - 1, RowH, nFsize, 1
                Else
                    .DrawText StrConv(mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), vbNarrow), dX(7) + 1, dY, ColW(7) - 1, RowH, nFsize - 1, 0
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 2), dX(8), dY, ColW(8), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 2), dX(9), dY, ColW(9), RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        .DrawText FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(10), dY, ColW(10) - 1, RowH, nFsize, 1
                    End If
    '                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "利用状況"), 6), dX(11), dY, ColW(11), RowH, nFsize - IIf(Len(mvarPData.Data(pNo & ":農地." & pSubNo, "利用状況")) > 5, 1, 0), 2
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "利用権内容"), 6), dX(11), dY, ColW(11), RowH, nFsize - IIf(Len(mvarPData.Data(pNo & ":農地." & pSubNo, "利用権内容")) > 5, 1, 0), 2
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "小作形態"), 4), dX(12), dY, ColW(12), RowH, nFsize, 2
                    If Len(mvarPData.Data(pNo & ":農地." & pSubNo, "小作料")) > 0 Then .DrawText Format(mvarPData.Data(pNo & ":農地." & pSubNo, "小作料"), "#,##0") & mvarPData.Data(pNo & ":農地." & pSubNo, "小作料単位"), dX(13), dY, ColW(13) - 1, RowH, nFsize, 1
'                    If Len(mvarPData.Data(pNo & ":農地." & pSubNo, "小作料")) > 0 Then .DrawText Format(mvarPData.Data(pNo & ":農地." & pSubNo, "小作料"), "#,##0") & "", dX(13), dY, ColW(13) - 1, RowH, nFsize, 1
                    
                    If mvarPData.Data(pNo, "法令") = state基盤利用権設定 Then
                        .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "支払方法"), 5), dX(14), dY, ColW(14), RowH, nFsize, 2
                        If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "期間")) > 0 Then .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "期間"), dX(15), dY, ColW(15), RowH, nFsize, 2
                        .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "設定内容"), 1), dX(16), dY, ColW(16), RowH, nFsize, 2
                    End If
                End If
            Case Else '"大崎町"
                If pSubNo = pSubStart Then
                    .TextOut pNo, hX(0), dY, nFsize, 2, 0
                    If Val(mvarPData.Data(pNo, "経由法人ID")) <> 0 Then
                        .DrawText Left(mvarPData.Data(pNo, "経由法人"), 24), dX(1) + 1, dY, ColW(1) - 1, RowH, nFsize, 0
                        .DrawText Left(Fnc.GetShortAddress(mvarPData.Data(pNo, "経由法人住所"), s都道府県名, s郡部, , , True), 16), dX(1) + 1, dY + RowH * 2, ColW(1) - 1, RowH, nFsize, 0
                        .DrawText Left(mvarPData.Data(pNo, "氏名A"), 24), dX(4) + 1, dY, ColW(4) - 1, RowH, nFsize, 0
                        If Len(mvarPData.Data(pNo, "集落A")) = 0 Or mvarPData.Data(pNo, "集落A") = "-" Then
                            .DrawText Left(Fnc.GetShortAddress(mvarPData.Data(pNo, "住所A"), s都道府県名, s郡部, , , True), 16), dX(4) + 1, dY + RowH * 3, ColW(4) - 1, RowH, nFsize, 0
                        Else
                            .DrawText Left(mvarPData.Data(pNo, "集落A"), 16), dX(4) + 1, dY + RowH * 3, ColW(4) - 1, RowH, nFsize, 0
                        End If
                        .DrawText Left(mvarPData.Data(pNo, "職業A"), 6), dX(4) + 1, dY + RowH * 5, ColW(4) - 1, RowH, nFsize
                        .DrawText IIf(Val(mvarPData.Data(pNo, "年齢A")) = 0, "", mvarPData.Data(pNo, "年齢A") & "歳"), dX(4), dY + RowH * 5, ColW(4) - 1, RowH, nFsize, 1
                        .DrawText FormatNumber(Val(mvarPData.Data(pNo, "経営面積A")), 0), dX(5), dY, ColW(5) - 1, RowH, nFsize, 1
                        .DrawText Left(mvarPData.Data(pNo, "申請理由A"), 12), dX(6), dY, ColW(6), RowH, nFsize, 2
                        pY = dY + RowH * HMax
                        .DLine dX(1), pY - 0.5, dX(7), pY - 0.5
                        .DrawText Left(mvarPData.Data(pNo, "氏名B"), 24), dX(1) + 1, pY, ColW(1) - 1, RowH, nFsize, 0
                        If Len(mvarPData.Data(pNo, "集落B")) = 0 Or mvarPData.Data(pNo, "集落B") = "-" Then
                            .DrawText Left(Fnc.GetShortAddress(mvarPData.Data(pNo, "住所B"), s都道府県名, s郡部, , , True), 16), dX(1) + 1, pY + RowH * 3, ColW(1) - 1, RowH, nFsize, 0
                        Else
                            .DrawText Left(mvarPData.Data(pNo, "集落B"), 16), dX(1) + 1, pY + RowH * 3, ColW(1) - 1, RowH, nFsize, 0
                        End If
                        .DrawText Left(mvarPData.Data(pNo, "職業B"), 6), dX(1) + 1, pY + RowH * 5, ColW(1) - 1, RowH, nFsize, 0
                        .DrawText IIf(Val(mvarPData.Data(pNo, "年齢B")) = 0, "", mvarPData.Data(pNo, "年齢B") & "歳"), dX(1), pY + RowH * 5, ColW(1) - 1, RowH, nFsize, 1
                        .DrawText FormatNumber(Val(mvarPData.Data(pNo, "経営面積B")), 0), dX(2), pY, ColW(2) - 1, RowH, nFsize, 1
                        .DrawText Format(mvarPData.Data(pNo, "稼動人数"), "#"), dX(3), pY, ColW(3), RowH, nFsize, 2
                        .DrawText Left(mvarPData.Data(pNo, "経由法人"), 24), dX(4) + 1, pY, ColW(4) - 1, RowH, nFsize, 0
                        .DrawText Left(Fnc.GetShortAddress(mvarPData.Data(pNo, "経由法人住所"), s都道府県名, s郡部, , , True), 16), dX(4) + 1, pY + RowH * 2, ColW(4) - 1, RowH, nFsize, 0
                    Else
                        .DrawText Left(mvarPData.Data(pNo, "氏名B"), 24), dX(1) + 1, dY, ColW(1) - 1, RowH, nFsize, 0
                        If Len(mvarPData.Data(pNo, "集落B")) = 0 Or mvarPData.Data(pNo, "集落B") = "-" Then
                            .DrawText Left(Fnc.GetShortAddress(mvarPData.Data(pNo, "住所B"), s都道府県名, s郡部, , , True), 16), dX(1) + 1, dY + RowH * 3, ColW(1) - 1, RowH, nFsize, 0
                        Else
                            .DrawText Left(mvarPData.Data(pNo, "集落B"), 16), dX(1) + 1, dY + RowH * 3, ColW(1) - 1, RowH, nFsize, 0
                        End If
                        .DrawText Left(mvarPData.Data(pNo, "職業B"), 6), dX(1) + 1, dY + RowH * 5, ColW(1) - 1, RowH, nFsize, 0
                        .DrawText IIf(Val(mvarPData.Data(pNo, "年齢B")) = 0, "", mvarPData.Data(pNo, "年齢B") & "歳"), dX(1), dY + RowH * 5, ColW(1) - 1, RowH, nFsize, 1
                        .DrawText FormatNumber(Val(mvarPData.Data(pNo, "経営面積B")), 0), dX(2), dY, ColW(2) - 1, RowH, nFsize, 1
                        .DrawText Format(mvarPData.Data(pNo, "稼動人数"), "#"), dX(3), dY, ColW(3), RowH, nFsize, 2
    
                        .DrawText Left(mvarPData.Data(pNo, "氏名A"), 24), dX(4) + 1, dY, ColW(4) - 1, RowH, nFsize, 0, , RowH * 3
                        If Len(mvarPData.Data(pNo, "集落A")) = 0 Or mvarPData.Data(pNo, "集落A") = "-" Then
                            .DrawText Left(Fnc.GetShortAddress(mvarPData.Data(pNo, "住所A"), s都道府県名, s郡部, , , True), 16), dX(4) + 1, dY + RowH * 3, ColW(4) - 1, RowH, nFsize, 0
                        Else
                            .DrawText Left(mvarPData.Data(pNo, "集落A"), 16), dX(4) + 1, dY + RowH * 3, ColW(4) - 1, RowH, nFsize, 0
                        End If
                        .DrawText Left(mvarPData.Data(pNo, "職業A"), 6), dX(4) + 1, dY + RowH * 5, ColW(4) - 1, RowH, nFsize
                        .DrawText IIf(Val(mvarPData.Data(pNo, "年齢A")) = 0, "", mvarPData.Data(pNo, "年齢A") & "歳"), dX(4), dY + RowH * 5, ColW(4) - 1, RowH, nFsize, 1
                        .DrawText FormatNumber(Val(mvarPData.Data(pNo, "経営面積A")), 0), dX(5), dY, ColW(5) - 1, RowH, nFsize, 1
                        .DrawText Left(mvarPData.Data(pNo, "申請理由A"), 12), dX(6), dY, ColW(6), RowH, nFsize, 2
                    End If
                    
                    If Len(mvarPData.Data(pNo, "権利種類")) > 0 And mvarPData.Data(pNo, "権利種類") <> "-" Then .DrawText mvarPData.Data(pNo, "権利種類"), dX(12), dY, ColW(12), RowH, nFsize, 2
                    If Len(mvarPData.Data(pNo, "小作料")) > 0 Then .DrawText mvarPData.Data(pNo, "小作料") & mvarPData.Data(pNo, "小作料単位"), dX(12), dY + RowH * 2, ColW(12), RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo, "期間年")) > 0 Then .DrawText mvarPData.Data(pNo, "期間年"), dX(13), dY, ColW(13), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo, "再設定"), 1), dX(14), dY, ColW(14), RowH, nFsize, 2
                    If IsDate(mvarPData.Data(pNo, "始期")) Then .TextOut Format(CDate(mvarPData.Data(pNo, "始期")), "GEE/MM/DD"), ColW(16) / 2 + dX(16), dY, nFsize, 2
                    If mvarPData.Data(pNo, "始期") <> "" Or mvarPData.Data(pNo, "終期") <> "" Then .TextOut "〜", ColW(16) / 2 + dX(16), dY + RowH, nFsize, 2
                    If IsDate(mvarPData.Data(pNo, "終期")) Then .TextOut Format(CDate(mvarPData.Data(pNo, "終期")), "GEE/MM/DD"), ColW(16) / 2 + dX(16), dY + RowH * 2, nFsize, 2
                End If
                    
                If mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目") = "99999" Then
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(7) + 2, dY, ColW(7), RowH, nFsize, 0
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目") & " 筆", dX(7), dY, ColW(7) - 2, RowH, nFsize, 1
                    .TextOut FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(11) - 1, dY, nFsize, 1
                ElseIf Val(mvarPData.Data(pNo & ":農地." & pSubNo, "一部")) = 1 Then
                    .TextOut "(" & FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0) & "の内)", dX(11) - 1, dY, nFsize - 2, 1
                Else
                    .DrawText mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在"), dX(7) + 1, dY, ColW(7) - 2, RowH, nFsize, 0
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "登記地目"), 1), dX(8), dY, ColW(8), RowH, nFsize, 2
                    .DrawText Left(mvarPData.Data(pNo & ":農地." & pSubNo, "現況地目"), 1), dX(9), dY, ColW(9), RowH, nFsize, 2
                    If Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")) <> 0 Then
                        .TextOut FormatNumber(Val(mvarPData.Data(pNo & ":農地." & pSubNo, "面積")), 0), dX(11) - 1, dY, nFsize, 1, 0
                    End If
                    If Len(mvarPData.Data(pNo & ":農地." & pSubNo, "土地所在")) > 0 Then
                        Select Case mvarPData.Data(pNo & ":農地." & pSubNo, "農振区分")
                            Case 1:    St = "地内"
                            Case 2:    St = "振外"
                            Case Else: St = "地外"
                        End Select
                        .DrawText St, dX(11), dY, ColW(11), RowH, nFsize, 2
                    End If
               End If
               
               If (pSubNo = pSubEnd) And Len(mvarPData.Data(pNo, "調査員")) Then
                    .DrawText Left(mvarPData.Data(pNo, "調査員"), 5), dX(16), dY, ColW(16), RowH, nFsize, 2
               End If
            End Select
        End With
    End Sub
    
    Private Sub PrintSubTotal(ByRef mvarParent As ADBasicLIB2.CPrintFormSK, ByRef dX() As Single, ByRef hX() As Single, dY As Single)
        Dim n As Long
        Dim i As Single
        Dim wdy As Single
        Dim Xcnt As Long
        Dim nArea(5) As Double
        Dim nWork(2) As Long
        Dim sWork(2) As String
        
        If T総合計.n筆数(4) = 0 Then Exit Sub
        wdy = dY
        Xcnt = UBound(ColW) + 1
                
        With mvarParent
            Select Case Fnc.s市町村名
            Case "姶良市", "阿久根市"
                For n = 0 To 4
                    If T総合計.n筆数(n) > 0 Then
                        .DrawText T総合計.s地目(n), dX(4) + 2, dY, ColW(3), RowH, nFsize
                        .DrawText T総合計.n筆数(n) & " 筆", dX(3), dY, ColW(3) - 2, RowH, nFsize, 1
                        .DrawText FormatNumber(Val(T総合計.n面積(n)), 0), dX(6), dY, ColW(6) - 1, RowH, nFsize, 1
                        dY = dY + RowH
                    End If
                Next
                .DrawText "［　総　合　計　］", dX(0), (dY + wdy) / 2, dX(3) - dX(0), RowH, nFsize, 2, 2
                .DLine dX(0), wdy - 1, dX(0), dY
                .DLine dX(3), wdy - 1, dX(3), dY
                .DLine dX(4), wdy - 1, dX(4), dY
                .DLine dX(7), wdy - 1, dX(7), dY
                .DLine dX(Xcnt), wdy - 1, dX(Xcnt), dY
                .DLine dX(0), dY, dX(Xcnt), dY

             Case "三股町"
                For n = 0 To 4
                    If T総合計.n筆数(n) > 0 Then
                        .DrawText T総合計.s地目(n), dX(4) + 2, dY, ColW(4), RowH, nFsize
                        .DrawText T総合計.n筆数(n) & " 筆", dX(4), dY, ColW(4) - 2, RowH, nFsize, 1
                        .DrawText FormatNumber(Val(T総合計.n面積(n)), 0), dX(6), dY, ColW(6) - 1, RowH, nFsize, 1
                        dY = dY + RowH
                    End If
                Next
                .DrawText "［ 総 合 計 ］", dX(0), wdy + (dY - wdy) / 2, dX(4) - dX(0), RowH, nFsize, 2, 2
                .DLine dX(0), wdy - 1, dX(0), dY
                .DLine dX(4), wdy - 1, dX(4), dY
                .DLine dX(5), wdy - 1, dX(5), dY
                .DLine dX(7), wdy - 1, dX(7), dY
                .DLine dX(Xcnt), wdy - 1, dX(Xcnt), dY
                .DLine dX(0), dY, dX(Xcnt), dY

            Case "南種子町"
                wdy = wdy - 1
                .TextOut "人", dX(2) - 2, wdy + 2, nFsize, 1, 0
                .TextOut "(         )", hX(1), wdy + 8, nFsize, 2, 2
                .TextOut "人", dX(5) - 2, wdy + 2, nFsize, 1, 0
                .TextOut "(         )", hX(4), wdy + 8, nFsize, 2, 2
                .TextOut "u", dX(11) - 2, wdy + 2, nFsize, 1, 0
                .TextOut "田", dX(11) + 10, wdy + 4, nFsize, 2, 2
                .TextOut "u", dX(11) + 45, wdy + 1, nFsize, 1, 0
                .TextOut "樹園地", dX(11) + 57, wdy + 4, nFsize, 2, 2
                .TextOut "u", dX(Xcnt) - 2, wdy + 1, nFsize, 1, 0
                .TextOut "畑", dX(11) + 10, wdy + 12, nFsize, 2, 2
                .TextOut "u", dX(11) + 45, wdy + 9, nFsize, 1, 0
                .TextOut "その他", dX(11) + 57, wdy + 12, nFsize, 2, 2
                .TextOut "u", dX(Xcnt) - 2, wdy + 9, nFsize, 1, 0
                i = wdy + 16
                For n = 0 To 7
                    .DLine dX(n), wdy, dX(n), i
                Next
                .DLine dX(11), wdy, dX(11), i
                .DLine dX(11) + 20, wdy, dX(11) + 20, i
                .DLine dX(11) + 47, wdy, dX(11) + 47, i
                .DLine dX(11) + 67, wdy, dX(11) + 67, i
                .DLine dX(Xcnt), wdy, dX(Xcnt), i
                .DLine dX(11), wdy + 8, dX(Xcnt), wdy + 8
                .DLine dX(0), wdy + 16, dX(Xcnt), wdy + 16

                For n = 0 To 5: nArea(n) = 0: Next
                nWork(0) = 0: nWork(1) = 0
                sWork(0) = ";": sWork(1) = ";"
                With mvarPData
                    For n = 1 To .Count
                        Select Case .Data(n, "法令")
                            Case "61":
                                If InStr(sWork(0), .Data(n, "氏名A")) = 0 Then nWork(0) = nWork(0) + 1: sWork(0) = sWork(0) & .Data(n, "氏名A") & ";"
                                If InStr(sWork(1), .Data(n, "氏名B")) = 0 Then nWork(1) = nWork(1) + 1: sWork(1) = sWork(1) & .Data(n, "氏名B") & ";"
                            Case "62":
                                nWork(0) = nWork(0) + 1
                                nWork(1) = nWork(1) + 1
                        End Select
                        nArea(1) = nArea(1) + Val(.Data(n, "田面積"))
                        nArea(2) = nArea(2) + Val(.Data(n, "畑面積"))
                        nArea(3) = nArea(3) + Val(.Data(n, "樹園面積"))
                        nArea(4) = nArea(4) + Val(.Data(n, "他面積"))
                    Next
                End With
                .TextOut nWork(0), hX(1), wdy + 8, nFsize, 2, 2
                .TextOut nWork(1), hX(4), wdy + 8, nFsize, 2, 2
                .TextOut FormatNumber(nArea(1) + nArea(2) + nArea(3) + nArea(4), 0), dX(11) - 10, wdy + 8, nFsize, 1, 2
                .TextOut IIf(nArea(1) = 0, "−", FormatNumber(nArea(1), 0)), dX(11) + 39, wdy + 4, nFsize, 1, 2
                .TextOut IIf(nArea(2) = 0, "−", FormatNumber(nArea(2), 0)), dX(11) + 39, wdy + 12, nFsize, 1, 2
                .TextOut IIf(nArea(3) = 0, "−", FormatNumber(nArea(3), 0)), dX(Xcnt) - 8, wdy + 4, nFsize, 1, 2
                .TextOut IIf(nArea(4) = 0, "−", FormatNumber(nArea(4), 0)), dX(Xcnt) - 8, wdy + 12, nFsize, 1, 2
            End Select
        End With
    End Sub
    
    Private Sub CPrintSub_SetData(ByVal sKey As String, Optional ByVal sParam1 As String = "", Optional ByVal sParam2 As String = "")
        Dim n As Long, i As Long, W As Long
        Dim pData(100) As dt総括表
        Dim pDataS As dt総括表
        Dim dbWork As Double
        Dim bFlag As Boolean
        Dim T As Single
        Dim sWork(100) As String
        Dim nArea(10) As Double
        Dim nWork(10) As Long
        
        If mvarPData.Count = 0 Then Exit Sub
        For i = 0 To 100: pData(i).n期間年 = (-1): Next
        For i = 0 To 4: sWork(i) = "": Next
        For i = 0 To 100
            T総括(i).s公告日 = ""
            T総括(i).s始期 = ""
            T総括(i).s終期 = ""
            T総括(i).n期間年 = 0
            T総括(i).n期間月 = 0
            For n = 0 To 10: T総括(i).n面積(n) = 0: Next
            For n = 0 To 5: T総括(i).n人数(n) = 0: Next
        Next
        If 1 Then
        End If

        If b総合計出力 Then
            If DataCnt + 3 > LMax Then
                mvarMaxPage = mvarMaxPage + 1
            End If
        End If


        With mvarPData
            For n = 1 To .Count
                ' 出力データ作成・集計
                bFlag = False
                For i = 0 To 100
                    If pData(i).n期間年 = Val(.Data(n, "期間年")) And pData(i).n期間月 = Val(.Data(n, "期間月")) And pData(i).s公告日 = .Data(n, "公告日") And pData(i).s始期 = .Data(n, "始期") Then
                        pData(i).n面積(0) = pData(i).n面積(0) + Val(.Data(n, "田面積"))
                        pData(i).n面積(1) = pData(i).n面積(1) + Val(.Data(n, "畑面積"))
                        pData(i).n面積(2) = pData(i).n面積(2) + Val(.Data(n, "樹園面積"))
                        pData(i).n面積(3) = pData(i).n面積(3) + Val(.Data(n, "他面積"))
                        dbWork = Val(.Data(n, "田面積")) + Val(.Data(n, "畑面積")) + Val(.Data(n, "樹園面積")) + Val(.Data(n, "他面積"))
                        pData(i).n面積(4) = pData(i).n面積(4) + dbWork
                        If .Data(n, "再設定") = "再設定" Then pData(i).n面積(5) = pData(i).n面積(5) + dbWork
                        Sub人数カウント pData(i), sWork, n
                        bFlag = True
                        Exit For
                    End If
                Next
                If bFlag = False Then
                    For i = 0 To 100
                        If pData(i).n期間年 = (-1) Then Exit For
                    Next
                    If i > 10 Then Exit For
                    pData(i).s公告日 = .Data(n, "公告日")
                    pData(i).s始期 = .Data(n, "始期")
                    pData(i).s終期 = .Data(n, "終期")
                    pData(i).n期間年 = Val(.Data(n, "期間年"))
                    pData(i).n期間月 = Val(.Data(n, "期間月"))
                    pData(i).n面積(0) = pData(i).n面積(0) + Val(.Data(n, "田面積"))
                    pData(i).n面積(1) = pData(i).n面積(1) + Val(.Data(n, "畑面積"))
                    pData(i).n面積(2) = pData(i).n面積(2) + Val(.Data(n, "樹園面積"))
                    pData(i).n面積(3) = pData(i).n面積(3) + Val(.Data(n, "他面積"))
                    dbWork = Val(.Data(n, "田面積")) + Val(.Data(n, "畑面積")) + Val(.Data(n, "樹園面積")) + Val(.Data(n, "他面積"))
                    pData(i).n面積(4) = pData(i).n面積(4) + dbWork
                    If .Data(n, "再設定") = "再設定" Then pData(i).n面積(5) = pData(i).n面積(5) + dbWork
                    Sub人数カウント pData(i), sWork, n
                End If
            Next
        End With

        ' 期間・公告日・始期順ソート
        For n = 0 To 100
            For i = 0 To 99
                If pData(i).n期間年 > pData(i + 1).n期間年 Then
                    pDataS = pData(i)
                    pData(i) = pData(i + 1)
                    pData(i + 1) = pDataS
                ElseIf pData(i).n期間年 = pData(i + 1).n期間年 Then
                    If pData(i).n期間月 > pData(i + 1).n期間月 Then
                        pDataS = pData(i)
                        pData(i) = pData(i + 1)
                        pData(i + 1) = pDataS
                    ElseIf pData(i).n期間月 = pData(i + 1).n期間月 Then
                        If IsDate(pData(i).s公告日) And IsDate(pData(i + 1).s公告日) Then
                            If CDate(pData(i).s公告日) > CDate(pData(i + 1).s公告日) Then
                                pDataS = pData(i)
                                pData(i) = pData(i + 1)
                                pData(i + 1) = pDataS
                            ElseIf pData(i).s公告日 = pData(i + 1).s公告日 Then
                                If IsDate(pData(i).s始期) And IsDate(pData(i + 1).s始期) Then
                                    If CDate(pData(i).s始期) > CDate(pData(i + 1).s始期) Then
                                        pDataS = pData(i)
                                        pData(i) = pData(i + 1)
                                        pData(i + 1) = pDataS
                                    End If
                                End If
                            End If
                        ElseIf IsDate(pData(i).s始期) And IsDate(pData(i + 1).s始期) Then
                            If CDate(pData(i).s始期) > CDate(pData(i + 1).s始期) Then
                                pDataS = pData(i)
                                pData(i) = pData(i + 1)
                                pData(i + 1) = pDataS
                            End If
                        End If
                    End If
                End If
            Next
        Next
        
        For i = 0 To 5: nArea(i) = 0: Next
        For i = 0 To 3: nWork(i) = 0: Next
        For n = 0 To 100
            If pData(n).n期間年 <> (-1) Then
                T総括(W) = pData(n)
                For i = 0 To 5
                    nArea(i) = nArea(i) + pData(n).n面積(i)
                Next
                For i = 0 To 3
                    nWork(i) = nWork(i) + pData(n).n人数(i)
                Next
                W = W + 1
            End If
        Next
        
        For i = 0 To 5: T総括(W).n面積(i) = nArea(i): Next
        For i = 0 To 3: T総括(W).n人数(i) = nWork(i): Next
        総括Cnt = W
        総括Page = 総括Cnt \ 8 + IIf((総括Cnt Mod 8) > 0, 1, 0)
    End Sub
    
    Private Sub Sub人数カウント(ByRef pData As dt総括表, ByRef sWork() As String, pNo As Long)

        With mvarPData
            If Fnc.s市町村名 = "南種子町" Then
                ' 「利用権設定」は同じ人をカウントしないが「利用権移転」ではカウントする
                Select Case .Data(pNo, "法令")
                    Case "61":
                        Set人数 sWork(0), .Data(pNo, "氏名A"), pData.n人数(0)
                        Set人数 sWork(2), .Data(pNo, "氏名B"), pData.n人数(2)
                        If .Data(pNo, "再設定") = "再設定" Then
                            Set人数 sWork(1), .Data(pNo, "氏名A"), pData.n人数(1)
                            Set人数 sWork(3), .Data(pNo, "氏名B"), pData.n人数(3)
                        End If
                    Case "62":
                        pData.n人数(0) = pData.n人数(0) + 1
                        pData.n人数(2) = pData.n人数(2) + 1
                        If .Data(pNo, "再設定") = "再設定" Then
                            pData.n人数(1) = pData.n人数(1) + 1
                            pData.n人数(3) = pData.n人数(3) + 1
                        End If
                End Select
            ElseIf Fnc.s市町村名 = "さつま町" Or Fnc.s市町村名 = "長島町" Then
                Select Case .Data(pNo, "法令")
                    Case "61":
                ' 「利用権設定」は同じ人をカウントしない
                        Set人数 sWork(0), .Data(pNo, "氏名A"), pData.n人数(0)
                        Set人数 sWork(2), .Data(pNo, "氏名B"), pData.n人数(2)
                        If .Data(pNo, "再設定") = "再設定" Then
                            Set人数 sWork(1), .Data(pNo, "氏名A"), pData.n人数(1)
                            Set人数 sWork(3), .Data(pNo, "氏名B"), pData.n人数(3)
                        End If
                    Case "62":
                        ' 同じ人でも件数分カウントする
                        pData.n人数(0) = pData.n人数(0) + 1
                        pData.n人数(2) = pData.n人数(2) + 1
                        If .Data(pNo, "再設定") = "再設定" Then
                            pData.n人数(1) = pData.n人数(1) + 1
                            pData.n人数(3) = pData.n人数(3) + 1
                        End If
                End Select
            Else
                ' 同じ人でも件数分カウントする
                pData.n人数(0) = pData.n人数(0) + 1
                pData.n人数(2) = pData.n人数(2) + 1
                If .Data(pNo, "再設定") = "再設定" Then
                    pData.n人数(1) = pData.n人数(1) + 1
                    pData.n人数(3) = pData.n人数(3) + 1
                End If
            End If
        End With
    End Sub
    
    Private Sub Set人数(ByRef pStr1 As String, ByRef pStr2 As String, ByRef pCount As Long)
        If InStr(pStr1, pStr2) = 0 Then
            pCount = pCount + 1
            pStr1 = pStr1 & pStr2 & ";"
        End If
    End Sub

    Private Sub Class_Initialize()
        Dim n As Long
        Dim Rs As ADBasicLIB2.RecordsetEx
        
        Set mvarPData = New CPrintDatas
        mvarPData.Headers = _
        "法令;受付番号;受付補助記号;通年受付番号;受付年月日;調査員;" & _
        "氏名A;住所A;年齢A;職業A;集落A;行政区IDA;経営面積A;申請理由A;" & _
        "氏名B;住所B;年齢B;職業B;集落B;行政区IDB;経営面積B;申請理由B;稼動人数;世帯員数;同意書;" & _
        "経由法人ID;経由法人;経由法人住所;" & _
        "権利種類;利用権内容;期間年;期間月;再設定;小作料;小作料単位;支払方法;備考;" & _
        "田筆;畑筆;樹園筆;他筆;田面積;畑面積;樹園面積;他面積;公告日;始期;終期;他地目;" & _
        ">農地;土地所在;登記地目;現況地目;面積;等級;所有者;農振区分;利用状況;小作形態;設定内容;利用権内容;支払方法;小作料;小作料単位;期間;都市計画;土地改良;一部;"
                   
        mvarNowPage = 1
        For n = 0 To PGMAX
            PgChgSt(n) = 0
            PgChgEn(n) = 0
        Next
        DataCnt = 0
        PageCnt = 0
        mvarMaxPage = 0
        総括Page = 0
        総括Cnt = 0
        s支所 = ""
        
        For n = 0 To 4
            T総合計.s地目(n) = ""
            T総合計.n筆数(n) = 0
            T総合計.n面積(n) = 0
        Next
        
        Set Rs = SystemDB.GetRecordsetEx("SELECT ID,名称 FROM [M_BASICALL] WHERE [Class]='支所番号'", 0, , Me)
        Do Until Rs.EOF
            p支所番号.Add Rs.Value("ID"), Rs.Value("名称")
            Rs.MoveNext
        Loop
        SystemDB.CloseRs Rs
    
        b総括表出力 = False
        Select Case Fnc.s市町村名
            Case "姶良市"
                LMax = 32
                HMax = 7
                ColW = GetArray(8, 40, 40, 56, 5, 5, 16, 0, 0, 6, 6, 20, 6, 25, 15, 0, 6, 19)
                StartX = 10
                StartY = 46

                Call mvarTB.SetSize(StartX, 25, 8, 40, 40, 56, 5, 5, 16, 0, 0, 6, 6, 20, 6, 25, 15, 0, 6, 19)
                nFsize = 11                    '8, 40, 40, 56, 5, 5, 16, 0, 0, 6, 6, 20, 6, 25, 15, 0, 6, 19
                Call mvarTB.SetColumHeader(21, nFsize, "番\n号", , , "土 地 の 所 在")
                RowH = 4
                mvarTB.RowH = RowH
                mvarTB.RowHeight = 4
                mvarTB.SetFontSize nFsize
                b総合計出力 = True
                b総括表出力 = True
            Case "阿久根市":
                LMax = 32
                HMax = 7
                ColW = GetArray(8, 40, 40, 56, 5, 5, 16, 0, 0, 6, 6, 20, 6, 25, 15, 0, 6, 19)
                StartX = 10
                StartY = 46

                Call mvarTB.SetSize(StartX, 25, 8, 40, 40, 56, 5, 5, 16, 0, 0, 6, 6, 20, 6, 25, 15, 0, 6, 19)
                nFsize = 11                    '8, 40, 40, 56, 5, 5, 16, 0, 0, 6, 6, 20, 6, 25, 15, 0, 6, 19
                Call mvarTB.SetColumHeader(21, nFsize, "番\n号", , , "土 地 の 所 在")
                RowH = 4
                mvarTB.RowH = RowH
                mvarTB.RowHeight = 4
                mvarTB.SetFontSize nFsize
                b総合計出力 = True
                b総括表出力 = True
            Case "枕崎市":
                LMax = 50
                HMax = 2
                nFsize = 8
                RowH = 3
                StartX = 10
                StartY = 28
                ColW = GetArray(8, 17, 32, 17, 32, 44, 8, 12, 16, 10, 15, 15, 14, 18, 16)
                b総括表出力 = True

            Case "南種子町":
                LMax = 32
                HMax = 6
                ColW = GetArray(9, 24, 8, 15, 24, 8, 15, 36, 7, 7, 14, 20, 14, 20, 14, 12, 8, 18)
                StartX = 15
                StartY = 45
                nFsize = 9
                RowH = 4
                b総括表出力 = True
                
            Case "さつま町", "長島町":
                LMax = 34
                HMax = 2
                ColW = GetArray(26, 26, 20, 26, 26, 58, 16, 20, 10, 20, 12)
                StartX = 20
                StartY = 42
                nFsize = 10
                RowH = 4
                b総括表出力 = True
                
            Case "日置市":
                LMax = 34
                HMax = 5
                ColW = GetArray(6, 35, 15, 5, 35, 15, 52, 5, 5, 16, 25, 10, 6, 12, 6, 22)
                nFsize = 10
                StartX = 10
                StartY = 50
                RowH = 4
                b総括表出力 = True
                
             Case "三股町":
                LMax = 32
                HMax = 3
                ColW = GetArray(6, 9, 22, 22, 38, 10, 15, 18, 12, 18, 14, 15, 15, 12, 12, 12, 18)
                nFsize = 9
                StartX = 10
                StartY = 39
                RowH = 4
                b総括表出力 = True
               
            Case "大崎町"
                HMax = 6
                LMax = 30
                StartX = 12
                StartY = 49
                nFsize = 10
                RowH = 4
                ColW = GetArray(6, 30, 15, 6, 30, 15, 10, 47, 5, 5, 16, 10, 26, 7, 7, 7, 20)
                b総括表出力 = True
                
           Case Else
                HMax = 6
                LMax = 30
                StartX = 12
                StartY = 49
                nFsize = 10
                RowH = 4
                ColW = GetArray(6, 30, 15, 6, 30, 15, 10, 47, 5, 5, 16, 10, 26, 7, 7, 7, 20)
                b総括表出力 = True
        End Select
    End Sub
    
    Private Sub CPrintSub_SetRsData(pRs As Object)
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim RsA As ADBasicLIB2.RecordsetEx
        Dim RsT As ADBasicLIB2.RecordsetEx
        Dim St As String
        Dim sSQL As String
        Dim n As Long, i As Long
        Dim nFlag(4) As Long
        Dim n面積 As Double
        Dim n部分面積 As Double
        Dim n集計面積 As Double
        Dim nSubCount As Long
        Dim W As Long
        Dim n地目区分 As Long
        Dim b合計出力 As Boolean
        Dim p合計 As dt合計
        Dim pHMax As Long
        Dim b支所 As Boolean
        Dim b支所改頁 As Boolean
        Dim Ar As Variant, Cm As Variant
        Dim b一部現況 As Boolean
        
        Ar = Split(mvarData, vbCrLf)
        Cm = Split(Ar(1), ";")
        s都道府県名 = Cm(0)
        s郡部 = Cm(1)
        If Cm(2) = "" Then b支所改頁 = False Else b支所改頁 = CBool(Cm(2))
        If Cm(3) = "" Then b支所 = False Else b支所 = CBool(Cm(3))

        b合計出力 = True
        b一部現況 = False
        Select Case Fnc.s市町村名
            Case "高尾野町", "さつま町", "三股町", "長島町": b合計出力 = False
            Case Else: b一部現況 = True
        End Select
                
        T総合計.s地目(0) = "( 田 )"
        T総合計.s地目(1) = "( 畑 )"
        T総合計.s地目(2) = "( 樹 )"
        T総合計.s地目(3) = "( 他 )"
        T総合計.s地目(4) = "( 計 )"
        
        Set Rs = pRs
        
        With mvarPData
            n = .NewLine
            If b支所改頁 And (s支所 <> Rs.Value("受付補助記号")) Then DataCnt = LMax
                                    
            If b支所 Then
                If p支所番号.Exists(Rs.Value("支所番号")) Then
                    .Data(n, "受付補助記号") = p支所番号.Item(Rs.Value("支所番号"))
                Else
                    .Data(n, "受付補助記号") = ""
                End If
            Else
                .Data(n, "受付補助記号") = Rs.NullCast("受付補助記号", "")
            End If
                       
            If Not Rs.IsNull("氏名B") And Rs.Value("氏名B") <> "" Then
                .SetRsData n, "氏名B", Rs
            ElseIf Not Rs.IsNull("申請者B") And Rs.Value("申請者B") <> 0 Then
                Set RsA = SystemDB.GetRecordsetEx("SELECT 氏名,行政区ID FROM [D:個人Info] WHERE [ID]=" & Rs.Value("申請者B"), 0, , Me)
                If Not RsA.EOF Then
                    .Data(n, "氏名B") = RsA.Value("氏名")
                    .Data(n, "行政区IDB") = RsA.Value("行政区ID")
                End If
            End If
                                   
            If Not Rs.IsNull("代理人名") And Rs.Value("代理人名") <> "" Then
                .SetRsData n, "氏名A", Rs, "代理人名"
                W = Rs.NullCast("代理人A", 0)
            ElseIf Not Rs.IsNull("氏名A") And Rs.Value("氏名A") <> "" Then
                .SetRsData n, "氏名A", Rs
                W = Rs.NullCast("申請者A", 0)
            Else
                .SetRsData n, "氏名A", Rs, "参照A"
                W = Rs.NullCast("申請者A", 0)
            End If
            If W <> 0 Then .Data(n, "行政区IDA") = SystemDB.GetDirectData("D:個人Info", "行政区ID", W)
            
            .SetRsData n, "法令", Rs
            .SetRsData n, "受付番号", Rs
            .SetRsData n, "通年受付番号", Rs
            .SetRsData n, "受付年月日", Rs
            .SetRsData n, "住所A", Rs
            .Data(n, "年齢A") = IIf(Rs.Value("年齢A") = 0 Or Rs.IsNull("年齢A"), "", Rs.Value("年齢A"))
            .SetRsData n, "職業A", Rs
            .SetRsData n, "集落A", Rs
            .SetRsData n, "経営面積A", Rs
            .SetRsData n, "申請理由A", Rs
            .SetRsData n, "住所B", Rs
            .Data(n, "年齢B") = IIf(Rs.Value("年齢B") = 0 Or Rs.IsNull("年齢B"), "", Rs.Value("年齢B"))
            .SetRsData n, "職業B", Rs
            .SetRsData n, "集落B", Rs
            .SetRsData n, "経営面積B", Rs
            .SetRsData n, "申請理由B", Rs
            .SetRsData n, "世帯員数", Rs, "世帯員数B"
            
            If Fnc.s市町村名 = "南種子町" Then
                .SetRsData n, "調査員", Rs, "調査員A"
            ElseIf Not Rs.IsNull("調査員A") Then
                .Data(n, "調査員") = Replace(Replace(StrConv(Rs.Value("調査員A"), vbNarrow), ",", "\n"), "､", "\n")
            End If
            
            If Rs.IsNull("権利種類") Or Rs.Value("権利種類") = 0 Then
                .Data(n, "権利種類") = ""
            Else
                .Data(n, "権利種類") = SystemDB.GetDirectDataWithClass("M_BASICALL", "名称", "小作形態", Rs.Value("権利種類"))
            End If
            .SetRsData n, "利用権内容", Rs
            
            .SetRsData n, "支払方法", Rs
            If Rs.IsNull("期間") Or Rs.Value("期間") = 0 Then
                If Rs.Value("始期") <> "" And Rs.Value("終期") <> "" Then
                    .Data(n, "期間年") = DateDiff("yyyy", Rs.Value("始期"), Rs.Value("終期"))
                End If
            Else
                .Data(n, "期間年") = Rs.Value("期間")
            End If
            .Data(n, "期間月") = 0
            Select Case mvarKey
                Case "n61":
                    .Data(n, "再設定") = IIf(Rs.Value("再設定") = True, "再設定", "新規設定")
                Case "n62":
                    If Rs.Value("始期") <> "" And Rs.Value("終期") <> "" Then
                        .Data(n, "期間月") = DateDiff("m", Rs.Value("始期"), Rs.Value("終期")) Mod 12
                    End If
                    .Data(n, "再設定") = ""
            End Select
            
            .Data(n, "小作料") = IIf(Rs.Value("小作料") = 0, "", Rs.Value("小作料"))
            .Data(n, "小作料単位") = Rs.NullCast("小作料単位", "")
            .Data(n, "公告日") = IIf(Rs.IsNull("公告年月日") Or Rs.Value("公告年月日") = "0:00:00", "", Rs.Value("公告年月日"))
            .Data(n, "始期") = IIf(Rs.IsNull("始期") Or Rs.Value("始期") = "0:00:00", "", Rs.Value("始期"))
            .Data(n, "終期") = IIf(Rs.IsNull("終期") Or Rs.Value("終期") = "0:00:00", "", Rs.Value("終期"))
            .SetRsData n, "稼動人数", Rs
            .SetRsData n, "支払方法", Rs
            .Data(n, "同意書") = IIf(Rs.Value("同意書") = True, "○", "")
            .SetRsData n, "備考", Rs
            
            For W = 0 To 4
                p合計.n筆数(W) = 0: p合計.n面積(W) = 0
            Next
            i = 0
            St = Replace(Replace(Rs.NullCast("農地リスト", ""), "農地.", ""), ";", ",")
            If Len(St) Then
                sSQL = "SELECT [V_農地].*,[V_農地].[現況地目] AS [現況地目ID],[V_地目].名称 AS [登記地目],[地目2].名称  AS [現況],[V_農委地目].名称 AS [農委地目],[D:個人Info].氏名 AS [所有者], [D_部分申請].部分面積 AS [部分面積T] " _
                     & "FROM (((([V_農地] LEFT JOIN [V_地目] ON [V_農地].[登記簿地目]=[V_地目].ID) LEFT JOIN V_現況地目 AS 地目2 ON [V_農地].[現況地目]=[地目2].ID) LEFT JOIN [V_農委地目] ON [V_農地].[農委地目ID]=[V_農委地目].ID)  LEFT JOIN [D:個人Info] ON V_農地.管理人ID = [D:個人Info].ID )  LEFT JOIN [D_部分申請] ON [V_農地].ID = [D_部分申請].農地ID " _
                     & "WHERE [V_農地].[ID] IN (" & St & ")"
                If Fnc.s市町村名 = "姶良市" Then
                    sSQL = sSQL & " ORDER BY [V_農地].[大字ID],[V_農地].[小字ID],val(IIf(IsNull([地番]),0,IIf(InStr([地番],'-')=0,Val([地番]),val(Left([地番],InStr([地番],'-')-1)))) *1000 + Val(IIf(IsNull([地番]),0,IIf(InStr([地番],'-')=0,0,val(Mid([地番],InStr([地番],'-')+1))))))"
                Else
                    sSQL = sSQL & " ORDER BY [V_農地].[管理人ID],[V_農地].[土地所在];"
                End If
                Set RsT = SystemDB.GetRecordsetEx(sSQL, 1, , "議案書")
                Do Until RsT.EOF
                    i = i + 1
                    .SetRsData n & ":農地." & i, "土地所在", RsT
                    .SetRsData n & ":農地." & i, "登記地目", RsT
                    .SetRsData n & ":農地." & i, "所有者", RsT
                    
                    If (Not RsT.IsNull("農委地目ID")) And (RsT.Value("農委地目ID") <> 0) And (Not RsT.IsNull("農委地目認定日")) And (RsT.Value("農委地目認定日") <> "0:00:00") Then
                        .SetRsData n & ":農地." & i, "現況地目", RsT, "農委地目"
                    Else
                        .SetRsData n & ":農地." & i, "現況地目", RsT, "現況"
                    End If
                    
                    .SetRsData n & ":農地." & i, "等級", RsT
                    .SetRsData n & ":農地." & i, "農振区分", RsT, "農業振興地域"
                    .SetRsData n & ":農地." & i, "都市計画", RsT, "都市計画法"
                    .SetRsData n & ":農地." & i, "土地改良", RsT, "土地改良法"
                   
                    n部分面積 = 0
                    If Fnc.s市町村名 = "南種子町" Then
                        n部分面積 = Fnc.NullCast(RsT.Value("契約面積"), 0)
    '                        .SetRsData n & ":農地." & i, "小作料", RsT
                        If Rs.Value("再設定") Then
                            .Data(n & ":農地." & i, "小作形態") = IIf(RsT.IsNull("小作形態"), "", SystemDB.GetDirectDataWithClass("M_BASICALL", "名称", "小作形態", RsT.Value("小作形態")))
                            .SetRsData n & ":農地." & i, "小作料", RsT   '変更(2010/12/07)井上
                            .SetRsData n & ":農地." & i, "小作料単位", RsT   '変更(2010/12/07)井上
                        Else
                            .Data(n & ":農地." & i, "小作形態") = IIf(Rs.IsNull("権利種類"), "", SystemDB.GetDirectDataWithClass("M_BASICALL", "名称", "小作形態", Rs.Value("権利種類")))
                            .SetRsData n & ":農地." & i, "小作料", RsT   '変更(2010/12/07)井上
                            .SetRsData n & ":農地." & i, "小作料単位", RsT   '変更(2010/12/07)井上
                        End If
                        
                        .SetRsData n & ":農地." & i, "利用状況", RsT
                        If Rs.Value("法令") = 61 Then
                            .Data(n & ":農地." & i, "設定内容") = IIf(Rs.Value("再設定") = True, "再設定", "新規設定")
                            .Data(n & ":農地." & i, "利用権内容") = Rs.Value("利用権内容")
                            .Data(n & ":農地." & i, "支払方法") = Rs.Value("支払方法")
    '                            If (Not RsT.IsNull("利用権開始申請日")) And (RsT.Value("利用権開始申請日") <> "0:00:00") And .Data(n, "始期") = "" Then .Data(n, "始期") = RsT.Value("利用権開始申請日")
    '                            If (Not RsT.IsNull("利用権終了申請日")) And (RsT.Value("利用権終了申請日") <> "0:00:00") And .Data(n, "終期") = "" Then .Data(n, "終期") = RsT.Value("利用権終了申請日")
    '                            If (Not RsT.IsNull("利用権開始申請日")) And (RsT.Value("利用権開始申請日") <> "0:00:00") And (Not RsT.IsNull("利用権終了申請日")) And (RsT.Value("利用権終了申請日") <> "0:00:00") Then
    '                                .Data(n & ":農地." & i, "期間") = DateDiff("yyyy", RsT.Value("利用権開始申請日"), RsT.Value("利用権終了申請日"))
    '                                If Val(.Data(n, "期間年")) = 0 Then .Data(n, "期間年") = DateDiff("yyyy", RsT.Value("利用権開始申請日"), RsT.Value("利用権終了申請日"))
    '                            Else
                                .Data(n & ":農地." & i, "期間") = .Data(n, "期間年")
    '                                .Data(n & ":農地." & i, "期間") = 0
    '                            End If
                        Else
                            .Data(n & ":農地." & i, "期間") = .Data(n, "期間年")
                        End If
                    End If
                    
                    If n部分面積 = 0 And Not RsT.IsNull("部分面積T") Then n部分面積 = RsT.Value("部分面積T")
                   
                    n面積 = 0
                    If RsT.Value("田面積") <> 0 Then
                        n面積 = RsT.Value("田面積")
                        n地目区分 = 0
                    ElseIf RsT.Value("畑面積") <> 0 Then
                        n面積 = RsT.Value("畑面積")
                        n地目区分 = 1
                    ElseIf RsT.Value("樹園地") <> 0 Then
                        n面積 = RsT.Value("樹園地")
                        n地目区分 = 2
                    Else
                        If RsT.Value("採草放牧面積") <> 0 Then n面積 = RsT.Value("採草放牧面積")
                        n地目区分 = 3
                    End If
                    If n面積 = 0 Then n面積 = RsT.Value("実面積")
                    
                    If n部分面積 = 0 Then
                        n集計面積 = n面積
                    Else
                        n集計面積 = n部分面積
                    End If
                    n集計面積 = Fix(n集計面積)
                    .Data(n & ":農地." & i, "面積") = n集計面積
                    
                    If Fnc.s市町村名 <> "南種子町" Then
                        .Data(n & ":農地." & i, "一部") = 0
                        If RsT.IsNull("一部現況") Then
                        ElseIf b一部現況 And Val(RsT.Value("一部現況")) > 0 Then
                            i = i + 1
                            .Data(n & ":農地." & i, "一部") = 1
                            .Data(n & ":農地." & i, "面積") = Fix(Fnc.NullCast(RsT.Value("登記簿面積"), 0))
                        End If
                    End If
                    
                    p合計.n筆数(n地目区分) = p合計.n筆数(n地目区分) + 1
                    p合計.n面積(n地目区分) = p合計.n面積(n地目区分) + n集計面積
                    RsT.MoveNext
                Loop
            End If
            
            If Val(Rs.NullCast("経由法人ID", 0)) <> 0 Then
                pHMax = HMax * 2
                Set RsA = SystemDB.GetRecordsetEx("SELECT [氏名],[住所] FROM [D:個人Info] WHERE [ID]=" & Rs.Value("経由法人ID"), 0, , "議案書Init基盤利用権設定")
                If Not RsA.EOF Then
                    .Data(n, "経由法人ID") = Rs.Value("経由法人ID")
                    .Data(n, "経由法人") = RsA.Value("氏名")
                    .Data(n, "経由法人住所") = RsA.Value("住所")
                End If
                SystemDB.CloseRs RsA
            Else
                .Data(n, "経由法人ID") = 0
                pHMax = HMax
            End If
            
            .Data(n, "田筆") = p合計.n筆数(0)
            .Data(n, "畑筆") = p合計.n筆数(1)
            .Data(n, "樹園筆") = p合計.n筆数(2)
            .Data(n, "他筆") = p合計.n筆数(3)
            .Data(n, "田面積") = p合計.n面積(0)
            .Data(n, "畑面積") = p合計.n面積(1)
            .Data(n, "樹園面積") = p合計.n面積(2)
            .Data(n, "他面積") = p合計.n面積(3)
            SystemDB.CloseRs RsT
            s支所 = Rs.NullCast("受付補助記号", "")
            
            p合計.n筆数(4) = p合計.n筆数(0) + p合計.n筆数(1) + p合計.n筆数(2) + p合計.n筆数(3)
            p合計.n面積(4) = p合計.n面積(0) + p合計.n面積(1) + p合計.n面積(2) + p合計.n面積(3)
            
            ' 総合計
            For W = 0 To 4
                T総合計.n筆数(W) = T総合計.n筆数(W) + p合計.n筆数(W)
                T総合計.n面積(W) = T総合計.n面積(W) + p合計.n面積(W)
            Next

            If b合計出力 Then
                For i = 0 To 3
                    If p合計.n筆数(i) > 0 Then nFlag(i) = 1
                Next
                nFlag(4) = nFlag(0) + nFlag(1) + nFlag(2) + nFlag(3)
                      
                nSubCount = .SubCount(n & ":農地")
                If nFlag(4) = 1 Then
                    For i = 0 To 4: nFlag(i) = 0: Next
                End If
                nFlag(4) = nFlag(4) + 1
                
                If nSubCount + nFlag(4) < pHMax Then
                   i = pHMax - nFlag(4)
                Else
                    i = nSubCount + 1
                End If
                For W = 0 To 4
                    If nFlag(W) > 0 Then
                        i = i + 1
                        .Data(n & ":農地." & i, "土地所在") = T総合計.s地目(W)
                        .Data(n & ":農地." & i, "登記地目") = p合計.n筆数(W)
                        .Data(n & ":農地." & i, "現況地目") = "99999"      'データ行との区分：合計行に"99999"セット
                        .Data(n & ":農地." & i, "面積") = p合計.n面積(W)
                    End If
                Next
            Else
                nSubCount = .SubCount(n & ":農地") + 1
                If nSubCount < pHMax Then
                    For i = nSubCount + 1 To pHMax
                        .Data(n & ":農地." & i, "土地所在") = ""
                    Next
                End If
            End If
            If LMax <> 0 And pHMax <> 0 Then SetPageNo n
        End With
        Set Rs = Nothing
    End Sub
    
    Private Sub SetPageNo(nDataNo As Long)
        Dim n As Long
        Dim i As Long
        Dim nSubCount As Long
        Dim nCount As Long
        Dim wCount As Long
        
        n = nDataNo
        nSubCount = mvarPData.SubCount(n & ":農地")
        
        nCount = DataCnt + nSubCount + 1      ' .SubCountは 0からみているため
        wCount = nSubCount + 1                '          件数として扱うときは１プラス
        
        If nCount > LMax Then
            nCount = nSubCount + 1
            i = 0
            Do While nCount > 0
                i = i + 1
                PageCnt = PageCnt + 1
                PgChgSt(PageCnt) = n * 1000 + (i - 1) * LMax
                PgChgEn(PageCnt) = n * 1000 + i * LMax - 1
                nCount = nCount - LMax
            Loop
            DataCnt = 0
            wCount = nCount + LMax
            If wCount < HMax Then
                wCount = HMax
            End If
        ElseIf n = 1 Then
            PageCnt = PageCnt + 1
            PgChgSt(PageCnt) = n * 1000
        End If
        PgChgEn(PageCnt) = n * 1000 + nSubCount
        DataCnt = DataCnt + wCount
        
        
        mvarMaxPage = PageCnt
    End Sub

    Private Sub Print総括表(mvarParent As ADBasicLIB2.CPrintFormSK)
        Dim Ay As Variant
        Dim n As Long, i As Long
        Dim dX(20) As Single, hX(20) As Single
        Dim St As String
        Dim nPit As Single
        Dim Xcnt As Long
        Dim T As Single
        Dim pFsize As Integer
        Dim nStart As Long
        Dim nEnd As Long

        pFsize = 9
        
        With mvarParent
            .ClearScreen
            .Offset -5, 0
            Ay = GetArray(28, 18, 18, 18, 18, 18, 18, 18, 18, 18, 14, 14, 14, 14)
            dX(0) = 30: hX(0) = dX(0) + Ay(0) / 2
            For i = 0 To UBound(Ay)
                dX(i + 1) = dX(i) + Ay(i)
                If i < UBound(Ay) Then hX(i + 1) = dX(i + 1) + Ay(i + 1) / 2
            Next
            Xcnt = UBound(Ay) + 1
            
            Select Case mvarKey
                Case "n61": St = "１．農用地利用集積計画総括表（利用権の設定）"
                Case "n62": St = "２．農用地利用集積計画総括表（利用権の移転）"
            End Select
            .TextOut St, dX(0), 25, 13, 0, 0
            .TextOut "（市町村名：" & Fnc.s市町村名 & "）", dX(14), 30, pFsize, 1, 0
            
            .TextOut "公告年月日", hX(0), 45, pFsize, 2, 2
            .TextOut "期　　　間", (dX(3) - dX(1)) / 2 + dX(1), 40, pFsize, 2, 2
            .TextOut "始　期", hX(1), 50, pFsize, 2, 2
            .TextOut "終　期", hX(2), 50, pFsize, 2, 2
            .TextOut "存続期間", hX(3), 45, pFsize, 2, 2
            .TextOut "面　　　　　　　　　　積", (dX(10) - dX(4)) / 2 + dX(4), 40, pFsize, 2, 2
            .TextOut "（u）", dX(10) - 5, 40, pFsize, 1, 2
            .TextOut "田", hX(4), 52, pFsize, 2, 2
            .TextOut "畑", hX(5), 52, pFsize, 2, 2
            .TextOut "樹園地", hX(6), 52, pFsize, 2, 2
            .TextOut "その他", hX(7), 52, pFsize, 2, 2
            .TextOut "計", hX(8), 52, pFsize, 2, 2
            .TextOut "うち再設定", hX(9), 52, pFsize, 2, 2
            .TextOut "利用権を設定", dX(10) + 2, 37, pFsize, 0, 0
            .TextOut "する者の数(人)", dX(12) - 1, 41, pFsize, 1, 0
            .TextOut "うち", dX(11) + 1, 47, pFsize, 0, 0
            .TextOut "更新分", dX(12) - 1, 51, pFsize, 1, 0
            .TextOut "利用権の設定を", dX(12) + 2, 37, pFsize, 0, 0
            .TextOut "受ける者の数(人)", dX(14) - 1, 41, pFsize, 1, 0
            .TextOut "うち", dX(13) + 1, 47, pFsize, 0, 0
            .TextOut "更新分", dX(14) - 1, 51, pFsize, 1, 0
            .TextOut "計", hX(0), 175.5, pFsize, 2, 2
            .TextOut "（注）１．存続期間別に記載すること。", dX(0), 186, pFsize, 0, 0

            .DBox dX(0), 35, dX(14), 184
            .DLine dX(1), 45, dX(3), 45
            .DLine dX(4), 45, dX(10), 45
            .DLine dX(0), 55, dX(14), 55
            .DLine dX(0), 167, dX(14), 167
            For i = 0 To 6: .DotLine dX(0), 14 * i + 69, dX(14), 14 * i + 69, vbBlack: Next
            For i = 1 To Xcnt
                Select Case i
                    Case 1, 3, 4, 10, 12
                        .DLine dX(i), 35, dX(i), 184
                    Case 2, 5, 6, 7, 8, 11, 13
                        .DLine dX(i), 45, dX(i), 184
                    Case 9
                        .DLine dX(i), 48, dX(i), 184
                End Select
            Next
            .DLine dX(9), 48, dX(10), 48
            .DLine dX(11), 45, dX(12), 45
            .DLine dX(13), 45, dX(14), 45
                             
            T = 61.5: nPit = 4
            nStart = (.Page - 1) * 8
            nEnd = nStart + 8 - 1
            If nEnd > 総括Cnt - 1 Then nEnd = 総括Cnt - 1

            For n = nStart To nEnd
                .DrawText IIf(Len(T総括(n).s公告日) = 0, "", Format(T総括(n).s公告日, "GGGEE年M月D日")), dX(0), T, Ay(0), nPit, pFsize, 2, 0
                .DrawText IIf(Len(T総括(n).s始期) = 0, "−", Format(T総括(n).s始期, "GEE.M.D")), dX(1), T, Ay(1), nPit, pFsize, 2, 0
                .DrawText IIf(Len(T総括(n).s終期) = 0, "−", Format(T総括(n).s終期, "GEE.M.D")), dX(2), T, Ay(2), nPit, pFsize, 2, 0
                St = ""
                If T総括(n).n期間月 > 0 Then
                    St = IIf(T総括(n).n期間年 = 0, T総括(n).n期間月 & "ヶ月", T総括(n).n期間年 & "年" & T総括(n).n期間月 & "ヶ月")
                Else
                    St = IIf(T総括(n).n期間年 = 0, "−　", T総括(n).n期間年 & "年間")
                End If
                .DrawText St, dX(3), T, Ay(3) - 3, nPit, pFsize, 1, 0
                For i = 0 To 5
                    .DrawText IIf(T総括(n).n面積(i) = 0, "−", FormatNumber(T総括(n).n面積(i), 0)), dX(4 + i), T, Ay(4 + i) - 1, nPit, pFsize, 1, 0
                Next
                For i = 0 To 3
                    .DrawText IIf(T総括(n).n人数(i) = 0, "−", FormatNumber(T総括(n).n人数(i), 0)), dX(10 + i), T, Ay(10 + i) - 3, nPit, pFsize, 1, 0
                Next
                T = T + 14
            Next
            If nEnd = 総括Cnt - 1 Then
                n = 総括Cnt
                For i = 0 To 5
                    .DrawText IIf(T総括(n).n面積(i) = 0, "−", FormatNumber(T総括(n).n面積(i), 0)), dX(4 + i), 175.5, Ay(4 + i) - 1, nPit, pFsize, 1, 2
                Next
                For i = 0 To 3
                    .DrawText IIf(T総括(n).n人数(i) = 0, "−", FormatNumber(T総括(n).n人数(i), 0)), dX(10 + i), 175.5, Ay(10 + i) - 3, nPit, pFsize, 1, 2
                Next
            End If
        End With
    End Sub
    Private Property Let CPrintSub_StartPage(RHS As Long): mvarStartPage = RHS: End Property
    Private Property Get CPrintSub_StartPage() As Long: CPrintSub_StartPage = mvarStartPage: End Property

End Class










Class CPrint営農計画書
    Option Explicit
    Implements CPrintCls
    Private mvarParent As CPrintFormSK
    Private mvarKey As String
    Private mvar氏名 As String
    Private mvar住所 As String
    Private Const nFsize = 10.5
    
    Private Property Get CPrintCls_CanCancelPrint() As Boolean: End Property
    Private Property Get CPrintCls_CanPrintNowPage() As Boolean: End Property

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean
        Dim pDV As ADBasicLIB2.CDataviewSK
        
        Set pDV = ObjectMan.GetObjectDVP(sParam)
        Select Case Fnc.GetKeyHead(sParam)
            Case "農家": mvar氏名 = pDV.GetProperty2("世帯主名")
                         mvar住所 = pDV.GetProperty2("住所")
            Case Else
                Stop
        End Select
        
        mvarParent.MaxPage = 1
    End Function

    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property

    Private Property Let CPrintCls_Key(ByVal RHS As String)

    End Property
    Private Property Get CPrintCls_Key() As String: CPrintCls_Key = mvarKey: End Property
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants: CPrintCls_Orientation = vbPRORPortrait: End Property

    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&): End Sub
    
    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Set CPrintCls_Parent(RHS As ADBasicLIB2.CPrintFormSK): Set mvarParent = RHS: End Property

    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        CPrintCls_Repaint
        mvarParent.EndDoc
    End Sub

    Private Sub CPrintCls_Repaint()
        
        With mvarParent
            .ClearScreen
            .Offset 0, 0
            
            .TextOut "様式第６号", 20, 20, nFsize, 0, 0
            .TextOut "営   農   計   画   書", 70, 25, 16, 0, 0
            .TextOut "住　所 " & mvar住所, 113, 40, nFsize, 0, 0
            .TextOut "譲受人　氏　名 " & mvar氏名, 99, 53, nFsize, 0, 0
            .TextOut "（借人）", 99, 59, nFsize, 0, 0
            .TextOut "１　構成員（同一世帯員）数", 22, 72, nFsize + 1, 0, 0
            .TextOut "人", 119, 72, nFsize, 0, 0
            .TextOut "うち、必要な農作業に常時従事する者", 30, 79, nFsize, 0, 0
            .TextOut "人", 119, 79, nFsize, 0, 0
            .TextOut "２　経　営　面　積", 22, 98, nFsize + 1, 0, 0
            .TextOut "田　　　　ａ，畑　　　　ａ，計　　　　ａ，採草放牧地　　　　ａ，合計　　　　ａ", 30, 105, nFsize, 0, 0
            .TextOut "うち、借入地", 30, 112, nFsize, 0, 0
            .TextOut "田　　　　ａ，畑　　　　ａ，計　　　　ａ，採草放牧地　　　　ａ，合計　　　　ａ", 30, 118, nFsize, 0, 0
            .TextOut "３　営農計画の概要等", 22, 137, nFsize + 1, 0, 0
            .TextOut "(1)　現在の経営状況及び年間販売高等", 26, 144, nFsize, 0, 0
            .TextOut "(2)　申請地を取得した後の具体的な営農計画及び年間販売計画等", 26, 151, nFsize, 0, 0
            .TextOut "４　農業以外の事業を行っている場合は、その概要", 22, 169, nFsize + 1, 0, 0
            .TextOut "５　取得しようとする農地に必要とする所要労働力及び重要な作業方法等", 22, 189, nFsize + 1, 0, 0
            .TextOut "(1)　播種及び植付の方法", 26, 196, nFsize, 0, 0
            .TextOut "(2)　水利見廻り等一般管理の方法", 26, 202, nFsize, 0, 0
            .TextOut "(3)　施肥、除草等の方法", 26, 208, nFsize, 0, 0
            .TextOut "(4)　病虫害発生等に係る薬剤散布の方法", 26, 214, nFsize, 0, 0
            .TextOut "(5)　収 穫 の 方 法", 26, 220, nFsize, 0, 0
            .TextOut "６　他の農地における作業と競合の有無及びその対策", 22, 240, nFsize + 1, 0, 0
            .TextOut "７　取得する農地の附近に現に耕作する農地があれば、その農地の表示", 22, 260, nFsize + 1, 0, 0
       End With

    End Sub

    Private Sub CPrintCls_TargetChange(sKey As String)

    End Sub

End Class










Class CPrint議案書
    Option Explicit
    Implements ADBasicLIB2.CPrintCls
    Private mvarPTypeKye As String
    Private mvarParent As ADBasicLIB2.CPrintFormSK
    Private mvarKey As String
    Private s市町村 As String
    Private sKey As String
    Private mCol As Collection
    
    
    Private Sub Class_Initialize()
        Set mCol = New Collection
    End Sub

    Private Sub Class_Terminate()
        Set mCol = Nothing
    End Sub

    Private Property Get CPrintCls_CanCancelPrint() As Boolean: End Property
    Private Property Get CPrintCls_CanPrintNowPage() As Boolean: CPrintCls_CanPrintNowPage = True: End Property

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean
        Dim sSQL As String
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim Rsx As ADBasicLIB2.RecordsetEx
        Dim Ar As Variant, Cm As Variant
        Dim mvarParams As Variant
        Dim LstItems As Variant
        Dim n As Long
        Dim i As Long
        Dim St As String
        Dim pNode As MSComctlLib.Node
        Dim s支所改頁 As String
        Dim s都道府県名 As String
        Dim s郡部 As String
        Dim s支所 As String
        Dim b利用権設定 As Boolean
        Dim b利用権移転 As Boolean
        Dim pPSub As CPrintSub
        
        'On Error GoTo DataInitError
        mvarParent.UsedTreeView = True
        mvarParent.PrintMode("部数印刷") = True
        mvarParent.表示倍率 = 0.75
        
        s市町村 = Fnc.s市町村名

        Set Rsx = SystemDB.GetRecordsetEx("SELECT * FROM [S_システムデータ]；", 0, , Me)
        Do Until Rsx.EOF
            Select Case Rsx.Value("KEY")
                Case "都道府県名": s都道府県名 = Fnc.NullCast(Rsx.Value("DATA"), "")
                Case "郡部": s郡部 = Fnc.NullCast(Rsx.Value("DATA"), "")
                Case "総会資料支所改頁": s支所改頁 = Fnc.NullCast(Rsx.Value("DATA"), "")
                Case "支所番号": s支所 = Fnc.NullCast(Rsx.Value("DATA"), "")
            End Select
            Rsx.MoveNext
        Loop
        SystemDB.CloseRs Rsx
        
        Select Case s市町村
            Case "東市来町": Set pNode = mvarParent.TreeNodeAdd("n10", "通知書", "CloseFolderG")
            Case "南種子町": SystemDB.ExecuteSQL "DELETE wk申請補助.申請ID FROM wk申請補助 WHERE (((wk申請補助.申請ID)=-1));"
        End Select
        
        St = SystemDB.GetDirectData("D_PSTRING", "DATA", , sParam)
        Ar = Split(St, vbTab)
        mvarParams = Split(Ar(0), vbCrLf)
        LstItems = Split(Ar(1), vbCrLf)
                
        For n = 0 To UBound(mvarParams)
            If mvarParams(n) <> "" Then
            Ar = Split(mvarParams(n), vbCrLf)
            Cm = Split(Ar(0), ";")
            St = Join(GetArray(Cm(1), Cm(2), Cm(3), Cm(4)), ";") & vbCrLf & s都道府県名 & ";" & s郡部 & ";" & s支所改頁 & ";" & s支所 & vbCrLf
            Select Case Cm(0)
                Case "n30":
                    Set pNode = mvarParent.TreeNodeAdd("n30", "3条(委員会許可)", "CloseFolderG")
                    Set pPSub = New CPrintSub農地法3条
                    pPSub.Key = "n30"
                    pPSub.Data = St
                Case "n31":
                    Set pNode = mvarParent.TreeNodeAdd("n30", "3条(委員会許可)", "CloseFolderG")
                    Set pPSub = New CPrintSub農地法3条
                    pPSub.Key = "n30"
                    pPSub.Data = St
                Case "n32":
                    Set pNode = mvarParent.TreeNodeAdd("n32", "3条(県知事許可)", "CloseFolderG")
                    Set pPSub = New CPrintSub農地法3条
                    pPSub.Key = "n32"
                    pPSub.Data = St
                Case "n33":
                    Set pNode = mvarParent.TreeNodeAdd("n32", "3条(県知事許可)", "CloseFolderG")
                    Set pPSub = New CPrintSub農地法3条
                    pPSub.Key = "n32"
                    pPSub.Data = St
                Case "n40":
                    Set pNode = mvarParent.TreeNodeAdd("n40", "4条申請", "CloseFolderG")
                    Set pPSub = New CPrintSub農地法4条
                    pPSub.Key = "n40"
                    pPSub.Data = St
                Case "n50":
                    mvarParent.TreeNodeAdd "n50", "5条申請", "CloseFolderG"
                    Set pPSub = New CPrintSub農地法5条
                    pPSub.Key = "n50"
                    pPSub.Data = St
                Case "n51":
                    mvarParent.TreeNodeAdd "n51", "5条申請", "CloseFolderG"
                    Set pPSub = New CPrintSub農地法5条
                    pPSub.Key = "n51"
                    pPSub.Data = St
                Case "n60":
                    Set pNode = mvarParent.TreeNodeAdd("n60", "所有権移転", "CloseFolderG")
                    Set pPSub = New CPrintSub所有権移転
                    pPSub.Key = "n60"
                    pPSub.Data = St
               Case "n61":
                    Set pNode = mvarParent.TreeNodeAdd("n61", "利用権設定", "CloseFolderG")
                    Set pPSub = New CPrintSub利用権設定
                    pPSub.Key = "n61"
                    pPSub.Data = St
                Case "n62":
                    Set pNode = mvarParent.TreeNodeAdd("n62", "利用権移転", "CloseFolderG")
                    Set pPSub = New CPrintSub利用権設定
                    pPSub.Key = "n62"
                    pPSub.Data = St
                Case "n200": Set pNode = mvarParent.TreeNodeAdd("n200", "20条解約", "CloseFolderG")
                    Set pPSub = New CPrintSub農地解約
                    pPSub.Key = "n200"
                    pPSub.Data = St
                Case "n210": Set pNode = mvarParent.TreeNodeAdd("n210", "合意解約", "CloseFolderG")
                    Set pPSub = New CPrintSub農地解約
                    pPSub.Key = "n210"
                    pPSub.Data = St
                Case "n301": Set pNode = mvarParent.TreeNodeAdd("n301", "農地改良届", "CloseFolderG")
                    Set pPSub = New CPrintSub農地改良届
                    pPSub.Key = "n301"
                    pPSub.Data = St
                Case "n302": Set pNode = mvarParent.TreeNodeAdd("n302", "農用地計画変更", "CloseFolderG")
                    Set pPSub = New CPrintSub農用地計画変更
                    pPSub.Key = "n302"
                    pPSub.Data = St
                Case "n303": Set pNode = mvarParent.TreeNodeAdd("n303", "事業計画変更", "CloseFolderG")
                    Set pPSub = New CPrintSub事業計画変更
                    pPSub.Key = "n303"
                    pPSub.Data = St
                Case "n400": Set pNode = mvarParent.TreeNodeAdd("n400", "あっせん(出)", "CloseFolderG")
                    Set pPSub = New CPrintSubあっせん申出
                    pPSub.Key = "n400"
                    pPSub.Data = St
                Case "n401": Set pNode = mvarParent.TreeNodeAdd("n401", "あっせん(受)", "CloseFolderG")
                    Set pPSub = New CPrintSubあっせん申出
                    pPSub.Key = "n401"
                    pPSub.Data = St
                Case "n500": Set pNode = mvarParent.TreeNodeAdd("n500", "農地利用変更", "CloseFolderG")
                    Set pPSub = New CPrintSub農地利用変更
                    pPSub.Key = "n500"
                    pPSub.Data = St
                Case "n600":
                    Set pNode = mvarParent.TreeNodeAdd("n600", "非農地証明", "CloseFolderG")
                    Set pPSub = New CPrintSub非農地証明
                    pPSub.Key = "n600"
                    pPSub.Data = St
                Case "n801", "n802", "n803", "n804":
                    Select Case Cm(0)
                        Case "n801": Set pNode = mvarParent.TreeNodeAdd("n801", "耕作目的（公売）", "CloseFolderG"): Set pPSub = New CPrintSub買受適格: pPSub.Key = Cm(0): pPSub.Data = St
                        Case "n802": Set pNode = mvarParent.TreeNodeAdd("n802", "耕作目的（競売）", "CloseFolderG"): Set pPSub = New CPrintSub買受適格: pPSub.Key = Cm(0): pPSub.Data = St
                        Case "n803": Set pNode = mvarParent.TreeNodeAdd("n803", "転用目的（公売）", "CloseFolderG"): Set pPSub = New CPrintSub買受適格: pPSub.Key = Cm(0): pPSub.Data = St
                        Case "n804": Set pNode = mvarParent.TreeNodeAdd("n804", "転用目的（競売）", "CloseFolderG"): Set pPSub = New CPrintSub買受適格: pPSub.Key = Cm(0): pPSub.Data = St
                    End Select
                Case "n990":
                    Set pNode = mvarParent.TreeNodeAdd("n990", "奨励金交付", "CloseFolderG")
                    Set pPSub = New CPrintSub奨励金交付
                    pPSub.Key = "n990"
                    pPSub.Data = St
                Case "n991":
                    Set pNode = mvarParent.TreeNodeAdd("n991", "奨励金交付", "CloseFolderG")
                    Set pPSub = New CPrintSub奨励金交付
                    pPSub.Key = "n991"
                    pPSub.Data = St
                Case "n10":
                    Debug.Assert False
                Case Else
                    Debug.Print Cm(0)
            End Select
            If Not pPSub Is Nothing Then
                mCol.Add pPSub, pPSub.Key
                Set pPSub = Nothing
            End If
            End If
        Next

        St = ""
        For i = 0 To UBound(LstItems) - 1
            Ar = Split(LstItems(i), ";")
            If Val(Ar(5)) Then St = St & "," & MID$(Ar(1), 3)
        Next
        St = MID$(St, 2)
        If Len(St) > 0 Then
            
            'If s市町村 = "南種子町" Then
            '    Set Rs = SystemDB.GetRecordsetEx("SELECT [D_申請].*,[D:個人Info].氏名 AS [参照A],[D:個人Info].行政区ID AS [参照集落IDA] FROM ([D_申請] LEFT JOIN [D:個人Info] ON [D_申請].申請者A=[D:個人Info].ID) WHERE [D_申請].[ID] IN (" & St & ") ORDER BY [受付番号];", 1, , "議案書")
            'Else
            '    Set Rs = SystemDB.GetRecordsetEx("SELECT [D_申請].*,[D:個人Info].氏名 AS [参照A],[D:個人Info].行政区ID AS [参照集落IDA] FROM ([D_申請] LEFT JOIN [D:個人Info] ON [D_申請].申請者A=[D:個人Info].ID) WHERE [D_申請].[ID] IN (" & St & ") ORDER BY [議席番号],[受付番号];", 1, , "議案書")
            'End If
            '2009/05/18 test
            If s市町村 = "南種子町" Then
                Set Rs = SystemDB.GetRecordsetEx("SELECT [D_申請].*,[D:個人Info].氏名 AS [参照A],[D:個人Info].行政区ID AS [参照集落IDA] FROM ([D_申請] LEFT JOIN [D:個人Info] ON [D_申請].申請者A=[D:個人Info].ID) WHERE [D_申請].[ID] IN (" & St & ") ORDER BY [受付番号];", 1, , "議案書")
            ElseIf s市町村 = "姶良市" Then
                Set Rs = SystemDB.GetRecordsetEx("SELECT [D_申請].*,[D:個人Info].氏名 AS [参照A],[D:個人Info].行政区ID AS [参照集落IDA] FROM ([D_申請] LEFT JOIN [D:個人Info] ON [D_申請].申請者A=[D:個人Info].ID) WHERE [D_申請].[ID] IN (" & St & ") ORDER BY [受付番号],[氏名B],[氏名A];", 1, , "議案書")
            Else
                Set Rs = SystemDB.GetRecordsetEx("SELECT [D_申請].*,[D:個人Info].氏名 AS [参照A],[D:個人Info].行政区ID AS [参照集落IDA] FROM ([D_申請] LEFT JOIN [D:個人Info] ON [D_申請].申請者A=[D:個人Info].ID) WHERE [D_申請].[ID] IN (" & St & ") ORDER BY [議席番号],[通年受付番号];", 1, , "議案書")
            End If
            
            
            Do Until Rs.EOF
                            
                Set pPSub = mCol(CStr("n" & (Rs.Value("法令") + (Rs.Value("法令") = 31) + (Rs.Value("法令") = 33) + (Rs.Value("法令") = 51) + (Rs.Value("法令") = 991))))
                
                Select Case Rs.Value("法令")
                    Case state3条所有権: pPSub.SetRsData Rs
                    Case state3条賃借権: pPSub.SetRsData Rs
                    Case state県3条所有権: pPSub.SetRsData Rs
                    Case state県3条賃借権: pPSub.SetRsData Rs
                    Case state基盤所有権設定: pPSub.SetRsData Rs
                    Case state基盤利用権設定: pPSub.SetRsData Rs: b利用権設定 = True
                    Case state基盤利用権移転: pPSub.SetRsData Rs: b利用権移転 = True
                    Case state20条解約: pPSub.SetRsData Rs
                    Case state合意解約: pPSub.SetRsData Rs
                    Case state4条転用: pPSub.SetRsData Rs
                    Case state5条所有権: pPSub.SetRsData Rs
                    Case state5条賃借権: pPSub.SetRsData Rs
                    Case state農地改良届: pPSub.SetRsData Rs
                    Case state農用地計画変更: pPSub.SetRsData Rs
                    Case state農地利用変更: pPSub.SetRsData Rs
                    Case state事業計画変更: pPSub.SetRsData Rs
                    Case state非農地証明: pPSub.SetRsData Rs
                    Case stateあっせん出手: pPSub.SetRsData Rs
                    Case stateあっせん受手: pPSub.SetRsData Rs
                    Case state奨励金交付A: pPSub.SetRsData Rs
                    Case state奨励金交付B: pPSub.SetRsData Rs
                    Case state買受適格耕公: pPSub.SetRsData Rs
                    Case state買受適格耕競: pPSub.SetRsData Rs
                    Case state買受適格転公: pPSub.SetRsData Rs
                    Case state買受適格転競: pPSub.SetRsData Rs
                End Select
                Rs.MoveNext
            Loop
            SystemDB.CloseRs Rs
            mvarParent.MaxPage = 1
            If b利用権設定 Then mCol("n61").SetData sKey
            If b利用権移転 Then mCol("n61").SetData sKey
            
            n = 1
            For Each pNode In mvarParent.Nodes
                Set pPSub = mCol(pNode.Key)
                If pPSub.StartPage > 1 Then
                    n = pPSub.StartPage + pPSub.MaxPage
                ElseIf pPSub.StartPage = 1 Then
                    pPSub.StartPage = n
                    n = pPSub.StartPage + pPSub.MaxPage
                Else
                    n = pPSub.StartPage + pPSub.MaxPage - (pPSub.StartPage = 0)
                End If
            Next
            
            CPrintCls_DataInit = False
        Else
            CPrintCls_DataInit = True
        End If
        
        Exit Function
    DataInitError:
        CPrintCls_DataInit = True
    End Function
    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property
    Private Property Let CPrintCls_Key(ByVal RHS As String): mvarPTypeKye = RHS: End Property
    Private Property Get CPrintCls_Key() As String: CPrintCls_Key = mvarPTypeKye: End Property
    
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants
        Select Case SystemDB.DBProperty("市町村名")
            Case "東市来町": CPrintCls_Orientation = vbPRORPortrait
            Case Else
                CPrintCls_Orientation = vbPRORLandscape
        End Select
    End Property
    
    Private Property Get CPrintCls_PaperSize() As Long
        CPrintCls_PaperSize = vbPRPSA4
    End Property
    Private Property Set CPrintCls_Parent(RHS As ADBasicLIB2.CPrintFormSK): Set mvarParent = RHS: End Property
    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&): CPrintCls_Repaint: End Sub
    
    Private Function PrintCtrl(sKey As String, nPage As Long) As Boolean
        Dim pPSub As CPrintSub
        PrintCtrl = True
        If sKey = "" Then Exit Function
        Set pPSub = mCol(sKey)
        Select Case sKey
            Case "n10": Page通知書 sKey
            Case "n30": pPSub.PrintSub sKey, nPage, mvarParent
            Case "n31": pPSub.PrintSub sKey, nPage, mvarParent
            Case "n32": pPSub.PrintSub sKey, nPage, mvarParent
            Case "n40": pPSub.PrintSub sKey, nPage, mvarParent
            Case "n50": pPSub.PrintSub sKey, nPage, mvarParent
            Case "n51": pPSub.PrintSub sKey, nPage, mvarParent
            Case "n60": pPSub.PrintSub sKey, nPage, mvarParent
            Case "n61": pPSub.PrintSub sKey, nPage, mvarParent
            Case "n62": pPSub.PrintSub sKey, nPage, mvarParent
            Case "n200": pPSub.PrintSub sKey, nPage, mvarParent
            Case "n210": pPSub.PrintSub sKey, nPage, mvarParent
            Case "n302": pPSub.PrintSub sKey, nPage, mvarParent
            Case "n303": pPSub.PrintSub sKey, nPage, mvarParent
            Case "n500": pPSub.PrintSub sKey, nPage, mvarParent
            Case "n400": pPSub.PrintSub sKey, nPage, mvarParent
            Case "n401": pPSub.PrintSub sKey, nPage, mvarParent
            Case "n600": pPSub.PrintSub sKey, nPage, mvarParent
            Case "n801": pPSub.PrintSub sKey, nPage, mvarParent
            Case "n802": pPSub.PrintSub sKey, nPage, mvarParent
            Case "n803": pPSub.PrintSub sKey, nPage, mvarParent
            Case "n804": pPSub.PrintSub sKey, nPage, mvarParent
            Case "n990": pPSub.PrintSub sKey, nPage, mvarParent
            Case "n991": pPSub.PrintSub sKey, nPage, mvarParent
            Case "利用変更": Page6
            Case "農地改良届": pPSub.PrintSub sKey, nPage, mvarParent
            Case ""
            Case Else
                PrintCtrl = False
        End Select
    End Function
    
    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        Dim pNode As Object
        Dim pPSub As CPrintSub
        Dim Ar As Variant
        Dim Cm As Variant
        Dim n As Long
        Dim B As Boolean
        Dim i As Long
        
        With mvarParent
            If bNowPage Then
                PrintCtrl .SelectedKey, .Page
                .EndDoc
            Else
                For i = 1 To .PluralNumber
                    For Each pNode In .Nodes
                        If pNode.Checked Then
                            B = False
                            .ChangeLayout CPrintCls_PaperSize, CPrintCls_Orientation
                            Set pPSub = mCol(pNode.Key)
                            Select Case pNode.Key
                                Case "n30", "n31": .MaxPage = pPSub.MaxPage
                                Case Else: .MaxPage = pPSub.MaxPage
                            End Select
                            .PrintMaxPage = .MaxPage
                            For n = IIf(nStart > 0, nStart, 1) To IIf(nEnd > 0 And nStart >= nEnd, nEnd, IIf(nStart > 0, nStart, .PrintMaxPage))
                                B = B Or PrintCtrl(pNode.Key, n)
                                .NewPage
                            Next
                            If B Then .EndDoc
                            If i = .PluralNumber Then pNode.Checked = False
                        End If
                    Next
                Next
            End If
        End With
    End Sub
    
    Private Sub CPrintCls_Repaint(): PrintCtrl mvarParent.SelectedKey, mvarParent.Page: End Sub
    
    Private Sub Page通知書(sKey As String)
    End Sub
    
    Private Sub Page6()
        Dim sData As String
        Dim Ar As Variant, Cm As Variant
        
        Dim hFTop As Variant                                                'hFTop→表フッター(合計の枠)の上下移動
        Dim nPit As Single, HH As Single, Rows As Long, Ay As Variant       'DX1個目
        Dim nPit1 As Single, HH1 As Single, Rows1 As Long, Ay1 As Variant   'DX2個目
        Dim nPit2 As Single, HH2 As Single, Rows2 As Long, Ay2 As Variant   'DX3個目(合計の枠)
        
        sData = mvarParent.Nodes(sKey).Tag
        
        hFTop = HH1 + Rows1 * nPit1   '合計上下ずらし

    '-----------------------役場カスタム
        Select Case s市町村
        Case "さつま町"
            HH = 18     'ヘッダーの高さ
            Rows = 0    '何セル分
            nPit = 0    '表の中の繰り返しの巾
            Ay = GetArray(60, 45, 12, 25, 6)
            
            HH1 = 0     'ヘッダーの高さ
            Rows1 = 4   '何セル分
            nPit1 = 30  '表の中の繰り返しの巾
            Ay1 = GetArray(6, 60, 45, 12, 25, 6, 41, 41, 20)
            
            HH2 = 24    'ヘッダーの高さ
            Rows2 = 0   '何セル分
            nPit2 = 0   '表の中の繰り返しの巾
            Ay2 = GetArray(111, 12, 31, 102)
        End Select
    '----------------------------------
    '----------------------------------
            With mvarParent
                .ClearScreen
                .Offset -7, 0
    '----------------------------------
    '----------------------------文字埋め
            Select Case s市町村
            Case "さつま町"
                .TextOut "日程第○号" & "　" & "第○号議案", 16, 13, 13, 0, 2
                .TextOut "農地利用変更届について", 20, 20, 14, 0, 2
                
                .hTextOut "番号", 16, 29.5, 1, 10, 11
                .TextOut "申  請  人", 51, 27, 11, 2, 2
                .TextOut "氏　名", 51, 34.5, 11, 2, 2
                .TextOut "住　所", 51, 43.5, 11, 2, 2
                .TextOut "申        請        地", 129.5, 27, 11, 2, 2
                .TextOut "所　　　在", 103.5, 38.5, 11, 2, 2
                .TextOut "地 目", 132, 32.5, 11, 2, 2
                .hTextOut "登記", 127, 36.5, 1, 6, 11
                .hTextOut "現況", 133, 36.5, 1, 6, 11
                .DrawText "面 積\n(u)", 144.5, 34, 12, 6, 11, 2
                .hTextOut "区分", 164, 32, 1, 9, 11
                .TextOut "変更後の使用目的", 190, 36, 11, 2, 2
                .TextOut "備　　　考", 231, 36, 11, 2, 2
                .TextOut "承認区分", 261, 36, 11, 2, 2
    '----------------------------表作成
                .DBox 15, 24, 21, 48                                '番号
                .DLine 126, 35, 138, 35                             '地目の下の横線
                .DLine 132, 35, 132, 48                             '地目の真中下の縦線
                .DLine 21, 24, 169, 24                              '申請人&申請地の上の横線
                .DLine 81, 24, 81, 30                               '申請人&申請地の間の縦線
                .DLine 169, 24, 169, 30                             '申請地&申請事由の間の縦線
                .LineBoxDX 21, 30, HH, Rows, nPit, Ay               '申請人→申請事由の下の枠
                .LineX 169, 210, 24, 2, 24                          '解約の理由の上&下の横線
                .LineBox 210, 24, 271, 48, 1, 1, 41                 '解約の条件&備考の枠
    
                .LineBoxDX 15, 48, HH1, Rows1, nPit1, Ay1           '表(Rowsの数だけ)
                .LineBoxDX 15, 48 + hFTop, HH2, Rows2, nPit2, Ay2   '表(合計の枠)
    '----------------------------文字埋め
            End Select
        End With
    End Sub
    Private Sub CPrintCls_TargetChange(sKey As String)
        Dim pPSub As CPrintSub
        mvarKey = sKey
        With mvarParent
            Set pPSub = mCol(sKey)
            Select Case sKey
                Case Else: .MaxPage = pPSub.MaxPage: .Page = pPSub.NowPage
            End Select
        End With
        CPrintCls_Repaint
    End Sub

End Class










Class CPrint許可書
    Option Explicit
    Implements ADBasicLIB2.CPrintCls
    Private mvarParent As ADBasicLIB2.CPrintFormSK
    Private mvarKey As String
    Private mvarData As String
    Private b不許可 As Boolean
    Private s権利の内容 As String
    Private s不許可の理由 As String
    Private n田面積 As Double
    Private n畑面積 As Double
    Private n計面積 As Double
    Private s法令Key As String
    Private n農地位置 As Long
    Private s教示(9) As String
    Private s都道府県 As String
    Private s法令 As String
    Private s指令日 As String
    Private b県許可 As Boolean
    Private dt発効日 As Date
    Private Ay As Variant
    Private Ar As Variant, Cx As Variant, Cy As Variant
    Private s許可文 As String
    Private s郵便番号(2) As String
    
    Private mvarPData As mod農家台帳.PrnData
    Private dX(5) As Single, hX(5) As Single
    
    Private Property Get CPrintCls_CanCancelPrint() As Boolean: End Property
    Private Property Get CPrintCls_CanPrintNowPage() As Boolean: End Property

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean
        Dim Ar As Variant
        
        Ar = Split(sParam, vbFormFeed)
        Select Case UBound(Ar)
            Case 0: s法令Key = Fnc.GetKeyHead(Ar(0))
                    dt発効日 = Now
            Case 1: s法令Key = Fnc.GetKeyHead(Ar(0))
                    dt発効日 = CDate(Ar(1))
        End Select
        b県許可 = SystemDB.DBProperty("県許可")
        With mvarPData
            .市町村 = SystemDB.DBProperty("市町村名")
            .都道府県名 = SystemDB.DBProperty("都道府県名")
            .会長名 = SystemDB.DBProperty("会長名")
            .会長肩書 = IIf(Val(SystemDB.DBProperty("会長代理")), "農業委員会会長代理", "農業委員会会長")
        End With
        
        mvarData = ""
        Select Case s法令Key
            Case "3条": s法令 = 3: CPrintCls_DataInit = Not Init農地異動許可(sParam)
            Case "利用権": s法令 = 6: CPrintCls_DataInit = Not Init農地異動許可(sParam)
            Case "4条": s法令 = 4: CPrintCls_DataInit = Not Init転用許可(sParam)
            Case "5条": s法令 = 5: CPrintCls_DataInit = Not Init転用許可(sParam)
            Case Else
                Debug.Assert CaseAssertPrint(s法令Key)
        End Select
        
    End Function

    Private Function Init農地異動許可(ByVal sParam As String) As Boolean
        Dim Cm As Variant
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim RpA As ADBasicLIB2.RecordsetEx
        Dim RpB As ADBasicLIB2.RecordsetEx
        Dim Rt As ADBasicLIB2.RecordsetEx
        Dim n As Long
        Dim i As Long
        
        Init農地異動許可 = True
        If b県許可 Then s指令日 = SystemDB.DBProperty("３条指令日")
        
        n田面積 = 0
        n畑面積 = 0
        
        b不許可 = False
        If InStr(sParam, "不許可") Then b不許可 = True: sParam = Left$(sParam, Len(sParam) - 3)
        
        Set Rs = SystemDB.GetRecordsetEx("SELECT * FROM [D_申請] WHERE [ID]=" & Fnc.GetKeyCode(sParam), , , "許可書Init")
        mvarData = Rs.NullCast("許可番号", "")
        
        If Not b不許可 Then
        ElseIf Not Rs.IsNull("不許可理由") Then
            s不許可の理由 = Trim(Rs.Value("不許可理由"))
        ElseIf Fnc.InputTextEx("不許可の理由", "不許可の理由を入力してください", s不許可の理由, 0, vbIMEHiragana) Then
            Rs.Update "不許可理由", Trim(s不許可の理由)
        Else
            Init農地異動許可 = False
            SystemDB.CloseRs Rs
            Exit Function
        End If
        
        If Not Rs.IsNull("申請者B") Then
            Set RpB = SystemDB.GetRecordsetEx("SELECT [郵便番号],[住所] AS 住所, [D:個人Info].氏名 FROM [D:個人Info] WHERE [ID]=" & Rs.Value("申請者B"), , , "許可書2")
            If RpB.EOF Then
                mvarData = mvarData & ";;"
            Else
                If mvarPData.市町村 = "大崎町" Then
                    mvarData = mvarData & ";" & Fnc.GetShortAddr(StrConv(Fnc.NullCast(RpB.Value("住所"), "住所がありません。"), vbNarrow), "", s都道府県)
    '                ElseIf mvarPData.市町村 = "姶良市" Then
    '                    mvarData = mvarData & ";" & LongAddr(RpB.NullCast("住所", "住所がありません。"))
                Else
                    mvarData = mvarData & ";" & Fnc.GetShortAddr(StrConv(Fnc.NullCast(RpB.Value("住所"), "住所がありません。"), vbNarrow), SystemDB.DBProperty("郡部"), s都道府県)
                End If
                mvarData = mvarData & ";" & RpB.Value("氏名")
                s郵便番号(0) = RpB.Value("郵便番号")
                If Not Rs.Value("法令") = 61 Then
                ElseIf Not SystemDB.RecordExists("X_住所リスト", "[作成年月日]=#" & Format$(Rs.V("許可年月日"), "YYYY/MM/DD") & "# AND [作成目的]='決定通知書' AND [氏名]='" & RpB.Value("氏名") & "'") Then
                    SystemDB.Execute "INSERT INTO X_住所リスト(作成目的,作成年月日,氏名,郵便番号,住所) VALUES('決定通知書',#" & Format$(Rs.V("許可年月日"), "YYYY/MM/DD") & "#,'" & RpB.Value("氏名") & "','" & RpB.Value("郵便番号") & "','" & RpB.Value("住所") & "')"
                End If
            End If
            SystemDB.CloseRs RpB
            
        Else
            mvarData = mvarData & ";;"
        End If
        mvarData = mvarData & ";" & CStr(Rs.Value("受付年月日"))
        
        Select Case Rs.Value("法令")
            Case 30: mvarData = mvarData & ";所有権;移転"
                s権利の内容 = "所有権の移転"
            Case 31, 33, 61:
                Select Case Rs.Value("権利種類")
                    Case 1:
                        mvarData = mvarData & ";賃借権"
                        s権利の内容 = "賃借権の設定"
                    Case 2:
                        mvarData = mvarData & ";使用貸借権"
                        s権利の内容 = "使用貸借権の設定"
                    Case Else
                        mvarData = mvarData & ";使用貸借権"
                        s権利の内容 = "使用貸借権の設定"
                End Select
                mvarData = mvarData & ";設定"
            Case Else
                mvarData = mvarData & ";;"
        End Select
        mvarData = mvarData & ";" & CStr(Rs.Value("許可年月日"))
        mvarData = mvarData & ";" & mvarPData.市町村
        mvarData = mvarData & ";" & mvarPData.会長名
                
        If Len(Trim(Rs.Value("代理人名"))) Then
            mvarData = mvarData & ";" & Rs.Value("住所A") & ";" & Rs.Value("代理人名")
                    
        ElseIf Not Rs.IsNull("申請者A") Then
            Set RpA = SystemDB.GetRecordsetEx("SELECT [郵便番号],[住所], [D:個人Info].氏名 FROM [D:個人Info] WHERE [ID]=" & Rs.Value("申請者A"), , , "許可書3")
            If RpA.EOF Then
                mvarData = mvarData & ";;"
            Else
                If mvarPData.市町村 = "大崎町" Then
                    mvarData = mvarData & ";" & Fnc.GetShortAddr(StrConv(IIf(IsNull(RpA.Value("住所")), "住所がありません。", RpA.Value("住所")), vbNarrow), "", s都道府県)
'                ElseIf mvarPData.市町村 = "姶良市" Then
'                    mvarData = mvarData & ";" & LongAddr(RpA.NullCast("住所", "住所がありません。"))
                Else
                    mvarData = mvarData & ";" & Fnc.GetShortAddr(StrConv(IIf(IsNull(RpA.Value("住所")), "住所がありません。", RpA.Value("住所")), vbNarrow), SystemDB.DBProperty("郡部"), s都道府県)
                End If
                mvarData = mvarData & ";" & RpA.Value("氏名")
                s郵便番号(1) = RpA.Value("郵便番号")
            End If
            
            If Not Rs.Value("法令") = 61 Then
            ElseIf Not SystemDB.RecordExists("X_住所リスト", "[作成年月日]=#" & Format$(Rs.V("許可年月日"), "YYYY/MM/DD") & "# AND [作成目的]='決定通知書' AND [氏名]='" & RpA.Value("氏名") & "'") Then
                SystemDB.Execute "INSERT INTO X_住所リスト(作成目的,作成年月日,氏名,郵便番号,住所) VALUES('決定通知書',#" & Format$(Rs.V("許可年月日"), "YYYY/MM/DD") & "#,'" & RpA.Value("氏名") & "','" & RpA.Value("郵便番号") & "','" & RpA.Value("住所") & "')"
            End If
            
            SystemDB.CloseRs RpA
        Else
            mvarData = mvarData & ";;"
        End If
        mvarData = mvarData & ";" & Rs.NullCast("条件A", "")
        mvarData = mvarData & ";" & Rs.NullCast("条件B", "")
        mvarData = mvarData & ";" & Rs.NullCast("総会番号", "")
        mvarData = mvarData & ";" & Rs.NullCast("受付番号", "")
        mvarData = mvarData & ";" & Rs.NullCast("許可補助記号", "")
        mvarData = mvarData & ";" & IIf(Rs.IsNull("始期") Or Rs.Value("始期") = "0:00:00", "", Rs.Value("始期"))
        mvarData = mvarData & ";" & IIf(Rs.IsNull("終期") Or Rs.Value("終期") = "0:00:00", "", Rs.Value("終期"))
        If IsNull(Rs.Value("期間")) Or Rs.Value("期間") = 0 Then
            mvarData = mvarData & ";" & DateDiff("yyyy", Rs.Value("始期"), Rs.Value("終期"))
        Else
            mvarData = mvarData & ";" & Rs.Value("期間")
        End If
        mvarData = mvarData & ";" & Rs.NullCast("小作料", 0)
        mvarData = mvarData & ";" & Rs.NullCast("小作料単位", "")
        mvarData = mvarData & ";" & IIf(Rs.IsNull("公告年月日") Or Rs.Value("公告年月日") = "0:00:00", "", Rs.Value("公告年月日")) & vbCrLf
        
        n農地位置 = 22
        If b県許可 Then
            Set Rt = SystemDB.GetRecordsetEx("SELECT [土地所在] AS 所在2, V_農地.田面積, V_農地.畑面積, V_地目.名称 AS 登記地目名, V_地目_1.名称 AS 現況地目名, V_農地.農委地目ID, V_農地.農委地目認定日, V_農委地目.名称 AS 農委地目 FROM ((V_農地 LEFT JOIN V_地目 ON V_農地.登記簿地目 = V_地目.ID) LEFT JOIN V_地目 AS V_地目_1 ON V_農地.現況地目 = V_地目_1.ID) LEFT JOIN V_農委地目 ON V_農地.農委地目ID = V_農委地目.ID WHERE (((V_農地.ID) In (" & Replace(Replace(Replace(Rs.Value("農地リスト"), "転用", ""), "農地.", ""), ";", ",") & ")))", , , "許可書4")
        ElseIf mvarPData.市町村 = "南種子町" Then
            Set Rt = SystemDB.GetRecordsetEx("SELECT V_農地.ID,V_農地.所在2, V_農地.田面積, V_農地.畑面積, V_地目.名称 AS 登記地目名, V_地目_1.名称 AS 現況地目名, V_農地.農委地目ID, V_農地.農委地目認定日, V_農委地目.名称 AS 農委地目,V_農地.一部現況,V_農地.登記簿面積 FROM ((V_農地 LEFT JOIN V_地目 ON V_農地.登記簿地目 = V_地目.ID) LEFT JOIN V_地目 AS V_地目_1 ON V_農地.現況地目 = V_地目_1.ID) LEFT JOIN V_農委地目 ON V_農地.農委地目ID = V_農委地目.ID WHERE (((V_農地.ID) In (" & Replace(Replace(Replace(Rs.Value("農地リスト"), "転用", ""), "農地.", ""), ";", ",") & ")))", , , "許可書4")
        Else
            Set Rt = SystemDB.GetRecordsetEx("SELECT [土地所在] AS 所在2, V_農地.田面積, V_農地.畑面積, V_地目.名称 AS 登記地目名, V_地目_1.名称 AS 現況地目名, V_農地.農委地目ID, V_農地.農委地目認定日, V_農委地目.名称 AS 農委地目 FROM ((V_農地 LEFT JOIN V_地目 ON V_農地.登記簿地目 = V_地目.ID) LEFT JOIN V_現況地目 AS V_地目_1 ON V_農地.現況地目 = V_地目_1.ID) LEFT JOIN V_農委地目 ON V_農地.農委地目ID = V_農委地目.ID WHERE (((V_農地.ID) In (" & Replace(Replace(Replace(Rs.Value("農地リスト"), "転用", ""), "農地.", ""), ";", ",") & ")))", , , "許可書4")
        End If
        n = 0
        Do Until Rt.EOF
            mvarData = mvarData & ";" & Replace(Rt.Value("所在2"), "字.", "") & vbTab & Rt.Value("登記地目名")
            If (Not IsNull(Rt.Value("農委地目ID"))) And (Not IsNull(Rt.Value("農委地目認定日"))) And (Rt.Value("農委地目認定日") <> "0:00:00") Then
                mvarData = mvarData & vbTab & Rt.Value("農委地目")
            Else
                mvarData = mvarData & vbTab & Rt.Value("現況地目名")
            End If
            If mvarPData.市町村 = "南種子町" Then
                mvarData = mvarData & vbTab & CStr(Fnc.NullCast(Rt.Value("田面積"), 0) + Fnc.NullCast(Rt.Value("畑面積"), 0)) & vbTab & CStr(Fnc.NullCast(Rt.Value("登記簿面積"), 0)) & vbTab & CStr(Fnc.NullCast(Rt.Value("一部現況"), 0))
                Set RpA = SystemDB.GetRecordsetEx("SELECT [部分面積] FROM [D_部分申請] WHERE ([申請ID]=" & Rs.Value("ID") & ") AND ([農地ID]=" & Rt.Value("ID") & ");", , , "許可書5")
                If RpA.EOF Then
                    mvarData = mvarData & vbTab & "0"
                Else
                    mvarData = mvarData & vbTab & CStr(Fnc.NullCast(RpA.Value("部分面積"), 0))
                End If
                
                Select Case s法令Key
                    Case "3条":
                        n田面積 = n田面積 + IIf(Fnc.NullCast(Rt.Value("田面積"), 0) > 0, Fnc.NullCast(Rt.Value("登記簿面積"), 0), 0)
                        n畑面積 = n畑面積 + IIf(Fnc.NullCast(Rt.Value("畑面積"), 0) > 0, Fnc.NullCast(Rt.Value("登記簿面積"), 0), 0)
                    Case "利用権":
                        n田面積 = n田面積 + Rt.NullCast("田面積", 0)
                        n畑面積 = n畑面積 + Rt.NullCast("畑面積", 0)
                End Select
                
                SystemDB.CloseRs RpA
            Else
                mvarData = mvarData & vbTab & CStr(Fnc.NullCast(Rt.Value("田面積"), 0) + Fnc.NullCast(Rt.Value("畑面積"), 0))
                n田面積 = n田面積 + Fnc.NullCast(Rt.Value("田面積"), 0)
                n畑面積 = n畑面積 + Fnc.NullCast(Rt.Value("畑面積"), 0)
            End If
            n = n + 1
            Rt.MoveNext
        Loop
        
        SystemDB.CloseRs Rt
        SystemDB.CloseRs Rs
                    
        If b不許可 Then
            mvarParent.MaxPage = 2 - (n > 5)
        ElseIf s法令Key = "利用権" Then
            n = n - (n田面積 > 0) - (n畑面積 > 0) - (n田面積 > 0 And n畑面積 > 0)
            If n <= 6 Then
                mvarParent.MaxPage = 2
            Else
                mvarParent.MaxPage = 2 + n \ 28 + IIf((n Mod 28) > 0, 1, 0)
            End If
        Else
            Ar = Split(mvarData, vbCrLf)
            Cm = Split(Ar(1), ";")
            
            Ar = UBound(Cm) - (n田面積 > 0) - (n畑面積 > 0) + IIf((n田面積 > 0) + (n畑面積 > 0) = -2, 1, 0)
            mvarParent.MaxPage = IIf(Ar > 10, 3, 2)
        End If
    
        If s法令Key = "3条" Then
            Ay = GetArray(72, 18, 18, 18, 38)
            dX(0) = 20
        Else
            Ay = GetArray(68, 18, 18, 22, 38)
            dX(0) = 25
        End If
        
        hX(0) = dX(0) + Ay(0) / 2
        
        If s法令Key = "3条" Then
            If b県許可 Then
                s教示(0) = "　この処分に不服があるときは，地方自治法第２５５条の２の規定により，この処分があったことを知った日から６０日以内（処分があったことを知った日の翌日から起算します。）に，審査請求書（行政不服審査法第１５条に規定する事項を記載しなければなりません。）正副２通を農林水産大臣に提出して審査請求をすることができます（なお，処分があったことを知った日から６０日以内であっても，処分の日から１年を経過したときは審査請求をすることはできません｡）。なお，審査請求書は，なるべく九州農政局長（熊本市二の丸１番２号）を経由して提出してください。"
                s教示(1) = "　この処分の取消しの訴えは，この処分があったことを知った日から６箇月以内（処分があったことを知った日の翌日から起算します。）に，" & mvarPData.市町村 & "を被告として（訴訟において" & mvarPData.市町村 & "を代表する者は" & mvarPData.市町村 & "農業委員会となります。），提起することができます（なお，処分があったことを知った日から６箇月以内であっても，処分の日から１年を経過したときは処分の取消しの訴えを提起することはできません。）。ただし，処分があったことを知った日から６０日以内に審査請求をした場合には，処分の取消しの訴えは，その審査請求に対する裁決の送達を受けた日から６箇月以内（送達を受けた日の翌日から起算します。）に提起することができるとされています。"
                s教示(2) = "　この処分の取消しの訴え（取消訴訟）は，処分についての審査請求に対する裁決を経た後でなければ提起することができませんが，次の@からBまでのいずれかに該当するときは，審査請求に対する裁決を経ないで処分の取消の訴えを提起することができます。\n@　審査請求があった日から３箇月を経過しても裁決がないとき。\nA　処分の執行又は手続の続行により生ずる著しい損害を避けるため緊急の必要があるとき。\nB　その他裁決を経ないことにつき正当な理由があるとき。"
            ElseIf mvarPData.市町村 = "姶良市" Then
                s教示(0) = "　この処分に不服があるときは，地方自治法第２５５条の２の規定によりこの処分があったことを知った日から６０日以内（処分があったことを知った日の翌日から起算します。）に，審査請求書（行政不服審査法第１５条に規定する事項を記載しなければなりません。）正副２通を鹿児島県知事に提出して審査請求をすることができます。（なお，処分があったことを知った日から６０日以内であっても，処分の日から１年を経過したときは審査請求をすることはできません｡）"
                s教示(1) = "　この処分の取消しの訴えは，この処分についての審査請求に対する採決があったことを知った日から６箇月以内（採決があったことを知った日の翌日から起算します。）に，市町村を被告として（訴訟において市町村を代表する者は農業委員会となります。），提起することができます。（なお，処分についての審査請求があったことを知った日から６箇月以内であっても，裁決の日から１年を経過したときは処分の取消しの訴えを提起することはできません。）"
                s教示(2) = "　この処分の取消しの訴えは，農地法第85条の2の規定により，この処分についての審査請求に対する裁決を経た後でなければ提起することができませんが，次の@からBまでのいずれかに該当するときは，審査請求に対する裁決を経ないで処分の取消の訴えを提起することができます。\n　この場合においては，処分の取消しの訴えはしょぶんがあったことを知った日から６箇月以内（処分があったことを知った日の翌日から起算します。）に提起することができます。（なお，処分があったことを知った日から６箇月以内であっても，処分の日から１年を経過したときは，処分の取消しの訴えを提起することはできません。）\n@　審査請求があった日から３箇月を経過しても裁決がないとき。\nA　処分，処分の執行又は手続の続行により生ずる著しい損害を避けるため緊急の必要があるとき。\nB　その他裁決を経ないことにつき正当な理由があるとき。"
            Else
                s教示(0) = "この処分に不服があるときは、行政不服審査法第５条１項の規定により、" & _
                           "この処分があったことを知った日の翌日から起算して60日以内に" & _
                           "鹿児島県知事に審査請求書(同法第15条に規定する事項を記載しな" & _
                           "ければなりません｡)正副２通を提出して審査請求をすることができます。"
                
            End If
        End If
        
        For i = 0 To UBound(Ay)
            dX(i + 1) = dX(i) + Ay(i)
            If i < UBound(Ay) Then hX(i + 1) = dX(i + 1) + Ay(i + 1) / 2
        Next
    End Function

    Private Function Init転用許可(ByVal sParam As String) As Boolean
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim sData As Variant
        Dim n As Long
        Dim i As Long
        Dim St As String

        Init転用許可 = True
        
        With SystemDB
            Set Rs = .GetRecordsetEx("SELECT * FROM [D_申請] WHERE [ID]=" & Fnc.GetKeyCode(sParam), 0, , Me)
                mvarData = Rs.NullCast("許可番号", "") & ";" & Rs.Value("申請理由A") & ";" & Rs.Value("住所A") & ";" & Rs.Value("氏名A") & IIf(s法令 = "5", ";" & Rs.Value("住所B") & ";" & Rs.Value("氏名B"), "")

                St = Replace(Replace(Rs.Value("農地リスト"), "転用", ""), "農地.", ",")
            .CloseRs Rs

            Cy = Split(mvarData, ";")

            sData = Null
            Set Rs = .GetRecordsetEx("SELECT [V_大字].[名称] & '字' & [V_小字].[名称] & [D_転用農地].[地番] AS 土地の所在, V_地目.名称 AS 登記, V_地目_1.名称 AS 現況, D_転用農地.登記簿面積 FROM (((D_転用農地 LEFT JOIN V_大字 ON D_転用農地.大字ID = V_大字.ID) LEFT JOIN V_小字 ON D_転用農地.小字ID = V_小字.ID) LEFT JOIN V_地目 ON D_転用農地.登記簿地目 = V_地目.ID) LEFT JOIN V_地目 AS V_地目_1 ON D_転用農地.現況地目 = V_地目_1.ID WHERE (((D_転用農地.ID) In (" & MID(Replace(St, ";", ""), 2) & ")));", 0, , Me)
                sData = Rs.GetString(vbTab, vbBack)
            .CloseRs Rs

            Set Rs = .GetRecordsetEx("SELECT 受付年月日,法令,許可番号 FROM D_申請 WHERE [ID]=" & Fnc.GetKeyCode(sParam), 0, , Me)
                '2009/05/21
                sData = sData & vbCr & Rs.Value("受付年月日") & IIf(Rs.Value("法令") = 50, vbTab & "所有権の移転", IIf(Rs.Value("法令") = 51, vbTab & "賃借権の設定", vbTab)) & IIf(mvarPData.市町村 = "大崎町", vbTab & Rs.Value("許可番号"), IIf(mvarPData.市町村 = "長島町", vbTab & Rs.Value("許可番号"), vbTab))
                'sData = sData & vbCr & Rs.Value("受付年月日") & IIf(Rs.Value("法令") = 50, vbTab & "所有権の移転", IIf(Rs.Value("法令") = 51, vbTab & "賃借権の設定", vbTab)) & IIf(mvarPData.市町村 = "長島町", vbTab & Rs.Value("許可番号"), vbTab)
            .CloseRs Rs
            Ar = Split(sData, vbBack)
            Cx = Split(MID(Ar(UBound(Ar)), 2), vbTab)
        End With

        s教示(0) = "３　条件"
        s教示(1) = "(1)　申請書に記載された事業計画に従って事業の用に供すること。"
        s教示(2) = "(2)　許可に係る工事が完了するまでの間，本件許可の日から３ヶ月後及びその後１年ごとに工事の進捗状況を農業委\n   員会会長あてに，報告すること。また，許可に係る工事が完了したときは，同様に遅滞なくその旨を報告すること。"
        s教示(3) = "(3)　平成　　年　　月　　日までに農地に復元すること。\n ｢注意事項｣"
        s教示(4) = "・申請書に記載された事業計画（用途，施設の配置，着工及び完工の時期，被害防除措置等を含む）に従って，その\n事業の用に供しないときは，農地法第８３条の２の規定によりその許可を取り消し，条件を変更し，若しくは新たに\n条件を附し，又は工事その他の行為の停止を命じ，若しくは原状回復の措置等をとるべきことを命ずることがありま\nす。"
        s教示(5) = "｢教示｣"
        s教示(6) = "　この処分に不服があるときは，行政不服審査法第６条の規定により，この処分があったことを知った日の翌日から\n起算して60日以内に農業委員会会長に異議申立てをすることができます。（なお，処分があったことを知った日の翌\n日から起算して60日以内であっても，処分があった日の翌日から起算して１年を経過したときは異議申立てをするこ\nとはできません。）"
        s教示(7) = "　この処分の取消しの訴え（取消訴訟）は，処分についての異議申立てに対する決定を経た後でなければ提起するこ\nとができます。\n@　異議申立てがあった日から３箇月を経過しても決定がないとき。\nA　処分，処分の執行又は手続の続行により生ずる著しい損害を避けるため緊急の必要があるとき。\nB　その他決定を経ないことにつき正当な理由があるとき。"
        s教示(8) = "　この処分の取消しの訴え（取消訴訟）は，異議申立てに対する決定があったことを知った日の翌日から起算して６箇月以内に，" & mvarPData.市町村 & "農業委員会を被告として，提起することができます。（なお，決定があったことを知った日の翌日から起算して６箇月以内であっても，当該決定の日の翌日から起算して１年を経過したときは，正当の理由がない限り，取消訴訟は提起することができません。）"
        s教示(9) = "　この処分に対する不服の理由が鉱業，採石業又は砂利採取業との調整に関するものであるときは，農地法第８５条\n第６項の規定により，この処分があったことを知った日の翌日から起算して６０日以内に，公害等調整委員会に裁定\n申請書（鉱業等に係る土地利用の調整手続等に関する法律第２５条の２第２項に規定する事項を記載しなければなり\nません。）正本１通及び副本２通を提出して裁定の申請をすることができます。"


        Select Case mvarPData.市町村
            '2009/05/22
            Case "大崎町"
                s許可文 = Left(mvarPData.市町村, 1) & "農委第 " & StrConv(s法令, vbWide) & " 号" & "の " & Cy(0)
            Case "長島町"
                s許可文 = "指令農委第 " & StrConv(s法令, vbWide) & " 号 " & StrConv(Cy(0), vbWide)
            Case Else
                s許可文 = "指令農委第" & StrConv(s法令, vbWide) & " 号" & "の " & Cy(0)
        End Select

        With mvarParent
            .表示倍率 = 0.75
            .MaxPage = IIf(s法令 = "4", 1, 2)
            .Page = 1
        End With
    End Function

    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property
    
    Private Property Let CPrintCls_Key(ByVal RHS As String): mvarKey = RHS: End Property
    Private Property Get CPrintCls_Key() As String: CPrintCls_Key = mvarKey: End Property

    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants: CPrintCls_Orientation = vbPRORPortrait: End Property

    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&): CPrintCls_Repaint: End Sub

    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Set CPrintCls_Parent(RHS As ADBasicLIB2.CPrintFormSK): Set mvarParent = RHS: End Property

    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        Dim nPage As Long
        Dim nMaxPage As Long
        Dim n As Long
        Dim NN As Long
        NN = SystemDB.DBPropertyEx("3条許可書部数", vbLong, 1)
        If NN = 0 Then NN = 1
        With mvarParent
            Select Case s法令Key
                Case "3条"
                    For n = 1 To NN
                        PrintSub3条 1: .NewPage
                        If .MaxPage > 2 Then PrintSub3条 3: .NewPage
                        PrintSub3条 2: .NewPage
                        If .MaxPage > 2 Then PrintSub3条 3: .NewPage
                    Next
                    .EndDoc
                Case "利用権"
                    nPage = 1
                    nMaxPage = .MaxPage
                    Do Until nPage > nMaxPage
                        If nPage > 2 Then
                            PrintSub利用権 nPage
                            .NewPage
                            PrintSub利用権 nPage
                            .NewPage
                        Else
                            PrintSub利用権 nPage
                            .NewPage
                        End If
                        nPage = nPage + 1
                    Loop
                    .EndDoc
                Case "4条"
                    PrintSub4条
                    .NewPage
                    .EndDoc
                Case "5条"
                    nPage = 1
                    nMaxPage = .MaxPage
                    Do Until nPage > nMaxPage
                        PrintSub5条 nPage
                        .NewPage
                        nPage = nPage + 1
                    Loop
                    .EndDoc
            End Select
        End With
    End Sub

    Private Sub CPrintCls_Repaint()
        
        Select Case s法令Key
            Case "3条": PrintSub3条 mvarParent.Page
            Case "利用権": PrintSub利用権 mvarParent.Page
            Case "4条": PrintSub4条
            Case "5条": PrintSub5条 mvarParent.Page
        End Select
    End Sub

    Private Sub CPrintCls_TargetChange(sKey As String): End Sub

    Private Sub PrintSub3条(ByVal n相手 As Long)
        Dim Ar As Variant, Cm As Variant
        Dim y As Single
        Dim i As Long, n As Long
        Dim nPit As Single, HH As Single, Rows As Long
        Dim n指令日 As Long
        n指令日 = Val(s指令日)
        
        nPit = 6
        HH = 12
        
        Ay = GetArray(72, 36, 18, 38)
        With mvarParent
            .ClearScreen
            If b県許可 Then
                .Offset -3, -20
            ElseIf mvarPData.市町村 = "姶良市" Then
                .Offset -3, -20
            Else
                .Offset 0, 0
            End If
            
            If Len(mvarData) = 0 Then Exit Sub
            Ar = Split(mvarData, ";")

            If n相手 > 2 Then
                y = 38
                Rows = 35
                .TextOut "(別紙)    許可する農地", 21, 26, 11
                n = 0
                For i = n農地位置 To n農地位置 + Rows - 3
                    If UBound(Ar) < i Then Exit For
                    Cm = Split(Ar(i), vbTab)
                    .TextOut Cm(0), 24, 51 + n * 6, 10
                    .TextOut Cm(1), 101, 51 + n * 6, 10, 2
                    .TextOut Cm(2), 119, 51 + n * 6, 10, 2
                    If mvarPData.市町村 = "南種子町" Then
                        .TextOut pFormatN(CCur(Cm(4))), 144, 51 + n * 6, 10, 1
                        If Val(Cm(5)) > 0 Then
                            .TextOut "の内" & pFormatN(CCur(Cm(3))) & "u", 147, 51 + n * 6, 10
                        ElseIf Val(Cm(6)) > 0 Then
                            .TextOut "の内" & pFormatN(CCur(Cm(6))) & "u", 147, 51 + n * 6, 10
                        End If
                    Else
                        .TextOut FormatNumber(Val(Cm(3)), 0), 144, 51 + n * 6, 10, 1
                    End If
                    n = n + 1
                Next
                .TextOut "  以  下  余  白", dX(0) + 4, 51 + n * 6, 10
                            
                .TextOut "田 計", hX(2), y - 5 + Rows * 6, 10, 2
                .TextOut "畑 計", hX(2), y + 1 + Rows * 6, 10, 2
                .TextOut "合 計", hX(2), y + 7 + Rows * 6, 10, 2
                .TextOut pFormatN(CCur(n田面積)), dX(4) - 1, y - 5 + Rows * 6, 10, 1
                .TextOut pFormatN(CCur(n畑面積)), dX(4) - 1, y + 1 + Rows * 6, 10, 1
                .TextOut pFormatN(CCur(n田面積 + n畑面積)), dX(4) - 1, y + 7 + Rows * 6, 10, 1
            Else
                .TextOut "様式第２号", 21, 26, 11
                .TextOut "申請人", 67, 46, 11
                Select Case mvarPData.市町村
                    Case "さつま町": .TextOut StrConv("さ農委指令第３号−" & Ar(0), vbWide), 145, 36, 11
                    Case "枕崎市": .TextOut "指令枕農委第" & Ar(0) & "号", 145, 36, 11
                    Case "南種子町":
                        .TextOut "指令 南農委第３号" & Ar(0), 145, 33, 11
                        .TextOut "( " & Ar(13) & "回−" & Ar(14) & " )", 158, 37, 11
                    Case "日置市":
                        Select Case Ar(15)
                            Case "本": .TextOut "日指令", 140, 36, 10, 1
                            Case "東", "日", "吹": .TextOut "日" & Ar(15) & "指令", 140, 36, 10, 1
                            Case Else: .TextOut "指令", 140, 36, 10, 1
                        End Select
                        .TextOut "第", 145, 36, 11
                        .TextOut Ar(0) & " 号", 170, 36, 10, 1, 11
                    Case "大崎町": .TextOut "指令大農委第 " & n指令日 & " 号の " & Ar(0), 145, 36, 11
                    Case Else
                        .TextOut "指令", 130, 36, 11
                        .TextOut "第", 145, 36, 11
                        .TextOut Ar(0) & " 号", 170, 36, 10, 1, 11
                End Select
                .TextOut "住所（所在地）:", 81.5, 46, 11
                
                Select Case n相手
                    Case 1: .DrawText StrConv(Ar(1), vbNarrow), 116.5, 46, 80, 6, 11
                            .TextOut "氏名（名　称）:  " & Ar(2), 81.5, 56, 11
                    Case 2: .DrawText StrConv(Ar(9), vbNarrow), 116.5, 46, 80, 6, 11
                            .TextOut "氏名（名　称）:  " & Ar(10), 81.5, 56, 11
                End Select
                
                If b不許可 Then
                    .TextOut Format(CDate(Ar(3)), "GGG E年 M月 D日") & " 付けで農地法第３条第１項の規定による許可申請のあった農地につい", 23, 65, 11
                    .TextOut Format(CDate(Ar(6)), "GGG E年 M月 D日"), 23, 80, 11
                    .TextOut Ar(7) & " " & mvarPData.会長肩書 & "  " & Ar(8), 96, 86, 11
                    .TextOut "記", 106.5, 92, 11
                    
                    .TextOut "ての " & Ar(4) & " の " & Ar(5) & " は、下記により許可しません。", 23, 72, 11
                    .TextOut "１.申請の内容", 21, 98, 11
                    .TextOut "(1)当事者の住所、氏名" & s権利の内容, 25, 104, 11
                    
                    If Ar(4) = "所有権" Then
                        .TextOut "譲 受 人", 30, 110, 11
                        .TextOut "譲 渡 人", 30, 120, 11
                    Else
                        .TextOut "借　　人", 30, 110, 11
                        .TextOut "貸　　人", 30, 120, 11
                    End If
                    
                    .TextOut "住所 : " & Ar(1), 56, 110, 11
                    .TextOut "氏名 : " & Ar(2), 56, 115, 11
                    .TextOut "住所 : " & Ar(9), 56, 120, 11
                    .TextOut "氏名 : " & Ar(10), 56, 125, 11
                    
                    .TextOut "(2)土地の表示", 25, 131, 11

                    .TextOut "２.許可しない理由", 21, 180, 11
                    .DrawText s不許可の理由, 32, 186, 160, 4, 11
                    
                    Rows = 5
                    y = 136
                    
                    .TextOut "［教 示］", 16, 205, 9
                    .DrawText s教示(0), 30, 205, 164, 4, 9
                
                    i = 0
                    If .MaxPage > 2 Then
                        .TextOut "別  紙  の  と  お  り", dX(0) + 4, y + HH + 2, 10
                    Else
                        Do Until UBound(Ar) <= 21 + i
                            Cm = Split(Ar(22 + i), vbTab)
                            .TextOut Cm(0), 24, 144 + 6 + i * 6, 10
                            .TextOut Cm(1), 101, 144 + 6 + i * 6, 10, 2
                            .TextOut Cm(2), 119, 144 + 6 + i * 6, 10, 2
                            .TextOut FormatNumber(Val(Cm(3)), 0), 144, 144 + 6 + i * 6, 10, 1
                            i = i + 1
                        Loop
                        If i < 5 Then .TextOut "  以  下  余  白", dX(0) + 4, 144 + 6 + i * 6, 10
                    End If
                Else
                    .TextOut Format(CDate(Ar(3)), "GGG E年 M月 D日") & " 付けで農地法第３条第１項の規定による許可申請のあった農地につい", 23, 65, 11
                    .TextOut Format(CDate(Ar(6)), "GGG E年 M月 D日"), 23, 90, 11
                    .TextOut Ar(7) & "農業委員会", 126, 90, 11
                    .TextOut "会長  " & Ar(8), 126, 94, 11
                    .TextOut "記", 106.5, 98, 11
                    
                    .TextOut "ての " & Ar(4) & " の " & Ar(5) & " は、下記により許可します。", 23, 72, 11
                    .TextOut "１.当事者の住所、氏名", 21, 106, 11
                    If Ar(4) = "所有権" Then
                        .TextOut "譲 受 人", 30, 112, 11
                        .TextOut "譲 渡 人", 30, 124, 11
                    Else
                        .TextOut "借　　人", 30, 112, 11
                        .TextOut "貸　　人", 30, 124, 11
                    End If
                    .TextOut "住所 : " & Ar(1), 56, 112, 11
                    .TextOut "氏名 : " & Ar(2), 56, 118, 11
                    .TextOut "住所 : " & Ar(9), 56, 124, 11
                    .TextOut "氏名 : " & Ar(10), 56, 130, 11
                    
                    .TextOut "２.許可する土地", dX(0), 136, 11
                
                    y = 141
                    Select Case n相手
                        Case 1: .TextBox Ar(11), 21, 246, 189, 259, 10, 0, 0
                        Case 2: .TextBox Ar(12), 21, 246, 189, 259, 10, 0, 0
                    End Select
                    If SystemDB.DBProperty("県許可") Then
                        .TextOut "３.条       件", 21, 214, 11
                        .TextOut "［教 示］", 22, 228, 11
                        .TextOut "１", 24, 234, 8
                        .TextOut "２", 24, 254, 8
                        .TextOut "３", 24, 278, 8
                        .DrawText s教示(0), 30, 234, 160, 4, 8
                        .DrawText s教示(1), 30, 254, 160, 4, 8
                        .DrawText s教示(2), 30, 278, 160, 4, 8
                        
                        Rows = 10
                    ElseIf mvarPData.市町村 = "姶良市" Then
                        .TextOut "３.条       件", 21, 214, 11
                        .TextOut "［教 示］", 22, 228, 11
                        .TextOut "１", 24, 233, 8
                        .TextOut "２", 24, 248, 8
                        .TextOut "３", 24, 266, 8
                        .DrawText s教示(0), 30, 233, 160, 4, 8
                        .DrawText s教示(1), 30, 248, 160, 4, 8
                        .DrawText s教示(2), 30, 266, 160, 4, 8
                        
                        Rows = 10
                    Else
                        .TextOut "［教 示］", 22, 262, 11
                        .DrawText s教示(0), 38, 262, 144, 5, 9
                        
                        Rows = 15
                    End If
                    
                    i = 0
                    If mvarParent.MaxPage > 2 Then
                        .TextOut "別  紙  の  と  お  り", dX(0) + 4, y + HH + 2, 10, 0
                    Else
                        n = 0
                        For i = n農地位置 To n農地位置 + Rows
                            If UBound(Ar) < i Then Exit For
                            Cm = Split(Ar(i), vbTab)
                            .TextOut Cm(0), dX(0) + 4, y + 13 + n * 6, 10
                            .TextOut Cm(1), hX(1), y + 13 + n * 6, 10, 2
                            .TextOut Cm(2), hX(2), y + 13 + n * 6, 10, 2
                            If mvarPData.市町村 = "南種子町" Then
                                .TextOut pFormatN(CCur(Cm(4))), dX(4) - 1, y + 13 + n * 6, 10, 1
                                If Val(Cm(5)) > 0 Then
                                    .TextOut "の内" & pFormatN(CCur(Cm(3))) & "u", dX(4) + 1, y + 13 + n * 6, 10
                                ElseIf Val(Cm(6)) > 0 Then
                                    .TextOut "の内" & pFormatN(CCur(Cm(6))) & "u", dX(4) + 1, y + 13 + n * 6, 10
                                End If
                            Else
                                .TextOut FormatNumber(Val(Cm(3)), 0), dX(4) - 1, y + 13 + n * 6, 10, 1
                            End If
                            n = n + 1
                        Next
                        If n < Rows - 3 Then
                            .TextOut "  以  下  余  白", dX(0) + 4, y + 13 + n * 6, 10
                        Else
                            .TextOut "  -　以  上  -  ", dX(0) + 4, y + 13 + n * 6, 10
                        End If
                        If n畑面積 * n田面積 Then
                            .TextOut "田 計", hX(2), y - 5 + Rows * 6, 10, 2
                            .TextOut "畑 計", hX(2), y + 1 + Rows * 6, 10, 2
                            .TextOut "合 計", hX(2), y + 7 + Rows * 6, 10, 2
                            .TextOut pFormatN(CCur(n田面積)), dX(4) - 1, y - 5 + Rows * 6, 10, 1
                            .TextOut pFormatN(CCur(n畑面積)), dX(4) - 1, y + 1 + Rows * 6, 10, 1
                            .TextOut pFormatN(CCur(n田面積 + n畑面積)), dX(4) - 1, y + 7 + Rows * 6, 10, 1
                        ElseIf n田面積 Then
                            .TextOut "田 計", hX(2), y + 7 + Rows * 6, 10, 2
                            .TextOut pFormatN(CCur(n田面積 + n畑面積)), dX(4) - 1, y + 7 + Rows * 6, 10, 1
                        ElseIf n畑面積 Then
                            .TextOut "畑 計", hX(2), y + 7 + Rows * 6, 10, 2
                            .TextOut pFormatN(CCur(n田面積 + n畑面積)), dX(4) - 1, y + 7 + Rows * 6, 10, 1
                        End If
                    End If
                End If
            End If
            .LineBoxDX dX(0), y, HH, Rows, nPit, Ay
            .DLine dX(1), y + HH / 2, dX(3), y + HH / 2
            .DLine dX(2), y + HH / 2, dX(2), y + HH + (Rows * nPit)
            .TextOut "土 　地 　の 　所 　在", hX(0), y + (HH / 3), 11, 2
            .TextOut "地     目", dX(2), y + (HH / 4), 11, 2, 2
            .TextOut "登 記 簿", hX(1), y + (HH / 4) * 3, 11, 2, 2
            .TextOut "現  況", hX(2), y + (HH / 4) * 3, 11, 2, 2
            .hTextOut "面  積 （ u ）", dX(3) + 2, y + 2, 5, 5, 11
            .TextOut "備    考", hX(4), y + (HH / 3), 11, 2
        End With
    End Sub
    
    Private Sub PrintSub利用権(ByVal nPage As Long)
        Dim Ar As Variant, Cm As Variant
        Dim Ay As Variant
        Dim y As Single
        Dim i As Long
        Dim n As Long
        Dim s市町村 As String
        Dim nPit As Single, HH As Single, Rows As Long
        Dim SY As Single
        Dim St As String, StX As String
        
        nPit = 8
        HH = 10
        
        Ay = GetArray(68, 36, 22, 38)
        With mvarParent
            .ClearScreen
            If Len(mvarData) = 0 Then Exit Sub
            Ar = Split(mvarData, ";")

            If nPage > 2 Then
                SY = 36
                Rows = 28
                y = SY + HH + nPit / 2
                .TextOut "(別紙)    対象の農地", 21, 26, 11
                n = n農地位置 + (nPage - 3) * Rows
                For i = n To n + Rows - 1
                    If UBound(Ar) < i Then Exit For
                    Cm = Split(Ar(i), vbTab)
                    .TextOut Cm(0), dX(0) + 4, y + (i - n) * nPit, 10, 0, 2
                    .TextOut Cm(1), hX(1), y + (i - n) * nPit, 10, 2, 2
                    .TextOut Cm(2), hX(2), y + (i - n) * nPit, 10, 2, 2
                    .TextOut FormatNumber(Val(Cm(3)), 0), dX(4) - 1, y + (i - n) * nPit, 10, 1, 2
                Next
                If i >= UBound(Ar) And (i - n) < Rows Then
                    .TextOut "  -　以  上  -  ", dX(0) + 4, y + (i - n) * nPit, 10, 0, 2
                End If
                            
                If nPage = mvarParent.MaxPage Then
                    y = SY + HH + nPit * Rows - nPit / 2
                    If n畑面積 * n田面積 Then
                        .TextOut "田 計", hX(2), y - nPit * 2, 10, 2, 2
                        .TextOut "畑 計", hX(2), y - nPit, 10, 2, 2
                        .TextOut "合 計", hX(2), y, 10, 2, 2
                        .TextOut FormatNumber(n田面積, 0), dX(4) - 1, y - nPit * 2, 10, 1, 2
                        .TextOut FormatNumber(n畑面積, 0), dX(4) - 1, y - nPit, 10, 1, 2
                        .TextOut FormatNumber(n田面積 + n畑面積, 0), dX(4) - 1, y, 10, 1, 2
                    ElseIf n田面積 Then
                        .TextOut "田 計", hX(2), y, 10, 2, 2
                        .TextOut FormatNumber(n田面積 + n畑面積, 0), dX(4) - 1, y, 10, 1, 2
                    ElseIf n畑面積 Then
                        .TextOut "畑 計", hX(2), y, 10, 2, 2
                        .TextOut FormatNumber(n田面積 + n畑面積, 0), dX(4) - 1, y, 10, 1, 2
                    End If
                End If
            Else
                If Val(SystemDB.DBProperty("決定通知番号指定")) <> 0 Then .TextOut StrConv("農委第 " & IIf(Val(Ar(0)) = 0, " ", Ar(0)) & " 号", vbWide), 183, 25, 11, 1
                .TextOut StrConv(Format(dt発効日, "GGGE年M月D日"), vbWide), 185 - 2, 20, 11, 1
                Select Case nPage
                    Case 1: .DrawText Ar(1), dX(0) - 2, 28, 75, 4, 11, 0, 0, 20
                            .TextOut Ar(2) & "   様", dX(0) + 2, 39, 11
                            .TextOut "〒" & s郵便番号(0), dX(0) - 2, 19, 11
                    Case 2: .DrawText Ar(9), dX(0) - 2, 28, 75, 4, 11, 0, 0, 20
                            .TextOut Ar(10) & "   様", dX(0) + 2, 39, 11
                            .TextOut "〒" & s郵便番号(1), dX(0) - 2, 19, 11
                End Select
                
                .TextOut Ar(7) & "農業委員会", 131, 47, 11
                .TextOut "会長　" & Ar(8), 131, 52, 11
                .TextOut "農業基盤強化促進法に基づく利用権設定について（通知）　", 105, 68, 11, 2
                
                Select Case SystemDB.DBProperty("利用権決定通知")
                    Case "B":
                        If IsDate(Ar(21)) Then
                            StX = StrConv(Format(CDate(Ar(21)), "GGGE年M月D日"), vbWide)
                        Else
                            StX = "平成　　年　　月　　日"
                        End If
                        St = "　先日、あなたが申請された農地の利用権設定については、「農用地利用集積計画」として、" & SystemDB.DBProperty("利用権決定担当課") & "が" & _
                        StX & "付けで公告いたしましたので通知します。\n　なお、申請の内容は下記のとおりです。"
                    Case Else
                        If IsDate(Ar(6)) Then
                            StX = StrConv(Format(CDate(Ar(6)), "GGGE年M月D日"), vbWide)
                        Else
                            StX = "平成　　年　　月　　日"
                        End If
                        St = "　先日、あなたが申請された農地の利用権設定については、" & StX & "付けで決定いたしましたので通知します。" & _
                        "\n　なお、申請の内容は下記のとおりです。"
                End Select
                .DrawText St, 25, 79, 165, 5, 11
                .TextOut "記", 105, 101, 11, 2
                .TextOut "１　貸借人氏名", dX(0) + 2, 111, 11
                .TextOut "借　人", dX(0) + 42, 111, 11
                .TextOut Ar(2), dX(0) + 64, 111, 11
                .TextOut "貸　人", dX(0) + 42, 122, 11
                .TextOut Ar(10), dX(0) + 64, 122, 11
                .TextOut "２　対象の農地", dX(0) + 2, 138, 11
                                
                SY = 150
                Rows = 6
               
                y = SY + HH + nPit / 2
                If mvarParent.MaxPage > 2 Then
                    .TextOut "別  紙  の  と  お  り", dX(0) + 4, y, 10, 0, 2
                Else
                    For i = n農地位置 To n農地位置 + Rows - 1
                        If UBound(Ar) < i Then Exit For
                        Cm = Split(Ar(i), vbTab)
                        .TextOut Cm(0), dX(0) + 4, y + (i - n農地位置) * nPit, 10, 0, 2
                        .TextOut Cm(1), hX(1), y + (i - n農地位置) * nPit, 10, 2, 2
                        .TextOut Cm(2), hX(2), y + (i - n農地位置) * nPit, 10, 2, 2
                        .TextOut FormatNumber(Val(Cm(3)), 0), dX(4) - 1, y + (i - n農地位置) * nPit, 10, 1, 2
                    Next
                    If i < n農地位置 + Rows - 1 Then
                        .TextOut "  以  下  余  白", dX(0) + 4, y + (i - n農地位置) * nPit, 10, 0, 2
                    End If
                    y = SY + HH + nPit * Rows - nPit / 2
                    If n畑面積 * n田面積 Then
                        .TextOut "田 計", hX(2), y - nPit * 2, 10, 2, 2
                        .TextOut "畑 計", hX(2), y - nPit, 10, 2, 2
                        .TextOut "合 計", hX(2), y, 10, 2, 2
                        .TextOut FormatNumber(n田面積, 0), dX(4) - 1, y - nPit * 2, 10, 1, 2
                        .TextOut FormatNumber(n畑面積, 0), dX(4) - 1, y - nPit, 10, 1, 2
                        .TextOut FormatNumber(n田面積 + n畑面積, 0), dX(4) - 1, y, 10, 1, 2
                    ElseIf n田面積 Then
                        .TextOut "田 計", hX(2), y, 10, 2, 2
                        .TextOut FormatNumber(n田面積 + n畑面積, 0), dX(4) - 1, y, 10, 1, 2
                    ElseIf n畑面積 Then
                        .TextOut "畑 計", hX(2), y, 10, 2, 2
                        .TextOut FormatNumber(n田面積 + n畑面積, 0), dX(4) - 1, y, 10, 1, 2
                    End If
                End If
                
                .TextOut "３　期　　　間", dX(0) + 2, 224, 11
                If Ar(16) = "" And Ar(17) = "" Then
                    St = ""
                Else
                    St = IIf(IsDate(Ar(16)), StrConv(Format(Ar(16), "GGGE年M月D日"), vbWide), "") & "　〜　" & IIf(IsDate(Ar(17)), StrConv(Format(Ar(17), "GGGE年M月D日"), vbWide), "")
                End If
                
                St = St & IIf(Val(Ar(18)) <> 0, "（" & StrConv(Ar(18), vbWide) & "年）", "")
                
                .TextOut St, dX(0) + 13, 230, 11
                .TextOut "４　小　作　料", dX(0) + 2, 240, 11
                
                If Ar(4) = "賃借権" Then
                    .TextOut Format(Ar(19), "#,##0") & Ar(20), dX(0) + 13, 246, 11
                ElseIf Ar(4) = "使用貸借権" Then
                    .TextOut "使用貸借契約のため、無し", dX(0) + 13, 246, 11
                End If
            End If

            y = SY
            .LineBoxDX dX(0), y, HH, Rows, nPit, Ay
            .DLine dX(1), y + HH / 2, dX(3), y + HH / 2
            .DLine dX(2), y + HH / 2, dX(2), y + HH + (Rows * nPit)
            .TextOut "土 　地 　の 　所 　在", hX(0), y + (HH / 3), 11, 2
            .TextOut "地    目", dX(2), y + (HH / 4), 11, 2, 2
            .TextOut "登記簿", hX(1), y + (HH / 4) * 3, 11, 2, 2
            .TextOut "現  況", hX(2), y + (HH / 4) * 3, 11, 2, 2
            .DrawText "面  積\n（ u ）", dX(3), y, Ay(2), 5, 11, 2, 2, 10
            .TextOut "備    考", hX(4), y + (HH / 3), 11, 2
        End With
    End Sub

    Private Sub PrintSub4条()
        Dim Cm As Variant
        Dim y As Single
        Dim n As Long
        
        With mvarParent
            .Offset -4, -2
            .ClearScreen
            
            .TextOut s許可文, 150, 16, 12, 0, 0
            .TextOut "申請人　住所（所在地）　" & Cy(2), 22, 21, 11, 0, 0
            .TextOut "氏名（名　称）　" & Cy(3), 38, 31, 11, 0, 0

            .DrawText "　" & Format(Cx(0), "GGG E 年 M 月 D 日") & "付けで申請のあった農地法第" & s法令 & "条第１項の規定による許可の申請は，\n下記により許可します。", 22, 44, 180, 6, 11, 0, 0, 12
            .TextOut Format(dt発効日, "GGG E 年 M 月 D 日"), 26, 56, 11, 0, 0

            .TextOut mvarPData.市町村 & "農業委員会　会長　" & mvarPData.会長名, 112, 64, 11, 0, 0
            .TextOut "記", 105, 73, 11, 2, 2

            .TextOut "１　農地法第" & s法令 & "条第１項の規定により" & "" & "に基づく農地の" & "" & "を許可する土地の表示", 22, 80, 11, 0, 0

            .DLine 20, 92, 194, 92, 0, 1
            .DLine 20, 104, 194, 104, 0, 1
            .DLine 20, 110, 194, 110, 0, 1
            .DLine 20, 116, 194, 116, 0, 1
            .DLine 20, 122, 194, 122, 0, 1
            .DLine 20, 128, 194, 128, 0, 1
            .DLine 20, 134, 194, 134, 0, 1
            .DLine 100, 98, 128, 98, 0, 1
            .DLine 20, 92, 20, 134, 0, 1
            .DLine 100, 92, 100, 134, 0, 1
            .DLine 114, 98, 114, 134, 0, 1
            .DLine 128, 92, 128, 134, 0, 1
            .DLine 150, 92, 150, 134, 0, 1
            .DLine 194, 92, 194, 134, 0, 1

            .TextOut "土　　地　　の　　所　　在", 60, 98, 11, 2, 2
            .TextOut "地　　目", 114, 95, 11, 2, 2
            .TextOut "登記簿", 107, 101, 11, 2, 2
            .TextOut "現　況", 121, 101, 11, 2, 2
            .TextOut "面　積", 139, 95, 11, 2, 2
            .TextOut "（u）", 150, 101, 11, 1, 2
            .TextOut "備　　　　　考", 172.5, 98, 11, 2, 2

            .TextOut "２　用途", 22, 140, 11, 0, 0
            .TextOut Cy(1), 26, 146, 11, 0, 0
            .TextOut s教示(0), 22, 154, 11, 0, 0

            .DrawText s教示(1), 26, 160, 180, 5, 9, 0, 0, 5
            .DrawText s教示(2), 26, 165, 180, 5, 9, 0, 0, 10
            .DrawText s教示(3), 26, 175, 180, 5, 9, 0, 0, 10
            .DrawText s教示(4), 27.5, 185, 180, 5, 9, 0, 0, 18
            .DrawText s教示(5), 28, 205, 180, 4, 9, 0, 0, 18
            .TextOut "１", 26, 210, 9, 0, 0
            .DrawText s教示(6), 28, 210, 180, 4, 9, 0, 0, 14
            .TextOut "２", 26, 228, 9, 0, 0
            .DrawText s教示(7), 28, 228, 180, 4, 9, 0, 0, 16
            .TextOut "３", 26, 249, 9, 0, 0
            .DrawText s教示(8), 28, 249, 166, 4, 9, 0, 0, 14
            .TextOut "４", 26, 267, 9, 0, 0
            .DrawText s教示(9), 28, 267, 180, 4, 9, 0, 0, 14

            For n = 0 To UBound(Ar) - 1
                If n >= 5 Then Exit For
                Cm = Split(Ar(n), vbTab)

                Cm(3) = Set面積(CStr(Cm(3)))

                y = n * 6
                .TextOut Cm(0), 21, 107 + y, 11, 0, 2  '全角20文字分
                .TextOut Cm(1), 107, 107 + y, 11, 2, 2
                .TextOut Cm(2), 121, 107 + y, 11, 2, 2
                .TextOut Cm(3), 149, 107 + y, 11, 1, 2
            Next
        
        End With
    End Sub
    Private Sub PrintSub5条(nPage As Long)
        Dim Cm As Variant
        Dim y As Single
        Dim n As Long
        
        With mvarParent
            .Offset -7, -1
            .ClearScreen
            
            If nPage = 1 Then
                .TextOut "(５条譲渡人（貸人）用)", 18, 10, 11, 0, 0
                .DrawText Cy(2), 68, 21, 80, 4, 11
                .DrawText Cy(3), 68, 31, 80, 4, 11
            Else
                .TextOut "(５条譲受人（借人）用)", 18, 10, 11, 0, 0
                .DrawText Cy(4), 68, 21, 80, 4, 11
                .DrawText Cy(5), 68, 31, 80, 4, 11
            End If
            
            '2009/05/22
            Select Case mvarPData.市町村
                Case "長島町"
                    .TextOut "指令農委第 " & s法令 & " 号 " & Cy(0), 150, 16, 12, 0, 0
                Case Else
                    .TextOut Left(mvarPData.市町村, 1) & "農委第 " & s法令 & " 号" & IIf(mvarPData.市町村 = "大崎町", "の " & Cy(0), ""), 150, 16, 12, 0, 0
            End Select

            
            .TextOut "申請人　住所（所在地）", 22, 21, 11, 0, 0
            .TextOut "氏名（名　称）", 38, 31, 11, 0, 0
        
            .DrawText "　" & Format(Cx(0), "GGG E 年 M 月 D 日") & "付けで申請のあった農地法第" & s法令 & "条第１項の規定による許可の申請は，\n下記により許可します。", 22, 44, 180, 6, 11, 0, 0, 12
            .TextOut Format(dt発効日, "GGG E 年 M 月 D 日"), 26, 56, 11, 0, 0
        
            .TextOut mvarPData.市町村 & "農業委員会　会長　" & mvarPData.会長名, 112, 64, 11, 0, 0
            .TextOut "記", 105, 73, 11, 2, 2
        
            .TextOut "１　所有権等の権利の設定，移転を許可する土地の表示", 22, 80, 11, 0, 0
            .TextOut Cx(1) & "を許可する土地", 20, 86, 11, 0, 0
            .TextOut "" & "人：申請人に同じ", 194, 86, 11, 1, 0
            
            .DLine 20, 92, 194, 92, 0, 1
            .DLine 20, 104, 194, 104, 0, 1
            .DLine 20, 110, 194, 110, 0, 1
            .DLine 20, 116, 194, 116, 0, 1
            .DLine 20, 122, 194, 122, 0, 1
            .DLine 20, 128, 194, 128, 0, 1
            .DLine 20, 134, 194, 134, 0, 1
            .DLine 100, 98, 128, 98, 0, 1
            .DLine 20, 92, 20, 134, 0, 1
            .DLine 100, 92, 100, 134, 0, 1
            .DLine 114, 98, 114, 134, 0, 1
            .DLine 128, 92, 128, 134, 0, 1
            .DLine 150, 92, 150, 134, 0, 1
            .DLine 194, 92, 194, 134, 0, 1
            
            .TextOut "土　　地　　の　　所　　在", 60, 98, 11, 2, 2
            .TextOut "地　　目", 114, 95, 11, 2, 2
            .TextOut "登記簿", 107, 101, 11, 2, 2
            .TextOut "現　況", 121, 101, 11, 2, 2
            .TextOut "面　積", 139, 95, 11, 2, 2
            .TextOut "（u）", 150, 101, 11, 1, 2
            .TextOut "備　　　　　考", 172.5, 98, 11, 2, 2
            
            .TextOut "２　用途", 22, 140, 11, 0, 0
            .TextOut Cy(1), 26, 146, 11, 0, 0
            .TextOut "３　条件", 22, 154, 11, 0, 0
        
            .DrawText s教示(1), 26, 160, 180, 5, 9, 0, 0, 5
            .DrawText s教示(2), 26, 165, 180, 5, 9, 0, 0, 10
            .DrawText s教示(3), 26, 175, 180, 5, 9, 0, 0, 10
            .DrawText s教示(4), 27.5, 185, 180, 5, 9, 0, 0, 18
            .DrawText s教示(5), 28, 205, 180, 4, 9, 0, 0, 18
            .TextOut "１", 26, 210, 9, 0, 0
            .DrawText s教示(6), 28, 210, 180, 4, 9, 0, 0, 14
            .TextOut "２", 26, 228, 9, 0, 0
            .DrawText s教示(7), 28, 228, 180, 4, 9, 0, 0, 16
            .TextOut "３", 26, 249, 9, 0, 0
            .DrawText s教示(8), 28, 249, 166, 4, 9, 0, 0, 14
            .TextOut "４", 26, 267, 9, 0, 0
            .DrawText s教示(9), 28, 267, 180, 4, 9, 0, 0, 14
        
            For n = 0 To UBound(Ar) - 1
                If n >= 5 Then Exit For
                Cm = Split(Ar(n), vbTab)
                
                Cm(3) = Set面積(CStr(Cm(3)))
                
                y = n * 6
                .TextOut Cm(0), 21, 107 + y, 11, 0, 2  '全角20文字分
                .TextOut Cm(1), 107, 107 + y, 11, 2, 2
                .TextOut Cm(2), 121, 107 + y, 11, 2, 2
                .TextOut Cm(3), 149, 107 + y, 11, 1, 2
            Next
        
        End With
    End Sub

    Private Function Set面積(d面積 As String) As String
        If d面積 < 10 Then
            Set面積 = Format(d面積, "#.00")
        Else
            Set面積 = Format(d面積, "#,###")
        End If
    End Function


End Class










Class CPrint現地調査
    Option Explicit
    Implements CPrintCls
    Private mvarParent As CPrintFormSK
    Private mvarDic As ADBasicLIB2.CDataDictionary
    Private mvarKey As String
    Private sKey As String
    Private Ay As Variant
    Private Ar As Variant
    Private Cm As Variant
    Private dX(11) As Single, hX(11) As Single
    Private SY As Single
    Private str As Variant
    Private nPit As Long
    Private dt現地調査日 As Date
    Private sData As String
    Private B As Boolean

    Public Property Let Key(RHS As String): mvarKey = RHS: End Property
    Private Sub Class_Initialize(): Set mvarDic = New ADBasicLIB2.CDataDictionary: End Sub
    Private Property Get CPrintCls_CanCancelPrint() As Boolean

    End Property
    Private Property Get CPrintCls_CanPrintNowPage() As Boolean: CPrintCls_CanPrintNowPage = True: End Property
    Private Property Let CPrintCls_Key(ByVal RHS As String): mvarKey = RHS: End Property
    Private Property Get CPrintCls_Key() As String: CPrintCls_Key = mvarKey: End Property

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim RsS As ADBasicLIB2.RecordsetEx
        Dim n支所 As Long
        Dim sWhere As String
        Dim sSQL As String
        Dim St As String
        Dim m As Long, n As Long
        Dim n総会 As Long
        Dim sBlock As String
        Dim Cx As Variant, Cy As Variant
        Dim n面積 As Variant
        
        dt現地調査日 = CDate(MID(sParam, 3))
        n総会 = SystemDB.DBProperty("今月総会番号")
    On Error GoTo Er_Ext:
        n支所 = Val(sParam)
        If mvarKey = "現地調査日程表" Then
            sSQL = "SELECT Null AS ID, IIf([法令]=302,[D_申請].[氏名A],IIf([法令]=303,[D_申請].[氏名A],IIf([法令]=30 Or [法令]=31 Or [法令]=32 Or [法令]=33 Or [法令]=60 Or [法令]=61 Or [法令]=62,[D_申請].[氏名B],IIf([法令]=50 Or [法令]=51,[D_申請].[氏名B],[D_申請].[氏名A])))) AS 名前, IIf(InStr([農地リスト],';')=0,Mid([農地リスト],4),Mid(Left([農地リスト],InStr([農地リスト],';')-1),4)) AS 農地, D_申請.農地リスト, D_申請.調査員A, '農地区分' AS 農地区分, D_申請.申請地目安, Null AS 土地所在, Null AS 地目, Null AS 筆数, Null AS 面積, D_申請.調査員B AS 担当委員, D_申請.法令, IIf([D_申請].[法令]>=40 And [D_申請].[法令]<=51 Or [D_申請].[法令]=303,[申請理由A],[用途]) AS 目的, D_申請.ID, D_申請.名称, D_申請.申請地地番 " & _
                   "FROM D_申請 LEFT JOIN [D:個人Info] AS [D:個人Info_1] ON D_申請.申請者B = [D:個人Info_1].ID " & _
                   "WHERE (((D_申請.現地調査番号) <> 999) And ((D_申請.総会番号) =" & n総会 & ") And ((D_申請.状態) = 0 Or (D_申請.状態) = 1)) " & _
                   "ORDER BY D_申請.現地調査番号, D_申請.申請地大字ID, D_申請.申請地地番, D_申請.受付番号, D_申請.調査員B;"
        Else
            sSQL = "SELECT [D:個人Info].ID, IIf([法令]=302,[D_申請].[氏名A],IIf([法令]=303,[D_申請].[氏名A],IIf([法令]=30 Or [法令]=31 Or [法令]=32 Or [法令]=33 Or [法令]=60 Or [法令]=61 Or [法令]=62,[D_申請].[氏名B],IIf([法令]=50 Or [法令]=51,[D_申請].[氏名B],[D_申請].[氏名A])))) AS 名前, IIf(InStr([農地リスト],';')=0,Mid([農地リスト],4),Mid(Left([農地リスト],InStr([農地リスト],';')-1),4)) AS 農地, D_申請.農地リスト, D_申請.調査員A, '農地区分' AS 農地区分, D_申請.申請地目安, Null AS 土地所在, Null AS 地目, Null AS 筆数, Null AS 面積, D_申請.調査員B AS 担当委員, D_申請.法令, IIf([D_申請].[法令]>=40 And [D_申請].[法令]<=51,[申請理由A],[用途]) AS 目的, D_申請.ID, D_申請.名称, D_申請.申請地地番 " & _
                 "FROM D_申請 INNER JOIN [D:個人Info] ON D_申請.申請者A = [D:個人Info].ID " & _
                 "WHERE (((D_申請.法令) <> 303) And ((D_申請.現地調査番号) = 999) And ((D_申請.総会番号) =" & n総会 & ") And ((D_申請.状態) = 0)) Or (((D_申請.法令) <> 303) And ((D_申請.現地調査番号) = 999) And ((D_申請.総会番号) =" & n総会 & ") And ((D_申請.状態) = 1)) " & _
                 "ORDER BY D_申請.法令, D_申請.申請地大字ID, D_申請.申請地地番, D_申請.受付番号, D_申請.調査員B;"
        End If
        
        Set Rs = SystemDB.GetRecordsetEx(sSQL, , , "現地調査1")
            If Rs.IsNoRecord Then
                MsgBox "対象となる議案がありません。" & vbCr & "処理を終了します。"
                Exit Function
            End If
            sData = Rs.GetString("|", vbBack)
        SystemDB.CloseRs Rs
        
        nPit = 16
        
        Ar = Split(sData, vbBack)
        For n = 0 To UBound(Ar) - 1
            Cm = Split(Ar(n), "|")
            If Cm(12) <> "303" Then St = IIf(Len(Cm(3)) = 0, St, St & ";" & Cm(3))
        Next
        
        St = GetIDList(MID(St, 2), "農地")

        Set Rs = SystemDB.GetRecordsetEx("SELECT V_農地.ID, V_農地.土地所在, IIf([農委地目認定日]=#12/30/1899#,[登記],[農委]) AS 地目, IIf(IsNull([登記簿面積]),0,[登記簿面積]) AS 登記面積, M_BASICALL.名称 AS 登記,  IIf(IsNull([田面積]) Or [田面積]=0,IIf(IsNull([畑面積]),0,IIf([畑面積]=0,[田面積],[畑面積])),[田面積]) AS 面積, V_農地.一部現況, M_BASICALL.名称 AS 農委, Val(IIf(InStr([地番],'-')=0,[地番] & '000',Left([地番],InStr([地番],'-')-1) & Right('000' & Mid([地番],InStr([地番],'-')+1),3))) AS 検索 FROM (V_農地 LEFT JOIN M_BASICALL ON V_農地.登記簿地目 = M_BASICALL.ID) LEFT JOIN V_農委地目 ON V_農地.農委地目ID = V_農委地目.ID WHERE (((V_農地.ID) IN(" & St & ")) AND (M_BASICALL.Class)='地目') ORDER BY V_農地.小字ID, Val(IIf(InStr([地番],'-')=0,[地番] & '000',Left([地番],InStr([地番],'-')-1) & Right('000' & Mid([地番],InStr([地番],'-')+1),3))), IIf(IsNull([一部現況]),0,[一部現況])", , , "現地調査2")
        
        For n = 0 To UBound(Ar) - 1
            Cm = Split(Ar(n), "|")

            Select Case Cm(12)
                Case "30", "31": Cm(12) = "３条"
                Case "32", "33": Cm(12) = "県３条"
                Case "40": Cm(12) = "４条"
                Case "50", "51": Cm(12) = "５条"
                Case "60", "61", "62": Cm(12) = "経営基盤"
                Case "301": Cm(12) = "農地改良"
                Case "302": Cm(12) = "農用地\n計画変更"
                Case "303": Cm(12) = "事業計画\n変更"
                Case "400", "401": Cm(12) = "あっせん"
                Case "500": Cm(12) = "農地利用\n変更"
                Case "801", "802", "803", "804": Cm(12) = "買受適格"
                Case "990", "991": Cm(12) = "奨励金"
                Case Else: Cm(12) = ""
            End Select

    sBlock = "データ取込エラー" & vbCr & "申請ID ⇒ " & Cm(14) & vbCr & "申請の種類 ⇒ 『" & Replace(Cm(12), "\n", "") & "』" & vbCr & "名称 ⇒ 『" & Cm(15) & "』" & vbCr & "で不正なデータが見つかりました。" & vbCr & "申請データを確認してください。"
            
            If Cm(12) <> "事業計画\n変更" Then
                Rs.MoveFirst
                Rs.FindFirst "[検索]=" & Val(Cm(16))
                If Not Rs.EOF Then
                    Cm(7) = Rs.Value("土地所在")
                    Cm(8) = Rs.Value("地目")
                    Cm(9) = UBound(Split(Cm(3), ";"))
                    If Rs.Value("一部現況") > 0 Then
                        Cm(10) = IIf(Rs.Value("登記面積") < 10, FormatNumber(Rs.Value("登記面積"), 2), Val(FormatNumber(Rs.Value("登記面積"), 2))) & "の内" & IIf(Rs.Value("面積") < 10, FormatNumber(Rs.Value("面積"), 2), Val(FormatNumber(Rs.Value("面積"), 2)))
                    Else
                        Cm(10) = IIf(Rs.Value("面積") < 10, FormatNumber(Rs.Value("面積"), 2), IIf(Right(Format(Rs.Value("面積"), "#,###.##"), 1) = ".", Format(Rs.Value("面積"), "#,###"), FormatNumber(Rs.Value("面積"), 0)))
                    End If
                    Ar(n) = Join(Cm, "|")
                End If
            Else
                n面積 = 0
                Cx = Split(Cm(2), vbCrLf)
                For m = 0 To UBound(Cx)
                    Cy = Split(Cx(m), ";")
                    If m = 0 Then Cm(6) = Cy(0): Cm(7) = Cy(1): Cm(8) = UBound(Cx)
                    n面積 = n面積 + Val(Cy(3))
                    If m = 0 Then n面積 = Val(Cy(3))
                Next
                Cm(10) = IIf(n面積 < 10, FormatNumber(n面積, 2), IIf(Right(Format(n面積, "#,###.##"), 1) = ".", Format(n面積, "#,###"), FormatNumber(n面積, 0)))
            End If
            Ar(n) = Join(Cm, "|")
            Rs.MoveNext
        Next
        SystemDB.CloseRs Rs
        
        If mvarKey = "現地調査日程表" Then
            Ay = GetArray(10, 26, 36, 18, 18, 24, 28, 30, 43, 30)
            str = GetArray("番号", "担当委員", "申　請　人", "申請区分", "農地区分", "転用目的等", "", "", "申 請 地 の 目 安", "調　査　員")
        Else
            Ay = GetArray(10, 34, 22, 28, 40, 28, 26, 50, 30)
            str = GetArray("番号", "申　請　人", "申請区分", "農地区分", "転用目的等", "", "", "申 請 地 の 目 安", "調 査 員")
        End If
        
        dX(0) = 12: hX(0) = dX(0) + Ay(0) / 2
        For n = 0 To UBound(Ay)
            dX(n + 1) = dX(n) + Ay(n)
            If n < UBound(Ay) Then hX(n + 1) = dX(n + 1) + Ay(n + 1) / 2
        Next
        
        With mvarParent
            .表示倍率 = 0.75
            .Page = 1
            .MaxPage = Fix((UBound(Ar) + 9) / 10)
        End With
        
        sKey = sParam
        B = True
        Exit Function
    Er_Ext:
        MsgBox sBlock & vbCrLf & "[" & Err.Description & "]" & vbCr & vbCr & "処理を中断します。"
    End Function
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants: CPrintCls_Orientation = vbPRORLandscape: End Property
    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&): CPrintCls_Repaint: End Sub
    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property
    Private Property Set CPrintCls_Parent(RHS As ADBasicLIB2.CPrintFormSK): Set mvarParent = RHS: End Property

    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        Dim pNode As Object
        Dim nData As Long
        Dim n As Long
        
        mvarParent.KillDoc
        
        mvarParent.ChangeLayout vbPRPSA4, vbPRORLandscape
        If bNowPage Then
            PrintSub mvarKey, mvarParent.Page
        Else
            For n = 1 To mvarParent.MaxPage
                PrintSub mvarKey, n
                mvarParent.NewPage
            Next
        End If
        mvarParent.EndDoc

    End Sub
    Private Sub CPrintCls_Repaint(): PrintSub mvarKey, mvarParent.Page: End Sub
    Private Sub PrintSub(mvarKey As String, nPage As Long)
        If nPage = 0 Then nPage = 1
        Select Case Fnc.GetKeyHead(mvarKey)
            Case "現地調査日程表": Sub_現地調査日程表 mvarKey, nPage
            Case "現地調査担当委員": Sub_現地調査担当委員 mvarKey, nPage
            Case Else
        End Select
    End Sub
    Private Sub Sub_現地調査日程表(sKey As String, nPage As Long)
        
        With mvarParent
            .Offset 0, 0
            .ClearScreen
            
            If Len(sData) = 0 Then Exit Sub
            
            SY = 10
            .TextOut Format(Now(), "GGGEE年MM月分　現地調査日程表"), (dX(0) + dX(10)) / 2, SY, 14, 2, 2
            .TextOut Format(dt現地調査日, "GGGEE年MM月DD日"), dX(0), SY + 10, 14, , 1
            
            Sub_表作成 sKey, SY + 10, nPage
            
        End With
    End Sub
    Private Sub Sub_現地調査担当委員(sKey As String, nPage As Long)
        With mvarParent
            .Offset 0, 0
            .ClearScreen
            
            If Len(sData) = 0 Then Exit Sub
            
            SY = 10
            .TextOut Format(Now(), "GGGEE年MM月分　地区担当委員現地調査表"), (dX(0) + dX(9)) / 2, SY, 14, 2, 2
        
            Sub_表作成 sKey, SY + 10, nPage
        
        End With
    End Sub
    Private Sub Sub_表作成(sKey As String, SY As Single, nPage As Long)
        Dim n As Long
        Dim i As Long
        Dim Arr As Variant
        
        If B = False Then Exit Sub
        If sKey = "現地調査日程表" Then
            i = 6
            Arr = GetArray(10, 26, 36, 18, 18, 24, 58, 43, 30)
        Else
            i = 5
            Arr = GetArray(10, 34, 22, 28, 40, 54, 50, 30)
        End If
        
        With mvarParent
            .LineBoxDX dX(0), SY, 10, 10, 16, Arr
            SY = SY + 5
            .DLine dX(i), SY, dX(i + 2), SY
            .DLine dX(i + 1) - 5, SY, dX(i + 1) - 5, SY + 5
            
            .TextOut "申　　請　　地", dX(i) + (Ay(i) + Ay(i + 1)) / 2, SY - 2, 11, 2, 2
            .TextOut "地　目", hX(i) - 2, SY + 3, 11, 2, 2
            .TextOut "面　　積", hX(i + 1) - 2, SY + 3, 11, 2, 2
            For n = 0 To UBound(str)
                .TextOut str(n), hX(n), SY, 11, 2, 2
            Next
            
            SY = SY + 12
            
            For n = 0 To 9
                .DLine dX(i), SY + 4 + n * nPit, dX(i + 2), SY + 4 + n * nPit
                .DLine dX(i + 1) - 5, SY + 4 + n * nPit, dX(i + 1) - 5, SY + 9 + n * nPit
            Next
        End With
    
        Sub_当込み sKey, SY, nPage
    
    End Sub

    Private Sub Sub_当込み(sKey As String, SY As Single, nPage As Long)
        Dim n As Long, i As Long
        Dim y As Single
        
        i = 0
        With mvarParent
            If mvarKey = "現地調査担当委員" Then i = 1
            For n = 1 To 10
                If (nPage - 1) * 10 + n > UBound(Ar) Then Exit For
                Cm = Split(Ar((nPage - 1) * 10 + n - 1), "|")
                y = (n - 1) * nPit
                .TextOut (nPage - 1) * 10 + n, hX(0), SY + y, 11, 2, 2
                If mvarKey = "現地調査担当委員" Then
                    .DrawText Cm(1), dX(1), SY + y - 6, Ay(2), 4, 10, , , 12
                Else
                    .DrawText Replace(Replace(StrConv(Cm(11), vbNarrow), ",", "\n"), "､", "\n"), dX(1) + 1, SY + y - 7, Ay(1), 3.7, 10, , , 12
                    .DrawText Cm(1), dX(2), SY + y - 6, Ay(2), 4, 10, , , 12
                End If
                .DrawText Cm(12), dX(3 - i), SY + y - 5, Ay(3 - i), 4, 11, 2, 2, 12
                If Len(Cm(5)) > 4 Then Cm(5) = Left(Cm(5), 4) & "\n" & MID(Cm(5), 5)
                .DrawText Cm(5), dX(4 - i) + 1, SY + y - 7, Ay(4 - i) - 2, 4, 11, 2, 2, nPit
                .DrawText Cm(13), dX(5 - i), SY + y - 7, Ay(5 - i), 4, 11, , , 12
                .DrawText Cm(7), dX(6 - i) + 1, SY + y - 6, Ay(6 - i) + Ay(7 - i), 4, 10, , , 12
                .TextOut Cm(8), dX(6 - i) + 1, SY + 7 + y, 10, 0, 2
                .TextOut "外   筆", dX(7 - i) - 7, SY + 7 + y, 10, 1, 2
                If Cm(9) <> 0 Then .TextOut Cm(9), dX(7 - i) - 11, SY + 7 + y, 10, 1, 2
                .TextOut Cm(10) & " u", dX(8 - i) - 1, SY + 7 + y, 10, 1, 2
                .DrawText Cm(6), dX(8 - i), SY + y - 7, Ay(8 - i), 3.3, 10, , , 12
                .DrawText Replace(Replace(StrConv(Cm(4), vbNarrow), ",", "\n"), "､", "\n"), dX(9 - i) + 1, SY + y - 7, Ay(9 - i) - 2, 4, 10, , , 12
            Next
        End With
    End Sub
    
    Private Sub CPrintCls_TargetChange(sKey As String)
    End Sub

End Class CPrint現地調査報告書










Class CPrint耕作証明書
    Option Explicit
    Implements CPrintCls
    Private mvarParent As CPrintFormSK
    Private mvarKey As String
    Private mvarData As String
    Private s総会番号 As String
    Private vSt As Variant
    Dim nFsize As Integer
    Dim St As String

    Private Property Get CPrintCls_CanCancelPrint() As Boolean
    End Property

    Private Property Get CPrintCls_CanPrintNowPage() As Boolean: CPrintCls_CanPrintNowPage = True: End Property

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim Rsx As ADBasicLIB2.RecordsetEx
        Dim pNode As Object
        Dim pDic As New ADBasicLIB2.CDataDictionary
        Dim St1 As String
        Dim sSQL As String
        Dim sKey As String
        Dim s種類  As String
        Dim n田面積 As Double
        Dim n畑面積 As Double
        Dim n面積計 As Double
        Dim n筆計 As Long
        Dim Ar As Variant
        Dim sData As String
        Dim n As Long
        Dim sName(10) As String
        Dim nWork As Double
        Dim Cm As Variant
        Dim n譲渡人数 As Long
        Dim s譲渡ID As String
        Dim mvar受付範囲 As Date
        
        On Error GoTo Ext_Err
        nFsize = 12
        s総会番号 = Val(SystemDB.DBProperty("今月総会番号"))
        mvar受付範囲 = DateSerial(Year(Now), Month(Now) - 1, Val(SystemDB.DBProperty("申請締切")) + 1)
        mvarParent.表示倍率 = 1
        mvarParent.UsedTreeView = True
        If Val(sParam) Then
            n = Val(sParam)
            
            Set Rs = SystemDB.GetRecordsetEx("SELECT *,'申請.' & [ID] AS [Key],'法令.' & [法令] AS [Key2] FROM [D_申請] WHERE [総会番号]=" & Val(s総会番号) & " AND [支所番号]=" & Val(sParam) & " AND [現地調査区分]>0 AND ((D_申請.状態)<2) AND ((D_申請.受付年月日)>=#" & mvar受付範囲 & "#) ORDER BY [法令],[申請地大字ID],[申請地地番],[受付番号];", 0, , "現地調査報告書")
        Else
            Set Rs = SystemDB.GetRecordsetEx("SELECT *,'申請.' & [ID] AS [Key],'法令.' & [法令] AS [Key2] FROM [D_申請] WHERE [総会番号]=" & Val(s総会番号) & " AND [現地調査区分]>0 AND ((D_申請.状態)<2) AND ((D_申請.受付年月日)>=#" & mvar受付範囲 & "#) ORDER BY [法令],[申請地大字ID],[申請地地番],[受付番号];", 0, , "現地調査報告書")
        End If
        
        If Rs.EOF Then
            SystemDB.CloseRs Rs
            MsgBox "データがありません", , "現地調査報告書"
            CPrintCls_DataInit = True
            Exit Function
        End If
        Do Until Rs.EOF
            Select Case Rs.Value("法令")
                Case state3条所有権, state3条賃借権, state県3条所有権, state県3条賃借権: sKey = "3条"
                Case state4条転用: sKey = "4条"
                Case state5条所有権, state5条賃借権: sKey = "5条"
                Case state20条解約: sKey = "20条"
                Case state基盤利用権設定: sKey = "利用権設定"
                Case state農用地計画変更: sKey = "農用地計画変更"
                Case state事業計画変更:   sKey = "事業計画変更"
                Case state農地利用変更:   sKey = "農地利用変更"
                Case state買受適格耕公, state買受適格耕競: sKey = "買受適格耕作"
                Case state買受適格転公, state買受適格転競: sKey = "買受適格転用"
                Case Else: sKey = ""
            End Select
            
            s種類 = ""
            Select Case Rs.Value("法令")
                Case state3条所有権, state県3条所有権: s種類 = IIf(Val(Rs.Value("所有権移転の種類")) > 0, SystemDB.GetDirectDataWithClass("M_BASICALL", "名称", "所有権移転の種類", Val(Rs.Value("所有権移転の種類"))), "")
                Case state買受適格耕公, state買受適格転公: s種類 = "公売"
                Case state買受適格耕競, state買受適格転競: s種類 = "競売"
                Case state農用地計画変更:
                    Select Case Rs.Value("区分")
                        Case 1: s種類 = "除外"
                        Case 2: s種類 = "用途区分変更"
                        Case 3: s種類 = "編入"
                    End Select
            End Select
            
            n筆計 = 0: n田面積 = 0: n畑面積 = 0: n面積計 = 0: sData = "": n譲渡人数 = 0: s譲渡ID = ";"
            If Len(sKey) Then
                If pDic.Exists(sKey) Then
                Else
                    pDic.Add sKey, sKey
                    mvarParent.Nodes.Add , , sKey & ".0", sKey, "CloseFolder", "CloseFolder"
                End If
                
                If sKey = "事業計画変更" Then
                    If Rs.IsNull("農地リスト") Then
                        sData = vbBack & vbBack & vbBack
                        nWork = 0
                    ElseIf Len(Rs.Value("農地リスト")) > 0 Then
                        Ar = Split(Rs.Value("農地リスト"), vbCrLf)
                        For n = 0 To UBound(Ar)
                            n筆計 = n筆計 + 1
                            If n筆計 = 1 Then
                                Cm = Split(Ar(n), ";")
                                sData = Cm(0) & vbBack & Cm(1) & vbBack & Cm(2) & vbBack & Val(Cm(3))
                            End If
                            nWork = Ck面積(Val(Cm(3)))
                            If InStr(Cm(2), "田") > 0 Then
                                n田面積 = n田面積 + nWork
                            ElseIf InStr(Cm(2), "畑") > 0 Then
                                n畑面積 = n畑面積 + nWork
                            End If
                            n面積計 = n面積計 + nWork
                        Next
                    End If
                Else
                    St = Replace(Replace(Rs.NullCast("農地リスト", ""), "農地.", ""), ";", ",")
                    If Len(St) Then
                        sSQL = "SELECT '農地.' & [V_農地].ID AS [Key],[V_農地].土地所在,[V_農地].登記簿地目,[V_農地].農委地目ID,[V_農地].農委地目認定日,[V_農地].田面積,[V_農地].畑面積,[V_農地].樹園地,[V_農地].採草放牧面積,[V_農地].登記簿面積,[V_農地].管理人ID"
                        sSQL = sSQL & ",[V_地目].名称 AS [登記地目],[地目2].名称 AS [現況],[V_農委地目].名称 AS [農委地目]"
                        sSQL = sSQL & " FROM ((([V_農地] LEFT JOIN [V_地目] ON [V_農地].[登記簿地目]=[V_地目].ID) LEFT JOIN V_地目 AS 地目2 ON [V_農地].[現況地目]=[地目2].ID) LEFT JOIN [V_農委地目] ON [V_農地].[農委地目ID]=[V_農委地目].ID) WHERE [V_農地].[ID] IN (" & St & ")"
                        Set Rsx = SystemDB.GetRecordsetEx(sSQL, 0, , "現地調査報告")
                        Do Until Rsx.EOF
                            If n筆計 = 0 Then
                                If Rsx.Value("農委地目ID") <> 0 And Rsx.Value("農委地目認定日") <> "" And Rsx.Value("農委地目認定日") <> "0:00:00" Then
                                    St = Rsx.Value("農委地目")
                                Else
                                    St = Rsx.Value("現況")
                                End If
                                
                                sData = Rsx.Value("土地所在") & vbBack & _
                                        Rsx.Value("登記地目") & vbBack & St & vbBack & _
                                        Rsx.NullCast("田面積", 0) + Rsx.NullCast("畑面積", 0) + Rsx.NullCast("樹園地", 0) + Rsx.NullCast("採草放牧面積", 0)
                            End If
                            n筆計 = n筆計 + 1
                            If sKey = "4条" Or sKey = "5条" Then
                                n田面積 = n田面積 + Ck面積(Val(Rsx.Value("田面積")))
                                n畑面積 = n畑面積 + Ck面積(Val(Rsx.Value("畑面積")))
                                If n田面積 + n畑面積 = 0 Then
                                    n面積計 = n面積計 + Ck面積(Val(Rsx.Value("登記簿面積")))
                                Else
                                    n面積計 = n面積計 + Ck面積(Val(Rsx.Value("田面積"))) + Ck面積(Val(Rsx.Value("畑面積")))
                                End If
                            Else
                                n田面積 = n田面積 + Fix(Val(Rsx.Value("田面積")))
                                n畑面積 = n畑面積 + Fix(Val(Rsx.Value("畑面積")))
                                If n田面積 + n畑面積 = 0 Then
                                    n面積計 = n面積計 + Fix(Val(Rsx.Value("登記簿面積")))
                                Else
                                    n面積計 = n面積計 + Fix(Val(Rsx.Value("田面積"))) + Fix(Val(Rsx.Value("畑面積")))
                                End If
                            End If
                            
                            If Rs.Value("複数申請人A") Then
                                If InStr(s譲渡ID, ";" & Rsx.Value("管理人ID") & ";") = 0 Then
                                    n譲渡人数 = n譲渡人数 + 1
                                    s譲渡ID = s譲渡ID & CStr(Rsx.Value("管理人ID")) & ";"
                                End If
                            End If
                            Rsx.MoveNext
                        Loop
                        SystemDB.CloseRs Rsx
                    End If
                End If
                
                For n = 0 To 10: sName(n) = "": Next
                If sKey = "買受適格耕作" Or sKey = "買受適格転用" Then
                    St = Replace(Rs.Value("個人リスト"), "対象者.", "")
                    Ar = Split(St, ";")
                    For n = 0 To UBound(Ar)
                        If Val(Ar(n)) <> 0 Then
                            sName(n) = SystemDB.GetDirectData("D:個人Info", "氏名", Val(Ar(n)))
                        Else
                            sName(n) = "-"
                        End If
                    Next
                ElseIf Rs.Value("代理人名") = "" Then
                    sName(0) = Rs.Value("氏名A")
                Else
                    sName(0) = Rs.Value("代理人名")
                End If
                Set pNode = mvarParent.Nodes(sKey & ".0")
                If Len(pNode.Tag) > 0 Then pNode.Tag = pNode.Tag & vbTab
                For n = 0 To 10
                    If sName(n) = "" Then Exit For
                    If n > 0 Then pNode.Tag = pNode.Tag & vbTab
                    pNode.Tag = pNode.Tag & sName(n) & vbBack & Rs.Value("氏名B") & vbBack & _
                                Rs.Value("年齢A") & vbBack & Rs.Value("年齢B") & vbBack & _
                                Rs.Value("経営面積A") & vbBack & Rs.Value("経営面積B") & vbBack & _
                                Rs.Value("稼動人数") & vbBack & _
                                IIf(Rs.Value("権利種類") = 1, "賃貸借", IIf(Rs.Value("権利種類") = 2, "使用貸借", "")) & vbBack & _
                                Rs.Value("申請理由A")
                    If sKey = "利用権設定" Then
'                        pNode.Tag = pNode.Tag & vbBack & IIf(Rs.Value("認定農業者"), "認定農業者である", "") & vbBack & IIf(Rs.Value("担い手農家"), "担い手である", "")
                        pNode.Tag = pNode.Tag & vbBack & "0" & vbBack & "0"
                    Else
                        pNode.Tag = pNode.Tag & vbBack & "0" & vbBack & "0"
                    End If
                    pNode.Tag = pNode.Tag & vbBack & s種類 & vbBack & Rs.Value("用途") & vbBack & Rs.Value("意見") & vbBack & Rs.Value("予備1") & vbBack & Rs.Value("調査員A")
                    pNode.Tag = pNode.Tag & vbBack & sData
                    pNode.Tag = pNode.Tag & vbBack & n筆計 & vbBack & n田面積 & vbBack & n畑面積 & vbBack & n面積計 & vbBack & n譲渡人数
                Next
            End If
            Rs.MoveNext
        Loop
        SystemDB.CloseRs Rs
            
        vSt = "１.農地の区分と転用目的\n申請地は(　　　　　　　　　　　)に位置し、現況は(　　　)である。農地区分は(　　種)農地の(　　　　　　　　　)に該当する。\n２.資力及び信用\n資金の調達については、(自己資金・住宅金融公庫・融資）であるため問題はないと思われる。また、(融資証明・資金証明）も添付されている。\n３.転用行為の妨げとなる権利を有する者の同意状況\n法定小作人はなし。\n４.申請に係る用途に遅滞なく供することの確実性\n転用目的は(　        　　　)を建設するものであり、計画も妥当であるため実現は確実と思われる。" & _
        "\n５.行政庁の免許、許可、認可等の処分の見込み\n\n６.農地以外の土地の利用の見込み\n(農地以外の土地(雑種地　宅地　山林))を申請地と同時に利用するものであり適当と思われる。\n７.計画面積の妥当性\n全体計画面積は(　　u)であるため妥当であると思われる。\n８.宅地の造成のみを目的とする場合にはその妥当性\n都市計画の用途が定められた地域内(　　        　　　　)であるため妥当と思われる。\n９.周囲の農地等に係る営農条件への支障の有無\n申請地の東は(　　)、西は(　　)、南は(　　)、北は(　　)である。" & _
        "隣接農地については被害防除計画書に記載してある措置を取るため支障はないものと思われる。以上のような理由により転用はやむをえないと思われる。\n１０.一時転用である場合にはその妥当性\n一時転用の期間は(平成　年　月　日〜平成　年　月　日)までで、一時転用終了後農地へ復元する計画のため妥当であると思われる。\n１１.法令(条例を含む｡)により義務付けられている行政庁との協議の進捗状況\n法令(条例を含む。)により義務付けられている行政庁との協議については、現在(申請中・未申請)である。"
        vSt = Split(vSt, "\n")
        
        mvarParent.MaxPage = 1
        mvarParent.Page = 1
        Exit Function
    Ext_Err:
        MsgBox "データエラー:" & Err.Description & " In " & Err.Source, vbCritical
        CPrintCls_DataInit = True
    End Function
    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property

    Private Property Let CPrintCls_Key(ByVal RHS As String)

    End Property
    Private Property Get CPrintCls_Key() As String: CPrintCls_Key = mvarKey: End Property
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants: CPrintCls_Orientation = vbPRORPortrait: End Property
    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&)
        mvarParent.Page = nNewPage
        CPrintCls_Repaint
    End Sub
    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Set CPrintCls_Parent(RHS As ADBasicLIB2.CPrintFormSK): Set mvarParent = RHS: End Property

    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        Dim pNode As Object
        Dim nPage As Long
        Dim nMaxPage As Long
        Dim Ar As Variant
        Dim sKey As String
        
        If bNowPage Then
            PrintSub mvarKey, mvarParent.Page
            mvarParent.EndDoc
        Else
            For Each pNode In mvarParent.Nodes
                If pNode.Checked Then
                    nMaxPage = 0
                    sKey = pNode.Key
                    If Len(sKey) <> 0 Then
                        St = mvarParent.Nodes(sKey).Tag
                        If Len(St) <> 0 Then
                            Ar = Split(St, vbTab)
                            nMaxPage = UBound(Ar) + 1
                        End If
                    End If
                    For nPage = 1 To nMaxPage
                        PrintSub sKey, nPage
                        mvarParent.NewPage
                    Next
                    mvarParent.EndDoc
                End If
                pNode.Checked = False
            Next
        End If
    End Sub
    Private Sub CPrintCls_Repaint()
        PrintSub mvarKey, mvarParent.Page
    End Sub

    Private Sub CPrintCls_TargetChange(sKey As String)
        Dim Ar As Variant
        
        mvarParent.MaxPage = 1
'        mvarParent.Page = 1
        mvarKey = sKey
    
        If Len(sKey) <> 0 Then
            St = mvarParent.Nodes(sKey).Tag
            If Len(St) <> 0 Then
                Ar = Split(St, vbTab)
                mvarParent.MaxPage = UBound(Ar) + 1
            End If
        End If
'        PrintSub sKey, mvarParent.Page
        PrintSub sKey, 1
    End Sub
    
    Private Sub PrintSub(sKey As String, nPage As Long)
        Dim Ar As Variant
        On Error GoTo Ext_Err
        mvarParent.ClearScreen
        SetData sKey, nPage
        If Len(mvarData) = 0 Then Exit Sub
            
        Ar = Split(mvarData, vbBack)
        
        Select Case Fnc.GetKeyHead(sKey)
            Case "3条": Print3条 Ar
            Case "4条": Print4条 Ar
            Case "5条": Print5条 Ar
            Case "20条": Print20条 Ar
            Case "利用権設定":   Print利用権設定 Ar
            Case "農用地計画変更": Print農用地計画変更 Ar
            Case "事業計画変更": Print事業計画変更 Ar
            Case "農地利用変更": Print農地利用変更 Ar
            Case "買受適格耕作": Print買受適格耕作 Ar
            Case "買受適格転用": Print買受適格転用 Ar
        End Select
    Exit Sub
    Ext_Err:
        MsgBox "データエラー:" & Err.Description & " In " & Err.Source, vbCritical
    End Sub

    Private Sub Print3条(Cm As Variant)
        With mvarParent
            .Offset 0, 0
            
            罫線A "譲受人（借人）", "譲渡人（貸人）", True
            .TextOut "現地調査報告書（３条）", 19, 27, 13
            .TextOut "受 人 の 経営面積", 38, 102, nFsize, 2, 2
            .TextOut "u", 93, 102, nFsize, 1, 2
            .TextOut "受人の世帯員のうち農作業常時従事者数", 131.5, 102, nFsize - 3, 2, 2
            .TextOut "人", 185, 102, nFsize, 1, 2
            .TextOut "法　 律　 関　 係", 38, 110, nFsize, 2, 2

            .DLine 58, 50, 58, 114
            .DLine 18, 106, 190, 106
            .DLine 100, 98, 100, 106
            .DLine 163, 98, 163, 106
            .DBox 18, 50, 190, 114, vbBlack, 4
            
            St = "申 請 地 の 位 置;"
            St = St & "申請地は（　　　　　　　　　）の（　　　　　　）に位置しており、現況は（　　　　　　）である。;"
            St = St & "現 在 の 耕 作 者;"
            St = St & "現在は〔（　　　　　　　　）さんが耕作している。・不耕作地である。〕;"
            St = St & "受　人　の　理　由;"
            St = St & "受人の（　　　　　　　）さんは、（　　　　　　）という申請理由であり、耕作意欲は（　　　）。また、農機具は（完備している ・　　　　　　）;"
            St = St & "決 　定 　意 　見;"
            St = St & "以上のような理由により、当申請は農地法第3条2項の〔各号に該当しない・（　　）号に該当する〕と思われるので、（許可相当・不許可相当)と思われる。;"
            St = St & "許可に附すべき条件\n及 び 特 記 事 項;"
            
            内容A St, 122, 240, 5, nFsize
            当込A Cm, True
            .TextOut Format(Val(Cm(5)), "#,##0"), 83, 102, nFsize, 1, 2
            .TextOut Format(Val(Cm(6)), "#"), 175, 102, nFsize, 1, 2
            .TextOut Cm(11), 59, 110, nFsize, 0, 2
        End With
    End Sub
    
    Private Sub Print4条(Cm As Variant)
        With mvarParent
            .Offset 0, -10
            
            罫線B
            .TextOut "現地調査報告書（転用）", 19, 27, 13
            .TextOut "転　 用 　目 　的", 38, 94, nFsize, 2, 2
            
            .DLine 18, 98, 190, 98
            .DLine 18, 106, 190, 106
            .DLine 58, 50, 58, 98
            .DBox 18, 50, 190, 98, vbBlack, 4
            
    '            St = "申 請 地 の 位 置;"
    '            St = St & "申請地は（　　　　　　　　　）の（　　　　　　）に位置しており、現況は（　　　　　　）である。;"
    '            St = St & "周　囲　の　状　況;"
    '            St = St & "申請地の北は（　　　　　　　　）、南は（　　　　　　　　）、東は（　　　　　　　　）、西は（　　　　　　　　）である。;"
    '            St = St & "転　 用 　目　 的;"
    '            St = St & "転用目的は（　　　　　　　　　）を（建 設）するものである。;"
    '            St = St & "農　 地 　区 　分;"
    '            St = St & "農地区分は、（　　　　）種農地の（　　　　　　　　　　）に該当するものと思われる。;"
    '            St = St & "用 ・ 排 水 関 係;"
    '            St = St & "周囲の農地の用水路及び排水路は（確 保）されている。 家庭用排水は（浄化槽・下水道）を通じ（　　　　　　　　）に流す計画のため特に問題はないものと思われる。;"
    '            St = St & "決 　定 　意 　見;"
    '            St = St & "以上のような理由により、周囲の農地に与える影響は軽微であると思われ、（転用）についてはやむを得ないものと思われる。;"
    '            St = St & "許可に附すべき条件\n及 び 特 記 事 項;"
    '            内容A St, 106, 235, 7, nFsize
            内容C St, 106, 235, 7, nFsize, 4
            当込B Cm
            .TextOut Cm(8), 59, 94, nFsize, 0, 2
        End With
    End Sub

    Private Sub Print5条(Cm As Variant)
        With mvarParent
            .Offset 0, -10
            
            罫線A "譲受人（借人）", "譲渡人（貸人）"
            .TextOut "現地調査報告書（転用）", 19, 27, 13
            .TextOut "転   用   目   的", 38, 102, nFsize, 2, 2

            .DBox 18, 50, 190, 106, vbBlack, 4
            .DLine 58, 50, 58, 106
            
            St = "申 請 地 の 位 置;"
            St = St & "申請地は（　　　　　　　　　）の（　　　　　　）に位置しており、現況は（　　　　　　）である。;"
            St = St & "周　囲　の　状　況;"
            St = St & "申請地の北は（　　　　　　　　）、南は（　　　　　　　　）、東は（　　　　　　　　）、西は（　　　　　　　　）である。;"
            St = St & "転　 用 　目　 的;"
            St = St & "転用目的は（　　　　　　　　　）を（建 設）するものである。;"
            St = St & "農　 地 　区 　分;"
            St = St & "農地区分は、（　　　　）種農地の（　　　　　　　　　　）に該当するものと思われる。;"
            St = St & "用 ・ 排 水 関 係;"
            St = St & "周囲の農地の用水路及び排水路は（確 保）されている。 家庭用排水は（浄化槽・下水道）を通じ（　　　　　　　　）に流す計画のため特に問題はないものと思われる。;"
            St = St & "決 　定 　意 　見;"
            St = St & "以上のような理由により、周囲の農地に与える影響は軽微であると思われ、（転用）についてはやむを得ないものと思われる。;"
            St = St & "許可に附すべき条件\n及 び 特 記 事 項;"
            内容C St, 114, 243, 7, nFsize, 5
            当込A Cm
            .TextOut Cm(8), 59, 102, nFsize, 0, 2
        End With
    End Sub

    Private Sub Print20条(Cm As Variant)
        With mvarParent
            .Offset 0, 0

            罫線A "借　　　　　人", "貸　　　　　人"
            .TextOut "２０条６項報告書", 19, 27, 13
            .TextOut "解　 約　 理　 由", 38, 102, nFsize, 2, 2
            .TextOut "第20条第１項第２号", 38, 114.5, nFsize, 2, 2
            .TextOut "引渡し前６ヶ月以内に成立した合意で（ ある・ない ）、", 59, 110, nFsize - 1
            .TextOut "その旨が書面において明らかで（ ある・ない ）", 59, 115, nFsize - 1
            .TextOut "施行規則第14条の３", 38, 127, nFsize, 2, 2
            .TextOut "合意解約が成立した翌日から30日以内に通知されたもので(ある・ない)", 59, 127, nFsize - 1, 0, 2
                         
            .TextOut "調査内容", 19, 135, nFsize, 0, 2
            .TextOut "貸人（　　　　　　　　　）、借人（　　　　　　　　　）の双方に確認したところ、", 19, 158, nFsize
            .TextOut "議案記載の解約理由（　　　　　　　　　）のとおり、間違いありませんでした。", 19, 183, nFsize
            .TextOut "特   記   事  項", 38, 231.5, nFsize, 2, 2
            .TextOut "以上のとおり、確認しましたので報告いたします。", 20, 251, nFsize
            .TextOut "報告年月日　平成　　年　　月　　日", 26, 259, nFsize
            .TextOut "報告委員名", 105, 267, nFsize
            
            .DLine 18, 106, 190, 106
            .DLine 18, 123, 190, 123
            .DLine 18, 131, 190, 131
            .DLine 58, 50, 58, 131
            .DBox 18, 50, 190, 131, vbBlack, 4
            
            .DBox 18, 139, 190, 240, vbBlack, 4
            .DLine 18, 223, 190, 223
            .DLine 58, 223, 58, 240
            当込A Cm
            .TextOut Cm(8), 59, 102, nFsize, 0, 2
        End With
    End Sub

    Private Sub Print利用権設定(Cm As Variant)
        With mvarParent
            .Offset 0, 0
            
            罫線A "借　　　　　人", "貸　　　　　人", True, "利用権設定"
            .TextOut "現地調査報告書（利用権設定）", 19, 27, 13
            .TextOut "借　人 の 経営形態", 38, 102, nFsize, 2, 2
            .TextOut "借　人 の 経営面積", 38, 110, nFsize, 2, 2
            .TextOut "u", 90, 110, nFsize, 2, 2
            .TextOut "借人の世帯員のうち農作業常時従事者数", 104, 110, nFsize - 3, 0, 2
            .TextOut "人", 185, 110, nFsize, 1, 2
            .TextOut "法　 律　 関　 係", 38, 118, nFsize, 2, 2
            .TextOut "調査内容", 19, 126, nFsize, 0, 2
            .DrawText "耕作等の事業に供すべき農用地のすべてについて耕作等を行うと認められるか否か", 19, 131, 39, 5, nFsize
            .DrawText "借人の（　　　　　　　　）さんは（　担い手農家 ・ 認定農業者 ・　　　　　　）であり、現在、（　　　　　　）uのすべてについて耕作して（　いる ・ いない　）。", 59, 136, 131, 5, nFsize
            .DrawText "耕作等の事業に必要な農作業に常時従事すると認められるか否か", 19, 158, 39, 5, nFsize
            .DrawText "また、（　専業 ・ 兼業　）農家であり、農作業に常時従事して（ いる ・ いない ）。\nまた、農機具は（ 完備している。 ・　　　　　　）", 59, 161, 131, 5, nFsize
            .DrawText "その土地を効率的に利用することができると認められるか否か", 19, 183, 39, 4, nFsize - 2
            .DrawText "申請地を効率的に利用することが( できる・できない )と認められる。", 59, 184, 131, 5, nFsize
            .TextOut "決 　定 　意 　見", 38, 205.5, nFsize, 2, 2
            .DrawText "以上のような理由により、借人は利用権設定を受ける要件を備えて（ いる ・ いない ）ものと思われる。", 59, 201, 131, 5, nFsize
            .TextOut "特 　記 　事 　項", 38, 222.5, nFsize, 2, 2
            .TextOut "以上のとおり、現地調査を実施しましたので報告いたします。", 20, 259, nFsize
            .TextOut "報告年月日　平成　　年　　月　　日", 26, 267, nFsize
            .TextOut "現地調査報告委員名", 105, 275, nFsize

            .DBox 18, 50, 190, 122, vbBlack, 4
            .DLine 18, 106, 190, 106
            .DLine 18, 114, 190, 114
            .DLine 58, 50, 58, 122
            .DLine 103, 106, 103, 114
            .DLine 163, 106, 163, 114
            
            .DBox 18, 130, 190, 231, vbBlack, 4
            .DLine 18, 155, 190, 155
            .DLine 18, 180, 190, 180
            .DLine 18, 197, 190, 197
            .DLine 18, 214, 190, 214
            .DLine 18, 231, 190, 231
            .DLine 58, 130, 58, 231
        
            当込A Cm, True
            .TextOut Cm(10) & "　" & Cm(9), 59, 102, nFsize, 0, 2
            .TextOut Format(Val(Cm(5)), "#,##0"), 85, 110, nFsize, 1, 2
            .TextOut Format(Val(Cm(6)), "#"), 175, 110, nFsize, 1, 2
            .TextOut Cm(7), 59, 118, nFsize, 0, 2
        End With
    End Sub
    
    Private Sub Print農地利用変更(Cm As Variant)
        With mvarParent
            .Offset 0, 0

            罫線B
            .TextOut "現地調査報告書（農地利用変更届）", 19, 27, 13
            .TextOut "利 用 変 更 目 的", 38, 94, nFsize, 2, 2
            .TextOut "工   事   内   容", 38, 102, nFsize, 2, 2
            .TextOut "土地改良区の意見", 157, 102, nFsize, 2, 2

            .DBox 18, 50, 190, 106, vbBlack, 4
            .DLine 58, 50, 58, 106
            .DLine 18, 98, 190, 98
            .DLine 138, 98, 138, 106
            .DLine 175, 98, 175, 106

            St = "申 請 地 の 位 置;"
            St = St & "申請地は（　　　　　　　　　）の（　　　　　　）に位置しており、現況は（　　　　　　）である。;"
            St = St & "周　囲　の　状　況;"
            St = St & "申請地の北は（　　　　　　　　）、南は（　　　　　　　　）、東は（　　　　　　　　）、西は（　　　　　　　　）である。;"
            St = St & "利 用 変 更 目 的;"
            St = St & "利用変更目的は（　畑として使用する ・ 農業用施設　　uを建設する ）ものである。;"
            St = St & "工   事   内   容;"
            St = St & "工事内容は盛土を（　　　　　　　　　）し、\n周囲は（　　　　　　　　　　）するものである;"
            St = St & "用 ・ 排 水 関 係;"
            St = St & "周囲の農地や用水路及び排水路に及ぼす影響は（　　　）と思われる。;"
            St = St & "決 　定 　意 　見;"
            St = St & "以上のような理由により、当届出は（ 妥当なもの ・ 妥当ではないもの ）と思われる。;"
            St = St & "条件及び特記事項;"
            内容A St, 114, 243, 7, nFsize
            当込B Cm
            .TextOut Cm(12), 59, 94, nFsize, 0, 2
            .DrawText Cm(14), 59, 98.5, 80, 3.5, nFsize - 2
            .DrawText Cm(13), 177, 100, 42, 4, nFsize
        End With
    End Sub
    
    Private Sub Print事業計画変更(Cm As Variant)
        With mvarParent
            .Offset 0, 0
            
            罫線B
            .TextOut "現地調査報告書（事業計画変更）", 19, 27, 13
            .TextOut "転   用   目   的", 38, 94, nFsize, 2, 2
            
            .DLine 18, 98, 190, 98
            .DLine 18, 106, 190, 106
            .DLine 58, 50, 58, 98
            .DBox 18, 50, 190, 98, vbBlack, 4
            
            St = "申 請 地 の 位 置;"
            St = St & "申請地は（　　　　　　　　　）の（　　　　　　）に位置しており、現況は（　　　　　　）である。;"
            St = St & "周　囲　の　状　況;"
            St = St & "申請地の北は（　　　　　　　　）、南は（　　　　　　　　）、東は（　　　　　　　　）、西は（　　　　　　　　）である。;"
            St = St & "転　 用 　目　 的;"
            St = St & "転用目的は（　　　　　　　　　）を（建 設）するものである。;"
            St = St & "農　 地 　区 　分;"
            St = St & "農地区分は（　　　　　　　　　）であるため、（　　　　）種農地の（　　　　　　　　　　）に該当するものと思われる。;"
            St = St & "用 ・ 排 水 関 係;"
            St = St & "周囲の農地の用水路及び排水路は（確 保）されている。 家庭用排水は（浄化槽・下水道）を通じ（　　　　　　　　）に流す計画のため特に問題はないものと思われる。;"
            St = St & "決 　定 　意 　見;"
            St = St & "周囲の農地に与える影響は変更前と比較して同程度であり、また、その必要性・確実性もあると思われるため事業計画変更申請についてはやむを得ないものと思われる。;"
            St = St & "許可に附すべき条件\n及 び 特 記 事 項;"
            内容A St, 106, 239, 7, nFsize
            .TextOut Cm(15), 59, 62, nFsize, 0, 2
            .TextOut Cm(0), 59, 70, nFsize, 0, 2
            If Val(Cm(20)) > 1 Then
                .TextOut Cm(16) & "　　外" & Val(Cm(20)) - 1 & "筆", 59, 78, nFsize, 0, 2
            Else
                .TextOut Cm(16), 59, 78, nFsize, 0, 2
            End If
            .TextOut Set面積(Val(Cm(21))), 89, 86, nFsize, 1, 2
            .TextOut Set面積(Val(Cm(22))), 131, 86, nFsize, 1, 2
            .TextOut Set面積(Val(Cm(23))), 180, 86, nFsize, 1, 2
            .TextOut Cm(8), 59, 94, nFsize, 0, 2
        End With
    End Sub

    Private Sub Print買受適格耕作(Cm As Variant)
        With mvarParent
            .Offset 0, 0
            
            罫線B True
            .TextOut "現地調査報告書（買受適格証明・耕作目的）", 19, 27, 13
            .TextOut "経   営   面   積", 38, 94, nFsize, 2, 2
            .TextOut "u", 90, 94, nFsize, 2, 2
            .TextOut "世帯員のうち農作業常時従事者数", 131.5, 94, nFsize - 2, 2, 2
            .TextOut "人", 185, 94, nFsize, 1, 2
            .TextOut "法　 律　 関　 係", 38, 102, nFsize, 2, 2
            
            .DLine 18, 98, 190, 98
            .DLine 100, 90, 100, 98
            .DLine 163, 90, 163, 98
            .DLine 58, 50, 58, 106
            .DBox 18, 50, 190, 106, vbBlack, 4

            St = "申 請 地 の 位 置;"
            St = St & "申請地は（　　　　　　　　　）の（　　　　　　）に位置しており、現況は（　　　　　　）である。;"
            St = St & "現 在 の 耕 作 者;"
            St = St & "現在は（　　　　　　　　）さんが（耕作されています。・不耕作地です。）;"
            St = St & "申 請 人 の 理 由;"
            St = St & "申請人の" & Cm(1) & "さんは、今回、（　　　　　）" & Cm(14) & "に参加するための申請であり、耕作意欲は（　　　　）。また、農機具は（　完備している　・　　　　　　　　　）;"
            St = St & "決 　定 　意 　見;"
            St = St & "以上のような理由により、当申請は農地法第3条第2項の〔各号に該当しない・（　　）号に該当する〕と思われるので、（ 買受適格者である ・ 買受適格者でない ）と思われる。;"
            St = St & "許可に附すべき条件\n及 び 特 記 事 項;"
            内容A St, 114, 235, 5, nFsize
            当込B Cm, True
            .TextOut Cm(8), 59, 94, nFsize, 0, 2
            '.TextOut Format(Val(Cm(5)), "#,##0"), 85, 94, nFsize, 1, 2
            .TextOut Format(Val(Cm(6)), "#"), 175, 94, nFsize, 1, 2
            .TextOut Cm(11), 59, 102, nFsize, 0, 2
        End With
    End Sub
    
    Private Sub Print買受適格転用(Cm As Variant)
        With mvarParent
            .Offset 0, 0
            
            罫線B
            .TextOut "現地調査報告書（買受適格証明・転用目的）", 19, 27, 13
            .TextOut "転　 用 　目 　的", 38, 94, nFsize, 2, 2
            .TextOut "法　 律　 関　 係", 38, 102, nFsize, 2, 2

            .DLine 18, 98, 190, 98
            .DLine 100, 90, 100, 90
            .DLine 163, 90, 163, 90
            .DLine 58, 50, 58, 106
            .DBox 18, 50, 190, 106, vbBlack, 4
            
            St = "申 請 地 の 位 置;"
            St = St & "申請地は（　　　　　　　　　）の（　　　　　　）に位置しており、現況は（　　　　　　）である。;"
            St = St & "周　囲　の　状　況;"
            St = St & "申請地の北は（　　　　　　　　）、南は（　　　　　　　　）、東は（　　　　　　　　）、西は（　　　　　　　　）である。;"
            St = St & "転　 用 　目　 的;"
            St = St & "転用目的は（　　　　　　　　　）を（建 設）するものである。;"
            St = St & "農　 地 　区 　分;"
            St = St & "農地区分は（　　　　　　　　　）であるため、（　　　　）種農地の（　　　　　　　　　　）に該当するものと思われる。;"
            St = St & "用 ・ 排 水 関 係;"
            St = St & "周囲の農地の用水路及び排水路は（確 保）されている。 家庭用排水は（浄化槽・下水道）を通じ（　　　　　　　　）に流す計画のため特に問題はないものと思われる。;"
            St = St & "決 　定 　意 　見;"
            St = St & "以上のような理由により、周囲の農地に与える影響は軽微であると思われ、（転用）についてはやむを得ないものと思われる。;"
            St = St & "許可に附すべき条件\n及 び 特 記 事 項;"
            内容A St, 114, 243, 7, nFsize
            当込B Cm
            .TextOut Cm(8), 59, 94, nFsize, 0, 2
            .TextOut Cm(11), 59, 102, nFsize, 0, 2
        End With
    End Sub
    
    Private Sub Print農用地計画変更(Cm As Variant)
        Dim s目的 As String
        
        With mvarParent
            .Offset 0, 0
            
            罫線B
            .TextOut "現地調査報告書（" & Cm(11) & "）", 19, 27, 13
            Select Case Cm(11)
                Case "除外": s目的 = "除　 外 　目 　的"
                Case "用途区分変更": s目的 = "用途区分変更 目 的"
                Case "編入": s目的 = "編　 入 　目 　的"
                Case Else: s目的 = ""
            End Select
            .TextOut s目的, 38, 94, nFsize, 2, 2

            .DLine 18, 98, 190, 98
            .DLine 18, 106, 190, 106
            .DLine 58, 50, 58, 98
            .DBox 18, 50, 190, 98, vbBlack, 4
            
            St = "申 請 地 の 位 置;"
            St = St & "申請地は（　　　　　　　　　）の（　　　　　　）に位置しており、現況は（　　　　　　）である。;"
            St = St & "周　囲　の　状　況;"
            St = St & "申請地の北は（　　　　　　　　）、南は（　　　　　　　　）、東は（　　　　　　　　）、西は（　　　　　　　　）である。;"
            St = St & s目的 & ";"
            Select Case Cm(11)
                Case "除外":
                    St = St & "除外目的は（　　　　　　　　　）を（建 設）するものである。;"
                    St = St & "用 ・ 排 水 関 係;"
                    St = St & "周囲の農地の用水路及び排水路は（確保）されている。 家庭用排水は（浄化槽・下水道）を通じ（　　　　　　）に流す計画のため特に問題はないものと思われる。;"
                    St = St & "総 　合 　意 　見;"
                    St = St & "申請地は農用地の外周部に位置しており、農用地除外することで、周囲の農地に及ぼす影響は軽微であると思われ、除外はやむを得ないものと思われる。;"
                Case "用途区分変更":
                    St = St & "用途区分変更目的は（　　　　　　　　　）にするものである。;"
                    St = St & "用 ・ 排 水 関 係;"
                    St = St & "周囲の農地の用水路及び排水路は（確保）されている。 家庭用排水は（浄化槽・下水道）を通じ（　　　　　　）に流す計画のため特に問題はないものと思われる。;"
                    St = St & "総 　合 　意 　見;"
                    St = St & "申請地は農用地の外周部に位置しており、用途区分変更することで、周囲の農地に及ぼす影響は軽微であると思われ、用途区分変更はやむを得ないものと思われる。;"
                Case "編入":
                    St = St & "編入目的は農地として有効に利用したいため、農用地へ編入するものです。;"
                    St = St & ";;"
                    St = St & "総 　合 　意 　見;"
                    St = St & "申請地を農用地へ編入することは問題ないと思われる。;"
                Case Else
                    St = St & ";;;;;"
            End Select
            St = St & "許可に附すべき条件\n及 び 特 記 事 項;"
            内容B St, 106, 235, 6, nFsize, 9.5
            当込B Cm
            .TextOut Left(Cm(12), 30), 59, 94, nFsize, 0, 2
        End With
    End Sub
    
    Private Sub 罫線A(s受人 As String, s渡人 As String, Optional b年齢 As Boolean = False, Optional s条 As String = "　　　条")
        With mvarParent
        
            .DLine 18, 58, 190, 58
            .DLine 18, 66, 190, 66
            .DLine 18, 82, 190, 82
            .DLine 18, 90, 190, 90
            .DLine 18, 98, 190, 98
            .DLine 24, 66, 24, 82
            .DLine 24, 74, 190, 74
            If b年齢 Then .DLine 163, 66, 163, 74
            .DLine 68, 90, 68, 98
            .DLine 100, 90, 100, 98
            .DLine 110, 90, 110, 98
            .DLine 142, 90, 142, 98
            .DLine 152, 90, 152, 98
            
            .TextOut "第（ " & IIf(s総会番号 = "0", "   ", s総会番号) & " )回　定例会議案第　　　号　　　番（" & s条 & "　　　番）", 19, 35, 13
            .TextOut "調　査　年　月　日", 38, 54, nFsize, 2, 2
            .TextOut "平成　　年　　月　　日", 59, 54, nFsize, 0, 2
            .TextOut "調　査　委　員　名", 38, 62, nFsize, 2, 2
            .DrawText "申\n請\n人", 18, 68, 6, 4.5, nFsize, 2, 0
            .TextOut s受人, 41, 70, nFsize, 2, 2
            If b年齢 Then .TextOut "年齢", 164, 70, nFsize, 0, 2
            .TextOut s渡人, 41, 78, nFsize, 2, 2
            .TextOut "申　　　請　　　地", 38, 86, nFsize, 2, 2
            .TextOut "面　　　　　　　積", 38, 94, nFsize, 2, 2
            .TextOut "田", 63, 94, nFsize, 2, 2
            .TextOut "u", 91, 94, nFsize, 0, 2
            .TextOut "畑", 105, 94, nFsize, 2, 2
            .TextOut "u", 133, 94, nFsize, 0, 2
            .TextOut "計", 147, 94, nFsize, 2, 2
            .TextOut "u", 186, 94, nFsize, 1, 2
        End With
    End Sub
    
    Private Sub 罫線B(Optional b年齢 As Boolean = False)
        With mvarParent
            .DLine 18, 58, 190, 58
            .DLine 18, 66, 190, 66
            .DLine 18, 74, 190, 74
            .DLine 18, 82, 190, 82
            .DLine 18, 90, 190, 90
            If b年齢 Then .DLine 163, 66, 163, 74
            .DLine 68, 82, 68, 90
            .DLine 100, 82, 100, 90
            .DLine 110, 82, 110, 90
            .DLine 142, 82, 142, 90
            .DLine 152, 82, 152, 90
            
            .TextOut "第（ " & IIf(s総会番号 = "0", "   ", s総会番号) & " )回　定例会議案第　　　号　　　番（　　　条　　　番）", 19, 35, 13
            .TextOut "調　査　年　月　日", 38, 54, nFsize, 2, 2
            .TextOut "平成　　年　　月　　日", 59, 54, nFsize, 0, 2
            .TextOut "調　査　委　員　名", 38, 62, nFsize, 2, 2
            .TextOut "申　　　請　　　人", 38, 70, nFsize, 2, 2
            If b年齢 Then .TextOut "年齢", 164, 70, nFsize, 0, 2
            .TextOut "申　　　請　　　地", 38, 78, nFsize, 2, 2
            .TextOut "面　　　　　　　積", 38, 86, nFsize, 2, 2
            .TextOut "田", 63, 86, nFsize, 2, 2
            .TextOut "u", 91, 86, nFsize, 0, 2
            .TextOut "畑", 105, 86, nFsize, 2, 2
            .TextOut "u", 133, 86, nFsize, 0, 2
            .TextOut "計", 147, 86, nFsize, 2, 2
            .TextOut "u", 186, 86, nFsize, 1, 2
        End With
    End Sub

    Private Sub 当込A(Cm As Variant, Optional b年齢 As Boolean = False)
        With mvarParent
            .TextOut Cm(15), 59, 62, nFsize, 0, 2
            .TextOut Cm(1), 59, 70, nFsize, 0, 2
            If b年齢 Then .TextOut Format(Val(Cm(3)), "#"), 178, 70, nFsize, 0, 2
            .TextOut Cm(0) & IIf(Val(Cm(24)) > 1, "　　外" & Val(Cm(24)) - 1 & "名", ""), 59, 78, nFsize, 0, 2
            If Val(Cm(20)) > 1 Then
                .TextOut Cm(16) & "　　外" & Val(Cm(20)) - 1 & "筆", 59, 86, nFsize, 0, 2
            Else
                .TextOut Cm(16), 59, 86, nFsize, 0, 2
            End If
            .TextOut Set面積(Val(Cm(21))), 89, 94, nFsize, 1, 2
            .TextOut Set面積(Val(Cm(22))), 131, 94, nFsize, 1, 2
            .TextOut Set面積(Val(Cm(23))), 180, 94, nFsize, 1, 2
        End With
    End Sub
    
    Private Sub 当込B(Cm As Variant, Optional b年齢 As Boolean = False)
        With mvarParent
            .TextOut Cm(15), 59, 62, nFsize, 0, 2
            .TextOut Cm(0), 59, 70, nFsize, 0, 2
            If b年齢 Then .TextOut Format(Val(Cm(2)), "#"), 178, 70, nFsize, 0, 2
            If Val(Cm(20)) > 1 Then
                .TextOut Cm(16) & "　　外" & Val(Cm(20)) - 1 & "筆", 59, 78, nFsize, 0, 2
            Else
                .TextOut Cm(16), 59, 78, nFsize, 0, 2
            End If
            .TextOut Set面積(Val(Cm(21))), 89, 86, nFsize, 1, 2
            .TextOut Set面積(Val(Cm(22))), 131, 86, nFsize, 1, 2
            .TextOut Set面積(Val(Cm(23))), 180, 86, nFsize, 1, 2
        End With
    End Sub
    
    Private Sub 内容A(pSt As String, pY1 As Single, pY2 As Single, nRow As Long, nFsize As Integer)
        Dim nY As Single
        Dim n As Long
        Dim i As Long
        Dim Cm As Variant
        
        If Len(pSt) = 0 Then Exit Sub
        Cm = Split(pSt, ";")
        With mvarParent
            .TextOut "調査内容", 19, pY1 - 4, nFsize, 0, 2
            nY = pY1
            i = 0
            For n = 0 To nRow - 1
                .DrawText Cm(i), 18, nY, 40, 5, nFsize, 2, 2, 17
                .DrawText Cm(i + 1), 59, nY, 131, 5, nFsize, 0, 2, 17
                i = i + 2
                nY = nY + 17
            Next
            nY = pY2
            .TextOut "以上のとおり、現地調査を実施しましたので報告いたします。", 20, nY, nFsize
            .TextOut "報告年月日　平成　　年　　月　　日", 26, nY + 9, nFsize
            .TextOut "現地調査報告委員名", 105, nY + 18, nFsize
            
            nY = pY1
            .LineBox 18, nY, 190, nY + 17, , nRow, 40
            .DBox 18, nY, 190, nY + 17 * nRow, vbBlack, 4
        End With
    End Sub
    
    Private Sub 内容B(pSt As String, pY1 As Single, pY2 As Single, nRow As Long, nFsize As Integer, nFsizeS As Integer)
        Dim nY As Single
        Dim n As Long
        Dim i As Long
        Dim Cm As Variant
        
        If Len(pSt) = 0 Then Exit Sub
        Cm = Split(pSt, ";")
        With mvarParent
            .TextOut "調査内容", 19, pY1 - 4, nFsize, 0, 2
            nY = pY1
            i = 0
            For n = 0 To nRow - 1
                .DrawText Cm(i), 18, nY + 8.5, 40, 5, nFsize, 2, 2
                .DrawText Cm(i + 1), 59, nY + 1, 131, 4, nFsizeS
                If n < nRow - 1 Then .DLine 58, nY + 9, 190, nY + 9
                i = i + 2
                nY = nY + 17
            Next
            nY = pY2
            .TextOut "以上のとおり、現地調査を実施しましたので報告いたします。", 20, nY, nFsize
            .TextOut "報告年月日　平成　　年　　月　　日", 26, nY + 9, nFsize
            .TextOut "現地調査報告委員名", 105, nY + 18, nFsize
            
            nY = pY1
            .LineBox 18, nY, 190, nY + 17, , nRow, 40
            .DBox 18, nY, 190, nY + 17 * nRow, vbBlack, 4
        End With
    End Sub
    
    Private Sub 内容C(pSt As String, pY1 As Single, pY2 As Single, nRow As Long, nFsize As Integer, s法令 As Long)
        Dim nY As Single
        Dim n As Long
        Dim i As Long
        Dim Cm As Variant
        Dim Ay As Variant
        Dim YY(11) As Variant
        
        If Len(pSt) = 0 Then Exit Sub
        Ay = GetArray(16, 16, 14, 12, 12, 12, 10, 14, 21, 12, 17)
        Cm = Split(pSt, vbBack)
        
        YY(0) = 0
        For n = 0 To 10
            YY(n + 1) = YY(n) + Ay(n)
        Next
        
        With mvarParent
            .TextOut "調査内容", 19, pY1 - 4, nFsize, 0, 2
            nY = pY1
            For n = 0 To 10
                mvarParent.DrawText vSt(n * 2), 18, nY + YY(n) + 1, 40, 4, 10
                If n = 0 And s法令 = 4 Then
                    mvarParent.DrawText "申請地は(　　　　　　　　　)に位置し、現況は(　　　)である。農地区分は(　　種)農地の(　　　　　　　　)に該当すると思われる。", 59, nY + YY(n) + 1, 132, 5, 12
                Else
                    mvarParent.DrawText vSt(n * 2 + 1), 59, nY + YY(n) + 1, 132, 5, 12
                End If
                mvarParent.DLine 18, nY + YY(n), 190, nY + YY(n)
            Next
            
            .DBox 18, nY, 190, nY + YY(n), vbBlack, 4
            .DLine 58, nY, 58, nY + YY(n)
        
            .TextOut "以上のとおり、現地調査を実施しましたので報告いたします。", 18, nY + YY(n) + 4, 11
            .TextOut "報 告 年 月 日  平 成   年   月   日", 18, nY + YY(n) + 12, 11
            .TextOut "現地調査報告委員名", 100, nY + YY(n) + 20, 11
        
        End With
    End Sub

    Private Sub SetData(sKey As String, nPage As Long)
        Dim Ar As Variant
        Dim sData As String
        
        mvarData = ""
        If Len(sKey) = 0 Then Exit Sub
        sData = mvarParent.Nodes(sKey).Tag
        If Len(sData) = 0 Then Exit Sub
        Ar = Split(sData, vbTab)
        mvarData = Ar(nPage - 1)
    End Sub

    Private Function Ck面積(pData As Double) As Double
        If pData < 10 Then
            Ck面積 = pData
        Else
            Ck面積 = Fix(pData)
        End If
    End Function
    
    Private Function Set面積(pData As Double) As String
        If pData - Fix(pData) = 0 Then
            Set面積 = Format(pData, "#,##0")
        Else
            Set面積 = Format(pData, "#,##0.00")
        End If
    End Function


End Class










Class CPrint耕作証明多筆型
    Option Explicit
    Implements CPrintCls
    Private mvarParent As ADBasicLIB2.CPrintFormSK
    Private mvarParams As ADBasicLIB2.CDataCollectSK
    Private mvarKey As String
    Private sKey As String
    Private sData As Variant
    Private dX(8) As Single
    Private SX As Single                                'データ始点(X)
    Private SY As Single                                'データ始点(Y)
    Private EY As Single                                'データ終点(Y)
    Private hX(8) As Single
    Private n As Long
    Private i As Long, j As Long
    Private nPit As Single, HH As Single, Ay As Variant 'DX1個目
    Private FF As Single                                '表の合計の高さ
    Private Ay2 As Variant, dS(12) As Single            '合計用
    Private Ar As Variant, Cm As Variant
    Private Cx As Variant
    Private Cy As Variant
    Private x As Long, y As Long
    Private nX As String
    
    Private Rows As Long
    Private s発効日 As String
    Private s使用目的 As String
    Private s提出先 As String
    Private n支所 As Long
    
    Private Type PrnData
        ID As Long
        世帯ID As Long
        
        申請者名 As String
        住所 As String
        
        n自筆(1 To 5) As Long
        n小筆(1 To 5) As Long
        n自作(1 To 5) As Single
        n小作(1 To 5) As Single
        
        n田合計 As Single
        n畑合計 As Single
        n樹園地 As Single
        n採草地 As Single
        
        市町村 As String
        都道府県名 As String
        会長名 As String
        会長肩書 As String
    End Type
    
    Private mvarData As PrnData
    Public Property Let Key(RHS As String): sKey = RHS: End Property
    Private Sub Class_Terminate(): Set mvarParams = Nothing: End Sub

    Private Property Get CPrintCls_CanCancelPrint() As Boolean: End Property
    Private Property Get CPrintCls_CanPrintNowPage() As Boolean: CPrintCls_CanPrintNowPage = True: End Property

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean
        Dim Cm As Variant
        
        With mvarData
            .市町村 = SystemDB.DBProperty("市町村名")
            .都道府県名 = SystemDB.DBProperty("都道府県名")
            .会長名 = SystemDB.DBProperty("会長名")
            .会長肩書 = IIf(Val(SystemDB.DBProperty("会長代理")), "農業委員会会長代理", "農業委員会会長")
        End With
        
        Set mvarParams = ADApp.Common.GetDataCollect()
        
        If 耕作証明Init(sParam, mvarParent.Page) Then
        ElseIf MsgBox("対象となる農地が見つかりませんでした" & vbCrLf & "印刷しますか", vbYesNo) = vbYes Then
        Else
            CPrintCls_DataInit = True
            Exit Function
        End If
    
    End Function
    
    Private Function 耕作証明Init(ByVal sParam As String, nPage As Long) As Long
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim sSQL As String
        
        Dim RpA As ADBasicLIB2.RecordsetEx
        Dim Ar As Variant
        Dim i As Long
        Dim n自作(5) As Long
        Dim n小作(5) As Long
        Dim nSK As Variant
        Dim RC As Long
        Dim cnt As Long
        
        mvarParams.FieldList = "証明書発効日;証明書発効番号;使用目的;提出先;田;畑;樹園;田合計;畑合計;所有者"
        Ar = Split(sParam, ";")
        mvarKey = Ar(0)
        mvarParent.表示倍率 = 1
        mvarParent.表示倍率 = 0.75
        
        With mvarData
        
        Select Case Fnc.GetKeyHead(Ar(0))
            Case "農家":
                .世帯ID = Fnc.GetKeyCode(Ar(0))
                Set Rs = SystemDB.GetRecordsetEx("SELECT [D:世帯Info].世帯主ID,[D:個人Info].* FROM [D:世帯Info] LEFT JOIN [D:個人Info] ON [D:世帯Info].世帯主ID = [D:個人Info].ID WHERE [D:世帯Info].[ID]=" & .世帯ID, 0, , "耕作証明")
                If Not Rs.EOF Then
                    If UBound(Ar) = 3 Then
                        .ID = Fnc.GetKeyCode(Ar(3))
                    Else
                        .ID = Rs.Value("世帯主ID")
                    End If
                    
                    .申請者名 = Rs.Value("氏名")
                    .住所 = LongAddr(Rs.NullCast("住所", ""))
                    
                    mvarParams.ListData(0, "証明書発効番号") = Ar(2)
                    mvarParams.ListData(0, "証明書発効日") = CDate(Ar(1))
                    sData = Rs.Join(";", GetArray("氏名", "住所")) & vbCrLf
                    
'                    sSQL = "SELECT V_農地.自小作別, V_農地.土地所在, V_農地.田面積, V_農地.畑面積, V_農地.樹園地, [D:個人Info].氏名 AS 所有者 FROM V_農地 INNER JOIN [D:個人Info] ON V_農地.耕作者ID = [D:個人Info].ID WHERE [V_農地].[農地状況]<20 AND [V_農地].[耕作世帯ID] = " & .世帯ID & " ORDER BY V_農地.土地所在;"
                    sSQL = "SELECT V_農地.土地所在, V_農地.田面積, V_農地.畑面積, V_農地.樹園地,V_農地.採草放牧面積, [D:個人Info].氏名 AS 所有者,[D:個人Info_1].氏名 AS 耕作者, V_農地.自小作別, V_農地.小作形態, V_農地.小作開始年月日, V_農地.小作終了年月日, V_農地.小作料 ,V_農地.小作料単位 FROM (V_農地 INNER JOIN [D:個人Info] ON V_農地.所有者ID = [D:個人Info].ID) INNER JOIN [D:個人Info] AS [D:個人Info_1] ON V_農地.耕作者ID = [D:個人Info_1].ID WHERE (((V_農地.農地状況) < 20) And ((V_農地.耕作世帯ID) = " & .世帯ID & ")) ORDER BY V_農地.土地所在;"
                End If
                SystemDB.CloseRs Rs
            Case "世帯員":
                .ID = Fnc.GetKeyCode(Ar(0))
                Set Rs = SystemDB.GetRecordsetEx("SELECT * FROM [D:個人Info] WHERE [ID]=" & .ID, 0, , "耕作証明")
                If Not Rs.EOF Then
                    
                    .世帯ID = Rs.Value("世帯ID")
                    .申請者名 = Rs.Value("氏名")
                    .住所 = Fnc.GetShortAddress(Rs.Value("住所"), .都道府県名)
                    
                    mvarParams.ListData(0, "証明書発効番号") = Ar(2)
                    mvarParams.ListData(0, "証明書発効日") = CDate(Ar(1))
                    sData = Rs.Join(";", GetArray("氏名", "住所")) & vbCrLf

'                    sSQL = "SELECT 自小作別,V_農地.土地所在, V_農地.田面積, V_農地.畑面積, V_農地.樹園地, [D:個人Info].氏名 AS 所有者 FROM V_農地 INNER JOIN [D:個人Info] ON V_農地.耕作者ID = [D:個人Info].ID WHERE [V_農地].[農地状況]<20 AND [V_農地].[耕作者ID] = " & .ID & " ORDER BY V_農地.土地所在;"
                    sSQL = "SELECT V_農地.自小作別, V_農地.土地所在, V_農地.田面積, V_農地.畑面積, V_農地.樹園地, [D:個人Info].氏名 AS 所有者, V_農地.自小作別, V_農地.小作形態, V_農地.小作開始年月日, V_農地.小作終了年月日, V_農地.小作料 FROM (V_農地 INNER JOIN [D:個人Info] ON V_農地.所有者ID = [D:個人Info].ID) INNER JOIN [D:個人Info] AS [D:個人Info_1] ON V_農地.耕作者ID = [D:個人Info_1].ID WHERE [V_農地].[農地状況]<20 AND [V_農地].[耕作者ID] = " & .ID & " ORDER BY V_農地.土地所在;"
                End If
                SystemDB.CloseRs Rs
            End Select
        
    '/****************************************************************/
        Set Rs = SystemDB.GetRecordsetEx(sSQL, 0, , "耕作証明")
        Do Until Rs.EOF
            cnt = cnt + 1
            If Rs.NullCast("田面積", 0) > 0 Then
                sData = sData & Rs.Value("土地所在")
                sData = sData & ";田;" & Rs.FormatNumberEx("田面積", 0) & ";" & Rs.Value("所有者") & ";" & Rs.Value("耕作者") & ";" & Rs.NullCast("自小作別", 0) & ";" & Rs.NullCast("小作形態", 0) & ";" & Rs.NullCast("小作開始年月日", "") & ";" & Rs.NullCast("小作終了年月日", "") & ";" & Rs.NullCast("小作料", 0) & ";" & Rs.NullCast("小作料単位", "") & vbCr
                .n田合計 = .n田合計 + Rs.NullCast("田面積", 0)
                If Rs.Value("自小作別") = 0 Then
                    .n自筆(1) = .n自筆(1) + 1
                    .n自作(1) = .n自作(1) + Rs.NullCast("田面積", 0)
                    n自作(0) = n自作(0) + 1
                    n自作(1) = n自作(1) + Rs.NullCast("田面積", 0)
                Else
                    .n小筆(1) = .n小筆(1) + 1
                    .n小作(1) = .n小作(1) + Rs.NullCast("田面積", 0)
                    n小作(0) = n小作(0) + 1
                    n小作(1) = n小作(1) + IIf(Rs.IsNull("田面積") Or 0, 0, Rs.Value("田面積"))
                End If
            ElseIf Rs.NullCast("畑面積", 0) > 0 Then
                sData = sData & Rs.Value("土地所在")
                sData = sData & ";畑;" & Rs.FormatNumberEx("畑面積", 0) & ";" & Rs.Value("所有者") & ";" & Rs.Value("耕作者") & ";" & Rs.NullCast("自小作別", 0) & ";" & Rs.NullCast("小作形態", 0) & ";" & Rs.NullCast("小作開始年月日", "") & ";" & Rs.NullCast("小作終了年月日", "") & ";" & Rs.NullCast("小作料", 0) & ";" & Rs.NullCast("小作料単位", "") & vbCr
                .n畑合計 = .n畑合計 + Rs.NullCast("畑面積", 0)
                If Rs.Value("自小作別") = 0 Then
                    .n自筆(2) = .n自筆(2) + 1
                    .n自作(2) = .n自作(2) + Rs.NullCast("畑面積", 0)
                    n自作(2) = n自作(2) + 1
                    n自作(3) = n自作(3) + Rs.NullCast("畑面積", 0)
                Else
                    .n小筆(2) = .n小筆(2) + 1
                    .n小作(2) = .n小作(2) + Rs.NullCast("畑面積", 0)
                    n小作(2) = n小作(2) + 1
                    n小作(3) = n小作(3) + Rs.NullCast("畑面積", 0)
                End If
            ElseIf Rs.NullCast("樹園地", 0) > 0 Then
                sData = sData & Rs.Value("土地所在")
                sData = sData & ";樹園地;" & Rs.FormatNumberEx("樹園地", 0) & ";" & Rs.Value("所有者") & ";" & Rs.Value("耕作者") & ";" & Rs.NullCast("自小作別", 0) & ";" & Rs.NullCast("小作形態", 0) & ";" & Rs.NullCast("小作開始年月日", "") & ";" & Rs.NullCast("小作終了年月日", "") & ";" & Rs.NullCast("小作料", 0) & ";" & Rs.NullCast("小作料単位", "") & vbCr
                .n樹園地 = .n樹園地 + Rs.NullCast("樹園地", 0)
                If Rs.Value("自小作別") = 0 Then
                    .n自筆(3) = .n自筆(3) + 1
                    .n自作(3) = .n自作(3) + Rs.NullCast("樹園地", 0)
                Else
                    .n小筆(3) = .n小筆(3) + 1
                    .n小作(3) = .n小作(3) + Rs.NullCast("樹園地", 0)
                End If
            ElseIf Rs.NullCast("採草放牧面積", 0) > 0 Then
                sData = sData & Rs.Value("土地所在")
                sData = sData & ";採草放牧;" & Rs.FormatNumberEx("採草放牧面積", 0) & ";" & Rs.Value("所有者") & ";" & Rs.Value("耕作者") & ";" & Rs.NullCast("自小作別", 0) & ";" & Rs.NullCast("小作形態", 0) & ";" & Rs.NullCast("小作開始年月日", "") & ";" & Rs.NullCast("小作終了年月日", "") & ";" & Rs.NullCast("小作料", 0) & ";" & Rs.NullCast("小作料単位", "") & vbCr
                .n採草地 = .n採草地 + Rs.NullCast("採草放牧面積", 0)
                If Rs.Value("自小作別") = 0 Then
                    .n自筆(4) = .n自筆(4) + 1
                    .n自作(4) = .n自作(4) + Rs.NullCast("採草放牧面積", 0)
                Else
                    .n小筆(4) = .n小筆(4) + 1
                    .n小作(4) = .n小作(4) + Rs.NullCast("採草放牧面積", 0)
                End If
            Else
                cnt = cnt - 1
            End If
            Rs.MoveNext
        Loop
        SystemDB.CloseRs Rs
        
        For i = 0 To 5
            nSK = nSK & ";" & n自作(i) & ";" & n小作(i)
        Next
        For i = 1 To 4
            .n自筆(5) = .n自筆(5) + .n自筆(i)
            .n自作(5) = .n自作(5) + .n自作(i)
            .n小筆(5) = .n小筆(5) + .n小筆(i)
            .n小作(5) = .n小作(5) + .n小作(i)
        Next
        
        sData = sData & vbCrLf & .n田合計 & ";" & .n畑合計 & ";" & cnt & nSK
    '/****************************************************************/
        End With
        
        SX = 15
        Select Case Fnc.GetKeyHead(sKey)
            Case Else:
                Rows = 5
                Ay = GetArray(67, 20, 20, 6, 50, 40, 10, 42)
                Ay2 = GetArray(30, 25, 15, 25, 15, 25, 15, 25, 15, 25, 15, 25)
                
                If cnt <= 5 Then
                    mvarParent.MaxPage = 1
                Else
                    Rows = 12
                    mvarParent.MaxPage = Fix(cnt / Rows) - ((cnt / Rows) > Fix(cnt / Rows)) + 1
                End If
                
                HH = 20     'ヘッダーの高さ
                nPit = 12    '表の中の繰り返しの巾
        End Select
        
        dX(0) = SX
        n = dX(0)
        For i = 0 To UBound(Ay)
            dX(i + 1) = dX(i) + Ay(i)
            If i <= UBound(Ay) Then hX(i) = dX(i) + Ay(i) / 2
        Next

        dS(0) = SX
        For i = 0 To UBound(Ay2)
            dS(i + 1) = dS(i) + Ay2(i)
        Next
        
        s発効日 = StrConv(Format(CDate(mvarParams.ListData(0, "証明書発効日")), "GGGEE年 M月 D日"), vbNarrow)
        s使用目的 = mvarParams.ListData(0, "使用目的")
        s提出先 = mvarParams.ListData(0, "提出先")
        
        耕作証明Init = cnt
    End Function
    
    Private Property Set CPrintCls_DB(RHS As Object)
    End Property
    
    Private Property Let CPrintCls_Key(ByVal RHS As String): mvarKey = RHS: End Property
    Private Property Get CPrintCls_Key() As String: CPrintCls_Key = mvarKey: End Property
    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants
        CPrintCls_Orientation = vbPRORLandscape
    End Property
    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&)
        耕作証明Print nNewPage
    End Sub
    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Set CPrintCls_Parent(RHS As CPrintFormSK): Set mvarParent = RHS: End Property
    
    Private Sub 耕作証明Print(nPage As Long)
        耕作証明Print2 nPage
    End Sub
    
    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        mvarParent.PrintPage = 1
        mvarParent.PrintMaxPage = mvarParent.MaxPage
        
        If bNowPage Then
            耕作証明Print mvarParent.Page
            mvarParent.EndDoc
        Else
            Do Until mvarParent.PrintPage > mvarParent.PrintMaxPage
                耕作証明Print mvarParent.PrintPage
                mvarParent.NewPage
            Loop
            mvarParent.EndDoc
        End If
    End Sub
    
    Private Sub CPrintCls_Repaint()
        If Not mvarParams Is Nothing Then
            Select Case Fnc.GetKeyHead(mvarKey)
                Case "農家": 耕作証明Print mvarParent.Page
                Case "世帯員": 耕作証明Print mvarParent.Page
           End Select
        End If
    End Sub
    
    Private Sub 耕作証明Print1(nPage As Long)

        If nPage = 0 Then Exit Sub

        SY = 67
        FF = 30     'フッターの高さ

        With mvarParent
    '-----------------------------------
            .ClearScreen
            .Offset 3, 6
    '-----------------------------------
            Ar = Split(sData, vbCrLf)
            Cm = Split(Ar(1), vbCr)
            Cx = Split(Ar(2), ";")

            If nPage > 1 Then
                SY = 20
                Rows = 30    '何セル分
            Else
                Rows = 15    '何セル分
            End If
    '-----------------------------------
            EY = SY + HH + (Rows * nPit)    '上表の一番下の線までの高さ
            nX = (Ay2(1) + Ay2(2))
    '-----------------------------------
            If nPage = 1 Then
                If mvarData.市町村 = "姶良市" Then
                    .TextOut "様式第２号", SX + 5, 10, 11, 0, 2
                    .TextOut "耕　作　証　明　願", ((SX + .PaperWidth) / 2), 18, 20, 2, 2
                    .DrawText "　" & s発効日 & "現在における農地基本台帳に登載された耕作面積は、下記のとおりで\nあることを証明してください。", SX - 5, 26, 178, 5, 11, 0
                Else
                    .TextOut "様式第４号", SX + 5, 10, 11, 0, 2
                    .TextOut "耕　作　証　明　願", ((SX + .PaperWidth) / 2), 18, 20, 2, 2
                    .DrawText "　" & s発効日 & "現在における農家台帳に記載された耕作面積は、下記のとおりであることを\n証明してください。", SX - 5, 26, 178, 5, 11, 0
                End If
                .TextOut s発効日, SX + 5, 38, 11, 0, 0

                .TextOut "申請人　住 所", SX + 80, 39, 11
                .DrawText mvarData.住所, SX + 110, 39, 70, 4, 11

                .TextOut "氏 名", SX + 96, 50, 11, 0
                .DrawText mvarData.申請者名, SX + 110, 50, 50, 4, 11
                .TextOut "印", SX + 165, 50, 11, 0
                .TextOut mvarData.市町村 & " 農業委員会会長　殿", SX - 5, 56, 11, 0, 0

                .TextOut "記", ((SX + .PaperWidth) / 2), 63, 11, 2, 2

                Select Case mvarData.市町村
                    Case "日置市"
                        Select Case ADApp.User.v支所符号
                            Case "本": .TextOut "日農委第　　　　　号", SX + 135, EY + FF + 5, 11, 0, 0
                            Case "東": .TextOut "日東農委第　　　　号", SX + 135, EY + FF + 5, 11, 0, 0
                            Case "日": .TextOut "日日農委第　　　　号", SX + 135, EY + FF + 5, 11, 0, 0
                            Case "吹": .TextOut "日吹農委第　　　　号", SX + 135, EY + FF + 5, 11, 0, 0
                            Case Else: .TextOut "農委第　　　　　　号", SX + 135, EY + FF + 5, 11, 0, 0
                        End Select
                        .TextOut mvarParams.ListData(0, "証明書発効番号"), SX + 162, EY + FF + 5, 11, 2, 0
                    Case "姶良市"
                        n支所 = SysAD.GetSettingData("農地基本台帳", "支所番号", 1)
                        .TextOut "霧農委" & SystemDB.GetDirectDataWithClass("M_BASICALL", "名称", "支所番号", n支所) & "第　　　　　号", SX + 131, EY + FF + 5, 11
                        .TextOut mvarParams.ListData(0, "証明書発効番号"), SX + 162, EY + FF + 5, 11, 2, 0
                    Case Else
                    .TextOut "農委第　　　　　号", SX + 135, EY + FF + 5, 11, 0, 0
                    .TextOut mvarParams.ListData(0, "証明書発効番号"), SX + 157, EY + FF + 5, 11, 2, 0
                End Select

                .TextOut "上記のとおり相違ないことを証明する。", SX - 5, EY + FF + 10, 11, 0, 0

                .TextOut s発効日, SX + 10, EY + FF + 16, 11, 0, 0
                If mvarData.市町村 = "姶良市" Then
                    .TextOut mvarData.市町村 & mvarData.会長肩書, SX + 78, EY + FF + 22, 11, 0, 0
                Else
                    .TextOut mvarData.会長肩書, SX + 90, EY + FF + 22, 11, 0, 0
                End If

                .TextOut mvarData.会長名 & "　 印", SX + 132, EY + FF + 22, 11

                .DotLine SX - 5, EY + FF + 28, dX(5) + 5, EY + FF + 28, vbBlack, vbDot

                .TextOut "１、この証明書の使用目的　（　　　　　　　　　　　　　　　　　　　　　　　　　　　）", 20, EY + FF + 32, 11, 0, 0
                .TextOut s使用目的, 76, , 11, 0, 0
                .TextOut "２、提出先　　　　　　　　（　　　　　　　　　　　　　　　　　　　　　　　　　　　）", 20, EY + FF + 38, 11, 0, 0
                .TextOut s提出先, 76, , 11, 0, 0

                .TextBox "合　計", dS(0), EY + 3, dS(1), EY + FF + 3, 12, 2, 2
                .DrawText "田", dS(2), EY + 4, nX, 4, 12, 2
                .DrawText "畑", dS(2) + nX, EY + 4, nX, 4, 12, 2
                .DrawText "計", dS(2) + nX * 2, EY + 4, nX, 4, 12, 2

                .TextOut "自 作 地", dS(1) + (Ay2(1) / 2), EY + (FF / 5) * 2 + 4, 12, 2, 0
                .TextOut "小 作 地", dS(1) + (Ay2(1) / 2), EY + (FF / 5) * 3 + 4, 12, 2, 0
                .TextOut "合    計", dS(1) + (Ay2(1) / 2), EY + (FF / 5) * 4 + 4, 12, 2, 0

                For i = 0 To 2
                    x = i * nX
                    j = i * 4
                    .DrawText "筆 数", dS(2) + x, EY + (FF / 5) + 4, Ay2(2), 6, 12, 2
                    .DrawText "面 積(u)", dS(2) + Ay2(2) + x, EY + (FF / 5) + 4, Ay2(1), 6, 12, 2
                    If i = 2 Then Exit For
                    .DrawText FormatNumber(Cx(i), 0), dS(3) + x + 0.5, EY + (FF / 5) * 5 - 1.5, Ay2(1) - 1, 4, 11, 1                    '田合計
                    .DrawText Cx(j + 3) & " 筆", dS(2) + x + 0.5, EY + (FF / 5) * 3 - 1.5, Ay2(2) - 1, 4, 11, 1                         '自作田(筆数)
                    .DrawText Cx(j + 4) & " 筆", dS(2) + x + 0.5, EY + (FF / 5) * 4 - 1.5, Ay2(2) - 1, 4, 11, 1                         '小作田(筆数)
                    .DrawText FormatNumber(Cx(j + 5), 0), dS(3) + x + 0.5, EY + (FF / 5) * 3 - 1.5, Ay2(1) - 1, 4, 11, 1                '自作田(面積計)
                    .DrawText FormatNumber(Cx(j + 6), 0), dS(3) + x + 0.5, EY + (FF / 5) * 4 - 1.5, Ay2(1) - 1, 4, 11, 1                '小作田(面積計)
                    .DrawText Val(Cx(j + 3)) + Val(Cx(j + 4)) & " 筆", dS(2) + x + 0.5, EY + (FF / 5) * 5 - 1.5, Ay2(2) - 1, 4, 11, 1   '田合計(筆)
                Next

                .DrawText Cx(i) & " 筆", dS(2) + x + 0.5, EY + (FF / 5) * 5 - 1.5, Ay2(2) - 1, 4, 11, 1                                 '合計(筆数)
                .DrawText Val(Cx(3)) + Val(Cx(7)) & " 筆", dS(2) + x + 0.5, EY + (FF / 5) * 3 - 1.5, Ay2(2) - 1, 4, 11, 1               '自作(筆数)
                .DrawText Val(Cx(4)) + Val(Cx(8)) & " 筆", dS(2) + x + 0.5, EY + (FF / 5) * 4 - 1.5, Ay2(2) - 1, 4, 11, 1               '小作(筆数)
                .DrawText FormatNumber(Val(Cx(5)) + Val(Cx(9)), 0), dS(3) + x + 0.5, EY + (FF / 5) * 3 - 1.5, Ay2(1) - 1, 4, 11, 1      '自作(面積計)
                .DrawText FormatNumber(Val(Cx(6)) + Val(Cx(10)), 0), dS(3) + x + 0.5, EY + (FF / 5) * 4 - 1.5, Ay2(1) - 1, 4, 11, 1     '小作(面積計)
                .DrawText FormatNumber(Val(Cx(0)) + Val(Cx(1)), 0), dS(3) + x + 0.5, EY + (FF / 5) * 5 - 1.5, Ay2(1) - 1, 4, 11, 1      '合計(筆)

                Select Case Fix((Cx(2) - 1) / 15) Mod 2
                    Case 0
                        .DLine dX(1), SY, dX(1), EY     '土地の所在&現況地目の間の縦線
                        .DLine dX(2), SY, dX(2), EY     '現況地目&耕作面積の間の縦線
                        .DLine dX(3), SY, dX(3), EY     '耕作面積&所有者の間の縦線
                        .DLine dX(4), SY, dX(4), EY     '耕作面積&所有者の間の縦線

                        For n = 1 To Rows
                            If n > Cx(2) Then Exit For
                            Cy = Split(Cm(n - 1), ";")
                            y = n * nPit + 5

                            .DrawText Cy(0), dX(0) + 0.5, SY + y, Ay(0), 4, 12, 0   '土地の所在
                            .DrawText Cy(1), dX(1), SY + y, Ay(1), 4, 12, 2         '現況地目
                            .DrawText Cy(2), dX(2) - 0.5, SY + y, Ay(2), 4, 12, 1   '耕作面積

                            j = Len(Cy(3))
                            If j > 26 Then
                                .DrawText Cy(3), dX(3) + 0.5, SY + y + 3, Ay(3), 3, 8, 0, 2 '所有者
                            ElseIf j > 20 Then
                                .DrawText Cy(3), dX(3) + 2, SY + y + 3, Ay(3) - 2, 3.5, 9, 0, 2 '所有者
                            ElseIf j > 10 Then
                                .DrawText Cy(3), dX(3) + 2.5, SY + y - 2.5, Ay(3) - 2, 4, 11 '所有者
                            Else
                                .DrawText Cy(3), dX(3) + 2.5, SY + y, Ay(3), 4, 12, 0 '所有者
                            End If
                        Next
                        .LineX SX, dX(5), SY + HH + nPit, Rows, nPit                '1件毎の横線
                    Case Else
                        .DLine dX(1), SY, dX(1), SY + HH                            '土地の所在&現況地目の間の縦線
                        .DLine dX(2), SY, dX(2), SY + HH                            '現況地目&耕作面積の間の縦線
                        .DLine dX(3), SY, dX(3), SY + HH                            '耕作面積&所有者の間の縦線
                        .DLine dX(4), SY, dX(4), SY + HH                            '所有者&備考の間の縦線
                        .ForeColor = RGB(200, 200, 200)
                        .TextBox "別 紙 記 載", dX(0), SY, dX(5), EY, 40, 2, 2
                        .ForeColor = vbBlack
                End Select

                .DBox dX(0), EY + 3, dX(5), EY + FF + 3
                .DLine dS(1), EY + 3, dS(1), EY + FF + 3                            '合計の右の縦線

                For i = 0 To 2
                    x = i * 40
                    .DLine dS(2) + x, EY + 3, dS(2) + x, EY + FF + 3                '下表の縦線
                    .DLine dS(3) + x, EY + 9, dS(3) + x, EY + FF + 3                '下表の横線
                Next

                .DLine dS(2), EY + 9, dS(2) + 120, EY + 9
                .LineX dS(1), dS(2) + nX * 3, EY + 15, 3, 6
            Else
                .LineX SX, dX(5), SY + HH + nPit, Rows, nPit                        '1件毎の横線
                .DLine dX(1), SY, dX(1), EY                                         '土地の所在&現況地目の間の縦線
                .DLine dX(2), SY, dX(2), EY                                         '現況地目&耕作面積の間の縦線
                .DLine dX(3), SY, dX(3), EY                                         '耕作面積&所有者の間の縦線
                .DLine dX(4), SY, dX(4), EY                                         '耕作面積&所有者の間の縦線

                Select Case Fix((Cx(2) - 1) / 15) Mod 2
                    Case 0: i = 15: Rows = Rows + 15
                    Case Else: i = 0
                End Select

                For n = i + 1 To Rows
                    If n + (nPage - 2) * 30 - 1 = Val(Cx(2)) Then Exit For
                    If Cx(2) < Rows Then
                        If ((nPage - 1) * 30 + n - Rows) > Cx(2) Then Exit For
                        Cy = Split(Cm(n - 1), ";")
                        y = (n - i) * nPit + 4
                    Else
                        If ((nPage - 1) * 30 + n - Rows) > Cx(2) Then Exit For
                        Cy = Split(Cm(n + (nPage - 2) * 30 - 1), ";")
                        y = (n - i) * nPit + 4
                    End If

                    .TextOut Cy(0), dX(0) + 0.5, SY + y, 12, 0                      '土地の所在
                    .DrawText Cy(1), dX(1), SY + y, Ay(1), 4, 12, 2                 '現況地目
                    .DrawText Cy(2), dX(2) - 0.5, SY + y, Ay(2), 4, 12, 1           '耕作面積
'                    .DrawText Cy(3), dX(3) + 2.5, SY + Y, Ay(3), 4, 12, 0           '所有者
                    j = Len(Cy(3))
                    If j > 26 Then
                        .DrawText Cy(3), dX(3) + 0.5, SY + y + 4, Ay(3), 3, 8, 0, 2
                    ElseIf j > 20 Then
                        .DrawText Cy(3), dX(3) + 2, SY + y + 4, Ay(3) - 2, 3.5, 9, 0, 2
                    ElseIf j > 10 Then
                        .DrawText Cy(3), dX(3) + 2.5, SY + y - 1.9, Ay(3) - 2.5, 4, 11
                    Else
                        .DrawText Cy(3), dX(3) + 1.8, SY + y, Ay(3), 4, 12, 0
                    End If
                Next
            End If

            If .MaxPage <> 1 Then
                .TextOut "Page " & nPage & "/" & .MaxPage, 170, 8, 12, 0, 2
            End If

            .LineBox SX, SY, dX(5), EY, , , , HH                                    '表外枠とヘッダー
            .TextOut "土地の所在", SX + (Ay(0) / 2), SY + (HH / 2), 12, 2, 2
            .TextOut "現況地目", dX(1) + (Ay(1) / 2), SY + (HH / 2), 12, 2, 2
            .DrawText "耕作面積\n(u)", dX(2), SY + 0.5, Ay(2), 5, 12, 2
            .TextOut "耕作者", dX(3) + (Ay(3) / 2), SY + (HH / 2), 12, 2, 2
            .TextOut "備　考", dX(4) + (Ay(4) / 2), SY + (HH / 2), 12, 2, 2

        End With
    End Sub
    Private Sub 耕作証明Print2(nPage As Long)

        If nPage = 0 Then Exit Sub

        SY = 52
        FF = 30     'フッターの高さ

        With mvarParent
    '-----------------------------------
            .ClearScreen
            .Offset 3, 0
    '-----------------------------------
            Ar = Split(sData, vbCrLf)
            Cm = Split(Ar(1), vbCr)
            Cx = Split(Ar(2), ";")

            If nPage > 1 Then
                SY = 20
                Rows = 10   '何セル分
            Else
                Rows = 5    '何セル分
            End If
    '-----------------------------------
            EY = SY + HH + (Rows * nPit)    '上表の一番下の線までの高さ
            nX = (Ay2(1) + Ay2(2))
    '-----------------------------------
            If nPage = 1 Then
                .TextOut "様式第４号", SX + 5, 8, 11, 0, 2
                .TextOut "耕　作　証　明　願", ((SX + .PaperWidth) / 2), 16, 20, 2, 2
                .DrawText "　" & s発効日 & "現在における農地基本台帳に記載された耕作面積は、下記のとおりであることを証明してください。", SX - 5, 24, 250, 5, 11, 0
                
                .TextOut s発効日, SX + 5, 31, 11, 0, 0

                .TextOut "申請人　住 所", SX + 150, 32, 11
                .DrawText mvarData.住所, SX + 180, 32, 80, 4, 11

                .TextOut "氏 名", SX + 166, 41, 11, 0
                .DrawText mvarData.申請者名, SX + 180, 41, 50, 4, 11
                .TextOut "印", SX + 255, 41, 11, 0
                .TextOut mvarData.市町村 & " 農業委員会会長　殿", SX - 5, 47, 11, 0, 0

                .TextOut "記", ((SX + .PaperWidth) / 2), 47, 11, 2, 2

                .TextOut "土地の所在", hX(0), SY + (HH / 2), 12, 2, 2
                .TextOut "現況地目", hX(1), SY + (HH / 2), 12, 2, 2
                .DrawText "耕作面積\n(u)", dX(2), SY + 0.5, Ay(2), 5, 12, 2, 2, HH
                .DrawText "自・小作地", dX(3), SY + 0.5, Ay(3), 5, 10, 2, 0, HH
                .DrawText "所有者氏名\n\n(小作地の場合は住所)", dX(4), SY + 0.5, Ay(4), 5, 12, 2, 2, HH
                .DrawText "借 受 人\n氏    名", dX(5), SY + 0.5, Ay(5), 5, 12, 2, 2, HH
                .TextOut "小作地の状況", (dX(6) + dX(8)) / 2, SY + 3, 12, 2, 2
                .DrawText "形\n態", dX(6), SY + 6, Ay(6), 5, 12, 2, 2, HH - 6
                .DrawText "貸借の内容", dX(7), SY + 6, Ay(7), 5, 12, 2, 2, HH - 6
                
                For i = 0 To 4
                    .DrawText "筆 数", dS(2) + i * 40, EY + (FF / 5) + 4, Ay2(2), 6, 12, 2
                    .DrawText "面 積(u)", dS(2) + Ay2(2) + i * 40, EY + (FF / 5) + 4, Ay2(1), 6, 12, 2
                Next
                
                For i = 1 To 5
                    .DrawText mvarData.n自筆(i) & " 筆", dS(2) + i * 40 - 40 + 0.5, EY + (FF / 5) * 3 - 1.5, Ay2(2) - 1, 4, 11, 1                     '自作田(筆数)
                    .DrawText mvarData.n小筆(i) & " 筆", dS(2) + i * 40 - 40 + 0.5, EY + (FF / 5) * 4 - 1.5, Ay2(2) - 1, 4, 11, 1                       '小作田(筆数)
                    .DrawText FormatNumber(mvarData.n自作(i), 0), dS(3) + i * 40 - 40 + 0.5, EY + (FF / 5) * 3 - 1.5, Ay2(1) - 1, 4, 11, 1              '自作田(面積計)
                    .DrawText FormatNumber(mvarData.n小作(i), 0), dS(3) + i * 40 - 40 + 0.5, EY + (FF / 5) * 4 - 1.5, Ay2(1) - 1, 4, 11, 1              '小作田(面積計)
                    .DrawText (mvarData.n自筆(i) + mvarData.n小筆(i)) & " 筆", dS(2) + i * 40 - 40 + 0.5, EY + (FF / 5) * 5 - 1.5, Ay2(2) - 1, 4, 11, 1                     '自作田(筆数)
                    .DrawText FormatNumber(mvarData.n自作(i) + mvarData.n小作(i), 0), dS(3) - 40 + i * 40 + 0.5, EY + (FF / 5) * 5 - 1.5, Ay2(1) - 1, 4, 11, 1          '自作田(面積計)
                Next

                If Val(Cx(2)) <= 5 Then
                        .DLine dX(0), SY, dX(8), SY
                        .DLine dX(0), EY, dX(8), EY
                        For n = 0 To UBound(Ay) + 1
                            If n <> 7 Then
                                .DLine dX(n), SY, dX(n), EY
                            Else
                                .DLine dX(n), SY + 6, dX(n), EY
                            End If
                        Next
                        .DLine dX(6), SY + 6, dX(8), SY + 6
                        .LineX dX(0), dX(7), SY + HH, Rows, nPit            '表横線
                        .LineX dX(7), dX(8), SY + HH, Rows * 3, nPit / 3    '小作地の状況
                        For n = 1 To Rows
                            If n > Cx(2) Then Exit For
                            Cy = Split(Cm(n - 1), ";")
                            y = (n - 1) * nPit + HH

                            .DrawText Cy(0), dX(0) + 1, SY + y, Ay(0), 4, 12, 0, 2, nPit    '土地の所在
                            .DrawText Cy(1), dX(1), SY + y, Ay(1), 4, 12, 2, 2, nPit        '現況地目
                            .DrawText Cy(2), dX(2) - 0.5, SY + y, Ay(2), 4, 12, 1, 2, nPit  '耕作面積

                            j = Len(Cy(3))
                            If j > 26 Then
                                .DrawText Cy(3), dX(4) + 1, SY + y + 3, Ay(4), 3, 8, 0, 2, nPit             '所有者
                            ElseIf j > 20 Then
                                .DrawText Cy(3), dX(4) + 2, SY + y + 3, Ay(4) - 2, 3.5, 9, 0, 2, nPit       '所有者
                            ElseIf j > 10 Then
                                .DrawText Cy(3), dX(4) + 2.5, SY + y - 2.5, Ay(4) - 2, 4, 11, 0, 2, nPit    '所有者
                            Else
                                .DrawText Cy(3), dX(4) + 2.5, SY + y, Ay(4), 4, 12, 0, 2, nPit              '所有者
                            End If
                            Select Case Val(Cy(5))
                                Case 0: .DrawText "自", dX(3) + 1, SY + y, Ay(3), 3, 11, 2, 2, nPit
                                Case 1: .DrawText "小", dX(3) + 1, SY + y, Ay(3), 3, 11, 2, 2, nPit
                                Case 2: .DrawText "農", dX(3) + 1, SY + y, Ay(3), 3, 11, 2, 2, nPit
                            End Select
                            If Val(Cy(5)) > 0 Then
                                Select Case Len(Cy(4))
                                    Case Is > 26: .DrawText Cy(4), dX(5) + 1, SY + y, Ay(5), 3, 8, 0, 2, nPit             '所有者
                                    Case Is > 20: .DrawText Cy(4), dX(5) + 2, SY + y, Ay(5) - 2, 3.5, 9, 0, 2, nPit       '所有者
                                    Case Is > 10: .DrawText Cy(4), dX(5) + 2.5, SY + y, Ay(5) - 2.5, 4, 11, 0, 2, nPit
                                    Case Else: .DrawText Cy(4), dX(5) + 1.8, SY + y, Ay(5), 4, 12, 0, 2, nPit        '所有者
                                End Select
                                
                                Select Case Val(Cy(6))
                                    Case 0: .DrawText "-", dX(6) + 1, SY + y, Ay(6), 3, 11, 2, 2, nPit
                                    Case 1: .DrawText "賃", dX(6) + 1, SY + y, Ay(6), 3, 11, 2, 2, nPit
                                    Case 2: .DrawText "使", dX(6) + 1, SY + y, Ay(6), 3, 11, 2, 2, nPit
                                End Select
                                
                                If IsDate(Replace(Cy(7), "0:00:00", "")) Then
                                    .DrawText Format$(CDate(Cy(7)), "GGGEE年MM月DD日"), dX(7) + 1, SY + y, Ay(7), 3, 11, 2, 2, 4
                                End If
                                If IsDate(Replace(Cy(8), "0:00:00", "")) Then
                                    .DrawText Format$(CDate(Cy(8)), "GGGEE年MM月DD日"), dX(7) + 1, SY + y + 4, Ay(7), 3, 11, 2, 2, 4
                                End If
                                If Val(Cy(9)) Then
                                    .DrawText Cy(9) & Cy(10), dX(7) + 1, SY + y + 8, Ay(7), 3, 11, 2, 2, 4
                                End If
                                
                                
                            End If
                        Next
                    Else
                        .DLine dX(0), SY, dX(8), SY
                        .DLine dX(0), EY, dX(8), EY
                        For n = 0 To UBound(Ay) + 1
                            If n = 0 Or n = 8 Then
                                .DLine dX(n), SY, dX(n), EY
                            ElseIf n <> 7 Then
                                .DLine dX(n), SY, dX(n), SY + HH
                            Else
                                .DLine dX(n), SY + 6, dX(n), SY + HH
                            End If
                        Next
                        y = Rows * nPit
                        .DLine dX(6), SY + 6, dX(8), SY + 6
                        .DLine dX(0), SY + HH, dX(8), SY + HH

                        .ForeColor = RGB(200, 200, 200)
                        .TextOut "別 紙 記 載", dX(0) + (dX(8) - dX(0)) / 2, SY + HH + y / 2, 40, 2, 2
                        .ForeColor = vbBlack
                End If

                .DBox dX(0), EY + 3, dS(12), EY + FF + 3
                .DLine dS(1), EY + 3, dS(1), EY + FF + 3                            '合計の右の縦線

                For i = 0 To 4
                    x = i * 40
                    .DLine dS(2) + x, EY + 3, dS(2) + x, EY + FF + 3                '下表の縦線
                    .DLine dS(3) + x, EY + 9, dS(3) + x, EY + FF + 3                '下表の横線
                Next

                .DLine dS(2), EY + 9, dS(12), EY + 9
                .LineX dS(1), dS(12), EY + 15, 3, 6
            
                .TextOut "農委第　　　　　号", SX + 190, EY + FF + 6, 11, 0, 0
                .TextOut mvarParams.ListData(0, "証明書発効番号"), SX + 212, EY + FF + 6, 11, 2, 0
    
                .TextOut "上記のとおり相違ないことを証明する。", SX - 5, EY + FF + 6, 11, 0, 0
    
                .TextOut s発効日, SX + 10, EY + FF + 12, 11, 0, 0
                .TextOut mvarData.市町村 & "  " & mvarData.会長肩書, SX + 160, EY + FF + 18, 11, 0, 0
    
                .TextOut mvarData.会長名 & "　 印", SX + 212, EY + FF + 18, 11
    
                .TextBox "合　計", dS(0), EY + 3, dS(1), EY + FF + 3, 12, 2, 2
                .DrawText "田", dS(2), EY + 4, nX, 4, 12, 2
                .DrawText "畑", dS(2) + nX, EY + 4, nX, 4, 12, 2
                .DrawText "樹園地", dS(2) + nX * 2, EY + 4, nX, 4, 12, 2
                .DrawText "採草放牧地", dS(2) + nX * 3, EY + 4, nX, 4, 12, 2
                .DrawText "計", dS(2) + nX * 4, EY + 4, nX, 4, 12, 2
    
                .TextOut "自 作 地", dS(1) + (Ay2(1) / 2), EY + (FF / 5) * 2 + 4, 12, 2, 0
                .TextOut "小 作 地", dS(1) + (Ay2(1) / 2), EY + (FF / 5) * 3 + 4, 12, 2, 0
                .TextOut "合    計", dS(1) + (Ay2(1) / 2), EY + (FF / 5) * 4 + 4, 12, 2, 0
    
                EY = EY + FF + 24
                .TextOut "１．この証明書の使用目的　（　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　）", dX(0) + 12, EY, 11, 0, 0
                .TextOut "２．提出先　　　　　　　　（　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　）", dX(0) + 12, EY + 6, 11, 0, 0
            
            Else '2ページ以降
                .TextOut "土地の所在", hX(0), SY + (HH / 2), 12, 2, 2
                .TextOut "現況地目", hX(1), SY + (HH / 2), 12, 2, 2
                .DrawText "耕作面積\n(u)", dX(2), SY + 0.5, Ay(2), 5, 12, 2, 2, HH
                .DrawText "自・小作地", dX(3), SY + 0.5, Ay(3), 5, 10, 2, 0, HH
                .DrawText "所有者氏名\n\n(小作地の場合は住所)", dX(4), SY + 0.5, Ay(4), 5, 12, 2, 2, HH
                .DrawText "借 受 人\n氏    名", dX(5), SY + 0.5, Ay(5), 5, 12, 2, 2, HH
                .TextOut "小作地の状況", (dX(6) + dX(8)) / 2, SY + 3, 12, 2, 2
                .DrawText "形\n態", dX(6), SY + 6, Ay(6), 5, 12, 2, 2, HH - 6
                .DrawText "貸借の内容", dX(7), SY + 6, Ay(7), 5, 12, 2, 2, HH - 6
                Rows = 12
        
                EY = SY + HH + Rows * nPit
                .DLine dX(0), SY, dX(8), SY
                .DLine dX(0), EY, dX(8), EY
                For n = 0 To UBound(Ay) + 1
                    If n <> 7 Then
                        .DLine dX(n), SY, dX(n), EY
                    Else
                        .DLine dX(n), SY + 6, dX(n), EY
                    End If
                Next
                .DLine dX(6), SY + 6, dX(8), SY + 6
                .LineX dX(0), dX(7), SY + HH, Rows, nPit            '表横線
                .LineX dX(7), dX(8), SY + HH, Rows * 3, nPit / 3    '小作地の状況
                
                For n = 1 To Rows
                    If n + (nPage - 2) * Rows - 1 = Val(Cx(2)) Then Exit For
                    If Cx(2) < Rows Then
                        If ((nPage - 1) * Rows + n - Rows) > Cx(2) Then Exit For
                        Cy = Split(Cm(n - 1), ";")
                        y = (n - 1) * nPit
                    Else
                        If ((nPage - 1) * Rows + n - Rows) > Cx(2) Then Exit For
                        Cy = Split(Cm(n + (nPage - 2) * Rows - 1), ";")
                        y = (n - 1) * nPit
                    End If

                    .DrawText Cy(0), dX(0) + 1, SY + y + HH, Ay(0), 4, 12, 0, 2, nPit       '土地の所在
                    .DrawText Cy(1), dX(1), SY + y + HH, Ay(1), 4, 12, 2, 2, nPit           '現況地目
                    .DrawText Cy(2), dX(2) - 0.5, SY + y + HH, Ay(2), 4, 12, 1, 2, nPit     '耕作面積
                    
                    Select Case Val(Cy(5))
                        Case 0: .DrawText "自", dX(3) + 1, SY + y + HH, Ay(3), 3, 11, 2, 2, nPit
                        Case 1: .DrawText "小", dX(3) + 1, SY + y + HH, Ay(3), 3, 11, 2, 2, nPit
                        Case 2: .DrawText "農", dX(3) + 1, SY + y + HH, Ay(3), 3, 11, 2, 2, nPit
                    End Select
                    
                    j = Len(Cy(3))
                    If j > 26 Then
                        .DrawText Cy(3), dX(4) + 1, SY + y + HH, Ay(4), 3, 8, 0, 2, nPit             '所有者
                    ElseIf j > 20 Then
                        .DrawText Cy(3), dX(4) + 2, SY + y + HH, Ay(4) - 2, 3.5, 9, 0, 2, nPit       '所有者
                    ElseIf j > 10 Then
                        .DrawText Cy(3), dX(4) + 2.5, SY + y + HH, Ay(4) - 2.5, 4, 11, 0, 2, nPit    '所有者
                    Else
                        .DrawText Cy(3), dX(4) + 1.8, SY + y + HH, Ay(4), 4, 12, 0, 2, nPit        '所有者
                    End If
                    
                    If Val(Cy(5)) > 0 Then
                        Select Case Len(Cy(4))
                            Case Is > 26: .DrawText Cy(4), dX(5) + 1, SY + y + HH, Ay(5), 3, 8, 0, 2, nPit            '所有者
                            Case Is > 20: .DrawText Cy(4), dX(5) + 2, SY + y + HH, Ay(5) - 2, 3.5, 9, 0, 2, nPit      '所有者
                            Case Is > 10: .DrawText Cy(4), dX(5) + 2.5, SY + y + HH, Ay(5) - 2.5, 4, 11, 0, 2, nPit
                            Case Else: .DrawText Cy(4), dX(5) + 1.8, SY + y + HH, Ay(5), 4, 12, 0, 2, nPit       '所有者
                        End Select
                        
                        Select Case Val(Cy(6))
                            Case 0: .DrawText "-", dX(6) + 1, SY + y + HH, Ay(6), 3, 11, 2, 2, nPit
                            Case 1: .DrawText "賃", dX(6) + 1, SY + y + HH, Ay(6), 3, 11, 2, 2, nPit
                            Case 2: .DrawText "使", dX(6) + 1, SY + y + HH, Ay(6), 3, 11, 2, 2, nPit
                        End Select
                        
                        If IsDate(Replace(Cy(7), "0:00:00", "")) Then
                            .DrawText Format$(CDate(Cy(7)), "GGGEE年MM月DD日"), dX(7) + 1, SY + y + HH, Ay(7), 3, 11, 2, 2, 4
                        End If
                        If IsDate(Replace(Cy(8), "0:00:00", "")) Then
                            .DrawText Format$(CDate(Cy(8)), "GGGEE年MM月DD日"), dX(7) + 1, SY + y + HH + 4, Ay(7), 3, 11, 2, 2, 4
                        End If
                        If Val(Cy(9)) > 0 Then
                            .DrawText Cy(9) & Cy(10), dX(7) + 1, SY + y + HH + 8, Ay(7), 3, 11, 2, 2, 4
                        End If
                        
                        
                    End If
                Next
            End If

            If .MaxPage <> 1 Then
                .TextOut "Page " & nPage & "/" & .MaxPage, .PaperWidth - 40, 8, 12, 0, 2
            End If

        End With
    End Sub

    Private Sub CPrintCls_TargetChange(sKey As String)
    
    End Sub

End Class










Class CPrint受付交付簿3条
    Option Explicit
    Implements ADBasicLIB2.CPrintCls
    Private mvarPData As CPrintDatas
    Private mvarParent As CPrintFormSK
    Private s総会番号 As String
    Private dt受付範囲 As Date
    Private s市町村名 As String

    Private Property Get CPrintCls_CanCancelPrint() As Boolean: End Property
    Private Property Get CPrintCls_CanPrintNowPage() As Boolean: CPrintCls_CanPrintNowPage = True: End Property

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim RsT As ADBasicLIB2.RecordsetEx
        Dim St As String
        Dim St1 As String, St2 As String
        Dim n As Long, i As Long
        Dim K As Long, W As Long
        Dim nArea(4) As Double
        Dim nLand(4) As Long
        Dim nAreaS(4) As Double
        Dim nLandS(4) As Long
        Dim sItem(4) As String
        Dim n地目区分 As Long
        Dim n面積 As Double
        Dim n部分面積 As Double
        Dim n集計面積 As Double
        Dim b合計 As Boolean
        Dim nCount As Long
        Dim nRows As Long
        Dim HMax As Long
        Dim n所有者 As Long
        Dim n分母(3) As Long
        Dim n分子(3) As Long
        Dim n筆 As Long
        Dim n支所番号 As Long
        Dim sSQL As String
        Dim n出力番号 As Long
        Dim Ar As Variant
        Dim s備考(6) As Variant
        Dim b備考(3) As Boolean
        Dim s支所記号 As String
       
        Ar = Split(sParam, ";")
        s総会番号 = Ar(0)
        If UBound(Ar) = 1 Then
            dt受付範囲 = Ar(1)
        Else
            dt受付範囲 = Now - 365
        End If
        s市町村名 = Fnc.s市町村名
        mvarParent.表示倍率 = 0.75
        
        b合計 = False
        n支所番号 = 0
        Select Case s市町村名
            Case "南種子町":
                nRows = 10
                HMax = 2
                b合計 = True
            Case "日置市":
                nRows = 7
                HMax = 4
                n支所番号 = SysAD.GetSettingData("農地基本台帳", "支所番号", 1)
                s支所記号 = MID(SystemDB.DBProperty("支所記号"), n支所番号, 1)
            Case Else
                Exit Function
        End Select
        
        Set mvarPData = New CPrintDatas
        
        With mvarPData
            .Headers = _
            "行区分;" & _
            "法令;受付番号;通年受付番号;受付補助記号;受付年月日;取下年月日;総会日;決定;許可年月日;許可番号;権利種類;期間;永久;小作料;小作料単位;備考;出力番号;" & _
            "譲渡人住所;譲渡人氏名;譲渡人年齢;譲渡人経営面積;譲渡事由;共有持分;筆端数;" & _
            "譲受人住所;譲受人氏名;譲受人年齢;譲受人経営面積;譲受事由;作物;通作距離;" & _
            ">農地;土地所在;登記地目;現況地目;面積;農振区分;所有者;所有者住所;持分;登記簿面積;一部;備考;事由;"
    
            For K = 0 To 3
                nArea(K) = 0:  nLand(K) = 0
                nAreaS(K) = 0: nLandS(K) = 0
            Next
            n出力番号 = 0
            sSQL = "SELECT *,[住所A] AS [譲渡人住所] FROM [D_申請] WHERE ([法令] IN (30,31,32,33)) AND [総会番号]=" & Val(sParam) & " AND ([受付年月日]>=#" & Format(dt受付範囲, "YYYY/MM/DD") & "#)"
            If s市町村名 = "日置市" Then
                sSQL = sSQL & " AND [受付補助記号]='" & s支所記号 & "' ORDER BY [通年受付番号],[受付番号]"
            Else
                sSQL = sSQL & " ORDER BY [通年受付番号],[受付番号]"
            End If
            Set Rs = SystemDB.GetRecordsetEx(sSQL, 0, , "受付交付簿")
            Do Until Rs.EOF
                n = .NewLine
                .Data(n, "行区分") = 0
                .SetRsDataList n, "法令;受付番号;通年受付番号;受付年月日;備考", Rs
                n出力番号 = n出力番号 + 1
                .Data(n, "出力番号") = n出力番号
                
                If s市町村名 = "姶良市" Then
                    .Data(n, "受付補助記号") = MID(s支所記号, Rs.V("支所番号"), 1)
                ElseIf s市町村名 = "日置市" Then
                    .Data(n, "受付補助記号") = s支所記号
                Else
                    .SetRsDataList n, "受付補助記号", Rs
                End If
                
                If Rs.Value("状態") = 2 Then
                    Select Case Rs.Value("法令")
                        Case 30, 31: .Data(n, "決定") = "許可"
                        Case 32, 33: .Data(n, "決定") = "承認"
                    End Select
                    .SetRsDataList n, "許可年月日;許可番号", Rs
                End If
                .SetRsDataList n, "取下年月日;総会日;譲渡人住所", Rs
                
                If Fnc.s市町村名 <> "南種子町" And Rs.IsNotNull("代理人名") And Rs.Value("代理人名") <> "" Then
                    .SetRsData n, "譲渡人氏名", Rs, "代理人名"
                ElseIf Fnc.s市町村名 <> "南種子町" And Rs.IsNotNull("氏名A") And Rs.Value("氏名A") <> "" Then
                    .SetRsData n, "譲渡人氏名", Rs, "氏名A"
                ElseIf Rs.IsNotNull("申請者A") And Rs.Value("申請者A") <> 0 Then
                    Set RsT = SystemDB.GetRecordsetEx("SELECT [D:個人Info].氏名,[V_行政区].行政区 FROM [D:個人Info] LEFT JOIN [V_行政区] ON [D:個人Info].行政区ID = [V_行政区].ID WHERE [D:個人Info].[ID]=" & Rs.fields("申請者A").Value, 0, , "受付簿")
                    If Not RsT.EOF Then .SetRsData n, "譲渡人氏名", RsT, "氏名"
                    SystemDB.CloseRs RsT
                End If
                
                .SetRsData n, "譲渡人年齢", Rs, "年齢A"
                .SetRsData n, "譲渡人経営面積", Rs, "経営面積A"
                .SetRsData n, "譲渡事由", Rs, "申請理由A"
                
                .SetRsData n, "譲受人住所", Rs, "住所B"
                If Fnc.s市町村名 <> "南種子町" And Rs.IsNotNull("氏名B") And Rs.Value("氏名B") <> "" Then
                    .SetRsData n, "譲受人氏名", Rs, "氏名B"
                ElseIf Not Rs.IsNull("申請者B") And Rs.Value("申請者B") <> 0 Then
                    Set RsT = SystemDB.GetRecordsetEx("SELECT [D:個人Info].氏名,[V_行政区].行政区 FROM [D:個人Info] LEFT JOIN [V_行政区] ON [D:個人Info].行政区ID = [V_行政区].ID WHERE [D:個人Info].[ID]=" & Rs.fields("申請者B").Value, , , "受付簿")
                    If Not RsT.EOF Then .SetRsData n, "譲受人氏名", RsT, "氏名"
                    SystemDB.CloseRs RsT
                End If
                .SetRsData n, "譲受人年齢", Rs, "年齢B"
                .SetRsData n, "譲受人経営面積", Rs, "経営面積B"
                .SetRsData n, "譲受事由", Rs, "申請理由B"
                .SetRsData n, "権利種類", Rs
                
                If Rs.Value("永久") Then
                    .Data(n, "期間") = 0
                ElseIf Not Rs.IsNull("期間") And Rs.Value("期間") <> 0 Then
                    .SetRsData n, "期間", Rs
                ElseIf Rs.IsDate("始期") And Rs.IsDate("終期") Then
                    .Data(n, "期間") = DateDiff("yyyy", Rs.Value("始期"), Rs.Value("終期"))
                Else
                    .Data(n, "期間") = 0
                End If
                .Data(n, "永久") = IIf(Rs.Value("永久"), "1", "0")

                .SetRsData n, "作物", Rs, "利用権内容"
                If Rs.Value("通作距離") = 0 Then
                    .Data(n, "通作距離") = ""
                Else
                    .Data(n, "通作距離") = SystemDB.GetDirectDataWithClass("M_BASICALL", "名称", "通作距離", Rs.Value("通作距離"))
                End If
                .SetRsDataList n, "小作料;小作料単位", Rs
                
                If s市町村名 = "南種子町" Then
                    Ar = Split(Rs.NullCast("備考", ""), vbCrLf)
                    K = UBound(Ar)
                    For K = 0 To 5
                        If K <= UBound(Ar) Then
                            s備考(K) = Ar(K)
                        Else
                            s備考(K) = ""
                        End If
                    Next
                    For K = 0 To 3: b備考(K) = False: Next
                End If
                For K = 0 To 3
                    n分母(K) = 0
                    n分子(K) = 0
                Next
                n所有者 = 0
                n筆 = 0
                .Data(n, "共有持分") = 0
                St = Replace(Replace(Rs.NullCast("農地リスト", ""), "農地.", ""), ";", ",")
                If Len(St) Then
                If s市町村名 = "姶良市" Then
                    Set RsT = SystemDB.GetRecordsetEx("SELECT [V_農地].*,[V_地目].名称 AS [登記地目],[地目2].名称 AS [現況],[V_農委地目].名称 AS [農委地目],[D:個人Info].氏名 AS [所有者],[D:個人Info].住所 AS [所有者住所],[D_部分申請].部分面積 AS [部分面積T] FROM (((([V_農地] LEFT JOIN [V_地目] ON [V_農地].[登記簿地目]=[V_地目].ID) LEFT JOIN V_地目 AS 地目2 ON [V_農地].[現況地目]=[地目2].ID) LEFT JOIN [V_農委地目] ON [V_農地].[農委地目ID]=[V_農委地目].ID) LEFT JOIN [D:個人Info] ON [V_農地].[管理人ID]=[D:個人Info].ID) LEFT JOIN [D_部分申請] ON [V_農地].ID = [D_部分申請].農地ID WHERE [V_農地].[ID] IN (" & St & ") ORDER BY [V_農地].[大字ID],[V_農地].[小字ID],val(IIf(IsNull([地番]),0,IIf(InStr([地番],'-')=0,Val([地番]),val(Left([地番],InStr([地番],'-')-1)))) *1000 + Val(IIf(IsNull([地番]),0,IIf(InStr([地番],'-')=0,0,val(Mid([地番],InStr([地番],'-')+1))))))", 1, , "受付交付簿")
                Else
                    Set RsT = SystemDB.GetRecordsetEx("SELECT [V_農地].*,[V_地目].名称 AS [登記地目],[地目2].名称 AS [現況],[V_農委地目].名称 AS [農委地目],[D:個人Info].氏名 AS [所有者],[D:個人Info].住所 AS [所有者住所],[D_部分申請].部分面積 AS [部分面積T] FROM (((([V_農地] LEFT JOIN [V_地目] ON [V_農地].[登記簿地目]=[V_地目].ID) LEFT JOIN V_地目 AS 地目2 ON [V_農地].[現況地目]=[地目2].ID) LEFT JOIN [V_農委地目] ON [V_農地].[農委地目ID]=[V_農委地目].ID) LEFT JOIN [D:個人Info] ON [V_農地].[管理人ID]=[D:個人Info].ID) LEFT JOIN [D_部分申請] ON [V_農地].ID = [D_部分申請].農地ID WHERE [V_農地].[ID] IN (" & St & ") ORDER BY [V_農地].[管理人ID],[V_農地].[土地所在]", 1, , "受付交付簿")
                End If
                i = 0: nCount = 0
                Do Until RsT.EOF
                    i = i + 1: nCount = nCount + 1
                    If nCount > HMax Then
                        n = .NewLine
                        .Data(n, "行区分") = 1
                        i = 1: nCount = 1
                    End If
                    If s市町村名 = "南種子町" Then
                        If b備考(0) = False Then
                            .Data(n & ":農地." & i, "備考") = s備考(0) & "\n" & s備考(1)
                            .Data(n & ":農地." & i, "事由") = Rs.Value("申請理由A")
                            b備考(0) = True
                        ElseIf b備考(1) = False Then
                            .Data(n & ":農地." & i, "備考") = s備考(2) & "\n" & s備考(3)
                            b備考(1) = True
                        ElseIf b備考(2) = False Then
                            .Data(n & ":農地." & i, "備考") = s備考(4) & "\n" & s備考(5)
                            .Data(n & ":農地." & i, "事由") = Rs.Value("申請理由B")
                            b備考(2) = True
                        End If
                    End If
                    .SetRsData n & ":農地." & i, "土地所在", RsT
                    .SetRsData n & ":農地." & i, "登記地目", RsT
                    .SetRsData n & ":農地." & i, "農振区分", RsT, "農業振興地域"
                     
                    If (Not RsT.IsNull("農委地目ID")) And (RsT.Value("農委地目ID") <> 0) And (Not RsT.IsNull("農委地目認定日")) And (RsT.Value("農委地目認定日") <> "0:00:00") Then
                        .SetRsData n & ":農地." & i, "現況地目", RsT, "農委地目"
                    Else
                        .SetRsData n & ":農地." & i, "現況地目", RsT, "現況"
                    End If
                    
                    If Not RsT.IsNull("共有持分分母") And RsT.Value("共有持分分母") <> 0 Then
                        .Data(n & ":農地." & i, "持分") = RsT.Value("共有持分分子") & "/" & RsT.Value("共有持分分母")
                        .Data(n, "共有持分") = 1
                    End If
                    If n所有者 <> RsT.Value("管理人ID") Then
                        .SetRsData n & ":農地." & i, "所有者", RsT
                        .SetRsData n & ":農地." & i, "所有者住所", RsT
                        n所有者 = RsT.Value("管理人ID")
                    End If
                                       
                    n部分面積 = 0
                    If Not RsT.IsNull("部分面積T") Then n部分面積 = RsT.Value("部分面積T")
                        
                    n地目区分 = 2
                    n面積 = 0
                    If RsT.Value("田面積") <> 0 Then
                        n面積 = RsT.Value("田面積")
                        n地目区分 = 0
                    ElseIf RsT.Value("畑面積") <> 0 Then
                        n面積 = RsT.Value("畑面積")
                        n地目区分 = 1
                    End If
                    If n面積 = 0 Or s市町村名 = "南種子町" Then n面積 = Fnc.NullCast(RsT.Value("登記簿面積"), 0)
                    
                    If n部分面積 = 0 Then
                        n集計面積 = n面積
                    Else
                        n集計面積 = n部分面積
                    End If
                    If s市町村名 <> "南種子町" Then n集計面積 = Fix(n集計面積)
                    .Data(n & ":農地." & i, "面積") = n集計面積
                    
                    .Data(n & ":農地." & i, "一部") = 0
                    If RsT.IsNull("一部現況") Then
                    ElseIf RsT.Value("一部現況") > 0 Then
                        If s市町村名 = "南種子町" Then
                            .Data(n & ":農地." & i, "登記簿面積") = Fnc.NullCast(RsT.Value("登記簿面積"), 0)
                        Else
                            .Data(n & ":農地." & i, "登記簿面積") = Fix(Fnc.NullCast(RsT.Value("登記簿面積"), 0))
                        End If
                        .Data(n & ":農地." & i, "一部") = 1
                    End If
                                        
                    If RsT.IsNotNull("共有持分分母") And RsT.Value("共有持分分母") <> 0 Then
                        If n分子(n地目区分) = 0 And n分母(n地目区分) = 0 Then
                            n分子(n地目区分) = RsT.Value("共有持分分子")
                            n分母(n地目区分) = RsT.Value("共有持分分母")
                        Else
                            n分子(n地目区分) = n分子(n地目区分) * RsT.Value("共有持分分母")
                            n分子(n地目区分) = n分子(n地目区分) + RsT.Value("共有持分分子") * n分母(n地目区分)
                            n分母(n地目区分) = n分母(n地目区分) * RsT.Value("共有持分分母")
                        End If
                    Else
                        If n分子(n地目区分) = 0 And n分母(n地目区分) = 0 Then
                            n分子(n地目区分) = 1
                            n分母(n地目区分) = 1
                        Else
                            n分子(n地目区分) = n分子(n地目区分) + n分母(n地目区分)
                        End If
                    End If
    
                    nAreaS(n地目区分) = nAreaS(n地目区分) + n集計面積
'                    nLandS(n地目区分) = nLandS(n地目区分) + 1
                    nArea(n地目区分) = nArea(n地目区分) + n集計面積
'                    nLand(n地目区分) = nLand(n地目区分) + 1
                    n筆 = n筆 + 1
                    RsT.MoveNext
                Loop
                SystemDB.CloseRs RsT
                End If
                If s市町村名 = "南種子町" Then
                    K = n筆
                    Do While K < 4
                        i = i + 1: nCount = nCount + 1
                        If nCount > HMax Then
                            n = .NewLine
                            .Data(n, "行区分") = 2
                            i = 1: nCount = 1
                        End If
                        If b備考(0) = False Then
                            .Data(n & ":農地." & i, "備考") = s備考(0) & "\n" & s備考(1)
                            .Data(n & ":農地." & i, "事由") = Rs.Value("申請理由A")
                            b備考(0) = True
                        ElseIf b備考(1) = False Then
                            .Data(n & ":農地." & i, "備考") = s備考(2) & "\n" & s備考(3)
                            b備考(1) = True
                        ElseIf b備考(2) = False Then
                            .Data(n & ":農地." & i, "備考") = s備考(4) & "\n" & s備考(5)
                            .Data(n & ":農地." & i, "事由") = Rs.Value("申請理由B")
                            b備考(2) = True
                        End If
                        .Data(n & ":農地." & i, "現況地目") = "77777"
                        K = K + 1
                    Loop
                End If
                For K = 0 To 2
                    If nAreaS(K) > 0 Then
                        nLandS(K) = n分子(K) \ n分母(K)
                        n分子(K) = n分子(K) Mod n分母(K)
                    End If
                    nLand(K) = nLand(K) + nLandS(K)
                Next

                n分子(3) = n分子(0) + n分子(1) + n分子(2)
                nAreaS(3) = nAreaS(0) + nAreaS(1) + nAreaS(2)
                nLandS(3) = nLandS(0) + nLandS(1) + nLandS(2)
                If b合計 And n筆 > 1 Then
    '                    If nLandS(3) > 1 Or n分子(3) > 0 Then
                        St = "": St1 = "": St2 = ""
                        sItem(0) = "( 田 )": sItem(1) = "( 畑 )": sItem(2) = "( 他 )": sItem(3) = "( 計 )"
                        For K = 0 To 3
                            If nLandS(K) > 0 Or n分子(K) <> 0 Then
                                St = St & sItem(K) & "\n"
    '                                St1 = St1 & FormatNumber(nLandS(K), 0) & " 筆\n"
                                St1 = St1 & Format(nLandS(K), "#")
                                If n分子(K) <> 0 And K < 3 Then
                                    If nLandS(K) > 0 Then St1 = St1 & "・"
                                    計算A n分子(K), n分母(K)
                                    St1 = St1 & n分子(K) & "/" & n分母(K)
                                End If
                                St1 = St1 & " 筆\n"
                                If s市町村名 = "南種子町" Then
                                    St2 = St2 & pFormatN(CCur(nAreaS(K))) & "\n"
                                Else
                                    St2 = St2 & FormatNumber(nAreaS(K), 0) & "\n"
                                End If
                            End If
                        Next
                        n = .NewLine
                        .Data(n, "行区分") = 1
                        .Data(n & ":農地." & 1, "現況地目") = "88888"
                        .Data(n & ":農地." & 1, "土地所在") = Left(St, Len(St) - 2)
                        .Data(n & ":農地." & 1, "登記地目") = Left(St1, Len(St1) - 2)
                        .Data(n & ":農地." & 1, "面積") = Left(St2, Len(St2) - 2)
    '                    End If
                End If
                For K = 0 To 3
                    nAreaS(K) = 0: nLandS(K) = 0
                Next
                Rs.MoveNext
            Loop
            SystemDB.CloseRs Rs
            nArea(3) = nArea(0) + nArea(1) + nArea(2)
            nLand(3) = nLand(0) + nLand(1) + nLand(2)
            
            ' 合計行
            If b合計 Then
                If nArea(3) > 0 Then
                    St = "": St1 = "": St2 = ""
                    sItem(0) = "( 田 )": sItem(1) = "( 畑 )": sItem(2) = "( 他 )": sItem(3) = "( 計 )"
                    For K = 0 To 3
                        If nArea(K) > 0 Then
                            St = St & sItem(K) & "\n"
                            St1 = St1 & Format(nLand(K), "#") & " 筆\n"
                            If s市町村名 = "南種子町" Then
                                St2 = St2 & pFormatN(CCur(nArea(K))) & "\n"
                            Else
                                St2 = St2 & FormatNumber(nArea(K), 0) & "\n"
                            End If
                        End If
                    Next
                    n = .NewLine
                    .Data(n & ":農地." & 1, "現況地目") = "99999"
                    .Data(n & ":農地." & 1, "土地所在") = Left(St, Len(St) - 2)
                    .Data(n & ":農地." & 1, "登記地目") = Left(St1, Len(St1) - 2)
                    .Data(n & ":農地." & 1, "面積") = Left(St2, Len(St2) - 2)
                End If
            End If
            
            ' ページ設定
            n = .Count
            mvarParent.MaxPage = n \ nRows + IIf((n Mod nRows) > 0, 1, 0)
            mvarParent.Page = 1
        End With
    End Function
    
    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property

    Private Property Let CPrintCls_Key(ByVal RHS As String): End Property
    Private Property Get CPrintCls_Key() As String: End Property
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants: CPrintCls_Orientation = vbPRORLandscape: End Property

    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&)
        mvarParent.Page = nNewPage
        CPrintCls_Repaint
    End Sub
    
    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Set CPrintCls_Parent(RHS As ADBasicLIB2.CPrintFormSK): Set mvarParent = RHS: End Property

    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        mvarParent.PrintPage = 1
        mvarParent.PrintMaxPage = mvarParent.MaxPage
            
        If bNowPage Then
            PrintSub mvarParent.Page
            mvarParent.EndDoc
        Else
            Do Until mvarParent.PrintPage > mvarParent.PrintMaxPage
                PrintSub mvarParent.PrintPage
                mvarParent.NewPage
            Loop
            mvarParent.EndDoc
        End If
    
    End Sub
    Private Sub CPrintCls_Repaint(): PrintSub mvarParent.Page: End Sub

    Private Sub CPrintCls_TargetChange(sKey As String): End Sub

    Private Sub PrintSub(nPage As Long)
        Dim nFsize As Integer
        Dim Ar As Variant, Cm As Variant
        Dim n As Long, i As Long
        Dim y As Single, Y2 As Long
        Dim dX(25) As Single, hX(25) As Single
        Dim Xcnt As Long
        Dim nStart As Long, nEnd As Long
        Dim nRows As Long, nRowH As Long
        Dim nWork As Double
        Dim St1 As String, St2 As String
        Dim St3 As String
        Dim K As Long
        Dim SX As Long, SY As Single
        Dim b合計 As Boolean
        Dim pTable As New CDrawTable
        
        Select Case s市町村名
        Case "姶良市":
            nFsize = 10
            nRows = 7
            Ar = GetArray(12, 12, 42, 42, 50, 10, 20, 8, 20, 15, 15, 25)
            SX = 12
            pTable.SetWidth SX, Ar

        Case "南種子町"
            nFsize = 7
            nRows = 10
            Ar = GetArray(8, 9, 10, 23, 18, 23, 18, 35, 7, 8, 15, 12, 10, 10, 8, 10, 10, 16, 8, 18)
            SX = 10
            pTable.SetWidth SX, Ar
            nRowH = 14
            SY = 47
            
        Case "日置市"
            nFsize = 10
            nRows = 7
            Ar = GetArray(10, 14, 22, 58, 14, 12, 50, 8, 14, 12, 8, 10, 16, 10, 12)
            SX = 12
            pTable.SetWidth SX, Ar
        Case Else
            Exit Sub
        End Select
            
        dX(0) = SX: hX(0) = dX(0) + Ar(0) / 2
        For i = 0 To UBound(Ar)
            dX(i + 1) = dX(i) + Ar(i)
            If i < UBound(Ar) Then hX(i + 1) = dX(i + 1) + Ar(i + 1) / 2
        Next
        Xcnt = UBound(Ar) + 1
    
        With mvarParent
            .ClearScreen
                
            Select Case s市町村名
            Case "姶良市":
                .Offset 0, 0
                .TextOut "農 地 法 第 ３ 条 受 付 ・ 交 付 簿", (dX(Xcnt) + dX(0)) / 2, 25 - 2, 12, 2, 0
                .DrawText "受付\n番号", dX(0), 30, Ar(0), 4, nFsize, 2, 2, 20
                .DrawText "受付日", dX(1), 30, Ar(1), 4, nFsize, 2, 2, 20
                .DrawText "譲受人（借人）", dX(2), 30, Ar(2), 4, nFsize, 2, 2, 20
                .DrawText "譲渡人（貸人）", dX(3), 30, Ar(3), 4, nFsize, 2, 2, 20
                .DrawText "土 地 の 表 示", dX(4), 30, Ar(4), 4, nFsize, 2, 2, 20
                .DrawText "地目", dX(5), 30, Ar(5), 4, nFsize, 2, 2, 20
                .DrawText "面積\n\n(u)", dX(6), 30, Ar(6), 4, nFsize, 2, 2, 20
                .DrawText "権\n利\n種\n類", dX(7), 30, Ar(7), 4, nFsize, 2, 2, 20
                .DrawText "許可番号", dX(8), 30, Ar(8), 4, nFsize, 2, 2, 10
                .DrawText "許 可 日", dX(8), 40, Ar(8), 4, nFsize, 2, 2, 10
                .DrawText "譲受人\n(借人)\n受領印", dX(9), 30, Ar(9), 4, nFsize, 2, 2, 20
                .DrawText "譲渡人\n(貸人)\n受領印", dX(10), 30, Ar(10), 4, nFsize, 2, 2, 20
                .DrawText "備　考", dX(11), 30, Ar(11), 4, nFsize, 2, 2, 15
                .DrawText "受領日", dX(11), 45, Ar(11), 4, nFsize, 2, 2, 5
                
                .LineBoxDX dX(0), 30, 20, nRows, 20, Ar
                .DLine dX(8), 40, dX(9), 40
                .DLine dX(11), 44, dX(12), 44
                For n = 1 To nRows
                    .DotLine dX(8), 40 + n * 20, dX(9), 40 + n * 20, vbBlack
                    .DotLine dX(11), 44 + n * 20, dX(12), 44 + n * 20, vbBlack
                Next
                
                If nPage = 0 Then Exit Sub
                nStart = (nPage - 1) * nRows + 1
                nEnd = nStart + nRows - 1
                If nEnd > mvarPData.Count Then nEnd = mvarPData.Count
                y = 50 + 1
                For n = nStart To nEnd
                    If mvarPData.Data(n, "行区分") = 0 Then
                        .DrawText mvarPData.Data(n, "出力番号"), dX(0), y + 5 - 2, Ar(0), 4, nFsize, 2, 2
                        .DrawText mvarPData.Data(n, "受付補助記号"), dX(0), y + 15 - 2, Ar(0), 4, nFsize, 2, 2
                        .TextOut Format(mvarPData.Data(n, "受付年月日"), "GEE"), dX(1) + 1, y + 5, nFsize, 0, 2
                        
                        .DrawText Format(mvarPData.Data(n, "受付年月日"), "M.D"), dX(1), y + 10, Ar(1), 4, nFsize, 2, 2
                        .DrawText Fnc.GetShortAddress(mvarPData.Data(n, "譲受人住所"), SystemDB.DBProperty("都道府県名"), SystemDB.DBProperty("郡部"), , , True), dX(2) + 1, y, Ar(2) - 1, 4, nFsize - IIf(pLen(mvarPData.Data(n, "譲受人住所")) > 40, 1, 0)
                        .DrawText mvarPData.Data(n, "譲受人氏名"), dX(2) + 1, y + 8, Ar(2) - 1, 4, nFsize
                        .DrawText Fnc.GetShortAddress(mvarPData.Data(n, "譲渡人住所"), SystemDB.DBProperty("都道府県名"), SystemDB.DBProperty("郡部"), , , True), dX(3) + 1, y, Ar(2) - 1, 4, nFsize - IIf(pLen(mvarPData.Data(n, "譲渡人住所")) > 40, 1, 0)
                        .DrawText mvarPData.Data(n, "譲渡人氏名"), dX(3) + 1, y + 8, Ar(3) - 1, 4, nFsize
                        
                        Select Case mvarPData.Data(n, "法令")
                            Case 30, 32: .TextOut "所", hX(7), y + 9, nFsize, 2, 2
                            Case 31, 33:
                                Select Case mvarPData.Data(n, "権利種類")
                                    Case 1: .TextOut "賃", hX(7), y + 9, nFsize, 2, 2
                                    Case 2: .TextOut "使", hX(7), y + 9, nFsize, 2, 2
                                End Select
                        End Select
'                        .DrawText IIf(Val(mvarPData.Data(n, "許可番号")), mvarPData.Data(n, "許可番号"), ""), dX(8), Y + 5, Ar(8), 5, nFsize, 2, 2
'                        .DrawText IIf(IsDate(mvarPData.Data(n, "許可年月日")), Format(mvarPData.Data(n, "許可年月日"), "GEE.MM.DD"), ""), dX(8), Y + 15, Ar(8), 5, nFsize, 2, 2
'                        .DrawText Left(mvarPData.Data(n, "備考"), 28), dX(11) + 0.5, y, Ar(11) - 0.5, 5, nFsize
                    End If
                    Y2 = y
                    For i = 0 To mvarPData.SubCount(n & ":農地")
                        If pLen(mvarPData.Data(n & ":農地." & i, "土地所在")) > 26 Then
                            .DrawText mvarPData.Data(n & ":農地." & i, "土地所在"), dX(4) + 1, Y2 - 1, Ar(4) - 1, 3, nFsize - 1
                        Else
                            .DrawText mvarPData.Data(n & ":農地." & i, "土地所在"), dX(4) + 1, Y2, Ar(4) - 1, 4, nFsize
                        End If
                        .DrawText Left(mvarPData.Data(n & ":農地." & i, "登記地目"), 2), dX(5), Y2, Ar(5), 4, nFsize, 2, 0
                        If Val(mvarPData.Data(n & ":農地." & i, "一部")) = 1 Then
                            .DrawText FormatNumber(Val(mvarPData.Data(n & ":農地." & i, "面積")), 2), dX(6), Y2 - 1, Ar(6) - 1, 3, nFsize - 1, 1
                            .TextOut "(" & FormatNumber(Val(mvarPData.Data(n & ":農地." & i, "登記簿面積")), 2) & "の内)", dX(7), Y2 + 2, nFsize - 2, 1
                        Else
                            .DrawText FormatNumber(Val(mvarPData.Data(n & ":農地." & i, "面積")), 2), dX(6), Y2, Ar(6) - 1, 4, nFsize, 1
                        End If
                        Y2 = Y2 + 5
                    Next
                    y = y + 20
                Next

            Case "南種子町"
                Dim nY1 As Single, nY2 As Single
                .Offset 0, 0
                .TextOut "第 " & s総会番号 & " 回定例総会付議案件　農地法第３条　申請書受付・交付簿", dX(0) + 5, 22, 10, 0, 0
                .TextOut "会　長", 154, 16.5, nFsize, 2, 2
                .TextOut "事務局長", 172, 16.5, nFsize, 2, 2
                .TextOut "係　長", 190, 16.5, nFsize, 2, 2
                .TextOut "係", 217, 16.5, nFsize, 2, 2
                .TextOut s市町村名 & "農業委員会", dX(Xcnt) - 2, 31, 9, 1, 1
                
                .DrawText "整理\n番号\n(月通)", dX(0), 36, Ar(0), 3, nFsize - 2, 2
                .DrawText "受付\n番号\n(年度通)", dX(1), 38.5, Ar(1), 3, nFsize - 2, 2
                .TextOut "受　　付", dX(2), 34.5, nFsize, 2, 2
                .TextOut "年月日", hX(2), 42, nFsize, 2, 2
                .TextOut "譲受人（借人）", (dX(3) + dX(5)) / 2, 34.5, nFsize, 2, 2
                .TextOut "住　　所", hX(3), 42, nFsize, 2, 2
                .TextOut "氏　名", hX(4), 42, nFsize, 2, 2
                .TextOut "譲渡人（貸人）", (dX(5) + dX(7)) / 2, 34.5, nFsize, 2, 2
                .TextOut "住　　所", hX(5), 42, nFsize, 2, 2
                .TextOut "氏　名", hX(6), 42, nFsize, 2, 2
                .TextOut "申　　　請　　　地", (dX(7) + dX(11)) / 2, 34.5, nFsize, 2, 2
                .TextOut "所　　在", hX(7), 42, nFsize, 2, 2
                .TextOut "持分", hX(8), 42, nFsize, 2, 2
                .TextOut "登記", hX(9), 39.5, nFsize, 2, 2
                .TextOut "現況", hX(9), 44.5, nFsize, 2, 2
                .TextOut "地 積", hX(10), 39.5, nFsize, 2, 2
                .TextOut "(u)", hX(10), 44.5, nFsize, 2, 2

                .TextOut "譲渡事由", hX(11), 36, nFsize, 2, 2
                .TextOut "譲受事由", hX(11), 43.5, nFsize, 2, 2
                .TextOut "処　　　　　理　　　　　状　　　　　況", (dX(12) + dX(20)) / 2, 34.5, nFsize, 2, 2
                .DrawText "取　下\n年月日", dX(12), 39, Ar(12), 4, nFsize, 2
                .TextOut "町 委 員 会", (dX(13) + dX(15)) / 2, 39.5, nFsize, 2, 2
                .TextOut "年月日", hX(13), 44.5, nFsize, 2, 2
                .TextOut "決定", hX(14), 44.5, nFsize, 2, 2
                .DrawText "許　可\n年月日", dX(15), 38, Ar(15), 3, nFsize - 1, 2
                .TextOut "番号", hX(15), 44.5, nFsize - 1, 2
                .TextOut "交　　　　付", (dX(16) + dX(19)) / 2, 39.5, nFsize, 2, 2
                .TextOut "年月日", hX(16), 44.5, nFsize, 2, 2
                .TextOut "受領者氏名", hX(17), 44.5, nFsize, 2, 2
                .TextOut "印", hX(18), 44.5, nFsize, 2, 2
                .TextOut "備　考", hX(19), 42, nFsize, 2, 2
                
                ' 印
                .DLine 145, 14, 235, 14
                .DLine 145, 18, 235, 18
                .DLine 145, 14, 145, 32
                .DLine 163, 14, 163, 32
                .DLine 181, 14, 181, 32
                .DLine 199, 14, 199, 32
                .DLine 235, 14, 235, 32
                
                ' 見出し／横線
                .DLine dX(0), 32, dX(Xcnt), 32
                .DLine dX(1), 37, dX(11), 37
                .DLine dX(12), 37, dX(Xcnt), 37
                .DLine dX(9), 42, dX(10), 42
                .DLine dX(11), 39.5, dX(12), 39.5
                .DLine dX(13), 42, dX(15), 42
                .DLine dX(16), 42, dX(19), 42
                .DLine dX(15), 43.5, dX(16), 43.5
                
                ' 見出し／縦線
                For n = 0 To Xcnt
                    Select Case n
                        Case 2, 4, 6, 8, 9, 10, 13, 15, 16, 19
                            .DLine dX(n), 37, dX(n), SY
                        Case 14, 17, 18
                            .DLine dX(n), 42, dX(n), SY
                        Case Else
                            .DLine dX(n), 32, dX(n), SY
                    End Select
                Next
                .LineBoxDX dX(0), SY, 0, 1, nRows * nRowH, Ar
                
                If nPage = 0 Then Exit Sub
    '                If (Not IsNull(mvarPData.Data(1, "総会日"))) And (mvarPData.Data(1, "総会日") <> "0:00:00") Then
    '                    .TextOut Format(mvarPData.Data(1, "総会日"), "GEE/MM/DD") & " 開催", dX(Xcnt) - 2, 30, 12, 1, 1
    '                End If
                
                nStart = (nPage - 1) * nRows + 1
                nEnd = nStart + nRows - 1
                If nEnd > mvarPData.Count Then nEnd = mvarPData.Count
                y = SY + 1
                nY1 = (nRowH - 4) / 4
                For n = nStart To nEnd
                    If mvarPData.Data(n, "行区分") = 0 Then
                        .DLine dX(0), y - 1, dX(Xcnt), y - 1
                        .TextOut mvarPData.Data(n, "受付番号"), dX(1) - 2, y, nFsize, 1
                        .TextOut mvarPData.Data(n, "通年受付番号"), dX(2) - 2, y, nFsize, 1
                        .DrawText SetDate(mvarPData.Data(n, "受付年月日")), dX(2) + 1, y, Ar(2), 4, nFsize, 0
                        .DrawText StrConv(mvarPData.Data(n, "譲受人住所"), vbNarrow), dX(3) + 1, y, Ar(3) - 1, 3, nFsize
                        .DrawText Left(mvarPData.Data(n, "譲受人氏名"), 24), dX(4) + 1, y, Ar(4) - 1, 3, nFsize
                        If mvarPData.Data(n, "共有持分") = "0" Then
                            .DrawText StrConv(mvarPData.Data(n, "譲渡人住所"), vbNarrow), dX(5) + 1, y, Ar(5) - 1, 3, nFsize
                            .DrawText Left(mvarPData.Data(n, "譲渡人氏名"), 24), dX(6) + 1, y, Ar(6) - 1, 3, nFsize, 0
                        End If
                        .DLine dX(11), y + 13, dX(12), y + 13   '譲渡事由・譲受事由の間の線
                        .DrawText SetDate(mvarPData.Data(n, "取下年月日")), dX(12) + 1, y, Ar(12), 4, nFsize, 0
                        .DrawText SetDate(mvarPData.Data(n, "総会日")), dX(13) + 1, y, Ar(13), 4, nFsize, 0
                        .DrawText mvarPData.Data(n, "決定"), dX(14), y, Ar(14), 3, nFsize, 2
                        .DrawText SetDate(mvarPData.Data(n, "許可年月日")), dX(15) + 1, y, Ar(15), 4, nFsize, 0

    '                        St1 = ""
    '                        St2 = IIf(Val(mvarPData.Data(n, "小作料")) > 0, FormatNumber(Val(mvarPData.Data(n, "小作料")), 0) & mvarPData.Data(n, "小作料単位"), "")
    '                        St3 = IIf(Val(mvarPData.Data(n, "期間")) > 0, FormatNumber(Val(mvarPData.Data(n, "期間")), 0) & "年", "")
    '                        Select Case mvarPData.Data(n, "法令")
    '                            Case 30, 32: St1 = "所有権" & "\n" & St2 & "\n" & St3
    '                            Case 31, 33
    '                                Select Case mvarPData.Data(n, "権利種類")
    '                                    Case 1: St1 = "賃貸借権" & "\n" & St2 & "\n" & St3
    '                                    Case 2: St1 = "使用貸借権" & "\n" & St2 & "\n" & St3
    '                                End Select
    '                        End Select
    '                        .DrawText St1, dX(16), y, Ar(16), 4, nFsize, 2
    '                        St1 = "": St2 = ""
    '                        St1 = IIf(Len(mvarPData.Data(n, "備考")) > 0, mvarPData.Data(n, "備考") & "\n", "")
    '                        If mvarPData.Data(n, "永久") = "1" Then
    '                            St2 = "永久"
    '                        Else
    '                            St2 = IIf(Val(mvarPData.Data(n, "期間")) > 0, FormatNumber(Val(mvarPData.Data(n, "期間")), 0) & "年", "")
    '                        End If
                    ElseIf mvarPData.Data(n, "行区分") = "1" Then
                        .DLine dX(7), y - 1, dX(11), y - 1
                    ElseIf mvarPData.Data(n, "行区分") <> "2" Then
                        .DLine dX(0), y - 1, dX(Xcnt), y - 1
                    End If
                    
                    Y2 = y
                    For i = 0 To mvarPData.SubCount(n & ":農地")
                        If mvarPData.Data(n & ":農地." & i, "現況地目") = "77777" Then
                        Else
                            If i <> 0 Then .DLine dX(7), Y2 - 1, dX(11), Y2 - 1
                            If mvarPData.Data(n & ":農地." & i, "現況地目") = "88888" Then
                                .DLine dX(5), Y2 - 1, dX(7), Y2 - 1
                                .DrawText mvarPData.Data(n & ":農地." & i, "土地所在"), dX(7) + 16, Y2 + 6 - 2, Ar(7), 3, nFsize, 0, 0
                                .DrawText mvarPData.Data(n & ":農地." & i, "登記地目"), dX(7), Y2 + 6 - 2, Ar(7) - 2, 3, nFsize, 1, 0
                                .DrawText mvarPData.Data(n & ":農地." & i, "面積"), dX(10), Y2 + 6 - 2, Ar(10) - 1, 3, nFsize, 1, 0
                            ElseIf mvarPData.Data(n & ":農地." & i, "現況地目") = "99999" Then
                                Y2 = (nRows - 1) * nRowH + SY + 1
                                .DrawText "月合計", dX(7) + 3, Y2 + 6, Ar(7), 4, nFsize, 0, 0
                                .DrawText mvarPData.Data(n & ":農地." & i, "土地所在"), dX(7) + 16, Y2 + 6 - 2, Ar(7), 3, nFsize, 0, 0
                                .DrawText mvarPData.Data(n & ":農地." & i, "登記地目"), dX(7), Y2 + 6 - 2, Ar(7) - 2, 3, nFsize, 1, 0
                                .DrawText mvarPData.Data(n & ":農地." & i, "面積"), dX(10), Y2 + 6 - 2, Ar(10) - 1, 3, nFsize, 1, 0
                            Else
                                If mvarPData.Data(n, "共有持分") = "1" Then
                                    If Len(mvarPData.Data(n & ":農地." & i, "所有者")) > 0 Then .DLine dX(5), Y2 - 1, dX(7), Y2 - 1
                                    .DrawText StrConv(mvarPData.Data(n & ":農地." & i, "所有者住所"), vbNarrow), dX(5) + 1, Y2 + nY1 - 2, Ar(5) - 1, 3, nFsize, 0, 0
                                    .DrawText mvarPData.Data(n & ":農地." & i, "所有者"), dX(6) + 1, Y2 + nY1 - 2, Ar(6) - 1, 3, nFsize, 0, 0
                                End If
                                
                                .DrawText mvarPData.Data(n & ":農地." & i, "土地所在"), dX(7) + 1, Y2 + nY1 - 2, Ar(7) - 2, 4, nFsize, 0, 0
                                .DrawText mvarPData.Data(n & ":農地." & i, "持分"), dX(8), Y2 + nY1 - 2, Ar(8), 3, nFsize, 2, 0
                                St1 = mvarPData.Data(n & ":農地." & i, "登記地目")
                                St2 = mvarPData.Data(n & ":農地." & i, "現況地目")
                                If StrComp(St1, St2) Then
                                    .DrawText Left(St1, 3), dX(9), Y2 + 1.5 - 2, Ar(9), 4, nFsize, 2, 0
                                    .DrawText Left(St2, 3), dX(9), Y2 + 5 - 2, Ar(9), 4, nFsize, 2, 0
                                    .DLine dX(9), Y2 + nY1, dX(10), Y2 + nY1
                                Else
                                    .DrawText St1, dX(9), Y2 + nY1 - 2, Ar(9), 3, nFsize, 2, 0
                                End If
                                .DrawText pFormatN(Val(mvarPData.Data(n & ":農地." & i, "面積"))), dX(10), Y2 + nY1 - 2, Ar(10) - 1, 3, nFsize, 1, 0
                            End If
                        End If
                        .DrawText Left(mvarPData.Data(n & ":農地." & i, "事由"), 16), dX(11) + 0.5, Y2, Ar(11), 3, nFsize
                        .DrawText mvarPData.Data(n & ":農地." & i, "備考"), dX(19), Y2, Ar(19), 3, nFsize, 2
                        Y2 = Y2 + nRowH / 2
                    Next
                    y = y + nRowH
                Next
                .DLine dX(0), y - 1, dX(Xcnt), y - 1
                Do Until y - 1 > nRows * (nRowH - 1) + SY
                    .DLine dX(0), y - 1, dX(Xcnt), y - 1
                    y = y + nRowH
                Loop
                
            Case "日置市"
                .Offset 0, 0
                .TextOut "農 地 法 第 ３ 条 申 請 ・ 許 可 名 簿", (dX(Xcnt) - dX(0)) / 2 + dX(0), 25, 12, 2, 0
                .DrawText "番号\n年度\n年", dX(0), 30, Ar(0), 4, nFsize, 2, 2, 20
                .DrawText "受\n付\n日", dX(1), 30, Ar(1), 4, nFsize, 2, 2, 20
                .DrawText "許可番号", dX(2), 30, Ar(2), 4, nFsize, 2, 2, 10
                .DrawText "許 可 日", dX(2), 40, Ar(2), 4, nFsize, 2, 2, 10
                .DrawText "譲 受 人 （借人）", dX(3) + 10, 30, Ar(3), 4, nFsize, 0, 2, 10
                .DrawText "（年齢）", dX(3), 30, Ar(3), 4, nFsize, 1, 1, 10
                .DrawText "譲 渡 人 （貸人）", dX(3) + 10, 40, Ar(3), 4, nFsize, 0, 2, 10
                .DrawText "（年齢）", dX(3), 40, Ar(3), 4, nFsize, 1, 1, 10
                .DrawText "経\n営\n面\n積", dX(4), 30, Ar(4), 4, nFsize, 2, 2, 20
                .DrawText "作\n\n\n物", dX(5), 30, Ar(5), 4, nFsize, 2, 2, 20
                .DrawText "申　　請　　地", dX(6), 30, Ar(6), 4, nFsize, 2, 2, 20
                .DrawText "地目", dX(7), 30, Ar(7), 4, nFsize, 2, 2, 20
                .DrawText "面積\n\n(u)", dX(8), 30, Ar(8), 4, nFsize, 2, 2, 20
                .DrawText "農\n用\n地", dX(9), 30, Ar(9), 4, nFsize, 2, 2, 20
                .DrawText "使\n用\n貸\n借\n・\n賃\n借", dX(10), 30, Ar(10), 2.7, 8, 2, 2, 20
                .DrawText "期間", dX(11), 30, Ar(11), 4, nFsize, 2, 2, 20
                .DrawText "権利関係", dX(12), 30, Ar(12), 4, nFsize, 2, 2, 20
                .DrawText "通\n作\n距\n離", dX(13), 30, Ar(13), 4, nFsize, 2, 2, 20
                .DrawText "印及び\n申請人\n日付", dX(14), 30, Ar(14), 4, nFsize, 2, 2, 20
                
                .LineBoxDX dX(0), 30, 20, nRows, 20, Ar
                .DLine dX(2), 40, dX(4), 40
                For n = 0 To nRows - 1
                    .DotLine dX(2), 60 + n * 20, dX(5), 60 + n * 20, vbBlack
                Next
                
                If nPage = 0 Then Exit Sub
            
                nStart = (nPage - 1) * nRows + 1
                nEnd = nStart + nRows - 1
                If nEnd > mvarPData.Count Then nEnd = mvarPData.Count
                y = 50 + 1
                For n = nStart To nEnd
                    If mvarPData.Data(n, "行区分") = 0 Then
                        .DrawText mvarPData.Data(n, "通年受付番号"), dX(0), y, Ar(0), 4, nFsize, 2, 2, 10
                        .DrawText mvarPData.Data(n, "受付補助記号") & mvarPData.Data(n, "受付番号"), dX(0), y + 10, Ar(0), 4, nFsize, 2, 2, 10
                        .DrawText SetDate(mvarPData.Data(n, "受付年月日")), dX(1) + 1, y, Ar(1), 5, nFsize, 0, 2, 20
                        .DrawText IIf(Val(mvarPData.Data(n, "許可番号")), mvarPData.Data(n, "許可番号"), ""), dX(2), y, Ar(2), 5, nFsize, 2, 2, 10
                        .DrawText IIf(IsDate(mvarPData.Data(n, "許可年月日")), Format(mvarPData.Data(n, "許可年月日"), "GEE.MM.DD"), ""), dX(2), y + 10, Ar(2), 5, nFsize, 2, 2, 10
                        .DrawText Left(mvarPData.Data(n, "譲受人住所"), 16), dX(3) + 1, y, Ar(3) - 1, 4, nFsize
                        .DrawText Left(mvarPData.Data(n, "譲受人氏名"), 10), dX(3) + 1, y + 4, Ar(3) - 1, 4, nFsize
                        .DrawText IIf(Val(mvarPData.Data(n, "譲受人年齢")), "( " & mvarPData.Data(n, "譲受人年齢") & " )", ""), dX(3), y + 4, Ar(3) - 1, 4, nFsize, 1
                        .DrawText Left(mvarPData.Data(n, "譲渡人住所"), 16), dX(3) + 1, y + 10, Ar(3) - 1, 4, nFsize
                        .DrawText Left(mvarPData.Data(n, "譲渡人氏名"), 10), dX(3) + 1, y + 15, Ar(3) - 1, 4, nFsize
                        .DrawText IIf(Val(mvarPData.Data(n, "譲渡人年齢")), "( " & mvarPData.Data(n, "譲渡人年齢") & " )", ""), dX(3), y + 15, Ar(3) - 1, 4, nFsize, 1
                        .DrawText FormatNumber(Val(mvarPData.Data(n, "譲受人経営面積")), 0), dX(4), y, Ar(4) - 1, 4, nFsize, 1, 2, 10
                        .DrawText FormatNumber(Val(mvarPData.Data(n, "譲渡人経営面積")), 0), dX(4), y + 10, Ar(4) - 1, 4, nFsize, 1, 2, 10
                        .DrawText mvarPData.Data(n, "作物"), dX(5), y, Ar(5), 4, nFsize, 2, 2, 20
                        Select Case mvarPData.Data(n, "法令")
                            Case 31, 33
                                Select Case mvarPData.Data(n, "権利種類")
                                    Case 1: .DrawText "賃", dX(10), y, Ar(10), 4, nFsize, 2, 2, 20
                                    Case 2: .DrawText "使", dX(10), y, Ar(10), 4, nFsize, 2, 2, 20
                                End Select
                        End Select
                        If mvarPData.Data(n, "永久") = "1" Then
                            .DrawText "永久", dX(11), y, Ar(11), 4, nFsize, 2, 2, 20
                        ElseIf Val(mvarPData.Data(n, "期間")) > 0 Then
                            .DrawText mvarPData.Data(n, "期間") & "年", dX(11), y, Ar(11), 4, nFsize, 2, 2, 20
                        End If
                        .DrawText Left(mvarPData.Data(n, "譲受事由"), 16), dX(12) + 1, y, Ar(12) - 1, 4, nFsize, 2, 2, 20
                        St1 = mvarPData.Data(n, "通作距離")
                        If Len(St1) > 0 Then
                            K = InStr(mvarPData.Data(n, "通作距離"), "〜")
                            If K = 0 Then
                                St2 = St1
                            Else
                                St2 = Left(St1, K) & "\n" & MID(St1, K + 1)
                            End If
                            .DrawText St2, dX(13), y, Ar(13), 4, nFsize, 2, 2, 20
                        End If
                    End If
                    Y2 = y
                    For i = 0 To mvarPData.SubCount(n & ":農地")
                        If pLen(mvarPData.Data(n & ":農地." & i, "土地所在")) > 28 Then
                            .TextOut mvarPData.Data(n & ":農地." & i, "土地所在"), dX(6) + 1, Y2, nFsize - 1
                        Else
                            .DrawText mvarPData.Data(n & ":農地." & i, "土地所在"), dX(6) + 1, Y2, Ar(6) - 1, 4, nFsize
                        End If
                        .DrawText Left(mvarPData.Data(n & ":農地." & i, "登記地目"), 2), dX(7), Y2, Ar(7), 4, nFsize, 2, 0
                        If mvarPData.Data(n & ":農地." & i, "農振区分") = 1 Then .DrawText "農用地", dX(9), Y2, Ar(9), 4, nFsize - 1, 2, 0
                        .DrawText FormatNumber(Val(mvarPData.Data(n & ":農地." & i, "面積")), 0), dX(8), Y2, Ar(8) - 1, 4, nFsize, 1, 0
                        Y2 = Y2 + 5
                    Next
                    y = y + 20
                Next
            End Select
        End With
    End Sub

    Private Function SetDate(vDate As Variant) As String
        Dim St As String
        Dim n As Long
        
        If IsDate(vDate) Then
            If CDate(vDate) > 0 Then
                St = Format(vDate, "GEE-MM/DD")
                n = InStr(St, "-")
                SetDate = Left(St, n - 1) & "\n " & MID(St, n + 1)
            Else
                SetDate = ""
            End If
        Else
            SetDate = ""
        End If
    End Function

    Private Sub 計算A(pDataA As Long, pDataB As Long)
        Dim n As Long
        
        n = 2
        Do While (n < pDataA And n < pDataB)
            If (pDataA Mod n = 0) And (pDataB Mod n = 0) Then
                pDataA = pDataA / n
                pDataB = pDataB / n
                Exit Do
            End If
            n = n + 1
        Loop
    End Sub

    Private Function pLen(pStr As String) As Long
        Dim n As Long
        Dim nAscCode As Integer
        Dim nCount As Long
                   
        nCount = 0
        For n = 1 To Len(pStr)
            nCount = nCount + 1
            nAscCode = Asc(MID(pStr, n, 1))
            If Len(Hex(nAscCode)) > 2 Then
                nCount = nCount + 1
            End If
        Next
        pLen = nCount
    End Function

End Class










Class CPrint受付交付簿4条
    Option Explicit
    Implements CPrintCls
    Private mvarPData As CPrintDatas
    Private mvarParent As CPrintFormSK
    Private mvarKey As String
    Private s総会番号 As String
    Private dt受付範囲 As Date
    

    Private Property Get CPrintCls_CanCancelPrint() As Boolean

    End Property

    Private Property Get CPrintCls_CanPrintNowPage() As Boolean: CPrintCls_CanPrintNowPage = True: End Property

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim RsT As ADBasicLIB2.RecordsetEx
        Dim RsA As ADBasicLIB2.RecordsetEx
        Dim St As String
        Dim St1 As String, St2 As String
        Dim n As Long, i As Long
        Dim K As Long, W As Long
        Dim m As Long
        Dim nArea(4) As Double
        Dim nLand(4) As Long
        Dim nAreaS(4) As Double
        Dim nLandS(4) As Long
        Dim sItem(4) As String
        Dim nFlag As Long
        Dim nRows As Long
        Dim b合計 As Boolean
        Dim nCount As Long
        Dim HMax As Long
        Dim n地目区分 As Long
        Dim n面積 As Double
        Dim n部分面積 As Double
        Dim n集計面積 As Double
        Dim n所有者 As Long
        Dim n分母(3) As Long
        Dim n分子(3) As Long
        Dim n筆 As Long
        Dim n支所番号 As Long
        Dim sSQL As String
        Dim n出力番号 As Long
        Dim s支所記号 As String
        Dim Ar As Variant
        
        Ar = Split(sParam, ";")
        s総会番号 = Ar(0)
        If UBound(Ar) = 1 Then
            dt受付範囲 = Ar(1)
        Else
            dt受付範囲 = Now - 365
        End If
        sItem(0) = "( 田 )": sItem(1) = "( 畑 )": sItem(2) = "( 他 )": sItem(3) = "( 計 )"
        mvarParent.表示倍率 = 0.75

        b合計 = False
        n支所番号 = 0
        n出力番号 = 0
        Select Case Fnc.s市町村名
            Case "姶良市", "霧島町":
                nRows = 7
                HMax = 4
                n支所番号 = SysAD.GetSettingData("農地基本台帳", "支所番号", 1)
                s支所記号 = SystemDB.DBProperty("支所記号")
            Case "南種子町":
                nRows = 18
                b合計 = True
                HMax = 1
                
            Case "日置市":
                nRows = 7
                HMax = 4
                n支所番号 = SysAD.GetSettingData("農地基本台帳", "支所番号", 1)
                s支所記号 = MID(SystemDB.DBProperty("支所記号"), n支所番号, 1)
            Case Else
                Exit Function
        End Select
            
        Set mvarPData = New CPrintDatas
        
        With mvarPData
            .Headers = _
            "行区分;" & _
            "受付番号;受付補助記号;通年受付番号;受付年月日;申請人住所;申請人氏名;共有持分;出力番号;" & _
            "転用目的;取下年月日;総会日;決定;進達年月日;許可番号;許可年月日;完了報告年月日;備考;" & _
            ">農地;土地所在;登記地目;現況地目;面積;農地区分;持分;所有者;所有者住所;一部;登記簿面積;"
    
            For K = 0 To 3
                nArea(K) = 0:  nLand(K) = 0
                nAreaS(K) = 0: nLandS(K) = 0
            Next
    
            sSQL = "SELECT * FROM [D_申請] WHERE ([法令]=40) AND ([総会番号]=" & Val(sParam) & ") AND ([受付年月日]>#" & Format(dt受付範囲, "YYYY/MM/DD") & "#)"
            If Fnc.s市町村名 = "姶良市" Then
                If n支所番号 = 1 Then
                    sSQL = sSQL & " ORDER BY [申請地大字ID],[申請地地番];"
                Else
                    sSQL = sSQL & " AND [支所番号]=" & n支所番号 & " ORDER BY [通年受付番号],[受付番号]"
                End If
            ElseIf Fnc.s市町村名 = "日置市" Then
                sSQL = sSQL & " AND [受付補助記号]='" & s支所記号 & "' ORDER BY [通年受付番号],[受付番号]"
            Else
                sSQL = sSQL & " ORDER BY [通年受付番号],[受付番号]"
            End If
            Set Rs = SystemDB.GetRecordsetEx(sSQL, 1, , "受付交付簿")
            Do Until Rs.EOF
                n = .NewLine
                .Data(n, "行区分") = 0
                .SetRsData n, "受付番号", Rs
                .SetRsData n, "通年受付番号", Rs
                .SetRsData n, "受付年月日", Rs
                .SetRsData n, "申請人住所", Rs, "住所A"
                n出力番号 = n出力番号 + 1
                .Data(n, "出力番号") = n出力番号

                If Fnc.s市町村名 = "姶良市" Then
                    .Data(n, "受付補助記号") = MID(s支所記号, Rs.V("支所番号"), 1)
                ElseIf Fnc.s市町村名 = "日置市" Then
                    .Data(n, "受付補助記号") = s支所記号
                Else
                    .SetRsDataList n, "受付補助記号", Rs
                End If
                
                If Not Rs.IsNull("代理人名") And Rs.Value("代理人名") <> "" Then
                    .SetRsData n, "申請人氏名", Rs, "代理人名"
                ElseIf Not Rs.IsNull("氏名A") And Rs.Value("氏名A") <> "" Then
                    .SetRsData n, "申請人氏名", Rs, "氏名A"
                ElseIf Not Rs.IsNull("申請者A") And Rs.Value("申請者A") <> 0 Then
                    Set RsT = SystemDB.GetRecordsetEx("SELECT 氏名 FROM [D:個人Info] WHERE [ID]=" & Rs.Value("申請者A"), 0, , "受付簿")
                    .SetRsData n, "申請人氏名", RsT, "氏名"
                    SystemDB.CloseRs RsT
                End If
                
                .SetRsData n, "転用目的", Rs, "申請理由A"
                .SetRsData n, "取下年月日", Rs
                .SetRsData n, "総会日", Rs
                .SetRsData n, "進達年月日", Rs
                .SetRsData n, "完了報告年月日", Rs
                .SetRsData n, "備考", Rs
                
                For K = 0 To 3
                    n分母(K) = 0
                    n分子(K) = 0
                Next
                n所有者 = 0
                n筆 = 0
                .Data(n, "共有持分") = 0
                            
                If Rs.IsNull("農地リスト") Or Len(Rs.Value("農地リスト")) < 4 Then
                    .Data(n, "行区分") = 0
                    .Data(n & ":農地." & 1, "土地所在") = ""
                    .Data(n & ":農地." & 1, "現況地目") = ""
                Else
                    If Rs.Value("状態") = 2 Then
                        .Data(n, "決定") = "許可"
                        .SetRsData n, "許可年月日", Rs
                        .SetRsData n, "許可番号", Rs
                    End If
                    If InStr(Rs.Value("農地リスト"), "転用農地") = 0 Then
                        St = Replace(Replace(Rs.Value("農地リスト"), "農地.", ""), ";", ",")
                        St1 = "V_農地"
                    Else
                        St = Replace(Replace(Rs.Value("農地リスト"), "転用農地.", ""), ";", ",")
                        St1 = "V_転用農地"
                    End If
                    If Fnc.s市町村名 = "姶良市" Then
                        Set RsT = SystemDB.GetRecordsetEx("SELECT [" & St1 & "].*,[V_地目].名称 AS [登記地目],[地目2].名称 AS [現況],[V_農委地目].名称 AS [農委地目],[D:個人Info].氏名 AS [所有者],[D:個人Info].住所 AS [所有者住所],[D_部分申請].部分面積 AS [部分面積T] FROM (((([" & St1 & "] LEFT JOIN [V_地目] ON [" & St1 & "].[登記簿地目]=[V_地目].ID) LEFT JOIN V_地目 AS 地目2 ON [" & St1 & "].[現況地目]=[地目2].ID) LEFT JOIN [V_農委地目] ON [" & St1 & "].[農委地目ID]=[V_農委地目].ID) LEFT JOIN [D:個人Info] ON [" & St1 & "].[管理人ID]=[D:個人Info].ID ) LEFT JOIN [D_部分申請] ON [" & St1 & "].ID = [D_部分申請].農地ID WHERE [" & St1 & "].[ID] IN (" & St & ") ORDER BY [" & St1 & "].[大字ID],[" & St1 & "].[小字ID],val(IIf(IsNull([地番]),0,IIf(InStr([地番],'-')=0,Val([地番]),val(Left([地番],InStr([地番],'-')-1)))) *1000 + Val(IIf(IsNull([地番]),0,IIf(InStr([地番],'-')=0,0,val(Mid([地番],InStr([地番],'-')+1))))))", 1, , "受付交付簿")
                    Else
                        Set RsT = SystemDB.GetRecordsetEx("SELECT [" & St1 & "].*,[V_地目].名称 AS [登記地目],[地目2].名称 AS [現況],[V_農委地目].名称 AS [農委地目],[D:個人Info].氏名 AS [所有者],[D:個人Info].住所 AS [所有者住所],[D_部分申請].部分面積 AS [部分面積T] FROM (((([" & St1 & "] LEFT JOIN [V_地目] ON [" & St1 & "].[登記簿地目]=[V_地目].ID) LEFT JOIN V_地目 AS 地目2 ON [" & St1 & "].[現況地目]=[地目2].ID) LEFT JOIN [V_農委地目] ON [" & St1 & "].[農委地目ID]=[V_農委地目].ID) LEFT JOIN [D:個人Info] ON [" & St1 & "].[管理人ID]=[D:個人Info].ID ) LEFT JOIN [D_部分申請] ON [" & St1 & "].ID = [D_部分申請].農地ID WHERE [" & St1 & "].[ID] IN (" & St & ") ORDER BY [" & St1 & "].[管理人ID],[" & St1 & "].[土地所在]", 1, , "受付交付簿")
                    End If
                    i = 0: nCount = 0
                    Do Until RsT.EOF
                        i = i + 1: nCount = nCount + 1
                        If nCount > HMax Then
                            n = .NewLine
                            .Data(n, "行区分") = 1
                            i = 1: nCount = 1
                        End If
                        .SetRsData n & ":農地." & i, "土地所在", RsT
                        .SetRsData n & ":農地." & i, "登記地目", RsT
                        .SetRsData n & ":農地." & i, "農地区分", RsT, "等級"
                        
                        If (RsT.IsNotNull("農委地目ID")) And (RsT.Value("農委地目ID") <> 0) And (Not RsT.IsNull("農委地目認定日")) And (RsT.Value("農委地目認定日") <> "0:00:00") Then
                            .SetRsData n & ":農地." & i, "現況地目", RsT, "農委地目"
                        Else
                            .SetRsData n & ":農地." & i, "現況地目", RsT, "現況"
                        End If
                        
                        If Not RsT.IsNull("共有持分分母") And RsT.Value("共有持分分母") <> 0 Then
                            .Data(n & ":農地." & i, "持分") = RsT.Value("共有持分分子") & "/" & RsT.Value("共有持分分母")
                            .Data(n, "共有持分") = 1
                        End If
                        If n所有者 <> RsT.Value("管理人ID") Then
                            .SetRsData n & ":農地." & i, "所有者", RsT
                            .SetRsData n & ":農地." & i, "所有者住所", RsT
                            n所有者 = RsT.Value("管理人ID")
                        End If
                    
                        n部分面積 = 0
                        If Not RsT.IsNull("部分面積T") Then n部分面積 = RsT.Value("部分面積T")
                            
                        n地目区分 = 2
                        n面積 = 0
                        If RsT.Value("田面積") <> 0 Then
                            n面積 = RsT.Value("田面積")
                            n地目区分 = 0
                        ElseIf RsT.Value("畑面積") <> 0 Then
                            n面積 = RsT.Value("畑面積")
                            n地目区分 = 1
                        End If
                        If n面積 = 0 Or Fnc.s市町村名 = "南種子町" Then n面積 = RsT.Value("登記簿面積")
                        
                        If n部分面積 = 0 Then
                            n集計面積 = n面積
                        Else
                            n集計面積 = n部分面積
                        End If
                        If n集計面積 >= 10 And Fnc.s市町村名 <> "南種子町" Then n集計面積 = Fix(n集計面積)
                        .Data(n & ":農地." & i, "面積") = n集計面積
                     
                       .Data(n & ":農地." & i, "一部") = 0
                        If RsT.IsNull("一部現況") Then
                        ElseIf RsT.Value("一部現況") > 0 Then
                            If Fnc.s市町村名 = "南種子町" Then
                                .Data(n & ":農地." & i, "登記簿面積") = Fnc.NullCast(RsT.Value("登記簿面積"), 0)
                            Else
                                .Data(n & ":農地." & i, "登記簿面積") = Fix(Fnc.NullCast(RsT.Value("登記簿面積"), 0))
                            End If
                            .Data(n & ":農地." & i, "一部") = 1
                        End If
                     
                        If Not RsT.IsNull("共有持分分母") And RsT.Value("共有持分分母") <> 0 Then
                            If n分子(n地目区分) = 0 And n分母(n地目区分) = 0 Then
                                n分子(n地目区分) = RsT.Value("共有持分分子")
                                n分母(n地目区分) = RsT.Value("共有持分分母")
                            Else
                                n分子(n地目区分) = n分子(n地目区分) * RsT.Value("共有持分分母")
                                n分子(n地目区分) = n分子(n地目区分) + RsT.Value("共有持分分子") * n分母(n地目区分)
                                n分母(n地目区分) = n分母(n地目区分) * RsT.Value("共有持分分母")
                            End If
                        Else
                            If n分子(n地目区分) = 0 And n分母(n地目区分) = 0 Then
                                n分子(n地目区分) = 1
                                n分母(n地目区分) = 1
                            Else
                                n分子(n地目区分) = n分子(n地目区分) + n分母(n地目区分)
                            End If
                        End If
   
                        nAreaS(n地目区分) = nAreaS(n地目区分) + n集計面積
    '                        nLandS(n地目区分) = nLandS(n地目区分) + 1
                        nArea(n地目区分) = nArea(n地目区分) + n集計面積
    '                        nLand(n地目区分) = nLand(n地目区分) + 1
                        n筆 = n筆 + 1
                        RsT.MoveNext
                    Loop
                    SystemDB.CloseRs RsT
                    If i = 0 Then
                        .Data(n, "行区分") = 0
                        .Data(n & ":農地." & 1, "土地所在") = ""
                        .Data(n & ":農地." & 1, "現況地目") = ""
                    End If
                    For K = 0 To 2
                        If nAreaS(K) > 0 Then
                            nLandS(K) = n分子(K) \ n分母(K)
                            n分子(K) = n分子(K) Mod n分母(K)
                        End If
                        nLand(K) = nLand(K) + nLandS(K)
                    Next
                End If
                Rs.MoveNext
                n分子(3) = n分子(0) + n分子(1) + n分子(2)
                nAreaS(3) = nAreaS(0) + nAreaS(1) + nAreaS(2)
                nLandS(3) = nLandS(0) + nLandS(1) + nLandS(2)
                If b合計 Then
                    If n筆 > 1 Then
                        St = "": St1 = "": St2 = "": nFlag = 0
                        i = 0
                        For K = 0 To 3
                            If nLandS(K) > 0 Or n分子(K) <> 0 Then
                                i = i + 1
                                If i > 2 Then
                                    n = .NewLine
                                    If nFlag = 1 Then
                                        .Data(n, "行区分") = 1
                                    Else
                                        .Data(n, "行区分") = 2
                                    End If
                                    .Data(n & ":農地." & 1, "現況地目") = "88888"
                                    .Data(n & ":農地." & 1, "土地所在") = Left(St, Len(St) - 2)
                                    .Data(n & ":農地." & 1, "登記地目") = Left(St1, Len(St1) - 2)
                                    .Data(n & ":農地." & 1, "面積") = Left(St2, Len(St2) - 2)
                                    i = 1
                                    St = "": St1 = "": St2 = ""
                                    nFlag = 1
                                End If
                                St = St & sItem(K) & "\n"
'                                St1 = St1 & FormatNumber(nLandS(K), 0) & " 筆\n"
                                If nLandS(K) > 0 Or n分子(K) <> 0 Then
                                    St1 = St1 & Format(nLandS(K), "#")
                                    If n分子(K) <> 0 And K < 3 Then
                                        If nLandS(K) > 0 Then St1 = St1 & "・"
                                        計算A n分子(K), n分母(K)
                                        St1 = St1 & n分子(K) & "/" & n分母(K)
                                    End If
                                    St1 = St1 & " 筆\n"
                                End If
                                St2 = St2 & IIf(Fnc.s市町村名 = "南種子町", pFormatN(CCur(nAreaS(K))), FormatNumber(nAreaS(K), 0)) & "\n"
                            End If
                        Next
                        If i > 0 Then
                            n = .NewLine
                            If nFlag = 1 Then
                                .Data(n, "行区分") = 1
                            Else
                                .Data(n, "行区分") = 2
                            End If
                            .Data(n & ":農地." & 1, "現況地目") = "88888"
                            .Data(n & ":農地." & 1, "土地所在") = Left(St, Len(St) - 2)
                            .Data(n & ":農地." & 1, "登記地目") = Left(St1, Len(St1) - 2)
                            .Data(n & ":農地." & 1, "面積") = Left(St2, Len(St2) - 2)
                        End If
                    End If
                End If
                For K = 0 To 3
                    nAreaS(K) = 0: nLandS(K) = 0
                Next
            Loop
            SystemDB.CloseRs Rs
            nArea(3) = nArea(0) + nArea(1) + nArea(2)
            nLand(3) = nLand(0) + nLand(1) + nLand(2)
            
            ' 合計行
            If b合計 Then
                If nArea(3) > 0 Then
                    St = "": St1 = "": St2 = "": nFlag = 0
                    i = 0: W = 0: m = 0
                    For K = 0 To 3
                        If nArea(K) > 0 Then m = m + 1
                    Next
                    
                    If .Count > nRows Then
                        n = .Count Mod nRows
                    Else
                        n = .Count
                    End If
                    i = m / 2 + IIf(m Mod 2, 1, 0)
                    
                    If (n + i) > nRows Then
                        n = .Count
                        Do While n < nRows
                            n = .NewLine
                            .Data(n, "行区分") = 0
                            .Data(n & ":農地." & 1, "土地所在") = ""
                            n = n + 1
                        Loop
                    End If
                    i = 0
                    For K = 0 To 3
                        If nArea(K) > 0 Then
                            i = i + 1
                            If i > 2 Then
                                n = .NewLine
                                If nFlag = 1 Then
                                    .Data(n, "行区分") = 1
                                Else
                                    .Data(n, "行区分") = 0
                                End If
                                W = W + 1
                                .Data(n, "受付番号") = W
                                .Data(n, "通年受付番号") = m
                                .Data(n & ":農地." & 1, "現況地目") = "99999"
                                .Data(n & ":農地." & 1, "土地所在") = Left(St, Len(St) - 2)
                                .Data(n & ":農地." & 1, "登記地目") = Left(St1, Len(St1) - 2)
                                .Data(n & ":農地." & 1, "面積") = Left(St2, Len(St2) - 2)
                                i = 1
                                St = "": St1 = "": St2 = ""
                                nFlag = 1
                            End If
                            St = St & sItem(K) & "\n"
                            St1 = St1 & Format(nLand(K), "#") & " 筆\n"
                            St2 = St2 & IIf(Fnc.s市町村名 = "南種子町", pFormatN(CCur(nArea(K))), FormatNumber(nArea(K), 0)) & "\n"
                        End If
                    Next
                    If i > 0 Then
                        n = .NewLine
                        If nFlag = 1 Then
                            .Data(n, "行区分") = 1
                        Else
                            .Data(n, "行区分") = 0
                        End If
                        W = W + 1
                        .Data(n, "受付番号") = W
                        .Data(n, "通年受付番号") = m
                        .Data(n & ":農地." & 1, "現況地目") = "99999"
                        .Data(n & ":農地." & 1, "土地所在") = Left(St, Len(St) - 2)
                        .Data(n & ":農地." & 1, "登記地目") = Left(St1, Len(St1) - 2)
                        .Data(n & ":農地." & 1, "面積") = Left(St2, Len(St2) - 2)
                    End If
                End If
            End If
            
            ' ページ設定
            n = .Count
            mvarParent.MaxPage = n \ nRows + IIf((n Mod nRows) > 0, 1, 0)
            mvarParent.Page = 1
        End With
    End Function
    
    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property

    Private Property Let CPrintCls_Key(ByVal RHS As String)

    End Property

    Private Property Get CPrintCls_Key() As String: CPrintCls_Key = mvarKey: End Property
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants: CPrintCls_Orientation = vbPRORLandscape: End Property

    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&)
        mvarParent.Page = nNewPage
        CPrintCls_Repaint
    End Sub
    
    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Set CPrintCls_Parent(RHS As ADBasicLIB2.CPrintFormSK): Set mvarParent = RHS: End Property

    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        mvarParent.PrintPage = 1
        mvarParent.PrintMaxPage = mvarParent.MaxPage
            
        If bNowPage Then
            PrintSub mvarParent.Page
            mvarParent.EndDoc
        Else
            Do Until mvarParent.PrintPage > mvarParent.PrintMaxPage
                PrintSub mvarParent.PrintPage
                mvarParent.NewPage
            Loop
            mvarParent.EndDoc
        End If
    
    End Sub
    Private Sub CPrintCls_Repaint(): PrintSub mvarParent.Page: End Sub
    Private Sub CPrintCls_TargetChange(sKey As String)

    End Sub

    Private Sub PrintSub(nPage As Long)
        Dim nFsize As Integer
        Dim Ar As Variant
        Dim Cm As Variant
        Dim n As Long, i As Long
        Dim y As Single, Y2 As Single
        Dim dX(25) As Single, hX(25) As Single
        Dim Xcnt As Long, SX As Long
        Dim SY As Single
        Dim nStart As Long, nEnd As Long
        Dim nRows As Long, nRowH As Long
        Dim nWork As Double
        Dim St1 As String, St2 As String
        Dim K As Long
        
        Select Case Fnc.s市町村名
        Case "姶良市", "霧島町":
            nFsize = 10
            nRows = 7
            SX = 20
            Ar = GetArray(12, 20, 56, 48, 12, 22, 24, 20, 20, 20)

        Case "南種子町"
            nFsize = 7
            nRows = 18
            nRowH = 8
            SY = 42
            SX = 10
            Ar = GetArray(10, 10, 12, 24, 18, 37, 7, 11, 15, 17, 11, 11, 10, 11, 11, 11, 16, 10, 12, 11)
            
        Case "日置市"
            nFsize = 10
            nRows = 7
            SX = 14
            Ar = GetArray(12, 20, 20, 54, 58, 12, 18, 32, 24, 16)
        Case Else
            Exit Sub
        End Select
        
        dX(0) = SX: hX(0) = dX(0) + Ar(0) / 2
        For i = 0 To UBound(Ar)
            dX(i + 1) = dX(i) + Ar(i)
            If i < UBound(Ar) Then hX(i + 1) = dX(i + 1) + Ar(i + 1) / 2
        Next
        Xcnt = UBound(Ar) + 1

        With mvarParent
            .ClearScreen
            Select Case Fnc.s市町村名
            Case "姶良市", "霧島町":
                .Offset 0, 0
                .TextOut "農 地 法 第 ４ 条 受 付 ・ 交 付 簿", (dX(Xcnt) - dX(0)) / 2 + dX(0), 25, 12, 2, 0
                .DrawText "受付\n番号", dX(0), 30, Ar(0), 4, nFsize, 2, 2, 20
                .DrawText "受付日", dX(1), 30, Ar(1), 4, nFsize, 2, 2, 20
                .DrawText "申　請　人　住　所", dX(2), 30, Ar(2), 4, nFsize, 2, 2, 10
                .DrawText "申　請　人　氏　名", dX(2), 40, Ar(2), 4, nFsize, 2, 2, 10
                .DrawText "土 地 の 表 示", dX(3), 30, Ar(3), 4, nFsize, 2, 2, 20
                .DrawText "地目", dX(4), 30, Ar(4), 4, nFsize, 2, 2, 20
                .DrawText "面積\n(u)", dX(5), 30, Ar(5), 4, nFsize, 2, 2, 20
                .DrawText "転用目的", dX(6), 30, Ar(6), 4, nFsize, 2, 2, 20
                .DrawText "許可番号", dX(7), 30, Ar(7), 4, nFsize, 2, 2, 10
                .DrawText "許 可 日", dX(7), 40, Ar(7), 4, nFsize, 2, 2, 10
                .DrawText "申請人\n受領印", dX(8), 30, Ar(8), 4, nFsize, 2, 2, 20
                .DrawText "備　考", dX(9), 30, Ar(9), 4, nFsize, 2, 2, 15
                .DrawText "受領日", dX(9), 45, Ar(9), 4, nFsize, 2, 2, 5
                
                .LineBoxDX dX(0), 30, 20, nRows, 20, Ar
                .DLine dX(2), 40, dX(3), 40
                .DLine dX(7), 40, dX(8), 40
                .DLine dX(9), 44, dX(10), 44
                For n = 1 To nRows
                    .DotLine dX(2), 40 + n * 20, dX(3), 40 + n * 20, vbBlack
                    .DotLine dX(7), 40 + n * 20, dX(8), 40 + n * 20, vbBlack
                    .DotLine dX(9), 44 + n * 20, dX(10), 44 + n * 20, vbBlack
                Next
                
                If nPage = 0 Then Exit Sub
            
                nStart = (nPage - 1) * nRows + 1
                nEnd = nStart + nRows - 1
                If nEnd > mvarPData.Count Then nEnd = mvarPData.Count
                y = 50 + 1
                For n = nStart To nEnd
                    If mvarPData.Data(n, "行区分") = 0 Then
                        .DrawText mvarPData.Data(n, "出力番号"), dX(0), y, Ar(0), 4, nFsize, 2, 2, 10
                        .DrawText mvarPData.Data(n, "受付補助記号"), dX(0), y + 10, Ar(0), 4, nFsize, 2, 2, 10
                        .DrawText Format(mvarPData.Data(n, "受付年月日"), "GEE.MM.DD"), dX(1), y, Ar(1), 5, nFsize, 2, 2, 20
                        .DrawText Fnc.GetShortAddress(mvarPData.Data(n, "申請人住所"), SystemDB.DBProperty("都道府県名"), SystemDB.DBProperty("郡部"), , , True), dX(2) + 1, y, Ar(2) - 1, 4, nFsize, 0, 2, 10
                        .DrawText mvarPData.Data(n, "申請人氏名"), dX(2) + 1, y + 10, Ar(2) - 1, 4, nFsize, 0, 2, 10
                        .DrawText Left(mvarPData.Data(n, "転用目的"), 16), dX(6) + 1, y, Ar(6) - 1, 4, nFsize
    '                        .DrawText IIf(Val(mvarPData.Data(n, "許可番号")), mvarPData.Data(n, "許可番号"), ""), dX(7), Y + 5, Ar(7), 5, nFsize, 2, 2
    '                        .DrawText IIf(IsDate(mvarPData.Data(n, "許可年月日")), Format(mvarPData.Data(n, "許可年月日"), "GEE.MM.DD"), ""), dX(7), Y + 15, Ar(7), 5, nFsize, 2, 2
    '                        .DrawText Left(mvarPData.Data(n, "備考"), 20), dX(9) + 1, y, Ar(9) - 1, 5, nFsize
                    End If
                    Y2 = y
                    For i = 0 To mvarPData.SubCount(n & ":農地")
                        If pLen(mvarPData.Data(n & ":農地." & i, "土地所在")) > 26 Then
                            .DrawText mvarPData.Data(n & ":農地." & i, "土地所在"), dX(3) + 1, Y2 - 1, Ar(3) - 1, 3, nFsize - 1
                        Else
                            .DrawText mvarPData.Data(n & ":農地." & i, "土地所在"), dX(3) + 1, Y2, Ar(3) - 1, 4, nFsize
                        End If
                    

                        .DrawText Left(mvarPData.Data(n & ":農地." & i, "登記地目"), 2), dX(4), Y2, Ar(4), 4, nFsize, 2, 0
                        If Val(mvarPData.Data(n & ":農地." & i, "一部")) = 1 Then
                            .DrawText FormatNumber(Val(mvarPData.Data(n & ":農地." & i, "面積")), 2), dX(5), Y2 - 1, Ar(5) - 1, 3, nFsize - 1, 1
                            .TextOut "(" & FormatNumber(Val(mvarPData.Data(n & ":農地." & i, "登記簿面積")), 2) & "の内)", dX(6), Y2 + 2, nFsize - 2, 1
                        Else
                            .DrawText FormatNumber(Val(mvarPData.Data(n & ":農地." & i, "面積")), 2), dX(5), Y2, Ar(5) - 1, 4, nFsize, 1, 0
                        End If
                        Y2 = Y2 + 5
                    Next
                    y = y + 20
                Next

            Case "南種子町"
                .Offset 0, 10
                .TextOut "第 " & s総会番号 & " 回定例総会付議案件　農地法第４条　申請書受付・交付簿", dX(0) + 5, 17, 10, 0, 0
                .TextOut "会　長", dX(8) + 10.5, 14, nFsize, 2, 2
                .TextOut "事務局長", dX(8) + 31.5, 14, nFsize, 2, 2
                .TextOut "係　長", dX(8) + 52.5, 14, nFsize, 2, 2
                .TextOut "係", dX(8) + 79, 14, nFsize, 2, 2
                .TextOut Fnc.s市町村名 & "農業委員会", dX(Xcnt) - 2, 29.5, 9, 1, 1
    
                .DrawText "整理番号\n(月通)", dX(0), 33.5, Ar(0), 4, 6, 2
                .DrawText "受付番号\n(年度通)", dX(1), 35.5, Ar(1), 3, 6, 2
                .TextOut "受　　付", (dX(1) + dX(3)) / 2, 32, nFsize, 2, 2
                .TextOut "年月日", hX(2), 38, nFsize, 2, 2
                .TextOut "申　請　人", (dX(3) + dX(5)) / 2, 32, nFsize, 2, 2
                .TextOut "住　　所", hX(3), 38, nFsize, 2, 2
                .TextOut "氏　名", hX(4), 38, nFsize, 2, 2
                .TextOut "申　　請　　地", (dX(5) + dX(9)) / 2, 32, nFsize, 2, 2
                .TextOut "所　　　在", hX(5), 38, nFsize, 2, 2
                .TextOut "持分", hX(6), 38, nFsize, 2, 2
                .TextOut "登記", hX(7), 36, nFsize, 2, 2
                .TextOut "現況", hX(7), 40, nFsize, 2, 2
                .TextOut "地積", hX(8), 36.5, nFsize, 2, 2
                .TextOut "(u)", hX(8), 39.5, nFsize, 2, 2
                .TextOut "転用目的", hX(9), 36, nFsize, 2, 2
                .TextOut "処　　　理　　　状　　　況", (dX(10) + dX(20)) / 2, 32, nFsize, 2, 2
                .TextOut "取下げ", hX(10), 36, nFsize, 2, 2
                .TextOut "年月日", hX(10), 40, nFsize, 2, 2
                .TextOut "町委員会", hX(11), 36, nFsize - 1, 2, 2
                .TextOut "年月日", hX(11), 40, nFsize, 2, 2
                .TextOut "決定", hX(12), 38, nFsize, 2, 2
                .TextOut "県送付", hX(13), 36, nFsize, 2, 2
                .TextOut "年月日", hX(13), 40, nFsize, 2, 2
                .TextOut "県許可", hX(14), 35, nFsize - 2, 2
                .TextOut "年月日", hX(14), 37.5, nFsize - 2, 2
                .TextOut "番　号", hX(14), 40, nFsize - 2, 2
                .TextOut "交　　付", (dX(15) + dX(18)) / 2, 36, nFsize, 2, 2
                .TextOut "年月日", hX(15), 40, nFsize, 2, 2
                .TextOut "受領者氏名", hX(16), 40, nFsize, 2, 2
                .TextOut "印", hX(17), 40, nFsize, 2, 2
                .TextOut "完了報告", hX(18), 36, nFsize - 1, 2, 2
                .TextOut "年月日", hX(18), 40, nFsize, 2, 2
                .TextOut "備　考", hX(19), 36, nFsize, 2, 2
                .TextOut "(対価)", hX(19), 40, nFsize, 2, 2
                
                ' 印
                .DLine dX(8), 12, dX(16), 12
                .DLine dX(8), 16, dX(16), 16
                .DLine dX(8), 12, dX(8), 30
                .DLine dX(8) + 21, 12, dX(8) + 21, 30
                .DLine dX(8) + 42, 12, dX(8) + 42, 30
                .DLine dX(8) + 63, 12, dX(8) + 63, 30
                .DLine dX(16), 12, dX(16), 30
            
                ' 見出し／横線
                .DLine dX(0), 30, dX(Xcnt), 30
                .DLine dX(1), 34, dX(9), 34
                .DLine dX(10), 34, dX(Xcnt), 34
                .DLine dX(7), 38, dX(8), 38
                .DLine dX(14), 40, dX(15), 40
                .DLine dX(15), 38, dX(18), 38
                
                ' 見出し／縦線
                For n = 0 To Xcnt
                    Select Case n
                        Case 0, 1, 3, 5, 9, 10, 20
                            .DLine dX(n), 30, dX(n), SY
                        Case 16, 17
                            .DLine dX(n), 38, dX(n), SY
                        Case Else
                            .DLine dX(n), 34, dX(n), SY
                    End Select
                Next
                .LineBoxDX dX(0), SY, 0, 1, nRows * nRowH, Ar
                
                If nPage = 0 Then Exit Sub
'                If (Not IsNull(mvarPData.Data(1, "総会日"))) And (mvarPData.Data(1, "総会日") <> "0:00:00") Then
'                    .TextOut Format(mvarPData.Data(1, "総会日"), "GEE/MM/DD") & " 開催", dX(Xcnt) - 2, 29, 12, 1, 1
'                End If

                nStart = (nPage - 1) * nRows + 1
                nEnd = nStart + nRows - 1
                If nEnd > mvarPData.Count Then nEnd = mvarPData.Count
                y = SY
                For n = nStart To nEnd
                    If mvarPData.Data(n, "行区分") = 0 Then
                        If n <> nStart Then .DLine dX(0), y, dX(Xcnt), y
                        If mvarPData.Data(n & ":農地." & 0, "現況地目") <> "99999" Then
                            .TextOut mvarPData.Data(n, "受付番号"), dX(1) - 2, y + 4, nFsize, 1, 2
                            .TextOut mvarPData.Data(n, "通年受付番号"), dX(2) - 2, y + 4, nFsize, 1, 2
                        End If
                        .DrawText SetDate(mvarPData.Data(n, "受付年月日")), dX(2) + 1, y + 1, Ar(2), 3, nFsize, 0, 2
                        .DrawText Left(mvarPData.Data(n, "申請人住所"), 16), dX(3) + 1, y + 2, Ar(3) - 1, 3, nFsize, 0, 2
                        .DrawText Left(mvarPData.Data(n, "申請人氏名"), 12), dX(4) + 1, y + 2, Ar(4) - 1, 3, nFsize, 0, 2
                    
                        .DrawText Left(mvarPData.Data(n, "転用目的"), 12), dX(9), y + 2, Ar(9), 3, nFsize, 2, 2
                        .DrawText SetDate(mvarPData.Data(n, "取下年月日")), dX(10) + 1, y + 2, Ar(10), 3, nFsize, 0, 2
                        .DrawText SetDate(mvarPData.Data(n, "総会日")), dX(11) + 1, y + 2, Ar(11), 3, nFsize, 0, 2
                        .DrawText mvarPData.Data(n, "決定"), dX(12), y + 2, Ar(12), 3, nFsize, 2, 2
    '                        .DrawText SetDate(mvarPData.Data(n, "進達年月日")), dX(13) + 1, Y + 4, Ar(13), 3, nFsize, 0, 2
    '                        .DrawText SetDate(mvarPData.Data(n, "許可年月日")), dX(14) + 1, Y + 4, Ar(14), 3, nFsize, 0, 2
    '                        .DrawText SetDate(mvarPData.Data(n, "完了報告年月日")), dX(18) + 1, Y + 4, Ar(18), 3, nFsize, 0, 2
                    ElseIf mvarPData.Data(n, "行区分") = 1 Then
                        If mvarPData.Data(n & ":農地." & 0, "現況地目") <> "99999" And mvarPData.Data(n & ":農地." & 0, "現況地目") <> "88888" Then
                            .DLine dX(5), y, dX(9), y
                        End If
                    ElseIf mvarPData.Data(n, "行区分") = 2 Then
                        .DLine dX(5), y, dX(9), y
                    Else
                        .DLine dX(0), y, dX(Xcnt), y
                    End If

                    Y2 = y
                    If mvarPData.Data(n & ":農地." & 0, "現況地目") = "99999" Then
                        If (Val(mvarPData.Data(n, "通年受付番号")) > 2) And (Val(mvarPData.Data(n, "受付番号")) = 1) Then
                            Y2 = (nRows - 2) * nRowH + SY
                            Do Until y > Y2
                                .DLine dX(0), y, dX(Xcnt), y
                                y = y + nRowH
                            Loop
                            .DLine dX(0), Y2, dX(Xcnt), Y2
                        Else
                            Y2 = (nRows - 1) * nRowH + SY
                        End If
                    End If
                    For i = 0 To mvarPData.SubCount(n & ":農地")
                        If mvarPData.Data(n & ":農地." & i, "現況地目") = "88888" Then
                            .DrawText mvarPData.Data(n & ":農地." & i, "土地所在"), dX(5) + 15, Y2 + 1, Ar(5), 4, nFsize
                            .DrawText mvarPData.Data(n & ":農地." & i, "登記地目"), dX(5), Y2 + 1, Ar(5) - 1, 4, nFsize, 1, 0
                            .DrawText mvarPData.Data(n & ":農地." & i, "面積"), dX(8), Y2 + 1, Ar(8) - 1, 4, nFsize, 1, 0
                         ElseIf mvarPData.Data(n & ":農地." & i, "現況地目") = "99999" Then
                            If Val(mvarPData.Data(n, "受付番号")) = 1 Then
                                .DrawText "月合計", dX(5) + 2, Y2 + 1, Ar(5), 3, nFsize
                            End If
                            .DrawText mvarPData.Data(n & ":農地." & i, "土地所在"), dX(5) + 15, Y2 + 1, Ar(5), 4, nFsize
                            .DrawText mvarPData.Data(n & ":農地." & i, "登記地目"), dX(5), Y2 + 1, Ar(5) - 1, 4, nFsize, 1, 0
                            .DrawText mvarPData.Data(n & ":農地." & i, "面積"), dX(8), Y2 + 1, Ar(8) - 1, 4, nFsize, 1, 0
                            If Val(mvarPData.Data(n, "受付番号")) = 2 Then Exit Sub
                        Else
                            .DrawText mvarPData.Data(n & ":農地." & i, "土地所在"), dX(5) + 1, Y2 + 4, Ar(5) - 1, 3, nFsize, 0, 2
                            .DrawText mvarPData.Data(n & ":農地." & i, "持分"), dX(6), Y2 + 4, Ar(6), 3, nFsize, 2, 2
                            St1 = mvarPData.Data(n & ":農地." & i, "登記地目")
                            St2 = mvarPData.Data(n & ":農地." & i, "現況地目")
                            If StrComp(St1, St2) Then
                                .DrawText Left(St1, 3), dX(7), Y2 + 2, Ar(7), 3, nFsize, 2, 2
                                .DrawText Left(St2, 3), dX(7), Y2 + 6, Ar(7), 3, nFsize, 2, 2
                                .DLine dX(7), Y2 + 4, dX(8), Y2 + 4
                            Else
                                .DrawText St1, dX(7), Y2 + 4, Ar(7), 3, nFsize, 2, 2
                            End If
                            If Val(mvarPData.Data(n & ":農地." & i, "面積")) <> 0 Then
                                .TextOut pFormatN(Val(mvarPData.Data(n & ":農地." & i, "面積"))), dX(9) - 1, Y2 + 4, nFsize, 1, 2
                            End If
                        End If
                        Y2 = Y2 + nRowH
                    Next
                    St1 = ""
                    y = y + nRowH
                Next
                Do Until y > nRows * nRowH + SY
                    .DLine dX(0), y, dX(Xcnt), y
                    y = y + nRowH
                Loop
               
            Case "日置市"
                .Offset 0, 0
                .TextOut "農 地 法 第 ４ 条 申 請 ・ 許 可 名 簿", .PaperWidth / 2, 25, 12, 2, 0
                .DrawText "番号\n年度\n年", dX(0), 30, Ar(0), 4, nFsize, 2, 2, 20
                .DrawText "受付日", dX(1), 30, Ar(1), 4, nFsize, 2, 2, 20
                .DrawText "許可番号", dX(2), 30, Ar(2), 4, nFsize, 2, 2, 10
                .DrawText "許 可 日", dX(2), 40, Ar(2), 4, nFsize, 2, 2, 10
                .DrawText "申　請　人　住　所", dX(3) + 10, 30, Ar(3), 4, nFsize, 0, 2, 10
                .DrawText "申　請　人　氏　名", dX(3) + 10, 40, Ar(3), 4, nFsize, 0, 2, 10
                .DrawText "申　　請　　地", dX(4), 30, Ar(4), 4, nFsize, 2, 2, 20
                .DrawText "地 目", dX(5), 30, Ar(5), 4, nFsize, 2, 2, 20
                .DrawText "面積(u)", dX(6), 30, Ar(6), 4, nFsize, 2, 2, 20
                .DrawText "農　地　区　分", dX(7), 30, Ar(7), 4, nFsize, 2, 2, 20
                .DrawText "転用目的", dX(8), 30, Ar(8), 4, nFsize, 2, 2, 20
                .DrawText "印\n申請人", dX(9), 30, Ar(9), 4, nFsize, 2, 2, 20
                
                .LineBoxDX dX(0), 30, 20, nRows, 20, Ar
                For n = 0 To nRows
                    .DotLine dX(2), 40 + n * 20, dX(4), 40 + n * 20, vbBlack
                Next
                
                If nPage = 0 Then Exit Sub
            
                nStart = (nPage - 1) * nRows + 1
                nEnd = nStart + nRows - 1
                If nEnd > mvarPData.Count Then nEnd = mvarPData.Count
                y = 50 + 1
                For n = nStart To nEnd
                    If mvarPData.Data(n, "行区分") = 0 Then
                        .DrawText mvarPData.Data(n, "通年受付番号"), dX(0), y, Ar(0), 4, nFsize, 2, 2, 10
                        .DrawText mvarPData.Data(n, "受付補助記号") & mvarPData.Data(n, "受付番号"), dX(0), y + 10, Ar(0), 4, nFsize, 2, 2, 10
                        .DrawText Format(mvarPData.Data(n, "受付年月日"), "GEE.MM.DD"), dX(1), y, Ar(1), 5, nFsize, 2, 2, 20
                        .DrawText IIf(Val(mvarPData.Data(n, "許可番号")), mvarPData.Data(n, "許可番号"), ""), dX(2), y, Ar(2), 5, nFsize, 2, 2, 10
                        .DrawText IIf(IsDate(mvarPData.Data(n, "許可年月日")), Format(mvarPData.Data(n, "許可年月日"), "GEE.MM.DD"), ""), dX(2), y + 10, Ar(2), 5, nFsize, 2, 2, 10
                        .DrawText mvarPData.Data(n, "申請人住所"), dX(3) + 1, y, Ar(3) - 1, 4, nFsize, 0, 2, 10
                        .DrawText mvarPData.Data(n, "申請人氏名"), dX(3) + 1, y + 10, Ar(3) - 1, 4, nFsize, 0, 2, 10
                        .DrawText Left(mvarPData.Data(n, "転用目的"), 16), dX(8) + 1, y, Ar(8) - 1, 4, nFsize, 2, 2, 20
                    End If
                    Y2 = y
                    For i = 0 To mvarPData.SubCount(n & ":農地")
                        .DrawText mvarPData.Data(n & ":農地." & i, "土地所在"), dX(4) + 1, Y2, Ar(4) - 1, 4, nFsize, 0, 0
                        .DrawText Left(mvarPData.Data(n & ":農地." & i, "登記地目"), 2), dX(5), Y2, Ar(5), 4, nFsize, 2, 0
                        .DrawText FormatNumber(Val(mvarPData.Data(n & ":農地." & i, "面積")), 0), dX(6), Y2, Ar(6) - 1, 4, nFsize, 1, 0
                        .DrawText Left(mvarPData.Data(n & ":農地." & i, "農地区分"), 9), dX(7) + 1, Y2, Ar(7) - 1, 4, nFsize, 0, 0
                        Y2 = Y2 + 5
                    Next
                    y = y + 20
                Next
            
            End Select
        End With

    End Sub

    Private Function SetDate(vDate As Variant) As String
        Dim St As String
        Dim n As Long
        
        If IsDate(vDate) Then
            If CDate(vDate) > 0 Then
                St = Format(vDate, "GEE-MM/DD")
                n = InStr(St, "-")
                SetDate = Left(St, n - 1) & "\n " & MID(St, n + 1)
            Else
                SetDate = ""
            End If
        Else
            SetDate = ""
        End If
    End Function

    Private Sub 計算A(pDataA As Long, pDataB As Long)
        Dim n As Long
        
        n = 2
        Do While (n < pDataA And n < pDataB)
            If (pDataA Mod n = 0) And (pDataB Mod n = 0) Then
                pDataA = pDataA / n
                pDataB = pDataB / n
                Exit Do
            End If
            n = n + 1
        Loop
    End Sub

    Private Function pLen(pStr As String) As Long
        Dim n As Long
        Dim nAscCode As Integer
        Dim nCount As Long
                   
        nCount = 0
        For n = 1 To Len(pStr)
            nCount = nCount + 1
            nAscCode = Asc(MID(pStr, n, 1))
            If Len(Hex(nAscCode)) > 2 Then
                nCount = nCount + 1
            End If
        Next
        pLen = nCount
    End Function

End Class










Class CPrint受付交付簿5条
    Option Explicit
    Implements CPrintCls
    Private mvarPData As CPrintDatas
    Private mvarParent As CPrintFormSK
    Private mvarKey As String
    Private s総会番号 As String
    Private dt受付範囲 As Date
    Private p所有者A As New CDataDictionary
    Private s市町村名 As String

    Private Property Get CPrintCls_CanCancelPrint() As Boolean

    End Property

    Private Property Get CPrintCls_CanPrintNowPage() As Boolean: CPrintCls_CanPrintNowPage = True: End Property

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim RsT As ADBasicLIB2.RecordsetEx
        Dim RsA As ADBasicLIB2.RecordsetEx
        Dim St As String
        Dim St1 As String, St2 As String
        Dim n As Long, i As Long
        Dim K As Long, W As Long
        Dim m As Long
        Dim nArea(4) As Double
        Dim nLand(4) As Long
        Dim nAreaS(4) As Double
        Dim nLandS(4) As Long
        Dim sItem(4) As String
        Dim nFlag As Long
        Dim nRows As Long
        Dim b合計 As Boolean
        Dim nCount As Long
        Dim HMax As Long
        Dim n地目区分 As Long
        Dim n面積 As Double
        Dim n部分面積 As Double
        Dim n集計面積 As Double
        Dim n所有者 As Long
        Dim n分母(3) As Long
        Dim n分子(3) As Long
        Dim n筆 As Long
        Dim n所有者数 As Long
        Dim n支所番号 As Long
        Dim sSQL As String
        Dim n出力番号 As Long
        Dim s備考(6) As Variant
        Dim b備考(3) As Boolean
        Dim s支所記号 As String
        Dim Ar As Variant
        
        Ar = Split(sParam, ";")
        s総会番号 = Ar(0)
        If UBound(Ar) = 1 Then
            dt受付範囲 = Ar(1)
        Else
            dt受付範囲 = Now - 365
        End If
        s市町村名 = Fnc.s市町村名
        sItem(0) = "( 田 )": sItem(1) = "( 畑 )": sItem(2) = "( 他 )": sItem(3) = "( 計 )"
        mvarParent.表示倍率 = 0.75
        
        b合計 = False
        n支所番号 = 0
        Select Case s市町村名
            Case "姶良市", "霧島町":
                nRows = 7
                HMax = 4
                n支所番号 = SysAD.GetSettingData("農地基本台帳", "支所番号", 1)
                s支所記号 = SystemDB.DBProperty("支所記号")
            Case "南種子町":
'                nRows = 18
'                HMax = 1
                nRows = 14
                HMax = 1
                b合計 = True
                
            Case "日置市":
                nRows = 7
                HMax = 4
                n支所番号 = SysAD.GetSettingData("農地基本台帳", "支所番号", 1)
                s支所記号 = MID(SystemDB.DBProperty("支所記号"), n支所番号, 1)
            Case Else
                Exit Function
        End Select
        
        Set mvarPData = New CPrintDatas
        
        With mvarPData
            .Headers = _
            "行区分;" & _
            "法令;受付番号;通年受付番号;受付補助記号;受付年月日;出力番号;" & _
            "取下年月日;総会日;決定;進達年月日;許可番号;許可年月日;完了報告年月日;" & _
            "譲受人住所;譲受人氏名;譲渡人住所;譲渡人氏名;共有持分;所有者数;" & _
            "権利種類;期間;永久;転用目的;備考;小作料;小作料単位;複数申請人A;" & _
            ">農地;土地所在;登記地目;現況地目;面積;農地区分;持分;所有者;所有者住所;登記簿面積;一部;備考;"
    
            For K = 0 To 3
                nArea(K) = 0:  nLand(K) = 0
                nAreaS(K) = 0: nLandS(K) = 0
            Next
            n出力番号 = 0
            sSQL = "SELECT * FROM [D_申請] WHERE ([法令] IN (50,51)) AND ([総会番号]=" & Val(sParam) & ") AND ([受付年月日]>#" & Format(dt受付範囲, "YYYY/MM/DD") & "#)"
            If s市町村名 = "姶良市" Then
                If n支所番号 = 1 Then
                    sSQL = sSQL & " ORDER BY [申請地大字ID],[申請地地番];"
                Else
                    sSQL = sSQL & " AND [支所番号]=" & n支所番号 & " ORDER BY [通年受付番号],[受付番号]"
                End If
            ElseIf s市町村名 = "日置市" Then
                sSQL = sSQL & " AND [受付補助記号]='" & s支所記号 & "' ORDER BY [通年受付番号],[受付番号]"
            Else
                sSQL = sSQL & " ORDER BY [通年受付番号],[受付番号]"
            End If
            Set Rs = SystemDB.GetRecordsetEx(sSQL, 1, , "受付交付簿")
            Do Until Rs.EOF
                n = .NewLine
                .Data(n, "行区分") = 0
                .SetRsData n, "法令", Rs
                .SetRsData n, "受付番号", Rs
                .SetRsData n, "通年受付番号", Rs
                .SetRsData n, "受付年月日", Rs
                n出力番号 = n出力番号 + 1
                .Data(n, "出力番号") = n出力番号
                 
                If Fnc.s市町村名 = "姶良市" Then
                    .Data(n, "受付補助記号") = MID(s支所記号, Rs.V("支所番号"), 1)
                ElseIf Fnc.s市町村名 = "日置市" Then
                    .Data(n, "受付補助記号") = s支所記号
                Else
                    .SetRsDataList n, "受付補助記号", Rs
                End If
               
                .SetRsData n, "譲受人住所", Rs, "住所B"
                If Not Rs.IsNull("氏名B") And Rs.Value("氏名B") <> "" Then
                    .SetRsData n, "譲受人氏名", Rs, "氏名B"
                ElseIf Not Rs.IsNull("申請者B") And Rs.Value("申請者B") <> 0 Then
                    Set RsT = SystemDB.GetRecordsetEx("SELECT [D:個人Info].氏名,[V_行政区].行政区 FROM [D:個人Info] LEFT JOIN [V_行政区] ON [D:個人Info].行政区ID = [V_行政区].ID WHERE [D:個人Info].[ID]=" & Rs.Value("申請者B"), 0, , "受付簿")
                    If Not RsT.EOF Then .SetRsData n, "譲受人氏名", RsT, "氏名"
                    SystemDB.CloseRs RsT
                End If
                
                .SetRsData n, "譲渡人住所", Rs, "住所A"
                If Fnc.s市町村名 <> "南種子町" And Rs.IsNotNull("代理人名") And Rs.Value("代理人名") <> "" Then
                    .SetRsData n, "譲渡人氏名", Rs, "代理人名"
                ElseIf Fnc.s市町村名 <> "南種子町" And Rs.IsNotNull("氏名A") And Rs.Value("氏名A") <> "" Then
                    .SetRsData n, "譲渡人氏名", Rs, "氏名A"
                ElseIf Not Rs.IsNull("申請者A") And Rs.Value("申請者A") <> 0 Then
                    Set RsT = SystemDB.GetRecordsetEx("SELECT [D:個人Info].氏名,[V_行政区].行政区 FROM [D:個人Info] LEFT JOIN [V_行政区] ON [D:個人Info].行政区ID = [V_行政区].ID WHERE [D:個人Info].[ID]=" & Rs.Value("申請者A"), 0, , "受付簿")
                    If Not RsT.EOF Then .SetRsData n, "譲渡人氏名", RsT, "氏名"
                    SystemDB.CloseRs RsT
                End If
                .SetRsData n, "権利種類", Rs

                If Rs.Value("永久") Then
                    .Data(n, "期間") = 0
                ElseIf Not Rs.IsNull("期間") And Rs.Value("期間") <> 0 Then
                    .SetRsData n, "期間", Rs
                ElseIf Rs.IsDate("始期") And Rs.IsDate("終期") Then
                    .Data(n, "期間") = DateDiff("yyyy", Rs.Value("始期"), Rs.Value("終期"))
                Else
                    .Data(n, "期間") = 0
                End If
                .Data(n, "永久") = IIf(Rs.Value("永久"), "1", "0")
                
                .SetRsData n, "転用目的", Rs, "申請理由A"
                .SetRsData n, "取下年月日", Rs
                .SetRsData n, "総会日", Rs
                .SetRsData n, "進達年月日", Rs
                .SetRsData n, "完了報告年月日", Rs
                .SetRsData n, "備考", Rs
                .SetRsData n, "小作料", Rs
                .SetRsData n, "小作料単位", Rs
                .SetRsData n, "複数申請人A", Rs
                
                If s市町村名 = "南種子町" Then
                    For K = 0 To 6: s備考(K) = "": Next
                    K = 0
                    If Rs.Value("小作料") > 0 Then s備考(K) = Rs.Value("小作料") & Rs.Value("小作料単位"): K = K + 2
                    If Rs.Value("法令") = 51 Then
                        If Rs.Value("永久") Then
                            s備考(K) = "永久": K = K + 1
                        ElseIf (Not Rs.IsNull("始期")) And Rs.Value("始期") <> "0:00:00" And (Not Rs.IsNull("終期")) And Rs.Value("終期") <> "0:00:00" Then
                            s備考(K) = Format(Rs.Value("始期"), "GEE/MM/DD"): K = K + 1
                            s備考(K) = "〜": K = K + 1
                            s備考(K) = Format(Rs.Value("終期"), "GEE/MM/DD"): K = K + 1
                        End If
                    End If
                    For K = 0 To 3: b備考(K) = False: Next
                End If
                
                For K = 0 To 3
                    n分母(K) = 0
                    n分子(K) = 0
                Next
                n所有者 = 0
                n筆 = 0
                n所有者数 = 0
                .Data(n, "共有持分") = 0
                i = 0: nCount = 0
           
                If Rs.IsNull("農地リスト") Or Len(Rs.Value("農地リスト")) < 4 Then
                    .Data(n, "行区分") = 0
                    .Data(n & ":農地." & 1, "土地所在") = ""
                    .Data(n & ":農地." & 1, "現況地目") = ""
                Else
                    If Rs.Value("状態") = 2 Then
                        .Data(n, "決定") = "許可"
                        .SetRsData n, "許可年月日", Rs
                        .SetRsData n, "許可番号", Rs
                        St = Replace(Replace(Rs.Value("農地リスト"), "転用農地.", ""), ";", ",")
                        St1 = "V_転用農地"
                    Else
                        St = Replace(Replace(Rs.Value("農地リスト"), "農地.", ""), ";", ",")
                        St1 = "V_農地"
                    End If
                    If InStr(St, "農地") <> 0 Then
                        .Data(n, "行区分") = 0
                        .Data(n & ":農地." & 1, "土地所在") = ""
                        .Data(n & ":農地." & 1, "現況地目") = ""
                    Else
                    If s市町村名 = "姶良市" Then
                        Set RsT = SystemDB.GetRecordsetEx("SELECT [" & St1 & "].*,[V_地目].名称 AS [登記地目],[地目2].名称 AS [現況],[V_農委地目].名称 AS [農委地目],[D:個人Info].氏名 AS [所有者],[D:個人Info].住所 AS [所有者住所], [D_部分申請].部分面積 AS [部分面積T] FROM (((([" & St1 & "] LEFT JOIN [V_地目] ON [" & St1 & "].[登記簿地目]=[V_地目].ID) LEFT JOIN V_地目 AS 地目2 ON [" & St1 & "].[現況地目]=[地目2].ID) LEFT JOIN [V_農委地目] ON [" & St1 & "].[農委地目ID]=[V_農委地目].ID) LEFT JOIN [D:個人Info] ON [" & St1 & "].[管理人ID]=[D:個人Info].ID )  LEFT JOIN [D_部分申請] ON [" & St1 & "].ID = [D_部分申請].農地ID WHERE [" & St1 & "].[ID] IN (" & St & ") ORDER BY [" & St1 & "].[大字ID],[" & St1 & "].[小字ID],val(IIf(IsNull([地番]),0,IIf(InStr([地番],'-')=0,Val([地番]),val(Left([地番],InStr([地番],'-')-1)))) *1000 + Val(IIf(IsNull([地番]),0,IIf(InStr([地番],'-')=0,0,val(Mid([地番],InStr([地番],'-')+1))))))", 1, , "受付交付簿")
                    Else
                        Set RsT = SystemDB.GetRecordsetEx("SELECT [" & St1 & "].*,[V_地目].名称 AS [登記地目],[地目2].名称 AS [現況],[V_農委地目].名称 AS [農委地目],[D:個人Info].氏名 AS [所有者],[D:個人Info].住所 AS [所有者住所], [D_部分申請].部分面積 AS [部分面積T] FROM (((([" & St1 & "] LEFT JOIN [V_地目] ON [" & St1 & "].[登記簿地目]=[V_地目].ID) LEFT JOIN V_地目 AS 地目2 ON [" & St1 & "].[現況地目]=[地目2].ID) LEFT JOIN [V_農委地目] ON [" & St1 & "].[農委地目ID]=[V_農委地目].ID) LEFT JOIN [D:個人Info] ON [" & St1 & "].[管理人ID]=[D:個人Info].ID )  LEFT JOIN [D_部分申請] ON [" & St1 & "].ID = [D_部分申請].農地ID WHERE [" & St1 & "].[ID] IN (" & St & ") ORDER BY [" & St1 & "].[管理人ID],[" & St1 & "].[土地所在]", 1, , "受付交付簿")
                    End If
                    Do Until RsT.EOF
                        i = i + 1: nCount = nCount + 1
                        If nCount > HMax Then
                            n = .NewLine
                            .Data(n, "行区分") = 1
                            i = 1: nCount = 1
                        End If
                        If b備考(0) = False Then
                            .Data(n & ":農地." & i, "備考") = s備考(0) & "\n" & s備考(1) & "\n" & s備考(2)
                            b備考(0) = True
                        ElseIf b備考(1) = False Then
                            .Data(n & ":農地." & i, "備考") = s備考(3) & "\n" & s備考(4)
                            b備考(1) = True
                        End If
                        
                        .SetRsData n & ":農地." & i, "土地所在", RsT
                        .SetRsData n & ":農地." & i, "登記地目", RsT
                        .SetRsData n & ":農地." & i, "農地区分", RsT, "等級"
                        
                        If (Not RsT.IsNull("農委地目ID")) And (RsT.Value("農委地目ID") <> 0) And (Not RsT.IsNull("農委地目認定日")) And (RsT.Value("農委地目認定日") <> "0:00:00") Then
                            .SetRsData n & ":農地." & i, "現況地目", RsT, "農委地目"
                        Else
                            .SetRsData n & ":農地." & i, "現況地目", RsT, "現況"
                        End If
                        
                        If Not RsT.IsNull("共有持分分母") And RsT.Value("共有持分分母") <> 0 Then
                            .Data(n & ":農地." & i, "持分") = RsT.Value("共有持分分子") & "/" & RsT.Value("共有持分分母")
                            .Data(n, "共有持分") = 1
                        End If
                        If n所有者 <> RsT.Value("管理人ID") Then
                            .SetRsData n & ":農地." & i, "所有者", RsT
                            .SetRsData n & ":農地." & i, "所有者住所", RsT
                            n所有者 = RsT.Value("管理人ID")
                        End If
                        
                        n部分面積 = 0
                        If Not RsT.IsNull("部分面積T") Then n部分面積 = RsT.Value("部分面積T")
                            
                        If RsT.IsNull("管理人ID") Then
                        ElseIf RsT.Value("管理人ID") <> 0 And p所有者A.Exists(RsT.Value("管理人ID")) = False Then
                            n所有者数 = n所有者数 + 1
                            p所有者A.Add RsT.Value("管理人ID"), Fnc.NullCast(RsT.Value("所有者"), "")
                            .Data(n, "所有者数") = n所有者数
                        End If
                        
                        n地目区分 = 2
                        n面積 = 0
                        If RsT.Value("田面積") <> 0 Then
                            n面積 = RsT.Value("田面積")
                            n地目区分 = 0
                        ElseIf RsT.Value("畑面積") <> 0 Then
                            n面積 = RsT.Value("畑面積")
                            n地目区分 = 1
                        End If
                        If n面積 = 0 Or s市町村名 = "南種子町" Then n面積 = RsT.Value("登記簿面積")
                        
                        If n部分面積 = 0 Then
                            n集計面積 = n面積
                        Else
                            n集計面積 = n部分面積
                        End If
                        If n集計面積 >= 10 And s市町村名 <> "南種子町" Then n集計面積 = Fix(n集計面積)
                        .Data(n & ":農地." & i, "面積") = n集計面積
                                                
                        .Data(n & ":農地." & i, "一部") = 0
                        If RsT.IsNull("一部現況") Then
                        ElseIf Val(RsT.Value("一部現況")) > 0 Then
                            If s市町村名 = "南種子町" Then
                                .Data(n & ":農地." & i, "登記簿面積") = Fnc.NullCast(RsT.Value("登記簿面積"), 0)
                            Else
                                .Data(n & ":農地." & i, "登記簿面積") = Fix(Fnc.NullCast(RsT.Value("登記簿面積"), 0))
                            End If
                            .Data(n & ":農地." & i, "一部") = 1
                        End If
                                                
                        If Not RsT.IsNull("共有持分分母") And RsT.Value("共有持分分母") <> 0 Then
                            If n分子(n地目区分) = 0 And n分母(n地目区分) = 0 Then
                                n分子(n地目区分) = RsT.Value("共有持分分子")
                                n分母(n地目区分) = RsT.Value("共有持分分母")
                            Else
                                n分子(n地目区分) = n分子(n地目区分) * RsT.Value("共有持分分母")
                                n分子(n地目区分) = n分子(n地目区分) + RsT.Value("共有持分分子") * n分母(n地目区分)
                                n分母(n地目区分) = n分母(n地目区分) * RsT.Value("共有持分分母")
                            End If
                        Else
                            If n分子(n地目区分) = 0 And n分母(n地目区分) = 0 Then
                                n分子(n地目区分) = 1
                                n分母(n地目区分) = 1
                            Else
                                n分子(n地目区分) = n分子(n地目区分) + n分母(n地目区分)
                            End If
                        End If
    
                        nAreaS(n地目区分) = nAreaS(n地目区分) + n集計面積
    '                        nLandS(n地目区分) = nLandS(n地目区分) + 1
                        nArea(n地目区分) = nArea(n地目区分) + n集計面積
    '                        nLand(n地目区分) = nLand(n地目区分) + 1
                        n筆 = n筆 + 1
                        RsT.MoveNext
                    Loop
                    SystemDB.CloseRs RsT
                    End If
                    If i = 0 Then
                        .Data(n, "行区分") = 0
                        .Data(n & ":農地." & 1, "土地所在") = ""
                        .Data(n & ":農地." & 1, "現況地目") = ""
                    End If
                    For K = 0 To 2
                        If nAreaS(K) > 0 Then
                            nLandS(K) = n分子(K) \ n分母(K)
                            n分子(K) = n分子(K) Mod n分母(K)
                        End If
                        nLand(K) = nLand(K) + nLandS(K)
                    Next
                End If
                Rs.MoveNext
                
                If s市町村名 = "南種子町" Then
                    K = n筆
                    Do While K < 2
                        i = i + 1: nCount = nCount + 1
                        If nCount > HMax Then
                            n = .NewLine
                            .Data(n, "行区分") = 3
                            i = 1: nCount = 1
                        End If
                        If b備考(0) = False Then
                            .Data(n & ":農地." & i, "備考") = s備考(0) & "\n" & s備考(1) & "\n" & s備考(2)
                            b備考(0) = True
                        ElseIf b備考(1) = False Then
                            .Data(n & ":農地." & i, "備考") = s備考(3) & "\n" & s備考(4)
                            b備考(1) = True
                        End If
                        .Data(n & ":農地." & i, "現況地目") = "77777"
                        K = K + 1
                    Loop
                End If
                
                ' 小計
                n分子(3) = n分子(0) + n分子(1) + n分子(2)
                nAreaS(3) = nAreaS(0) + nAreaS(1) + nAreaS(2)
                nLandS(3) = nLandS(0) + nLandS(1) + nLandS(2)
                If b合計 Then
                    If n筆 > 1 Then
                        St = "": St1 = "": St2 = "": nFlag = 0
                        i = 0
                        For K = 0 To 3
                            If nLandS(K) > 0 Or n分子(K) <> 0 Then
                                i = i + 1
                                If i > 2 Then
                                    n = .NewLine
                                    If nFlag = 1 Then
                                        .Data(n, "行区分") = 1
                                    Else
                                        .Data(n, "行区分") = 2
                                    End If
                                    .Data(n & ":農地." & 1, "現況地目") = "88888"
                                    .Data(n & ":農地." & 1, "土地所在") = Left(St, Len(St) - 2)
                                    .Data(n & ":農地." & 1, "登記地目") = Left(St1, Len(St1) - 2)
                                    .Data(n & ":農地." & 1, "面積") = Left(St2, Len(St2) - 2)
                                    i = 1
                                    St = "": St1 = "": St2 = ""
                                    nFlag = 1
                                End If
                                St = St & sItem(K) & "\n"
'                                St1 = St1 & FormatNumber(nLandS(K), 0) & " 筆\n"
                                If nLandS(K) > 0 Or n分子(K) <> 0 Then
                                    St1 = St1 & Format(nLandS(K), "#")
                                    If n分子(K) <> 0 And K < 3 Then
                                        If nLandS(K) > 0 Then St1 = St1 & "・"
                                        計算A n分子(K), n分母(K)
                                        St1 = St1 & n分子(K) & "/" & n分母(K)
                                    End If
                                    St1 = St1 & " 筆\n"
                                End If
                                St2 = St2 & IIf(s市町村名 = "南種子町", pFormatN(CCur(nAreaS(K))), FormatNumber(nAreaS(K), 0)) & "\n"
                            End If
                        Next
                        If i > 0 Then
                            n = .NewLine
                            If nFlag = 1 Then
                                .Data(n, "行区分") = 1
                            Else
                                .Data(n, "行区分") = 2
                            End If
                            .Data(n & ":農地." & 1, "現況地目") = "88888"
                            .Data(n & ":農地." & 1, "土地所在") = Left(St, Len(St) - 2)
                            .Data(n & ":農地." & 1, "登記地目") = Left(St1, Len(St1) - 2)
                            .Data(n & ":農地." & 1, "面積") = Left(St2, Len(St2) - 2)
                        End If
                    End If
                End If
                For K = 0 To 3
                    nAreaS(K) = 0: nLandS(K) = 0
                Next
            Loop
            SystemDB.CloseRs Rs
            nArea(3) = nArea(0) + nArea(1) + nArea(2)
            nLand(3) = nLand(0) + nLand(1) + nLand(2)
            
            ' 総合計
            If b合計 Then
                If nArea(3) > 0 Then
                    St = "": St1 = "": St2 = "": nFlag = 0
                    i = 0: W = 0: m = 0
                    For K = 0 To 3
                        If nArea(K) > 0 Then m = m + 1
                    Next
                    
                    If .Count > nRows Then
                        n = .Count Mod nRows
                    Else
                        n = .Count
                    End If
                    i = m / 2 + IIf(m Mod 2, 1, 0)
                    
                    If (n + i) > nRows Then
                        n = .Count
                        Do While n < nRows
                            n = .NewLine
                            .Data(n, "行区分") = 0
                            .Data(n & ":農地." & 1, "土地所在") = ""
                            n = n + 1
                        Loop
                    End If
                    i = 0
                    For K = 0 To 3
                        If nArea(K) > 0 Then
                            i = i + 1
                            If i > 2 Then
                                n = .NewLine
                                If nFlag = 1 Then
                                    .Data(n, "行区分") = 1
                                Else
                                    .Data(n, "行区分") = 0
                                End If
                                W = W + 1
                                .Data(n, "受付番号") = W
                                .Data(n, "通年受付番号") = m
                                .Data(n & ":農地." & 1, "現況地目") = "99999"
                                .Data(n & ":農地." & 1, "土地所在") = Left(St, Len(St) - 2)
                                .Data(n & ":農地." & 1, "登記地目") = Left(St1, Len(St1) - 2)
                                .Data(n & ":農地." & 1, "面積") = Left(St2, Len(St2) - 2)
                                i = 1
                                St = "": St1 = "": St2 = ""
                                nFlag = 1
                            End If
                            St = St & sItem(K) & "\n"
                            St1 = St1 & Format(nLand(K), "#") & " 筆\n"
                            St2 = St2 & IIf(s市町村名 = "南種子町", pFormatN(CCur(nArea(K))), FormatNumber(nArea(K), 0)) & "\n"
                        End If
                    Next
                    If i > 0 Then
                        n = .NewLine
                        If nFlag = 1 Then
                            .Data(n, "行区分") = 1
                        Else
                            .Data(n, "行区分") = 0
                        End If
                        W = W + 1
                        .Data(n, "受付番号") = W
                        .Data(n, "通年受付番号") = m
                        .Data(n & ":農地." & 1, "現況地目") = "99999"
                        .Data(n & ":農地." & 1, "土地所在") = Left(St, Len(St) - 2)
                        .Data(n & ":農地." & 1, "登記地目") = Left(St1, Len(St1) - 2)
                        .Data(n & ":農地." & 1, "面積") = Left(St2, Len(St2) - 2)
                    End If
                End If
            End If
            
            ' ページ設定
            n = .Count
            mvarParent.MaxPage = n \ nRows + IIf((n Mod nRows) > 0, 1, 0)
            mvarParent.Page = 1
        End With
    End Function
    
    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property

    Private Property Let CPrintCls_Key(ByVal RHS As String)

    End Property

    Private Property Get CPrintCls_Key() As String: CPrintCls_Key = mvarKey: End Property
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants: CPrintCls_Orientation = vbPRORLandscape: End Property

    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&)
        mvarParent.Page = nNewPage
        CPrintCls_Repaint
    End Sub
    
    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Set CPrintCls_Parent(RHS As ADBasicLIB2.CPrintFormSK): Set mvarParent = RHS: End Property

    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        mvarParent.PrintPage = 1
        mvarParent.PrintMaxPage = mvarParent.MaxPage
            
        If bNowPage Then
            PrintSub mvarParent.Page
            mvarParent.EndDoc
        Else
            Do Until mvarParent.PrintPage > mvarParent.PrintMaxPage
                PrintSub mvarParent.PrintPage
                mvarParent.NewPage
            Loop
            mvarParent.EndDoc
        End If
    
    End Sub
    Private Sub CPrintCls_Repaint(): PrintSub mvarParent.Page: End Sub
    Private Sub CPrintCls_TargetChange(sKey As String)

    End Sub

    Private Sub PrintSub(nPage As Long)
        Dim nFsize As Integer
        Dim pSize As Integer
        Dim Ar As Variant
        Dim Cm As Variant
        Dim n As Long, i As Long
        Dim y As Single, Y2 As Single
        Dim dX(25) As Single, hX(25) As Single
        Dim Xcnt As Long
        Dim nStart As Long, nEnd As Long
        Dim nRows As Long, nRowH As Long
        Dim nWork As Double
        Dim St1 As String, St2 As String
        Dim K As Long
        Dim SX As Long, SY As Single
        
        Select Case s市町村名
            Case "姶良市":
                nFsize = 10
                nRows = 7
                SX = 5
                Ar = GetArray(10, 12, 40, 40, 48, 10, 20, 6, 10, 20, 20, 13, 13, 16)
            
            Case "南種子町"
                nFsize = 7
'                nRows = 18
                nRows = 14
                nRowH = 10
               SX = 8
                SY = 52
                Ar = GetArray(8, 10, 9, 22, 17, 22, 17, 31, 6, 8, 14, 12, 9, 10, 8, 9, 9, 9, 16, 10, 10, 15)
            
            Case "日置市"
                nFsize = 10
                nRows = 7
                SX = 8
                Ar = GetArray(10, 20, 20, 56, 58, 12, 18, 32, 8, 10, 20, 12)
            Case Else
                Exit Sub
        End Select
        
        dX(0) = SX: hX(0) = dX(0) + Ar(0) / 2
        For i = 0 To UBound(Ar)
            dX(i + 1) = dX(i) + Ar(i)
            If i < UBound(Ar) Then hX(i + 1) = dX(i + 1) + Ar(i + 1) / 2
        Next
        Xcnt = UBound(Ar) + 1

        With mvarParent
            .ClearScreen
            Select Case s市町村名
            Case "姶良市":
                .Offset 0, 0
                .TextOut "農 地 法 第 ５ 条 受 付 ・ 交 付 簿", (dX(Xcnt) + dX(0)) / 2, 25, 12, 2, 0
                .DrawText "受付\n番号", dX(0), 30, Ar(0), 4, nFsize, 2, 2, 20
                .DrawText "受付日", dX(1), 30, Ar(1), 4, nFsize, 2, 2, 20
                .DrawText "譲受人（借人）", dX(2), 30, Ar(2), 4, nFsize, 2, 2, 20
                .DrawText "譲渡人（貸人）", dX(3), 30, Ar(3), 4, nFsize, 2, 2, 20
                .DrawText "土 地 の 表 示", dX(4), 30, Ar(4), 4, nFsize, 2, 2, 20
                .DrawText "地目", dX(5), 30, Ar(5), 4, nFsize, 2, 2, 20
                .DrawText "面積\n\n(u)", dX(6), 30, Ar(6), 4, nFsize, 2, 2, 20
                .DrawText "権\n利\n種\n類", dX(7), 30, Ar(7), 4, nFsize, 2, 2, 20
                .DrawText "期間", dX(8), 30, Ar(8), 4, nFsize, 2, 2, 20
                .DrawText "転用目的", dX(9), 30, Ar(9), 4, nFsize, 2, 2, 20
                .DrawText "許可番号", dX(10), 30, Ar(10), 4, nFsize, 2, 2, 10
                .DrawText "許 可 日", dX(10), 40, Ar(10), 4, nFsize, 2, 2, 10
                .DrawText "譲受人\n(借人)\n受領印", dX(11), 30, Ar(11), 4, nFsize, 2, 2, 20
                .DrawText "譲渡人\n(貸人)\n受領印", dX(12), 30, Ar(12), 4, nFsize, 2, 2, 20
                .DrawText "備　考", dX(13), 30, Ar(13), 4, nFsize, 2, 2, 15
                .DrawText "受領日", dX(13), 45, Ar(13), 4, nFsize, 2, 2, 5

                .LineBoxDX dX(0), 30, 20, nRows, 20, Ar
                .DLine dX(10), 40, dX(11), 40
                .DLine dX(13), 44, dX(14), 44
                For n = 1 To nRows
                    .DotLine dX(10), 40 + n * 20, dX(11), 40 + n * 20, vbBlack
                    .DotLine dX(13), 44 + n * 20, dX(14), 44 + n * 20, vbBlack
                Next

                If nPage = 0 Then Exit Sub

                nStart = (nPage - 1) * nRows + 1
                nEnd = nStart + nRows - 1
                If nEnd > mvarPData.Count Then nEnd = mvarPData.Count
                y = 50 + 1
                For n = nStart To nEnd
                    If mvarPData.Data(n, "行区分") = 0 Then
                        .DrawText mvarPData.Data(n, "出力番号"), dX(0), y, Ar(0), 4, nFsize, 2, 2, 10
                        .DrawText mvarPData.Data(n, "受付補助記号"), dX(0), y + 10, Ar(0), 4, nFsize, 2, 2, 10
                        .TextOut Format(mvarPData.Data(n, "受付年月日"), "GEE"), dX(1) + 1, y + 7, nFsize, 0, 2
                        .TextOut Format(mvarPData.Data(n, "受付年月日"), "M.D"), dX(1) + 1, y + 13, nFsize, 0, 2
                        .DrawText Fnc.GetShortAddress(mvarPData.Data(n, "譲受人住所"), SystemDB.DBProperty("都道府県名"), SystemDB.DBProperty("郡部"), , , True), dX(2) + 1, y, Ar(2) - 1, 4, nFsize - 1
                        .DrawText mvarPData.Data(n, "譲受人氏名"), dX(2) + 1, y + 8, Ar(2) - 1, 4, nFsize
                        .DrawText Fnc.GetShortAddress(mvarPData.Data(n, "譲渡人住所"), SystemDB.DBProperty("都道府県名"), SystemDB.DBProperty("郡部"), , , True), dX(3) + 1, y, Ar(3) - 1, 4, nFsize - 1
                        If Val(mvarPData.Data(n, "所有者数")) > 1 Then
                            St1 = "　外" & Val(mvarPData.Data(n, "所有者数")) - 1 & "名"
                        Else
                            St1 = ""
                        End If
                        .DrawText mvarPData.Data(n, "譲渡人氏名") & St1, dX(3) + 1, y + 8, Ar(3) - 1, 4, nFsize

                        Select Case mvarPData.Data(n, "法令")
                            Case 50: .DrawText "所", dX(7), y, Ar(7), 4, nFsize, 2, 2, 20
                            Case 51:
                                Select Case mvarPData.Data(n, "権利種類")
                                    Case 1: .DrawText "賃", dX(7), y, Ar(7), 4, nFsize, 2, 2, 20
                                    Case 2: .DrawText "使", dX(7), y, Ar(7), 4, nFsize, 2, 2, 20
                                End Select
                        End Select
                        If mvarPData.Data(n, "永久") = "1" Then
                            .DrawText "永久", dX(8), y, Ar(8), 4, nFsize, 2, 2, 20
                        ElseIf Val(mvarPData.Data(n, "期間")) > 0 Then
                            .DrawText mvarPData.Data(n, "期間") & "年", dX(8), y, Ar(8), 4, nFsize, 2, 2, 20
                        End If
                        .DrawText Left(mvarPData.Data(n, "転用目的"), 16), dX(9) + 1, y, Ar(9) - 1, 4, nFsize
    '                        .DrawText IIf(Val(mvarPData.Data(n, "許可番号")), mvarPData.Data(n, "許可番号"), ""), dX(10), Y + 5, Ar(10), 5, nFsize, 2, 2
    '                        .DrawText IIf(IsDate(mvarPData.Data(n, "許可年月日")), Format(mvarPData.Data(n, "許可年月日"), "GEE.MM.DD"), ""), dX(10), Y + 15, Ar(10), 5, nFsize, 2, 2
    '                        .DrawText Left(mvarPData.Data(n, "備考"), 20), dX(13) + 1, y, Ar(13) - 1, 4, nFsize - 1
                    End If
                    Y2 = y
                    For i = 0 To mvarPData.SubCount(n & ":農地")
                        If pLen(mvarPData.Data(n & ":農地." & i, "土地所在")) > 25 Then
                            .DrawText mvarPData.Data(n & ":農地." & i, "土地所在"), dX(4) + 1, Y2 - 1, Ar(4) - 1, 3, nFsize - 1
                        Else
                            .DrawText mvarPData.Data(n & ":農地." & i, "土地所在"), dX(4) + 1, Y2, Ar(4) - 1, 4, nFsize
                        End If
                        .DrawText Left(mvarPData.Data(n & ":農地." & i, "登記地目"), 2), dX(5), Y2, Ar(5), 4, nFsize, 2, 0
                        If Val(mvarPData.Data(n & ":農地." & i, "一部")) = 1 Then
                            .DrawText FormatNumber(Val(mvarPData.Data(n & ":農地." & i, "面積")), 2), dX(6), Y2 - 1, Ar(6) - 1, 3, nFsize - 1, 1
                            .TextOut "(" & FormatNumber(Val(mvarPData.Data(n & ":農地." & i, "登記簿面積")), 2) & "の内)", dX(7), Y2 + 1.8, nFsize - 2, 1
                        Else
                            .DrawText FormatNumber(Val(mvarPData.Data(n & ":農地." & i, "面積")), 2), dX(6), Y2, Ar(6) - 1, 4, nFsize - 1, 1
                        End If

    '                        .DrawText mvarPData.Data(n & ":農地." & i, "土地所在"), dX(4) + 1, Y2, Ar(4) - 1, 4, nFsize, 0, 0
    '                        .DrawText Left(mvarPData.Data(n & ":農地." & i, "登記地目"), 2), dX(5), Y2, Ar(5), 4, nFsize, 2, 0
    '                        .DrawText FormatNumber(Val(mvarPData.Data(n & ":農地." & i, "面積")), 2), dX(6), Y2, Ar(6) - 1, 4, nFsize, 1, 0
                       Y2 = Y2 + 5
                    Next
                    y = y + 20
                Next

            Case "南種子町"
                .Offset 0, 0
                .TextOut "第 " & s総会番号 & " 回定例総会付議案件　農地法第５条　申請書受付・交付簿", dX(0) + 5, 29, 10
                .TextOut "会　長", dX(8) + 10.5, 22, nFsize, 2, 2
                .TextOut "事務局長", dX(8) + 31.5, 22, nFsize, 2, 2
                .TextOut "係　長", dX(8) + 52.5, 22, nFsize, 2, 2
                .TextOut "係", dX(8) + 76.5, 22, nFsize, 2, 2
                .TextOut s市町村名 & "農業委員会", dX(Xcnt) - 1, 39.5, 9, 1, 1
    
                .DrawText "整理\n番号\n(月通)", dX(0), 42, Ar(0), 3, 6, 2, 0
                .DrawText "受付\n番号\n(年度通)", dX(1), 44, Ar(1), 2.5, 6, 2, 2
                .TextOut "受　　付", (dX(1) + dX(3)) / 2, 42, nFsize, 2, 2
                .TextOut "年月日", hX(2), 48, nFsize, 2, 2
                .TextOut "譲受人（借人）", (dX(3) + dX(5)) / 2, 42, nFsize, 2, 2
                .TextOut "住　所", hX(3), 48, nFsize, 2, 2
                .TextOut "氏　名", hX(4), 48, nFsize, 2, 2
                .TextOut "譲渡人（貸人）", (dX(5) + dX(7)) / 2, 42, nFsize, 2, 2
                .TextOut "住　所", hX(5), 48, nFsize, 2, 2
                .TextOut "氏　名", hX(6), 48, nFsize, 2, 2
                .TextOut "申　　請　　地", (dX(7) + dX(11)) / 2, 42, nFsize, 2, 2
                .TextOut "所　　　在", hX(7), 48, nFsize, 2, 2
                .TextOut "持分", hX(8), 48, nFsize, 2, 2
                .TextOut "登記", hX(9), 46, nFsize, 2, 2
                .TextOut "現況", hX(9), 50, nFsize, 2, 2
                .TextOut "地積", hX(10), 46, nFsize, 2, 2
                .TextOut "(u)", hX(10), 50, nFsize, 2, 2
                .TextOut "転用目的", hX(11), 46, nFsize, 2, 2
                .TextOut "処　　　理　　　状　　　況", (dX(12) + dX(22)) / 2, 42, nFsize, 2, 2
                .TextOut "取下げ", hX(12), 46, nFsize, 2, 2
                .TextOut "年月日", hX(12), 50, nFsize, 2, 2
                .TextOut "町委員会", hX(13), 46, nFsize - 1, 2, 2
                .TextOut "年月日", hX(13), 50, nFsize, 2, 2
                .TextOut "決定", hX(14), 48, nFsize, 2, 2
                .TextOut "県送付", hX(15), 46, nFsize, 2, 2
                .TextOut "年月日", hX(15), 50, nFsize, 2, 2
                .TextOut "県許可", hX(16), 45, nFsize - 2, 2
                .TextOut "年月日", hX(16), 47.5, nFsize - 2, 2
                .TextOut "番　号", hX(16), 50, nFsize - 2, 2
                .TextOut "交　　付", (dX(17) + dX(20)) / 2, 46, nFsize, 2, 2
                .TextOut "年月日", hX(17), 50, nFsize, 2, 2
                .TextOut "受領者氏名", hX(18), 50, nFsize, 2, 2
                .TextOut "印", hX(19), 50, nFsize, 2, 2
                .TextOut "完了報告", hX(20), 46, nFsize - 1, 2, 2
                .TextOut "年月日", hX(20), 50, nFsize, 2, 2
                .TextOut "備　考", hX(21), 46, nFsize, 2, 2
                .TextOut "(対価)", hX(21), 50, nFsize, 2, 2
                
                ' 印
                .DLine dX(8), 20, dX(18), 20
                .DLine dX(8), 24, dX(18), 24
                .DLine dX(8), 20, dX(8), 40
                .DLine dX(8) + 21, 20, dX(8) + 21, 40
                .DLine dX(8) + 42, 20, dX(8) + 42, 40
                .DLine dX(8) + 63, 20, dX(8) + 63, 40
                .DLine dX(18), 20, dX(18), 40
            
                ' 見出し／横線
                .DLine dX(0), 40, dX(Xcnt), 40
                .DLine dX(1), 44, dX(11), 44
                .DLine dX(12), 44, dX(Xcnt), 44
                .DLine dX(9), 48, dX(10), 48
                .DLine dX(16), 50, dX(17), 50
                .DLine dX(17), 48, dX(20), 48
                
                ' 見出し／縦線
                For n = 0 To Xcnt
                    Select Case n
                        Case 0, 1, 3, 5, 7, 11, 12, 22
                            .DLine dX(n), 40, dX(n), SY
                        Case 18, 19
                            .DLine dX(n), 48, dX(n), SY
                        Case Else
                            .DLine dX(n), 44, dX(n), SY
                    End Select
                Next
                .LineBoxDX dX(0), SY, 0, 1, nRows * nRowH, Ar
                
                If nPage = 0 Then Exit Sub
'                If (Not IsNull(mvarPData.Data(1, "総会日"))) And (mvarPData.Data(1, "総会日") <> "0:00:00") Then
'                    .TextOut Format(mvarPData.Data(1, "総会日"), "GEE/MM/DD") & " 開催", dX(Xcnt) - 2, 29, 12, 1, 1
'                End If
                
                nStart = (nPage - 1) * nRows + 1
                nEnd = nStart + nRows - 1
                If nEnd > mvarPData.Count Then nEnd = mvarPData.Count
                y = SY
                For n = nStart To nEnd
                    If mvarPData.Data(n, "行区分") = 0 Then
                        If n <> nStart Then .DLine dX(0), y, dX(Xcnt), y
                        If mvarPData.Data(n & ":農地." & 0, "現況地目") <> "99999" Then
                            .TextOut mvarPData.Data(n, "受付番号"), dX(1) - 2, y + 1, nFsize, 1
                            .TextOut mvarPData.Data(n, "通年受付番号"), dX(2) - 2, y + 1, nFsize, 1
                        End If
                        .DrawText SetDate(mvarPData.Data(n, "受付年月日")), dX(2) + 1, y + 1, Ar(2), 4, nFsize, 0
                        .DrawText Left(mvarPData.Data(n, "譲受人住所"), 32), dX(3) + 1, y + 1, Ar(3) - 1, 4, nFsize, 0
                        .DrawText Left(mvarPData.Data(n, "譲受人氏名"), 24), dX(4) + 1, y + 1, Ar(4) - 1, 4, nFsize, 0
                        .DrawText Left(mvarPData.Data(n, "譲渡人住所"), 32), dX(5) + 1, y + 1, Ar(5) - 1, 4, nFsize, 0
                        .DrawText Left(mvarPData.Data(n, "譲渡人氏名"), 24), dX(6) + 1, y + 1, Ar(6) - 1, 4, nFsize, 0
        
                        .DrawText Left(mvarPData.Data(n, "転用目的"), 16), dX(11), y + 1, Ar(11), 4, nFsize, 2
                        .DrawText SetDate(mvarPData.Data(n, "取下年月日")), dX(12) + 1, y + 1, Ar(12), 4, nFsize, 0
                        .DrawText SetDate(mvarPData.Data(n, "総会日")), dX(13) + 1, y + 1, Ar(13), 4, nFsize, 0
                        .DrawText mvarPData.Data(n, "決定"), dX(14), y + 1, Ar(14), 4, nFsize, 2
                        .DrawText SetDate(mvarPData.Data(n, "進達年月日")), dX(15) + 1, y + 1, Ar(15), 4, nFsize, 0
                        .DrawText SetDate(mvarPData.Data(n, "許可年月日")), dX(16) + 1, y + 1, Ar(16), 3, nFsize - 1, 0
                        .DrawText Left(mvarPData.Data(n, "許可番号"), 6), dX(16) + 1, y + 7, Ar(16), 3, nFsize - 1, 0
    '                        .DrawText SetDate(mvarPData.Data(n, "完了報告年月日")), dX(20) + 1, y + 1, Ar(20), 4, nFsize
                    ElseIf mvarPData.Data(n, "行区分") = 1 Then
                        If mvarPData.Data(n & ":農地." & 0, "現況地目") <> "99999" And mvarPData.Data(n & ":農地." & 0, "現況地目") <> "88888" Then
                            .DLine dX(7), y, dX(11), y
                        End If
                    ElseIf mvarPData.Data(n, "行区分") = 2 Then
                        .DLine dX(7), y, dX(11), y
                    ElseIf mvarPData.Data(n, "行区分") = 3 Then
                    Else
                        .DLine dX(0), y, dX(Xcnt), y
                    End If
                    
                    Y2 = y
                    If mvarPData.Data(n & ":農地." & 0, "現況地目") = "99999" Then
                        If (Val(mvarPData.Data(n, "通年受付番号")) > 2) And (Val(mvarPData.Data(n, "受付番号")) = 1) Then
                            Y2 = (nRows - 2) * nRowH + SY
                            Do Until y > Y2
                                .DLine dX(0), y, dX(Xcnt), y
                                y = y + nRowH
                            Loop
                            .DLine dX(0), Y2, dX(Xcnt), Y2
                        Else
                            Y2 = (nRows - 1) * nRowH + SY
                        End If
                    End If
                    For i = 0 To mvarPData.SubCount(n & ":農地")
                        If mvarPData.Data(n & ":農地." & i, "現況地目") = "88888" Then
                            .DrawText mvarPData.Data(n & ":農地." & i, "土地所在"), dX(7) + 11, Y2 + 1, Ar(7) - 1, 5, nFsize
                            .DrawText mvarPData.Data(n & ":農地." & i, "登記地目"), dX(7), Y2 + 1, Ar(7) - 1, 5, nFsize, 1, 0
                            .DrawText mvarPData.Data(n & ":農地." & i, "面積"), dX(10), Y2 + 1, Ar(10) - 1, 5, nFsize, 1, 0
                        ElseIf mvarPData.Data(n & ":農地." & i, "現況地目") = "99999" Then
                             If Val(mvarPData.Data(n, "受付番号")) = 1 Then
                                .DrawText "月合計", dX(7) + 1, Y2 + 1, Ar(7), 4, nFsize
                            End If
                            .DrawText mvarPData.Data(n & ":農地." & i, "土地所在"), dX(7) + 11, Y2 + 1, Ar(7) - 2, 5, nFsize
                            .DrawText mvarPData.Data(n & ":農地." & i, "登記地目"), dX(7), Y2 + 1, Ar(7) - 1, 5, nFsize, 1, 0
                            .DrawText mvarPData.Data(n & ":農地." & i, "面積"), dX(10), Y2 + 1, Ar(10) - 1, 5, nFsize, 1, 0
                        ElseIf mvarPData.Data(n & ":農地." & i, "現況地目") = "77777" Then
                        Else
                            .DrawText mvarPData.Data(n & ":農地." & i, "土地所在"), dX(7) + 1, Y2 + 5, Ar(7) - 1, 4, nFsize, 0, 2
                            .DrawText mvarPData.Data(n & ":農地." & i, "持分"), dX(8), Y2 + 5, Ar(8), 4, nFsize, 2, 2
                            St1 = mvarPData.Data(n & ":農地." & i, "登記地目")
                            St2 = mvarPData.Data(n & ":農地." & i, "現況地目")
                            If StrComp(St1, St2) Then
                                .DrawText Left(St1, 3), dX(9), Y2 + 2.5, Ar(9), 4, nFsize, 2, 2
                                .DrawText Left(St2, 3), dX(9), Y2 + 7.5, Ar(9), 4, nFsize, 2, 2
                                .DLine dX(9), Y2 + 5, dX(10), Y2 + 5
                            Else
                                .DrawText St1, dX(9), Y2 + 5, Ar(9), 4, nFsize, 2, 2
                            End If
                            If Val(mvarPData.Data(n & ":農地." & i, "面積")) <> 0 Then
                                .TextOut pFormatN(Val(mvarPData.Data(n & ":農地." & i, "面積"))), dX(11) - 1, Y2 + 5, nFsize, 1, 2
                            End If
    '                        Else
    '                            K = K + 1
    '                            nWork = nWork + Val(mvarPData.Data(n & ":農地." & i, "面積"))
                        End If
                        .DrawText mvarPData.Data(n & ":農地." & i, "備考"), dX(21), Y2 + 0.5, Ar(21), 3, nFsize, 2
                        Y2 = Y2 + nRowH
                    Next
                    St1 = ""
    '                    If K > 0 Then
    '                        St1 = "外 " & K & "筆\n" & FormatNumber(Val(nWork), 0) & "u"
    '                    End If
    '                    .DrawText St1, dX(20), y + 5, Ar(20), 3.5, nFsize, 2, 2
                    y = y + nRowH
                Next
                Do Until y > nRows * nRowH + SY
                    .DLine dX(0), y, dX(Xcnt), y
                    y = y + nRowH
                Loop
                
            Case "日置市"
                .Offset 0, 0
                .TextOut "農 地 法 第 ５ 条 申 請 ・ 許 可 名 簿", .PaperWidth / 2, 25, 12, 2, 0
                .DrawText "番号\n年度\n年", dX(0), 30, Ar(0), 4, nFsize, 2, 2, 20
                .DrawText "受付日", dX(1), 30, Ar(1), 4, nFsize, 2, 2, 20
                .DrawText "許可番号", dX(2), 30, Ar(2), 4, nFsize, 2, 2, 10
                .DrawText "許 可 日", dX(2), 40, Ar(2), 4, nFsize, 2, 2, 10
                .DrawText "譲 受 人 （借人）", dX(3), 30, Ar(3), 4, nFsize, 2, 2, 10
                .DrawText "譲 渡 人 （貸人）", dX(3), 40, Ar(3), 4, nFsize, 2, 2, 10
                .DrawText "申　　請　　地", dX(4), 30, Ar(4), 4, nFsize, 2, 2, 20
                .DrawText "地目", dX(5), 30, Ar(5), 4, nFsize, 2, 2, 20
                .DrawText "面積\n\n(u)", dX(6), 30, Ar(6), 4, nFsize, 2, 2, 20
                .DrawText "農 地 区 分", dX(7), 30, Ar(7), 4, nFsize, 2, 2, 20
                .DrawText "使\n用\n貸\n借\n・\n賃\n借", dX(8), 30, Ar(8), 2.7, 8, 2, 2, 20
                .DrawText "期間", dX(9), 30, Ar(9), 4, nFsize, 2, 2, 20
                .DrawText "転用目的", dX(10), 30, Ar(10), 4, nFsize, 2, 2, 20
                .DrawText "印\n申請人", dX(11), 30, Ar(11), 4, nFsize, 2, 2, 20
                
                .LineBoxDX dX(0), 30, 20, nRows, 20, Ar
                .DLine dX(2), 40, dX(4), 40
                For n = 0 To nRows - 1
                    .DotLine dX(2), 60 + n * 20, dX(4), 60 + n * 20, RGB(0, 0, 0)
                Next

                If nPage = 0 Then Exit Sub
            
                nStart = (nPage - 1) * nRows + 1
                nEnd = nStart + nRows - 1
                If nEnd > mvarPData.Count Then nEnd = mvarPData.Count
                y = 50 + 1
                For n = nStart To nEnd
                    If mvarPData.Data(n, "行区分") = 0 Then
                        .DrawText mvarPData.Data(n, "通年受付番号"), dX(0), y, Ar(0), 4, nFsize, 2, 2, 10
                        .DrawText mvarPData.Data(n, "受付補助記号") & mvarPData.Data(n, "受付番号"), dX(0), y + 10, Ar(0), 4, nFsize, 2, 2, 10
                        .DrawText Format(mvarPData.Data(n, "受付年月日"), "GEE.MM.DD"), dX(1), y, Ar(1), 5, nFsize, 2, 2, 20
                        .DrawText IIf(Val(mvarPData.Data(n, "許可番号")), mvarPData.Data(n, "許可番号"), ""), dX(2), y, Ar(2), 5, nFsize, 2, 2, 10
                        .DrawText IIf(IsDate(mvarPData.Data(n, "許可年月日")), Format(mvarPData.Data(n, "許可年月日"), "GEE.MM.DD"), ""), dX(2), y + 10, Ar(2), 5, nFsize, 2, 2, 10
                        .DrawText Left(mvarPData.Data(n, "譲受人住所"), 17), dX(3) + 1, y, Ar(3) - 1, 4, nFsize - 1
                        
                        pSize = nFsize
                        Do Until mvarParent.TextWidth(mvarPData.Data(n, "譲受人氏名"), pSize) <= (Ar(3) - 1) * 2
                            pSize = pSize - 1
                        Loop
                        .DrawText mvarPData.Data(n, "譲受人氏名"), dX(3) + 1, y + 4, Ar(3) - 1, 4, pSize
                        
                        .DrawText Left(mvarPData.Data(n, "譲渡人住所"), 17), dX(3) + 1, y + 10, Ar(3) - 1, 4, nFsize - 1
                        .DrawText Left(mvarPData.Data(n, "譲渡人氏名"), 15), dX(3) + 1, y + 15, Ar(3) - 1, 4, nFsize
'                        .DrawText Left(mvarPData.Data(n, "備考"), 10), dX(7) + 1, y, Ar(7) - 1, 4, nFsize - 1
                        
                        If mvarPData.Data(n, "法令") = 51 Then
                            Select Case mvarPData.Data(n, "権利種類")
                                Case 1: .DrawText "賃", dX(8), y, Ar(8), 4, nFsize, 2, 2, 20
                                Case 2: .DrawText "使", dX(8), y, Ar(8), 4, nFsize, 2, 2, 20
                            End Select
                        End If
                        If mvarPData.Data(n, "永久") = "1" Then
                            .DrawText "永久", dX(9), y, Ar(9), 4, nFsize, 2, 2, 20
                        ElseIf Val(mvarPData.Data(n, "期間")) > 0 Then
                            .DrawText mvarPData.Data(n, "期間") & "年", dX(9), y, Ar(9), 4, nFsize, 2, 2, 20
                        End If
                        .DrawText Left(mvarPData.Data(n, "転用目的"), 16), dX(10) + 1, y, Ar(10) - 1, 4, nFsize, 2, 2, 20
                    End If
                    Y2 = y
                    For i = 0 To mvarPData.SubCount(n & ":農地")
                        If pLen(mvarPData.Data(n & ":農地." & i, "土地所在")) > 32 Then
                            .TextOut mvarPData.Data(n & ":農地." & i, "土地所在"), dX(4) + 1, Y2, nFsize - 1
                        Else
                            .DrawText mvarPData.Data(n & ":農地." & i, "土地所在"), dX(4) + 1, Y2, Ar(4) - 1, 4, nFsize
                        End If
                        .DrawText Left(mvarPData.Data(n & ":農地." & i, "登記地目"), 2), dX(5), Y2, Ar(5), 4, nFsize, 2, 0
                        .DrawText FormatNumber(Val(mvarPData.Data(n & ":農地." & i, "面積")), 0), dX(6), Y2, Ar(6) - 1, 4, nFsize, 1, 0
                        .DrawText Left(mvarPData.Data(n & ":農地." & i, "農地区分"), 9), dX(7) + 1, Y2, Ar(7) - 1, 4, nFsize
                       Y2 = Y2 + 5
                    Next
                    y = y + 20
                Next
            End Select
        End With
    End Sub

    Private Function SetDate(vDate As Variant) As String
        Dim St As String
        Dim n As Long
        
        If IsDate(vDate) Then
            If CDate(vDate) > 0 Then
                St = Format(vDate, "GEE-MM/DD")
                n = InStr(St, "-")
                SetDate = Left(St, n - 1) & "\n " & MID(St, n + 1)
            Else
                SetDate = ""
            End If
        Else
            SetDate = ""
        End If
    End Function

    Private Sub 計算A(pDataA As Long, pDataB As Long)
        Dim n As Long
        
        n = 2
        Do While (n < pDataA And n < pDataB)
            If (pDataA Mod n = 0) And (pDataB Mod n = 0) Then
                pDataA = pDataA / n
                pDataB = pDataB / n
                Exit Do
            End If
            n = n + 1
        Loop
    End Sub

    Private Function pLen(pStr As String) As Long
        Dim n As Long
        Dim nAscCode As Integer
        Dim nCount As Long
                   
        nCount = 0
        For n = 1 To Len(pStr)
            nCount = nCount + 1
            nAscCode = Asc(MID(pStr, n, 1))
            If Len(Hex(nAscCode)) > 2 Then
                nCount = nCount + 1
            End If
        Next
        pLen = nCount
    End Function

End Class










Class CPrint受付交付簿事業計画
    Option Explicit
    Implements CPrintCls
    Private mvarPData As CPrintDatas
    Private mvarParent As CPrintFormSK
    Private mvarKey As String
    Private s総会番号 As String
    Private dt受付範囲 As Date
    Private p所有者A As New CDataDictionary

    Private Property Get CPrintCls_CanCancelPrint() As Boolean: End Property
    Private Property Get CPrintCls_CanPrintNowPage() As Boolean: CPrintCls_CanPrintNowPage = True: End Property

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim RsT As ADBasicLIB2.RecordsetEx
        Dim St As String
        Dim St1 As String, St2 As String
        Dim n As Long, i As Long
        Dim K As Long, W As Long
        Dim m As Long
        Dim nArea(4) As Double
        Dim nLand(4) As Long
        Dim nAreaS(4) As Double
        Dim nLandS(4) As Long
        Dim sItem(4) As String
        Dim nFlag As Long
        Dim nRows As Long
        Dim b合計 As Boolean
        Dim nCount As Long
        Dim HMax As Long
        Dim n地目区分 As Long
        Dim n面積 As Double
        Dim n筆 As Long
        Dim n支所番号 As Long
        Dim sSQL As String
        Dim n出力番号 As Long
        Dim Ar As Variant, Cm As Variant
        Dim s支所記号 As String
       
        Ar = Split(sParam, ";")
        s総会番号 = Ar(0)
        If UBound(Ar) > 0 Then dt受付範囲 = Ar(1) Else dt受付範囲 = Now - 365
        sItem(0) = "( 田 )": sItem(1) = "( 畑 )": sItem(2) = "( 他 )": sItem(3) = "( 計 )"
        mvarParent.表示倍率 = 0.75
        
        b合計 = False
        n支所番号 = 0
        Select Case Fnc.s市町村名
            Case "姶良市", "日置市":
                nRows = 7
                HMax = 4
                n支所番号 = SysAD.GetSettingData("農地基本台帳", "支所番号", 1)
                s支所記号 = SystemDB.DBProperty("支所記号")
            Case Else
                Exit Function
        End Select
        
        Set mvarPData = New CPrintDatas
        
        With mvarPData
            .Headers = _
            "行区分;" & _
            "受付番号;通年受付番号;受付補助記号;受付年月日;出力番号;" & _
            "変更前氏名;変更前住所;変更後氏名;変更後住所;" & _
            "変更前目的;変更後目的;" & _
            ">農地;土地所在;登記地目;現況地目;面積;"
    
            For K = 0 To 3
                nArea(K) = 0:  nLand(K) = 0
                nAreaS(K) = 0: nLandS(K) = 0
            Next
            n出力番号 = 0
            sSQL = "SELECT * FROM [D_申請] WHERE ([法令] IN (303)) AND ([総会番号]=" & Val(sParam) & ") AND ([受付年月日]>=#" & Format(dt受付範囲, "YYYY/MM/DD") & "#)"
            If Fnc.s市町村名 = "姶良市" Then
                If n支所番号 = 1 Then
                    sSQL = sSQL & " ORDER BY [支所番号],[受付番号],[申請地大字ID],[申請地地番];"
                Else
                    sSQL = sSQL & " AND [支所番号]=" & n支所番号 & " ORDER BY [通年受付番号],[受付番号]"
                End If
            Else
                sSQL = sSQL & " ORDER BY [通年受付番号],[受付番号]"
            End If
            Set Rs = SystemDB.GetRecordsetEx(sSQL, 0, , "受付交付簿")
 
            Do Until Rs.EOF
                n = .NewLine
                .Data(n, "行区分") = 0
                .Data(n, "受付番号") = Rs.Value("受付番号")
                .Data(n, "通年受付番号") = Rs.Value("通年受付番号")
                .Data(n, "受付年月日") = Rs.Value("受付年月日")
                n出力番号 = n出力番号 + 1
                .Data(n, "出力番号") = n出力番号
                 
                If Fnc.s市町村名 = "姶良市" Or Fnc.s市町村名 = "日置市" Then
                    .Data(n, "受付補助記号") = MID(s支所記号, Rs.V("支所番号"), 1)
                Else
                    .Data(n, "受付補助記号") = Rs.Value("受付補助記号")
                End If
               
                .Data(n, "変更後氏名") = Rs.Value("氏名A")
                .Data(n, "変更後住所") = Rs.Value("住所A")

                .Data(n, "変更前氏名") = Rs.Value("氏名C")
                .Data(n, "変更前住所") = Rs.Value("住所C")

                .Data(n, "変更前目的") = Rs.Value("予備2")
                .Data(n, "変更後目的") = Rs.Value("申請理由A")
                
                If Rs.IsNull("農地リスト") Then
                    .Data(n, "行区分") = 0
                    .Data(n & ":農地." & 1, "土地所在") = ""
                    .Data(n & ":農地." & 1, "現況地目") = ""
                ElseIf Len(Rs.Value("農地リスト")) > 0 Then
                    Ar = Split(Rs.Value("農地リスト"), vbCrLf)
                    i = 0: nCount = 0
                    For W = 0 To UBound(Ar)
                        i = i + 1: nCount = nCount + 1
                        If nCount > HMax Then
                            n = .NewLine
                            .Data(n, "行区分") = 1
                            i = 1: nCount = 1
                        End If
                        Cm = Split(Ar(W), ";")
                        .Data(n & ":農地." & i, "土地所在") = Cm(0)
                        .Data(n & ":農地." & i, "登記地目") = Cm(1)
                        .Data(n & ":農地." & i, "現況地目") = Cm(2)
                        .Data(n & ":農地." & i, "面積") = Cm(3)
                        
                        n地目区分 = 2
                        n面積 = 0
                        If InStr(Cm(2), "田") > 0 Then
                            n地目区分 = 0
                        ElseIf InStr(Cm(2), "畑") > 0 Then
                            n地目区分 = 1
                        End If
                        If n面積 = 0 Then n面積 = Val(Cm(3))
                        If n面積 >= 10 Then n面積 = Fix(n面積)
                        .Data(n & ":農地." & i, "面積") = n面積
                        nAreaS(n地目区分) = nAreaS(n地目区分) + n面積
                        nArea(n地目区分) = nArea(n地目区分) + n面積
                        n筆 = n筆 + 1
                    Next
                End If
                If i = 0 Then
                    .Data(n, "行区分") = 0
                    .Data(n & ":農地." & 1, "土地所在") = ""
                    .Data(n & ":農地." & 1, "現況地目") = ""
                End If
                Rs.MoveNext
                
                ' 小計
                nAreaS(3) = nAreaS(0) + nAreaS(1) + nAreaS(2)
                nLandS(3) = nLandS(0) + nLandS(1) + nLandS(2)
                If b合計 Then
                    If n筆 > 1 Then
                        St = "": St1 = "": St2 = "": nFlag = 0
                        i = 0
                        For K = 0 To 3
                            i = i + 1
                            If i > 2 Then
                                n = .NewLine
                                If nFlag = 1 Then
                                    .Data(n, "行区分") = 1
                                Else
                                    .Data(n, "行区分") = 2
                                End If
                                .Data(n & ":農地." & 1, "現況地目") = "88888"
                                .Data(n & ":農地." & 1, "土地所在") = Left(St, Len(St) - 2)
                                .Data(n & ":農地." & 1, "登記地目") = Left(St1, Len(St1) - 2)
                                .Data(n & ":農地." & 1, "面積") = Left(St2, Len(St2) - 2)
                                i = 1
                                St = "": St1 = "": St2 = ""
                                nFlag = 1
                            End If
                            St = St & sItem(K) & "\n"
                            St2 = St2 & FormatNumber(nAreaS(K), 0) & "\n"
                        Next
                        If i > 0 Then
                            n = .NewLine
                            If nFlag = 1 Then
                                .Data(n, "行区分") = 1
                            Else
                                .Data(n, "行区分") = 2
                            End If
                            .Data(n & ":農地." & 1, "現況地目") = "88888"
                            .Data(n & ":農地." & 1, "土地所在") = Left(St, Len(St) - 2)
                            .Data(n & ":農地." & 1, "登記地目") = Left(St1, Len(St1) - 2)
                            .Data(n & ":農地." & 1, "面積") = Left(St2, Len(St2) - 2)
                        End If
                    End If
                End If
                For K = 0 To 3
                    nAreaS(K) = 0: nLandS(K) = 0
                Next
            Loop
            SystemDB.CloseRs Rs
            nArea(3) = nArea(0) + nArea(1) + nArea(2)
            nLand(3) = nLand(0) + nLand(1) + nLand(2)
            
            ' 総合計
            If b合計 Then
                If nArea(3) > 0 Then
                    St = "": St1 = "": St2 = "": nFlag = 0
                    i = 0: W = 0: m = 0
                    For K = 0 To 3
                        If nArea(K) > 0 Then m = m + 1
                    Next
                    
                    If .Count > nRows Then
                        n = .Count Mod nRows
                    Else
                        n = .Count
                    End If
                    i = m / 2 + IIf(m Mod 2, 1, 0)
                    
                    If (n + i) > nRows Then
                        n = .Count
                        Do While n < nRows
                            n = .NewLine
                            .Data(n, "行区分") = 0
                            .Data(n & ":農地." & 1, "土地所在") = ""
                            n = n + 1
                        Loop
                    End If
                    i = 0
                    For K = 0 To 3
                        If nArea(K) > 0 Then
                            i = i + 1
                            If i > 2 Then
                                n = .NewLine
                                If nFlag = 1 Then
                                    .Data(n, "行区分") = 1
                                Else
                                    .Data(n, "行区分") = 0
                                End If
                                W = W + 1
                                .Data(n, "受付番号") = W
                                .Data(n, "通年受付番号") = m
                                .Data(n & ":農地." & 1, "現況地目") = "99999"
                                .Data(n & ":農地." & 1, "土地所在") = Left(St, Len(St) - 2)
                                .Data(n & ":農地." & 1, "登記地目") = Left(St1, Len(St1) - 2)
                                .Data(n & ":農地." & 1, "面積") = Left(St2, Len(St2) - 2)
                                i = 1
                                St = "": St1 = "": St2 = ""
                                nFlag = 1
                            End If
                            St = St & sItem(K) & "\n"
                            St1 = St1 & Format(nLand(K), "#") & " 筆\n"
                            St2 = St2 & FormatNumber(nArea(K), 0) & "\n"
                        End If
                    Next
                    If i > 0 Then
                        n = .NewLine
                        If nFlag = 1 Then
                            .Data(n, "行区分") = 1
                        Else
                            .Data(n, "行区分") = 0
                        End If
                        W = W + 1
                        .Data(n, "受付番号") = W
                        .Data(n, "通年受付番号") = m
                        .Data(n & ":農地." & 1, "現況地目") = "99999"
                        .Data(n & ":農地." & 1, "土地所在") = Left(St, Len(St) - 2)
                        .Data(n & ":農地." & 1, "登記地目") = Left(St1, Len(St1) - 2)
                        .Data(n & ":農地." & 1, "面積") = Left(St2, Len(St2) - 2)
                    End If
                End If
            End If
            
            ' ページ設定
            n = .Count
            mvarParent.MaxPage = n \ nRows + IIf((n Mod nRows) > 0, 1, 0)
            mvarParent.Page = 1
        End With
    End Function
    
    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property

    Private Property Let CPrintCls_Key(ByVal RHS As String)

    End Property

    Private Property Get CPrintCls_Key() As String: CPrintCls_Key = mvarKey: End Property
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants: CPrintCls_Orientation = vbPRORLandscape: End Property

    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&)
        mvarParent.Page = nNewPage
        CPrintCls_Repaint
    End Sub
    
    Private Property Get CPrintCls_PaperSize() As Long
        Select Case Fnc.s市町村名
            Case "南種子町": CPrintCls_PaperSize = vbPRPSB4
            Case Else: CPrintCls_PaperSize = vbPRPSA4
        End Select
    End Property
    Private Property Set CPrintCls_Parent(RHS As ADBasicLIB2.CPrintFormSK): Set mvarParent = RHS: End Property

    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        mvarParent.PrintPage = 1
        mvarParent.PrintMaxPage = mvarParent.MaxPage
            
        If bNowPage Then
            PrintSub mvarParent.Page
            mvarParent.EndDoc
        Else
            Do Until mvarParent.PrintPage > mvarParent.PrintMaxPage
                PrintSub mvarParent.PrintPage
                mvarParent.NewPage
            Loop
            mvarParent.EndDoc
        End If
    
    End Sub
    Private Sub CPrintCls_Repaint(): PrintSub mvarParent.Page: End Sub
    Private Sub CPrintCls_TargetChange(sKey As String)

    End Sub

    Private Sub PrintSub(nPage As Long)
        Dim nFsize As Integer
        Dim Ar As Variant
        Dim Cm As Variant
        Dim n As Long, i As Long
        Dim y As Single, Y2 As Single
        Dim dX(25) As Single, hX(25) As Single
        Dim Xcnt As Long
        Dim nStart As Long, nEnd As Long
        Dim nRows As Long
        Dim nWork As Double
        Dim St1 As String, St2 As String
        Dim K As Long
        Dim SX As Long
        
        Select Case Fnc.s市町村名
            Case "姶良市":
                nFsize = 10
                nRows = 7
                SX = 5
                Ar = GetArray(10, 12, 40, 40, 48, 10, 20, 20, 20, 20, 13, 13, 16)
            
            Case Else
                Exit Sub
        End Select
        
        dX(0) = SX: hX(0) = dX(0) + Ar(0) / 2
        For i = 0 To UBound(Ar)
            dX(i + 1) = dX(i) + Ar(i)
            If i < UBound(Ar) Then hX(i + 1) = dX(i + 1) + Ar(i + 1) / 2
        Next
        Xcnt = UBound(Ar) + 1

        With mvarParent
            .ClearScreen
            Select Case Fnc.s市町村名
            Case "姶良市":
                .Offset -3, 0
                .TextOut "事 業 計 画 変 更 受 付 ・ 交 付 簿", (dX(Xcnt) + dX(0)) / 2, 25, 12, 2, 0
                .DrawText "受付\n番号", dX(0), 30, Ar(0), 4, nFsize, 2, 2, 20
                .DrawText "受付日", dX(1), 30, Ar(1), 4, nFsize, 2, 2, 20
                .DrawText "当初計画者", dX(2), 30, Ar(2), 4, nFsize, 2, 2, 20
                .DrawText "事業承継者", dX(3), 30, Ar(3), 4, nFsize, 2, 2, 20
                .DrawText "土 地 の 表 示", dX(4), 30, Ar(4), 4, nFsize, 2, 2, 20
                .DrawText "地目", dX(5), 30, Ar(5), 4, nFsize, 2, 2, 20
                .DrawText "面積\n\n(u)", dX(6), 30, Ar(6), 4, nFsize, 2, 2, 20
                .DrawText "転用目的", dX(7), 30, Ar(7) + Ar(8), 4, nFsize, 2, 2, 10
                .DrawText "当初", dX(7), 40, Ar(7), 4, nFsize, 2, 2, 10
                .DrawText "変更後", dX(8), 40, Ar(8), 4, nFsize, 2, 2, 10
                .DrawText "許可番号", dX(9), 30, Ar(9), 4, nFsize, 2, 2, 10
                .DrawText "許 可 日", dX(9), 40, Ar(9), 4, nFsize, 2, 2, 10
                .DrawText "当初\n計画者\n受領印", dX(10), 30, Ar(10), 4, nFsize, 2, 2, 20
                .DrawText "事業\n継承者\n受領印", dX(11), 30, Ar(11), 4, nFsize, 2, 2, 20
                .DrawText "備　考", dX(12), 30, Ar(12), 4, nFsize, 2, 2, 15
                .DrawText "受領日", dX(12), 45, Ar(12), 4, nFsize, 2, 2, 5

                .DLine dX(0), 30, dX(Xcnt), 30
                For n = 0 To Xcnt
                    If n = 8 Then
                        .DLine dX(n), 40, dX(n), 50
                    Else
                        .DLine dX(n), 30, dX(n), 50
                    End If
                Next
                
                .LineBoxDX dX(0), 50, 0, nRows, 20, Ar
                .DLine dX(7), 40, dX(10), 40
                .DLine dX(12), 44, dX(13), 44
                For n = 1 To nRows
                    .DotLine dX(9), 40 + n * 20, dX(10), 40 + n * 20, vbBlack
                    .DotLine dX(12), 44 + n * 20, dX(13), 44 + n * 20, vbBlack
                Next

                If nPage = 0 Then Exit Sub

                nStart = (nPage - 1) * nRows + 1
                nEnd = nStart + nRows - 1
                If nEnd > mvarPData.Count Then nEnd = mvarPData.Count
                y = 50 + 1
                For n = nStart To nEnd
                    If mvarPData.Data(n, "行区分") = 0 Then
                        .DrawText mvarPData.Data(n, "出力番号"), dX(0), y + 5, Ar(0), 4, nFsize, 2, 2
                        .DrawText mvarPData.Data(n, "受付補助記号"), dX(0), y + 15, Ar(0), 4, nFsize, 2, 2
                        .TextOut Format(mvarPData.Data(n, "受付年月日"), "GEE"), dX(1) + 1, y + 5, nFsize, 0, 2
                        .DrawText Format(mvarPData.Data(n, "受付年月日"), "M.D"), dX(1), y + 10, Ar(1), 4, nFsize, 2, 2
                        .DrawText Fnc.GetShortAddress(mvarPData.Data(n, "変更前住所"), SystemDB.DBProperty("都道府県名"), SystemDB.DBProperty("郡部"), , , True), dX(2) + 1, y, Ar(2) - 1, 4, nFsize - 1
                        .DrawText mvarPData.Data(n, "変更前氏名"), dX(2) + 1, y + 8, Ar(2) - 1, 4, nFsize
                        .DrawText Fnc.GetShortAddress(mvarPData.Data(n, "変更後住所"), SystemDB.DBProperty("都道府県名"), SystemDB.DBProperty("郡部"), , , True), dX(3) + 1, y, Ar(3) - 1, 4, nFsize - 1
                        .DrawText mvarPData.Data(n, "変更後氏名"), dX(3) + 1, y + 8, Ar(3) - 1, 4, nFsize
                        .DrawText Left(mvarPData.Data(n, "変更前目的"), 16), dX(7) + 1, y, Ar(7) - 1, 4, nFsize
                        .DrawText Left(mvarPData.Data(n, "変更後目的"), 16), dX(8) + 1, y, Ar(8) - 1, 4, nFsize
                    End If
                    Y2 = y
                    For i = 0 To mvarPData.SubCount(n & ":農地")
                        St1 = StrConv(mvarPData.Data(n & ":農地." & i, "土地所在"), vbNarrow)
                        If pLen(St1) > 25 Then
                            .DrawText St1, dX(4) + 1, Y2 - 1, Ar(4) - 1, 3, nFsize - 1
                        Else
                            .DrawText St1, dX(4) + 1, Y2, Ar(4) - 1, 4, nFsize
                        End If
                        .DrawText Left(mvarPData.Data(n & ":農地." & i, "登記地目"), 2), dX(5), Y2, Ar(5), 4, nFsize, 2, 0
                        .DrawText FormatNumber(Val(mvarPData.Data(n & ":農地." & i, "面積")), 2), dX(6), Y2, Ar(6) - 1, 4, nFsize - 1, 1
                       Y2 = Y2 + 5
                    Next
                    y = y + 20
                Next
            End Select
        End With
    End Sub

    Private Function pLen(pStr As String) As Long
        Dim n As Long
        Dim nAscCode As Integer
        Dim nCount As Long
                   
        nCount = 0
        For n = 1 To Len(pStr)
            nCount = nCount + 1
            nAscCode = Asc(MID(pStr, n, 1))
            If Len(Hex(nAscCode)) > 2 Then
                nCount = nCount + 1
            End If
        Next
        pLen = nCount
    End Function

End Class










Class CPrint受付交付簿農地変更
    Option Explicit
    Implements CPrintCls
    Private mvarPData As CPrintDatas
    Private mvarParent As CPrintFormSK
    Private mvarKey As String
    Private s総会番号 As String
    Private dt受付範囲 As Date


    Private Property Get CPrintCls_CanCancelPrint() As Boolean: End Property

    Private Property Get CPrintCls_CanPrintNowPage() As Boolean: CPrintCls_CanPrintNowPage = True: End Property

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim RsT As ADBasicLIB2.RecordsetEx
        Dim RsA As ADBasicLIB2.RecordsetEx
        Dim St As String
        Dim St1 As String, St2 As String
        Dim n As Long, i As Long
        Dim K As Long, W As Long
        Dim m As Long
        Dim nArea(4) As Double
        Dim nLand(4) As Long
        Dim nAreaS(4) As Double
        Dim nLandS(4) As Long
        Dim sItem(4) As String
        Dim nFlag As Long
        Dim nRows As Long
        Dim b合計 As Boolean
        Dim nCount As Long
        Dim HMax As Long
        Dim n地目区分 As Long
        Dim n面積 As Double
        Dim n部分面積 As Double
        Dim n集計面積 As Double
        Dim n所有者 As Long
        Dim n分母(3) As Long
        Dim n分子(3) As Long
        Dim n筆 As Long
        Dim n支所番号 As Long
        Dim sSQL As String
        Dim n出力番号 As Long
        Dim s支所記号 As String
        Dim Ar As Variant
        
        Ar = Split(sParam, ";")
        s総会番号 = Ar(0)
        If UBound(Ar) > 0 Then dt受付範囲 = Ar(1) Else dt受付範囲 = Now - 365
        sItem(0) = "( 田 )": sItem(1) = "( 畑 )": sItem(2) = "( 他 )": sItem(3) = "( 計 )"
        mvarParent.表示倍率 = 0.75

        b合計 = False
        n支所番号 = 0
        Select Case Fnc.s市町村名
            Case "南種子町":
                nRows = 18
                b合計 = True
                HMax = 1
                
            Case "日置市":
                nRows = 7
                HMax = 4
                n支所番号 = SysAD.GetSettingData("農地基本台帳", "支所番号", 1)
                s支所記号 = SystemDB.DBProperty("支所記号")
            Case Else
                Exit Function
        End Select
            
        Set mvarPData = New CPrintDatas
        
        With mvarPData
            .Headers = _
            "行区分;" & _
            "受付番号;受付補助記号;通年受付番号;受付年月日;申請人住所;申請人氏名;共有持分;" & _
            "利用目的;許可番号;許可年月日;出力番号;" & _
            ">農地;土地所在;登記地目;現況地目;面積;持分;所有者;所有者住所;登記簿面積;一部;"
    
            For K = 0 To 3
                nArea(K) = 0:  nLand(K) = 0
                nAreaS(K) = 0: nLandS(K) = 0
            Next
            n出力番号 = 0
            sSQL = "SELECT * FROM [D_申請] WHERE ([法令]=500) AND ([受付年月日]>#" & dt受付範囲 & "#) AND ([総会番号]=" & Val(sParam) & ") ORDER BY [通年受付番号],[受付番号]"
            Set Rs = SystemDB.GetRecordsetEx(sSQL, 1, , "受付交付簿")
            Do Until Rs.EOF
                n = .NewLine
                .Data(n, "行区分") = 0
                .SetRsData n, "受付番号", Rs
                .SetRsData n, "通年受付番号", Rs
                .SetRsData n, "受付年月日", Rs
                .SetRsData n, "申請人住所", Rs, "住所A"
                n出力番号 = n出力番号 + 1
                .Data(n, "出力番号") = n出力番号

                .SetRsData n, "受付補助記号", Rs
                
                If Not Rs.IsNull("氏名A") And Rs.Value("氏名A") <> "" Then
                    .SetRsData n, "申請人氏名", Rs, "氏名A"
                ElseIf Not Rs.IsNull("申請者A") And Rs.Value("申請者A") <> 0 Then
                    Set RsT = SystemDB.GetRecordsetEx("SELECT 氏名 FROM [D:個人Info] WHERE [ID]=" & Rs.Value("申請者A"), 0, , "受付簿")
                    .SetRsData n, "申請人氏名", RsT, "氏名"
                    SystemDB.CloseRs RsT
                End If
                
                .SetRsData n, "利用目的", Rs, "用途"
                If Rs.Value("状態") = 2 Then
                    .SetRsData n, "許可年月日", Rs
                    .SetRsData n, "許可番号", Rs
                End If
                
                For K = 0 To 3
                    n分母(K) = 0
                    n分子(K) = 0
                Next
                n所有者 = 0
                n筆 = 0
                .Data(n, "共有持分") = 0
                            
                If Rs.IsNull("農地リスト") Or Len(Rs.Value("農地リスト")) < 4 Then
                    .Data(n, "行区分") = 0
                    .Data(n & ":農地." & 1, "土地所在") = ""
                    .Data(n & ":農地." & 1, "現況地目") = ""
                Else
                    St = Replace(Replace(Rs.Value("農地リスト"), "農地.", ""), ";", ",")
                    If Fnc.s市町村名 = "姶良市" Then
                        Set RsT = SystemDB.GetRecordsetEx("SELECT [V_農地].*,[V_地目].名称 AS [登記地目],[地目2].名称 AS [現況],[V_農委地目].名称 AS [農委地目],[D:個人Info].氏名 AS [所有者],[D:個人Info].住所 AS [所有者住所],[D_部分申請].部分面積 AS [部分面積T] FROM (((([V_農地] LEFT JOIN [V_地目] ON [V_農地].[登記簿地目]=[V_地目].ID) LEFT JOIN V_地目 AS 地目2 ON [V_農地].[現況地目]=[地目2].ID) LEFT JOIN [V_農委地目] ON [V_農地].[農委地目ID]=[V_農委地目].ID) LEFT JOIN [D:個人Info] ON [V_農地].[管理人ID]=[D:個人Info].ID) LEFT JOIN [D_部分申請] ON [V_農地].ID = [D_部分申請].農地ID WHERE [V_農地].[ID] IN (" & St & ") ORDER BY [V_農地].[大字ID],[V_農地].[小字ID],val(IIf(IsNull([地番]),0,IIf(InStr([地番],'-')=0,Val([地番]),val(Left([地番],InStr([地番],'-')-1)))) *1000 + Val(IIf(IsNull([地番]),0,IIf(InStr([地番],'-')=0,0,val(Mid([地番],InStr([地番],'-')+1))))))", 1, , "受付交付簿")
                    Else
                        Set RsT = SystemDB.GetRecordsetEx("SELECT [V_農地].*,[V_地目].名称 AS [登記地目],[地目2].名称 AS [現況],[V_農委地目].名称 AS [農委地目],[D:個人Info].氏名 AS [所有者],[D:個人Info].住所 AS [所有者住所],[D_部分申請].部分面積 AS [部分面積T] FROM (((([V_農地] LEFT JOIN [V_地目] ON [V_農地].[登記簿地目]=[V_地目].ID) LEFT JOIN V_地目 AS 地目2 ON [V_農地].[現況地目]=[地目2].ID) LEFT JOIN [V_農委地目] ON [V_農地].[農委地目ID]=[V_農委地目].ID) LEFT JOIN [D:個人Info] ON [V_農地].[管理人ID]=[D:個人Info].ID) LEFT JOIN [D_部分申請] ON [V_農地].ID = [D_部分申請].農地ID WHERE [V_農地].[ID] IN (" & St & ") ORDER BY [V_農地].[管理人ID],[V_農地].[土地所在]", 1, , "受付交付簿")
                    End If
                    i = 0: nCount = 0
                    Do Until RsT.EOF
                        i = i + 1: nCount = nCount + 1
                        If nCount > HMax Then
                            n = .NewLine
                            .Data(n, "行区分") = 1
                            i = 1: nCount = 1
                        End If
                        .SetRsData n & ":農地." & i, "土地所在", RsT
                        .SetRsData n & ":農地." & i, "登記地目", RsT
                        
                        If (Not RsT.IsNull("農委地目ID")) And (RsT.Value("農委地目ID") <> 0) And (Not RsT.IsNull("農委地目認定日")) And (RsT.Value("農委地目認定日") <> "0:00:00") Then
                            .SetRsData n & ":農地." & i, "現況地目", RsT, "農委地目"
                        Else
                            .SetRsData n & ":農地." & i, "現況地目", RsT, "現況"
                        End If
                        
                        If Not RsT.IsNull("共有持分分母") And RsT.Value("共有持分分母") <> 0 Then
                            .Data(n & ":農地." & i, "持分") = RsT.Value("共有持分分子") & "/" & RsT.Value("共有持分分母")
                            .Data(n, "共有持分") = 1
                        End If
                        If n所有者 <> RsT.Value("管理人ID") Then
                            .SetRsData n & ":農地." & i, "所有者", RsT
                            .SetRsData n & ":農地." & i, "所有者住所", RsT
                            n所有者 = RsT.Value("管理人ID")
                        End If
                    
                        n部分面積 = 0
                        If Not RsT.IsNull("部分面積T") Then n部分面積 = RsT.Value("部分面積T")
                      
                        n地目区分 = 2
                        n面積 = 0
                        If RsT.Value("田面積") <> 0 Then
                            n面積 = RsT.Value("田面積")
                            n地目区分 = 0
                        ElseIf RsT.Value("畑面積") <> 0 Then
                            n面積 = RsT.Value("畑面積")
                            n地目区分 = 1
                        End If
                        If n面積 = 0 Then n面積 = RsT.Value("登記簿面積")
                        
                        If n部分面積 = 0 Then
                            n集計面積 = n面積
                        Else
                            n集計面積 = n部分面積
                        End If
                        n集計面積 = Fix(n集計面積)
                        .Data(n & ":農地." & i, "面積") = n集計面積
                        
                        .Data(n & ":農地." & i, "一部") = 0
                        If RsT.IsNull("一部現況") Then
                        ElseIf Val(RsT.Value("一部現況")) > 0 Then
                            .Data(n & ":農地." & i, "登記簿面積") = Fix(Fnc.NullCast(RsT.Value("登記簿面積"), 0))
                            .Data(n & ":農地." & i, "一部") = 1
                        End If
                    
                        If Not RsT.IsNull("共有持分分母") And RsT.Value("共有持分分母") <> 0 Then
                            If n分子(n地目区分) = 0 And n分母(n地目区分) = 0 Then
                                n分子(n地目区分) = RsT.Value("共有持分分子")
                                n分母(n地目区分) = RsT.Value("共有持分分母")
                            Else
                                n分子(n地目区分) = n分子(n地目区分) * RsT.Value("共有持分分母")
                                n分子(n地目区分) = n分子(n地目区分) + RsT.Value("共有持分分子") * n分母(n地目区分)
                                n分母(n地目区分) = n分母(n地目区分) * RsT.Value("共有持分分母")
                            End If
                        Else
                            If n分子(n地目区分) = 0 And n分母(n地目区分) = 0 Then
                                n分子(n地目区分) = 1
                                n分母(n地目区分) = 1
                            Else
                                n分子(n地目区分) = n分子(n地目区分) + n分母(n地目区分)
                            End If
                        End If
   
                        nAreaS(n地目区分) = nAreaS(n地目区分) + n集計面積
                        nArea(n地目区分) = nArea(n地目区分) + n集計面積
                        n筆 = n筆 + 1
                        RsT.MoveNext
                    Loop
                    SystemDB.CloseRs RsT
                    If i = 0 Then
                        .Data(n, "行区分") = 0
                        .Data(n & ":農地." & 1, "土地所在") = ""
                        .Data(n & ":農地." & 1, "現況地目") = ""
                    End If
                    For K = 0 To 2
                        If nAreaS(K) > 0 Then
                            nLandS(K) = n分子(K) \ n分母(K)
                            n分子(K) = n分子(K) Mod n分母(K)
                        End If
                        nLand(K) = nLand(K) + nLandS(K)
                    Next
                End If
                Rs.MoveNext
                n分子(3) = n分子(0) + n分子(1) + n分子(2)
                nAreaS(3) = nAreaS(0) + nAreaS(1) + nAreaS(2)
                nLandS(3) = nLandS(0) + nLandS(1) + nLandS(2)
                If b合計 Then
                    If n筆 > 1 Then
                        St = "": St1 = "": St2 = "": nFlag = 0
                        i = 0
                        For K = 0 To 3
                            If nLandS(K) > 0 Or n分子(K) <> 0 Then
                                i = i + 1
                                If i > 2 Then
                                    n = .NewLine
                                    If nFlag = 1 Then
                                        .Data(n, "行区分") = 1
                                    Else
                                        .Data(n, "行区分") = 2
                                    End If
                                    .Data(n & ":農地." & 1, "現況地目") = "88888"
                                    .Data(n & ":農地." & 1, "土地所在") = Left(St, Len(St) - 2)
                                    .Data(n & ":農地." & 1, "登記地目") = Left(St1, Len(St1) - 2)
                                    .Data(n & ":農地." & 1, "面積") = Left(St2, Len(St2) - 2)
                                    i = 1
                                    St = "": St1 = "": St2 = ""
                                    nFlag = 1
                                End If
                                St = St & sItem(K) & "\n"
'                                St1 = St1 & FormatNumber(nLandS(K), 0) & " 筆\n"
                                If nLandS(K) > 0 Or n分子(K) <> 0 Then
                                    St1 = St1 & Format(nLandS(K), "#")
                                    If n分子(K) <> 0 And K < 3 Then
                                        If nLandS(K) > 0 Then St1 = St1 & "・"
                                        計算A n分子(K), n分母(K)
                                        St1 = St1 & n分子(K) & "/" & n分母(K)
                                    End If
                                    St1 = St1 & " 筆\n"
                                End If
                                St2 = St2 & FormatNumber(nAreaS(K), 0) & "\n"
                            End If
                        Next
                        If i > 0 Then
                            n = .NewLine
                            If nFlag = 1 Then
                                .Data(n, "行区分") = 1
                            Else
                                .Data(n, "行区分") = 2
                            End If
                            .Data(n & ":農地." & 1, "現況地目") = "88888"
                            .Data(n & ":農地." & 1, "土地所在") = Left(St, Len(St) - 2)
                            .Data(n & ":農地." & 1, "登記地目") = Left(St1, Len(St1) - 2)
                            .Data(n & ":農地." & 1, "面積") = Left(St2, Len(St2) - 2)
                        End If
                    End If
                End If
                For K = 0 To 3
                    nAreaS(K) = 0: nLandS(K) = 0
                Next
            Loop
            SystemDB.CloseRs Rs
            nArea(3) = nArea(0) + nArea(1) + nArea(2)
            nLand(3) = nLand(0) + nLand(1) + nLand(2)
            
            ' 合計行
            If b合計 Then
                If nArea(3) > 0 Then
                    St = "": St1 = "": St2 = "": nFlag = 0
                    i = 0: W = 0: m = 0
                    For K = 0 To 3
                        If nArea(K) > 0 Then m = m + 1
                    Next
                    
                    If .Count > nRows Then
                        n = .Count Mod nRows
                    Else
                        n = .Count
                    End If
                    i = m / 2 + IIf(m Mod 2, 1, 0)
                    
                    If (n + i) > nRows Then
                        n = .Count
                        Do While n < nRows
                            n = .NewLine
                            .Data(n, "行区分") = 0
                            .Data(n & ":農地." & 1, "土地所在") = ""
                            n = n + 1
                        Loop
                    End If
                    i = 0
                    For K = 0 To 3
                        If nArea(K) > 0 Then
                            i = i + 1
                            If i > 2 Then
                                n = .NewLine
                                If nFlag = 1 Then
                                    .Data(n, "行区分") = 1
                                Else
                                    .Data(n, "行区分") = 0
                                End If
                                W = W + 1
                                .Data(n, "受付番号") = W
                                .Data(n, "通年受付番号") = m
                                .Data(n & ":農地." & 1, "現況地目") = "99999"
                                .Data(n & ":農地." & 1, "土地所在") = Left(St, Len(St) - 2)
                                .Data(n & ":農地." & 1, "登記地目") = Left(St1, Len(St1) - 2)
                                .Data(n & ":農地." & 1, "面積") = Left(St2, Len(St2) - 2)
                                i = 1
                                St = "": St1 = "": St2 = ""
                                nFlag = 1
                            End If
                            St = St & sItem(K) & "\n"
                            St1 = St1 & Format(nLand(K), "#") & " 筆\n"
                            St2 = St2 & FormatNumber(nArea(K), 0) & "\n"
                        End If
                    Next
                    If i > 0 Then
                        n = .NewLine
                        If nFlag = 1 Then
                            .Data(n, "行区分") = 1
                        Else
                            .Data(n, "行区分") = 0
                        End If
                        W = W + 1
                        .Data(n, "受付番号") = W
                        .Data(n, "通年受付番号") = m
                        .Data(n & ":農地." & 1, "現況地目") = "99999"
                        .Data(n & ":農地." & 1, "土地所在") = Left(St, Len(St) - 2)
                        .Data(n & ":農地." & 1, "登記地目") = Left(St1, Len(St1) - 2)
                        .Data(n & ":農地." & 1, "面積") = Left(St2, Len(St2) - 2)
                    End If
                End If
            End If
            
            ' ページ設定
            n = .Count
            mvarParent.MaxPage = n \ nRows + IIf((n Mod nRows) > 0, 1, 0)
            mvarParent.Page = 1
        End With
    End Function
    
    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property

    Private Property Let CPrintCls_Key(ByVal RHS As String): End Property

    Private Property Get CPrintCls_Key() As String: CPrintCls_Key = mvarKey: End Property
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants: CPrintCls_Orientation = vbPRORLandscape: End Property

    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&)
        mvarParent.Page = nNewPage
        CPrintCls_Repaint
    End Sub
    
    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Set CPrintCls_Parent(RHS As ADBasicLIB2.CPrintFormSK): Set mvarParent = RHS: End Property

    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        mvarParent.PrintPage = 1
        mvarParent.PrintMaxPage = mvarParent.MaxPage
            
        If bNowPage Then
            PrintSub mvarParent.Page
            mvarParent.EndDoc
        Else
            Do Until mvarParent.PrintPage > mvarParent.PrintMaxPage
                PrintSub mvarParent.PrintPage
                mvarParent.NewPage
            Loop
            mvarParent.EndDoc
        End If
    
    End Sub
    Private Sub CPrintCls_Repaint(): PrintSub mvarParent.Page: End Sub
    Private Sub CPrintCls_TargetChange(sKey As String)

    End Sub

    Private Sub PrintSub(nPage As Long)
        Dim nFsize As Integer
        Dim Ar As Variant
        Dim Cm As Variant
        Dim n As Long, i As Long
        Dim y As Single, Y2 As Single
        Dim dX(25) As Single, hX(25) As Single
        Dim Xcnt As Long, SX As Long
        Dim nStart As Long, nEnd As Long
        Dim nRows As Long
        Dim nWork As Double
        Dim St1 As String, St2 As String
        Dim K As Long
        
        Select Case Fnc.s市町村名
        Case "姶良市":
            nFsize = 10
            nRows = 7
            SX = 10
            Ar = GetArray(12, 20, 48, 56, 12, 22, 40, 20, 12, 15, 15)
        Case Else
            Exit Sub
        End Select
        
        dX(0) = SX: hX(0) = dX(0) + Ar(0) / 2
        For i = 0 To UBound(Ar)
            dX(i + 1) = dX(i) + Ar(i)
            If i < UBound(Ar) Then hX(i + 1) = dX(i + 1) + Ar(i + 1) / 2
        Next
        Xcnt = UBound(Ar) + 1

        With mvarParent
            .ClearScreen
            Select Case Fnc.s市町村名
            Case "姶良市":
                .Offset 0, 0
                .TextOut "農 地 利 用 変 更 届 受 理 書 交 付 簿", (dX(0) + dX(Xcnt)) / 2, 25, 12, 2
                .DrawText "受付\n番号", dX(0), 40, Ar(0), 4, nFsize, 2, 2
                .DrawText "受付日", dX(1), 40, Ar(1), 4, nFsize, 2, 2
                .DrawText "申　請　人　住　所", dX(2), 35, Ar(2), 4, nFsize, 2, 2
                .DrawText "申　請　人　氏　名", dX(2), 45, Ar(2), 4, nFsize, 2, 2
                .DrawText "土 地 の 表 示", dX(3), 40, Ar(3), 4, nFsize, 2, 2
                .DrawText "地目", dX(4), 40, Ar(4), 4, nFsize, 2, 2
                .DrawText "面積\n(u)", dX(5), 35, Ar(5), 6, nFsize, 2
                .DrawText "変 更 事 由", dX(6), 40, Ar(6), 4, nFsize, 2, 2
                .DrawText "受理番号", dX(7), 35, Ar(7), 4, nFsize, 2, 2
                .DrawText "受 理 日", dX(7), 45, Ar(7), 4, nFsize, 2, 2
                .DrawText "交\n付\n日", dX(8), 40 - 5, Ar(8), 4, nFsize, 2, 2
                .DrawText "受領印", dX(9), 40, Ar(9), 4, nFsize, 2, 2
                .DrawText "備　考", dX(10), 37, Ar(10), 4, nFsize, 2, 2
                .DrawText "受領日", dX(10), 45, Ar(10), 4, nFsize, 2, 2
                
                .LineBoxDX dX(0), 30, 20, nRows, 20, Ar
                .DLine dX(2), 40, dX(3), 40
                .DLine dX(7), 40, dX(8), 40
                .DLine dX(10), 44, dX(11), 44
                For n = 1 To nRows
                    .DotLine dX(2), 40 + n * 20, dX(3), 40 + n * 20, vbBlack
                    .DotLine dX(7), 40 + n * 20, dX(8), 40 + n * 20, vbBlack
                    .DotLine dX(10), 44 + n * 20, dX(11), 44 + n * 20, vbBlack
                Next
                
                If nPage = 0 Then Exit Sub
            
                nStart = (nPage - 1) * nRows + 1
                nEnd = nStart + nRows - 1
                If nEnd > mvarPData.Count Then nEnd = mvarPData.Count
                y = 50 + 1
                For n = nStart To nEnd
                    If mvarPData.Data(n, "行区分") = 0 Then
                        .DrawText mvarPData.Data(n, "出力番号"), dX(0), y + 5, Ar(0), 4, nFsize, 2, 2
                        .DrawText mvarPData.Data(n, "受付補助記号"), dX(0), y + 15, Ar(0), 4, nFsize, 2, 2
                        .DrawText Format(mvarPData.Data(n, "受付年月日"), "GEE.MM.DD"), dX(1), y + 10, Ar(1), 5, nFsize, 2, 2
                        .DrawText Fnc.GetShortAddress(mvarPData.Data(n, "申請人住所"), SystemDB.DBProperty("都道府県名"), SystemDB.DBProperty("郡部"), , , True), dX(2) + 1, y + 4, Ar(2) - 1, 4, nFsize, 0, 2
                        .DrawText mvarPData.Data(n, "申請人氏名"), dX(2) + 1, y + 14, Ar(2) - 1, 4, nFsize, 0, 2
                        .DrawText Left(mvarPData.Data(n, "利用目的"), 16), dX(6) + 1, y, Ar(6) - 1, 4, nFsize
'                        .DrawText IIf(Val(mvarPData.Data(n, "許可番号")), mvarPData.Data(n, "許可番号"), ""), dX(7), Y + 5, Ar(7), 5, nFsize, 2, 2
'                        .DrawText IIf(IsDate(mvarPData.Data(n, "許可年月日")), Format(mvarPData.Data(n, "許可年月日"), "GEE.MM.DD"), ""), dX(7), Y + 15, Ar(7), 5, nFsize, 2, 2
                    End If
                    Y2 = y
                    For i = 0 To mvarPData.SubCount(n & ":農地")
                        If pLen(mvarPData.Data(n & ":農地." & i, "土地所在")) > 32 Then
                            .DrawText mvarPData.Data(n & ":農地." & i, "土地所在"), dX(3) + 1, Y2 - 1, Ar(3) - 1, 3, nFsize - 1
                        Else
                            .DrawText mvarPData.Data(n & ":農地." & i, "土地所在"), dX(3) + 1, Y2, Ar(3) - 1, 4, nFsize
                        End If
                        .DrawText Left(mvarPData.Data(n & ":農地." & i, "登記地目"), 2), dX(4), Y2, Ar(4), 4, nFsize, 2, 0
                        If Val(mvarPData.Data(n & ":農地." & i, "一部")) = 1 Then
                            .DrawText FormatNumber(Val(mvarPData.Data(n & ":農地." & i, "面積")), 0), dX(5), Y2 - 1, Ar(5) - 1, 3, nFsize - 1, 1
                            .TextOut "(" & FormatNumber(Val(mvarPData.Data(n & ":農地." & i, "登記簿面積")), 0) & "の内)", dX(6), Y2 + 2, nFsize - 2, 1
                        Else
                            .DrawText FormatNumber(Val(mvarPData.Data(n & ":農地." & i, "面積")), 0), dX(5), Y2, Ar(5) - 1, 4, nFsize, 1, 0
                        End If
                        Y2 = Y2 + 5
                    Next
                    y = y + 20
                Next

            End Select
        End With
    End Sub

    Private Sub 計算A(pDataA As Long, pDataB As Long)
        Dim n As Long
        
        n = 2
        Do While (n < pDataA And n < pDataB)
            If (pDataA Mod n = 0) And (pDataB Mod n = 0) Then
                pDataA = pDataA / n
                pDataB = pDataB / n
                Exit Do
            End If
            n = n + 1
        Loop
    End Sub

    Private Function pLen(pStr As String) As Long
        Dim n As Long
        Dim nAscCode As Integer
        Dim nCount As Long
                   
        nCount = 0
        For n = 1 To Len(pStr)
            nCount = nCount + 1
            nAscCode = Asc(MID(pStr, n, 1))
            If Len(Hex(nAscCode)) > 2 Then
                nCount = nCount + 1
            End If
        Next
        pLen = nCount
    End Function


End Class










Class CPrint受付交付簿買受適格
    Option Explicit
    Implements CPrintCls
    Private mvarPData As CPrintDatas
    Private mvarParent As CPrintFormSK
    Private mvarKey As String
    Private s総会番号 As String
    Private dt受付範囲 As Date
    Private s市町村名 As String
    Private n様式 As Long
    Private nRows As Long
    Private HMax As Long

    Private Property Get CPrintCls_CanCancelPrint() As Boolean

    End Property

    Private Property Get CPrintCls_CanPrintNowPage() As Boolean: CPrintCls_CanPrintNowPage = True: End Property

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim RsT As ADBasicLIB2.RecordsetEx
        Dim St As String
        Dim n As Long, i As Long
        Dim K As Long, W As Long
        Dim n筆数小計(4) As Long
        Dim n面積小計(4) As Double
        Dim n筆数合計(4) As Long
        Dim n面積合計(4) As Double
        Dim s合計項目(4) As String
        Dim n地目区分 As Long
        Dim n面積 As Double
        Dim n集計面積 As Double
        Dim b合計 As Boolean
        Dim n支所番号 As Long
        Dim sSQL As String
        Dim s譲受人 As String
        Dim n出力番号 As Long
        Dim nCount As Long
        Dim Ar As Variant
        Dim nStart As Long
        Dim Cm As Variant
        
        Ar = Split(sParam, ";")
        s総会番号 = Ar(0)
        n様式 = Val(Ar(1))
        If UBound(Ar) > 1 Then dt受付範囲 = Ar(2) Else dt受付範囲 = Now - 365
        
        s市町村名 = Fnc.s市町村名
        mvarParent.表示倍率 = 0.75
        s合計項目(0) = "( 田 )": s合計項目(1) = "( 畑 )": s合計項目(2) = "( 他 )": s合計項目(3) = "( 計 )"
        b合計 = False
        n支所番号 = 0
        
        Select Case s市町村名
            Case "姶良市":
                HMax = 4
                nRows = 7
                n支所番号 = SysAD.GetSettingData("農地基本台帳", "支所番号", 1)
            Case Else
                Exit Function
        End Select
        
        Set mvarPData = New CPrintDatas
        With mvarPData
            .Headers = _
            "行区分;" & _
            "法令;受付番号;受付補助記号;受付年月日;区分;出力番号;転用目的;" & _
            "譲渡人住所;譲渡人氏名;" & _
            "譲受人住所;譲受人氏名;譲受人線;" & _
            ">農地;土地所在;登記地目;現況地目;面積;"

            For K = 0 To 3
                n筆数小計(K) = 0: n面積小計(K) = 0
                n筆数合計(K) = 0: n面積合計(K) = 0
            Next
            n出力番号 = 0
            Select Case n様式
                Case 1: St = state買受適格耕公 & "," & state買受適格耕競
                Case 2: St = state買受適格転公 & "," & state買受適格転競
            End Select
            
            sSQL = "SELECT * FROM [D_申請] WHERE ([法令] IN (" & St & ")) AND [総会番号]=" & Val(sParam)
            If s市町村名 = "姶良市" Then
                If n支所番号 = 1 Then
                    sSQL = sSQL & " ORDER BY [申請地大字ID],[申請地地番];"
                Else
                    sSQL = sSQL & " AND [支所番号]=" & n支所番号 & " ORDER BY [通年受付番号],[受付番号]"
                End If
            Else
                sSQL = sSQL & " ORDER BY [通年受付番号],[受付番号]"
            End If
            Set Rs = SystemDB.GetRecordsetEx(sSQL, 1, , "受付交付簿")
            Do Until Rs.EOF
                n = .NewLine
                nStart = n
                .Data(n, "行区分") = 0
                n出力番号 = n出力番号 + 1
                .Data(n, "出力番号") = n出力番号
                .SetRsData n, "受付番号", Rs
                .SetRsData n, "受付年月日", Rs
                .SetRsData n, "転用目的", Rs, "申請理由A"
                
                If s市町村名 = "姶良市" Then
                    .Data(n, "受付補助記号") = Choose(Rs.Value("支所番号"), "国", "溝", "横", "牧", "霧", "隼", "福")
                Else
                    .SetRsData n, "受付補助記号", Rs
                End If

                .SetRsData n, "譲渡人住所", Rs, "住所A"

                If Not Rs.IsNull("氏名A") And Rs.Value("氏名A") <> "" Then
                    .SetRsData n, "譲渡人氏名", Rs, "氏名A"
                ElseIf Not Rs.IsNull("申請者A") And Rs.Value("申請者A") <> 0 Then
                    Set RsT = SystemDB.GetRecordsetEx("SELECT [D:個人Info].氏名,[V_行政区].行政区 FROM [D:個人Info] LEFT JOIN [V_行政区] ON [D:個人Info].行政区ID = [V_行政区].ID WHERE [D:個人Info].[ID]=" & Rs.fields("申請者A").Value, 0, , "受付簿")
                    If Not RsT.EOF Then .SetRsData n, "譲渡人氏名", RsT, "氏名"
                    SystemDB.CloseRs RsT
                End If

                St = Replace(Replace(Rs.NullCast("個人リスト", ""), "対象者.", ""), ";", ",")
                s譲受人 = ""
                nCount = 0
                If Len(St) Then
                    Set RsT = SystemDB.GetRecordsetEx("SELECT [D:個人Info].氏名,[D:個人Info].住所 FROM [D:個人Info] WHERE [D:個人Info].[ID] IN(" & St & ");", 0, , "受付簿")
                    Do Until RsT.EOF
                        s譲受人 = s譲受人 & Fnc.GetShortAddress(RsT.Value("住所"), SystemDB.DBProperty("都道府県名"), SystemDB.DBProperty("郡部"), , , True) & ";" & RsT.Value("氏名") & vbBack
                        nCount = nCount + 1
                        RsT.MoveNext
                    Loop
                End If
                SystemDB.CloseRs RsT

                Select Case Rs.Value("法令")
                    Case state買受適格耕公, state買受適格転公: .Data(n, "区分") = "公"
                    Case state買受適格耕競, state買受適格転競: .Data(n, "区分") = "競"
                End Select

                St = Replace(Replace(Rs.NullCast("農地リスト", ""), "農地.", ""), ";", ",")
                If Len(St) Then
                    If s市町村名 = "姶良市" Then
                        Set RsT = SystemDB.GetRecordsetEx("SELECT [V_農地].*,[V_地目].名称 AS [登記地目],[地目2].名称 AS [現況],[V_農委地目].名称 AS [農委地目],[D:個人Info].氏名 AS [所有者],[D:個人Info].住所 AS [所有者住所],[D_部分申請].部分面積 AS [部分面積T] FROM (((([V_農地] LEFT JOIN [V_地目] ON [V_農地].[登記簿地目]=[V_地目].ID) LEFT JOIN V_地目 AS 地目2 ON [V_農地].[現況地目]=[地目2].ID) LEFT JOIN [V_農委地目] ON [V_農地].[農委地目ID]=[V_農委地目].ID) LEFT JOIN [D:個人Info] ON [V_農地].[管理人ID]=[D:個人Info].ID) LEFT JOIN [D_部分申請] ON [V_農地].ID = [D_部分申請].農地ID WHERE [V_農地].[ID] IN (" & St & ") ORDER BY [V_農地].[大字ID],[V_農地].[小字ID],val(IIf(IsNull([地番]),0,IIf(InStr([地番],'-')=0,Val([地番]),val(Left([地番],InStr([地番],'-')-1)))) *1000 + Val(IIf(IsNull([地番]),0,IIf(InStr([地番],'-')=0,0,val(Mid([地番],InStr([地番],'-')+1))))))", 1, , "受付交付簿")
                    Else
                        Set RsT = SystemDB.GetRecordsetEx("SELECT [V_農地].*,[V_地目].名称 AS [登記地目],[地目2].名称 AS [現況],[V_農委地目].名称 AS [農委地目],[D:個人Info].氏名 AS [所有者],[D:個人Info].住所 AS [所有者住所],[D_部分申請].部分面積 AS [部分面積T] FROM (((([V_農地] LEFT JOIN [V_地目] ON [V_農地].[登記簿地目]=[V_地目].ID) LEFT JOIN V_地目 AS 地目2 ON [V_農地].[現況地目]=[地目2].ID) LEFT JOIN [V_農委地目] ON [V_農地].[農委地目ID]=[V_農委地目].ID) LEFT JOIN [D:個人Info] ON [V_農地].[管理人ID]=[D:個人Info].ID) LEFT JOIN [D_部分申請] ON [V_農地].ID = [D_部分申請].農地ID WHERE [V_農地].[ID] IN (" & St & ") ORDER BY [V_農地].[管理人ID],[V_農地].[土地所在]", 1, , "受付交付簿")
                    End If
                    i = 0: nCount = 0
                    Do Until RsT.EOF
                        i = i + 1: nCount = nCount + 1
                        If nCount > HMax Then
                            n = .NewLine
                            .Data(n, "行区分") = 1
                            i = 1: nCount = 1
                        End If
                        .SetRsData n & ":農地." & i, "土地所在", RsT
                        .SetRsData n & ":農地." & i, "登記地目", RsT
    
                        If (Not RsT.IsNull("農委地目ID")) And (RsT.Value("農委地目ID") <> 0) And (Not RsT.IsNull("農委地目認定日")) And (RsT.Value("農委地目認定日") <> "0:00:00") Then
                            .SetRsData n & ":農地." & i, "現況地目", RsT, "農委地目"
                        Else
                            .SetRsData n & ":農地." & i, "現況地目", RsT, "現況"
                        End If
    
                        n地目区分 = 2
                        n面積 = 0
                        If RsT.Value("田面積") <> 0 Then
                            n面積 = RsT.Value("田面積")
                            n地目区分 = 0
                        ElseIf RsT.Value("畑面積") <> 0 Then
                            n面積 = RsT.Value("畑面積")
                            n地目区分 = 1
                        End If
                        If n面積 = 0 Then n面積 = Fnc.NullCast(RsT.Value("登記簿面積"), 0)
                        n集計面積 = Fix(n面積)
                        .Data(n & ":農地." & i, "面積") = n集計面積
    
                        n面積小計(n地目区分) = n面積小計(n地目区分) + n集計面積
                        n面積合計(n地目区分) = n面積合計(n地目区分) + n集計面積
                        n筆数小計(n地目区分) = n筆数小計(n地目区分) + 1
                        n筆数合計(n地目区分) = n筆数合計(n地目区分) + 1
                        RsT.MoveNext
                    Loop
                    SystemDB.CloseRs RsT
                End If

                If b合計 And n筆数小計(3) > 1 Then
                    For K = 0 To 3
                        If n筆数小計(K) > 0 Then
                            n = .NewLine
                            .Data(n, "行区分") = 1
                            .Data(n & ":農地." & 1, "土地所在") = s合計項目(K)
                            .Data(n & ":農地." & 1, "登記地目") = FormatNumber(n筆数小計(K), 0) & "筆"
                            .Data(n & ":農地." & 1, "面積") = FormatNumber(n面積小計(K), 0)
                        End If
                    Next
                End If
                
                For K = 0 To 3
                    n筆数小計(K) = 0: n面積小計(K) = 0
                Next
                
                Ar = Split(s譲受人, vbBack)
                For W = 0 To UBound(Ar) - 1
                    If n < W + 1 Then
                        n = .NewLine
                    End If
                    Cm = Split(Ar(W), ";")
                    .Data(nStart + W, "譲受人線") = 1
                    .Data(nStart + W, "譲受人住所") = Cm(0)
                    .Data(nStart + W, "譲受人氏名") = Cm(1)
                Next
                
                Rs.MoveNext
            Loop
            SystemDB.CloseRs Rs

             If b合計 Then
                If n面積合計(3) > 0 Then
                    For K = 0 To 3
                        If n面積合計(K) > 0 Then
                            n = .NewLine
                            .Data(n & ":農地." & 1, "土地所在") = s合計項目(K)
                            .Data(n & ":農地." & 1, "登記地目") = FormatNumber(n筆数合計(K), 0) & "筆"
                            .Data(n & ":農地." & 1, "面積") = FormatNumber(n面積合計(K), 0)
                        End If
                    Next
                End If
            End If
           
            ' ページ設定
            n = .Count
            mvarParent.MaxPage = n \ nRows + IIf((n Mod nRows) > 0, 1, 0)
            mvarParent.Page = 1
        End With
    End Function
    
    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property

    Private Property Let CPrintCls_Key(ByVal RHS As String)

    End Property
    Private Property Get CPrintCls_Key() As String: CPrintCls_Key = mvarKey: End Property
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants: CPrintCls_Orientation = vbPRORLandscape: End Property

    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&)
        mvarParent.Page = nNewPage
        CPrintCls_Repaint
    End Sub
    
    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Set CPrintCls_Parent(RHS As ADBasicLIB2.CPrintFormSK): Set mvarParent = RHS: End Property

    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        mvarParent.PrintPage = 1
        mvarParent.PrintMaxPage = mvarParent.MaxPage
            
        If bNowPage Then
            PrintSub mvarParent.Page
            mvarParent.EndDoc
        Else
            Do Until mvarParent.PrintPage > mvarParent.PrintMaxPage
                PrintSub mvarParent.PrintPage
                mvarParent.NewPage
            Loop
            mvarParent.EndDoc
        End If
    
    End Sub
    Private Sub CPrintCls_Repaint(): PrintSub mvarParent.Page: End Sub

    Private Sub CPrintCls_TargetChange(sKey As String)

    End Sub
    
    Private Sub PrintSub(nPage As Long)
        Select Case n様式
            Case 1: Print耕作 nPage
            Case 2: Print転用 nPage
        End Select
    End Sub

    Private Sub Print耕作(nPage As Long)
        Dim nFsize As Integer
        Dim Ar As Variant, Cm As Variant
        Dim n As Long, i As Long
        Dim y As Single, Y2 As Long
        Dim dX(25) As Single, hX(25) As Single
        Dim Xcnt As Long
        Dim nStart As Long, nEnd As Long
        Dim nRowH As Long
        Dim nWork As Double
        Dim K As Long
        Dim SX As Long, SY As Single
        
        Select Case s市町村名
        Case "姶良市":
            nFsize = 10
            Ar = GetArray(12, 12, 42, 42, 50, 10, 20, 8, 20, 15, 15, 25)
            SX = 12
        Case Else
            Exit Sub
        End Select
            
        dX(0) = SX: hX(0) = dX(0) + Ar(0) / 2
        For i = 0 To UBound(Ar)
            dX(i + 1) = dX(i) + Ar(i)
            If i < UBound(Ar) Then hX(i + 1) = dX(i + 1) + Ar(i + 1) / 2
        Next
        Xcnt = UBound(Ar) + 1
    
        With mvarParent
            .ClearScreen
                
            Select Case s市町村名
            Case "姶良市":
                .Offset 0, 0
                .TextOut "買 受 適 格 証 明 （ 耕 作 目 的 ） 受 付 ・ 交 付 簿", (dX(Xcnt) + dX(0)) / 2, 25, 12, 2, 0
                .DrawText "受付\n番号", dX(0), 40, Ar(0), 4, nFsize, 2, 2
                .DrawText "受付日", dX(1), 40, Ar(1), 4, nFsize, 2, 2
                .DrawText "譲受人（借人）", dX(2), 40, Ar(2), 4, nFsize, 2, 2
                .DrawText "譲渡人（貸人）", dX(3), 40, Ar(3), 4, nFsize, 2, 2
                .DrawText "土 地 の 表 示", dX(4), 40, Ar(4), 4, nFsize, 2, 2
                .DrawText "地目", dX(5), 40, Ar(5), 4, nFsize, 2, 2
                .DrawText "面積\n\n(u)", dX(6), 40, Ar(6), 4, nFsize, 2, 2
                .DrawText "区\n分", dX(7), 40, Ar(7), 4, nFsize, 2, 2
                .DrawText "許可番号", dX(8), 35, Ar(8), 4, nFsize, 2, 2
                .DrawText "許 可 日", dX(8), 45, Ar(8), 4, nFsize, 2, 2
                .DrawText "譲受人\n(借人)\n受領印", dX(9), 40, Ar(9), 4, nFsize, 2, 2
                .DrawText "譲渡人\n(貸人)\n受領印", dX(10), 40, Ar(10), 4, nFsize, 2, 2
                .DrawText "備　考", dX(11), 37, Ar(11), 4, nFsize, 2, 2
                .DrawText "受領日", dX(11), 47, Ar(11), 4, nFsize, 2, 2
                .LineBoxDX dX(0), 30, 20, nRows, 20, Ar
                .DLine dX(8), 40, dX(9), 40
                .DLine dX(11), 44, dX(12), 44
                For n = 1 To nRows
                    .DotLine dX(8), 40 + n * 20, dX(9), 40 + n * 20, vbBlack
                    .DotLine dX(11), 44 + n * 20, dX(12), 44 + n * 20, vbBlack
                Next
                
                If nPage = 0 Then Exit Sub
                nStart = (nPage - 1) * nRows + 1
                nEnd = nStart + nRows - 1
                If nEnd > mvarPData.Count Then nEnd = mvarPData.Count
                y = 50 + 1
                For n = nStart To nEnd
                    If mvarPData.Data(n, "行区分") = 0 Then
                        .DrawText mvarPData.Data(n, "出力番号"), dX(0), y + 5, Ar(0), 4, nFsize, 2, 2
                        .DrawText mvarPData.Data(n, "受付補助記号"), dX(0), y + 15, Ar(0), 4, nFsize, 2, 2
                        .TextOut Format(mvarPData.Data(n, "受付年月日"), "GEE"), dX(1) + 1, y + 5, nFsize, 0, 2
                        .DrawText Format(mvarPData.Data(n, "受付年月日"), "M.D"), dX(1), y + 10, Ar(1), 4, nFsize, 2, 2
                        .DrawText Fnc.GetShortAddress(mvarPData.Data(n, "譲渡人住所"), SystemDB.DBProperty("都道府県名"), SystemDB.DBProperty("郡部"), , , True), dX(3) + 1, y, Ar(2) - 1, 4, nFsize - IIf(pLen(mvarPData.Data(n, "譲渡人住所")) > 40, 1, 0)
                        .DrawText mvarPData.Data(n, "譲渡人氏名"), dX(3) + 1, y + 8, Ar(3) - 1, 4, nFsize
                        .DrawText mvarPData.Data(n, "区分"), dX(7), y, Ar(7), 4, nFsize, 2
                    End If
                    .DrawText Fnc.GetShortAddress(mvarPData.Data(n, "譲受人住所"), SystemDB.DBProperty("都道府県名"), SystemDB.DBProperty("郡部"), , , True), dX(2) + 1, y, Ar(2) - 1, 4, nFsize - IIf(pLen(mvarPData.Data(n, "譲受人住所")) > 40, 1, 0)
                    .DrawText mvarPData.Data(n, "譲受人氏名"), dX(2) + 1, y + 8, Ar(2) - 1, 4, nFsize
                    
                    Y2 = y
                    For i = 0 To mvarPData.SubCount(n & ":農地")
                        If pLen(mvarPData.Data(n & ":農地." & i, "土地所在")) > 26 Then
                            .DrawText mvarPData.Data(n & ":農地." & i, "土地所在"), dX(4) + 1, Y2 - 1, Ar(4) - 1, 3, nFsize - 1
                        Else
                            .DrawText mvarPData.Data(n & ":農地." & i, "土地所在"), dX(4) + 1, Y2, Ar(4) - 1, 4, nFsize
                        End If
                        .DrawText Left(mvarPData.Data(n & ":農地." & i, "登記地目"), 2), dX(5), Y2, Ar(5), 4, nFsize, 2, 0
                        .DrawText FormatNumber(Val(mvarPData.Data(n & ":農地." & i, "面積")), 2), dX(6), Y2, Ar(6) - 1, 4, nFsize, 1
                        Y2 = Y2 + 5
                    Next
                    y = y + 20
                Next
            End Select
        End With
    End Sub
    
    Private Sub Print転用(nPage As Long)
        Dim nFsize As Integer
        Dim Ar As Variant
        Dim Cm As Variant
        Dim n As Long, i As Long
        Dim y As Single, Y2 As Single
        Dim dX(25) As Single, hX(25) As Single
        Dim Xcnt As Long
        Dim nStart As Long, nEnd As Long
        Dim nRowH As Long
        Dim nWork As Double
        Dim St1 As String, St2 As String
        Dim K As Long
        Dim SX As Long, SY As Single
        
        Select Case s市町村名
            Case "姶良市":
                nFsize = 10
                SX = 5
                Ar = GetArray(10, 12, 40, 40, 48, 10, 20, 6, 10, 20, 20, 13, 13, 16)
            Case Else
                Exit Sub
        End Select
        
        dX(0) = SX: hX(0) = dX(0) + Ar(0) / 2
        For i = 0 To UBound(Ar)
            dX(i + 1) = dX(i) + Ar(i)
            If i < UBound(Ar) Then hX(i + 1) = dX(i + 1) + Ar(i + 1) / 2
        Next
        Xcnt = UBound(Ar) + 1

        With mvarParent
            .ClearScreen
            Select Case s市町村名
            Case "姶良市":
                .Offset 0, 0
                .TextOut "買 受 適 格 証 明 （ 転 用 目 的 ） 受 付 ・ 交 付 簿", (dX(Xcnt) + dX(0)) / 2, 25, 12, 2, 0
                .DrawText "受付\n番号", dX(0), 40, Ar(0), 4, nFsize, 2, 2
                .DrawText "受付日", dX(1), 40, Ar(1), 4, nFsize, 2, 2
                .DrawText "譲受人（借人）", dX(2), 40, Ar(2), 4, nFsize, 2, 2
                .DrawText "譲渡人（貸人）", dX(3), 40, Ar(3), 4, nFsize, 2, 2
                .DrawText "土 地 の 表 示", dX(4), 40, Ar(4), 4, nFsize, 2, 2
                .DrawText "地目", dX(5), 40, Ar(5), 4, nFsize, 2, 2
                .DrawText "面積\n\n(u)", dX(6), 40, Ar(6), 4, nFsize, 2, 2
                .DrawText "区\n分", dX(7), 40, Ar(7), 4, nFsize, 2, 2
                .DrawText "期間", dX(8), 40, Ar(8), 4, nFsize, 2, 2
                .DrawText "転用目的", dX(9), 40, Ar(9), 4, nFsize, 2, 2
                .DrawText "許可番号", dX(10), 35, Ar(10), 4, nFsize, 2, 2
                .DrawText "許 可 日", dX(10), 45, Ar(10), 4, nFsize, 2, 2
                .DrawText "譲受人\n(借人)\n受領印", dX(11), 40, Ar(11), 4, nFsize, 2, 2
                .DrawText "譲渡人\n(貸人)\n受領印", dX(12), 40, Ar(12), 4, nFsize, 2, 2
                .DrawText "備　考", dX(13), 37, Ar(13), 4, nFsize, 2, 2
                .DrawText "受領日", dX(13), 47, Ar(13), 4, nFsize, 2, 2

                .LineBoxDX dX(0), 30, 20, nRows, 20, Ar
                .DLine dX(10), 40, dX(11), 40
                .DLine dX(13), 44, dX(14), 44
                For n = 1 To nRows
                    .DotLine dX(10), 40 + n * 20, dX(11), 40 + n * 20, vbBlack
                    .DotLine dX(13), 44 + n * 20, dX(14), 44 + n * 20, vbBlack
                Next

                If nPage = 0 Then Exit Sub

                nStart = (nPage - 1) * nRows + 1
                nEnd = nStart + nRows - 1
                If nEnd > mvarPData.Count Then nEnd = mvarPData.Count
                y = 50 + 1
                For n = nStart To nEnd
                    If mvarPData.Data(n, "行区分") = 0 Then
                        .DrawText mvarPData.Data(n, "出力番号"), dX(0), y + 5, Ar(0), 4, nFsize, 2, 2
                        .DrawText mvarPData.Data(n, "受付補助記号"), dX(0), y + 15, Ar(0), 4, nFsize, 2, 2
                        .TextOut Format(mvarPData.Data(n, "受付年月日"), "GEE"), dX(1) + 1, y + 5, nFsize, 0, 2
                        .DrawText Format(mvarPData.Data(n, "受付年月日"), "M.D"), dX(1), y + 10, Ar(1), 4, nFsize, 2, 2
                        .DrawText Fnc.GetShortAddress(mvarPData.Data(n, "譲渡人住所"), SystemDB.DBProperty("都道府県名"), SystemDB.DBProperty("郡部"), , , True), dX(3) + 1, y, Ar(3) - 1, 4, nFsize - 1
                        .DrawText Left(mvarPData.Data(n, "譲渡人住所"), 17), dX(3) + 1, y + 10, Ar(3) - 1, 4, nFsize - 1
                        .DrawText mvarPData.Data(n, "区分"), dX(7), y + 10, Ar(7), 4, nFsize, 2, 2
                        .DrawText Left(mvarPData.Data(n, "転用目的"), 20), dX(9) + 1, y, Ar(9) - 1, 4, nFsize
                    End If
                    .DrawText Fnc.GetShortAddress(mvarPData.Data(n, "譲受人住所"), SystemDB.DBProperty("都道府県名"), SystemDB.DBProperty("郡部"), , , True), dX(2) + 1, y, Ar(2) - 1, 4, nFsize - 1
                    .DrawText mvarPData.Data(n, "譲受人氏名"), dX(2) + 1, y + 8, Ar(2) - 1, 4, nFsize
                    
                    Y2 = y
                    For i = 0 To mvarPData.SubCount(n & ":農地")
                        If pLen(mvarPData.Data(n & ":農地." & i, "土地所在")) > 25 Then
                            .DrawText mvarPData.Data(n & ":農地." & i, "土地所在"), dX(4) + 1, Y2 - 1, Ar(4) - 1, 3, nFsize - 1
                        Else
                            .DrawText mvarPData.Data(n & ":農地." & i, "土地所在"), dX(4) + 1, Y2, Ar(4) - 1, 4, nFsize
                        End If
                        .DrawText Left(mvarPData.Data(n & ":農地." & i, "登記地目"), 2), dX(5), Y2, Ar(5), 4, nFsize, 2, 0
                        .DrawText FormatNumber(Val(mvarPData.Data(n & ":農地." & i, "面積")), 2), dX(6), Y2, Ar(6) - 1, 4, nFsize - 1, 1
                       Y2 = Y2 + 5
                    Next
                    y = y + 20
                Next

            End Select
        End With
    
    End Sub

    Private Function pLen(pStr As String) As Long
        Dim n As Long
        Dim nAscCode As Integer
        Dim nCount As Long
                   
        nCount = 0
        For n = 1 To Len(pStr)
            nCount = nCount + 1
            nAscCode = Asc(MID(pStr, n, 1))
            If Len(Hex(nAscCode)) > 2 Then
                nCount = nCount + 1
            End If
        Next
        pLen = nCount
    End Function

End Class










Class CPrint受付交付簿非農地
    Option Explicit
    Implements CPrintCls
    Private mvarPData As CPrintDatas
    Private mvarParent As CPrintFormSK
    Private mvarKey As String
    Private s総会番号 As String
    Private dt受付範囲 As Date
    Private Type pTotal
        bFlag As Boolean
        s地目 As String
        n面積 As Double
        n筆 As Long
        n分子 As Long
        n分母 As Long
    End Type

    Private Property Get CPrintCls_CanCancelPrint() As Boolean

    End Property

    Private Property Get CPrintCls_CanPrintNowPage() As Boolean: CPrintCls_CanPrintNowPage = True: End Property

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim RsT As ADBasicLIB2.RecordsetEx
        Dim RsA As ADBasicLIB2.RecordsetEx
        Dim St As String
        Dim St1 As String, St2 As String
        Dim n As Long, i As Long
        Dim K As Long, m As Long
        Dim nArea As Double
        Dim nLand As Long
        Dim nRows As Long
        Dim p合計(20) As pTotal
        Dim p小計(20) As pTotal
        Dim nCount As Long
        Dim nWork As Double
        Dim bFlag As Boolean
        Dim n面積 As Double
        Dim n部分面積 As Double
        Dim s地目 As String
        Dim n所有者 As Long
        Dim n筆 As Long
        Dim Ar As Variant
        
        mvarParent.表示倍率 = 0.75
        Ar = Split(sParam, ";")
        s総会番号 = Ar(0)
        If UBound(Ar) = 1 Then
            dt受付範囲 = Ar(1)
        Else
            dt受付範囲 = Now - 365
        End If
        nRows = 14

        Set mvarPData = New CPrintDatas
        With mvarPData
            .Headers = _
            "行区分;合計行;" & _
            "受付番号;通年受付番号;受付年月日;申請人住所;申請人氏名;" & _
            "取下年月日;総会日;決定;備考;許可番号;変更年月日txt;共有持分;" & _
            ">農地;土地所在;登記地目;現況地目;面積;持分;所有者;所有者住所;"
    
            For K = 0 To 20
                p小計(K).bFlag = False
                p小計(K).s地目 = ""
                p小計(K).n面積 = 0
                p小計(K).n筆 = 0
                p小計(K).n分子 = 0
                p小計(K).n分母 = 0
                p合計(K).bFlag = False
                p合計(K).s地目 = ""
                p合計(K).n面積 = 0
                p合計(K).n筆 = 0
                p合計(K).n分子 = 0
                p合計(K).n分母 = 0
            Next
    
            Set Rs = SystemDB.GetRecordsetEx("SELECT * FROM [D_申請] WHERE ([法令]=600) AND ([総会番号]=" & Val(sParam) & ") AND ([受付年月日]>#" & Format(dt受付範囲, "YYYY/MM/DD") & "#) ORDER BY [受付番号]", 1, , "受付交付簿")
            Do Until Rs.EOF
                n = .NewLine
                .Data(n, "行区分") = "0"
                .SetRsData n, "受付番号", Rs
                .SetRsData n, "通年受付番号", Rs
                .SetRsData n, "受付年月日", Rs
                .SetRsData n, "申請人住所", Rs, "住所A"
                .SetRsData n, "申請人氏名", Rs, "氏名A"
                .SetRsData n, "取下年月日", Rs
                .SetRsData n, "総会日", Rs
                .SetRsData n, "変更年月日txt", Rs
            
                If Rs.Value("状態") = 2 Then
                    .Data(n, "決定") = "承認"
                    .SetRsData n, "許可番号", Rs
                End If
                
                n所有者 = 0
                n筆 = 0
                .Data(n, "共有持分") = 0
                
                St = Replace(Replace(Rs.Value("農地リスト"), "農地.", ""), ";", ",")
                Set RsT = SystemDB.GetRecordsetEx("SELECT [V_農地].*,[V_地目].名称 AS [登記地目],[地目2].名称 AS [現況],[V_農委地目].名称 AS [農委地目],[D:個人Info].氏名 AS [所有者],[D:個人Info].住所 AS [所有者住所] FROM ((([V_農地] LEFT JOIN [V_地目] ON [V_農地].[登記簿地目]=[V_地目].ID) LEFT JOIN V_地目 AS 地目2 ON [V_農地].[現況地目]=[地目2].ID) LEFT JOIN [V_農委地目] ON [V_農地].[農委地目ID]=[V_農委地目].ID) LEFT JOIN [D:個人Info] ON [V_農地].[管理人ID]=[D:個人Info].ID WHERE [V_農地].[ID] IN (" & St & ") ORDER BY [V_農地].[管理人ID],[V_農地].[土地所在]", 1, , "受付交付簿")
                i = 0: nWork = 0
                Do Until RsT.EOF
                    i = i + 1
                    If i > 1 Then
                        n = .NewLine
                        .Data(n, "行区分") = "1"
                    End If
                    .SetRsData n & ":農地." & 1, "土地所在", RsT
                    .Data(n & ":農地." & 1, "登記地目") = RsT.Value("登記地目")
                    
                    If (Not RsT.IsNull("農委地目ID")) And (RsT.Value("農委地目ID") <> 0) And (Not RsT.IsNull("農委地目認定日")) And (RsT.Value("農委地目認定日") <> "0:00:00") Then
                        .Data(n & ":農地." & 1, "現況地目") = RsT.Value("農委地目")
                        s地目 = RsT.Value("農委地目")
                    Else
                        .Data(n & ":農地." & 1, "現況地目") = RsT.Value("現況")
                        s地目 = RsT.Value("現況")
                    End If
                    
                    If RsT.IsNotNull("共有持分分母") And RsT.Value("共有持分分母") <> 0 Then
                        .Data(n & ":農地." & 1, "持分") = RsT.Value("共有持分分子") & "/" & RsT.Value("共有持分分母")
                        .Data(n, "共有持分") = 1
                    End If
                    If n所有者 <> RsT.Value("管理人ID") Then
                        .SetRsData n & ":農地." & 1, "所有者", RsT
                        .SetRsData n & ":農地." & 1, "所有者住所", RsT
                        n所有者 = RsT.Value("管理人ID")
                    End If
                        
    '                    n部分面積 = 0
    '                    Set RsA = SystemDB.GetRecordsetEx("SELECT * FROM [D_部分申請] WHERE [申請ID]=" & Rs.Value("ID") & " AND [農地ID]=" & RsT.Value("ID"), 0, , "議案書")
    '                    If Not RsA.EOF Then
    '                        n部分面積 = RsA.Value("部分面積")
    '                    End If
    '                    SystemDB.CloseRs RsA
    '
    '                    If n部分面積 = 0 Then
    '                        n面積 = Fnc.NullCast(RsT.Value("田面積"), 0) + Fnc.NullCast(RsT.Value("畑面積"), 0) + Fnc.NullCast(RsT.Value("樹園地"), 0) + Fnc.NullCast(RsT.Value("採草放牧面積"), 0)
    '                    Else
    '                        n面積 = n部分面積
    '                    End If
    '                    If n面積 = 0 Then n面積 = RsT.Value("登記簿面積")

                    n面積 = RsT.Value("登記簿面積")
                    .Data(n & ":農地." & 1, "面積") = n面積
                                        
                    Set合計データ p小計, s地目, n面積, Fnc.NullCast(RsT.Value("共有持分分子"), 0), Fnc.NullCast(RsT.Value("共有持分分母"), 0)
                    n筆 = n筆 + 1
                    RsT.MoveNext
                Loop
                SystemDB.CloseRs RsT
                
                For K = 0 To 20
                    If p小計(K).bFlag Then
                        p小計(K).n筆 = p小計(K).n分子 \ p小計(K).n分母
                        p小計(K).n分子 = p小計(K).n分子 Mod p小計(K).n分母
                    End If
                Next
                Set総合計データ p合計, p小計

                ' 小計行
                If n筆 > 1 Then Set合計行 p小計, 8, 88888
               
                For K = 0 To 20
                    p小計(K).bFlag = False
                    p小計(K).s地目 = ""
                    p小計(K).n面積 = 0
                    p小計(K).n筆 = 0
                    p小計(K).n分子 = 0
                    p小計(K).n分母 = 0
                Next
                Rs.MoveNext
            Loop
            SystemDB.CloseRs Rs
            
            ' 総合計
            m = 0
            For K = 0 To 20
                If p合計(K).bFlag Then m = m + 1
            Next
            If m > 0 Then m = m + 1
            If .Count > nRows Then
                n = .Count Mod nRows
            Else
                n = .Count
            End If
            i = m \ 2 + IIf(m Mod 2, 1, 0)
            
            If (n + i) > nRows Then
                n = .Count
                Do While n < nRows
                    n = .NewLine
                    .Data(n, "行区分") = 0
                    .Data(n & ":農地." & 1, "土地所在") = ""
                Loop
                m = 0
                Do While m < nRows - i
                    n = .NewLine
                    .Data(n, "行区分") = 0
                    .Data(n & ":農地." & 1, "土地所在") = ""
                    m = m + 1
                Loop
            
            ElseIf (n + i) < nRows Then
                m = n + i
                Do While m < nRows
                    n = .NewLine
                    .Data(n, "行区分") = 0
                    .Data(n & ":農地." & 1, "土地所在") = ""
                    m = m + 1
                Loop
            End If
            
            Set合計行 p合計, 9, 99999
            
            ' ページ設定
            n = .Count
            mvarParent.MaxPage = n \ nRows + IIf((n Mod nRows) > 0, 1, 0)
            mvarParent.Page = 1
        End With
    End Function
    
    Private Sub Set合計データ(p項目() As pTotal, p地目 As String, p面積 As Double, p分子 As Long, p分母 As Long)
        Dim bFlag As Boolean
        Dim i As Long
        
        bFlag = False
        For i = 0 To 20
            If StrComp(p地目, p項目(i).s地目) = 0 Then
                p項目(i).n面積 = p項目(i).n面積 + p面積
                If Not IsNull(p分母) And p分母 <> 0 Then
                    If p項目(i).n分子 = 0 And p項目(i).n分母 = 0 Then
                        p項目(i).n分子 = p分子
                        p項目(i).n分母 = p分母
                    Else
                        p項目(i).n分子 = p項目(i).n分子 * p分母
                        p項目(i).n分子 = p項目(i).n分子 + p分子 * p項目(i).n分母
                        p項目(i).n分母 = p項目(i).n分母 * p分母
                    End If
                Else
                    If p項目(i).n分子 = 0 And p項目(i).n分母 = 0 Then
                        p項目(i).n分子 = 1
                        p項目(i).n分母 = 1
                    Else
                        p項目(i).n分子 = p項目(i).n分子 + p項目(i).n分母
                    End If
                End If
                bFlag = True
                Exit For
            End If
        Next
        If bFlag = False Then
            For i = 0 To 20
                If p項目(i).bFlag = False Then
                    p項目(i).s地目 = p地目
                    p項目(i).n面積 = p項目(i).n面積 + p面積
                    If Not IsNull(p分母) And p分母 <> 0 Then
                        If p項目(i).n分子 = 0 And p項目(i).n分母 = 0 Then
                            p項目(i).n分子 = p分子
                            p項目(i).n分母 = p分母
                        Else
                            p項目(i).n分子 = p項目(i).n分子 * p分母
                            p項目(i).n分子 = p項目(i).n分子 + p分子 * p項目(i).n分母
                            p項目(i).n分母 = p項目(i).n分母 * p分母
                        End If
                    Else
                        If p項目(i).n分子 = 0 And p項目(i).n分母 = 0 Then
                            p項目(i).n分子 = 1
                            p項目(i).n分母 = 1
                        Else
                            p項目(i).n分子 = p項目(i).n分子 + p項目(i).n分母
                        End If
                    End If
                    p項目(i).bFlag = True
                    Exit For
                End If
            Next
        End If
    End Sub
    
    Private Sub Set総合計データ(p合計() As pTotal, p小計() As pTotal)
        Dim bFlag As Boolean
        Dim i As Long
        Dim n As Long

        For n = 0 To 20
            If p小計(n).bFlag Then
                bFlag = False
                For i = 0 To 20
                    If p合計(i).s地目 = p小計(n).s地目 Then
                        p合計(i).bFlag = True
                        p合計(i).n面積 = p合計(i).n面積 + p小計(n).n面積
                        p合計(i).n筆 = p合計(i).n筆 + p小計(n).n筆
                        bFlag = True
                        Exit For
                    End If
                Next
                
                If bFlag = False Then
                    For i = 0 To 20
                        If p合計(i).bFlag = False Then
                            p合計(i).bFlag = True
                            p合計(i).s地目 = p小計(n).s地目
                            p合計(i).n面積 = p小計(n).n面積
                            p合計(i).n筆 = p小計(n).n筆
                            Exit For
                        End If
                    Next
                End If
            End If
        Next
    End Sub
    
    Private Sub Set合計行(p項目() As pTotal, p行区分 As Long, p合計行No As Long)
        Dim nArea As Double
        Dim nLand As Long
        Dim nCount As Long
        Dim St1 As String
        Dim St2 As String
        Dim St As String
        Dim i As Long
        Dim n As Long
        Dim nWork As Double
        
        With mvarPData
            nLand = 0: nArea = 0: nCount = 0
            St1 = "": St2 = "": St = ""
            For i = 0 To 20
                If p項目(i).bFlag = True Then
                    If nCount = 2 Then
                        n = .NewLine
                        .Data(n, "行区分") = p行区分
                        .Data(n & ":農地." & 1, "土地所在") = St
                        .Data(n & ":農地." & 1, "登記地目") = St1
                        .Data(n & ":農地." & 1, "面積") = St2
                        St = "": St1 = "": St2 = ""
                        nCount = 0
                    End If
                    St = St & p項目(i).s地目 & "\n"
                    St1 = St1 & Format(p項目(i).n筆, "#")
                    If p項目(i).n分子 <> 0 And p行区分 = 8 Then
                        If p項目(i).n筆 > 0 Then St1 = St1 & "・"
                        計算A p項目(i).n分子, p項目(i).n分母
                        St1 = St1 & p項目(i).n分子 & "/" & p項目(i).n分母
                    End If
                    St1 = St1 & " 筆\n"
                    St2 = St2 & 面積整形(p項目(i).n面積) & "\n"
                    nArea = nArea + p項目(i).n面積
                    nLand = nLand + p項目(i).n筆
                    nCount = nCount + 1
                End If
            Next
            
'            If nLand > 1 Then
                If nCount = 2 Then
                    n = .NewLine
                    .Data(n, "行区分") = p行区分
                    .Data(n & ":農地." & 1, "土地所在") = St
                    .Data(n & ":農地." & 1, "登記地目") = St1
                    .Data(n & ":農地." & 1, "面積") = St2
                    n = .NewLine
                    .Data(n, "行区分") = p行区分
                    .Data(n, "合計行") = p合計行No
                    .Data(n & ":農地." & 1, "土地所在") = "合計"
                    .Data(n & ":農地." & 1, "登記地目") = Format(nLand, "#") & " 筆"
                    .Data(n & ":農地." & 1, "面積") = 面積整形(nArea)
               ElseIf nCount = 1 Then
                    St = St & "合計"
                    St1 = St1 & Format(nLand, "#") & " 筆"
                    St2 = St2 & 面積整形(nArea)
                    n = .NewLine
                    .Data(n, "行区分") = p行区分
                    .Data(n, "合計行") = p合計行No
                    .Data(n & ":農地." & 1, "土地所在") = St
                    .Data(n & ":農地." & 1, "登記地目") = St1
                    .Data(n & ":農地." & 1, "面積") = St2
                End If
'            End If
        End With
    End Sub
    
    Private Function 面積整形(n面積 As Double) As String
       Dim nWork As Double
        
        nWork = n面積 - Fix(n面積)
        If nWork = 0 Then
            面積整形 = FormatNumber(n面積, 0)
        Else
            面積整形 = FormatNumber(n面積, 2)
        End If
    End Function
    
    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property

    Private Property Let CPrintCls_Key(ByVal RHS As String)

    End Property

    Private Property Get CPrintCls_Key() As String: CPrintCls_Key = mvarKey: End Property
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants: CPrintCls_Orientation = vbPRORLandscape: End Property

    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&)
        mvarParent.Page = nNewPage
        CPrintCls_Repaint
    End Sub
    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Set CPrintCls_Parent(RHS As ADBasicLIB2.CPrintFormSK): Set mvarParent = RHS: End Property

    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        mvarParent.PrintPage = 1
        mvarParent.PrintMaxPage = mvarParent.MaxPage
            
        If bNowPage Then
            PrintSub mvarParent.Page
            mvarParent.EndDoc
        Else
            Do Until mvarParent.PrintPage > mvarParent.PrintMaxPage
                PrintSub mvarParent.PrintPage
                mvarParent.NewPage
            Loop
            mvarParent.EndDoc
        End If
    
    End Sub

    Private Sub CPrintCls_Repaint()
        PrintSub mvarParent.Page
    End Sub

    Private Sub CPrintCls_TargetChange(sKey As String)

    End Sub

    Private Sub PrintSub(nPage As Long)
        Dim nFsize As Integer
        Dim Ar As Variant, Cm As Variant
        Dim n As Long, i As Long
        Dim y As Single
        Dim dX(25) As Single, hX(25) As Single
        Dim Xcnt As Long
        Dim nStart As Long, nEnd As Long
        Dim nRows As Long, nRowH As Long
        Dim nWork As Double
        Dim St1 As String, St2 As String
        Dim K As Long
        Dim bFlag As Boolean
        Dim SY As Single, SX As Single
        
        nFsize = 7
        nRows = 14
        nRowH = 10
        SY = 50
        SX = 15
        
        Ar = GetArray(8, 9, 11, 29, 20, 34, 6, 12, 18, 13, 16, 11, 11, 10, 11, 20, 11, 16)
        dX(0) = SX
        hX(0) = dX(0) + Ar(0) / 2
        For i = 0 To UBound(Ar)
            dX(i + 1) = dX(i) + Ar(i)
            If i < UBound(Ar) Then hX(i + 1) = dX(i + 1) + Ar(i + 1) / 2
        Next
        Xcnt = UBound(Ar) + 1

        With mvarParent
            .ClearScreen
            .Offset 0, 0
            .TextOut "第 " & s総会番号 & " 回定例総会付議案件　非農地証明　申請書受付・交付簿", dX(0) + 5, 29, 10, 0, 0
            .TextOut "会　長", dX(6) + 10.5, 22, nFsize, 2, 2
            .TextOut "事務局長", dX(6) + 31.5, 22, nFsize, 2, 2
            .TextOut "係　長", dX(6) + 52.5, 22, nFsize, 2, 2
            .TextOut "係", dX(6) + 78, 22, nFsize, 2, 2
            .TextOut Fnc.s市町村名 & "農業委員会", dX(Xcnt) - 2, 37.5, 9, 1, 1

            .DrawText "整理\n番号\n(月通)", dX(0), 40, Ar(0), 3, 6, 2, 0
            .DrawText "受付\n番号\n(年度通)", dX(1), 46 - 2, Ar(1), 2, 5, 2, 2
            .TextOut "受　　付", (dX(1) + dX(3)) / 2, 40, nFsize, 2, 2
            .TextOut "年月日", hX(2), 46, nFsize, 2, 2
            .TextOut "申　請　人", (Ar(3) + Ar(4)) / 2 + dX(3), 40, nFsize, 2, 2
            .TextOut "住　　所", hX(3), 46, nFsize, 2, 2
            .TextOut "氏　名", hX(4), 46, nFsize, 2, 2
            .TextOut "申　　請　　地", (dX(5) + dX(9)) / 2, 40, nFsize, 2, 2
            .TextOut "所　　　在", hX(5), 46, nFsize, 2, 2
            .TextOut "持分", hX(6), 46, nFsize, 2, 2
            .TextOut "地目", hX(7), 46, nFsize, 2, 2
            .TextOut "地　積", hX(8), 44, nFsize, 2, 2
            .TextOut "(u)", hX(8), 48, nFsize, 2, 2
            .TextOut "現況地目", hX(9), 44, nFsize, 2, 2
            .TextOut "処　　　理　　　状　　　況", (dX(10) + dX(Xcnt)) / 2, 40, nFsize, 2, 2
            .TextOut "転　用", hX(10), 44, nFsize, 2, 2
            .TextOut "年月日", hX(10), 48, nFsize, 2, 2
            .TextOut "取下げ", hX(11), 44, nFsize, 2, 2
            .TextOut "年月日", hX(11), 48, nFsize, 2, 2
            .TextOut "町委員会", hX(12), 44, nFsize - 1, 2, 2
            .TextOut "年月日", hX(12), 48, nFsize, 2, 2
            .TextOut "決定", hX(13), 44, nFsize, 2, 2
            .TextOut "番号", hX(13), 48, nFsize, 2, 2
            .TextOut "交　　付", (dX(14) + dX(17)) / 2, 44, nFsize, 2, 2
            .TextOut "年月日", hX(14), 48, nFsize, 2, 2
            .TextOut "受領者氏名", hX(15), 48, nFsize, 2, 2
            .TextOut "印", hX(16), 48, nFsize, 2, 2
            .TextOut "備　考", hX(17), 46, nFsize, 2, 2
            
            ' 印
            .DLine dX(6), 20, dX(14), 20
            .DLine dX(6), 24, dX(14), 24
            .DLine dX(6), 20, dX(6), 38
            .DLine dX(6) + 21, 20, dX(6) + 21, 38
            .DLine dX(6) + 42, 20, dX(6) + 42, 38
            .DLine dX(6) + 63, 20, dX(6) + 63, 38
            .DLine dX(14), 20, dX(14), 38
        
            ' 見出し／横線
            .DLine dX(0), 38, dX(Xcnt), 38
            .DLine dX(1), 42, dX(9), 42
            .DLine dX(10), 42, dX(Xcnt), 42
            .DLine dX(13), 46, dX(17), 46
            
            ' 見出し／縦線
            For n = 0 To Xcnt
                Select Case n
                    Case 0, 1, 3, 5, 9, 10, Xcnt
                        .DLine dX(n), 38, dX(n), SY
                    Case 15, 16
                        .DLine dX(n), 46, dX(n), SY
                    Case Else
                        .DLine dX(n), 42, dX(n), SY
                End Select
            Next
            .LineBoxDX dX(0), SY, 0, 1, nRows * nRowH, Ar
            
            If nPage = 0 Then Exit Sub
        
            nStart = (nPage - 1) * nRows + 1
            nEnd = nStart + nRows - 1
            If nEnd > mvarPData.Count Then nEnd = mvarPData.Count
            y = SY
            bFlag = False
            For n = nStart To nEnd
                If Val(mvarPData.Data(n, "行区分")) > 7 Then
                    If (bFlag = False) And (Val(mvarPData.Data(n, "行区分")) = 9) Then
                        .DrawText "月合計", dX(5) + 2, y + 1, Ar(5) - 2, 5, nFsize
                        bFlag = True
                    End If
                    .DrawText mvarPData.Data(n & ":農地." & 0, "土地所在"), dX(5) + 15, y + 1, Ar(5), 5, nFsize
                    .DrawText mvarPData.Data(n & ":農地." & 0, "登記地目"), dX(5), y + 1, Ar(5) - 1, 5, nFsize, 1, 0
                    .DrawText mvarPData.Data(n & ":農地." & 0, "面積"), dX(8), y + 1, Ar(8) - 1, 5, nFsize, 1, 0
                Else
                    .TextOut mvarPData.Data(n, "受付番号"), dX(1) - 2, y + 2, nFsize, 1, 2
                    .TextOut mvarPData.Data(n, "通年受付番号"), dX(2) - 2, y + 2, nFsize, 1, 2
                    .DrawText SetDate(mvarPData.Data(n, "受付年月日")), dX(2) + 1, y, Ar(2), 4, nFsize, 0, 2, 10
                    .DrawText Left(mvarPData.Data(n, "申請人住所"), 16), dX(3) + 1, y, Ar(3) - 1, 4, nFsize, 0, 2, 10
                    .DrawText Left(mvarPData.Data(n, "申請人氏名"), 12), dX(4) + 1, y, Ar(4) - 1, 4, nFsize, 0, 2, 10
                    
                    .DrawText mvarPData.Data(n, "変更年月日txt"), dX(10) + 1, y + 1, Ar(10) - 1, 3, nFsize, 0
                    .DrawText SetDate(mvarPData.Data(n, "取下年月日")), dX(11) + 1, y, Ar(11), 4, nFsize, 0, 2, 10
                    .DrawText SetDate(mvarPData.Data(n, "総会日")), dX(12) + 1, y, Ar(12), 4, nFsize, 0, 2, 10
                    .DrawText mvarPData.Data(n, "決定"), dX(13), y + 1, Ar(13), 4, nFsize, 2
                    .DrawText Format(mvarPData.Data(n, "許可番号"), "#"), dX(13), y + 5, Ar(13), 4, nFsize, 2

                    .DrawText mvarPData.Data(n & ":農地." & 0, "土地所在"), dX(5) + 1, y, Ar(5) - 1, 4, nFsize, 0, 2, 10
                    .DrawText mvarPData.Data(n & ":農地." & 0, "持分"), dX(6), y, Ar(6), 4, nFsize, 2, 2, 10
                    .DrawText mvarPData.Data(n & ":農地." & 0, "登記地目"), dX(7), y, Ar(7), 4, nFsize, 2, 2, 10
                    If Val(mvarPData.Data(n & ":農地." & 0, "面積")) <> 0 Then
                        .TextOut 面積整形(Val(mvarPData.Data(n & ":農地." & 0, "面積"))), dX(9) - 1, y + 4, nFsize, 1, 2
                    End If
                    .DrawText mvarPData.Data(n & ":農地." & 0, "現況地目"), dX(9), y, Ar(9), 4, nFsize, 2, 2, 10
                    .DrawText mvarPData.Data(n, "備考"), dX(16), y, Ar(16) - 1, 4, nFsize, 1, 2, 10
                End If
                y = y + nRowH
                If Val(mvarPData.Data(n, "行区分")) < 8 Then
                    If Val(mvarPData.Data(n + 1, "行区分")) = 1 Then
                        .DLine dX(5), y, dX(10), y
                    ElseIf Val(mvarPData.Data(n + 1, "行区分")) = 8 Then
                        .DLine dX(5), y, dX(10), y
                    Else
                        .DLine dX(0), y, dX(Xcnt), y
                    End If
                End If
                If (Val(mvarPData.Data(n, "合計行")) = 99999) Or (Val(mvarPData.Data(n, "合計行")) = 88888) Then
                    .DLine dX(0), y, dX(Xcnt), y
                End If
            Next
            Do Until y > nRowH * nRows + SY
                .DLine dX(0), y, dX(Xcnt), y
                y = y + nRowH
            Loop
        End With
    End Sub

    Private Function SetDate(vDate As Variant) As String
        Dim St As String
        Dim n As Long
        
        If IsDate(vDate) Then
            If CDate(vDate) > 0 Then
                St = Format(vDate, "GEE-MM/DD")
                n = InStr(St, "-")
                SetDate = Left(St, n - 1) & "\n " & MID(St, n + 1)
            Else
                SetDate = ""
            End If
        Else
            SetDate = ""
        End If
    End Function
    
    Private Sub 計算A(pDataA As Long, pDataB As Long)
        Dim n As Long
        
        n = 2
        Do While (n < pDataA And n < pDataB)
            If (pDataA Mod n = 0) And (pDataB Mod n = 0) Then
                pDataA = pDataA / n
                pDataB = pDataB / n
                Exit Do
            End If
            n = n + 1
        Loop
    End Sub

End Class










Class CPrint受理通知書
    Option Explicit
    Implements CPrintCls
    Private mvarParent As CPrintFormSK
    Private mvarKey As String
    Private mvarKojin As String
    Private mvarTochi As String
    Private Const nFsize = 10.5

    Private Property Get CPrintCls_CanCancelPrint() As Boolean: End Property
    Private Property Get CPrintCls_CanPrintNowPage() As Boolean: End Property

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim RsT As ADBasicLIB2.RecordsetEx
        Dim sSQL As String
        Dim St As String
        
        mvarKey = sParam
        mvarKojin = ""
        mvarTochi = ""

        Set Rs = SystemDB.GetRecordsetEx("SELECT * FROM [D_申請] WHERE [ID]=" & 132, 0, , "受理通知書")
        If Not Rs.EOF Then
            mvarKojin = mvarKojin & SystemDB.GetDirectData("D:個人Info", "氏名", Val(Rs.V("申請者B"))) & ";" & Rs.V("住所B") & ";"
            mvarKojin = mvarKojin & SystemDB.GetDirectData("D:個人Info", "氏名", Val(Rs.V("申請者A"))) & ";" & Rs.V("住所A") & ";"
            St = Replace(Replace(Rs.V("農地リスト"), "農地.", ""), ";", ",")
            Set RsT = SystemDB.GetRecordsetEx("SELECT [V_農地].*,[V_地目].名称 AS [登記地目],[地目2].名称 AS [現況地目] FROM (([V_農地] INNER JOIN [V_地目] ON [V_農地].[登記簿地目]=[V_地目].ID) INNER JOIN V_地目 AS 地目2 ON [V_農地].[現況地目]=[地目2].ID) INNER JOIN [D:農地Info] ON [V_農地].ID = [D:農地Info].ID WHERE [V_農地].[ID] IN (" & St & ")", 0, , "受理通知書")
            Do Until RsT.EOF
                mvarTochi = mvarTochi & RsT.V("土地所在") & ";" & RsT.V("登記地目") & ";" & RsT.V("現況地目") & ";" & RsT.V("登記簿面積") & vbCrLf
                RsT.MoveNext
            Loop
            RsT.CloseRs
        End If
        Rs.CloseRs
    End Function

    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property

    Private Property Let CPrintCls_Key(ByVal RHS As String)
        Debug.Assert False
    End Property
    Private Property Get CPrintCls_Key() As String: CPrintCls_Key = mvarKey: End Property
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants: CPrintCls_Orientation = vbPRORPortrait: End Property

    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&)

    End Sub
    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Set CPrintCls_Parent(RHS As ADBasicLIB2.CPrintFormSK): Set mvarParent = RHS: End Property

    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        CPrintCls_Repaint
        mvarParent.EndDoc
    End Sub

    Private Sub CPrintCls_Repaint()
        Select Case mvarKey
            Case "3条": PrintSub3条
            Case "4条": PrintSub4条
            Case "5条": PrintSub5条
            Case Else
        End Select
    End Sub

    Private Sub CPrintCls_TargetChange(sKey As String)

    End Sub

    Private Sub PrintSub3条()
        Dim Ar As Variant
        Dim Ar2 As Variant
        Dim Cm As Variant
        Dim n As Long
        Dim y As Long
        
        Ar = GetArray(18, 44, 100)
        Ar2 = GetArray(60, 16, 16, 20, 23, 27)

        With mvarParent
            .ClearScreen
            
            ADApp.Common.DrawPrintData mvarParent, "受理証明3条"
            
            .DrawText "面   積\nu", 112, 174, 20, 5, nFsize, 2, 2
            .DrawText "権利の設定\n又は移転の別", 155, 174, 27, 5, nFsize, 2, 2
            
            .LineBoxDX 20, 119, 7, 2, 10, Ar
            .LineBoxDX 20, 182, 0, 5, 7, Ar2
        
'            If Len(mvarKojin) Then
'                Ar = Split(mvarKojin, ";")
'                .TextOut Ar(0), 40 , 131 , nFsize, 0, 2
'                .TextOut Ar(1), 84 , 131 , nFsize, 0, 2
'                .TextOut Ar(2), 40 , 141 , nFsize, 0, 2
'                .TextOut Ar(3), 84 , 141 , nFsize, 0, 2
'                Ar = Split(mvarTochi, vbCrLf)
'                For n = 0 To UBound(Ar) - 1
'                    Cm = Split(Ar(n), ";")
'                    Y = 185.5 + n * 7
'                    .TextOut Cm(0), 21 , Y, nFsize, 0, 2
'                    .TextOut Cm(1), 88 , Y, nFsize, 2, 2
'                    .TextOut Cm(2), 104 , Y, nFsize, 2, 2
'                    .TextOut FormatNumber(Cm(3), 0), 131 , Y, nFsize, 1, 2
'                Next
'            End If
        
        End With
    End Sub

    Private Sub PrintSub4条()
        Dim Ar As Variant
        
        Ar = GetArray(60, 28, 18, 18, 18)

        With mvarParent
            .ClearScreen
            
            ADApp.Common.DrawPrintData mvarParent, "受理証明4条"
            
            .DrawText "1　届出書の\n 氏名及び住\n 所", 22, 116, 24, 5, nFsize, 0, 0
            .DrawText "2　土地の所\n 在,地番,地\n 目及び面積", 22, 138, 24, 5, nFsize, 0, 0
            .DrawText "面　積\nu", 168, 145, 18, 5, nFsize, 2, 2
            .DrawText "3　届出書が\n 到達した日", 22, 211, 24, 5, nFsize, 0, 0
            .DrawText "4　届出に係\n る転用の目\n 的", 22, 227, 24, 5, nFsize, 0, 0
            
            .LineBoxDX 44, 153, 0, 5, 9, Ar
        End With
    End Sub
    Private Sub PrintSub5条()
        Dim Ar As Variant
        Dim Ar2 As Variant
        
        Ar = GetArray(20, 36, 90)
        Ar2 = GetArray(60, 28, 18, 18, 22)

        With mvarParent
            .ClearScreen
            
            ADApp.Common.DrawPrintData mvarParent, "受理証明5条"
            
            .DrawText "1　届出書の\n 氏名及び住\n 所", 22, 103, 24, 5, nFsize, 0, 0
            .DrawText "2　土地の所\n 在,地番,地\n 目及び面積\n 並びに権利\n の種類及び\n 設定又は移\n 転の別", 22, 131, 24, 5, nFsize, 0, 0
            .DrawText "面　積\nu", 168, 138, Ar2(4), 5, nFsize, 2, 2
            .DrawText "権利の種類及び設\n定又は移転の別", 45, 209, 30, 5, nFsize, 0, 2
            .DrawText "3　届出書が\n 到達した日", 22, 218, 24, 5, nFsize, 0, 0
            .DrawText "4　届出に係\n る転用の目\n 的", 22, 233, 24, 5, nFsize, 0, 0
            
            .LineBoxDX 44, 100, 10, 2, 9, Ar
            .LineBoxDX 44, 146, 0, 5, 9, Ar2
          
        End With
    End Sub

End Class










Class Cprint集計
    Option Explicit
    Implements CPrintCls
    Private mvarParent As CPrintFormSK
    Private mvarKey As String
    Private nPage As Long
    Private s市町村 As String
    Private mvarTable As String

    Private Property Get CPrintCls_CanCancelPrint() As Boolean

    End Property

    Private Property Get CPrintCls_CanPrintNowPage() As Boolean

    End Property

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim sSQL As String
        Dim nLine As Long
        Dim St As String
        Dim i As Long
        Dim n As Long
        Dim Ar As Variant, Cm As Variant
        Dim Total(6) As Long
        
        mvarKey = sParam
        
        mvarParent.MaxPage = 1
        mvarParent.表示倍率 = 0.75

        Select Case sParam
            Case "小作形態別集計"
                sSQL = "SELECT IIf([小作地適用法]=0 Or IsNull([小作地適用法]),3,[小作地適用法]) AS 適用法, IIf(IsNull([小作形態]) Or [小作形態]>3 Or [小作形態]=0,3,[小作形態]) AS 形態, Count([D:農地Info].ID) AS 筆数, Sum([D:農地Info].田面積) AS 田面積の合計, Sum([D:農地Info].畑面積) AS 畑面積の合計"
                sSQL = sSQL & " FROM [D:農地Info]"
                sSQL = sSQL & " WHERE ((([D:農地Info].自小作別) > 0))"
                sSQL = sSQL & " GROUP BY IIf([小作地適用法]=0 Or IsNull([小作地適用法]),3,[小作地適用法]), IIf(IsNull([小作形態]) Or [小作形態]>3 Or [小作形態]=0,3,[小作形態])"
                sSQL = sSQL & " ORDER BY IIf([小作地適用法]=0 Or IsNull([小作地適用法]),3,[小作地適用法]), IIf(IsNull([小作形態]) Or [小作形態]>3 Or [小作形態]=0,3,[小作形態]);"

                Set Rs = SystemDB.GetRecordsetEx(sSQL, , , "集計")
                mvarTable = Rs.GetString(";", vbCrLf)
                Rs.CloseRs
                mvarParent.表示倍率 = 1
            Case "後継者状況別世帯件数集計表"
                sSQL = "SELECT [D:個人Info].行政区ID, [V_行政区].行政区, Count([D:個人Info].ID) AS IDのカウント"
                sSQL = sSQL & " FROM [D:個人Info] INNER JOIN [V_行政区] ON [D:個人Info].行政区ID = [V_行政区].ID"
                sSQL = sSQL & " WHERE ((([D:個人Info].農業跡継ぎ)=True))"
                sSQL = sSQL & " GROUP BY [D:個人Info].行政区ID, [V_行政区].行政区;"
                Set Rs = SystemDB.GetRecordsetEx(sSQL, , , "集計")
                If Rs.EOF Then
                Else
                    mvarTable = Rs.GetString(";", vbCrLf)
                    nLine = Len(mvarTable)
                    St = Replace(mvarTable, vbCrLf, vbTab)
                    nLine = nLine - Len(St)
                    n = 0
                    Ar = Split(mvarTable, vbCrLf)
                    For i = 0 To UBound(Ar) - 1
                        Cm = Split(Ar(i), ";")
                        n = n + Val(Cm(2))
                    Next
                    mvarTable = mvarTable & ";合　計;" & n
                    mvarParent.MaxPage = nLine / 20 + IIf((nLine Mod 20) = 0, 0, 1)
                End If
                Rs.CloseRs
                
            Case "地区別世帯件数集計"
                Dim Rsx As ADBasicLIB2.RecordsetEx
                Dim d農地所有 As New CDataDictionary
                Dim d農地耕作 As New CDataDictionary
                Dim d田所有 As New CDataDictionary
                Dim d田耕作 As New CDataDictionary
                Dim d畑所有 As New CDataDictionary
                Dim d畑耕作 As New CDataDictionary
                
                sSQL = "SELECT [所有世帯].行政区ID, Count( [所有世帯].農家世帯ID) AS [世帯数] "
                sSQL = sSQL & "FROM (SELECT [V_農地].農家世帯ID, [D:世帯Info].行政区ID FROM [V_農地] LEFT JOIN [D:世帯Info] ON [V_農地].農家世帯ID = [D:世帯Info].ID GROUP BY [V_農地].農家世帯ID, [D:世帯Info].行政区ID) AS [所有世帯] "
                sSQL = sSQL & "GROUP BY  [所有世帯].行政区ID;"
                Set Rsx = SystemDB.GetRecordsetEx(sSQL, 0, , Me)

                Do Until Rsx.EOF
                    If d農地所有.Exists(Rsx.Value("行政区ID")) Then
                        d農地所有.Item(Rsx.Value("行政区ID")) = d農地所有.Item(Rsx.Value("行政区ID")) + Rsx.Value("世帯数")
                    Else
                        d農地所有.Add Rsx.Value("行政区ID"), Rsx.Value("世帯数")
                    End If
                    Rsx.MoveNext
                Loop
                SystemDB.CloseRs Rsx
            
                sSQL = "SELECT [耕作世帯].行政区ID, Count( [耕作世帯].耕作世帯ID) AS [世帯数] "
                sSQL = sSQL & "FROM (SELECT [V_農地].耕作世帯ID, [D:世帯Info].行政区ID FROM [V_農地] LEFT JOIN [D:世帯Info] ON [V_農地].耕作世帯ID = [D:世帯Info].ID GROUP BY [V_農地].耕作世帯ID, [D:世帯Info].行政区ID) AS [耕作世帯] "
                sSQL = sSQL & "GROUP BY  [耕作世帯].行政区ID;"
                Set Rsx = SystemDB.GetRecordsetEx(sSQL, 0, , Me)

                Do Until Rsx.EOF
                    If d農地耕作.Exists(Rsx.Value("行政区ID")) Then
                        d農地耕作.Item(Rsx.Value("行政区ID")) = d農地耕作.Item(Rsx.Value("行政区ID")) + Rsx.Value("世帯数")
                    Else
                        d農地耕作.Add Rsx.Value("行政区ID"), Rsx.Value("世帯数")
                    End If
                    Rsx.MoveNext
                Loop
                SystemDB.CloseRs Rsx
            
                sSQL = "SELECT [所有世帯].行政区ID, Count( [所有世帯].農家世帯ID) AS [世帯数] "
                sSQL = sSQL & "FROM (SELECT [V_農地].農家世帯ID, [D:世帯Info].行政区ID FROM [V_農地] LEFT JOIN [D:世帯Info] ON [V_農地].農家世帯ID = [D:世帯Info].ID WHERE [V_農地].田面積>0 GROUP BY [V_農地].農家世帯ID, [D:世帯Info].行政区ID) AS [所有世帯] "
                sSQL = sSQL & "GROUP BY  [所有世帯].行政区ID;"
                Set Rsx = SystemDB.GetRecordsetEx(sSQL, 0, , Me)

                Do Until Rsx.EOF
                    If d田所有.Exists(Rsx.Value("行政区ID")) Then
                        d田所有.Item(Rsx.Value("行政区ID")) = d田所有.Item(Rsx.Value("行政区ID")) + Rsx.Value("世帯数")
                    Else
                        d田所有.Add Rsx.Value("行政区ID"), Rsx.Value("世帯数")
                    End If
                    Rsx.MoveNext
                Loop
                SystemDB.CloseRs Rsx
            
                sSQL = "SELECT [所有世帯].行政区ID, Count( [所有世帯].農家世帯ID) AS [世帯数] "
                sSQL = sSQL & "FROM (SELECT [V_農地].農家世帯ID, [D:世帯Info].行政区ID FROM [V_農地] LEFT JOIN [D:世帯Info] ON [V_農地].農家世帯ID = [D:世帯Info].ID WHERE [V_農地].畑面積>0 GROUP BY [V_農地].農家世帯ID, [D:世帯Info].行政区ID) AS [所有世帯] "
                sSQL = sSQL & "GROUP BY  [所有世帯].行政区ID;"
                Set Rsx = SystemDB.GetRecordsetEx(sSQL, 0, , Me)

                Do Until Rsx.EOF
                    If d畑所有.Exists(Rsx.Value("行政区ID")) Then
                        d畑所有.Item(Rsx.Value("行政区ID")) = d畑所有.Item(Rsx.Value("行政区ID")) + Rsx.Value("世帯数")
                    Else
                        d畑所有.Add Rsx.Value("行政区ID"), Rsx.Value("世帯数")
                    End If
                    Rsx.MoveNext
                Loop
                SystemDB.CloseRs Rsx
            
                sSQL = "SELECT [耕作世帯].行政区ID, Count( [耕作世帯].耕作世帯ID) AS [世帯数] "
                sSQL = sSQL & "FROM (SELECT [V_農地].耕作世帯ID, [D:世帯Info].行政区ID FROM [V_農地] LEFT JOIN [D:世帯Info] ON [V_農地].耕作世帯ID = [D:世帯Info].ID WHERE [V_農地].田面積>0 GROUP BY [V_農地].耕作世帯ID, [D:世帯Info].行政区ID) AS [耕作世帯] "
                sSQL = sSQL & "GROUP BY  [耕作世帯].行政区ID;"
                Set Rsx = SystemDB.GetRecordsetEx(sSQL, 0, , Me)

                Do Until Rsx.EOF
                    If d田耕作.Exists(Rsx.Value("行政区ID")) Then
                        d田耕作.Item(Rsx.Value("行政区ID")) = d田耕作.Item(Rsx.Value("行政区ID")) + Rsx.Value("世帯数")
                    Else
                        d田耕作.Add Rsx.Value("行政区ID"), Rsx.Value("世帯数")
                    End If
                    Rsx.MoveNext
                Loop
                SystemDB.CloseRs Rsx
            
                sSQL = "SELECT [耕作世帯].行政区ID, Count( [耕作世帯].耕作世帯ID) AS [世帯数] "
                sSQL = sSQL & "FROM (SELECT [V_農地].耕作世帯ID, [D:世帯Info].行政区ID FROM [V_農地] LEFT JOIN [D:世帯Info] ON [V_農地].耕作世帯ID = [D:世帯Info].ID WHERE [V_農地].畑面積>0 GROUP BY [V_農地].耕作世帯ID, [D:世帯Info].行政区ID) AS [耕作世帯] "
                sSQL = sSQL & "GROUP BY  [耕作世帯].行政区ID;"
                Set Rsx = SystemDB.GetRecordsetEx(sSQL, 0, , Me)

                Do Until Rsx.EOF
                    If d畑耕作.Exists(Rsx.Value("行政区ID")) Then
                        d畑耕作.Item(Rsx.Value("行政区ID")) = d畑耕作.Item(Rsx.Value("行政区ID")) + Rsx.Value("世帯数")
                    Else
                        d畑耕作.Add Rsx.Value("行政区ID"), Rsx.Value("世帯数")
                    End If
                    Rsx.MoveNext
                Loop
                SystemDB.CloseRs Rsx

                Set Rsx = SystemDB.GetRecordsetEx("SELECT [ID], [名称] FROM [V_行政区];", 0, , Me)
                mvarTable = ""
                Do Until Rsx.EOF
                    If d農地所有.Exists(Rsx.Value("ID")) Or d農地耕作.Exists(Rsx.Value("ID")) Then
                        mvarTable = mvarTable & Rsx.Value("ID") & ";" & Rsx.Value("名称")
                        mvarTable = mvarTable & ";" & IIf(d農地所有.Exists(Rsx.Value("ID")), d農地所有.Item(Rsx.Value("ID")), 0)
                        mvarTable = mvarTable & ";" & IIf(d農地耕作.Exists(Rsx.Value("ID")), d農地耕作.Item(Rsx.Value("ID")), 0)
                        mvarTable = mvarTable & ";" & IIf(d田所有.Exists(Rsx.Value("ID")), d田所有.Item(Rsx.Value("ID")), 0)
                        mvarTable = mvarTable & ";" & IIf(d田耕作.Exists(Rsx.Value("ID")), d田耕作.Item(Rsx.Value("ID")), 0)
                        mvarTable = mvarTable & ";" & IIf(d畑所有.Exists(Rsx.Value("ID")), d畑所有.Item(Rsx.Value("ID")), 0)
                        mvarTable = mvarTable & ";" & IIf(d畑耕作.Exists(Rsx.Value("ID")), d畑耕作.Item(Rsx.Value("ID")), 0)
                        mvarTable = mvarTable & vbCrLf
                    End If
                    Rsx.MoveNext
                Loop
                SystemDB.CloseRs Rsx

                nLine = Len(mvarTable)
                St = Replace(mvarTable, vbCrLf, vbTab)
                nLine = nLine - Len(St)
                Ar = Split(mvarTable, vbCrLf)

                For i = 0 To 6
                    Total(i) = 0
                Next

                For i = 0 To UBound(Ar) - 1
                    Cm = Split(Ar(i), ";")
                    Total(0) = Total(0) + Cm(2)
                    Total(1) = Total(1) + Cm(3)
                    Total(2) = Total(2) + Cm(4)
                    Total(3) = Total(3) + Cm(5)
                    Total(4) = Total(4) + Cm(6)
                    Total(5) = Total(5) + Cm(7)
                Next

                mvarTable = mvarTable & ";合　計"
                For i = 0 To 6
                    mvarTable = mvarTable & ";" & Total(i)
                Next
                mvarParent.MaxPage = nLine / 20 + IIf((nLine Mod 20) = 0, 0, 1)
            Case Else
        End Select
        mvarParent.Page = 1
        mvarParent.ExtPaperChange
    End Function
    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property
    Private Property Let CPrintCls_Key(ByVal RHS As String): mvarKey = RHS: End Property
    Private Property Get CPrintCls_Key() As String: CPrintCls_Key = mvarKey: End Property

    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants
        Select Case mvarKey
            Case "小作形態別集計": CPrintCls_Orientation = vbPRORLandscape
            Case "後継者状況別世帯件数集計表": CPrintCls_Orientation = vbPRORLandscape
            Case "地区別世帯件数集計": CPrintCls_Orientation = vbPRORLandscape
            
            Case Else
                CPrintCls_Orientation = vbPRORPortrait
        End Select
    End Property
    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&): CPrintCls_Repaint: End Sub
    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Set CPrintCls_Parent(RHS As ADBasicLIB2.CPrintFormSK): Set mvarParent = RHS: End Property

    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        mvarParent.PrintPage = 1
        mvarParent.PrintMaxPage = mvarParent.MaxPage

        Do Until mvarParent.PrintPage > mvarParent.PrintMaxPage
            Select Case mvarKey
                Case "小作形態別集計": sub小作形態別集計
                Case "後継者状況別世帯件数集計表": sub後継者状況別世帯件数集計表 mvarParent.PrintPage
                Case "地区別世帯件数集計": sub地区別世帯件数集計 mvarParent.PrintPage
                Case Else
            End Select
            mvarParent.NewPage
        Loop
        mvarParent.EndDoc
    End Sub

    Private Sub CPrintCls_Repaint()
        Select Case mvarKey
            Case "小作形態別集計": sub小作形態別集計
            Case "後継者状況別世帯件数集計表": sub後継者状況別世帯件数集計表 mvarParent.Page
            Case "地区別世帯件数集計": sub地区別世帯件数集計 mvarParent.Page
            Case Else
        End Select
    End Sub
    Private Sub CPrintCls_TargetChange(sKey As String): CPrintCls_Repaint: End Sub

    Private Sub sub後継者状況別世帯件数集計表(nPage As Long)
        Dim Ar As Variant, Cm As Variant
        Dim i As Long
        Dim n As Long
        Dim x As Long
        Dim y As Long
        
        Dim nPit As Single, HH As Single, Rows As Long, Ay As Variant   'DX1個目
        Dim nFsize As Integer                                           'フォントサイズ
        
        HH = 8          'ヘッダーの高さ
        Rows = 20       '何セル分
        nPit = 8        '表の中の繰り返しの巾
        nFsize = 10     'フォンサイズ
        Ar = GetArray(18, 46, 20, 20, 20, 20, 20, 20, 20, 20, 20, 25)
        
        With mvarParent
            .ClearScreen
            .Offset -5, 0
    '----------------------------文字埋め
            .TextOut "後継者状況別世帯件数集計表", 148, 20, 14, 2, 0
            .TextOut "作成日：" & Format(Now(), "GGGEE年MM月DD日"), 281, 26, nFsize, 1, 2
            .TextOut "地区コード", 23, 34, 8, 2, 2
            .TextOut "地区名", 55, 34, nFsize, 2, 2
            .TextOut "後継者", 88, 34, nFsize, 2, 2
            .TextOut "予定者", 108, 34, nFsize, 2, 2
            .TextOut "志願者", 128, 34, nFsize, 2, 2
            .TextOut "対象外", 248, 34, nFsize, 2, 2
            .TextOut "合計件数", 270, 34, nFsize, 2, 2
            
    '------------------------------表作成
            .LineBoxDX 14, 30, HH, Rows, nPit, Ar

    '------------------------------当込み
            If Len(mvarTable) Then
                Ar = Split(mvarTable, vbCrLf)
                For i = 0 To Rows - 1
                    If Len(Ar(i)) Then
                        n = i + (nPage - 1) * Rows
                        If n > UBound(Ar) Then Exit For
                        Cm = Split(Ar(n), ";")

                        If Cm(1) = "合　計" Then
                            y = (i + 1) * nPit + 40
                            .TextOut Cm(1), 55, y, nFsize, 2
                            .TextOut FormatNumber(Val(Cm(2)), 0), 95, y, nFsize, 1
                        Else
                            y = i * nPit + 40
                            .TextOut Right$("000" & Cm(0), 3), 20, y, nFsize, 0
                            .TextOut Cm(1), 35, y, nFsize, 0
                            .TextOut FormatNumber(Val(Cm(2)), 0), 95, y, nFsize, 1
                        End If
                    End If
                Next
            End If
    '----------------------------------
        End With
    
    End Sub

    Private Sub sub地区別世帯件数集計(nPage As Long)
        Dim Ar As Variant, Cm As Variant
        Dim i As Long
        Dim n As Long
        Dim x As Long
        Dim y As Long
        
        Dim nPit As Single, HH As Single, Rows As Long, Ay As Variant   'DX1個目
        Dim nFsize As Integer                                           'フォントサイズ
        
        HH = 8          'ヘッダーの高さ
        Rows = 20       '何セル分
        nPit = 8        '表の中の繰り返しの巾
        nFsize = 10     'フォンサイズ
        Ar = GetArray(18, 48, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20)
        
        With mvarParent
            .ClearScreen
    '----------------------------文字埋め
            .TextOut "地区別世帯件数集計表", 147, 20, 13, 2, 2
            .TextOut "[単位:件]　　作成日：" & Format(Now(), "GGGEE年MM月DD日"), 280, 25, nFsize, 1, 2
            .TextOut "地区コード", 23, 32, 9, 2, 2
            .TextOut "地区名", 56, 32, nFsize, 2, 2
            .TextOut "農地所有", 90, 32, nFsize, 2, 2
            .TextOut "農地耕作", 110, 32, nFsize, 2, 2
            .TextOut "田 所 有", 130, 32, nFsize, 2, 2
            .TextOut "田 耕 作", 150, 32, nFsize, 2, 2
            .TextOut "畑 所 有", 170, 32, nFsize, 2, 2
            .TextOut "畑 耕 作", 190, 32, nFsize, 2, 2
            
    '------------------------------表作成
            .LineBoxDX 14, 28, HH, Rows, nPit, Ar

    '------------------------------当込み
            If Len(mvarTable) Then
                Ar = Split(mvarTable, vbCrLf)
                For i = 0 To Rows - 1
                    n = i + (nPage - 1) * Rows
                    If n > UBound(Ar) Then Exit For
                    Cm = Split(Ar(n), ";")
                    
                    If Cm(1) = "合　計" Then
                        y = (i + 1) * nPit + 38
                        .TextOut Cm(1), 56, y, nFsize, 2
                        .TextOut Cm(2), 98, y, nFsize, 1
                        .TextOut Cm(3), 118, y, nFsize, 1
                        .TextOut Cm(4), 138, y, nFsize, 1
                        .TextOut Cm(5), 158, y, nFsize, 1
                        .TextOut Cm(6), 178, y, nFsize, 1
                        .TextOut Cm(7), 198, y, nFsize, 1
                    Else
                        y = i * nPit + 38
                        .TextOut Right$("000" & Cm(0), 3), 20, y, nFsize, 0
                        .TextOut Cm(1), 35, y, nFsize, 0
                        .TextOut Cm(2), 98, y, nFsize, 1
                        .TextOut Cm(3), 118, y, nFsize, 1
                        .TextOut Cm(4), 138, y, nFsize, 1
                        .TextOut Cm(5), 158, y, nFsize, 1
                        .TextOut Cm(6), 178, y, nFsize, 1
                        .TextOut Cm(7), 198, y, nFsize, 1
                    End If
                Next
            End If
        End With
    End Sub

    Private Sub sub小作形態別集計()
        Dim sData As String
        Dim Ar As Variant, Cm As Variant
        
        Dim nPit As Single, HH As Single, Rows As Long, Ay As Variant       'DX1個目
        Dim i As Long
        Dim j As Long
        Dim x As Single
        Dim y As Single
        
        HH = 6      'ヘッダーの高さ
        Rows = 4    '何セル分
        nPit = 6   '表の中の繰り返しの巾
        Ar = GetArray(40, 52, 52, 52)
        Cm = GetArray(12, 20, 20, 12, 20, 20, 12, 20, 20)
        Ay = GetArray(40, 12, 20, 20, 12, 20, 20, 12, 20, 20)
        
        With mvarParent
            .ClearScreen
            .Offset 30, 0
            
            .TextOut "小作形態別集計", 105, 20, 12, 2, 2
            .LineBoxDX 13, 29, 12, 0, nPit, Ar
            .LineBoxDX 53, 35, HH, 0, nPit, Cm
            .LineBoxDX 13, 41, HH, Rows, nPit, Ay
            
            .TextOut "賃貸借", 79, 30, 11, 2
            .TextOut "使用貸借", 79 + 52, 30, 11, 2
            .TextOut "その他", 79 + 104, 30, 11, 2
            .TextOut "農地法", 15, 42, 11
            .TextOut "基盤強化法", 15, 48, 11
            .TextOut "その他", 15, 54, 11
            .TextOut "", 15, 66, 11
            
            .TextOut "筆数", 55, 36, 11
            .TextOut "田(u)", 75, 36, 11, 2
            .TextOut "畑(u)", 95, 36, 11, 2
            .TextOut "筆数", 55 + 52, 36, 11
            .TextOut "田(u)", 75 + 52, 36, 11, 2
            .TextOut "畑(u)", 95 + 52, 36, 11, 2
            .TextOut "筆数", 55 + 104, 36, 11
            .TextOut "田(u)", 75 + 104, 36, 11, 2
            .TextOut "畑(u)", 95 + 104, 36, 11, 2
            
            If Len(mvarTable) Then
                Ar = Split(mvarTable, vbCrLf)
                For i = 0 To UBound(Ar)
                If Len(Ar(i)) Then
                    Cm = Split(Ar(i), ";")
                    x = 12.5 + Val(Cm(1)) * 52
                    y = 36 + Val(Cm(0)) * 6
                    .TextOut Cm(2), x, y, 11, 1
                    .TextOut FormatNumber(Val(Cm(3)), 0), x + 20, y, 11, 1
                    .TextOut FormatNumber(Val(Cm(4)), 0), x + 40, y, 11, 1
                End If
                Next
            End If
        End With
    End Sub

End Class










Class CPrint奨励金交付申請書
    Option Explicit
    Implements CPrintCls
    Private mvarParent As CPrintFormSK
    Private mvarKey As String
    Private mvarPage As Long
    Private mvarData As String
    Private s会長 As String
    Private n年度 As Long

    Private Property Get CPrintCls_CanCancelPrint() As Boolean

    End Property

    Private Property Get CPrintCls_CanPrintNowPage() As Boolean

    End Property

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean
        Dim Rs As ADBasicLIB2.RecordsetEx
        
        Dim sSQL As String
        Dim pNode As Object
        mvarParent.表示倍率 = 0.8
        
        s会長 = SystemDB.DBProperty("会長名")
        n年度 = MID$(Fnc.Get年度("GEE", DateAdd("m", 1, Now())), 2)
        
        If InStr(sParam, "総会") Then
            mvarParent.UsedTreeView = True
            sSQL = "SELECT D_申請.ID,D_申請.法令,始期, D_申請.申請者A, D_申請.氏名A, D_申請.公告年月日,D_申請.数量,D_申請.条件A,D_申請.条件B, D_申請.住所A,農地リスト,パラメータリスト,D_申請.年齢A FROM [D_申請] WHERE ([法令] IN (990,991)) AND [総会番号]=" & MID$(sParam, InStr(sParam, "=") + 1)
            Set Rs = SystemDB.GetRecordsetEx(sSQL, 0, , Me)
            
            Do Until Rs.EOF
                Set pNode = mvarParent.TreeNodeAdd("ID." & Rs.ID, Rs.Value("氏名A"), "Farmer")
                pNode.Tag = Rs.GetLineString(GetArray("法令", "ID", "住所A", "氏名A", "数量", "条件A", "条件B", "年齢A"), vbTab) & vbTab & _
                GetLandList(Rs.Value("法令"), Rs.Value("申請者A"), Rs.Value("始期"), Rs.Value("パラメータリスト"), Format$(Rs.Value("公告年月日"), "GEE/MM/DD"))
                Rs.MoveNext
            Loop
            SystemDB.CloseRs Rs
        Else
        
        End If
            
        mvarParent.Page = 1
        mvarParent.MaxPage = 1
        mvarPage = 1
            
    End Function
    
    Private Function GetLandList(ByVal n法令 As Long, n本人 As Long, ByVal dtStart As Date, ByVal nAppList As String, ByVal sDate As String) As String
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim n As Long
        
        Select Case n法令
            Case 990: Set Rs = SystemDB.GetRecordsetEx("SELECT *,[D:個人Info].氏名 AS [相手],[V_現況地目].[名称] AS [地目] FROM ([V_農地] LEFT JOIN [D:個人Info] ON [V_農地].[耕作者ID]=[D:個人Info].ID) LEFT JOIN [V_現況地目] ON [V_農地].[現況地目] = [V_現況地目].[ID] WHERE ([管理人ID]=" & n本人 & ") AND ([借受人ID] IN (" & nAppList & ")) AND [小作開始年月日]=#" & dtStart & "#", 0, , Me)
            Case 991: Set Rs = SystemDB.GetRecordsetEx("SELECT *,[D:個人Info].氏名 AS [相手],[V_現況地目].[名称] AS [地目] FROM ([V_農地] LEFT JOIN [D:個人Info] ON [V_農地].[管理人ID]=[D:個人Info].ID) LEFT JOIN [V_現況地目] ON [V_農地].[現況地目] = [V_現況地目].[ID] WHERE ([借受人ID]=" & n本人 & ") AND ([管理人ID] IN (" & nAppList & ")) AND [小作開始年月日]=#" & dtStart & "#", 0, , Me)
        End Select
        GetLandList = ""
        n = 0
        Do Until Rs.EOF
            GetLandList = GetLandList & ";" & Rs.Value("土地所在") & "," & Replace(Rs.Value("地目"), "普通", "") & "," & Rs.Value("登記簿面積") & "," & IIf(Rs.Value("小作形態") = 1, "賃貸借権", "使用貸借") & "," & sDate & "," & Rs.DateDiff("yyyy", "小作開始年月日", "小作終了年月日") & "," & Rs.Value("相手") & "," & IIf(Rs.Value("再設定"), "再設定", "新規")
            n = n + 1
            Rs.MoveNext
        Loop
        GetLandList = n & vbTab & MID$(GetLandList, 2)
        SystemDB.CloseRs Rs
    End Function

    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property

    Private Property Let CPrintCls_Key(ByVal RHS As String): End Property
    
    Private Property Get CPrintCls_Key() As String: CPrintCls_Key = mvarKey: End Property
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants: CPrintCls_Orientation = vbPRORLandscape: End Property

    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&)
        mvarPage = nNewPage
        CPrintCls_Repaint
    End Sub
    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Set CPrintCls_Parent(RHS As ADBasicLIB2.CPrintFormSK): Set mvarParent = RHS: End Property

    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        Dim pNode As Object
        Dim Ar As Variant
        Dim mPage As Long
        Dim n As Long
        Dim sData As String
        Dim f As Boolean
        f = False
        For Each pNode In mvarParent.Nodes
            If pNode.Checked Then
                sData = pNode.Tag
                Ar = Split(sData, vbTab)
                Select Case Val(Ar(8))
                    Case 0, 1, 2, 3, 4, 5, 6: mPage = 1
                    Case 7, 8, 9, 10, 11, 12: mPage = 2
                    Case 13, 14, 15, 16, 17, 18: mPage = 3
                    Case 19, 20, 21, 22, 23, 24: mPage = 4
                End Select
                
                For n = 1 To mPage
                    Select Case Val(Left$(sData, 3))
                        Case 990: PrintPage1 n, sData
                        Case 991: PrintPage2 n, sData
                    End Select
                    f = True
                    mvarParent.NewPage
                Next
                
                pNode.Checked = False
            End If
        Next
        If f Then mvarParent.EndDoc
    End Sub

    Private Sub CPrintCls_Repaint()
        Select Case Val(Left$(mvarData, 3))
            Case 990: PrintPage1 mvarParent.Page, mvarData
            Case 991: PrintPage2 mvarParent.Page, mvarData
        End Select
    End Sub

    Private Sub CPrintCls_TargetChange(sKey As String)
        Dim Ar As Variant
        mvarData = mvarParent.Nodes.Item(sKey).Tag
        Ar = Split(mvarData, vbTab)
        Select Case Val(Ar(8))
            Case 0, 1, 2, 3, 4, 5, 6: mvarParent.MaxPage = 1
            Case 7, 8, 9, 10, 11, 12: mvarParent.MaxPage = 2
            Case 13, 14, 15, 16, 17, 18: mvarParent.MaxPage = 3
            Case 19, 20, 21, 22, 23, 24: mvarParent.MaxPage = 4
        End Select
        mvarParent.Page = 1
        CPrintCls_Repaint
    End Sub

    Private Sub PrintPage1(ByVal nPage As Long, pData As String)
        Dim nFsize As Integer, nFsizeH As Integer
        Dim Ar As Variant
        Dim Cm As Variant
        Dim Cx As Variant
        Dim n As Long, i As Long
        Dim dX(20) As Single
        Dim Xcnt As Long
        Dim n基本料 As Single
        
        If Len(pData) = 0 Then Exit Sub
        nFsize = 9
        nFsizeH = 15
        
        Ar = GetArray(8, 38, 8, 16, 13, 19, 8, 22, 13, 17, 19, 22, 20, 12, 22)
        dX(0) = 16
        For n = 0 To UBound(Ar)
            dX(n + 1) = dX(n) + Ar(n)
        Next
        Xcnt = UBound(Ar) + 1
        
        With mvarParent
            .ClearScreen
            .Offset 0, 0
            Cm = Split(pData, vbTab)
            
            .TextOut "（第１号様式）", 15, 15, nFsize, 0, 0
            .TextOut "平成 " & n年度 & " 年度農地流動化奨励金交付申請書", 60, 25, 20, 0, 1
            .TextOut "（兼交付台帳）", 200, 25, nFsizeH, 0, 1
            .TextOut Fnc.s市町村名 & "農業委員会", 15, 33, nFsizeH, 0, 0
            .TextOut "会長　" & s会長 & "　殿", 15, 41, nFsizeH, 0, 0
            .TextOut "平成　　　年　　　月　　　日", 132, 46, nFsize, 0, 0
            .TextOut "申請人住所", 164, 59, nFsizeH, 0, 1
            .TextOut Fnc.GetShortAddress(Cm(2), SystemDB.DBProperty("都道府県名"), SystemDB.DBProperty("郡部"), , , True), dX(11), 59, nFsizeH - 1, 0, 1
            .TextOut "申請人氏名", 164, 66, nFsizeH, 0, 1
            .TextOut Cm(3), dX(11), 66, nFsizeH - 1, 0, 1
            .TextOut "印（年齢　" & IIf(Val(Cm(7)) > 0, Cm(7), "  ") & "　才）", dX(Xcnt), 66, nFsize, 1, 1
            .TextOut "　下記により" & Fnc.s市町村名 & "農地流動化奨励金交付要綱に基づく、農地流動化奨励金を交付されたく申請します。", 15, 75, nFsizeH, 0, 0
            .TextOut "交 　付 　対 　象 　農 　用 　地", (dX(4) - dX(0)) / 2 + dX(0), 90.5, nFsize, 2, 2
            .TextOut "番号", (dX(1) - dX(0)) / 2 + dX(0), 101, nFsize, 2, 2
            .TextOut "土 地 所 在", (dX(2) - dX(1)) / 2 + dX(1), 101, nFsize, 2, 2
            .TextOut "地目", (dX(3) - dX(2)) / 2 + dX(2), 101, nFsize, 2, 2
            .DrawText "面　積\nu @", dX(3), 97, Ar(3), 6, nFsize, 2
            .TextOut "契　　　約　　　内　　　容", (dX(8) - dX(4)) / 2 + dX(4), 90.5, nFsize, 2, 2
            .DrawText "流動化\n方策名", dX(4), 97, Ar(4), 6, nFsize, 2
            .DrawText "許認可広告\n年　月　日", dX(5), 97, Ar(5), 6, nFsize, 2
            .DrawText "契約\n期間", dX(6), 97, Ar(6), 6, nFsize, 2
            .TextOut "借手農家氏名", (dX(8) - dX(7)) / 2 + dX(7), 101, nFsize, 2, 2
            .DrawText "新　規\n再設定\nの　別", dX(8), 89, Ar(8), 7, nFsize, 2
            .DrawText "10ａ当り\nの 金 額\n　　A", dX(9), 89, Ar(9), 7, nFsize, 2
            .DrawText "交付対象額\n@×A 円", dX(10), 92, Ar(10), 11, nFsize, 2
            .TextOut "申請人以外の権原者", (dX(13) - dX(11)) / 2 + dX(11), 92, nFsize, 2
            .TextOut "住　　所", (dX(12) - dX(11)) / 2 + dX(11), 104.5, nFsize, 2, 2
            .TextOut "氏　 名", (dX(13) - dX(12)) / 2 + dX(12), 104.5, nFsize, 2, 2
            .DrawText "税務課\n確認印", dX(13), 92, Ar(13), 8, nFsize, 2, 0
            .DrawText "交付要件適合\nの確認結果", dX(14), 92, Ar(14), 8, nFsize, 2, 0
            .TextOut "地 区 名", 27.5, 178.5, nFsize, 2, 2
            .TextOut "整理番号", 55, 178.5, nFsize, 2, 2
            .DrawText "交付決定\n番　　号", 20, 183, 15, 4, nFsize, 2, 2
            
            For n = 0 To 5
                i = 10 * n + 109.5
                .DrawText "1 適合する\n2 適合しない", dX(14) + 1, i, Ar(14), 4, nFsize - 1
            Next
            n基本料 = Val(Cm(6))
            If nPage = 1 Then
            End If
            If nPage = mvarParent.MaxPage Then
                .DBox 16, 108 + 6 * 10, dX(15), 108 + 6 * 10 + 6
                .TextOut "合  計", (dX(2) + dX(1)) / 2, 113 + 6 * 10, nFsize, 2, 1
                .TextOut Val(Cm(4)) / 10 & "a", dX(4) - 1, 113 + 6 * 10, nFsize, 1, 1
                .TextOut FormatNumber(n基本料 / 10 * Fix(Val(Cm(4)) / 10), 0) & "円", dX(11) - 1, 113 + 6 * 10, nFsize, 1, 1
            End If
            Cm = Split(Cm(9), ";")

            For n = 0 To 5
                If (nPage - 1) * 6 + n > UBound(Cm) Then
                Else
                    Cx = Split(Cm(n + (nPage - 1) * 6), ",")
                    i = 113 + n * 10
                    .TextOut (nPage - 1) * 6 + n + 1, (dX(1) - dX(0)) / 2 + dX(0), i, nFsize, 2, 2
                    .DrawText Left(Cx(0), 20), dX(1) + 2, i, Ar(1) - 2, 4, nFsize, 0, 2
                    .TextOut Cx(1), Ar(2) / 2 + dX(2), i, nFsize, 2, 2
                    .TextOut FormatNumber(Cx(2), 0), dX(4) - 1, i, nFsize, 1, 2
                    .TextOut Cx(3), Ar(4) / 2 + dX(4), i, nFsize - 1, 2, 2
                    .TextOut IIf(Cx(4) = "M32/12/30", "", Cx(4)), Ar(5) / 2 + dX(5), i, nFsize, 2, 2
                    .TextOut Cx(5), dX(7) - 1, i, nFsize, 1, 2
                    .DrawText Left(Cx(6), 12), dX(7), i, Ar(7), 4, nFsize, 0, 2
                    .TextOut Cx(7), Ar(8) / 2 + dX(8), i, nFsize, 2, 2
                    .TextOut FormatNumber(n基本料, 0), dX(10) - 1, i, nFsize, 1, 2
                    .TextOut FormatNumber(n基本料 / 10 * Fix(Val(Cx(2)) / 10) / 10, 0), dX(11) - 1, i, nFsize, 1, 2
                End If
            Next
            
            .DLine dX(11), 59, dX(Xcnt), 59
            .DLine dX(11), 66, dX(Xcnt), 66
            .DLine dX(0), 87, dX(Xcnt), 87
            .DLine dX(0), 94, dX(8), 94
            .DLine dX(11), 101, dX(13), 101
            For n = 0 To Xcnt
                Select Case n
                    Case 1, 2, 3, 5, 6, 7: .DLine dX(n), 94, dX(n), 108
                    Case 12:               .DLine dX(n), 101, dX(n), 108
                    Case Else:             .DLine dX(n), 87, dX(n), 108
                End Select
            Next
            .LineBoxDX 16, 108, 0, 6, 10, Ar
            
            .LineBox 20, 175, 75, 192
            .DLine 20, 182, 75, 182
            .DLine 35, 175, 35, 192
            .DLine 47, 175, 47, 182
            .DLine 63, 175, 63, 182
        End With
    End Sub

    Private Sub PrintPage2(ByVal nPage As Long, pData As String)
        Dim nFsize As Integer, nFsizeH As Integer
        Dim Ar As Variant, Cm As Variant
        Dim n As Long, i As Long
        Dim dX(20) As Single
        Dim Xcnt As Long
        Dim Cx As Variant
        Dim n基本料 As Single
        
        
        If Len(pData) = 0 Then Exit Sub
        nFsize = 9
        nFsizeH = 15
        
        Ar = GetArray(8, 40, 8, 20, 16, 20, 8, 26, 14, 20, 24, 14, 22, 20)
        dX(0) = 16
        For n = 0 To UBound(Ar)
            dX(n + 1) = dX(n) + Ar(n)
        Next
        Xcnt = UBound(Ar) + 1

        With mvarParent
            .ClearScreen
            .Offset 0, -8
            Cm = Split(pData, vbTab)
            
            .TextOut "（第１号の２様式）", 15, 15, nFsize, 0, 0
            .TextOut "平成 " & n年度 & " 年度農地流動化奨励金交付申請書", 60, 25, 20, 0, 1
            .TextOut "（兼交付台帳）", 200, 25, nFsizeH, 0, 1
            .TextOut Fnc.s市町村名 & "農業委員会", 15, 33, nFsizeH, 0, 0
            .TextOut "会長　" & s会長 & "　殿", 15, 41, nFsizeH, 0, 0
            .TextOut "平成　　　年　　　月　　　日", 132, 46, nFsize, 0, 0
            .TextOut "申請人住所", 164, 59, nFsizeH, 0, 1
            .TextOut Fnc.GetShortAddress(Cm(2), SystemDB.DBProperty("都道府県名"), SystemDB.DBProperty("郡部"), , , True), dX(10), 59, nFsizeH - 1, 0, 1
            .TextOut "申請人氏名", 164, 66, nFsizeH, 0, 1
            .TextOut Cm(3), dX(10), 66, nFsizeH - 1, 0, 1
            .TextOut "印（年齢　" & IIf(Val(Cm(7)) > 0, Cm(7), "  ") & "　才）", dX(Xcnt), 66, nFsize, 1, 1
            .TextOut "　下記により" & Fnc.s市町村名 & "農地流動化奨励金交付要綱に基づく、農地流動化奨励金を交付されたく申請します。", 15, 75, nFsizeH, 0, 0
            .TextOut "交 　付 　対 　象 　農 　用 　地", (dX(4) - dX(0)) / 2 + dX(0), 90.5, nFsize, 2, 2
            .TextOut "番号", (dX(1) - dX(0)) / 2 + dX(0), 101, nFsize, 2, 2
            .TextOut "土 地 所 在", (dX(2) - dX(1)) / 2 + dX(1), 101, nFsize, 2, 2
            .TextOut "地目", (dX(3) - dX(2)) / 2 + dX(2), 101, nFsize, 2, 2
            .DrawText "面　積\nu @", dX(3), 97, Ar(3), 6, nFsize, 2
            .TextOut "契　　　約　　　内　　　容", (dX(8) - dX(4)) / 2 + dX(4), 90.5, nFsize, 2, 2
            .DrawText "流動化\n方策名", dX(4), 97, Ar(4), 6, nFsize, 2
            .DrawText "許認可広告\n年　月　日", dX(5), 97, Ar(5), 6, nFsize, 2
            .DrawText "契約\n期間", dX(6), 97, Ar(6), 6, nFsize, 2
            .TextOut "貸手農家氏名", (dX(8) - dX(7)) / 2 + dX(7), 101, nFsize, 2, 2
            .DrawText "新　規\n再設定\nの　別", dX(8), 89, Ar(8), 7, nFsize, 2
            .DrawText "10ａ当り\nの 金 額\n　　A", dX(9), 89, Ar(9), 7, nFsize, 2
            .DrawText "交付対象額\n@×A 円", dX(10), 92, Ar(10), 11, nFsize, 2
            .DrawText "税務課\n確認印", dX(11), 92, Ar(11), 8, nFsize, 2, 0
            .DrawText "交付要件適合\nの確認結果", dX(12), 92, Ar(12), 8, nFsize, 2, 0
            .TextOut "備　　考", (dX(14) - dX(13)) / 2 + dX(13), 97.5, nFsize, 2, 2
            .DrawText "経　　　営\nの　状　況", 70, 178, 20, 4, nFsize, 2, 2
            .DrawText "経営面積\n（現況）", 90, 178, 20, 4, nFsize, 2, 2
            .DrawText "経営面積\n（将来）", 110, 178, 20, 4, nFsize, 2, 2
            .TextOut "主な経営作物", 141, 182, nFsize, 2, 2
            .TextOut "自　作　地", 80, 190.5, nFsize, 2, 2
            .TextOut "a", 109, 190.5, nFsize, 1, 2
            .TextOut "a", 129, 190.5, nFsize, 1, 2
            .TextOut "小　作　地", 80, 197.5, nFsize, 2, 2
            .TextOut "a", 109, 197.5, nFsize, 1, 2
            .TextOut "a", 129, 197.5, nFsize, 1, 2
            .TextOut "合　　　計", 80, 204.5, nFsize, 2, 2
            .TextOut "a", 109, 204.5, nFsize, 1, 2
            .TextOut "a", 129, 204.5, nFsize, 1, 2
            .TextOut "地 区 名", 187.5, 180.5, nFsize, 2, 2
            .TextOut "整理番号", 215, 180.5, nFsize, 2, 2
            .DrawText "交付決定\n番　　号", 180, 186, 15, 4, nFsize, 2, 2
            
            For n = 0 To 5
                i = 10 * n + 109.5
                .DrawText "1 適合する\n2 適合しない", dX(12) + 1, i, Ar(12), 4, nFsize - 1
            Next
            n基本料 = Val(Cm(6))
        
            If Cm(5) = "Null" Then
                .TextOut "１．認定農家", 16, 178, nFsizeH, 0, 0
                .TextOut "認定番号", 27, 188, 11, 0, 0
                .TextOut "A．担い手農家", 16, 200, nFsizeH, 0, 0
            Else
                .TextOut "@．認定農家", 16, 178, nFsizeH, 0, 0
                .TextOut "認定番号　" & Cm(5), 27, 188, 11, 0, 0
                .TextOut "２．担い手農家", 16, 200, nFsizeH, 0, 0
            End If
        
            If nPage = 1 Then
            End If
            If nPage = mvarParent.MaxPage Then
                .DBox 16, 108 + 6 * 10, dX(14), 108 + 6 * 10 + 6
                .TextOut "合  計", (dX(2) + dX(1)) / 2, 113 + 6 * 10, nFsize, 2, 1
                .TextOut Val(Cm(4)) / 10 & "a", dX(4) - 1, 113 + 6 * 10, nFsize, 1, 1
                .TextOut FormatNumber(n基本料 / 10 * Fix(Val(Cm(4)) / 10), 0) & "円", dX(11) - 1, 113 + 6 * 10, nFsize, 1, 1
            End If
            Cm = Split(Cm(9), ";")
            
            For n = 0 To 5
                If (nPage - 1) * 6 + n > UBound(Cm) Then
                Else
                    Cx = Split(Cm(n + (nPage - 1) * 6), ",")
                    i = 113 + n * 10
                    .TextOut (nPage - 1) * 6 + n + 1, (dX(1) - dX(0)) / 2 + dX(0), i, nFsize, 2, 2
                    .DrawText Left(Cx(0), 22), dX(1) + 2, i, Ar(1) - 2, 4, nFsize, 0, 2
                    .TextOut Cx(1), Ar(2) / 2 + dX(2), i, nFsize, 2, 2
                    .TextOut FormatNumber(Cx(2), 0), dX(4) - 1, i, nFsize, 1, 2
                    .TextOut Cx(3), Ar(4) / 2 + dX(4), i, nFsize - 1, 2, 2
                    .TextOut IIf(Cx(4) = "M32/12/30", "", Cx(4)), Ar(5) / 2 + dX(5), i, nFsize, 2, 2
                    .TextOut Cx(5), dX(7) - 1, i, nFsize, 1, 2
                    .DrawText Left(Cx(6), 14), dX(7) + 1, i, Ar(7) - 1, 4, nFsize, 0, 2
                    .TextOut Cx(7), Ar(8) / 2 + dX(8), i, nFsize, 2, 2
                    .TextOut FormatNumber(n基本料, 0), dX(10) - 1, i, nFsize, 1, 2
                    .TextOut FormatNumber(n基本料 / 10 * Fix(Val(Cx(2)) / 10) / 10, 0), dX(11) - 1, i, nFsize, 1, 2
                End If
            Next
            
            .DLine dX(10), 59, dX(Xcnt), 59
            .DLine dX(10), 66, dX(Xcnt), 66
            .DLine dX(0), 87, dX(Xcnt), 87
            .DLine dX(0), 94, dX(8), 94
            For n = 0 To Xcnt
                Select Case n
                    Case 1, 2, 3, 5, 6, 7: .DLine dX(n), 94, dX(n), 108
                    Case Else:             .DLine dX(n), 87, dX(n), 108
                End Select
            Next
            .LineBoxDX 16, 108, 0, 6, 10, Ar

            .LineBox 70, 177, 152, 208
            .DLine 70, 187, 152, 187
            .DLine 70, 194, 130, 194
            .DLine 70, 201, 130, 201
            .DLine 90, 177, 90, 208
            .DLine 110, 177, 110, 208
            .DLine 130, 177, 130, 208

            .LineBox 180, 177, 235, 194
            .DLine 180, 184, 235, 184
            .DLine 195, 177, 195, 194
            .DLine 207, 177, 207, 184
            .DLine 223, 177, 223, 184

        End With
    End Sub

End Class










Class CPrint奨励金交付通知書
    Option Explicit
    Implements CPrintCls
    Private mvarParent As CPrintFormSK
    Private mvarKey As String
    Private mvarPData As CPrintDatas
    Private mvarRows As Long
    Private s会長 As String
    
    Private Property Get CPrintCls_CanCancelPrint() As Boolean
    End Property
    Private Property Get CPrintCls_CanPrintNowPage() As Boolean: CPrintCls_CanPrintNowPage = True: End Property

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim RsT As ADBasicLIB2.RecordsetEx
        Dim St As String
        Dim n As Long, i As Long
        Dim W As Long
        Dim nCount As Long
        Dim Ar As Variant
        
        mvarRows = 7        '　農地出力枠の行数
        s会長 = SystemDB.DBProperty("会長名")
        
        Set mvarPData = New CPrintDatas
        mvarPData.Headers = _
        "申請人;申請日;決定日;決定番号;地積a;奨励金;交付金額;" & _
        ">農地;土地所在;登記地目;現況地目;面積;契約期間;"

        With mvarPData
            Set Rs = SystemDB.GetRecordsetEx("SELECT * FROM [D_申請] WHERE [ID]=" & Val(sParam), , , "奨励金交付通知書")
            If Not Rs.EOF Then
                n = .NewLine
                .SetRsData n, "申請人", Rs, "氏名A"
                .SetRsData n, "申請日", Rs, "受付年月日"
                .SetRsData n, "決定日", Rs, "許可年月日"
                .SetRsData n, "決定番号", Rs, "許可番号"
                .SetRsData n, "地積a", Rs, "数量"
                .SetRsData n, "奨励金", Rs, "条件B"
                .Data(n, "交付金額") = Val(Rs.Value("条件B")) * Val(Rs.Value("数量")) / 10
                
                St = Replace(Replace(Rs.Value("農地リスト"), "農地.", ""), ";", ",")
                If Len(St) Then
                    i = 0
                    Set RsT = SystemDB.GetRecordsetEx("SELECT [V_農地].*,[V_地目].名称 AS 登記地目,[地目2].名称 AS [現況] FROM ([V_農地] INNER JOIN [V_地目] ON [V_農地].[登記簿地目]=[V_地目].ID) INNER JOIN V_地目 AS 地目2 ON [V_農地].[現況地目]=[地目2].ID WHERE [V_農地].[ID] IN (" & St & ")", , , "奨励金交付通知書")
                    Do Until RsT.EOF
                        i = i + 1
                        .SetRsData n & ":農地." & i, "土地所在", RsT
                        .SetRsData n & ":農地." & i, "登記地目", RsT
                        .SetRsData n & ":農地." & i, "現況地目", RsT, "現況"
                        .Data(n & ":農地." & i, "面積") = RsT.Value("田面積") + RsT.Value("畑面積")
                        .Data(n & ":農地." & i, "契約期間") = RsT.DateDiff("yyyy", "小作開始年月日", "小作終了年月日")
                        RsT.MoveNext
                    Loop
                    SystemDB.CloseRs RsT
                End If
            End If
            SystemDB.CloseRs Rs
        
            If .SubCount(n & ":農地") + 1 > mvarRows - 1 Then
                mvarParent.MaxPage = 2
            Else
                mvarParent.MaxPage = 1
            End If
            mvarParent.Page = 1
        End With
    End Function
    
    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property

    Private Property Let CPrintCls_Key(ByVal RHS As String)

    End Property

    Private Property Get CPrintCls_Key() As String: CPrintCls_Key = mvarKey: End Property
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants: CPrintCls_Orientation = vbPRORPortrait: End Property

    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&)
        mvarParent.Page = nNewPage
        CPrintCls_Repaint
    End Sub
    
    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Set CPrintCls_Parent(RHS As ADBasicLIB2.CPrintFormSK): Set mvarParent = RHS: End Property

    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        mvarParent.PrintPage = 1
        mvarParent.PrintMaxPage = mvarParent.MaxPage

        If bNowPage Then
            CPrintCls_Repaint
            mvarParent.EndDoc
        Else
            Do Until mvarParent.PrintPage > mvarParent.PrintMaxPage
                If mvarParent.PrintPage = 1 Then
                    PrintSub1
                Else
                    PrintSub2
                End If
                mvarParent.NewPage
            Loop
            mvarParent.EndDoc
        End If
    
    End Sub

    Private Sub CPrintCls_Repaint()
        If mvarParent.Page = 1 Then
            PrintSub1
        Else
            PrintSub2
        End If
    End Sub

    Private Sub CPrintCls_TargetChange(sKey As String)

    End Sub

    Private Sub PrintSub1()
        Dim nFsize As Integer
        Dim Ar As Variant, Cm As Variant
        Dim n As Long, i As Long
        Dim dX(25) As Single
        Dim Xcnt As Long
        Dim nRows As Long
        Dim St As String, St1 As String
        Dim dY As Single
    
        If mvarParent.Page = 0 Then Exit Sub
        
        With mvarParent
            .ClearScreen
            .Offset 0, 0
            nFsize = 11
            
            Ar = GetArray(64, 20, 22, 22, 28, 20)
            dX(0) = 18
            For i = 0 To UBound(Ar)
                dX(i + 1) = dX(i) + Ar(i)
            Next
            Xcnt = UBound(Ar) + 1

            .TextOut "（第２号様式）", 15, 20, nFsize
            .TextOut "農地流動化奨励金交付決定通知書", (dX(Xcnt) - dX(0)) / 2 + dX(0), 28, 18, 2, 0
            .TextOut "交付決定番号　　第　　　　　　号", 112, 47, nFsize
            .TextOut "交付決定年月日", 112, 56, nFsize
            .TextOut "殿", 65, 74, nFsize
            .TextOut Fnc.s市町村名 & "農業委員会", 120, 84, nFsize
            .TextOut "会　長　　" & s会長, 120, 92, nFsize
            .TextOut "記", (dX(Xcnt) - dX(0)) / 2 + dX(0), 137, nFsize, 2, 0
            .DrawText "交　付　対　象　農　用　地", dX(0), 152.5, Ar(0) + Ar(1) + Ar(2), 4, nFsize, 2, 2
            .DrawText "土　地　所　在", dX(0), 161.5, Ar(0), 4, nFsize, 2, 2
            .DrawText "地 目", dX(1), 161.5, Ar(1), 4, nFsize, 2, 2
            .DrawText "地　積", dX(2), 161.5, Ar(2), 4, nFsize, 2, 2
            .DrawText "10ａ当り\n金　　額", dX(3), 157, Ar(3), 4, nFsize, 2, 2
            .DrawText "交付決定額", dX(4), 157, Ar(4), 4, nFsize, 2, 2
            .DrawText "契約期間", dX(5), 157, Ar(5), 4, nFsize, 2, 2
            .TextOut "※奨励金の支払いについては、　　月　　日に役場窓口までご足労下さい。（印鑑をご持参ください。）", 17, 268, nFsize
            .TextOut "※奨励金の支払いについては、　　月　　日までに指定の口座へ振込をいたします。", 17, 275, nFsize

            .DLine 17, 79, 62, 79
            .DLine dX(0), 148, dX(Xcnt), 148
            .DLine dX(0), 157, dX(3), 157
            For i = 0 To Xcnt
                Select Case i
                    Case 0, 3, 4, 5, 6: .DLine dX(i), 148, dX(i), 166
                    Case Else: .DLine dX(i), 157, dX(i), 166
                End Select
            Next
            .LineBoxDX dX(0), 166, 0, 7, 14, Ar
            
            n = 1
            .TextOut Format(mvarPData.Data(n, "決定番号"), "#"), 165, 47, nFsize, 1
            .TextOut Format(mvarPData.Data(n, "決定日"), "GGG E 年 M 月 D 日"), 186, 56, nFsize, 1
            .TextOut mvarPData.Data(n, "申請人"), 23, 78, nFsize + 1, 0, 1
            
            If IsDate(mvarPData.Data(n, "申請日")) Then
                St = Format(mvarPData.Data(n, "申請日"), "GGG E 年 M 月 D 年")
                ' 南種子町仕様　3/5受付分までが前年度
                If Fnc.s市町村名 = "南種子町" And (DatePart("m", mvarPData.Data(n, "申請日")) < 3 Or (DatePart("m", mvarPData.Data(n, "申請日")) = 3 And DatePart("d", mvarPData.Data(n, "申請日")) <= 5)) Then
                    St1 = Format(DateAdd("yyyy", -1, mvarPData.Data(n, "申請日")), "E")
                Else
                    St1 = Format(mvarPData.Data(n, "申請日"), "E")
                End If
            Else
                St = "平成　　年　　月　　日"
                St1 = "  "
            End If
            St = "　" & St & "付け申請のあった平成 " & St1 & " 年度農地流動化奨励金について、" & Fnc.s市町村名 & "農地流動化奨励金交付要綱により、下記のとおり交付することに決定したので通知します。"
            .DrawText St, 13, 110, 180, 9, nFsize
            
            dY = 173
            If mvarPData.SubCount(n & ":農地") + 1 > mvarRows - 1 Then
                .DrawText "別 紙 の と お り", dX(0), dY, Ar(0), 4, nFsize, 2, 2
            Else
                For i = 0 To mvarPData.SubCount(n & ":農地")
                    .DrawText mvarPData.Data(n & ":農地." & i, "土地所在"), dX(0) + 1, dY, Ar(0) - 2, 4, nFsize, 0, 2
                    .DrawText mvarPData.Data(n & ":農地." & i, "現況地目"), dX(1), dY, Ar(1), 4, nFsize, 2, 2
                    .DrawText FormatNumber(mvarPData.Data(n & ":農地." & i, "面積"), 0), dX(2), dY, Ar(2) - 1, 4, nFsize, 1, 2
                    .DrawText mvarPData.Data(n & ":農地." & i, "契約期間"), dX(5), dY, Ar(5), 4, nFsize, 2, 2
                    dY = dY + 14
                Next
                If i < mvarRows - 2 Then .DrawText "以　下　余　白", dX(0), dY, Ar(0), 4, nFsize, 2, 2
                dY = 14 * (mvarRows - 1) + 173
                .DrawText FormatNumber(mvarPData.Data(n, "地積a"), 0) & "ａ", dX(2), dY, Ar(2) - 1, 4, nFsize, 1, 2
                .DrawText FormatNumber(mvarPData.Data(n, "奨励金"), 0), dX(3), dY, Ar(3) - 1, 4, nFsize, 1, 2
                .DrawText FormatNumber(mvarPData.Data(n, "交付金額"), 0), dX(4), dY, Ar(4) - 1, 4, nFsize, 1, 2
            End If
        End With
    End Sub

    Private Sub PrintSub2()
        Dim nFsize As Integer
        Dim Ar As Variant, Cm As Variant
        Dim n As Long, i As Long
        Dim dX(25) As Single
        Dim Xcnt As Long
        Dim nRows As Long
        Dim St As String, St1 As String
        Dim dY As Single
    
        If mvarParent.Page = 0 Then Exit Sub
        
        With mvarParent
            .ClearScreen
            .Offset 0, 0
            nFsize = 11
            
            Ar = GetArray(64, 20, 22, 22, 28, 20)
            dX(0) = 18
            For i = 0 To UBound(Ar)
                dX(i + 1) = dX(i) + Ar(i)
            Next
            Xcnt = UBound(Ar) + 1

            .TextOut "（別紙）", dX(0), 25, nFsize
            .DrawText "交　付　対　象　農　用　地", dX(0), 34.5, Ar(0) + Ar(1) + Ar(2), 4, nFsize, 2, 2
            .DrawText "土　地　所　在", dX(0), 43.5, Ar(0), 4, nFsize, 2, 2
            .DrawText "地 目", dX(1), 43.5, Ar(1), 4, nFsize, 2, 2
            .DrawText "地　積", dX(2), 43.5, Ar(2), 4, nFsize, 2, 2
            .DrawText "10ａ当り\n金　　額", dX(3), 39, Ar(3), 4, nFsize, 2, 2
            .DrawText "交付決定額", dX(4), 39, Ar(4), 4, nFsize, 2, 2
            .DrawText "契約期間", dX(5), 39, Ar(5), 4, nFsize, 2, 2

            .DLine dX(0), 30, dX(Xcnt), 30
            .DLine dX(0), 39, dX(3), 39
            For i = 0 To Xcnt
                Select Case i
                    Case 0, 3, 4, 5, 6: .DLine dX(i), 30, dX(i), 48
                    Case Else: .DLine dX(i), 39, dX(i), 48
                End Select
            Next
            
            n = 1
            i = mvarPData.SubCount(n & ":農地") + 2
            .LineBoxDX dX(0), 48, 0, i, 14, Ar

            dY = 55
            For i = 0 To mvarPData.SubCount(n & ":農地")
                .DrawText mvarPData.Data(n & ":農地." & i, "土地所在"), dX(0) + 1, dY, Ar(0) - 2, 4, nFsize, 0, 2
                .DrawText mvarPData.Data(n & ":農地." & i, "現況地目"), dX(1), dY, Ar(1), 4, nFsize, 2, 2
                .DrawText FormatNumber(mvarPData.Data(n & ":農地." & i, "面積"), 0), dX(2), dY, Ar(2) - 1, 4, nFsize, 1, 2
                .DrawText mvarPData.Data(n & ":農地." & i, "契約期間"), dX(5), dY, Ar(5), 4, nFsize, 2, 2
                dY = dY + 14
            Next
            .DrawText FormatNumber(mvarPData.Data(n, "地積a"), 0) & "ａ", dX(2), dY, Ar(2) - 1, 4, nFsize, 1, 2
            .DrawText FormatNumber(mvarPData.Data(n, "奨励金"), 0), dX(3), dY, Ar(3) - 1, 4, nFsize, 1, 2
            .DrawText FormatNumber(mvarPData.Data(n, "交付金額"), 0), dX(4), dY, Ar(4) - 1, 4, nFsize, 1, 2
        End With
    End Sub

End Class










Class CPrint奨励金総括表
    Option Explicit
    Implements CPrintCls
    Private mvarParent As CPrintFormSK
    Private mvarKey As String

    Private Property Get CPrintCls_CanCancelPrint() As Boolean
    End Property

    Private Property Get CPrintCls_CanPrintNowPage() As Boolean
    End Property

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean
    End Function

    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property

    Private Property Let CPrintCls_Key(ByVal RHS As String)

    End Property
    Private Property Get CPrintCls_Key() As String: CPrintCls_Key = mvarKey: End Property
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants: CPrintCls_Orientation = vbPRORLandscape: End Property
    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&): CPrintCls_Repaint: End Sub
    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Set CPrintCls_Parent(RHS As ADBasicLIB2.CPrintFormSK): Set mvarParent = RHS: End Property

    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        CPrintCls_Repaint
        mvarParent.EndDoc
    End Sub
    Private Sub CPrintCls_Repaint(): PrintSub: End Sub

    Private Sub CPrintCls_TargetChange(sKey As String)

    End Sub

    Private Sub PrintSub()
        Dim nFsize As Integer
        Dim Ar As Variant
        Dim n As Long, i As Long
        Dim dX(10) As Single, hX(10) As Single
        
        nFsize = 10
        
        Ar = GetArray(12, 34, 10, 24, 26, 20, 24, 30, 56)
        dX(0) = 30: hX(0) = dX(0) + Ar(0) / 2
        For n = 0 To UBound(Ar)
            dX(n + 1) = dX(n) + Ar(n)
            If n < UBound(Ar) Then hX(n + 1) = dX(n + 1) + Ar(n + 1) / 2
        Next

        With mvarParent
            .ClearScreen
            .Offset 0, 0
            
            .TextOut "議案第　　号", 27, 18, nFsize, 0, 0
            .TextOut "農地流動化奨励金交付申請について", 45, 25, 14, 0, 0
            .TextOut "このことについて、農地流動化奨励金交付要綱の規定により農業委員会の議決を求める。", dX(0), 34, nFsize, 0, 0
            .TextOut "農地流動化奨励金交付申請総括表", dX(0), 40, nFsize, 0, 0
            .TextOut "番 号", hX(0), 53, nFsize, 2, 2
            .TextOut "申 請 人 氏 名", hX(1), 53, nFsize, 2, 2
            .TextOut "年齢", hX(2), 53, nFsize, 2, 2
            .TextOut "利用権設定", hX(3), 50, nFsize, 2, 2
            .TextOut "年　月　日", hX(3), 56, nFsize, 2, 2
            .TextOut "地　積（ａ）", hX(4), 53, nFsize, 2, 2
            .TextOut "契約期間", hX(5), 53, nFsize, 2, 2
            .TextOut "１０ａ当り", hX(6), 50, nFsize, 2, 2
            .TextOut "奨　励　金", hX(6), 56, nFsize, 2, 2
            .TextOut "交　付　金　額", hX(7), 53, nFsize, 2, 2
            .TextOut "備　　　　　　　　考", hX(8), 53, nFsize, 2, 2

            .LineBoxDX dX(0), 46, 14, 13, 10, Ar
            .DLine 30, 44, 83, 44
        End With
    End Sub

End Class










Class CPrint選挙一覧表
    Option Explicit
    Implements CPrintCls
    Private mvarParent As CPrintFormSK
    Private mvarDic As ADBasicLIB2.CDataDictionary
    Private mvarKey As String
    Private s名称変更 As String
    Private b農家番号 As Boolean
    Private s市町村名 As String
    Private b改行 As Boolean
    Private b罫線 As Boolean
    Private nRows As Long
    Private nPit As Single
    Private n有選挙権者 As Long
    Private n前回有権者 As Long
    
    Private Property Get CPrintCls_CanCancelPrint() As Boolean: End Property
    Private Property Get CPrintCls_CanPrintNowPage() As Boolean: CPrintCls_CanPrintNowPage = True: End Property

    Private Property Let CPrintCls_Key(ByVal RHS As String): End Property

    Private Property Get CPrintCls_Key() As String: End Property
    Private Sub Class_Initialize(): Set mvarDic = New ADBasicLIB2.CDataDictionary: End Sub

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim RsS As ADBasicLIB2.RecordsetEx
        Dim sSQL As String
        Dim St As String
        Dim SX As String
        Dim pNode As Object
        Dim SID As Long
        Dim Ar As Variant
        Dim bLoop As Boolean
        Dim n As Long
        Dim Va As Variant
        Dim s都道府県名 As String
        Dim s郡部名 As String
        Dim sBlock As String
        Dim Flg As Boolean
        Dim sWhere As String
        Dim OID As Long
        
        n有選挙権者 = 0
        n前回有権者 = 0
        
        On Error Resume Next
        OID = 0
            
        With SystemDB
            b改行 = Val(.DBProperty("選挙一覧改行"))
            b罫線 = Val(.DBProperty("選挙一覧罫線"))
        
            s都道府県名 = .DBProperty("都道府県名")
            s郡部名 = .DBProperty("郡部")
            s市町村名 = .DBProperty("市町村名")
            b農家番号 = Val(.DBProperty("選挙関連農家番号の印刷"))
            
            St = "自治会集落名行政区公民館公民会"
            s名称変更 = MID(St, Val(.DBProperty("選挙申請名簿用")) * 3 + 1, 3)
        End With
        
        With mvarParent
            .UsedTreeView = True
            
            If s市町村名 <> "姶良市" Then
                .Nodes.Add , , "選挙人申請書.0", "名簿登載候補一覧", "CloseFolder", "CloseFolder"
                
                Set Rs = SystemDB.GetRecordsetEx("SELECT '行政区.' & [ID] AS [Key], M_BASICALL.名称 FROM M_BASICALL WHERE (((M_BASICALL.ID)>0) AND ((M_BASICALL.Class)='行政区')) ORDER BY Right('000000' & [ID],6)", , , "選挙人一覧")
            
    sBlock = "ツリービュー作成"
                Do Until Rs.EOF
                    .Nodes.Add("選挙人申請書.0", 4, CStr(Rs.Value("Key")), Rs.Value("名称") & "(" & Fnc.GetKeyCode(Rs.Value("Key")) & ")", "CloseFolderG", "CloseFolderG").Tag = ""
                    Rs.MoveNext
                Loop
            Else
                .Nodes.Add , , "姶良", "姶良", "CloseFolder", "CloseFolder"
                .Nodes.Add , , "加治木", "加治木", "CloseFolder", "CloseFolder"
                .Nodes.Add , , "蒲生", "蒲生", "CloseFolder", "CloseFolder"
                Set Rs = SystemDB.GetRecordsetEx("SELECT '行政区.' & [ID] AS [Key], M_BASICALL.名称, M_BASICALL.nParam FROM M_BASICALL WHERE (((M_BASICALL.ID)>0) AND ((M_BASICALL.Class)='行政区')) ORDER BY [nParam],Right('000000' & [ID],6)", , , "選挙人一覧")
    
    sBlock = "ツリービュー作成"
                Do Until Rs.EOF
                    .Nodes.Add(Choose(Rs.Value("nParam"), "姶良", "加治木", "蒲生"), 4, CStr(Rs.Value("Key")), Rs.Value("名称") & "(" & Fnc.GetKeyCode(Rs.Value("Key")) & ")", "CloseFolderG", "CloseFolderG").Tag = ""
                    Rs.MoveNext
                Loop
            End If

            
            SystemDB.CloseRs Rs
            
            If Len(SystemDB.DBPropertyEx("選挙面積除外農地状況区分", vbString, "")) Then
                sWhere = " WHERE [農地状況] NOT IN (" & SystemDB.DBPropertyEx("選挙面積除外農地状況区分", vbString, "") & ")"
            Else
                sWhere = ""
            End If
            
            nRows = 50
            nPit = 4.5
            If s市町村名 <> "姶良市" Then
                sSQL = "SELECT Sum(耕作農地.田畑計) AS 田畑計の合計, [D:世帯Info].ID, [D:個人Info].性別, '世帯員.' & [D:個人Info].ID AS [KEY], [D:世帯Info].農家番号, [D:個人Info].氏名, [V_続柄].続柄 AS 続柄1, [V_続柄_1].続柄 AS 続柄2, [V_続柄_2].続柄 AS 続柄3, [D:個人Info].生年月日, [D:個人Info].住民区分, M_BASICALL.名称 AS 住民区分名称, [D:個人Info].行政区ID, [D:個人Info].住所, [D:個人Info].選挙権の有無 " & _
                "FROM (((SELECT IIf([自小作別]=0,IIF([管理世帯ID]<>0,[管理世帯ID],[所有世帯ID]),[借受世帯ID]) AS 耕作世帯, [D:農地Info].登記簿面積, [D:農地Info].実面積, IIF(IsNull([田面積]),0,[田面積])+IIF(IsNull([畑面積]),0,[畑面積])+IIF(IsNull([樹園地]),0,[樹園地]) AS 田畑計 FROM [D:農地Info]" & sWhere & ") AS 耕作農地 RIGHT JOIN [D:世帯Info] ON 耕作農地.耕作世帯 = [D:世帯Info].ID) INNER JOIN ((([D:個人Info] INNER JOIN [V_続柄] ON [D:個人Info].続柄1 = [V_続柄].ID) INNER JOIN [V_続柄] AS [V_続柄_1] ON [D:個人Info].続柄2 = [V_続柄_1].ID) INNER JOIN [V_続柄] AS [V_続柄_2] ON [D:個人Info].続柄3 = [V_続柄_2].ID) ON [D:世帯Info].ID = [D:個人Info].世帯ID) LEFT JOIN M_BASICALL ON [D:個人Info].住民区分 = M_BASICALL.ID " & _
                "WHERE (((M_BASICALL.Class) = '住民区分')) Or (((M_BASICALL.Class) = '住民区分')) " & _
                "GROUP BY [D:世帯Info].ID, [D:個人Info].性別, [D:世帯Info].農家番号, [D:個人Info].氏名, [V_続柄].続柄, [V_続柄_1].続柄, [V_続柄_2].続柄, [D:個人Info].生年月日, [D:個人Info].住民区分, M_BASICALL.名称, [D:個人Info].行政区ID, [D:個人Info].住所, [D:個人Info].選挙権の有無, [D:個人Info].ID, [V_続柄].ID, [D:個人Info].住民区分, [D:個人Info].行政区ID " & _
                "HAVING ((([D:世帯Info].ID)<>0) AND (([D:個人Info].生年月日)<#4/2/" & IIf(Month(Now) > 6, Year(Now) - 19, Year(Now) - 20) & "#) AND (([D:個人Info].住民区分)=" & SystemDB.DBProperty("記録住民コード") & ") AND (([D:個人Info].行政区ID)>0)) OR ((([D:個人Info].住民区分)=" & SystemDB.DBProperty("記録住民コード") & ") AND (([D:個人Info].選挙権の有無)=True)) " & _
                "ORDER BY [D:個人Info].行政区ID, [D:世帯Info].ID, [V_続柄].ID, [D:個人Info].生年月日"
            Else
                sSQL = "SELECT Sum(耕作農地.田畑計) AS 田畑計の合計, [D:世帯Info].ID, [D:個人Info].性別, '世帯員.' & [D:個人Info].ID AS [KEY], [D:世帯Info].農家番号, [D:個人Info].氏名, V_続柄.続柄 AS 続柄1, V_続柄_1.続柄 AS 続柄2, V_続柄_2.続柄 AS 続柄3, [D:個人Info].生年月日, [D:個人Info].住民区分, M_BASICALL.名称 AS 住民区分名称, [D:個人Info].行政区ID, [D:個人Info].住所, [D:個人Info].選挙権の有無, M_BASICALL_1.nParam " & _
                       "FROM ((((SELECT IIf([自小作別]=0,IIF([管理世帯ID]<>0,[管理世帯ID],[所有世帯ID]),[借受世帯ID]) AS 耕作世帯, [D:農地Info].登記簿面積, [D:農地Info].実面積, IIF(IsNull([田面積]),0,[田面積])+IIF(IsNull([畑面積]),0,[畑面積])+IIF(IsNull([樹園地]),0,[樹園地]) AS 田畑計 FROM [D:農地Info]" & sWhere & ") AS 耕作農地 RIGHT JOIN [D:世帯Info] ON 耕作農地.耕作世帯 = [D:世帯Info].ID) INNER JOIN ((([D:個人Info] INNER JOIN V_続柄 ON [D:個人Info].続柄1 = V_続柄.ID) INNER JOIN V_続柄 AS V_続柄_1 ON [D:個人Info].続柄2 = V_続柄_1.ID) INNER JOIN V_続柄 AS V_続柄_2 ON [D:個人Info].続柄3 = V_続柄_2.ID) ON [D:世帯Info].ID = [D:個人Info].世帯ID) LEFT JOIN M_BASICALL ON [D:個人Info].住民区分 = M_BASICALL.ID) LEFT JOIN M_BASICALL AS M_BASICALL_1 ON [D:個人Info].行政区ID = M_BASICALL_1.ID " & _
                       "WHERE (((M_BASICALL.Class)='住民区分') AND ((M_BASICALL_1.Class)='行政区')) OR (((M_BASICALL.Class)='住民区分') AND ((M_BASICALL_1.Class)='行政区')) " & _
                       "GROUP BY [D:世帯Info].ID, [D:個人Info].性別, '世帯員.' & [D:個人Info].ID, [D:世帯Info].農家番号, [D:個人Info].氏名, V_続柄.続柄, V_続柄_1.続柄, V_続柄_2.続柄, [D:個人Info].生年月日, [D:個人Info].住民区分, M_BASICALL.名称, [D:個人Info].行政区ID, [D:個人Info].住所, [D:個人Info].選挙権の有無, M_BASICALL_1.nParam, [D:個人Info].ID, V_続柄.ID, [D:個人Info].住民区分, [D:個人Info].行政区ID, [D:世帯Info].ID, V_続柄.ID, [D:個人Info].生年月日 " & _
                       "HAVING ((([D:世帯Info].ID) <> 0) And (([D:個人Info].生年月日) < #4/2/" & IIf(Month(Now) > 6, Year(Now) - 19, Year(Now) - 20) & "#) And (([D:個人Info].住民区分) = " & SystemDB.DBProperty("記録住民コード") & ") And (([D:個人Info].行政区ID) > 0)) Or ((([D:個人Info].住民区分) = " & SystemDB.DBProperty("記録住民コード") & ") And (([D:個人Info].選挙権の有無) = True)) " & _
                       "ORDER BY [D:個人Info].行政区ID, [D:世帯Info].ID, V_続柄.ID, [D:個人Info].生年月日;"
            End If
            SID = 0
            
    sBlock = "ツリービューデータ追加"
            
            Set Rs = SystemDB.GetRecordsetEx(sSQL, , , Me)
            Do Until Rs.EOF
    sBlock = "ツリービューデータ追加" & vbCr & "Key:" & Rs.Value("Key") & vbCr & "農家番号　" & Rs.Value("農家番号") & vbCr & "氏      名　" & Rs.Value("氏名") & vbCr & "住民区分　" & Rs.Value("住民区分名称") & vbCr & "選 挙 権    " & IIf(Rs.Value("選挙権の有無") = True, "○", "×")
                St = Rs.NullCast("農家番号", 0) & ";" & Rs.Value("氏名") & ";" & IIf(Rs.NullCast("田畑計の合計", 0) >= 1000, IIf(Rs.Value("選挙権の有無"), "◎", "○"), IIf(Rs.Value("選挙権の有無"), "▽", "-")) & ";" & Rs.Value("続柄1") & "の" & Rs.Value("続柄2") & "の" & Rs.Value("続柄3") & ";" & Choose(Rs.Value("性別") + 2, "不明", "男", "女") & ";" & Format(Rs.Value("生年月日"), "GEE/MM/DD") & ";" & Fnc.NullCast(Int(Rs.Value("田畑計の合計")), 0) & ";" & Fnc.GetShortAddress(Rs.NullCast("住所", ""), s都道府県名, s郡部名, s市町村名, , True) & ";"
                
                mvarDic.Add CStr(Rs.Value("Key")), St
                SX = ""
                SX = .Nodes(CStr("行政区." & Rs.Value("行政区ID"))).Tag
                
                If SX = "" Then SID = 0
                If SID = 0 Then
                    SID = Rs.Value("ID")
                ElseIf SID <> Rs.Value("ID") And Len(SX) > 0 Then
                    SX = SX & "Q;"
                    SID = Rs.Value("ID")
                End If
                If Rs.Value("田畑計の合計") >= 1000 Then
                    n有選挙権者 = n有選挙権者 + 1
                    n前回有権者 = n前回有権者 - Rs.Value("選挙権の有無")
                    SX = SX & Rs.Value("Key") & "○" & Choose(Rs.Value("性別") + 2, "不明", "男", "女", "不明") & ";"
                Else
                    SX = SX & Rs.Value("Key") & Choose(Rs.Value("性別") + 2, "不明", "男", "女", "不明") & ";"
                End If
                .Nodes(CStr("行政区." & Rs.Value("行政区ID"))).Tag = SX
                Rs.MoveNext
            Loop
            SystemDB.CloseRs Rs
            
            For Each pNode In .Nodes
    sBlock = "集落追加:" & pNode.Key
                If Fnc.GetKeyHead(pNode.Key) = "行政区" Then
                    pNode.Text = pNode.Text & "<" & (Fnc.StringF.StrCount(pNode.Tag, "Q") + 1) & "," & Fnc.Sf.StrCount(pNode.Tag, "男") & "," & Fnc.Sf.StrCount(pNode.Tag, "女") & "," & Fnc.Sf.StrCount(pNode.Tag, "○男") & "," & Fnc.Sf.StrCount(pNode.Tag, "○女") & ">"
                    pNode.Tag = Replace(pNode.Tag, "○", "")
                    pNode.Tag = Replace(pNode.Tag, "男", "")
                    pNode.Tag = Replace(pNode.Tag, "女", "")
                    pNode.Tag = Replace(pNode.Tag, "不明", "")
                    If b改行 = False Then pNode.Tag = Replace(pNode.Tag, "Q;", "")
                    SID = 1
                    n = 0
                    Ar = Split(pNode.Tag, ";")
                    For Each Va In Ar

    sBlock = "ツリーノード:" & Ar(n)
                        
                        n = n + 1
                        If Va = "Q" Then
                        
                        Else
                            St = mvarDic.Item(CStr(Va)) & ";" & SID
                            mvarDic.Item(CStr(Va)) = St
                            SID = SID + 1
                        End If
                    Next
                End If
            Next
        End With
        MsgBox "候補者数：" & n有選挙権者 & "名(うち前回有権者数: " & n前回有権者 & "名)"
        
        
        Exit Function
    Er_Ext:
        MsgBox "不正なデータの為、印刷を中断します。" & vbCrLf & "ブロック:" & sBlock & vbCrLf & "[" & Err.Description & "]"
    
    End Function
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants: CPrintCls_Orientation = vbPRORPortrait: End Property
    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&): CPrintCls_Repaint: End Sub
    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property
    Private Property Set CPrintCls_Parent(RHS As ADBasicLIB2.CPrintFormSK): Set mvarParent = RHS: End Property

    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        Dim pNode As Object
        Dim nData As Long
        Dim B As Boolean
        B = False
'        If bNowPage Then
'            For Each pNode In mvarParent.Nodes
'                Print世帯 Fnc.GetKeyHead(pNode.Key), mvarParent.Page
'            Next
'            mvarParent.EndDoc
'        Else
            For Each pNode In mvarParent.Nodes
                If pNode.Checked And Right$(pNode.Text, 6) <> "0,0,0>" Then
                    Select Case Fnc.GetKeyHead(pNode.Key)
                        Case "行政区"
                            mvarParent.PrintPage = 1
                            Do Until Print世帯(pNode.Key, mvarParent.PrintPage - 1)
                                mvarParent.NewPage
                            Loop
                    End Select
                    pNode.Checked = False
                    B = True
                    mvarParent.NewPage
                End If
            Next
            If B Then mvarParent.EndDoc
'        End If
    End Sub

    Private Sub CPrintCls_Repaint()
        Select Case Fnc.GetKeyHead(mvarKey)
            Case "行政区"
                Print世帯 mvarKey, mvarParent.Page - 1
        End Select
    End Sub
        
    Private Function Print世帯(ByVal sKey As String, Optional nPage As Long = 0) As Boolean
        Dim y As Single
        Dim n As Single
        Dim Ar As Variant, Cm As Variant
        Dim St As String
        Dim B As Boolean
        Dim OID As Long
        y = 0
        n = 0
        
        Print世帯 = False
        
        With mvarParent
            .ClearScreen
            .Offset -4, 0
            
            Ar = Split(mvarParent.Nodes(sKey).Tag, ";")
            If UBound(Ar) = -1 Then Print世帯 = True: Exit Function
    '----------------------------文字埋め
            .hTextOut "選挙権", 26 - b農家番号 * 20, 37, 1, , 7
            .TextOut "農業委員会委員選挙人名簿登載申請資料", 100, 15, 15, 2
            .TextOut s名称変更, 30, 30, 11, 2
            .TextOut "No", 20, 38, 11
            
            If b農家番号 Then .TextOut "農家番号", 35, 38, 11, 2
            
            .TextOut "氏名", 32 - b農家番号 * 20, 38, 11
            .TextOut "続柄", 61 - b農家番号 * 20, 38, 11
            .TextOut "性別", 78 - b農家番号 * 20, 38, 11
            .TextOut "生年月日", 87 - b農家番号 * 20, 38, 11
            .TextOut "農地面積", 112 - b農家番号 * 20, 38, 11
            .TextOut "住所", 131 - b農家番号 * 20, 38, 11
    '-----------------------------------
    '-----------------------------表作成
            .LineBox 20, 28, 84, 36, 1, 1, 20   '自治会の枠
            .DLine 18, 44, 200, 44, 0, 4        '仕切り線
    '-----------------------------------
    '---------------------------データはめ込み用の文字位置
            St = Replace(.Nodes(sKey).Text, "<", ",")
            St = Replace(St, ">", ",")
            Cm = Split(St, ",")
            
            .TextOut Left(Cm(0), InStr(Cm(0), "(") - 1), 42, 30, 11     '自治会の横の項目
            .TextOut MID$(Cm(0), InStr(Cm(0), "(")), 84, 30, 11, 1      '自治会の横の項目
            .TextOut "世帯数=" & Right$("    " & FormatNumber(Val(Cm(1)), 0), 4) & " 件", 115, 28, 11, 1
            n = Val(Cm(4)) + Val(Cm(5))
            y = Val(Cm(2)) + Val(Cm(3))
            .TextOut "  人数=" & FormatNumber(n, 0) & "/" & FormatNumber(y, 0) & " 人", 115, 32, 11, 1
            .TextOut "  男性=" & FormatNumber(Val(Cm(4)), 0) & "/" & FormatNumber(Val(Cm(2)), 0) & " 人", 120, 32, 11
            .TextOut "  女性=" & FormatNumber(Val(Cm(5)), 0) & "/" & FormatNumber(Val(Cm(3)), 0) & " 人", 150, 32, 11
            
            B = False
            OID = 0
            For n = 0 To nRows - 1
                y = n * nPit
                If UBound(Ar) <= nPage * nRows + n Then Print世帯 = True: Exit For
                If Ar(nPage * nRows + n) = "Q" Then
                Else
                    Cm = Split(mvarDic.Item(Ar(nPage * nRows + n)), ";")
                    
                    .TextOut (nPage * nRows) + n + 1, 25, 46 + y, 12, 1
                    If b農家番号 Then .TextOut Cm(0), 43, 46 + y, 12, 1                 '農家番号
                    .TextOut Cm(2), 27 - b農家番号 * 20, 46 + y, 12, 2
                    
                    .TextOut Cm(1), 31 - b農家番号 * 20, 46 + y, 11                     '氏名
                    .TextOut Replace(Cm(3), "の-", ""), 61 - b農家番号 * 20, 46 + y, 11 '続柄
                    .TextOut Cm(4), 81 - b農家番号 * 20, 46 + y, 12                     '性別
                    .TextOut Cm(5), 87 - b農家番号 * 20, 46 + y, 12                     '生年月日
                    
                    If b改行 And OID = 0 And ((nPage * nRows) + n) = 0 Then
                        .TextOut FormatNumber(Int(Val(Cm(6))), 0) & " u", 130 - b農家番号 * 20, 46 + y, 12, 1           '経営面積
                        .TextOut Cm(7), 131 - b農家番号 * 20, 46 + y, 11                '住所
                    ElseIf b改行 And Val(Cm(0)) <> OID And Left(Cm(3), 3) <> "世帯主" Then
                        .TextOut FormatNumber(Int(Val(Cm(6))), 0) & " u", 130 - b農家番号 * 20, 46 + y, 12, 1           '経営面積
                        .TextOut Cm(7), 131 - b農家番号 * 20, 46 + y, 11                '住所
                    ElseIf b改行 And Val(Cm(0)) <> OID Then
                        If b罫線 Then .DLine 19, 46 + y - 0.5, 198, 46 + y - 0.5, 0
                        .TextOut FormatNumber(Int(Val(Cm(6))), 0) & " u", 130 - b農家番号 * 20, 46 + y, 12, 1           '経営面積
                        .TextOut Cm(7), 131 - b農家番号 * 20, 46 + y, 11                '住所
                    ElseIf Val(Cm(0)) = OID Then
                        .TextOut FormatNumber(Int(Val(Cm(6))), 0) & " u", 130 - b農家番号 * 20, 46 + y, 12, 1           '経営面積
                        .TextOut Cm(7), 131 - b農家番号 * 20, 46 + y, 11                '住所
                    Else
                        .TextOut FormatNumber(Int(Val(Cm(6))), 0) & " u", 130 - b農家番号 * 20, 46 + y, 12, 1           '経営面積
                        .TextOut Cm(7), 131 - b農家番号 * 20, 46 + y, 11                '住所
                    End If
                    If ((nPage * nRows) + n) = 0 Then
                        OID = 0
                    ElseIf Cm(0) <> OID Then
                        OID = Cm(0)
                    End If
                End If
            Next
            If B And n <> nRows Then .DLine 19, 46 + y - 0.5, 198, 46 + y - 0.5, 0
            If UBound(Ar) <= nPage * nRows + n Then Print世帯 = True
    '-----------------------------------
        End With
    End Function

    Private Sub CPrintCls_TargetChange(sKey As String)
        mvarKey = sKey
        Select Case Fnc.GetKeyHead(mvarKey)
            Case "行政区":
                Dim Ar As Variant
                Ar = Split(mvarParent.Nodes(sKey).Tag, ";")
                mvarParent.MaxPage = Fix(UBound(Ar) / nRows) - ((UBound(Ar) Mod nRows) > 0)
                mvarParent.Page = 1
        End Select
        
        CPrintCls_Repaint
    End Sub

End Class










Class CPrint適格要件届出書
    Option Explicit
    Implements CPrintCls
    Private mvarParent As CPrintFormSK
    Private mvarKey As String
    Private Const nFsize = 10

    Private Property Get CPrintCls_CanCancelPrint() As Boolean

    End Property

    Private Property Get CPrintCls_CanPrintNowPage() As Boolean

    End Property

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean

    End Function

    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property

    Private Property Let CPrintCls_Key(ByVal RHS As String)

    End Property
    Private Property Get CPrintCls_Key() As String: CPrintCls_Key = mvarKey: End Property
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants: CPrintCls_Orientation = vbPRORPortrait: End Property

    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&)

    End Sub
    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Set CPrintCls_Parent(RHS As ADBasicLIB2.CPrintFormSK): Set mvarParent = RHS: End Property

    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        CPrintCls_Repaint
        mvarParent.EndDoc
    End Sub

    Private Sub CPrintCls_Repaint()
        Dim nFsize As Integer
        
        With mvarParent
            .ClearScreen
            .Offset 0, 0
            
            .TextOut "様式第５号", 20, 20, nFsize, 0, 0
            .TextOut "農 業 生 産 法 人 適 格 要 件 届 出 書", 101.5, 30, 13, 2, 0
            .TextOut "平成　　年　　月　　日", 178, 38, nFsize, 1, 0
            .TextOut "住　所", 114, 44, nFsize, 0, 0
            .TextOut "法人名", 114, 51, nFsize, 0, 0
            .TextOut "殿", 68, 58, nFsize, 0, 0
            .TextOut "代表者氏名署名", 114, 58, nFsize, 0, 0
            .DrawText "法人の\n事　業", 20, 76, 15, 5, nFsize, 2, 2
            .DrawText "法人の\n設　立", 59, 76, 15, 5, nFsize, 2, 2
            .TextOut "昭和", 75, 71, nFsize, 0, 0
            .TextOut "平成", 75, 76, nFsize, 0, 0
            .TextOut "年　月　日", 105, 75, nFsize, 1, 2
            .DrawText "法 人 の\n総出資額", 106, 76, 18, 5, nFsize, 2, 2
            .TextOut "円", 146, 75, nFsize, 1, 2
            .DrawText "法人の\n組　織", 148, 76, 15, 5, nFsize, 2, 2
            .DrawText "構成員の\n氏　　名", 20, 94, 18, 5, nFsize, 2, 2
            .DrawText "年\n令", 38, 94, 9, 6, nFsize, 2, 2
            .TextOut "出資額", 54, 93.5, nFsize, 2, 2
            .DrawText "構 成 員と\nなった年月\n日、役職名", 61, 94, 22, 5, nFsize, 2, 2
            .TextOut "法人の農作業に対する従事状況", 119, 87.5, nFsize, 2, 2
            .DrawText "過去１年\n間の実績", 83, 98, 18, 4, nFsize, 2, 2
            .DrawText "今年１年\n間の見込", 101, 98, 18, 4, nFsize, 2, 2
            .DrawText "実施業務\nの 内 容", 119, 98, 18, 4, nFsize, 2, 2
            .DrawText "支 払 済\n賃　　金", 137, 98, 18, 4, nFsize, 2, 2
            .DrawText "農地等の権利の\n設　定　移　転\nを し た 面 積", 155, 94, 28, 4, nFsize, 2, 2
            .TextOut "才", 45, 106, nFsize, 1, 0
            .TextOut "円", 59, 106, nFsize, 1, 0
            .TextOut "日", 99, 106, nFsize, 1, 0
            .TextOut "日", 117, 106, nFsize, 1, 0
            .TextOut "円", 153, 106, nFsize, 1, 0
            .TextOut "u", 181, 106, nFsize, 1, 0
            .TextOut "法人の年間総労日数", 25, 142, nFsize, 0, 0
            .TextOut "日", 89, 142, nFsize, 0, 0
            .TextOut "算出基礎", 25, 149, nFsize, 0, 0
            .TextOut "上記法人について調査したところ下記のとおり相違ないことを確認した。", 25, 170, nFsize, 0, 0
            .TextOut "平成　　　年　　　月　　　日", 31, 177, nFsize, 0, 0
            .TextOut "農業委員会長", 132, 185, nFsize, 1, 0
            .TextOut "印", 176, 185, nFsize, 0, 0
            .TextOut "調査確認者氏名", 132, 198, nFsize, 1, 0
            .DrawText "法人の\n経営地", 20, 217, 15, 5, nFsize, 2, 2
            .TextOut "u", 62, 216, nFsize, 1, 2
            .DrawText "法人の\n役員数", 64, 217, 15, 5, nFsize, 2, 2
            .TextOut "人", 106, 216, nFsize, 1, 2
            .DrawText "左のうち農地等の権利の\n設定移転をしている者で\n常時従事している者の数", 108, 216, 46, 4, nFsize, 2, 2
            .TextOut "人", 181, 216, nFsize, 1, 2
            .TextOut "許可年月日", 30.5, 234, nFsize, 2, 2
            .TextOut "構成員個人の農地等の所有状況", 73, 229.5, nFsize, 2, 2
            .TextOut "田", 49, 238.5, nFsize, 2, 2
            .TextOut "畑", 65, 238.5, nFsize, 2, 2
            .TextOut "その他", 81, 238.5, nFsize, 2, 2
            .TextOut "計", 97, 238.5, nFsize, 2, 2
            .DrawText "左の経営に\n従 事 した\n日　　　数", 105, 234, 21, 4, nFsize, 2, 2
            .DrawText "構成員個人の家族\n状況及び世帯員の\n農作業従事 状 況", 126, 234, 33, 4, nFsize, 2, 2
            .DrawText "左 の 所 得\n状   　　況", 159, 234, 24, 4, nFsize, 2, 2
            .TextOut "u", 55, 245, nFsize, 1, 0
            .TextOut "u", 71, 245, nFsize, 1, 0
            .TextOut "u", 87, 245, nFsize, 1, 0
            .TextOut "u", 103, 245, nFsize, 1, 0
            .TextOut "日", 124, 245, nFsize, 1, 0
            .TextOut "円", 181, 245, nFsize, 1, 0
            .TextOut "その他参考となるべき事項", 25, 263, nFsize, 0, 0
            
            .DBox 20, 26, 183, 276, , 4
            .DLine 20, 67, 183, 67
            .DLine 20, 83, 183, 83
            .DLine 20, 104, 183, 104
            .DLine 20, 139, 183, 139
            .DLine 20, 168, 183, 168
            .DLine 20, 207, 183, 207
            .DLine 20, 225, 183, 225
            .DLine 20, 243, 183, 243
            .DLine 20, 260, 183, 260
            .DLine 83, 92, 155, 92
            .DLine 41, 234, 105, 234
            .DLine 35, 67, 35, 83
            .DLine 59, 67, 59, 83
            .DLine 74, 67, 74, 83
            .DLine 106, 67, 106, 83
            .DLine 124, 67, 124, 83
            .DLine 148, 67, 148, 83
            .DLine 163, 67, 163, 83
            .DLine 38, 83, 38, 139
            .DLine 47, 83, 47, 139
            .DLine 61, 83, 61, 139
            .DLine 83, 83, 83, 139
            .DLine 101, 92, 101, 139
            .DLine 119, 92, 119, 139
            .DLine 137, 92, 137, 139
            .DLine 155, 83, 155, 139
            .DLine 35, 207, 35, 225
            .DLine 64, 207, 64, 225
            .DLine 79, 207, 79, 225
            .DLine 108, 207, 108, 225
            .DLine 154, 207, 154, 225
            .DLine 41, 225, 41, 260
            .DLine 57, 234, 57, 260
            .DLine 73, 234, 73, 260
            .DLine 89, 234, 89, 260
            .DLine 105, 225, 105, 260
            .DLine 126, 225, 126, 260
            .DLine 159, 225, 159, 260
       End With

    End Sub

    Private Sub CPrintCls_TargetChange(sKey As String)

    End Sub

End Class










Class CPrint転用申請チェック表
    Option Explicit
    Implements CPrintCls
    Private mvarParent As CPrintFormSK
    Private mvarKey As String
    Private Const nFsize = 10.5

    Private Property Get CPrintCls_CanCancelPrint() As Boolean

    End Property

    Private Property Get CPrintCls_CanPrintNowPage() As Boolean

    End Property

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean

    End Function

    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property

    Private Property Let CPrintCls_Key(ByVal RHS As String)

    End Property
    Private Property Get CPrintCls_Key() As String: CPrintCls_Key = mvarKey: End Property
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants: CPrintCls_Orientation = vbPRORPortrait: End Property

    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&)

    End Sub
    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Set CPrintCls_Parent(RHS As ADBasicLIB2.CPrintFormSK): Set mvarParent = RHS: End Property

    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        CPrintCls_Repaint
        mvarParent.EndDoc
    End Sub

    Private Sub CPrintCls_Repaint()
        Dim nFsize As Integer
        Dim n As Long
        Dim y As Single
        Dim Ar As Variant
        
        Ar = GetArray(10, 7, 7, 10, 10, 10, 7, 10, 7, 7)
        
        With mvarParent
            .ClearScreen
            .TextOut "転用許可申請書チェック表", 102, 20, 16, 2, 0
            .TextOut "チ　　ェ　　ッ　　ク　　表", 72, 36, nFsize, 2, 2
            .TextOut "４　　条", 139, 33, nFsize, 2, 2
            .TextOut "５　　条", 169, 33, nFsize, 2, 2
            .TextOut "個 人", 131.5, 39, nFsize, 2, 2
            .TextOut "法 人", 146.5, 39, nFsize, 2, 2
            .TextOut "個 人", 161.5, 39, nFsize, 2, 2
            .TextOut "法 人", 176.5, 39, nFsize, 2, 2
            .TextOut " 1　申請書記載事項", 22, 45, nFsize, 0, 2
            .TextOut "(1)　申請者の欄", 66, 45, nFsize, 0, 2
            .TextOut "(2)　申請地の欄", 66, 51, nFsize, 0, 2
            .TextOut "(3)　転用計画の欄", 66, 57, nFsize, 0, 2
            .TextOut "(4)　契約の内容の欄", 66, 63, nFsize, 0, 2
            .TextOut "(5)　資金調達の欄", 66, 69, nFsize, 0, 2
            .TextOut "(6)　被害防除の欄", 66, 75, nFsize, 0, 2
            .TextOut "(7)　その他参考となる事項", 66, 81, nFsize, 0, 2
            .TextOut " 2　申請書に係る別紙", 22, 93, nFsize, 0, 2
            .TextOut " 3　申請地に係る登記簿謄本", 22, 99, nFsize, 0, 2
            .TextOut " 4　位 置 図（市町村の全図等）", 22, 105, nFsize, 0, 2
            .TextOut " 5　住宅地図、字図", 22, 111, nFsize, 0, 2
            .TextOut " 6　配 置 図", 22, 117, nFsize, 0, 2
            .TextOut " 7　定　　款", 22, 123, nFsize, 0, 2
            .TextOut " 8　法人登記簿謄本", 22, 129, nFsize, 0, 2
            .TextOut " 9　所有者の同意書", 22, 135, nFsize, 0, 2
            .TextOut "所有権以外の権利に基づく申請の場合", 60, 135, 7, 0, 2
            .TextOut "10　小作人の同意書", 22, 141, nFsize, 0, 2
            .TextOut "小作人がいる場合のみ（やみ小作は除く）", 60, 141, 7, 0, 2
            .TextOut "11　他法令の許認可の進捗状況", 22, 147, nFsize, 0, 2
            .TextOut "12　土地改良区の意見書", 22, 153, nFsize, 0, 2
            .TextOut "13　水利関係者等の同意書", 22, 159, nFsize, 0, 2
            .TextOut "14　その他", 22, 165, nFsize, 0, 2
            .TextOut "(1)　住民票又は戸籍附票", 46, 167, nFsize, 0, 2
            .DrawText "（現住所と不動産登記簿上の\n　住所が異なる場合）", 88, 164, 33, 3, 7, 0, 0
            .TextOut "(2)　系譜図、戸籍謄本等", 46, 175.5, nFsize, 0, 2
            .TextOut "相続登記未済みの場合", 91, 175.5, 7, 0, 2
            .TextOut "(3)　事 業 計 画 書", 46, 182.5, nFsize, 0, 2
            .TextOut "(4)　資 金 証 明 書", 46, 191, nFsize, 0, 2
            .DrawText "土地取得費を含む総事業計\n画費が3,000万円超の場合", 91, 188, 33, 3, 7, 0, 0
            .TextOut "(5)　理　　由　　書", 46, 201, nFsize, 0, 2
            .DrawText "一般住宅で敷地面積が500\nu超になる場合", 91, 198, 33, 3, 7, 0, 0
            .TextOut "(6)　畜産環境保全意見書", 46, 211, nFsize, 0, 2
            .DrawText "牛50頭、生産豚30頭、養豚\n100頭、養鶏1,000羽以上等", 91, 209, 33, 3, 7, 0, 0
            .TextOut "(7)　通 行 承 諾 書", 46, 219.5, nFsize, 0, 2
            .TextOut "袋地等の場合", 91, 219.5, 7, 0, 2
            .TextOut "(8)　被害防除計画書", 46, 228, nFsize, 0, 2
            .DrawText "転用することにより被害が\n生じるおそれがあるとき", 91, 225, 33, 3, 7, 0, 0
            .TextOut "(9)", 46, 236.5, nFsize, 0, 2
            .DrawText "　その他必要\nな書類がある\n場合に、その\n名称を記入す\nる。", 22, 235, 20, 3.5, 7, 0, 0
            .TextOut "(注)　不要な欄は斜線を引いて使用すること。申請書を提出する際は、できるだけ上記の順番に製本し", 22, 261, nFsize, 0, 0
            .TextOut " 　 て提出すること。", 22, 267, nFsize, 0, 0
            
            .DBox 20, 30, 184, 254
            .DLine 124, 36, 184, 36
            For n = 0 To 20: y = 42 + n * 6: .DLine 20, y, 184, y: Next
            y = 162
            For n = 0 To UBound(Ar): y = y + Ar(n): .DLine 44, y, 184, y: Next
            .DLine 20, 233, 44, 233
            .DLine 64, 42, 64, 90
            .DLine 124, 30, 124, 254
            .DLine 139, 36, 139, 254
            .DLine 154, 30, 154, 254
            .DLine 169, 36, 169, 254
            .DLine 44, 162, 44, 254
            .DLine 40, 235, 42, 234
            .DLine 40, 235, 40, 252
            .DLine 40, 252, 42, 253
       End With

    End Sub

    Private Sub CPrintCls_TargetChange(sKey As String)

    End Sub

End Class










Class CPrint入場券
    Option Explicit
    Implements CPrintCls
    Private mvarParent As CPrintFormSK
    Private mvarData As Variant
    Private mvarColor As Long
    Private mvarKey As String

    Private Property Get CPrintCls_CanCancelPrint() As Boolean
    End Property

    Private Property Get CPrintCls_CanPrintNowPage() As Boolean
    End Property

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim ErrorPos As String
        Dim St As String
        Dim SID As Long
        Dim s世帯主 As String
        Dim s郵便 As String
        Dim s世帯住所 As String
        Dim nCount As Long
        Dim pCount As Long
        
        With mvarParent
            .表示倍率 = 0.75
            .PrintMode("ページ指定可") = True
            St = SystemDB.DBProperty("葉書投票区カラー")
            If Len(St) = 0 Then mvarColor = 255 Else mvarColor = Val(St)
            
            Set Rs = SystemDB.GetRecordsetEx("SELECT [D:個人Info].ID, [D:個人Info].氏名, [D:個人Info].住所, [D:個人Info].性別, [D:個人Info].投票区, [D:個人Info].頁番号, [D:個人Info].頁番号 & '-' & [D:個人Info].整理番号 AS [番号],[郵便番号], [M:投票区].選挙区 FROM [D:個人Info] INNER JOIN [M:投票区] ON [D:個人Info].投票区 = [M:投票区].ID WHERE ((([D:個人Info].住民区分) = 0) And (([D:個人Info].選挙権の有無) = True) And (([D:個人Info].整理番号) > 0)) ORDER BY [D:個人Info].投票区, [D:個人Info].頁番号, [D:個人Info].整理番号;", 0, , Me)
            
            St = ""
            Do Until Rs.EOF
                If SID = 0 Then
                    s世帯主 = Rs.V("氏名")
                    s世帯住所 = Rs.V("住所")
                    s郵便 = Rs.V("郵便番号")
                    s郵便 = Replace(s郵便, "-", "")
                    St = St & vbCrLf & Join(GetArray(s郵便, s世帯住所, s世帯主, vbTab, Rs.V("選挙区"), Rs.V("投票区"), Rs.V("番号"), Rs.V("氏名"), IIf(Rs.V("性別") = 1, "女", "男")), vbBack)
                    nCount = 0
                    SID = Rs.V("頁番号")
                    pCount = 1
                ElseIf SID = Rs.V("頁番号") Then
                    If nCount < 2 Then
                        nCount = nCount + 1
                        St = St & vbTab & Join(GetArray(Rs.V("選挙区"), Rs.V("投票区"), Rs.V("番号"), Rs.V("氏名"), IIf(Rs.V("性別") = 1, "女", "男")), vbBack)
                    Else
                        St = St & vbCrLf & Join(GetArray(s郵便, s世帯住所, s世帯主, vbTab, Rs.V("選挙区"), Rs.V("投票区"), Rs.V("番号"), Rs.V("氏名"), IIf(Rs.V("性別") = 1, "女", "男")), vbBack)
                        pCount = pCount + 1
                        nCount = 0
                    End If
                Else
                    s世帯主 = Rs.V("氏名")
                    s世帯住所 = Rs.V("住所")
                    s郵便 = Rs.V("郵便番号")
                    s郵便 = Replace(s郵便, "-", "")
                    St = St & vbCrLf & Join(GetArray(s郵便, s世帯住所, s世帯主, vbTab, Rs.V("選挙区"), Rs.V("投票区"), Rs.V("番号"), Rs.V("氏名"), IIf(Rs.V("性別") = 1, "女", "男")), vbBack)
                    nCount = 0
                    pCount = pCount + 1
                    SID = Rs.V("頁番号")
                End If
                
                
                Rs.MoveNext
            Loop

            .Page = 1
            .MaxPage = pCount
            mvarData = Split(St, vbCrLf)
        End With

    Exit Function
    Ext:
        MsgBox ErrorPos & ";" & Err.Description
        Exit Function
    End Function
    Private Property Let CPrintCls_Key(ByVal RHS As String)
    
    End Property
    Private Property Get CPrintCls_Key() As String
    
    End Property
    Private Property Get CPrintCls_FontType() As String
        CPrintCls_FontType = "ＭＳ 明朝"
    End Property
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants
        CPrintCls_Orientation = vbPRORPortrait
    End Property
    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&)
        CPrintCls_Repaint
    End Sub
    Private Property Get CPrintCls_PaperSize() As Long
        mvarParent.PaperSize.Width = 102
        mvarParent.PaperSize.Height = 152
        CPrintCls_PaperSize = vbPRPSUser
    End Property
    Private Property Set CPrintCls_Parent(RHS As CPrintFormSK)
        Set mvarParent = RHS
    End Property
    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        Dim n As Long
        Dim A As Long
        Dim B As Long
        
        'mvarParent.Printer.PaperBin = vbPRBNManual
        A = IIf(nStart > 0, nStart, 1)
        B = IIf(nEnd > 0, nEnd, UBound(mvarData))
        If B < A Then
            A = IIf(nEnd > 0, nEnd, UBound(mvarData))
            B = nStart
        End If
        For n = A To B
            If Len(mvarData(n)) Then
                PrintSub "", n
                mvarParent.NewPage
            End If
        Next
        mvarParent.EndDoc
    End Sub
    Private Sub CPrintCls_TargetChange(sKey As String)
        CPrintCls_Repaint
    End Sub
    Private Sub CPrintCls_Repaint()
        PrintSub mvarKey, mvarParent.Page
    End Sub
    Private Sub PrintSub(sKey As String, nPage As Long)
        Dim sData As String
        Dim Ar As Variant, Cm As Variant
        
        Dim x As Single, y As Single
        Dim m As Single, n As Single
        Dim LR As String
        Dim Fg As String
        
        LR = 0
        Fg = 0
        
        With mvarParent
            .ClearScreen
            
            If UBound(mvarData) = -1 Then Exit Sub
            Ar = Split(mvarData(nPage), vbTab)
            Cm = Split(Ar(0), vbBack)
            .Offset Val(SystemDB.DBProperty("葉書横ｵﾌｾｯﾄ")), Val(SystemDB.DBProperty("葉書縦ｵﾌｾｯﾄ"))
            .TextOut MID$(Cm(0), 4, 1), 67, 13, 18, 0, 0
            .TextOut MID$(Cm(0), 5, 1), 74, 13, 18, 0, 0
            .TextOut MID$(Cm(0), 6, 1), 81, 13, 18, 0, 0
            .TextOut MID$(Cm(0), 7, 1), 88, 13, 18, 0, 0
            
            .TextOut Replace(Cm(1), "枕崎市", ""), 37, 37, 14, 0, 0
            .TextOut Trim(Cm(2)), 24, 49, 14, 0, 0
            
            For n = 0 To 2
'            For y = 0 To 75 Step 25
                y = n * 25
                If n + 1 > UBound(Ar) Then Exit For
                
                Cm = Split(MID$(Ar(n + 1), 1 - (Left$(Ar(n + 1), 1) = vbBack)), vbBack)
                .ForeColor = mvarColor
                .TextOut Cm(0), 23, 72 + y, 11, 0, 0
                .ForeColor = vbBlack
                .TextOut Cm(1), 11, 78 + y, 11, 0, 0
                .TextOut Cm(2), 57, 78 + y, 11, 2, 0
                        
                .TextOut Cm(3), 10, 85 + y, 11, 0, 0
                .TextOut Cm(4), 86, 85 + y, 11, 0, 0
            Next
            
    '----------------------------データはめ込み用の文字位置
            

    '-----------------------------------
        End With
    End Sub

End Class










Class CPrint年金受付簿
    Option Explicit
    Implements CPrintCls
    Private mvarParent As CPrintFormSK
    Private mvarPData As CPrintDatas
    Private mvarKey As String
    Private mvar区分 As Long
    Private Const nRows = 17

    Private Property Get CPrintCls_CanCancelPrint() As Boolean
    End Property

    Private Property Get CPrintCls_CanPrintNowPage() As Boolean: CPrintCls_CanPrintNowPage = True: End Property

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim Ar As Variant
        Dim n種類開始 As Long
        Dim n種類終了 As Long
        Dim s区分 As String
        Dim n As Long
        Dim sSQL As String
        Dim nRows As Long
        
        Ar = Split(sParam, ";")
        mvar区分 = Val(Ar(0))
        n種類開始 = 0: n種類終了 = 0
        
        Select Case mvar区分
            Case 1: s区分 = "年金受付種別"
            Case 2: s区分 = "年金一時請求受付種別"
        End Select
        Set Rs = SystemDB.GetRecordsetEx("SELECT Min([M_BASICALL].ID) AS 最小ID, Max([M_BASICALL].ID) AS 最大ID FROM [M_BASICALL] WHERE ([M_BASICALL].Class='" & s区分 & "');", 0, , "年金")
        If Not Rs.EOF Then
            n種類開始 = Rs.Value("最小ID")
            n種類終了 = Rs.Value("最大ID")
        End If
        SystemDB.CloseRs Rs
        
        Set mvarPData = New CPrintDatas
        With mvarPData
            .Headers = "受付番号;受付年月日;氏名;届出種類;支所名;送付年月日;備考;"
            
            sSQL = "SELECT [D_年金受付].*, [D:個人Info].氏名, [M_BASICALL].名称 AS [届出種類], [M_BASICALL_1].sParam AS [支所名]"
            sSQL = sSQL & " FROM (([D_年金受付] LEFT JOIN [D:個人Info] ON [D_年金受付].届出者ID = [D:個人Info].ID) LEFT JOIN [M_BASICALL] ON [D_年金受付].届出の種類 = [M_BASICALL].ID) LEFT JOIN [M_BASICALL] AS [M_BASICALL_1] ON [D_年金受付].支所番号 = [M_BASICALL_1].ID"
            sSQL = sSQL & " WHERE (((Format([D_年金受付].[受付年月日],'ge'))='" & Ar(1) & "') AND (([D_年金受付].届出の種類)>=" & n種類開始 & " And ([D_年金受付].届出の種類)<=" & n種類終了 & ") AND (([M_BASICALL].Class)='" & s区分 & "') AND (([M_BASICALL_1].Class)='支所番号'))"
            sSQL = sSQL & " ORDER BY [D_年金受付].受付番号;"
            Set Rs = SystemDB.GetRecordsetEx(sSQL, 1, , "年金受付簿")
            Do Until Rs.EOF
                n = .NewLine
                .SetRsData n, "受付番号", Rs
                .SetRsData n, "受付年月日", Rs
                .SetRsData n, "氏名", Rs
                .SetRsData n, "届出種類", Rs
                .SetRsData n, "支所名", Rs
                .SetRsData n, "送付年月日", Rs
                .SetRsData n, "備考", Rs
                Rs.MoveNext
            Loop
            SystemDB.CloseRs Rs
            
            mvarParent.Page = 1
            mvarParent.MaxPage = .Count \ nRows + IIf((.Count Mod nRows) > 0, 1, 0)
        End With
    End Function

    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property

    Private Property Let CPrintCls_Key(ByVal RHS As String): End Property
    Private Property Get CPrintCls_Key() As String: CPrintCls_Key = mvarKey: End Property
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants: CPrintCls_Orientation = vbPRORPortrait: End Property
    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&)
        mvarParent.Page = nNewPage
        CPrintCls_Repaint
    End Sub
    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Set CPrintCls_Parent(RHS As ADBasicLIB2.CPrintFormSK): Set mvarParent = RHS: End Property

    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        If bNowPage Then
            PrintSub mvarParent.Page
            mvarParent.EndDoc
        Else
            mvarParent.PrintPage = 1
            mvarParent.PrintMaxPage = mvarParent.MaxPage
            Do Until mvarParent.PrintPage > mvarParent.PrintMaxPage
                PrintSub mvarParent.PrintPage
                mvarParent.NewPage
            Loop
            mvarParent.EndDoc
        End If
    End Sub
    Private Sub CPrintCls_Repaint(): PrintSub mvarParent.Page: End Sub
    
    Private Sub PrintSub(nPage As Long)
        Dim nFsize As Integer
        Dim Ar As Variant
        Dim n As Long, i As Long
        Dim dX(10) As Single, hX(10) As Single
        Dim Xcnt As Long
        Dim St As String
        Dim nRowH As Single
        Dim SY As Single, SX As Single
        Dim nStart As Long, nEnd As Long
        Dim y As Single
        Dim HH As Single
        
        If mvarPData Is Nothing Then Exit Sub
        nFsize = 10
        nRowH = 14
        SY = 40
        SX = 12
        HH = 6
        
        Ar = GetArray(16, 20, 36, 46, 18, 20, 30)
        dX(0) = SX: hX(0) = dX(0) + Ar(0) / 2
        For n = 0 To UBound(Ar)
            dX(n + 1) = dX(n) + Ar(n)
            If n < UBound(Ar) Then hX(n + 1) = dX(n + 1) + Ar(n + 1) / 2
        Next
        Xcnt = UBound(Ar) + 1

        With mvarParent
            .ClearScreen
            .Offset 0, 0
            Select Case mvar区分
                Case 1: St = "農業者年金給付関係書類受付処理簿（旧農業者年金）"
                Case 2: St = "農業者年金一時金請求書受付処理簿（旧農業者年金）"
            End Select
            .TextOut St, (dX(0) + dX(Xcnt)) / 2, 25, 16, 2
            .TextOut "＜平成 " & Format(Now(), "e") & " 年度＞", dX(Xcnt) - 2, 39, 11, 1, 1
            y = SY + HH / 2
            .TextOut "受付番号", hX(0), y, nFsize, 2, 2
            .TextOut "受付年月日", hX(1), y, nFsize, 2, 2
            .TextOut "氏　　名", hX(2), y, nFsize, 2, 2
            .TextOut "届出の種類", hX(3), y, nFsize, 2, 2
            .TextOut "総合支所名", hX(4), y, nFsize - 2, 2, 2
            .TextOut "送付年月日", hX(5), y, nFsize, 2, 2
            .TextOut "備　　考", hX(6), y, nFsize, 2, 2
            .LineBoxDX dX(0), SY, HH, nRows, nRowH, Ar
            
            nStart = (nPage - 1) * nRows + 1
            nEnd = nStart + nRows - 1
            If nEnd > mvarPData.Count Then nEnd = mvarPData.Count
            
            y = SY + HH + nRowH / 2
            For n = nStart To nEnd
                .DrawText mvarPData.Data(n, "受付番号"), dX(0), y, Ar(0), 4, nFsize, 2, 2
                .DrawText Format(mvarPData.Data(n, "受付年月日"), "gee/mm/dd"), dX(1), y, Ar(1), 4, nFsize, 2, 2
                .DrawText mvarPData.Data(n, "氏名"), dX(2) + 1, y, Ar(2) - 1, 4, nFsize, 0, 2
                .DrawText mvarPData.Data(n, "届出種類"), dX(3) + 1, y, Ar(3) - 1, 4, nFsize, 0, 2
                .DrawText mvarPData.Data(n, "支所名"), dX(4), y, Ar(4), 4, nFsize, 2, 2
                .DrawText Format(mvarPData.Data(n, "送付年月日"), "gee/mm/dd"), dX(5), y, Ar(5), 4, nFsize, 2, 2
                .DrawText mvarPData.Data(n, "備考"), dX(6) + 1, y, Ar(6) - 1, 4, nFsize, 0, 2
                y = y + nRowH
            Next
        End With
    End Sub

    Private Sub CPrintCls_TargetChange(sKey As String)
    End Sub

End Class










Class CPrint買受適格証明願
    Option Explicit
    Implements CPrintCls
    Private mvarParent As CPrintFormSK
    Private mvarKey As String

    Private Property Get CPrintCls_CanCancelPrint() As Boolean

    End Property

    Private Property Get CPrintCls_CanPrintNowPage() As Boolean

    End Property

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean

    End Function
    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property

    Private Property Let CPrintCls_Key(ByVal RHS As String)

    End Property
    Private Property Get CPrintCls_Key() As String: CPrintCls_Key = mvarKey: End Property
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants: CPrintCls_Orientation = vbPRORPortrait: End Property

    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&)

    End Sub
    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Set CPrintCls_Parent(RHS As ADBasicLIB2.CPrintFormSK): Set mvarParent = RHS: End Property

    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        CPrintCls_Repaint
        mvarParent.EndDoc
    End Sub

    Private Sub CPrintCls_Repaint()
        Dim sData As String
        Dim Ar As Variant, Cm As Variant
        
        Dim y As Single
        Dim n As Single
        Dim nPit As Single, HH As Single, Rows As Long, Ay As Variant       'DX1個目
        Dim nPit1 As Single, HH1 As Single, Rows1 As Long, Ay1 As Variant   'DX2個目
        Dim nPit2 As Single, HH2 As Single, Rows2 As Long, Ay2 As Variant   'DX3個目
        Dim St As String
        Dim LH As Long

        Dim P As Variant
        Dim Flg As Variant

        y = 0
        n = 0

        HH = 6      'ヘッダーの高さ
        Rows = 1    '何セル分
        nPit = 8    '表の中の繰り返しの巾
        Ay = GetArray(40, 19, 14, 59, 30)

        HH1 = 16    'ヘッダーの高さ
        Rows1 = 5  '何セル分
        nPit1 = 12  '表の中の繰り返しの巾
        Ay1 = GetArray(25, 24, 14, 14, 14, 35.5, 35.5)

        HH2 = 6    'ヘッダーの高さ
        Rows2 = 1  '何セル分
        nPit2 = 22  '表の中の繰り返しの巾
        Ay2 = GetArray(20, 40, 40, 32, 30)

    '----------------------------------
        With mvarParent
            .ClearScreen
            .Offset -4, -15
    '----------------------------------
    '----------------------------文字埋め
            .TextOut "様式第1号", 24, 23, 11, 0, 2
            .TextOut "買 受 適 格 証 明 願", 105, 40, 16, 2, 2
            .TextOut Format(Now, "GGGEE年MM月DD日"), 190, 54, 11, 1, 2
            .TextOut "鹿児島県知事　　　　　殿", 25, 58, 11, 0, 2
            .TextOut "(　　　　　　農業委員 会長)", 25, 64, 11, 0, 2
            .TextOut "申請者氏名　　　　　　　　　　印", 190, 70, 11, 1, 2
            
            .TextOut "下記のとおり農地等の競売に参加したいので適格者であることの証明を願います｡", 105, 82, 11, 2, 2
            .TextOut "記", 105, 90, 11, 2, 2
            
            .TextOut "1", 13, 99, 11
            .hTextOut "申請者の 氏名･年齢住所等", 16, 99, 5, 4, 11
            .TextOut "氏　　　　名", 56, 101, 11, 2, 2
            .TextOut "職 業", 85.5, 101, 11, 2, 2
            .TextOut "年齢", 102, 101, 11, 2, 2
            .TextOut "住　　　　　　所", 138.5, 101, 11, 2, 2
            .TextOut "電話番号", 183, 101, 11, 2, 2

            .TextOut "2", 13, 114, 11
            .DrawText "土地の所在\n地番\n地目\n面積\n利用状況", 16, 114, 22, 6, 11
            .DrawText "10a当り\n収穫高", 16, 145, 22, 4, 11
            .DrawText "所有者と\n耕作者の\n氏名", 16, 156, 22, 4, 11
            .DrawText "所有期間\n及び\n利用権原", 16, 170, 22, 4, 11
            .TextOut "所在・地番", 48.5, 120, 11, 2, 2
            .TextOut "地　 目", 73, 114.5, 11, 2, 2
            .TextOut "所　有　者", 145, 115, 11, 2, 2
            .TextOut "耕　作　者", 180, 115, 11, 2, 2
            .TextOut "登記簿", 67, 122.5, 10, 2, 2
            .TextOut "現況", 79, 122.5, 10, 2, 2
            .TextOut "面積", 92, 120, 11, 2, 2
            .DrawText "利用\n状況", 99, 121, 14, 5, 11, 2, 2
            
            .DrawText "10ａ当\nり普通\n収穫高", 113, 120, 14, 4, 11, 2, 2

            .TextOut "氏  名", 138.5, 122.5, 11, 2, 2
            .DrawText "所有\n期間", 150, 123, 12, 4, 11, 2, 2
            .TextOut "氏  名", 173, 122.5, 11, 2, 2
            .DrawText "利用\n権原", 185, 123, 13, 4, 11, 2, 2

            .TextOut "計", 50, 189, 11
            .TextOut "(田", 80, 189, 11
            .TextOut "畑", 112, 189, 11
            .TextOut "採草放牧地            )", 144, 189, 11

            .TextBox "競売の内容", 12, 194, 36, 222, 11, 2, 2
            .TextOut "競売原因", 46, 197, 11, 2, 2
            .TextOut "入札期日・期間", 76, 197, 11, 2, 2
            .TextOut "売却決定期日", 116, 197, 11, 2, 2
            .TextOut "所轄裁判所名", 152, 197, 11, 2, 2
            .TextOut "競売事件名", 183, 197, 11, 2, 2
            .hTextOut "入札期日入札期間", 57, 201, 4, 8, 11
            .TextOut "その他参考となるべき事項", 15, 226, 11, , 2
            .TextOut "(農地法第5条第1項の規定による許可を要する農地等の場合、転用目的を記載)", 63, 226.5, 10, , 2
            .TextOut "指令欄", 15, 242, 11, , 2
            .TextOut "本申請農地等の競売参加の件農地法第　　　条の規定により適格者であることを証明する｡", 22, 250, 11, , 2
            .TextOut "ただし、平成　　年　　月　　日〜平成　　年　　月　　日に限り効力を有する｡", 22, 256, 11, , 2

            .TextOut "鹿児島県知事", 128, 271, 11, 2, 2
            .TextOut "印", 185, 271, 11, 2, 2
            .TextOut "(農業委員会会長)", 128, 276, 11, 2, 2
    '-----------------------------------
    '----------------------------表作成
            .TextOut "県  受  付  印", 37, 33, 11, 2, 2
            .DotLine 16, 30, 58, 30, vbBlack
            .DotLine 16, 36, 58, 36, vbBlack
            .DotLine 16, 50, 58, 50, vbBlack
            .DotLine 16, 30, 16, 50, vbBlack
            .DotLine 58, 30, 58, 50, vbBlack
            
            .TextOut "農業委員会受付", 173, 33, 11, 2, 2
            .DotLine 152, 30, 194, 30, vbBlack
            .DotLine 152, 36, 194, 36, vbBlack
            .DotLine 152, 50, 194, 50, vbBlack
            .DotLine 152, 30, 152, 50, vbBlack
            .DotLine 194, 30, 194, 50, vbBlack

            .LineBoxDX 36, 98, HH, Rows, nPit, Ay         '1の横の枠
            .LineBoxDX 36, 112, HH1, Rows1, nPit1, Ay1    '2の横の枠
                        
            .DLine 61, 118, 85, 118, vbBlack        '地目の下の横線
            .DLine 127, 118, 198, 118, vbBlack      '所有者&耕作者の下の横線
            .DLine 73, 118, 73, 188, vbBlack        '地目の下の縦線
            .DLine 150, 118, 150, 188, vbBlack      '所有者の下の縦線
            .DLine 184.5, 118, 184.5, 188, vbBlack  '耕作者の下の縦線
                                    
            LH = Rows1 * nPit1 + HH1 + 6
                        
            .LineBoxDX 36, 112 + LH, HH2, Rows2, nPit2, Ay2  '競売の内容の横の枠
            .DLine 12, 112 + LH + Rows2 * nPit2 + HH2 + 15, 198, 112 + LH + Rows2 * nPit2 + HH2 + 15, vbBlack      '参考となるべき事項の下の横線
            
            .LineBox 12, 112, 36, 112 + LH + HH2 + nPit2, , , , 82    '2と競売の内容の枠
            .DBox 12, 98, 198, 284, vbBlack, 2     '外枠の太線
    '-----------------------------------
    '------------------------------当込み

    '-----------------------------------
        End With

    End Sub

    Private Sub CPrintCls_TargetChange(sKey As String)

    End Sub

End Class










Class CPrint非農地証明
    Option Explicit
    Implements CPrintCls
    Private mvarParent As ADBasicLIB2.CPrintFormSK
    Private mvarKey As String
    Private s市町村 As String
    Private s会長名 As String
    Private mvarParams As ADBasicLIB2.CDataCollectSK
    Private sData As Variant
    Private Rows As Long
    Private cnt As Long
    
    Public Property Let Key(sKey As String): mvarKey = sKey: End Property
    Private Sub Class_Terminate(): Set mvarParams = Nothing: End Sub
    Private Property Get CPrintCls_CanCancelPrint() As Boolean: End Property
    Private Property Get CPrintCls_CanPrintNowPage() As Boolean: CPrintCls_CanPrintNowPage = True: End Property

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean
        s市町村 = SystemDB.DBProperty("市町村名")
        s会長名 = SystemDB.DBProperty("会長名")
        Set mvarParams = ADApp.Common.GetDataCollect()
        
        非農地証明Init sParam, mvarParent.Page, cnt
    End Function
    
    Private Sub 非農地証明Init(ByVal sParam As String, nPage As Long, cnt As Long)
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim s世帯 As String
        Dim s個人 As String
        Dim s田地目 As String
        Dim s畑地目 As String
        Dim Ar As Variant
        Dim i As Long
        Dim n自作(3) As Long
        Dim n小作(3) As Long
        Dim nSK As Variant
        Dim n田合計 As Long
        Dim n畑合計 As Long
        Dim RC As Long
        
        s田地目 = Replace(SystemDB.DBProperty("田地目"), ";", ",")
        s畑地目 = Replace(SystemDB.DBProperty("畑地目"), ";", ",")
        
        mvarParams.FieldList = "申請者名;住所;証明書発効日;証明書発効番号;使用目的;提出先;田;畑;樹園;田合計;畑合計;所有者"
        Ar = Split(sParam, ";")
        mvarKey = Ar(0)
        Select Case Fnc.GetKeyHead(Ar(0))
            Case "農家":
                s世帯 = Ar(0)
                Set Rs = SystemDB.GetRecordsetEx("SELECT [D:世帯Info].世帯主ID,[D:個人Info].氏名,[D:個人Info].住所 FROM [D:世帯Info] LEFT JOIN [D:個人Info] ON [D:世帯Info].[世帯主ID] = [D:個人Info].[ID] WHERE [D:世帯Info].[ID]=1584", , , "非農地証明書")
                If Not Rs.EOF Then
                    s個人 = "世帯員." & Rs.Value("世帯主ID")
                    mvarParams.ListData(0, "申請者名") = Rs.Value("氏名")
                    mvarParams.ListData(0, "住所") = Rs.Value("住所")
                    Rs.CloseRs
                
                    Set Rs = SystemDB.GetRecordsetEx("SELECT V_農地.耕作世帯ID, V_農地.耕作者ID, V_農地.土地所在, V_地目.ID AS 地目ID, V_地目.名称 AS 地目名, V_農地.実面積, V_農地.田面積, V_農地.畑面積, V_農地.樹園地, V_農地.所有者ID, [D:個人Info].氏名 AS 所有者 FROM (V_農地 INNER JOIN V_地目 ON V_農地.現況地目 = V_地目.ID) INNER JOIN [D:個人Info] ON V_農地.管理人ID = [D:個人Info].ID WHERE (((V_農地.耕作世帯ID)=" & Fnc.GetKeyCode(Ar(0)) & ") AND ((V_農地.現況地目) In (" & s田地目 & "," & s畑地目 & "))) ORDER BY V_農地.土地所在;", , , "非農地証明書")

                    Do Until Rs.EOF
                        Rs.MoveNext
                    Loop
                    
                    Rs.CloseRs
                Else
                    Rs.CloseRs
                End If
            Case "世帯員":
        End Select
        
        Rows = 15
        If cnt < Rows Then
            mvarParent.MaxPage = 1
        Else
            Rows = 30
            mvarParent.MaxPage = Fix(((cnt - 1) - 15) / Rows) + 2
        End If
    End Sub
    
    Private Property Set CPrintCls_DB(RHS As Object)
    End Property
    
    Private Property Let CPrintCls_Key(ByVal RHS As String): mvarKey = RHS: End Property
    Private Property Get CPrintCls_Key() As String: CPrintCls_Key = mvarKey: End Property
    
    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants: CPrintCls_Orientation = vbPRORPortrait: End Property

    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&)
        非農地証明Print nNewPage
    End Sub
    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Set CPrintCls_Parent(RHS As CPrintFormSK): Set mvarParent = RHS: End Property
    
    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        With mvarParent
            .PrintPage = 1
            .PrintMaxPage = .MaxPage
            
            If bNowPage Then
                非農地証明Print .Page
                .EndDoc
            Else
                Do Until .PrintPage > .PrintMaxPage
                    非農地証明Print .PrintPage
                    .NewPage
                Loop
                .EndDoc
            End If
        End With
    End Sub
    
    Private Sub CPrintCls_Repaint()
        If Not mvarParams Is Nothing Then
            Select Case Fnc.GetKeyHead(mvarKey)
                Case "農家": 非農地証明Print mvarParent.Page
            End Select
        End If
    End Sub
    
    Private Sub 非農地証明Print(nPage As Long)
        Dim s発効日 As String
        Dim s使用目的 As String
        Dim s提出先 As String
        Dim Ar As Variant, Cm As Variant
        Dim Cx As Variant
        Dim Cy As Variant
        Dim x As Long, y As Long
        Dim St As String
        Dim SX As Single, EX As Single  'データ始点・終点(X)
        Dim SY As Single                'データ始点(Y)
        Dim hY As Single                'データ当込み用
        Dim dX(5) As Single, hX(5) As Single
        Dim n As Long
        Dim i As Long
        Dim nPit As Single, HH As Single, Rows As Long, Ay As Variant
        Dim FF As Single                '表の合計の高さ
        Dim nX As String
        Dim pTable As New CDrawTable
        
        If nPage = 0 Then Exit Sub
        
    '        s発効日 = StrConv(Format(CDate(mvarParams.ListData(0, "証明書発効日")), "GGGEE年 M月 D日"), vbNarrow)
    '        s使用目的 = mvarParams.ListData(0, "使用目的")
    '        s提出先 = mvarParams.ListData(0, "提出先")
        
        HH = 12     'ヘッダーの高さ
        nPit = 8    '表の中の繰り返しの巾
        Rows = 6
        Ay = GetArray(70, 32, 28, 40)
        
        SX = 15
        SY = 20
        EX = SX + 170
        
        FF = 30     'フッターの高さ
        pTable.SetWidth SX, Ay
        dX(0) = SX: hX(0) = dX(0) + Ay(0) / 2
        For i = 0 To UBound(Ay)
            dX(i + 1) = dX(i) + Ay(i)
            If i < UBound(Ay) Then hX(i + 1) = dX(i + 1) + Ay(n + 1) / 2
        Next
        
        With mvarParent
    '-----------------------------------
            .ClearScreen
            .Offset 0, 6
    '-----------------------------------
            Ar = Split(sData, vbCrLf)
    '            Cm = Split(Ar(1), vbCr)
    '-----------------------------文字埋め
            .TextOut "任意様式", SX, SY, 11, 0, 2
            .TextOut "非　農　地　証　明　願", ((SX + .PaperWidth) / 2), SY + 14, 20, 2, 2
            .DrawText "  下記の土地の土地登記簿の地目は台帳上,下記の表のとおりなっていますが, " & Format(Now(), "GGG E 年") & "\n以前から農地法第２条に規定する農地でないことを証明してください｡", SX, SY + 28, SX + 160, 8, 11
            
            .DLine SX + 136, SY + 32, SX + 160, SY + 32
            
            .TextOut "記", ((SX + .PaperWidth) / 2), SY + 50, 11, 2, 2

            SY = SY + 60
            hY = SY + HH + (nPit / 3)
            
            .LineBoxDX SX, SY, HH, Rows, nPit, Ay
            .DLine dX(1), SY + 6, dX(2), SY + 6
            .DLine hX(1), SY + (HH / 2), hX(1), SY + HH + Rows * nPit
            .TextOut "土　地　の　所　在", hX(0), SY + (HH / 2), 12, 2, 2
            .TextOut "地   目", hX(1), SY + (HH / 4) + 0.5, 12, 2, 2
            
            .TextOut "登記簿", dX(1) + (Ay(1) / 4), SY + (HH / 4) * 3, 12, 2, 2
            .TextOut "現  況", dX(1) + (Ay(1) / 4) * 3, SY + (HH / 4) * 3, 12, 2, 2
            .DrawText "地　籍\n( u )", dX(2), SY + 1, Ay(2), 5, 12, 2
            .TextOut "登記名義人", hX(3), SY + (HH / 2), 12, 2, 2
            
            For i = 1 To Rows
    '                If X = 0 Then Exit For
    '                .TextOut "市町村名大字＆字＆地番", Sx + 1, hY + y, 11
    '                .TextOut "登記地目", dX(1) + (Ay(1) / 4), hY + y, 11, 2
    '                .TextOut "現況地目", dX(1) + (Ay(1) / 4) * 3, hY + y, 11, 2
    '                .TextOut FormatNumber(88888, 0), dX(3) - 1, hY + y, 11, 1
    '                .TextOut "登記名義人", dX(3) + 1, hY + y, 11
                y = i * nPit
            Next
            
            SY = SY + Rows * nPit + 20
            
            .TextOut Format(Now(), "GGG E 年 M 月 D 日"), SX + 2, SY, 11
            .TextOut s市町村 & "農業委員会  会長    殿", SX + 2, SY + 12, 11
            .TextOut "申請人　　住　所   " & "申請人住所", SX + 80, SY + 24, 11
            .TextOut "　　　　　氏　名   " & "申請人氏名", SX + 80, SY + 34, 11
            .TextOut "印", EX, , 11, 1
            .LineX SX + 117, EX, SY + 29, 2, 10

            .TextOut "※　添付書類  @願出地付近の現況図（住宅地図等）×１部", SX, SY + 46, 11
            .TextOut "A願出地の登記簿謄本×１部", SX + 27.3, SY + 51, 11
            .TextOut "B公図の写し（隣接地において，地番，地目，所有者を表示すること。）×１部", SX + 27.3, SY + 56, 11

            .DotLine SX, SY + 65, EX, SY + 65, RGB(0, 0, 0), vbDashDot
s市町村 = "       "
s会長名 = "       "
            .TextOut "上記土地については，農地法第２条に規定する農地ではないことを証明する。", SX, SY + 70, 11
            .TextOut Format(Now(), "GGG E 年 M 月 D 日"), SX, SY + 80, 11
            .TextOut s市町村 & "農業委員会", SX + 130, SY + 90, 11
            .TextOut "会長　" & s会長名, SX + 130, SY + 96, 11
        End With
    End Sub

    Private Sub CPrintCls_TargetChange(sKey As String)

    End Sub

End Class










Class CPrint利用権終期台帳
    Option Explicit
    Implements ADBasicLIB2.CPrintCls
    Private mvarParent As ADBasicLIB2.CPrintFormSK
    Private mvarList As Variant
    Private mvarStartDT As String
    Private mvarEndDT As String
    Private s名称変更 As String

    Private Property Get CPrintCls_CanCancelPrint() As Boolean: End Property
    Private Property Get CPrintCls_CanPrintNowPage() As Boolean: End Property

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim Ar As Variant
        Dim St As String
        
        St = "自治会集落名行政区公民館公民会"
        s名称変更 = MID(St, Val(SystemDB.DBProperty("選挙申請名簿用")) * 3 + 1, 3)
        
        Ar = Split(sParam, ";")
        mvarStartDT = Format(Ar(0), "GGGEE年MM月DD日")
        mvarEndDT = Format(Ar(1), "GGGEE年MM月DD日")
    
        Set Rs = SystemDB.GetRecordsetEx("SELECT V_行政区.行政区 AS 設定者集落, [D:個人Info].住所 AS 設定者住所, [D:個人Info].氏名 AS 設定者, IIf([D:個人INfo].[死亡],'死亡',' ') AS 設定者区分, V_行政区_1.行政区 AS 被設定者集落, [D:個人Info_1].住所 AS 被設定者住所, [D:個人Info_1].氏名 AS 被設定者, [V_大字].大字, [V_小字].名称, [D:農地info].地番, V_地目.名称 AS 地目, [D:農地info].登記簿面積, M_BASICALL.名称 AS 種類, [D:農地info].小作料, Format([小作開始年月日],'ggee/mm/dd') AS 開始日, Format([小作終了年月日],'ggee/mm/dd') AS 終了日 " & _
        "FROM ((((((([D:農地info] INNER JOIN [D:個人Info] ON [D:農地info].所有者ID = [D:個人Info].ID) INNER JOIN [D:個人Info] AS [D:個人Info_1] ON [D:農地info].借受人ID = [D:個人Info_1].ID) LEFT JOIN [V_大字] ON [D:農地info].大字ID = [V_大字].ID) LEFT JOIN [V_小字] ON [D:農地info].小字ID = [V_小字].ID) INNER JOIN M_BASICALL ON [D:農地info].小作形態 = M_BASICALL.ID) INNER JOIN V_地目 ON [D:農地info].現況地目 = V_地目.ID) LEFT JOIN V_行政区 AS V_行政区_1 ON [D:個人Info_1].行政区ID = V_行政区_1.ID) LEFT JOIN V_行政区 ON [D:個人Info].行政区ID = V_行政区.ID " & _
        "WHERE ((([D:農地info].小作終了年月日)>=CDate('" & mvarStartDT & "') And ([D:農地info].小作終了年月日)<=CDate('" & mvarEndDT & "')) AND (([D:農地info].自小作別)>0) AND ((M_BASICALL.Class)='利用権種類')) " & _
        "ORDER BY [D:農地info].小作終了年月日, [D:個人Info].氏名, [D:個人Info_1].氏名, [D:農地info].小作開始年月日, [D:農地info].大字ID, [D:農地info].小字ID, Val([D:農地Info].[地番]), IIf(InStr([D:農地Info].[地番],'-')>0,Mid([D:農地Info].[地番],InStr([D:農地Info].[地番],'-')+1),0);", 0, , Me)
        
        If Not Rs.EOF Then
            mvarList = Split(Rs.GetString(vbTab, vbCrLf), vbCrLf)
            mvarParent.MaxPage = Fix(IIf(UBound(mvarList) Mod 20 = 0, UBound(mvarList) / 20, (UBound(mvarList) / 20) + 1))
        Else
            MsgBox "該当する貸借は存在しませんでした。", vbInformation
            CPrintCls_DataInit = True
            Exit Function
        End If
        
        SystemDB.CloseRs Rs
        mvarParent.Page = 1
    End Function

    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property

    Private Property Let CPrintCls_Key(ByVal RHS As String): End Property
    Private Property Get CPrintCls_Key() As String: End Property
    
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants: CPrintCls_Orientation = vbPRORLandscape: End Property

    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&): CPrintCls_Repaint: End Sub

    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Set CPrintCls_Parent(RHS As ADBasicLIB2.CPrintFormSK): Set mvarParent = RHS: End Property

    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        Dim n As Long
        
        For n = 1 To mvarParent.MaxPage
            PrintSub n
            mvarParent.NewPage
        Next
        mvarParent.EndDoc
    End Sub

    Private Sub CPrintCls_Repaint()
        If mvarParent.Page > 0 Then PrintSub mvarParent.Page
    End Sub

    Private Sub PrintSub(nPage As Long)
        Dim y As Single
        Dim n As Long
        Dim Ar As Variant
        Dim dX As String
        
        With mvarParent
            .ClearScreen
            y = 0
            .TextOut "利用権終期農地一覧表", 120, y, 16, 0
            y = y + 12
            .TextOut "終期の範囲：" & mvarStartDT & "〜" & mvarEndDT, 1, y, 11, 0
            y = y + 8
            .DLine 1, y, .PaperWidth - 2, y
            y = y + 1
            .TextOut "利用権の設定をしたもの", 12, y, 11, 0
            .TextOut "利用権の設定を受けたもの", 92, y, 11, 0
            .TextOut "土地の所在", 182, y, 11, 0
            .TextOut "契約の内容", 237, y, 11, 0
            
            y = y + 4
            .DLine 1, y, .PaperWidth - 2, y
            y = y + 3
            .TextOut s名称変更, 12, y, 11, 0
            .TextOut "住所", 32, y - 2, 11, 0
            .TextOut "氏名", 32, y + 2, 11, 0
            .TextOut s名称変更, 92, y, 11, 0
            .TextOut "住所", 112, y - 2, 11, 0
            .TextOut "氏名", 112, y + 2, 11, 0
            .TextOut "大字･小字", 182, y - 2, 11, 0
            .TextOut "地番", 182, y + 2, 11, 0
            .TextOut "地目", 203, y, 11, 0
            .TextOut "面積 u", 215, y, 11, 0
            .TextOut "種類", 237, y, 11, 0
            .TextOut "小作料", 250, y, 11, 0
            .TextOut "開始日", 267, y - 2, 11, 0
            .TextOut "終了日", 267, y + 2, 11, 0
                        
            y = y + 5.5
            .DLine 1, y, .PaperWidth - 2, y
            dX = ""
            For n = 0 To 19
                If n + (nPage - 1) * 20 >= UBound(mvarList) Then Exit For
                y = y + 2.5
                Ar = Split(mvarList(n + (nPage - 1) * 20), vbTab)
                If dX = "" Or dX <> Left$(Ar(15), 6) Then
                    dX = Left$(Ar(15), 6)
                    .DrawText dX, 1, y - 2, 8, 4, 10, 0
                Else
                End If
                
                .TextOut Ar(0), 12, y, 10
                .TextOut StrConv(Ar(1), vbNarrow), 32, y - 2, 10
                .TextOut StrConv(Ar(2), vbNarrow), 32, y + 2, 10
                .TextOut Ar(4), 92, y, 10
                .TextOut Ar(5), 112, y - 2, 10
                .TextOut Ar(6), 112, y + 2, 10
                
                .TextOut Replace(Ar(7) & "字" & Ar(8), "字.", ""), 182, y - 2, 10
                .TextOut Ar(9), 182, y + 2, 10
                .TextOut Ar(10), 203, y, 10
                .TextOut FormatNumber(Val(Ar(11)), 0) & " u", 215, y, 10
                .TextOut Left$(Ar(12), 1), 237, y, 10
                If Ar(13) = "物納" Then
                    .TextOut Ar(13), 250, y, 10
                Else
                    .TextOut Right$("      " & FormatNumber(Val(Ar(13)), 0), 6), 250, y, 10
                End If
                .TextOut Ar(14), 267, y - 2, 10
                .TextOut Ar(15), 267, y + 2, 10
                y = y + 5.5
                .DLine 1, y, .PaperWidth - 2, y
            Next
        End With
    End Sub

    Private Sub CPrintCls_TargetChange(sKey As String)

    End Sub

End Class










Class CPrn議案書鏡
    Option Explicit
    Implements ADBasicLIB2.CPrintCls
    Private mvarParent As ADBasicLIB2.CPrintFormSK
    Private mvarKey As String
    Private mvarData As String
    Private s法令Key As String
    Dim s県名 As String
    Dim s郡部 As String
    Dim s市町村 As String
    Dim s議案番号(1) As String
    Dim Ay As Variant
    Dim b決定 As Boolean
    Dim dt総会日 As Date

    Private Property Get CPrintCls_CanCancelPrint() As Boolean
    End Property

    Private Property Get CPrintCls_CanPrintNowPage() As Boolean
    End Property

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim Ar As Variant, Cm As Variant
        
        s法令Key = Fnc.GetKeyHead(sParam)
        
        Ar = SysAD.MDIForm.InputDate("総会日", "総会日を入力してください", Now)
        If IsNull(Ar) Then
            CPrintCls_DataInit = True
            Exit Function
        ElseIf IsDate(Ar) Then
            dt総会日 = Ar
        Else
            dt総会日 = Now
        End If
        With SystemDB
            s県名 = .DBProperty("都道府県名")
            s郡部 = .DBProperty("郡部")
            s市町村 = .DBProperty("市町村名")
        End With
        
        If MsgBox("議案用は はい を　決定後なら　いいえ　を選択", vbYesNo) = vbYes Then
            b決定 = True
            s議案番号(0) = InputBox("議案番号を入力してください")
        Else
            b決定 = False
        End If
        s議案番号(1) = InputBox("利用集積計画番号を入力してください。")
        
        mvarData = ""
        mvarParent.表示倍率 = 0.75
        
    End Function

    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property
    
    Private Property Let CPrintCls_Key(ByVal RHS As String): mvarKey = RHS: End Property
    Private Property Get CPrintCls_Key() As String: CPrintCls_Key = mvarKey: End Property

    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants: CPrintCls_Orientation = vbPRORLandscape: End Property

    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&)
        CPrintCls_Repaint
    End Sub

    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Set CPrintCls_Parent(RHS As ADBasicLIB2.CPrintFormSK): Set mvarParent = RHS: End Property

    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        PrintSub_利用権
        mvarParent.EndDoc
    End Sub

    Private Sub CPrintCls_Repaint()
        PrintSub_利用権
    End Sub

    Private Sub CPrintCls_TargetChange(sKey As String)
    
    End Sub

    Private Sub PrintSub_利用権()
        Dim x As Long, m As Long
        
        With mvarParent
            .ClearScreen
            .Offset 0, 0
            
            If b決定 Then .TextOut "(議案第" & s議案番号(0) & "号)", 20, 20, 12, 0, 0
            .TextOut "農業経営基盤強化促進法（昭和５５年法律第６５号）第１８条第１項の規定により，", 25, 100, 18
            .TextOut StrConv(Format(Now(), "GGGE年度第") & s議案番号(1) & "号", vbWide), 25, 70, 12, 0, 0
        
            .DBox 20, 50, 270, 180, vbBlack, 4
            .TextOut "農業経営基盤強化促進法（昭和５５年法律第６５号）第１８条第１項の規定により，", 25, 100, 18
            For m = 0 To 13
                x = m * 18
                .TextOut MID("農用地利用集積計画を定める。", m + 1, 1), 25 + x, 110, 18
            Next
        
            .TextOut StrConv(Format(dt総会日, "GGG E 年 M 月 D 日"), vbWide), .PaperWidth / 2, 140, 12, 2
            .TextOut s県名 & s郡部 & s市町村, .PaperWidth / 2, 176, 20, 2, 1
        End With
    End Sub

End Class










Class CPrn小作地実態調査
    Option Explicit
    Implements CPrintCls
    Private mvarParent As CPrintFormSK
    Private mvarDic As ADBasicLIB2.CDataDictionary
    Private mvarKey As String
    Private s市町村 As String
    Private SX As Single
    Private SX2 As Single
    Private dX(5) As Single, hX(5) As Single
    Private dX2(8) As Single, hX2(8) As Single
    Private Const nPit As Single = 6
    Private Const HH As Single = 6
    Private Const Rows As Long = 40
    Private Const nPit2 As Single = 12
    Private Const HH2 As Single = 21
    Private Const Rows2 As Long = 15
    Private Ay As Variant
    Private Ay2 As Variant
    Private St As Variant
    Private St2 As Variant
    Private XX As Single, YY As Single
    Private bPrinting As Boolean
    Private s名称変更 As String
    Private sData As Variant
    Private Ar As Variant, Cm As Variant
    Private Ar2 As Variant, Cm2 As Variant
    Private bKSK As Boolean
    Private bTT As Boolean
    
    Private Property Get CPrintCls_CanCancelPrint() As Boolean

    End Property

    Private Property Get CPrintCls_CanPrintNowPage() As Boolean

    End Property
    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property

    Private Property Let CPrintCls_Key(ByVal RHS As String)

    End Property

    Private Property Get CPrintCls_Key() As String

    End Property
    Private Sub Class_Initialize(): Set mvarDic = New ADBasicLIB2.CDataDictionary: End Sub
    
    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim sSQL As String
        Dim pNode As Object
        Dim mDic As New ADBasicLIB2.CDataDictionary
        Dim pTag As Object
        Dim i As Long
        Dim n As Long
        Dim Sc As Variant
        Dim SD As Variant
        Dim SG As String

        bKSK = True
        s市町村 = SystemDB.DBProperty("市町村名")
        St = "自治会集落名行政区公民館公民会"
        s名称変更 = MID$(St, Val(SystemDB.DBPropertyEx("選挙申請名簿用", vbInteger, "0")) * 3 + 1, 3)
         bTT = True
        
        With mvarParent
            .UsedTreeView = True
            .Nodes.Add , , "実態調査.0", "実態調査", "CloseFolder", "CloseFolder"
        
            Set Rs = SystemDB.GetRecordsetEx("SELECT '行政区.' & [ID] AS [Key], 名称 FROM M_BASICALL WHERE Class='行政区' ORDER BY RIGHT('000000' & [ID],6)", , , Me)
            Do Until Rs.EOF
                Set pTag = .Nodes.Add("実態調査.0", 4, CStr(Rs.Key), Rs.Value("名称"), "CloseFolderG", "CloseFolderG")
                pTag.Tag = Rs.V("名称")
                Rs.MoveNext
            Loop
            Rs.CloseRs
            
            sSQL = "SELECT [D:個人Info].郵便番号, [D:個人Info].行政区ID, V_行政区.名称 AS 行政区, [D:世帯Info].ID AS [X世帯ID], [D:個人Info].フリガナ,[D:個人Info].住所 AS [世帯住所], [D:個人Info].氏名 AS [耕作者氏名], [D:個人Info_1].氏名 AS 所有者名, [D:個人Info].氏名 AS 耕作者名, V_農地.土地所在, V_地目.名称 AS 地目, V_農委地目.名称 AS 農委地目, CInt([V_農地].[畑面積]+[V_農地].[田面積]) AS 面積,[小作開始年月日],[小作終了年月日] " & _
                   "FROM (V_行政区 INNER JOIN ((V_地目 INNER JOIN ((V_農地 INNER JOIN [D:世帯Info] ON V_農地.耕作世帯ID = [D:世帯Info].ID) INNER JOIN [D:個人Info] AS [D:個人Info_1] ON V_農地.所有者ID = [D:個人Info_1].ID) ON V_地目.ID = V_農地.登記簿地目) INNER JOIN [D:個人Info] ON [D:世帯Info].世帯主ID = [D:個人Info].ID) ON V_行政区.ID = [D:個人Info].行政区ID) LEFT JOIN V_農委地目 ON V_農地.農委地目ID = V_農委地目.ID " & _
                   "WHERE ((([D:個人Info].行政区ID)>0) AND ((CInt([V_農地].[畑面積]+[V_農地].[田面積]))>0) AND ((V_農地.農地状況)<20)) " & _
                   "ORDER BY [D:個人Info].行政区ID, [D:個人Info].フリガナ, V_農地.大字ID;"
                
            Set Rs = SystemDB.GetRecordsetEx(sSQL, 0, , "耕作地実態調査")
            SG = ""
            n = 0
            Do Until Rs.EOF
                If SG = "" Then
                    SG = Rs.Value("行政区ID")
                ElseIf SG <> Rs.Value("行政区ID") Then
                    n = 0
                    SG = Rs.Value("行政区ID")
                End If
                If Not mDic.Exists(CStr("耕作者." & Rs.Value("X世帯ID"))) Then
                    n = n + 1
                    mDic.Add CStr("耕作者." & Rs.Value("X世帯ID")), Rs.Value("耕作者氏名")
                    Set pTag = mvarParent.TreeNodeAdd(CStr("耕作者." & Rs.Value("X世帯ID")), CStr(Rs.Value("耕作者氏名")), "Farmer", CStr("行政区." & Rs.Value("行政区ID")))
                    pTag.Tag = Rs.Value("郵便番号") & ";;" & Rs.Value("世帯住所") & ";" & Rs.Value("行政区") & ";" & Rs.Value("フリガナ") & ";" & Rs.Value("耕作者氏名") & ";" & Rs.Value("フリガナ") & ";" & Rs.Value("耕作者氏名") & ";;" & n & vbBack & _
                    Rs.Value("土地所在") & ";" & Rs.Value("地目") & ";" & Rs.Value("農委地目") & ";" & Rs.Value("面積") & ";" & Rs.Value("所有者名") & ";" & Rs.Value("小作開始年月日") & ";" & Rs.Value("小作終了年月日") & ";" & vbBack
                    mvarParent.Nodes(CStr("行政区." & Rs.Value("行政区ID"))).Tag = mvarParent.Nodes(CStr("行政区." & Rs.Value("行政区ID"))).Tag & vbCrLf & n & ";" & Rs.Value("耕作者氏名") & ";" & Rs.Value("耕作者氏名")
                Else
                   pTag.Tag = pTag.Tag & Rs.Value("土地所在") & ";" & Rs.Value("地目") & ";" & Rs.Value("農委地目") & ";" & Rs.Value("面積") & ";" & Rs.Value("所有者名") & ";" & Rs.Value("小作開始年月日") & ";" & Rs.Value("小作終了年月日") & ";" & vbBack
                End If
                Rs.MoveNext
            Loop
            SystemDB.CloseRs Rs

            Ay = GetArray(16, 45, 45, 20, 54)
            St = Split(",世帯主名,調査対象者名,調査日,備　　　　　考", ",")
            
            SX = 15
            dX(0) = SX
            hX(0) = dX(0) + Ay(0) / 2
            For i = 0 To UBound(Ay)
                dX(i + 1) = dX(i) + Ay(i)
                If i < UBound(Ay) Then hX(i + 1) = dX(i + 1) + Ay(i + 1) / 2
            Next
            
            Ay2 = GetArray(46, 6, 6, 20, 36, 34, 0, 32)
            St2 = Split("所　　　　　在,登\n \n記\n \n簿,現\n\n\n\n況,面積\n(u),借 受 地 の\n\n所 有 者 名,耕作地の状況,,備    考,契約期間", ",")
            
            SX2 = 15
            dX2(0) = SX2
            hX2(0) = dX2(0) + Ay2(0) / 2
            For i = 0 To UBound(Ay2)
                dX2(i + 1) = dX2(i) + Ay2(i)
                If i < UBound(Ay2) Then hX2(i + 1) = dX2(i + 1) + Ay2(i + 1) / 2
            Next
            
            SD = ""
            For Each pTag In mvarParent.Nodes
                If Fnc.GetKeyHead(pTag.Key) = "行政区" Then
                    Sc = Split(pTag.Tag, ";")
                    If UBound(Sc) < 1 Then
                        SD = SD & ";" & pTag.Key
                    End If
                End If
            Next
            Sc = Split(SD, ";")
            For i = 0 To UBound(Sc)
                mvarParent.TreeNodeRemove CStr(Sc(i))
            Next
            .MaxPage = 1
            .Page = 1
        End With
    End Function
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants: CPrintCls_Orientation = vbPRORPortrait: End Property
    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&): CPrintCls_Repaint: End Sub
    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Set CPrintCls_Parent(RHS As ADBasicLIB2.CPrintFormSK): Set mvarParent = RHS: End Property

    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        Dim pNode As Object
        Dim nData As Long
        Dim x As Long
        Dim n As Long
        Dim B As Boolean
        
        B = False
        For Each pNode In mvarParent.Nodes
            If pNode.Checked And Right$(pNode.Text, 6) <> "0,0,0>" Then
                Select Case Fnc.GetKeyHead(pNode.Key)
                    Case "行政区"
                        mvarParent.PrintPage = 1
                        If bTT Then
                            sData = Split(pNode.Tag, vbCrLf)
                            x = Fix(UBound(sData) / Rows) - ((UBound(sData) Mod Rows) > 0)
                            For n = 1 To x
                                If Print行政区(pNode.Key, n) Then mvarParent.NewPage
                            Next
                        End If
                    Case "耕作者"
                        mvarParent.PrintPage = 1
                        sData = Split(pNode.Tag, vbBack)
                        x = Fix(UBound(sData) / Rows2) - ((UBound(sData) Mod Rows2) > 0)
                        
                        For n = 1 To x
                            If Print耕作者(pNode.Key, n) Then mvarParent.NewPage
                        Next
                End Select
                
                pNode.Checked = False
                B = True
                mvarParent.NewPage
            End If
        Next
        If B Then mvarParent.EndDoc
    End Sub

    Private Sub CPrintCls_Repaint()
        Select Case Fnc.GetKeyHead(mvarKey)
            Case "行政区": Print行政区 mvarKey, mvarParent.Page
            Case "耕作者": Print耕作者 mvarKey, mvarParent.Page
        End Select
    End Sub

    Private Function Print行政区(ByVal sKey As String, Optional nPage As Long = 0) As Boolean
        Dim SY As Single
        Dim y As Long
        Dim n As Long
        Dim i As Long
        Dim Ar As Variant

        With mvarParent
            Print行政区 = False
            .Offset 0, 0
            .ClearScreen
    '-----------------------------------
            If Fnc.GetKeyHead(sKey) <> "行政区" Then Exit Function
    '-----------------------------------
            .TextOut "耕作地の実態調査票一覧表", .PaperWidth / 2, 16, 14, 2, 2
            
            .TextOut s名称変更 & "名 " & sData(0), dX(3), 24, 11, 0, 1
            .LineBoxDX dX(0), 24, HH, Rows, nPit, Ay
            

            If bTT Then
                For n = 0 To UBound(St)
                    .DrawText St(n), dX(n), 24, Ay(n), 4, 11, 2, 2, HH
                Next
                
                For n = 0 To Rows - 1
                    If (nPage - 1) * 40 + n + 1 > UBound(sData) Then Exit For
                    If Len(sData((nPage - 1) * Rows + n + 1)) > 0 Then
                        Ar = Split(sData((nPage - 1) * Rows + n + 1), ";")
                        Print行政区 = True
                        y = n * nPit
                        .DrawText Ar(0), dX(0) - 1, 24 + HH + y, Ay(0) - 2, 4, 11, 1, 2, nPit
                        .DrawText Ar(1), dX(1) + 1, 24 + HH + y, Ay(1) - 2, 4, 11, 0, 2, nPit
                        .DrawText Ar(2), dX(2) + 1, 24 + HH + y, Ay(2) - 2, 4, 11, 0, 2, nPit
                        .DrawText "／", dX(3) + 1, 24 + HH + y, Ay(3) - 2, 4, 11, 2, 2, nPit
        '                .DrawText "備考", dX(4) + 1, 24 + HH + Y, Ay(4)-2, 4, 11, 0, 2, nPit
                    End If
                Next
            End If
        End With
    End Function
    Private Function Print耕作者(ByVal sKey As String, Optional nPage As Long = 0) As Boolean
        Dim SY As Single
        Dim y As Long
        Dim n As Long
        
        Print耕作者 = False
        With mvarParent
            .Offset 0, 0
            .ClearScreen
    '-----------------------------------
            If Fnc.GetKeyHead(sKey) <> "耕作者" Then Exit Function
    '-----------------------------------
            .TextOut "耕作地の実態調査票", .PaperWidth / 2, 25, 14, 2, 2
            .DBox dX2(0), 32, dX2(8), 44, 0, 1
            .DLine dX2(0) + 12, 32, dX2(0) + 12, 44, 0, 0
            .DLine dX2(0) + 120, 32, dX2(0) + 120, 44, 0, 0
            .DLine dX2(0) + 138, 32, dX2(0) + 138, 44, 0, 0
            
            .DrawText "住所", dX2(0), 32, 12, 4, 11, 2, 2, 12
            .DrawText "自治会名", dX2(0) + 120, 32, 18, 4, 11, 2, 2, 12
            
            .DBox dX2(0), 50, dX2(8), 62, 0, 1
            .DLine dX2(0) + 30, 50, dX2(0) + 30, 62, 0, 0
            .DLine dX2(0) + 110, 50, dX2(0) + 110, 62, 0, 0
            '.DBox dX2(0) + 90, 50, dX2(0) + 110, 62, 0, 4
            .DLine dX2(0) + 130, 50, dX2(0) + 130, 62, 0, 0
        
            .DrawText "氏　　　名", dX2(0), 50, 30, 4, 11, 2, 2, 12
            .DrawText "調　査\n年月日", dX2(0) + 110, 50, 20, 4, 11, 2, 2, 12
            
'            .DBox dX2(8) - 90, 68, dX2(8), 80, 0, 0
'            .DBox dX2(8) - 74, 68, dX2(8) - 50, 80, 0, 4
'            .DLine dX2(8) - 34, 68, dX2(8) - 34, 80, 0, 0
            
            .DrawText "印", dX2(5) - 24, 50, 24, 4, 11, 2, 2, 12
            .TextOut "耕作地内容", dX2(0), 83, 11, 0, 2
            .LineBoxDX dX2(0), 86, HH2, Rows2, nPit2, Ay2
            .DLine dX2(5), 86 + HH2 / 2, dX2(6), 86 + HH2 / 2, 0, 0
            .LineX dX2(5), dX2(6), 86 + HH2 + nPit2 / 2, Rows2, nPit2, 0
            
            For n = 0 To UBound(St2)
                If n <> 5 And n <> 8 Then
                    .DrawText St2(n), dX2(n), 86, Ay2(n), 4, 11, 2, 2, HH2
                Else
                    If n = 5 Then
                        .DrawText St2(5), dX2(5), 86, Ay2(5), 4, 11, 2, 2, HH2 / 2
                    Else
                        .DrawText St2(8), dX2(5), 86 + HH2 / 2, Ay2(5), 4, 11, 2, 2, HH2 / 2
                    End If
                End If
            Next
    '-----------------------------------
            Ar2 = Split(sData(0), ";")
    '-----------------------------------
            .TextOut "〒 " & Ar2(0), dX2(0) + 14, 33, 11, 0, 0
            .TextOut " " & Ar2(1), dX2(0) + 66, 33, 11, 0, 0
            .TextOut " " & Ar2(2), dX2(0) + 14, 39, 11, 0, 0
            '.TextOut s名称変更 & "名 " & Ar2(3), dX2(0) + 80, 45, 11, 0, 0
            
            .TextOut " " & Ar2(3), 153, 36, 11, 0, 0
            '.TextOut Ar2(5), 153, 39, 11, 0, 0
            .TextOut " " & Ar2(9), 180, 27, 11, 1, 0
            
            .TextOut " " & Ar2(6), 45, 51, 11, 0, 0
            .TextOut " " & Ar2(7), 45, 57, 11, 0, 0
            
            '.TextOut Ar2(8), 115, 56, 11, 2, 2
            
            .DrawText "平成　　年　　月　　日", dX2(8) - 50, 50, 50, 4, 11, 2, 2, 12
            
            SY = 107
    '            For n = (nPage - 1) * Rows2 + 1 To UBound(sData) - 1
            For n = 1 To Rows2
                y = (n - 1) * nPit2
    '                If n >= nPage * Rows2 Then Exit For
    '                Cm = Split(sData(n + (Rows * (nPage - 1)) + 1), ";")
                If n + (nPage - 1) * Rows2 >= UBound(sData) Then Exit For
                Cm = Split(sData(n + (nPage - 1) * Rows2), ";")
                .DrawText Cm(0), dX2(0), SY + y, Ay2(0), 4, 11, 0, 2, nPit2
                .DrawText Cm(1), dX2(1), SY + y, Ay2(1), 4, 11, 2, 2, nPit2
                .DrawText Cm(2), dX2(2), SY + y, Ay2(2), 4, 11, 2, 2, nPit2
                .DrawText FormatNumber(Cm(3), 0, False, False, vbFalse), dX2(3) - 1, SY + y, Ay2(3), 4, 11, 1, 2, nPit2
                .DrawText Cm(4), dX2(4) + 1, SY + y, Ay2(4), 4, 11, 0, 2, nPit2
                Print耕作者 = True
                '.DrawText "有 無", dX2(6), SY + Y, Ay2(6), 4, 11, 2, 2, nPit2
                If bKSK Then
                    If Not IsDate(Cm(5)) Then
                    ElseIf Year(CDate(Cm(5))) > 1950 Then
                        .DrawText Format(Cm(5), "GGGEE年MM月DD日"), dX2(5), SY + y, Ay2(5), 4, 11, 1, 2, nPit2 / 2
                    End If
                    If Not IsDate(Cm(6)) Then
                    ElseIf Year(CDate(Cm(6))) > 1950 Then
                        .DrawText Format(Cm(6), "GGGEE年MM月DD日"), dX2(5), SY + y + nPit2 / 2, Ay2(5), 4, 11, 1, 2, nPit2 / 2
                    End If
    '                    If Len(Cm(7)) Then
    '                        .DCircle dX2(6) + 4, SY + Y + 6, 2.8, vbBlack
    '                    Else
    '                        .DCircle dX2(6) + 10, SY + Y + 6, 2.8, vbBlack
    '                    End If
                End If
            Next
        End With
    End Function

    Private Sub CPrintCls_TargetChange(sKey As String)
        
        mvarKey = sKey
        Select Case Fnc.GetKeyHead(mvarKey)
            Case "耕作者"
                sData = Split(mvarParent.Nodes(sKey).Tag, vbBack)
                mvarParent.MaxPage = Fix(UBound(sData) / Rows2) - ((UBound(sData) Mod Rows2) > 0)
            Case "行政区"
                sData = Split(mvarParent.Nodes(sKey).Tag, vbCrLf)
                mvarParent.MaxPage = Fix(UBound(sData) / Rows) - ((UBound(sData) Mod Rows) > 0)
        End Select

        CPrintCls_Repaint
    End Sub



End Class










Class C検索
    Option Explicit
    Implements ADBasicLIB2.CExplorerCommandSK
    Private DVProperty As CDataviewProperty
    Dim bInit As Boolean
    
    Private mvarOptCBKey As Variant
    Private mvarOptCtrl As Variant
    
    Private mvarParent As ADBasicLIB2.CExplorerBarSK
    Private WithEvents mvarBody As VB.PictureBox
    Private WithEvents CtrlMan As ADBasicLIB2.CControlMan
    
    Private WithEvents mvarCombo1 As VB.ComboBox
    Private WithEvents mvarCombo2 As VB.ComboBox
    
    Private WithEvents mvarTZyusyo As VB.TextBox
    
    Private WithEvents mvarCmdGo As VB.CommandButton
    Private WithEvents mvarCmdCancel As VB.CommandButton
    Private Const mvarEXCtrlCount = 5
    
    Public Property Get Key() As String: Key = DVProperty.Key: End Property
    Public Property Let Key(RHS As String): DVProperty.Key = RHS: DVProperty.SetDVP RHS: End Property

    Private Property Set CExplorerCommandSK_Body(ByVal RHS As Object)
        Set mvarBody = RHS
        mvarBody.Visible = True
        Select Case Fnc.GetKeyHead(DVProperty.Key)
            Case "農家検索": 農家検索Init
            Case "農地検索": 農地検索Init
        End Select
        
        Set mvarCmdGo = mvarPDW.AddCtrlWithCode(DVProperty.UniqueCode & "BtnGo", "VB.CommandButton", mvarBody, "FontSize=10")
        With mvarCmdGo
            .Caption = "検索開始"
            .Visible = True
        End With
        Set mvarCmdCancel = mvarPDW.AddCtrlWithCode(DVProperty.UniqueCode & "BtnCancel", "VB.CommandButton", mvarBody, "FontSize=10;V=-1")
        With mvarCmdCancel
            .Caption = "キャンセル"
        End With
        bInit = True
    End Property
    
    Private Property Get CExplorerCommandSK_Body() As Object: Set CExplorerCommandSK_Body = mvarBody: End Property
    Private Property Get CExplorerCommandSK_BodyClass() As String: CExplorerCommandSK_BodyClass = "VB.PictureBox": End Property
    Private Property Get CExplorerCommandSK_Caption() As String: CExplorerCommandSK_Caption = DVProperty.ClassStr: End Property

    Private Function CExplorerCommandSK_DoCommand(ByVal sCmd As String, Optional ByVal sParam As String = "") As String
        On Error Resume Next
        Select Case sCmd
            Case "SetFocus": mvarBody.SetFocus
        End Select
    End Function

    Private Property Let CExplorerCommandSK_Key(ByVal RHS As String): DVProperty.Key = RHS: End Property
    Private Property Get CExplorerCommandSK_Key() As String: CExplorerCommandSK_Key = DVProperty.Key: End Property
    
    Private Property Let CExplorerCommandSK_MinHeight(ByVal RHS As Single): End Property
    Private Property Get CExplorerCommandSK_MinHeight() As Single: End Property
    Private Property Get CExplorerCommandSK_ObjName() As String: CExplorerCommandSK_ObjName = DVProperty.ClassStr: End Property
    Private Property Set CExplorerCommandSK_Parent(ByVal RHS As ADBasicLIB2.CExplorerBarSK): Set mvarParent = RHS: End Property
    Private Property Get CExplorerCommandSK_Parent() As ADBasicLIB2.CExplorerBarSK: Set CExplorerCommandSK_Parent = mvarParent: End Property

    Private Property Let CExplorerCommandSK_UniqueCode(ByVal RHS As String)
        Dim n As Long
        Dim St As String
        Dim S2 As String
        
        DVProperty.UniqueCode = RHS
        
        St = ""
        For n = 1 To 5
            St = St & ";" & "OptCombo" & Right$("00" & n, 2)
            S2 = S2 & ";"
        Next
        mvarOptCBKey = Split(MID$(St, 2), ";")
        mvarOptCtrl = Split(MID$(S2, 2), ";")
    End Property
    
    Private Property Get CExplorerCommandSK_UniqueCode() As String: CExplorerCommandSK_UniqueCode = DVProperty.UniqueCode: End Property

    Private Sub Class_Initialize(): Set CtrlMan = mvarPDW.ControlMan: Set DVProperty = mvarPDW.DataviewCol.GetNewDVP: End Sub
    Private Sub Class_Terminate(): Set CtrlMan = Nothing: End Sub

    Private Sub CtrlMan_CtrlEvent(ByVal sKey As String, ByVal sEventName As String, ByVal vParam As Variant)
        Dim pKey As String
        If Not DVProperty.UniqueCode = Left$(sKey, Len(DVProperty.UniqueCode)) Then Exit Sub
        pKey = MID$(sKey, Len(DVProperty.UniqueCode) + 1)
        Select Case Left(pKey, InStr(pKey, "_") - 1)
            Case "VBTextBox"
            Case "VBComboBox"
    '            Case "OptionCombo":
    '                If Len(mvarOptCtrl(Val(MID$(pKey, InStr(pKey, "_") + 1)) - 1)) > 0 Then
    '                    mvarPDW.ControlMan.Ctrl(mvarOptCtrl(Val(MID$(pKey, InStr(pKey, "_") + 1)) - 1)).Visible = False
    '                    mvarOptCtrl(Val(MID$(pKey, InStr(pKey, "_") + 1)) - 1) = ""
    '                End If
    '                mvarBody_Resize
            Case "VBCommandButton":
                Select Case MID$(pKey, InStr(pKey, "_") + 1)
                    Case "転用地検索": sub転用農地検索
                    Case "住基台帳検索": sub外部テーブル参照
                    Case "世帯検索": 検索Btn
                    Case "土地台帳検索":
                        Dim St As String
                        Dim sWhere As String
                        St = Replace(mvarPDW.ControlMan.CtrlText(DVProperty, "地番"), "*", "%")
                        If Len(St) = 0 Then Exit Sub
                        sWhere = ""
                        If Len(St) Then
                            view土地台帳List " WHERE" & sWhere & " [M_固定情報].[地番] LIKE '" & StrConv(St, vbNarrow) & "'", "土地台帳一覧：" & sWhere & " [M_固定情報].[地番] LIKE '" & StrConv(St, vbNarrow) & "'", True
                        Else
                            Exit Sub
                        End If
                    Case "所有地検索"
                        With mvarPDW.ControlMan
                            If .CtrlVisible(DVProperty, "フリガナ") Then
                                St = DVProperty.CtrlEx("フリガナ").TextReplace("*", "%")
                                sWhere = " WHERE [所有].[フリガナ] LIKE '" & StrConv(StrConv(St, vbKatakana), vbNarrow) & "%'"
                            ElseIf .CtrlVisible(DVProperty, "漢字") Then
                                St = DVProperty.CtrlEx("漢字").TextReplace("*", "%")
                                sWhere = " WHERE [所有].[氏名] LIKE '" & StrConv(StrConv(St, vbKatakana), vbNarrow) & "%'"
                            Else
                                MsgBox "所有地検索では検索条件は氏名・フリガナのみ利用できます", vbCritical
                                Exit Sub
                            End If
                            If Len(St) Then
                                view農地List sWhere, "所有地検索"
                            End If
                        End With
                    Case "借受地検索"
                        With mvarPDW.ControlMan
                            If .CtrlVisible(DVProperty, "フリガナ") Then
                                St = DVProperty.CtrlEx("フリガナ").TextReplace("*", "%")
                                sWhere = " WHERE [自小作別]<>0 AND [T_借受者].[フリガナ] LIKE '" & StrConv(StrConv(St, vbKatakana), vbNarrow) & "%'"
                            ElseIf .CtrlVisible(DVProperty, "漢字") Then
                                St = DVProperty.CtrlEx("漢字").TextReplace("*", "%")
                                sWhere = " WHERE [自小作別]<>0 AND [T_借受者].[氏名] LIKE '" & StrConv(StrConv(St, vbKatakana), vbNarrow) & "%'"
                            Else
                                MsgBox "借受地検索では検索条件は氏名・フリガナのみ利用できます", vbCritical
                                Exit Sub
                            End If
                            If Len(St) Then
                                view農地List sWhere, "借受地検索"
                            End If
                        End With
                    Case Else
                        Stop
                End Select
    '            Case "KanaCombo"
    '                Select Case sEventName
    '                    Case "KeyDown": If vParam(0) = vbKeyReturn Then mvarCmdGo_Click
    '                End Select
            Case "VBLabel"
                Select Case MID$(pKey, InStr(pKey, "_") + 1)
                    Case "ラベルカナ": ラベル設定 "<<", "", ""
                    Case "ラベル漢字": ラベル設定 "", "<<", ""
                    Case "ラベル住所": ラベル設定 "", "", "<<"
                End Select
            Case Else
                Debug.Assert CaseAssertPrint(Left(pKey, InStr(pKey, "_") - 1))
        End Select
    End Sub

    Private Sub ラベル設定(S1, S2, S3)
        With mvarPDW.ControlMan
            .CtrlCaption(DVProperty, "ラベルカナ") = S1 & "カナ検索" & IIf(S1 = "", ">>", "")
            .CtrlCaption(DVProperty, "ラベル漢字") = S2 & "漢字検索" & IIf(S2 = "", ">>", "")
            .CtrlCaption(DVProperty, "ラベル住所") = S3 & "住所検索" & IIf(S3 = "", ">>", "")
        End With
        mvarBody_Resize
    End Sub

    Private Sub mvarBody_DblClick(): mvarParent.FitWidth DVProperty.Key, 2000: End Sub

    Private Sub mvarBody_GotFocus()
        If mvarCmdGo.Default = False Then mvarPDW.ControlMan.ClearDefaultBtn: mvarCmdGo.Default = True
    End Sub

    Private Sub mvarBody_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)
        If mvarCmdGo.Default = False Then mvarPDW.ControlMan.ClearDefaultBtn: mvarCmdGo.Default = True
    End Sub


    Private Sub mvarBody_Resize()
        Dim T As Single
        Dim W As Single
        If Not bInit Then Exit Sub
        'On Error GoTo Ext
        
        T = 50
        W = mvarBody.ScaleWidth - 100
        Select Case DVProperty.ClassStr
            Case "農家検索"
                With DVProperty
                    T = .CtrlEx("ラベルカナ").Move(0, T, , , , , 50)
                    T = .CtrlEx("フリガナ").Move(100, T, W, , (InStr(.CtrlEx("ラベルカナ").Caption, "<<") > 0), , 80)
                
                    T = .CtrlEx("ラベル漢字").Move(0, T, , , , , 50)
                    T = .CtrlEx("漢字").Move(100, T, W, , (InStr(.CtrlEx("ラベル漢字").Caption, "<<") > 0), , 80)
                    
                    T = .CtrlEx("ラベル住所").Move(0, T, , , , , 50)
                    If InStr(DVProperty.CtrlEx("ラベル住所").Caption, "<<") Then
                        mvarTZyusyo.Move 100, T, W: T = T + 350
                        mvarTZyusyo.Visible = True
                    Else
                        mvarTZyusyo.Visible = False
                    End If
                    T = T + 100
                    T = .CtrlEx("ラベル備考").Move(0, T, , , , , 50)
                    T = .CtrlEx("備考").Move(100, T, W, , , , 100)
                End With
                ExtCTMove 0, T
            Case "農地検索"
                Dim n As Long
                With DVProperty
                    .CtrlEx("ラベル説明").Body.Width = mvarBody.ScaleWidth
                    T = .CtrlEx("ラベル説明").Move(0, T, mvarBody.ScaleWidth, , True, , 120)
                
                    T = .CtrlEx("ラベル大字").Move(0, T, , , , , 20)
                    mvarCombo1.Move 100, T, W: T = T + mvarCombo1.Height + 100
                    T = .CtrlEx("ラベル小字").Move(0, T, , , , , 20)
                    mvarCombo2.Move 100, T, W: T = T + mvarCombo2.Height + 100
                    T = .CtrlEx("ラベル地番").Move(0, T, , , , , 20)
                    T = .CtrlEx("地番").Move(100, T, W, , , , 20)
                End With
                ExtCTMove 0, T
        End Select
        mvarCmdGo.Move 0, T, mvarBody.ScaleWidth / 2, 330
        mvarCmdCancel.Move mvarBody.ScaleWidth / 2, T, mvarBody.ScaleWidth / 2, 330
        T = T + mvarCmdGo.Height
        
        Select Case DVProperty.ClassStr
            Case "農家検索"
                DVProperty.CtrlEx("世帯検索").Move 0, T, mvarBody.ScaleWidth / 2, 330
                DVProperty.CtrlEx("住基台帳検索").Move mvarBody.ScaleWidth / 2, T, mvarBody.ScaleWidth / 2, 330
                T = T + mvarCmdGo.Height
                DVProperty.CtrlEx("所有地検索").Move 0, T, mvarBody.ScaleWidth / 2, 330
                DVProperty.CtrlEx("借受地検索").Move mvarBody.ScaleWidth / 2, T, mvarBody.ScaleWidth / 2, 330
            Case "農地検索"
                DVProperty.CtrlEx("転用地検索").Move 0, T, mvarBody.ScaleWidth / 2, 330, True
                DVProperty.CtrlEx("土地台帳検索").Move mvarBody.ScaleWidth / 2, T, mvarBody.ScaleWidth / 2, 330, True
        End Select
    End Sub

    Private Sub ExtCTMove(ByVal n As Long, ByRef T As Single)
        Dim sCtrlKey As String
        Dim i As Long
        With mvarPDW.ControlMan
            .CtrlD(DVProperty, mvarOptCBKey(n)).Visible = True
            .CtrlD(DVProperty, mvarOptCBKey(n)).Move 0, T, mvarBody.ScaleWidth: T = T + .CtrlD(DVProperty, mvarOptCBKey(n)).Height + 100
            If .CtrlD(DVProperty, mvarOptCBKey(n)).ListIndex = 0 Then
                For i = n + 1 To UBound(mvarOptCBKey)
                    .CtrlD(DVProperty, mvarOptCBKey(i)).Visible = False
                    If Len(mvarOptCtrl(i)) Then .CtrlD(DVProperty, mvarOptCtrl(i)).Visible = False
                Next
                If UBound(mvarOptCBKey) > n Then .CtrlD(DVProperty, mvarOptCBKey(n + 1)).Visible = False
            Else
                
                If Len(mvarOptCtrl(n)) = 0 Then
                    CtrlSub n, .CtrlD(DVProperty, mvarOptCBKey(n)).List(.CtrlD(DVProperty, mvarOptCBKey(n)).ListIndex)
                Else
                    .CtrlD(DVProperty, mvarOptCtrl(n)).Visible = True
                End If
                On Error Resume Next
                .CtrlD(DVProperty, mvarOptCtrl(n)).Move 100, T, mvarBody.ScaleWidth - 100: T = T + .CtrlD(DVProperty, mvarOptCtrl(n)).Height + 100
                If UBound(mvarOptCBKey) > n Then ExtCTMove n + 1, T
            End If
        End With
    End Sub

    Private Sub CtrlSub(ID As Long, SX As String)
        Dim sClass As String
        Dim sParam As String
        Dim sSQL As String
        Dim sCtrlKey As String
        Dim Rs As ADBasicLIB2.RecordsetEx
        
        sCtrlKey = DVProperty.UniqueCode & "OptionCtrl_" & SX
        Select Case SX
            Case "登記地目": sClass = "VB.ComboBox": sParam = "IMEMode=0;FontSize=10": sSQL = "SELECT [ID],[名称] FROM [V_地目] ORDER BY [ID]"
            Case "現況地目": sClass = "VB.ComboBox": sParam = "IMEMode=0;FontSize=10": sSQL = "SELECT [ID],[名称] FROM [V_現況地目] ORDER BY [ID]"
            Case "農委地目": sClass = "VB.ComboBox": sParam = "IMEMode=0;FontSize=10": sSQL = "SELECT [ID],[名称] FROM [V_農委地目] ORDER BY [ID]"
            Case "自小作別": sClass = "VB.ComboBox": sParam = "IMEMode=0;FontSize=10": sSQL = "SELECT [ID],[名称] FROM [M_BASICALL] WHERE [CLASS]='自小作区分' ORDER BY [ID]"
            Case "貸付希望": sClass = "VB.ComboBox": sParam = "IMEMode=0;FontSize=10": sSQL = "SELECT [ID],[名称] FROM [M_BASICALL] WHERE [CLASS]='希望有無' ORDER BY [ID]"
            Case "売渡希望": sClass = "VB.ComboBox": sParam = "IMEMode=0;FontSize=10": sSQL = "SELECT [ID],[名称] FROM [M_BASICALL] WHERE [CLASS]='希望有無' ORDER BY [ID]"
            
            Case "利用権始期検索開始": sClass = "台帳管理EXE.NakaDT": sParam = "formatstring=XXX/XX/X;value=" & Date
            Case "利用権始期検索終了": sClass = "台帳管理EXE.NakaDT": sParam = "formatstring=XXX/XX/X;value=" & Date
            Case "登記面積": sClass = "VB.TextBox": sParam = "IMEMode=0"
            Case "年齢": sClass = "VB.TextBox": sParam = "Align=0:IMEMode=0"
            Case "生年月日": sClass = "VB.TextBox": sParam = "IMEMode=0"
            Case "従事日数": sClass = "VB.TextBox": sParam = "IMEMode=0"
            Case "適用法令": sClass = "VB.ComboBox": sParam = "IMEMode=0": sSQL = "SELECT [ID],[名称] FROM [M_BASICALL] WHERE [CLASS]='適用法令' ORDER BY [ID]"
            Case Else
                Debug.Assert CaseAssertPrint(SX)
                Exit Sub
        End Select
        
        mvarOptCtrl(ID) = sCtrlKey
        If mvarPDW.ControlMan.CtrlD(DVProperty, sCtrlKey) Is Nothing Then
            mvarPDW.ControlMan.AddCtrlDVP DVProperty, mvarOptCtrl(ID), sClass, mvarBody, sParam & ";Visible=-1"
        
            With mvarPDW.ControlMan.CtrlD(DVProperty, sCtrlKey)
                .Tag = SX
                Select Case sClass
                    Case "VB.ComboBox"
                        Set Rs = SystemDB.GetRecordsetEx(sSQL, 0, , Me)
                        Rs.SetComboBox mvarPDW.ControlMan.CtrlD(DVProperty, sCtrlKey)
                    Case Else
                        .Height = mvarPDW.ControlMan.CtrlD(DVProperty, mvarOptCBKey(ID)).Height
                End Select
            End With
        Else
            mvarPDW.ControlMan.CtrlD(DVProperty, sCtrlKey).Visible = True
        End If
    End Sub

    Private Sub mvarCChiban_KeyDown(KeyCode As Integer, Shift As Integer)
        If KeyCode = vbKeyReturn Then mvarCmdGo_Click
    End Sub

    Private Sub 検索Btn()
        Dim St As String
        Dim sSQL As String
        Dim n As Long
        Dim sWhere As String
        Dim s備考 As String
        
        With mvarPDW.ControlMan
            Select Case DVProperty.ClassStr
                Case "農家検索"
                    If Len(.CtrlText(DVProperty, "備考")) Then
                        s備考 = " AND [D:世帯Info].[備考] LIKE '%" & Trim(mvarPDW.ControlMan.CtrlText(DVProperty, "備考")) & "%'"
                    End If
                    If .CtrlVisible(DVProperty, "フリガナ") Then
                        St = DVProperty.CtrlEx("フリガナ").TextReplace("*", "%")
                        sWhere = " WHERE [D:個人Info].[フリガナ] LIKE '" & StrConv(StrConv(St, vbKatakana), vbNarrow) & "%'" & s備考
                    ElseIf .CtrlVisible(DVProperty, "漢字") Then
                        St = DVProperty.CtrlEx("漢字").TextReplace("*", "%")
                        sWhere = " WHERE [D:個人Info].[氏名] LIKE '" & StrConv(StrConv(St, vbKatakana), vbNarrow) & "%'" & s備考
                    ElseIf mvarTZyusyo.Visible Then
                        St = "%" & Replace(mvarTZyusyo.Text, "*", "%") & "%"
                        St = Replace(St, "%%", "%")
                        sWhere = " WHERE [D:個人Info].[住所] LIKE '" & St & "'" & s備考
                    End If
            
                    sSQL = "SELECT '農家.' & [D:世帯Info].[ID] & '_' & [D:個人Info].[ID] AS [Key], [D:個人Info].氏名 AS 本人氏名, [D:個人Info].フリガナ AS 本人フリガナ, [V_行政区].行政区, [D:世帯Info].農家番号, [D:個人Info_1].氏名 AS 世帯主名, [D:個人Info_1].住所 AS 世帯住所,[V_続柄].[名称] AS [本人続柄], 'House' AS Icon, 'House' AS SelectIcon " & _
                    "FROM ((([D:個人Info] INNER JOIN [D:世帯Info] ON [D:個人Info].世帯ID = [D:世帯Info].ID) INNER JOIN [D:個人Info] AS [D:個人Info_1] ON [D:世帯Info].世帯主ID = [D:個人Info_1].ID) LEFT JOIN [V_行政区] ON [D:個人Info_1].行政区ID = [V_行政区].ID) LEFT JOIN [V_続柄] ON [D:個人Info].続柄1 = [V_続柄].ID "
            
                    mvarPDW.SQLListview.SQLFindList sSQL & sWhere, "本人氏名;本人氏名;本人フリガナ;本人フリガナ;本人続柄;本人続柄;行政区;行政区;農家番号;農家番号;世帯主名;世帯主名;世帯住所;世帯住所", "農家検索:" & sWhere
                                    
                    SaveKanaMRL
                    'LoadKanaMRL
            End Select
        End With
    End Sub

    Private Sub mvarCmdCancel_Click()
        Dim St As String
        Dim n As Long
        
        Select Case DVProperty.ClassStr
            Case "農家検索"
            Case "農地検索"
                If Len(mvarPDW.ControlMan.CtrlText(DVProperty, "地番")) Then
                    St = mvarPDW.ControlMan.CtrlText(DVProperty, "地番")
                    For n = 0 To mvarPDW.ControlMan.CtrlD(DVProperty, "地番").ListCount - 1
                        If Not mvarPDW.ControlMan.CtrlD(DVProperty, "地番").Text = mvarPDW.ControlMan.CtrlD(DVProperty, "地番").List(n) Then
                            St = St & ";" & mvarPDW.ControlMan.CtrlD(DVProperty, "地番").List(n)
                        End If
                        If n > 30 Then Exit For
                    Next
                    If Len(St) Then SystemDB.SetDirectData "S_システムデータ", "DATA", St, , "検索地番"
                End If
        End Select
        mvarParent.Remove Key
    End Sub

    Private Sub sub転用農地検索()
        Dim St As String
        Dim sWhere As String
        
        St = Replace(mvarPDW.ControlMan.CtrlText(DVProperty, "地番"), "*", "%")
        If Len(St) = 0 Then Exit Sub
        sWhere = ""
        
        If Len(St) Then
            view転用農地List " WHERE" & sWhere & " [V_転用農地].[地番] LIKE '" & StrConv(St, vbNarrow) & "'", "転用農地一覧：" & sWhere & " [V_転用農地].[地番] LIKE '" & StrConv(St, vbNarrow) & "'", True
        Else
            Exit Sub
        End If
    End Sub

    Private Sub sub外部テーブル参照()
        Dim St As String
        Dim sWhere As String
        Dim sSQL As String
        Dim n As Long
        
        With mvarPDW.ControlMan
        Select Case DVProperty.ClassStr
            Case "農家検索"
                If .CtrlVisible(DVProperty, "フリガナ") Then
                    St = Replace(.CtrlText(DVProperty, "フリガナ"), "*", "%")
                    sWhere = " WHERE [M_住民情報].[フリガナ] LIKE '" & StrConv(StrConv(St, vbKatakana), vbNarrow) & "%'"
                    SaveKanaMRL
                ElseIf .CtrlVisible(DVProperty, "漢字") Then
                    St = Replace(.CtrlText(DVProperty, "漢字"), "*", "%")
                    sWhere = " WHERE [M_住民情報].[氏名] LIKE '" & StrConv(StrConv(St, vbKatakana), vbNarrow) & "%'"
                ElseIf mvarTZyusyo.Visible Then
                    St = "%" & Replace(mvarTZyusyo.Text, "*", "%") & "%"
                    St = Replace(St, "%%", "%")
                    sWhere = " WHERE [M_住民情報].[住所] LIKE '" & St & "'"
                End If
        
                sSQL = "SELECT '住基.' & [M_住民情報].[ID] AS [Key], [M_住民情報].氏名 AS 氏名, [M_住民情報].フリガナ,[M_住民情報].住所 AS 住所 " & _
                "FROM [M_住民情報] "
        
                mvarPDW.SQLListview.SQLFindList sSQL & sWhere, "氏名;氏名;フリガナ;フリガナ;住所;住所", "住基検索:" & sWhere
                                
                'LoadKanaMRL
            Case "農地検索"
                St = Replace(mvarPDW.ControlMan.CtrlText(DVProperty, "地番"), "*", "%")
                If Len(St) = 0 Then Exit Sub
                sWhere = ""
                If Len(St) Then
                    view土地台帳List " WHERE" & sWhere & " [M_固定情報].[地番] LIKE '" & StrConv(St, vbNarrow) & "'", "土地台帳一覧：" & sWhere & " [M_固定情報].[地番] LIKE '" & StrConv(St, vbNarrow) & "'", True
                Else
                    Exit Sub
                End If
        End Select
        End With
    End Sub

    Private Sub mvarCmdGo_Click()
        Dim St As String
        Dim Sc As String
        Dim n As Long
        Dim sWhere As String
        Dim s備考 As String

        mvarCmdGo.SetFocus
        With mvarPDW.ControlMan
        Select Case DVProperty.ClassStr
            Case "農家検索"
                If Len(mvarPDW.ControlMan.CtrlText(DVProperty, "備考")) Then
                    s備考 = " AND [D:個人Info].[備考] LIKE '%" & Trim(mvarPDW.ControlMan.CtrlText(DVProperty, "備考")) & "%'"
                End If
                
                If .CtrlVisible(DVProperty, "フリガナ") Then
                    St = StrConv(StrConv(Replace(mvarPDW.ControlMan.CtrlText(DVProperty, "フリガナ"), "*", "%"), vbKatakana), vbNarrow)
                    Sc = Fnc.あいまいカナ文字列(St)
                    
                    If Len(St) Then
                    ElseIf MsgBox("全件検索しますか", vbYesNo) = vbNo Then
                        Exit Sub
                    End If
                    sWhere = "([フリガナ] LIKE '" & St & "%' Or [検索フリガナ] LIKE '" & Sc & "%')"
                    SaveKanaMRL
                
                ElseIf .CtrlVisible(DVProperty, "漢字") Then
                    St = Replace(.CtrlText(DVProperty, "漢字"), "*", "%")
                    If Len(St) Then
                    ElseIf MsgBox("全件検索しますか", vbYesNo) = vbNo Then
                        Exit Sub
                    End If
                    sWhere = "[氏名] LIKE '" & StrConv(StrConv(St, vbKatakana), vbNarrow) & "%'"
                ElseIf mvarTZyusyo.Visible Then
                    St = "%" & Replace(mvarTZyusyo.Text, "*", "%") & "%"
                    St = Replace(St, "%%", "%")
                    If Len(St) Then
                    ElseIf MsgBox("全件検索しますか", vbYesNo) = vbNo Then
                        Exit Sub
                    End If
                    sWhere = "[住所] LIKE '" & St & "'"
                End If
        
                If Len(mvarPDW.ControlMan.CtrlText(DVProperty, "備考")) Then
                End If
                
                sWhere = Trim(Set農家条件(mvarPDW.ControlMan.CtrlD(DVProperty, mvarOptCBKey(0)), mvarPDW.ControlMan.CtrlD(DVProperty, mvarOptCtrl(0)), "")) & " " & sWhere
                
                SQLList世帯員 sWhere & s備考, "農家検索 : " & sWhere & s備考, True
            Case "農地検索"
                St = Replace(mvarPDW.ControlMan.CtrlText(DVProperty, "地番"), "*", "%")
                If Len(St) = 0 Then Exit Sub
                sWhere = ""
                
                If mvarCombo1.ListIndex = -1 Then
                    
                ElseIf mvarCombo1.ItemData(mvarCombo1.ListIndex) <> -99999 Then
                    sWhere = " [V_農地].大字ID = " & mvarCombo1.ItemData(mvarCombo1.ListIndex) & " AND"
                End If
                
                For n = 0 To UBound(mvarOptCBKey)
                    sWhere = Set農地条件(mvarPDW.ControlMan.CtrlD(DVProperty, mvarOptCBKey(n)), mvarPDW.ControlMan.CtrlD(DVProperty, mvarOptCtrl(n)), sWhere)
                Next
                If mvarCombo2.ListIndex = -1 Then
                ElseIf mvarCombo2.ItemData(mvarCombo2.ListIndex) <> -99999 Then
                    sWhere = " [V_農地].小字ID = " & mvarCombo2.ItemData(mvarCombo2.ListIndex) & " AND"
                End If
                
                If Len(St) Then
                    view農地List " WHERE" & sWhere & " [V_農地].[地番] LIKE '" & StrConv(St, vbNarrow) & "'", "農地一覧：" & sWhere & " [V_農地].[地番] LIKE '" & StrConv(St, vbNarrow) & "'", True '/** 農地0001-0001-0002
                Else
                    Exit Sub
                End If
                
                If Len(mvarPDW.ControlMan.CtrlText(DVProperty, "地番")) Then
                    St = mvarPDW.ControlMan.CtrlText(DVProperty, "地番")
                    For n = 0 To mvarPDW.ControlMan.CtrlD(DVProperty, "地番").ListCount - 1
                        If n >= 30 Then Exit For
                        If Not mvarPDW.ControlMan.CtrlText(DVProperty, "地番") = mvarPDW.ControlMan.CtrlD(DVProperty, "地番").List(n) Then
                            St = St & ";" & mvarPDW.ControlMan.CtrlD(DVProperty, "地番").List(n)
                        End If
                    Next
                    If Len(St) Then SystemDB.SetDirectData "S_システムデータ", "DATA", St, , "検索地番"
                End If
                mvarPDW.ControlMan.CtrlD(DVProperty, "地番").SetFocus
        End Select
        End With
    End Sub
    Private Function Set農家条件(Ctrl As Control, Ctrl2 As Control, sWhere As String) As String
        Dim bInData As Boolean
        
        If Ctrl.Visible Then
            Select Case TypeName(Ctrl2)
                Case "TextBox": bInData = (Len(Ctrl2.Text) > 0)
                Case "ComboBox": bInData = (Ctrl2.ListIndex > -1)
                Case "Nothing": bInData = False
                Case "NakaDT": bInData = IsDate(Ctrl2.Value) And (Ctrl2.Value <> 0)
                Case Else
                    Debug.Assert CaseAssertPrint(TypeName(Ctrl2))
            End Select
            If bInData Then
                Select Case Ctrl.ListIndex
                    Case 1: Set農家条件 = sWhere & " Val(IIF([生年月日]>0,IIF(dateadd('yyyy',datediff('yyyy',[生年月日],now()),[生年月日])>Now(),datediff('yyyy',[生年月日],now())-1,datediff('yyyy',[生年月日],now())),'-'))=" & Val(Ctrl2.Text) & " AND"
                    Case 2: If IsDate(Ctrl2.Text) Then Set農家条件 = sWhere & " [生年月日]=#" & CDate(Ctrl2.Text) & "# AND" Else MsgBox "生年月日が正しくありません", vbCritical
                    Case 3: Set農家条件 = sWhere & " [農業従事日数]=" & Val(Ctrl2.Text) & " AND"
                End Select
            Else
                Set農家条件 = sWhere
            End If
        Else
            Set農家条件 = sWhere
        End If
    End Function
    Private Function Set農地条件(Ctrl As Control, Ctrl2 As Control, sWhere As String) As String
        Dim bInData As Boolean
        If Ctrl.Visible Then
        
            Select Case TypeName(Ctrl2)
                Case "TextBox": bInData = (Len(Ctrl2.Text) > 0)
                Case "ComboBox": bInData = (Ctrl2.ListIndex > -1)
                Case "Nothing": bInData = False
                Case "NakaDT": bInData = IsDate(Ctrl2.Value) And (Ctrl2.Value <> 0)
                Case Else
                    Debug.Assert CaseAssertPrint(TypeName(Ctrl2))
            End Select
        
            If bInData Then
                Select Case Ctrl.List(Ctrl.ListIndex)
                    Case "登記地目": Set農地条件 = sWhere & " [V_地目].[ID]=" & Ctrl2.ItemData(Ctrl2.ListIndex) & " AND"
                    Case "現況地目": Set農地条件 = sWhere & " [V_現況地目].[名称]='" & Trim(Ctrl2.Text) & "' AND"
                    Case "自小作別": Set農地条件 = sWhere & " [自小作別]=" & Ctrl2.ItemData(Ctrl2.ListIndex) & " AND"
                    Case "貸付希望": Set農地条件 = sWhere & " [貸付希望]=" & Ctrl2.ItemData(Ctrl2.ListIndex) & " AND"
                    Case "売渡希望": Set農地条件 = sWhere & " [売渡希望]=" & Ctrl2.ItemData(Ctrl2.ListIndex) & " AND"
                    
                    Case "登記面積": Set農地条件 = sWhere & " [登記簿面積]=" & Val(Ctrl2.Text) & " AND"
                    Case "農委地目": Set農地条件 = sWhere & " [地目名]='" & Trim(Ctrl2.Text) & "' AND"
                    Case "適用法令": Set農地条件 = sWhere & " [小作地適用法]=" & Ctrl2.ItemData(Ctrl2.ListIndex) & " AND"
                    Case "利用権始期検索開始": Set農地条件 = sWhere & " [小作開始年月日]>=#" & Format$(Ctrl2.Value, "yyyy/mm/dd") & "# AND "
                    Case "利用権始期検索終了": Set農地条件 = sWhere & " [小作開始年月日]<=#" & Format$(Ctrl2.Value, "yyyy/mm/dd") & "# AND "
                    Case Else
                        Debug.Assert CaseAssertPrint(Ctrl.List(Ctrl.ListIndex))
                        Set農地条件 = sWhere
                End Select
            Else
                Set農地条件 = sWhere
            End If
            
        Else
            Set農地条件 = sWhere
        End If
    End Function
    Private Sub mvarCombo1_Change()
        Dim n As Long
        
        With mvarCombo1
        If .ListIndex = -1 Then
            For n = 0 To .ListCount - 1
                If .List(n) = mvarCombo1.Text Then
                    .ListIndex = n
                    Exit For
                End If
            Next
        End If
        End With
    End Sub

    Private Sub mvarCombo1_Click()
        Dim Ar As CArray
        Dim n As Long
        Dim Cm As Variant
        
        On Error Resume Next
        With mvarCombo2
            .Clear
            .AddItem "なし": .ItemData(.NewIndex) = -99999: .ListIndex = .NewIndex
            If mvarCombo1.ItemData(mvarCombo1.ListIndex) > 0 Then
            Set Ar = SystemDB.GetRecordsetArray("SELECT ID,名称 FROM V_小字 WHERE [大字ID]=" & mvarCombo1.ItemData(mvarCombo1.ListIndex), , vbFormFeed, vbCrLf)
            If Not Ar Is Nothing Then
            For n = Ar.nLBound To Ar.nUBound
                If Ar.length(n) Then
                    Cm = Split(Ar(n), vbFormFeed)
                    .AddItem Trim(Cm(1))
                    .ItemData(.NewIndex) = Val(Cm(0))
                End If
            Next
            End If
            End If
        End With
    End Sub

    Private Sub mvarCombo2_Change()
        Dim n As Long
        
        With mvarCombo2
        If .ListIndex = -1 Then
            For n = 0 To .ListCount - 1
                If .List(n) = mvarCombo1.Text Then
                    .ListIndex = n
                    Exit For
                End If
            Next
        End If
        End With
    End Sub
    
    Private Sub 農地検索Init()
        Dim n As Long
        Dim St As String
        Dim Ar As CArray
        Dim Cm As Variant
        Dim vList As Variant
        
        With mvarPDW.ControlMan
            .AddCtrlDVP(DVProperty, "ラベル説明", "VB.Label", mvarBody, "FontSize=10;BackStyle=0;ForeColor=16711680;BorderStyle=0;AutoSize=-1;Visible=-1:WordWrap=-1").Caption = "地番を入力してください" & vbCrLf & "※検索の際、不明な文字に" & vbCrLf & "ワイルドカード * が使えます" & vbCrLf & "例、「10*-1」のとき" & vbCrLf & "10-1,101-1,1023-1・・・などが" & vbCrLf & "検索できます。"
            .AddCtrlDVP DVProperty, "ラベル大字", "VB.Label", mvarBody, "FontSize=10;BackStyle=0;ForeColor=16711680;BorderStyle=0;AutoSize=-1;Caption=大字;Visible=-1"
            .AddCtrlDVP DVProperty, "ラベル小字", "VB.Label", mvarBody, "FontSize=10;BackStyle=0;ForeColor=16711680;BorderStyle=0;AutoSize=-1;Caption=小字;Visible=-1"
            .AddCtrlDVP DVProperty, "ラベル地番", "VB.Label", mvarBody, "FontSize=10;BackStyle=0;ForeColor=16711680;BorderStyle=0;AutoSize=-1;Caption=地番;Visible=-1"
        
        End With
        
        Set mvarCombo1 = mvarPDW.AddCtrlWithCode(DVProperty.UniqueCode & "Combo大字", "VB.ComboBox", mvarBody)
        With mvarCombo1
            .IMEMode = 6
            .FontSize = 10
            .AddItem "なし": .ItemData(.NewIndex) = -99999: .ListIndex = .NewIndex
            Set Ar = SystemDB.GetRecordsetArray("SELECT ID,名称 FROM V_大字", , vbTab, vbCrLf)
            
            For n = Ar.nLBound To Ar.nUBound
                If Ar.length(n) Then
                    Cm = Split(Ar(n), vbTab)
                    .AddItem Trim(Cm(1))
                    .ItemData(.NewIndex) = Val(Cm(0))
                End If
            Next
            
            .IMEMode = 2
            .Visible = True
        End With
        Set mvarCombo2 = mvarPDW.AddCtrlWithCode(DVProperty.UniqueCode & "Combo小字", "VB.ComboBox", mvarBody)
        With mvarCombo2
            .IMEMode = 6
            .FontSize = 10
            .AddItem "なし": .ItemData(.NewIndex) = -99999: .ListIndex = .NewIndex
            .IMEMode = 2
            .Visible = True
        End With
        
        
        With mvarPDW.ControlMan.AddCtrlDVP(DVProperty, "地番", "VB.ComboBox", mvarBody, "FontSize=10")
            St = Fnc.NullCast(SystemDB.GetDirectData("S_システムデータ", "DATA", , "検索地番"), "")
            Ar.SetSplitData St, ";"
            .Clear
            For n = Ar.nLBound To Ar.nUBound
                .AddItem Ar(n)
            Next
            If n > 0 Then .ListIndex = 0
            .Visible = True
            .IMEMode = 0
            .SetFocus
        End With
        
        mvarPDW.ControlMan.AddCtrlDVP DVProperty, "転用地検索", "VB.CommandButton", mvarBody, "FontSize=10;Caption=転用地検索;Visible=-1"
        mvarPDW.ControlMan.AddCtrlDVP DVProperty, "土地台帳検索", "VB.CommandButton", mvarBody, "FontSize=10;Caption=土地台帳検索;Visible=-1"
    '拡張部分
        SetOptions GetArray("以下なし;1", "登記地目;2", "現況地目;3", "自小作別;4", "登記面積;5", "農委地目;2", "適用法令;2", "利用権始期検索開始;7", "利用権始期検索終了;8", "貸付希望;0", "売渡希望;0")
    End Sub

    Private Sub SetOptions(vList As Variant)
        Dim n As Long
        Dim pObj As Object
        For n = 0 To mvarEXCtrlCount - 1
            mvarPDW.ControlMan.AddCtrlDVP DVProperty, mvarOptCBKey(n), "VB.ComboBox", mvarBody, "IMEMode=2;FontSize=10"
            Set pObj = mvarPDW.ControlMan.CtrlD(DVProperty, mvarOptCBKey(n))
            With mvarPDW.ControlMan.CtrlD(DVProperty, mvarOptCBKey(n))
                mvarPDW.ControlMan.SetComboListD DVProperty, mvarOptCBKey(n), vList
                .ListIndex = 0
                .Visible = True
            End With
        Next
    End Sub

    Private Sub 農家検索Init()
        Dim n As Long
        Dim St As String
        Dim Ar As Variant
        Dim vList As Variant
       
        With mvarPDW.ControlMan.AddCtrlDVP(DVProperty, "フリガナ", "VB.ComboBox", mvarBody, "FontSize=10;IMEMode=6;Text=;Visible=True")
            St = Fnc.NullCast(SystemDB.GetDirectData("S_システムデータ", "DATA", , "検索カナ"), "")
            mvarPDW.ControlMan.SetComboListD DVProperty, "フリガナ", Split(St, ";")
            .SetFocus
        End With
        
        mvarPDW.ControlMan.AddCtrlDVP DVProperty, "ラベル漢字", "VB.Label", mvarBody, "AutoSize=-1;BackStyle=0;FontUnderline=-1;FontSize=10;BackStyle=0;ForeColor=16711680;BorderStyle=0;Caption=漢字検索>>;Visible=-1"
        mvarPDW.ControlMan.AddCtrlDVP DVProperty, "ラベルカナ", "VB.Label", mvarBody, "AutoSize=-1;BackStyle=0;FontUnderline=-1;FontSize=10;BackStyle=0;ForeColor=16711680;BorderStyle=0;Caption=<<カナ検索;Visible=-1"
        mvarPDW.ControlMan.AddCtrlDVP DVProperty, "ラベル住所", "VB.Label", mvarBody, "FontUnderline=-14;FontSize=10;BackStyle=0;ForeColor=16711680;BorderStyle=0;AutoSize=-1;Caption=住所検索>>;Visible=-1"
        
        Set mvarTZyusyo = mvarPDW.AddCtrlWithCode(DVProperty.UniqueCode & "TextZyusyo", "VB.TextBox", mvarBody)
        With mvarTZyusyo
            .Height = 300
            .FontSize = 10
            .IMEMode = 4
            .Visible = True
        End With
        
        mvarPDW.ControlMan.AddCtrlDVP DVProperty, "ラベル備考", "VB.Label", mvarBody, "FontUnderline=-14;FontSize=10;BackStyle=0;ForeColor=16711680;BorderStyle=0;AutoSize=-1;Caption=備考;Visible=-1"
        
        With mvarPDW.ControlMan
            .AddCtrlDVP DVProperty, "備考", "VB.TextBox", mvarBody, "FontSize=10;Height=300;IMEMode=4;Text=;Visible=-1"
        End With
        
        
        With mvarPDW.ControlMan.AddCtrlDVP(DVProperty, "漢字", "VB.ComboBox", mvarBody)
            Dim Va As Variant
            Va = SystemDB.GetDirectData("S_システムデータ", "DATA", , "検索漢字")
            If IsNull(Va) Then St = "" Else St = Va
            Ar = Split(St, ";")
            .FontSize = 10
            .Clear
            For n = LBound(Ar) To UBound(Ar)
                .AddItem Ar(n)
            Next
            If n > 1 Then .ListIndex = 0
            .FontSize = 10
            .IMEMode = 4
            .Visible = True
        End With
        
        
        Call mvarPDW.ControlMan.AddCtrlDVP(DVProperty, "世帯検索", "VB.CommandButton", mvarBody, "FontSize=10;Caption=世帯検索;Visible=-1")
        Call mvarPDW.ControlMan.AddCtrlDVP(DVProperty, "住基台帳検索", "VB.CommandButton", mvarBody, "FontSize=10;Caption=住基台帳検索;Visible=-1")
        Call mvarPDW.ControlMan.AddCtrlDVP(DVProperty, "所有地検索", "VB.CommandButton", mvarBody, "FontSize=10;Caption=所有地検索;Visible=-1")
        Call mvarPDW.ControlMan.AddCtrlDVP(DVProperty, "借受地検索", "VB.CommandButton", mvarBody, "FontSize=10;Caption=借受地検索;Visible=-1")

    '拡張部分
        SetOptions GetArray("以下なし;1", "年齢;2", "生年月日;2", "従事日数;2")
    End Sub

    Private Sub SaveKanaMRL()
        Dim St As String
        St = mvarPDW.ControlMan.GetComboList(DVProperty, "フリガナ", 30)
        If Len(St) Then SystemDB.DBProperty("検索カナ") = St
    End Sub

        
End Class










Class C選挙権確定者
    Option Explicit
    Implements CPrintCls
    Private mvarParent As CPrintFormSK
    Private mvarDic As ADBasicLIB2.CDataDictionary
    Private mvarKey As String
    Private s名称変更 As String
    Private s市町村 As String
    
    Private Property Get CPrintCls_CanCancelPrint() As Boolean

    End Property

    Private Property Get CPrintCls_CanPrintNowPage() As Boolean

    End Property
    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property

    Private Property Let CPrintCls_Key(ByVal RHS As String)

    End Property

    Private Property Get CPrintCls_Key() As String

    End Property
    Private Sub Class_Initialize(): Set mvarDic = New ADBasicLIB2.CDataDictionary: End Sub
    
    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim sSQL As String
        Dim St As String
        Dim SX As String
        Dim pNode As Object
        Dim SID As Long
        Dim Ar As Variant
        Dim bLoop As Boolean
        Dim n As Long
        Dim Va As Variant

        St = "自治会集落名行政区公民館公民会"
        s名称変更 = MID(St, Val(SystemDB.DBProperty("選挙申請名簿用")) * 3 + 1, 3)
        s市町村 = SystemDB.DBProperty("市町村名")

        With mvarParent
            .UsedTreeView = True
            
            If s市町村 <> "姶良市" Then
                Set Rs = SystemDB.GetRecordsetEx("SELECT * FROM [V_行政区] ORDER BY [ID];", , , "選挙")
                
                .Nodes.Add , , "選挙権確定者.0", "選挙権確定者", "CloseFolder", "CloseFolder"
                
                Do Until Rs.EOF
                    .Nodes.Add("選挙権確定者.0", 4, CStr("行政区." & Rs.Value("ID")), Rs.Value("行政区"), "CloseFolderG", "CloseFolderG").Tag = ""
                    Rs.MoveNext
                Loop
                SystemDB.CloseRs Rs
            Else
                Set Rs = SystemDB.GetRecordsetEx("SELECT M_BASICALL.ID, M_BASICALL.名称 AS 行政区, M_BASICALL.nParam FROM M_BASICALL WHERE (((M_BASICALL.Class)='行政区') AND ((M_BASICALL.ID)>0)) ORDER BY M_BASICALL.nParam, M_BASICALL.ID;", , , "選挙")
                
                .Nodes.Add , , "姶良", "姶良", "CloseFolder", "CloseFolder"
                .Nodes.Add , , "加治木", "加治木", "CloseFolder", "CloseFolder"
                .Nodes.Add , , "蒲生", "蒲生", "CloseFolder", "CloseFolder"
                
                Do Until Rs.EOF
                    .Nodes.Add(Choose(Rs.Value("nParam"), "姶良", "加治木", "蒲生"), 4, CStr("行政区." & Rs.Value("ID")), Rs.Value("行政区"), "CloseFolderG", "CloseFolderG").Tag = ""
                    Rs.MoveNext
                Loop
                SystemDB.CloseRs Rs
            End If


            sSQL = "SELECT [D:個人Info].選挙権の有無,[D:世帯Info].ID,[D:個人Info].性別, '世帯員.' & [D:個人Info].ID AS [KEY],[D:世帯Info].農家番号, [D:個人Info].氏名, [V_続柄].続柄 AS 続柄1, [V_続柄_1].続柄 AS 続柄2, [V_続柄_2].続柄 AS 続柄3, [D:個人Info].生年月日,[D:個人Info].住民区分,[D:個人Info].行政区ID,[D:個人Info].住所"
            sSQL = sSQL & " FROM [D:世帯Info] INNER JOIN ((([D:個人Info] LEFT JOIN V_続柄 ON [D:個人Info].続柄1 = V_続柄.ID) LEFT JOIN V_続柄 AS V_続柄_1 ON [D:個人Info].続柄2 = V_続柄_1.ID) LEFT JOIN V_続柄 AS V_続柄_2 ON [D:個人Info].続柄3 = V_続柄_2.ID) ON [D:世帯Info].ID = [D:個人Info].世帯ID"
            sSQL = sSQL & " GROUP BY [D:個人Info].選挙権の有無,[D:世帯Info].ID,[D:個人Info].住民区分,[D:個人Info].性別,[D:個人Info].ID, [D:個人Info].氏名,[D:世帯Info].農家番号, [V_続柄].続柄, [V_続柄_1].続柄, [V_続柄_2].続柄, [D:個人Info].生年月日, [D:個人Info].行政区ID, [V_続柄].ID,[D:個人Info].住民区分,[D:個人Info].行政区ID,[D:個人Info].住所"
            sSQL = sSQL & " HAVING ([選挙権の有無]=True AND [D:個人Info].住民区分 = " & SystemDB.DBProperty("記録住民コード") & ") AND ([D:世帯Info].ID <> 0) AND ([D:個人Info].生年月日 < #" & Year(Now()) - 20 - (Month(Now()) > 7) & "/4/2#) And ([D:個人Info].行政区ID > 0)"
            sSQL = sSQL & " ORDER BY [D:個人Info].[行政区ID],[D:世帯Info].農家番号,[D:世帯Info].ID, [V_続柄].ID, [D:個人Info].生年月日;"
            
            SID = 0

            Set Rs = SystemDB.GetRecordsetEx(sSQL, , , Me)
            Do Until Rs.EOF
                St = Rs.Value("農家番号") & ";" & Rs.Value("氏名") & ";" & IIf(Rs.Value("選挙権の有無"), "○", "-") & ";" & Rs.Value("続柄1") & "の" & Rs.Value("続柄2") & "の" & Rs.Value("続柄3") & ";" & Choose(Rs.Value("性別") + 2, "不明", "男", "女") & ";" & Format(Rs.Value("生年月日"), "GEE/MM/DD") & ";;"
                St = St & Fnc.GetShortAddress(Rs.NullCast("住所", ""), SystemDB.DBProperty("都道府県名"), SystemDB.DBProperty("郡部"), s市町村)
                mvarDic.Add CStr(Rs.Value("Key")), St
                SX = .Nodes(CStr("行政区." & Rs.Value("行政区ID"))).Tag
                If SX = "" Then SID = 0
                If SID = 0 Then
                    SID = Rs.Value("ID")
                ElseIf SID <> Rs.Value("ID") And Len(SX) > 0 Then
                    SX = SX & "Q;"
                    SID = Rs.Value("ID")
                End If
                SX = SX & Rs.Value("Key") & IIf(Rs.Value("選挙権の有無"), "○", "") & Choose(Rs.Value("性別") + 2, "不明", "男", "女") & ";"
                .Nodes(CStr("行政区." & Rs.Value("行政区ID"))).Tag = SX
                Rs.MoveNext
            Loop
            SystemDB.CloseRs Rs

            For Each pNode In .Nodes
                If Fnc.GetKeyHead(pNode.Key) = "行政区" Then
                    pNode.Text = pNode.Text & "<" & (Fnc.Sf.StrCount(pNode.Tag, "Q") + 1) & "," & Fnc.Sf.StrCount(pNode.Tag, "男") & "," & Fnc.Sf.StrCount(pNode.Tag, "女") & "," & Fnc.Sf.StrCount(pNode.Tag, "○男") & "," & Fnc.Sf.StrCount(pNode.Tag, "○女") & ">"
                    pNode.Tag = Replace(pNode.Tag, "○", "")
                    pNode.Tag = Replace(pNode.Tag, "男", "")
                    pNode.Tag = Replace(pNode.Tag, "女", "")
                    pNode.Tag = Replace(pNode.Tag, "不明", "")

                    SID = 1
                    Ar = Split(pNode.Tag, ";")
                    For Each Va In Ar
                        If Va = "Q" Then

                        Else
                            St = mvarDic.Item(CStr(Va)) & ";" & SID
                            mvarDic.Item(CStr(Va)) = St
                            SID = SID + 1
                        End If
                    Next
                End If
            Next

            Do
            bLoop = False
            For Each pNode In .Nodes
                If Fnc.GetKeyHead(pNode.Key) = "行政区" And Len(Trim(pNode.Tag)) = 0 Then
                    .Nodes.Remove pNode.Key
                    bLoop = True
                    Exit For
                End If
            Next
            Loop Until bLoop = False
        End With
    End Function
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants: CPrintCls_Orientation = vbPRORPortrait: End Property
    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&): CPrintCls_Repaint: End Sub
    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Set CPrintCls_Parent(RHS As ADBasicLIB2.CPrintFormSK): Set mvarParent = RHS: End Property

    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        Dim pNode As Object
        Dim nData As Long
        Dim B As Boolean
        B = False
        For Each pNode In mvarParent.Nodes
            If pNode.Checked And Right$(pNode.Text, 6) <> "0,0,0>" Then
                Select Case Fnc.GetKeyHead(pNode.Key)
                    Case "行政区"
                        mvarParent.PrintPage = 1
                        Do Until Print世帯(pNode.Key, mvarParent.PrintPage - 1)
                            mvarParent.NewPage
                        Loop
                End Select
                
                pNode.Checked = False
                B = True
                mvarParent.NewPage
            End If
        Next
        If B Then mvarParent.EndDoc
    End Sub

    Private Sub CPrintCls_Repaint()
        Select Case Fnc.GetKeyHead(mvarKey)
            Case "行政区"
                Print世帯 mvarKey, mvarParent.Page - 1
        End Select
    End Sub

    Private Function Print世帯(ByVal sKey As String, Optional nPage As Long = 0) As Boolean
        Dim y As Single, n As Single
        Dim Ar As Variant, Cm As Variant
        Dim St As String

        y = 0
        n = 0

        Print世帯 = False

        With mvarParent
            .Offset -4, 0
            .ClearScreen
            
            Ar = Split(.Nodes(sKey).Tag, ";")
            If UBound(Ar) = -1 Then Print世帯 = True: Exit Function

    '----------------------------文字埋め
            .TextOut s名称変更, 36, 30, 11, 2
            .TextOut "No", 20, 38, 11
            .TextOut "農家番号", 35, 38, 11, 2
            .hTextOut "選挙権", 46, 37, 1, , 7
            .TextOut "氏名", 52, 38, 11
            .TextOut "続柄", 77, 38, 11
            .TextOut "性別", 97, 38, 11
            .TextOut "生年月日", 107, 38, 11
            .TextOut "住所", 131, 38, 11
    '-----------------------------------
    '-----------------------------表作成
            .LineBox 26, 28, 76, 36, 1, 1, 20   '自治会の枠
            .DLine 18, 44, 200, 44, 0, 4        '仕切り線
    '-----------------------------------
    '---------------------------データはめ込み用の文字位置
            St = Replace(.Nodes(sKey).Text, "<", ",")
            St = Replace(St, ">", ",")
            Cm = Split(St, ",")

            .DrawText Cm(0), 47, 28, 28, 4, 11, 0, 2, 8
            .TextOut "世帯数=" & Right$("    " & FormatNumber(Val(Cm(1)), 0), 4) & " 件", 115, 28, 11, 1
            n = Val(Cm(4)) + Val(Cm(5))
            y = Val(Cm(2)) + Val(Cm(3))
            .TextOut "  人数=" & FormatNumber(n, 0) & "/" & FormatNumber(y, 0) & " 人", 115, 32, 11, 1
            .TextOut "  男性=" & FormatNumber(Val(Cm(4)), 0) & "/" & FormatNumber(Val(Cm(2)), 0) & " 人", 120, 32, 11
            .TextOut "  女性=" & FormatNumber(Val(Cm(5)), 0) & "/" & FormatNumber(Val(Cm(3)), 0) & " 人", 150, 32, 11

            For n = 0 To 49
                y = n * 4.5
                If UBound(Ar) <= nPage * 50 + n Then Print世帯 = True: Exit For
                If Ar(nPage * 50 + n) = "Q" Then
                Else
                    Cm = Split(mvarDic.Item(Ar(nPage * 50 + n)), ";")

                    .TextOut Cm(8), 25, 46 + y, 12, 1                       'ナンバー
                    .TextOut Cm(0), 43, 46 + y, 12, 1                       '農家番号
                    .TextOut Cm(2), 47, 46 + y, 12, 2
                    .TextOut Cm(1), 51, 46 + y, 11                          '氏名
                    .TextOut Replace(Cm(3), "の-", ""), 78, 46 + y, 12      '続柄
                    .TextOut Cm(4), 97, 46 + y, 12                          '性別
                    .TextOut Cm(5), 107, 46 + y, 12                         '生年月日
    '                    .TextOut FormatNumber(Int(Cm(6)), 0) & " u", 150 , 46  + Y, 12, 1          '経営面積
                    .TextOut StrConv(Cm(7), vbNarrow), 131, 46 + y, 11      '住所
                End If
            Next
            If UBound(Ar) <= nPage * 50 + n Then Print世帯 = True
    '-----------------------------------
        End With
    End Function

    Private Sub CPrintCls_TargetChange(sKey As String)
        mvarKey = sKey
        Select Case Fnc.GetKeyHead(mvarKey)
            Case "行政区":
                Dim Ar As Variant
                Ar = Split(mvarParent.Nodes(sKey).Tag, ";")
                mvarParent.MaxPage = Fix(UBound(Ar) / 50) - ((UBound(Ar) Mod 50) > 0)
        End Select

        CPrintCls_Repaint
    End Sub

End Class











Class C選挙申請書
    Option Explicit
    Implements CPrintCls
    
    Private mvarParent As CPrintFormSK
    Private mvarDic As ADBasicLIB2.CDataDictionary
    Private mvarKey As String
    Private s裏面 As String
    Private s本人 As String
    Private s会長名 As String
    Private b認定面積 As Boolean
    Private b男女表示 As Boolean
    Private b世帯員 As Boolean
    Private b生年月日表示 As Boolean
    Private s名称変更 As String
    Private b白抜き As Boolean
    Private s都道府県名 As String
    Private s郡部名 As String
    Private s市町村名 As String
    Private b提出日 As Boolean
    Private s提出日程 As String
    Private n支所 As Long
    Private SX As Single
    Private n太枠 As Single
    Private SY As Single, EY As Single
    Private pY As Single
    Private dX(11) As Single, hX(10) As Single
    Private Ay As Variant
    Private sData As Variant
    Private Ar As Variant
    Private Arr As Variant
    Private PCnt As Long, GCnt As Long
    Private s支所計(7) As Long, s支所計2(7) As Long
    Private Sub Class_Initialize(): Set mvarDic = New ADBasicLIB2.CDataDictionary: End Sub

    Private Property Get CPrintCls_CanCancelPrint() As Boolean: End Property
    Private Property Get CPrintCls_CanPrintNowPage() As Boolean: CPrintCls_CanPrintNowPage = True: End Property
    Private Property Let CPrintCls_Key(ByVal RHS As String): mvarKey = RHS: End Property
    Private Property Get CPrintCls_Key() As String: CPrintCls_Key = mvarKey: End Property

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim RsS As ADBasicLIB2.RecordsetEx
        Dim sSQL As String
        Dim St As String
        Dim n As Long
        Dim pNode As Object
        Dim sBlock As String
        Dim OID As Long
        Dim O支所 As Long
        Dim cnt As Long
        Dim TCnt As Long
        Dim m As Long
        Dim Flg As Boolean
        Dim sWhere As String
        
    'On Error GoTo Er_Ext:
        With SystemDB
            s都道府県名 = .DBProperty("都道府県名")
            s郡部名 = .DBProperty("郡部")
            s市町村名 = .DBProperty("市町村名")
            b生年月日表示 = Val(.DBProperty("生年月日の表示"))
            b男女表示 = Val(.DBProperty("男女の表示"))
            b世帯員 = Val(.DBProperty("世帯員表示"))
            b白抜き = Val(sParam)
            b提出日 = Val(.DBProperty("提出日"))
            s提出日程 = .DBProperty("提出日程")
            n支所 = SysAD.GetSettingData("農地基本台帳", "支所番号", 1)
            n太枠 = .DBPropertyEx("選挙登載申請太線幅", vbInteger, 12)
            
            Select Case Val(.DBProperty("裏面"))
                Case 0: s裏面 = "(裏面記載注意事項参照)"
                Case 1: s裏面 = "(別紙記載注意事項参照)"
                Case 2: s裏面 = ""
            End Select
        
            St = "自治会集落名行政区公民館公民会"
            s名称変更 = MID(St, Val(.DBProperty("選挙申請名簿用")) * 3 + 1, 3)
            Select Case Val(.DBProperty("本人")) + (.DBProperty("本人") = "True")
                Case 0: s本人 = "本　　人　　の　　申　　請　　面　　積"
                Case -1: s本人 = "世　　帯　　の　　耕　　作　　面　　積"
            End Select
            
            s会長名 = IIf(Val(.DBProperty("申請名簿会長名出力")), .DBProperty("会長名"), "")
            b認定面積 = Val(.DBProperty("認定面積"))
        End With
            
        With mvarParent
            .表示倍率 = 0.75
            
            If b白抜き Then
                .MaxPage = 1
            Else

    sBlock = "ツリービュー作成"
                
                .UsedTreeView = True

                If s市町村名 <> "姶良市" Then
                    .Nodes.Add , , "選挙人申請書.0", "選挙人申請書", "CloseFolder", "CloseFolder"
                Else
                    .Nodes.Add , "選挙人申請書.0", "姶良", "姶良", "CloseFolder", "CloseFolder"
                    .Nodes.Add , "選挙人申請書.0", "加治木", "加治木", "CloseFolder", "CloseFolder"
                    .Nodes.Add , "選挙人申請書.0", "蒲生", "蒲生", "CloseFolder", "CloseFolder"
                End If

    sBlock = "データ作成1"
                If Len(SystemDB.DBPropertyEx("選挙面積除外農地状況区分", vbString, "")) Then
                    sWhere = " WHERE [農地状況] NOT IN (" & SystemDB.DBPropertyEx("選挙面積除外農地状況区分", vbString, "") & ")"
                Else
                    sWhere = ""
                End If
                
                If s市町村名 = "さつま町" Then
                    sSQL = "SELECT Sum(耕作農地.登記簿面積) AS 耕作面積計, '世帯.' & [D:世帯Info].[ID] AS [Key], [D:個人Info].氏名, [D:個人Info].行政区ID, [V_行政区].行政区, [D:個人Info].住所, [D:世帯Info].農家番号, [D:個人Info].郵便番号, [D:個人Info].住民区分, [D:個人Info_1].フリガナ "
                    sSQL = sSQL & "FROM ((((SELECT IIf([自小作別]=0,IIF([管理世帯ID]<>0,[管理世帯ID],[所有世帯ID]),[借受世帯ID]) AS 耕作世帯, [D:農地Info].登記簿面積 FROM [D:農地Info]" & sWhere & ") AS 耕作農地 INNER JOIN [D:世帯Info] ON 耕作農地.耕作世帯 = [D:世帯Info].ID) INNER JOIN [D:個人Info] ON [D:世帯Info].世帯主ID = [D:個人Info].ID) INNER JOIN [D:個人Info] AS [D:個人Info_1] ON [D:世帯Info].世帯主ID = [D:個人Info_1].ID) LEFT JOIN [V_行政区] ON [D:個人Info].行政区ID = [V_行政区].ID "
                    sSQL = sSQL & "GROUP BY '世帯.' & [D:世帯Info].[ID], [D:個人Info].氏名, [D:個人Info].行政区ID, [V_行政区].行政区, [D:個人Info].住所, [D:世帯Info].農家番号, [D:個人Info].郵便番号, [D:個人Info].住民区分, [D:個人Info_1].フリガナ, [D:世帯Info].農家番号, [D:世帯Info].ID "
                    sSQL = sSQL & "HAVING (((Sum(耕作農地.登記簿面積)) >= 1000) And (([D:個人Info].行政区ID) > 0) And (([D:個人Info].住民区分) = " & SystemDB.DBProperty("記録住民コード") & ") And (([D:世帯Info].ID) > 0)) "
                    sSQL = sSQL & "ORDER BY [D:個人Info].行政区ID, [D:個人Info_1].フリガナ, [D:世帯Info].農家番号;"
                ElseIf s市町村名 = "阿久根市" Then
'                    sSQL = "SELECT Sum(耕作農地.田畑計の合計) AS 耕作面積計, '世帯.' & [D:世帯Info].[ID] AS [Key], [D:個人Info].氏名, [D:個人Info].行政区ID, V_行政区.行政区, [D:個人Info].住所, [D:世帯Info].農家番号, [D:個人Info].郵便番号, [D:個人Info].住民区分, [行政区] & [M_BASICALL].[名称] AS 班名"
'                    sSQL = sSQL & " FROM ((((SELECT IIf([自小作別]=0,IIf([管理世帯ID]<>0,[管理世帯ID],[所有世帯ID]),[借受世帯ID]) AS 耕作世帯, IIF(IsNull([田面積]),0,[田面積])+IIF(IsNull([畑面積]),0,[畑面積]) AS 田畑計の合計 FROM [D:農地Info]" & sWhere & ") AS 耕作農地 INNER JOIN [D:世帯Info] ON 耕作農地.耕作世帯 = [D:世帯Info].ID) INNER JOIN [D:個人Info] ON [D:世帯Info].世帯主ID = [D:個人Info].ID) LEFT JOIN V_行政区 ON [D:個人Info].行政区ID = V_行政区.ID) LEFT JOIN M_BASICALL ON [D:個人Info].投票区 = M_BASICALL.ID"
'                    If SystemDB.DBPropertyEx("前年有権者のみ表示", vbBoolean, False) Then
'                        sSQL = sSQL & " WHERE ((([D:個人Info].選挙権の有無) = True))"
'                    Else
'                        sSQL = sSQL & " WHERE ((([D:世帯Info].ID)>0) AND ((M_BASICALL.Class)='班'))"
'                    End If
'                    sSQL = sSQL & " GROUP BY '世帯.' & [D:世帯Info].[ID], [D:個人Info].氏名, [D:個人Info].行政区ID, V_行政区.行政区, [D:個人Info].住所, [D:世帯Info].農家番号, [D:個人Info].郵便番号, [D:個人Info].住民区分, [行政区] & [M_BASICALL].[名称]"
'                    sSQL = sSQL & " HAVING (((Sum(耕作農地.田畑計の合計))>=1000) AND (([D:個人Info].行政区ID)>0) AND (([D:個人Info].住民区分) = " & SystemDB.DBProperty("記録住民コード") & "))"
'                    sSQL = sSQL & " ORDER BY [D:個人Info].行政区ID, [D:世帯Info].農家番号;"

                    sSQL = "SELECT Sum(耕作農地.田畑計の合計) AS 耕作面積計, '世帯.' & [D:世帯Info].[ID] AS [Key], [D:個人Info].氏名, [D:個人Info].行政区ID, V_行政区.行政区, [D:個人Info].住所, [D:世帯Info].農家番号, [D:個人Info].郵便番号, [D:個人Info].住民区分, [行政区] & [M_BASICALL].[名称] AS 班名"
                    sSQL = sSQL & " FROM ((((SELECT IIf([自小作別]=0,IIf([管理世帯ID]<>0,[管理世帯ID],[所有世帯ID]),[借受世帯ID]) AS 耕作世帯, IIF(IsNull([田面積]),0,[田面積])+IIF(IsNull([畑面積]),0,[畑面積]) AS 田畑計の合計 FROM [D:農地Info]" & sWhere & ") AS 耕作農地 INNER JOIN [D:世帯Info] ON 耕作農地.耕作世帯 = [D:世帯Info].ID) INNER JOIN [D:個人Info] ON [D:世帯Info].世帯主ID = [D:個人Info].ID) LEFT JOIN V_行政区 ON [D:個人Info].行政区ID = V_行政区.ID) LEFT JOIN M_BASICALL ON [D:個人Info].投票区 = M_BASICALL.ID"
                    If SystemDB.DBPropertyEx("前年有権者のみ表示", vbBoolean, False) Then
                        sSQL = sSQL & " WHERE ((([D:個人Info].選挙権の有無) = True))"
                    Else
                        sSQL = sSQL & " WHERE ((([D:世帯Info].ID)>0) AND ((M_BASICALL.Class)='班'))"
                    End If
                    sSQL = sSQL & " GROUP BY '世帯.' & [D:世帯Info].[ID], [D:個人Info].氏名, [D:個人Info].行政区ID, V_行政区.行政区, [D:個人Info].住所, [D:世帯Info].農家番号, [D:個人Info].郵便番号, [D:個人Info].住民区分, [行政区] & [M_BASICALL].[名称], [D:個人Info].投票区, [D:世帯Info].農家番号"
                    sSQL = sSQL & " HAVING (((Sum(耕作農地.田畑計の合計)) >= 1000) And (([D:個人Info].行政区ID) > 0) And (([D:個人Info].住民区分) = " & SystemDB.DBProperty("記録住民コード") & "))"
                    sSQL = sSQL & " ORDER BY [D:個人Info].行政区ID, [D:個人Info].投票区, [D:世帯Info].農家番号;"
                ElseIf s市町村名 = "姶良市" Then
                    sSQL = "SELECT Sum(耕作農地.田畑計の合計) AS 耕作面積計, '世帯.' & [D:世帯Info].[ID] AS [Key], [D:個人Info].氏名, [D:個人Info].行政区ID, V_行政区.行政区, [D:個人Info].住所, [D:世帯Info].農家番号, [D:個人Info].郵便番号, [D:個人Info].住民区分, M_BASICALL.nParam "
                    sSQL = sSQL & "FROM ((((SELECT IIf([自小作別]=0,IIf([管理世帯ID]<>0,[管理世帯ID],[所有世帯ID]),[借受世帯ID]) AS 耕作世帯, IIF(IsNull([田面積]),0,[田面積])+IIF(IsNull([畑面積]),0,[畑面積]) AS 田畑計の合計 FROM [D:農地Info]" & sWhere & ") AS 耕作農地 INNER JOIN [D:世帯Info] ON 耕作農地.耕作世帯 = [D:世帯Info].ID) INNER JOIN [D:個人Info] ON [D:世帯Info].世帯主ID = [D:個人Info].ID) LEFT JOIN V_行政区 ON [D:個人Info].行政区ID = V_行政区.ID) LEFT JOIN M_BASICALL ON V_行政区.ID = M_BASICALL.ID "
                    If SystemDB.DBPropertyEx("前年有権者のみ表示", vbBoolean, False) Then
                        sSQL = sSQL & "WHERE ((([D:個人Info].選挙権の有無) = True) AND ((M_BASICALL.Class)='行政区')) "
                    Else
                        sSQL = sSQL & "WHERE ((M_BASICALL.Class)='行政区') "
                    End If
                    sSQL = sSQL & "GROUP BY '世帯.' & [D:世帯Info].[ID], [D:個人Info].氏名, [D:個人Info].行政区ID, V_行政区.行政区, [D:個人Info].住所, [D:世帯Info].農家番号, [D:個人Info].郵便番号, [D:個人Info].住民区分, M_BASICALL.nParam, [D:世帯Info].ID "
                    sSQL = sSQL & "HAVING (((Sum(耕作農地.田畑計の合計)) >= 1000) And (([D:個人Info].行政区ID) > 0) And (([D:個人Info].住民区分) = " & SystemDB.DBProperty("記録住民コード") & ") And (([D:世帯Info].ID) > 0)) "
                    sSQL = sSQL & "ORDER BY [D:個人Info].行政区ID, [D:世帯Info].農家番号;"
                Else
                    sSQL = "SELECT Sum(耕作農地.田畑計の合計) AS 耕作面積計, '世帯.' & [D:世帯Info].[ID] AS [Key], [D:個人Info].氏名, [D:個人Info].行政区ID, [V_行政区].行政区, [D:個人Info].住所, [D:世帯Info].農家番号, [D:個人Info].郵便番号, [D:個人Info].住民区分"
                    sSQL = sSQL & " FROM (((SELECT IIf([自小作別]=0,IIf([管理世帯ID]<>0,[管理世帯ID],[所有世帯ID]),[借受世帯ID]) AS 耕作世帯, IIF(IsNull([田面積]),0,[田面積])+IIF(IsNull([畑面積]),0,[畑面積]) AS 田畑計の合計 FROM [D:農地Info]" & sWhere & ") AS 耕作農地 INNER JOIN [D:世帯Info] ON 耕作農地.耕作世帯 = [D:世帯Info].ID) INNER JOIN [D:個人Info] ON [D:世帯Info].世帯主ID = [D:個人Info].ID) LEFT JOIN [V_行政区] ON [D:個人Info].行政区ID = [V_行政区].ID"
                    If SystemDB.DBPropertyEx("前年有権者のみ表示", vbBoolean, False) Then
                        sSQL = sSQL & " WHERE ((([D:個人Info].選挙権の有無) = True))"
                    End If
                    sSQL = sSQL & " GROUP BY '世帯.' & [D:世帯Info].[ID], [D:個人Info].氏名, [D:個人Info].行政区ID, [V_行政区].行政区, [D:個人Info].住所, [D:世帯Info].農家番号, [D:個人Info].郵便番号, [D:個人Info].住民区分, [D:世帯Info].ID"
                    sSQL = sSQL & " HAVING (((Sum(耕作農地.田畑計の合計)) >= 1000) And (([D:個人Info].行政区ID) > 0) And (([D:個人Info].住民区分) = " & SystemDB.DBProperty("記録住民コード") & ") And (([D:世帯Info].ID) > 0))"
                    sSQL = sSQL & " ORDER BY [D:個人Info].行政区ID, [D:世帯Info].農家番号;"
                End If
    
                n = 0: OID = 0: PCnt = 0
                Set RsS = SystemDB.GetRecordsetEx(sSQL, , , Me)
                
                n = 0
                Do Until RsS.EOF
                    If RsS.Value("耕作面積計") >= 1000 Then
                        sBlock = "データ追加1" & vbCr & s名称変更 & "コード:" & RsS.Value("行政区ID") & "⇒" & Fnc.NullCast(RsS.Value("行政区"), "該当するコードがありません") & vbCr & "氏名:" & RsS.Value("氏名")
                        If s市町村名 = "姶良市" Then
                            If n = 0 Then
                                n = 1
                                OID = RsS.Value("行政区ID")
                                .TreeNodeAdd CStr("行政区." & OID), RsS.V("行政区"), "Unit", Choose(RsS.Value("nParam"), "姶良", "加治木", "蒲生")
                            ElseIf OID = RsS.Value("行政区ID") Then
                                n = n + 1
                            ElseIf OID <> RsS.Value("行政区ID") Then
                                n = 1
                                OID = RsS.Value("行政区ID")
                                .TreeNodeAdd CStr("行政区." & OID), RsS.V("行政区"), "Unit", Choose(RsS.Value("nParam"), "姶良", "加治木", "蒲生")
                            End If
                            mvarDic.Add RsS.Key, .Nodes(CStr("行政区." & OID)).Text & "(" & Right("00000" & OID, 5) & ")" & ";" & CStr(RsS.Value("氏名") & ";" & Fnc.GetShortAddress(IIf(IsNull(RsS.Value("住所")), "", RsS.Value("住所")), s都道府県名, s郡部名, , , True) & ";" & RsS.Value("耕作面積計") & ";" & RsS.Value("郵便番号") & ";" & RsS.Value("農家番号")) & ";" & n & ";" & n
                        Else
                            If n = 0 Then
                                n = 1
                                OID = RsS.Value("行政区ID")
                                .TreeNodeAdd CStr("行政区." & OID), RsS.V("行政区"), "Unit", "選挙人申請書.0"
                            ElseIf OID = RsS.Value("行政区ID") Then
                                n = n + 1
                            ElseIf OID <> RsS.Value("行政区ID") Then
                                n = 1
                                OID = RsS.Value("行政区ID")
                                .TreeNodeAdd CStr("行政区." & OID), RsS.V("行政区"), "Unit", "選挙人申請書.0"
                            End If
                            
                            If s市町村名 <> "阿久根市" Then
                                mvarDic.Add RsS.Key, .Nodes(CStr("行政区." & OID)).Text & "(" & Right("0000" & OID, 4) & ")" & ";" & CStr(RsS.Value("氏名") & ";" & Fnc.GetShortAddress(IIf(IsNull(RsS.Value("住所")), "", RsS.Value("住所")), s都道府県名, s郡部名, , , True) & ";" & RsS.Value("耕作面積計") & ";" & RsS.Value("郵便番号") & ";" & RsS.Value("農家番号")) & ";" & n & ";" & n
                            Else
                                mvarDic.Add RsS.Key, .Nodes(CStr("行政区." & OID)).Text & "(" & Right("0000" & OID, 4) & ")" & ";" & CStr(RsS.Value("氏名") & ";" & Fnc.GetShortAddress(IIf(IsNull(RsS.Value("住所")), "", RsS.Value("住所")), s都道府県名, s郡部名, , , True) & ";" & RsS.Value("耕作面積計") & ";" & RsS.Value("郵便番号") & ";" & RsS.Value("農家番号")) & ";" & n & ";" & n & ";" & RsS.Value("班名")
                            End If
                        End If
                        .Nodes.Add CStr("行政区." & OID), 4, CStr(RsS.Key), CStr(IIf(IsNull(RsS.Value("氏名")), "", RsS.Value("氏名"))) & "(" & FormatNumber(RsS.Value("耕作面積計"), 0) & "u)", "House", "House"
                        mvarParent.Nodes(CStr("行政区." & OID)).Tag = mvarParent.Nodes(CStr("行政区." & OID)).Tag & RsS.Key & ";"
                    End If
                    RsS.MoveNext
                Loop
                SystemDB.CloseRs RsS

    sBlock = "データ作成2"

                sSQL = "SELECT Sum(耕作農地.登記簿面積) AS 耕作面積計, '世帯.' & [D:世帯Info].ID AS [KEY], [D:個人Info].氏名, [V_続柄].続柄 AS 続柄1, [V_続柄_1].続柄 AS 続柄2, [V_続柄_2].続柄 AS 続柄3, [D:個人Info].生年月日, [D:個人Info].住民区分, [D:個人Info].性別 "
                sSQL = sSQL & "FROM ((SELECT IIf([自小作別]=0,IIF([管理世帯ID]<>0,[管理世帯ID],[所有世帯ID]),[借受世帯ID]) AS 耕作世帯, [D:農地Info].登記簿面積 FROM [D:農地Info]" & sWhere & ") AS 耕作農地 INNER JOIN [D:世帯Info] ON 耕作農地.耕作世帯 = [D:世帯Info].ID) INNER JOIN ((([D:個人Info] INNER JOIN [V_続柄] ON [D:個人Info].続柄1 = [V_続柄].ID) INNER JOIN [V_続柄] AS [V_続柄_1] ON [D:個人Info].続柄2 = [V_続柄_1].ID) INNER JOIN [V_続柄] AS [V_続柄_2] ON [D:個人Info].続柄3 = [V_続柄_2].ID) ON [D:世帯Info].ID = [D:個人Info].世帯ID "
                
                If s市町村名 = "さつま町" Then
                    If SystemDB.DBPropertyEx("前年有権者のみ表示", vbBoolean) Then sSQL = sSQL & "WHERE ((([D:個人Info].選挙権の有無) = True)) "
                Else
                    If SystemDB.DBPropertyEx("前年有権者のみ表示", vbBoolean, False) Then sSQL = sSQL & " WHERE ((([D:個人Info].選挙権の有無) = True)) "
                End If
                
                sSQL = sSQL & "GROUP BY [D:個人Info].氏名, [V_続柄].続柄, [V_続柄_1].続柄, [V_続柄_2].続柄, [D:個人Info].生年月日, [D:個人Info].住民区分, [D:個人Info].性別, [D:世帯Info].ID, [D:個人Info].行政区ID, [V_続柄].ID "
                sSQL = sSQL & "HAVING (((Sum(耕作農地.登記簿面積)) >= 1000) And (([D:個人Info].生年月日) < #4/2/" & IIf(Month(Now) > 6, Year(Now) + 1 - 20, Year(Now) - 20) & "#) And (([D:個人Info].住民区分) = " & SystemDB.DBProperty("記録住民コード") & ") And (([D:世帯Info].ID) > 0) And (([D:個人Info].行政区ID) > 0)) "
                sSQL = sSQL & "ORDER BY [D:世帯Info].ID, [V_続柄].ID"

                Set Rs = SystemDB.GetRecordsetEx(sSQL, , , Me)
                Do Until Rs.EOF
                    If mvarDic.Exists(Rs.Key) Then

    sBlock = "データ追加2:" & Rs.Value("氏名")

                        St = mvarDic.Item(Rs.Key) & vbCrLf & Rs.Value("氏名") & ";" & Replace(Rs.Value("続柄1") & "の" & Rs.Value("続柄2") & "の" & Rs.Value("続柄3"), "の-", "") & ";" & Format(Rs.Value("生年月日"), "GGGEE年MM月DD日") & ";" & IIf(b男女表示, Choose(Rs.Value("性別") + 2, "-", "男", "女"), "")
                        mvarDic.Item(Rs.Key) = St
                    End If
                    Rs.MoveNext
                Loop
                SystemDB.CloseRs Rs

                n = 0
                For Each pNode In .Nodes
                    If Fnc.GetKeyHead(pNode.Key) = "世帯" Then n = n + 1
                Next
                MsgBox "印刷枚数:" & n, vbInformation
            End If
        End With
               If mvarParent.UsedTreeView = True Then mvarParent.DoCommand "不要ノード削除", "行政区"
        Exit Function
    Er_Ext:
        MsgBox "不正なデータの為、印刷を中断します。" & vbCrLf & "ブロック:" & sBlock & vbCrLf & "[" & Err.Description & "]"
    
    End Function
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants
        Select Case Fnc.GetKeyHead(mvarKey)
            Case "行政区": CPrintCls_Orientation = vbPRORPortrait
            Case Else
                Select Case SystemDB.DBProperty("市町村名")
                    Case "枕崎市", "さつま町", "姶良市": CPrintCls_Orientation = vbPRORPortrait
                    Case Else: CPrintCls_Orientation = vbPRORLandscape
                End Select
        End Select
    End Property
    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&): CPrintCls_Repaint: End Sub
    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property
    Private Property Set CPrintCls_Parent(RHS As ADBasicLIB2.CPrintFormSK): Set mvarParent = RHS: End Property

    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        Dim pNode As Object
        Dim nData As Long
        Dim m As Long, n As Long
        
        mvarParent.KillDoc
        
        If b白抜き Then
            m = Val(Fnc.InputText("印刷枚数設定", "印刷枚数を入力してください", 1, m))
            For n = 1 To m
                Select Case s市町村名
                    Case "枕崎市", "さつま町", "姶良市"
                        mvarParent.ChangeLayout vbPRPSA4, vbPRORPortrait
                    Case Else
                        mvarParent.ChangeLayout vbPRPSA4, vbPRORLandscape
                End Select
                PrintSub ""
                mvarParent.EndDoc
            Next
        Else
            If bNowPage Then
                For Each pNode In mvarParent.Nodes
                    If pNode.Checked Then
                        Select Case Fnc.GetKeyHead(pNode.Key)
                            Case "行政区"
                                mvarParent.ChangeLayout vbPRPSA4, vbPRORPortrait
                                mvarParent.PrintPage = 1
                                Do Until Print世帯(pNode.Key, mvarParent.PrintPage - 1)
                                    mvarParent.NewPage
                                Loop
                                mvarParent.EndDoc
                        End Select
                        pNode.Checked = False
                    End If
                Next
            Else
                For Each pNode In mvarParent.Nodes
                    If pNode.Checked Then
                        Select Case Fnc.GetKeyHead(pNode.Key)
                            Case "行政区"
                                mvarParent.ChangeLayout vbPRPSA4, vbPRORPortrait
                                mvarParent.PrintPage = 1
                                Do Until Print世帯(pNode.Key, mvarParent.PrintPage - 1)
                                    mvarParent.NewPage
                                Loop
                                mvarParent.EndDoc
                            Case "世帯"
                                Select Case s市町村名
                                    Case "枕崎市", "さつま町", "姶良市"
                                        mvarParent.ChangeLayout vbPRPSA4, vbPRORPortrait
                                    Case Else
                                        mvarParent.ChangeLayout vbPRPSA4, vbPRORLandscape
                                End Select

                                PrintSub pNode.Key
                                mvarParent.EndDoc
                        End Select
                        
                        pNode.Checked = False
                    End If
                Next
            End If
        End If
    End Sub

    Private Sub CPrintCls_Repaint()
        If b白抜き Then
            PrintSub ""
        Else
            Select Case Fnc.GetKeyHead(mvarKey)
                Case "行政区": Print世帯 mvarKey, mvarParent.Page - 1
                Case "世帯": PrintSub mvarKey
            End Select
        End If
    End Sub
        
    Private Sub PrintSub(Key As String)
        Select Case SystemDB.DBProperty("市町村名")
            Case "枕崎市", "さつま町", "姶良市": PrintSub縦 Key
            Case Else: PrintSub横 Key
        End Select
    End Sub
    
    Private Sub PrintSub縦(sKey As String)
        Dim y As Single
        Dim n As Long
        Dim HH As Single, nPit As Single, Rows As Long
        
        Select Case s市町村名
            Case "枕崎市"
                pY = 0
                Rows = 8: nPit = 8
                mvarParent.Offset 0, 0
                Arr = GetArray(6, 40, 14, 31, 80)
                Ay = GetArray(6, 40, 14, 31, 16, 16, 16, 16, 16)
            Case "さつま町"
                pY = 15
                Rows = 10: nPit = 8
                mvarParent.Offset -6, 0
                Arr = GetArray(6, 38, 14, 30, 15, 75)
                Ay = GetArray(6, 38, 14, 30, 15, 15, 15, 15, 15, 15)
            Case Else
                pY = 20
                Rows = 10: nPit = 8
                mvarParent.Offset -6, 0
                Arr = GetArray(6, 40, 14, 31, 80)
                Ay = GetArray(6, 40, 14, 31, 16, 16, 16, 16, 16)
        End Select
        HH = 27

        SX = 24
        dX(0) = SX
        hX(0) = dX(0) + Ay(0) / 2
        For n = 0 To UBound(Ay)
            dX(n + 1) = dX(n) + Ay(n)
            If n < UBound(Ay) Then hX(n + 1) = dX(n + 1) + Ay(n + 1) / 2
        Next
        
        With mvarParent
            .ClearScreen
            .FontName = "ＭＳ 明朝"
    '-----------------------------表作成
            
            If Len(mvarKey) Then
                sData = Split(mvarDic.Item(sKey), vbCrLf)
                Ar = Split(sData(0), ";")
            End If
            
            Sub_表上 n, SX, SY
            Sub_表下 SX, SY, HH, nPit, Rows
            Sub_表当込 HH, nPit, sKey
            
    '-----------------------------------
    '---------------------------文字埋め
            Select Case s市町村名
                Case "枕崎市"
                    .TextOut "農業委員会委員選挙人名簿登載申請書", (dX(0) + dX(UBound(Ay))) / 2, 63, 14, 2, 2
                    .TextOut "受付年月日　　平成　　　年　　　月　　　日", 91, 73, 11
                    .TextOut s市町村名 & "農業委員会", 27, 83, 11
                    .TextOut "御中", 75, 83, 11
                    .TextOut "住 所", 106, 83, 11
                    .TextOut "[申請者代表]", 99, 87, 11
                    .TextOut "枕崎市選挙管理委員会", 27, 92, 11
                    .TextOut "御中", 75, 92, 11
                    .TextOut "氏 名", 106, 92, 11
                    .TextOut "印", 170, 92, 11
'                    .hTextOut "　農業委員会等に関する法律施行令第３条の規定により、   平成 " & Val(Format(Now(), "EE")) + 1 & "年 1月 1日   現在による農業委員会委員選挙人名簿の登載につき、下記のとおり申請する。", 26, 103, 46
                    .hTextOut "　農業委員会等に関する法律施行令第３条の規定により、   " & Format(s提出日程, "GGG EE") & "年 1月 1日   現在による農業委員会委員選挙人名簿の登載につき、下記のとおり申請する。", 26, 103, 46
                    
                    .hTextOut "世帯主と　の続　柄", dX(2) + 1, SY + 7, 3, 4
                    .TextOut "枕崎市選挙管理委員会　　御中", SX, 229, 11
                    
                    .TextOut "枕崎市農業委員会", 130, 250, 11
                    .DrawText " この申請書を受け付け、内容を審査したところ、本委員会の意見は所定の欄にそれぞれ\n記載した通りである。よって、これを送付する。", 33, 260, dX(9) - dX(0), 5, 11
                    
                    .TextOut "裏面をごらんください", dX(7), 266, 15, 2
                    .DLine dX(7) - 28, 273, dX(7) + 28, 273, 0
                    .TextOut "平成　　年 　月 　日", 40, 235 + pY, 11
                Case "姶良市"
                    .TextOut "農 業 委 員 会 委 員 選 挙 人 名 簿 登 載 申 請 書", (dX(0) + dX(UBound(Ay))) / 2, 26, 18, 2, 2
                    .TextOut s市町村名 & "農業委員会   経由", SX, 36, 11
                    .TextOut s市町村名 & "選挙管理委員会　　御中", SX, 44, 11
                    
                    .TextOut "続 柄", hX(2), SY + (HH / 2), 11, 2, 2
'                    .DrawText "　農業委員会等に関する法律施行令第３条の規定により、平成 " & Val(Format(Now(), "EE")) + 1 & " 年 1 月 1 日現在による\n農業委員会委員選挙人名簿の登載につき、下記のとおり申請する。", 25, 70 + pY, (dX(9 - (s市町村名 = "さつま町")) - dX(0)) + 10, 5, 11
                    .DrawText "　農業委員会等に関する法律施行令第３条の規定により、" & Format(s提出日程, "GGG EE") & " 年 1 月 1 日現在による\n農業委員会委員選挙人名簿の登載につき、下記のとおり申請する。", 25, 70 + pY, (dX(9 - (s市町村名 = "さつま町")) - dX(0)) + 10, 5, 11
                    
                    .TextOut s市町村名 & "選挙管理委員会　　御中", SX, EY + 10, 13
                    .TextOut s市町村名 & "農業委員会会長　" & s会長名 & "    印", dX(4) - 10, 241 + pY, 11
                    
                    If b提出日 And Len(s提出日程) Then
                        .TextOut Format(s提出日程, "GGG EE 年 M 月 D 日"), 40, 235 + pY, 12
                    Else
                        .TextOut "平成    年    月    日", 40, 235 + pY, 12
                    End If
                    .DrawText " この申請書を受け付け内容を審査したところ、本委員会の意見は所定の欄にそれぞれ記載した\nとおりである。よってこれを送付する。", (SX + dX(0)) / 2, 252 + pY, dX(9) - dX(0) + 10, 8, 11
                Case Else
                    .TextOut "農 業 委 員 会 委 員 選 挙 人 名 簿 登 載 申 請 書", (dX(0) + dX(UBound(Ay))) / 2, 26, 18, 2, 2
                    .TextOut s市町村名 & "農業委員会   経由", SX, 36, 11
                    .TextOut s市町村名 & "選挙管理委員会　　御中", SX, 44, 11
                    
                    .TextOut "続 柄", hX(2), SY + (HH / 2), 11, 2, 2
'                    .DrawText "　農業委員会等に関する法律施行令第３条の規定により、平成 " & Val(Format(Now(), "EE")) + 1 & " 年 1 月 1 日現在による\n農業委員会委員選挙人名簿の登載につき、下記の通り申請する。", 25, 70 + pY, (dX(9 - (s市町村名 = "さつま町")) - dX(0)) + 10, 5, 11
                    .DrawText "　農業委員会等に関する法律施行令第３条の規定により、" & Format(s提出日程, "GGG EE") & " 年 1 月 1 日現在による\n農業委員会委員選挙人名簿の登載につき、下記の通り申請する。", 25, 70 + pY, (dX(9 - (s市町村名 = "さつま町")) - dX(0)) + 10, 5, 11
                    
                    .TextOut s市町村名 & "選挙管理委員会　　御中", SX, EY + 10, 13
                    .TextOut s市町村名 & "農業委員会             印", dX(9) - 2, 241 + pY, 11, 1
                    
                    .DrawText " この申請書を受け付け内容を審査したところ、本委員会の意見は所定の欄にそれぞれ記載した\n通りである。よってこれを送付する。", (SX + dX(0)) / 2, 252 + pY, dX(9) - dX(0) + 10, 8, 11
                    .TextOut "平成　　年 　月 　日", 40, 235 + pY, 11
            End Select
            
    '-----------------------------------
            SY = SY + HH + (nPit / 2)
            For y = 0 To Rows - 1
                .TextOut (y + 1), hX(0), SY + y * 8, 11, 2, 2
                For n = 0 To 4
                    .TextOut "※", dX(4 + n - (s市町村名 = "さつま町")) + 1, SY + y * 8, 11, , 2
                Next
            Next
        End With
    End Sub

    Private Sub PrintSub横(ByVal sKey As String)
        Dim x As Single, X1 As Single, X2 As Single, y As Single, Y1 As Single
        Dim m As Single, n As Single                            'm→ループ横 n→ループ縦
        Dim nPit As Single, HH As Single, Rows As Long          'DX1個目
        Dim Flg As String
        Dim Ar As Variant, Cm As Variant
        Dim j As Single
        Dim SY As Single, EY As Single
        Dim nX As Long
        Dim hPit As Single
        Dim nF As Integer
        
        With mvarParent
            .ClearScreen
            .Offset 0, 0
            
            SX = 28: Y1 = 0: HH = 11: Rows = 8: nPit = 11: SY = 78
            Select Case s市町村名
                Case "北郷町", "都城市":
                    X1 = 0: X2 = 110
                    hPit = 19.5
                    nF = 10
                    Ay = GetArray(16, 8, 40, 16, 41, 16, hPit, hPit, hPit, hPit, hPit)
                Case "阿久根市"
                    SX = SX - 4
                    X1 = 150: X2 = -10: nX = 2
                    hPit = 19
                    nF = 9
'                    Ay = GetArray(16, 8, 40, 16, 41, 20, 19.5, 19.5, 19.5, 19.5, 19.5)
                    Ay = GetArray(16, 8, 40, 16, 41, 44, hPit, hPit, hPit, hPit, hPit)
                Case Else
                    X1 = 150: X2 = -10
                    hPit = 19.5
                    nF = 10
                    Ay = GetArray(16, 8, 40, 16, 41, 16, hPit, hPit, hPit, hPit, hPit)
            End Select
            EY = SY + HH + Rows * nPit
    '-----------------------------------
            dX(0) = SX
            hX(0) = dX(0) + Ay(0) / 2
            For n = 0 To UBound(Ay)
                dX(n + 1) = dX(n) + Ay(n)
                If n < UBound(Ay) Then hX(n + 1) = dX(n + 1) + Ay(n + 1) / 2
            Next
    '-----------------------------表作成
            If s市町村名 <> "阿久根市" Then
                .LineBox dX(0), 62, dX(11), 76, , , 116, 7          '真中の表
                .DBox dX(0) + 116, 62, dX(11), 69, , 12             '真中の表太線
                .LineBoxDX dX(0) + 16, SY, HH, Rows, nPit, GetArray(8, 40, 16, 41, 16)  '番号→生年月日
                .DBox dX(0), SY, dX(6), EY, , CInt(n太枠)                               '下の表太線
            Else
                .Bold = True
                .TextOut "※太線枠内を必ず記入してください。（別紙記載注意事項参照）", dX(0), 60, 10, 0, 1
                .Bold = False
                .LineBox dX(0), 62, dX(0) + 190, 76, , , 116, 7        '真中の表
                .DBox dX(0), 62, dX(0) + 116, 69, , 12            '真中の表太線
                .DBox dX(0) + 116, 62, dX(0) + 190, 69, , 12           '真中の表太線
                .LineBoxDX dX(0) + 16, SY, HH, Rows, nPit, GetArray(8, 40, 16, 41, 44)  '番号→生年月日
                .DBox dX(5) + 9, SY, dX(6), EY, , CInt(n太枠)                           '下の表太線
            End If
            .LineBox dX(0), SY, dX(1), EY                                               '表の一番左
            .LineBox dX(6), SY, dX(11), SY + 4                                          '選挙権有無
            .LineBox dX(7), SY + 4, dX(11), SY + 7.5                                    '選挙権なし
            .LineBox dX(7), SY + 7.5, dX(8), SY + 11, 4                                 '満20才→欠格
            
            .LineXY dX(6), SY + 11, 5, 8, nPit, hPit                                    '選挙権有無の下の大きさの同じ表
    '----------------------------文字埋め
            .TextOut s本人, 87 + x, 63.5, 12, 2
            .TextOut "農   業   委   員   会   認   定   面   積　　", 87, 70.5, 12, 2
            
            If s市町村名 <> "阿久根市" Then
                .TextOut "平方メートル", 260, 63.5, 12, 1
                .TextOut "平方メートル", 260, 70.5, 12, 1
                .TextOut "アール", 190, 63.5, 12
                .TextOut "アール", 190, 70.5, 12
                .TextOut "性　別", hX(5), SY + (HH / 2), 11, 2, 2
            Else
                .TextOut "アール", dX(7), 63.5, 12, 1
                .TextOut "※", dX(5), 70.5, 12, 2
                .TextOut "アール", dX(7), 70.5, 12, 1
                .TextOut "性別", dX(5) + 0.5, SY + (HH / 2), 11, 0, 2
                .hTextOut "耕作経営主に○印", dX(5) + 10, SY + 1.5, 4, 3.5, 10
                .hTextOut "耕作従事日数　(１年間)", dX(5) + 25.5, SY + 2.5, 6, 3.5, 8
                .DLine dX(5) + 9, SY, dX(5) + 9, EY, vbBlack
                .DLine dX(5) + 25, SY, dX(5) + 25, EY, vbBlack
            End If
            
            .hTextOut "番号", dX(1) + 2, SY + 0.5, 1, 6, 11
            .TextOut "氏　　　　　　名", hX(2), SY + (nPit / 2), 11, 2, 2
            .hTextOut "世帯主と　の続　柄", dX(3) + 2, SY + 0.2, 3, 3.5, 11
            .TextOut "生　年　月　日", hX(4), SY + (nPit / 2), 11, 2, 2
            
            
            .TextOut "選挙権の有無についての農業委員会の意見", dX(6) + (dX(11) - dX(6)) / 2, SY, 11, 2
            .hTextOut "選 挙 権 あ    り", dX(6) + 3, SY + 4.2, 6, , nF
            .TextOut "選　挙　権　な　し", dX(7) + (dX(11) - dX(7)) / 2, SY + 4.2, nF, 2
            .TextOut "満20年未満", hX(7), SY + 7.5, nF, 2
            .TextOut "耕作従事日数", hX(8), SY + 8, nF - 1, 2
            .TextOut "同居せず", hX(9), SY + 7.5, nF, 2
            .TextOut "欠　　格", hX(10), SY + 7.5, nF, 2
            .TextOut s市町村名 & " 選 挙 管 理 委 員 会   御 中", 29.5, 178, 14
            
            If b提出日 And Len(s提出日程) Then
                .TextOut Format(s提出日程, "GGG EE 年 M 月 D 日"), 53, 184, 12
            Else
                .TextOut "平成    年    月    日", 53, 184, 12
            End If
            .TextOut s市町村名 & "農業委員会  会長    " & s会長名, 150, 183, 12
            
            .TextOut "印", 254, 185, 10, 2, 2
            .DBox 252, 183, 256, 187
            .TextOut "この申請を受け付け、内容を審査したところ、本委員会の意見は所定の欄にそれぞれ記載したとおりである。よって、これを送付する。", 28, 189, 9
            .hTextOut "世帯員中農業委員会委員の選挙権を", dX(0) + 3, 93, 1
            .hTextOut "有する者の氏名・生年月日等", dX(0) + 9, 93, 1
    '-----------------------------------
            .TextOut "農 業 委 員 会 委 員 選 挙 人 名 簿 登 載 申 請 書", 30, 11, 14
            .DLine 29, 16.5, 159, 16.5, vbBlack     '下線
            
            .TextOut s裏面, 262, 12, 12, 1
            .DBox 18 + X1, 23, 120 + X1, 55, , CInt(n太枠)   '上の表太線
            .TextOut "受付年月日　　※　　平成　　　年　　月　　日", 30 + X1, 18, 11
            
            If s市町村名 <> "阿久根市" Then
                .TextOut "〒", 20 + X1, 25, 12
                .TextOut "※印は農業委員会にて記入", 200, 178, 11
            Else
                .TextOut "区名", 20 + X1, 25, 12
                .TextOut "※印は農業委員会にて記入", dX(11) - 1, 73, 11, 1
            End If
            
            .TextOut "住所", 20 + X1, 35, 12
            .TextOut "氏名", 20 + X1, 45, 12
            .TextOut "印", 110 + X1, 45.1, 9
            
            .TextOut "(" & s市町村名 & "農業委員会経由)", 25 + X2, 24, 11
            .TextOut s市町村名 & "選挙管理委員会 御中", 25 + X2, 30, 11
    '            .DrawText "　農業委員会等に関する法律施行令第３条の規定により、平成 " & Val(Format(Now(), "EE")) + 1 & "年 1月 1日現在\nによる農業委員会委員選挙人名簿の登載につき､下記のとおり申請する｡", 21 + X2, 39, 155, 5, 11
            .DrawText "　農業委員会等に関する法律施行令第３条の規定により、" & Format(s提出日程, "GGG EE") & "年 1月 1日現在\nによる農業委員会委員選挙人名簿の登載につき､下記のとおり申請する｡", 21 + X2, 39, 155, 5, 11
    '-----------------------------------
    '----------------------------データはめ込み用の文字位置
            If b白抜き Then
                For n = 0 To 7
                    y = n * nPit
                    
                    If s市町村名 = "阿久根市" Then
                        .TextOut CStr(n + 1), dX(2) - 1, SY + HH + (nPit / 2) + y, 11, 1          '文字埋め(番号)
                        .DrawText "明治大正昭和", dX(4) + 1, 89.5 + y, 8, 3.4, 10   '文字埋め(生年月日)
                        .TextOut "年   月   日", dX(5) - 1, 93 + y, 11, 1
                        For m = 0 To 4
                            x = m * hPit
                            .TextOut "※", dX(6) + x, SY + HH + 7 + y + Y1, 11
                        Next
                        
                        .TextBox "日", dX(5), SY + HH + y, dX(6), SY + HH + nPit + y, 11, 1, 1
                    Else
                        .TextOut CStr(n + 1), 51, SY + HH + (nPit / 2) + y, 11, 1             '文字埋め(番号)
                        .TextOut "※", 149, 71, 11, 2
                        .DrawText "明治大正昭和", 108.5, 89.5 + y, 8, 3.4, 10     '文字埋め(生年月日)
                        .TextOut "年   月   日", 148, 93 + y, 11, 1
                        For m = 0 To 4
                            x = m * hPit
                            .TextOut "※", dX(6) + x, SY + HH + 8 + y + Y1, 11
                        Next
                    End If
                Next
            Else
                Ar = Split(mvarDic.Item(sKey), vbCrLf)
                Cm = Split(Ar(0), ";")
                
                If s市町村名 <> "阿久根市" Then
                    .TextOut Cm(4), 40 + X1, 25, 12
                Else
                    .TextOut Cm(8), 40 + X1, 25, 12
                End If
                .TextOut Fnc.GetShortAddress(IIf(IsNull(Cm(2)), "", Cm(2)), s都道府県名, s郡部名, , , False), 40 + X1, 35, 12
                If s市町村名 <> "阿久根市" Then
                    .TextOut Cm(1) & "(" & Right$("00000" & Cm(5), 5) & ")", 40 + X1, 45, 12
                    .TextOut s名称変更 & ":" & Cm(0), 80 + X1, 57, 11     '集落名
                Else
                    .TextOut Cm(1), 40 + X1, 45, 12
                End If
                
                If b認定面積 Then
                    .TextOut FormatNumber(Fix(Int(Val(Cm(3))) / 100), 0), 185, 70.5, 12, 1    '認定(e)
                    .TextOut FormatNumber((Int(Val(Cm(3))) Mod 100), 0), 230, 70.5, 12, 1     '認定(u)
                End If
                For n = 0 To 7
                    If b世帯員 = True Then
                        If n + 1 > UBound(Ar) Then Exit For
                        Cm = Split(Ar(n + 1), ";")
                        y = n * nPit
                        
                        For m = 0 To 4
                            x = m * hPit
                            .TextOut "※", dX(6) + x, SY + HH + 7 + y + Y1, 11
                        Next
                    
                        .TextOut CStr(n + 1), dX(2) - 1, SY + HH + (nPit / 2) + y, 11, 1                '文字埋め(番号)
                        .TextOut Cm(0), dX(2) + 1, SY + HH + (nPit / 2) + y, 11                         '文字埋め(氏名)
                        .TextOut Replace(Cm(1), "の-", ""), hX(3), SY + HH + (nPit / 2) + y, 11, 2      '文字埋め(続柄)
                        If b生年月日表示 Then
                            .TextOut Cm(2), hX(4), SY + HH + (nPit / 2) + y, 11, 2                      '文字埋め(生年月日)
                        Else
                            .DrawText "明治大正昭和", dX(4) + 0.5, 89.5 + y, 8, 3.4, 10                 '文字埋め(生年月日)
                            .TextOut "年   月   日", dX(5) - 1, 93 + y, 11, 1
                        End If
                        If s市町村名 = "阿久根市" Then
                            .TextOut "日", dX(6) - 2, SY + HH + (nPit / 2) + y, 11, 2
                            .TextOut Cm(3), dX(5) + 4.5, SY + HH + (nPit / 2) + y, 11, 2                '文字埋め(性別)
                        Else
                            .TextOut Cm(3), dX(5) + 2, SY + HH + (nPit / 2) + y, 11, 2                  '文字埋め(性別)
                        End If
                    Else
                        y = n * 11
                        
                        .TextOut CStr(n + 1), dX(2) - 1, 92.5 + y, 11, 1                                '文字埋め(番号)
                        For m = 0 To 4
                            x = m * hPit
                            .TextOut "※", dX(6) + x, 96 + y, 11
                        Next
                        
'                        .TextOut "性　別", 157, 82.5, 11, 2
                    End If
                Next
            End If
        End With
    End Sub

    Private Function Print世帯(ByVal sKey As String, Optional nPage As Long = 0) As Boolean
        Dim y As Single                         'y→縦用 値格納
        Dim n As Single                         'n→ループ縦
        Dim Ay As Variant
        Dim Ar As Variant, Cm As Variant
        Dim dX(6) As Single, hX(6) As Single
        Dim i As Long
        Dim Rsx As ADBasicLIB2.RecordsetEx
        
        Ay = GetArray(18, 22, 52, 64, 16)
        dX(0) = 24
        hX(0) = dX(0) + Ay(0) / 2
        For i = 0 To UBound(Ay)
            dX(i + 1) = dX(i) + Ay(i)
            If i < UBound(Ay) Then hX(i + 1) = dX(i + 1) + Ay(i + 1) / 2
        Next
        
        Print世帯 = False
        
        Ar = Split(mvarParent.Nodes(sKey).Tag, ";")
        If UBound(Ar) = -1 Then Print世帯 = True: Exit Function
        
        With mvarParent
            .Offset -6, -4
            .ClearScreen
            .FontName = "ＭＳ 明朝"
    '----------------------------文字埋め
            .TextOut s名称変更, 34, 18, 13, 2, 2
            .TextOut "No", hX(0), 30, 13, 2, 2
            .TextOut "農家番号", hX(1), 30, 13, 2, 2
            .TextOut "氏　　　名", hX(2), 30, 13, 2, 2
            .TextOut "住　　　　所", hX(3), 30, 13, 2, 2
            .TextOut "確認", hX(4), 30, 13, 2, 2
            .LineBox dX(0), 14, 86, 22, 1, 1, 20        '自治会の枠
    '-----------------------------------
    '-----------------------------表作成
            .LineBoxDX dX(0), 26, 9, 50, 5, Ay
    '-----------------------------------
    '---------------------------データはめ込み用の文字位置
            .TextOut .Nodes(sKey).Text, 46, 16, 11  '自治会の横の項目
            For n = 0 To 49
                y = n * 5
                If UBound(Ar) <= nPage * 50 + n Then Print世帯 = True: Exit For
                Cm = Split(mvarDic.Item(Ar(nPage * 50 + n)), ";")

                .TextOut (nPage * 50 + n + 1), dX(1) - 1, 35.5 + y, 12, 1      'ナンバー
                .TextOut Right$("    " & Cm(5), 5), dX(2) - 1, 35.5 + y, 12, 1 '農家番号
                .TextOut Cm(1), dX(2) + 1, 35.5 + y, 12     '氏名
                .TextOut Cm(2), dX(3) + 1, 35.5 + y, 12     '住所
            Next
            If UBound(Ar) <= nPage * 50 + n Then Print世帯 = True
    '-----------------------------------
            .TextOut "Page: " & nPage + 1 & " / " & IIf(UBound(Ar) Mod 50 > 0, Fix(UBound(Ar) / 50) + 1, UBound(Ar) / 50), 174, 14, 12, 0, 2
            .TextOut "世帯数:" & UBound(Ar), 92, 18, 12, 0, 2
        End With
    End Function
    Private Sub Sub_表上(n As Long, SX As Single, SY As Single)
        Dim x As Single
        
        Select Case s市町村名
            Case "枕崎市": SY = 113
            Case Else: SY = 82 + pY
        End Select
        
        With mvarParent
            .LineBox SX, SY, dX(n), SY + 16, , , 72, 8          '一番上の枠
            .DBox SX + 72, SY, dX(UBound(Ay) + 1), SY + 8, , CInt(n太枠)   '太線
            
            .TextOut "耕    作    面    積", 60, SY + 2, 11, 2
            
            Select Case s市町村名
                Case "枕崎市": x = 0
                    .TextOut "アール        平方メートル", 128, SY + 2, 11
                    .TextOut "アール        平方メートル", 128, SY + 10, 11
                Case Else: x = 0
                    .TextOut "アール        平方メートル", 128, SY + 2, 11
                    .TextOut "アール        平方メートル", 128, SY + 10, 11
            End Select
            
            If b認定面積 Then
                .TextOut Fix(Val(Ar(3)) / 100), 127 - x, SY + 10, 11, 1
                .TextOut (Round(Val(Ar(3)), 0) Mod 100), 156 - x, SY + 10, 11, 1
            End If
            
            .TextOut "農 業 委 員 会 認 定 面 積", 60, SY + 10, 11, 2
        End With
    End Sub
    
    Private Sub Sub_表下(SX As Single, SY As Single, HH As Single, nPit As Single, Rows As Long)
        Dim x As Single, y As Single, YY As Single
        Dim n As Long
        
        Select Case s市町村名
            Case "枕崎市": SY = SY + 18
            Case Else: SY = SY + 24
        End Select
        
        EY = SY + (HH + Rows * nPit)
        
        With mvarParent
            .LineBoxDX dX(0), SY, HH, 0, nPit, Arr
            .DBox dX(4 - (s市町村名 = "さつま町")), SY + 11, dX(5 - (s市町村名 = "さつま町")), SY + HH
            .DBox dX(5 - (s市町村名 = "さつま町")), SY + 11, dX(9 - (s市町村名 = "さつま町")), SY + 17
            .DBox dX(1), SY + HH, dX(4 - (s市町村名 = "さつま町")), EY, vbBlack, CInt(n太枠)
            
            .hTextOut "番 号", dX(0) + 1, SY + 7, 1, Val(Ay(0))
            .TextOut "氏       名", hX(1), SY + (HH / 2), 11, 2, 2
            Select Case s市町村名
                Case "さつま町"
                    .DrawText "耕作従事日数", dX(4), SY, dX(5) - dX(4), 4, 11, 2, 2, HH
                Case Else
            End Select
            .TextOut "生年月日", hX(3), SY + (HH / 2), 11, 2, 2
            .TextOut "選 挙 権 な し", (dX(5 - (s市町村名 = "さつま町")) + dX(9 - (s市町村名 = "さつま町"))) / 2, SY + 12, 11, 2
            .hTextOut "選挙権あ　り", dX(4 - (s市町村名 = "さつま町")) + 2, SY + 14, 3, 6
            .hTextOut "満20歳未  満", dX(5 - (s市町村名 = "さつま町")) + 2, SY + 18, 4, , 11
            .hTextOut "耕作従事日数", dX(6 - (s市町村名 = "さつま町")) + 2, SY + 18, 3, , 11
            .hTextOut "同居せず", dX(7 - (s市町村名 = "さつま町")) + 4, SY + 18, 2, , 11
            .TextOut "欠格", hX(8 - (s市町村名 = "さつま町")), SY + 20, 11, 2
            
            For n = 0 To 9
                x = n * 6.3
                .TextOut MID("選挙権の有無について", n + 1, 1), dX(4 - (s市町村名 = "さつま町")) + 10 + x, SY + 1, 11
            Next
            For n = 0 To 7
                x = n * 8
                .TextOut MID("農業委員会の意見", n + 1, 1), dX(4 - (s市町村名 = "さつま町")) + 10 + x, SY + 6, 11
            Next
            
            .LineBoxDX dX(0), SY + HH, 0, Rows, nPit, Ay
            .DLine dX(6 - (s市町村名 = "さつま町")), SY + 17, dX(6 - (s市町村名 = "さつま町")), SY + HH
            .DLine dX(7 - (s市町村名 = "さつま町")), SY + 17, dX(7 - (s市町村名 = "さつま町")), SY + HH
            .DLine dX(8 - (s市町村名 = "さつま町")), SY + 17, dX(8 - (s市町村名 = "さつま町")), SY + HH
            
            YY = SY + 4
            
        End With
    End Sub
    
    Private Sub Sub_表当込(HH As Single, nPit As Single, sKey As String)
        Dim y As Single, YY As Single
        Dim i As Integer, nY As Integer
        Dim Ad As Variant
        Dim sAddr As String
        
        With mvarParent
            If Len(mvarKey) Then
                
                Select Case s市町村名
                    Case "枕崎市":
                        If Len(Ar(4)) > 3 And InStr(Ar(4), "-") = 0 Then
                            Ar(4) = Left(Ar(4), 3) & "-" & MID(Ar(4), 4)
                        End If
                        .TextOut Ar(4), 32, 10.5, 12
                        .TextOut StrConv(Ar(2), 8), 32, 15, 14
                        .TextOut Ar(1) & "  様", 40, 28, 15
                        .TextOut s名称変更 & "名: " & Ar(0), 132, 36, 14
                        .TextOut "農家番号: " & Ar(5), 132, 42, 14
                    Case "姶良市":
'                        .TextOut "〒" & Ar(4), dX(5), 46, 11
'                        .TextOut StrConv(Ar(2), 8), dX(5), 54, 11
'                        .TextOut Ar(1) & "　 様", dX(5), 62, 11
'                        .TextOut s名称変更 & " " & Ar(0), dX(1), 70, 11
'                        .TextOut "申請者代表 ", dX(1), 78, 11
'                        .TextOut "印", dX(4), 78, 11, 2
'                        .DLine dX(1), 82, dX(4), 82, , 8
                    
                        .TextOut "〒" & Ar(4), dX(5), 46, 11
                        sAddr = StrConv(Ar(2), 8)
                        nY = 54
                        Ad = Split(sAddr, " ")
                        For i = 0 To UBound(Ad)
                            .TextOut Ad(i), dX(5), nY, 11
                            nY = nY + 8
                        Next
                        
                        .TextOut Ar(1) & "　 様", dX(5), nY, 11
                        .TextOut s名称変更 & " " & Ar(0), dX(1), 65, 11
                        .TextOut "申請者代表 ", dX(1), 73, 11
                        .TextOut "印", dX(4), 73, 11, 2
                        .DLine dX(1), 77, dX(4), 77, , 8
                        .TextOut "電話番号 (                  ) ", dX(1), 80, 11
                    
                    
                    Case Else:
                        .TextOut s名称変更 & "   " & Ar(0), dX(4), 44, 11
                        .TextOut "住　所   " & StrConv(Ar(2), 8), dX(4), 52, 11
                        .TextOut "氏  名   " & Ar(1), dX(4), 60, 11
                        .TextOut "印", dX(9), 60, 11, 1
                End Select
                
                For y = 1 To UBound(sData)
                    Ar = Split(sData(y), ";")
                    If b世帯員 = True Then
                        .TextOut Ar(0), dX(1) + 1, SY + HH + (nPit / 2) + (y - 1) * 8, 11, , 2
                        .TextOut Replace(Ar(1), "の-", ""), hX(2), SY + HH + (nPit / 2) + (y - 1) * 8, 10, 2, 2
                        .TextOut Format(CDate(Ar(2)), "GGGEE年MM月DD日"), hX(3), SY + HH + (nPit / 2) + (y - 1) * 8, 10, 2, 2
                    End If
                Next
            Else
                Select Case s市町村名
                    Case "姶良市":
                        .TextOut s名称変更, dX(1), 65, 11
                        .TextOut "申請者代表 ", dX(1), 73, 11
                        .TextOut "印", dX(4), 73, 11, 2
                        .DLine dX(1), 77, dX(4), 77, , 8
                        .TextOut "電話番号 (                  ) ", dX(1), 80, 11
                End Select
            End If
        End With
    End Sub
    
    Private Sub CPrintCls_TargetChange(sKey As String)
        If Not b白抜き Then
            mvarKey = sKey
            Select Case Fnc.GetKeyHead(mvarKey)
                Case "行政区":
                    Dim Ar As Variant
                    Ar = Split(mvarParent.Nodes(sKey).Tag, ";")
                    mvarParent.MaxPage = Fix(UBound(Ar) / 50) - ((UBound(Ar) Mod 50) > 0)
                Case "世帯":
                    Ar = Split(mvarParent.Nodes(sKey).Parent.Key, ";")
            End Select
        End If
        CPrintCls_Repaint
    End Sub

End Class










Class C選挙人名簿
    Option Explicit
    Implements ADBasicLIB2.CPrintCls
    Private mvarParent As CPrintFormSK
    Private mvarKey As String
    
    Private Property Get CPrintCls_CanCancelPrint() As Boolean

    End Property

    Private Property Get CPrintCls_CanPrintNowPage() As Boolean

    End Property

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim St As String
        Dim Sr As String
        Dim SX As String
        Dim Ar As Variant
        Dim n As Long
        Dim i As Long
        Dim pNode As Object
        Dim sSQL As String
        Dim GID As Long
        Dim SID As Long
        Dim sAddr As String
        Dim SArea As String
        Dim SCount As Long
        Dim KCount As Long
        Dim ErrorPos As String
        Dim Cm As Variant
        Dim Va As Variant
        Dim Vd As Variant
        Dim bUpdate As Boolean
        
        With mvarParent
            .表示倍率 = 0.75
            .UsedTreeView = True
            bUpdate = False
            
            bUpdate = (MsgBox("名簿番号を更新しますか", vbYesNo) = vbYes)
            
            .Nodes.Add , , "選挙人名簿.0", "選挙人名簿", "CloseFolder", "CloseFolder"
            ErrorPos = "投票区情報"
            St = SystemDB.DBProperty("投票区情報")
            If Len(St) = 0 Then MsgBox "投票区情報がおかしいです."
            Ar = Split(St, ";")
            For n = 0 To UBound(Ar)
                .Nodes.Add "選挙人名簿.0", 4, "分冊." & CStr(Ar(n)), CStr(Ar(n)), "CloseFolder"
            Next
        
            ErrorPos = "投票区別公民館"
            St = SystemDB.DBProperty("投票区別公民館")
            If Len(St) = 0 Then MsgBox "投票区別公民館情報がおかしいです."
            Ar = Split(St, ";")
            For n = 0 To UBound(Ar)
                .Nodes.Add "分冊." & CStr(MID$(Ar(n), InStr(Ar(n), ",") + 1)), 4, "行政区." & CStr(Left$(Ar(n), InStr(Ar(n), ",") - 1)), "", "CloseFolder"
            Next
        
            ErrorPos = "行政区振り分け"
            Set Rs = SystemDB.GetRecordsetEx("SELECT * FROM [S_FOLDER] WHERE [CLASS]='行政区'", , , Me)
            Do Until Rs.EOF
                For Each pNode In .Nodes
                    If pNode.Key = Rs.Value("Key") Then
                        pNode.Text = Rs.Value("名称")
                        pNode.Tag = Rs.Value("名称")
                    End If
                Next
                Rs.MoveNext
            Loop
            SystemDB.CloseRs Rs
            
            Set Rs = SystemDB.GetRecordsetEx("SELECT * FROM [M_BASICALL] WHERE [CLASS]='大字'", , , Me)
            sSQL = SystemDB.DataString(Rs, "名称", ";")
            SystemDB.CloseRs Rs
            
            Ar = Split(sSQL, ";")
            St = SystemDB.DBProperty("市町村名")
            Set Rs = SystemDB.GetRecordsetEx("SELECT [D:個人Info].住所, [D:世帯Info].ソート用住所 FROM [D:世帯Info] INNER JOIN [D:個人Info] ON [D:世帯Info].ID = [D:個人Info].世帯ID WHERE ((([D:個人Info].選挙権の有無)=True));", , , Me)
            Do Until Rs.EOF
                Sr = Rs.Value("住所")
                SX = ""
                If Left$(Sr, Len(St)) = St Then Sr = MID$(Sr, Len(St) + 1)
                For n = 0 To UBound(Ar)
                    If Left$(Sr, Len(Ar(n))) = Ar(n) And IsNumeric(StrConv(MID$(Sr, Len(Ar(n)) + 1, 1), vbNarrow)) Then
                        SX = Ar(n)
                        Sr = MID$(Sr, Len(Ar(n)) + 1)
                        Exit For
                    End If
                Next
                
                If SX = "" Then
                    'Debug.Assert False
                Else
                    Sr = StrConv(Sr, vbNarrow)
                    Sr = Replace(Sr, "番地", "-")
                    Sr = Replace(Sr, "の", "-")
                    Sr = Replace(Sr, "--", "-")
                    Sr = Left$(Sr, Len(Sr) + (Right$(Sr, 1) = "-"))
                    If InStr(Sr, "-") Then
                        If Val(MID$(Sr, InStr(Sr, "-") + 1)) > 0 Then
                            Rs.Update "ソート用住所", SX & Right$("00000" & Val(Sr), 6) & "-" & Right$("00000" & Val(MID$(Sr, InStr(Sr, "-") + 1)), 6)
                        Else
                            Rs.Update "ソート用住所", SX & Right$("00000" & Val(Sr), 6)
                        End If
                    Else
                        Rs.Update "ソート用住所", SX & Right$("00000" & Val(Sr), 6)
                    End If
                End If
                Rs.MoveNext
            Loop
            Rs.CloseRs
            
            ErrorPos = "個人の振り分け;レコードセットの作成"
            sSQL = "SELECT [D:世帯Info].ID,[D:個人Info].性別,[D:個人Info].ID AS [個人ID], '世帯員.' & [D:個人Info].ID AS [KEY], [D:世帯Info].農家番号, [D:個人Info].氏名, [V_続柄].続柄 AS 続柄1, [V_続柄_1].続柄 AS 続柄2, [V_続柄_2].続柄 AS 続柄3, [D:個人Info].生年月日, [D:個人Info].住民区分, [D:個人Info].行政区ID, [D:個人Info_1].フリガナ, [D:個人Info].住所, [田合計]+[畑合計] AS 経営面積 ,ソート用住所" & _
            " FROM (([D:世帯Info] INNER JOIN ((([D:個人Info] INNER JOIN [V_続柄] ON [D:個人Info].続柄1 = [V_続柄].ID) INNER JOIN [V_続柄] AS [V_続柄_1] ON [D:個人Info].続柄2 = [V_続柄_1].ID) INNER JOIN [V_続柄] AS [V_続柄_2] ON [D:個人Info].続柄3 = [V_続柄_2].ID) ON [D:世帯Info].ID = [D:個人Info].世帯ID) INNER JOIN [D:個人Info] AS [D:個人Info_1] ON [D:世帯Info].世帯主ID = [D:個人Info_1].ID) LEFT JOIN V_経営世帯 ON [D:世帯Info].ID = V_経営世帯.耕作世帯ID" & _
            " WHERE ((([D:個人Info].選挙権の有無)=True))" & _
            " GROUP BY ソート用住所,[D:世帯Info].ID, [D:個人Info].住所, [D:個人Info].性別, [D:世帯Info].農家番号, [D:個人Info].氏名, [V_続柄].続柄, [V_続柄_1].続柄, [V_続柄_2].続柄, [D:個人Info].生年月日, [D:個人Info].住民区分, [D:個人Info].行政区ID, [D:個人Info_1].フリガナ, [D:個人Info].住所, [D:個人Info].ID, [V_続柄].ID, [田合計]+[畑合計]" & _
            " HAVING ((([D:世帯Info].ID)>0) AND (([D:個人Info].生年月日)<#4/2/" & IIf(Month(Now) > 6, Year(Now) - 19, Year(Now) - 20) & "#) AND (([D:個人Info].住民区分) In (0)) AND (([D:個人Info].行政区ID)>0))" & _
            " ORDER BY [D:個人Info].行政区ID, [D:世帯Info].ソート用住所, [D:世帯Info].ID, [V_続柄].ID, [D:個人Info].生年月日;"

            Set Rs = SystemDB.GetRecordsetEx(sSQL, , , Me)
            If bUpdate Then SystemDB.ExecuteSQL "Update [D:個人Info] SET [投票区]=Null,[頁番号]=Null,[整理番号]=Null"
            SCount = 1
            KCount = 0
            GID = 0
            SID = 0
            
            Do Until Rs.EOF
                ErrorPos = "個人の振り分け:世帯=[" & Rs.Value("ID") & "]"
                
                sAddr = ""
                SArea = ""
                Set pNode = .Nodes("行政区." & Rs.Value("行政区ID"))
                If Rs.Value("行政区ID") = GID Then
                Else
                    If GID > 0 Then
                        .Nodes("行政区." & GID).Tag = Fix(KCount / 25) + 1 & ";" & SCount & ";" & KCount & ";" & .Nodes("行政区." & GID).Tag
                    End If
                    SID = Rs.Value("ID")
                    GID = Rs.Value("行政区ID")
                    sAddr = IIf(Rs.IsNull("住所"), "", MID$(Rs.Value("住所"), 4))
                    SArea = Rs.NullCast("経営面積", "")
                    SCount = 1
                    KCount = 0
                End If
                
                If Rs.Value("ID") = SID Then
                Else
                    SID = Rs.Value("ID")
                    sAddr = IIf(Rs.IsNull("住所"), "", MID$(Rs.Value("住所"), 4))
                    SArea = Rs.NullCast("経営面積", 0)
                    SCount = SCount + 1
                End If
                
                KCount = KCount + 1
                If Rs.IsNull("氏名") Then MsgBox "氏名のはいっていない住民情報があります"
                
                pNode.Tag = pNode.Tag & vbCrLf & SCount
                pNode.Tag = pNode.Tag & ";" & KCount
                pNode.Tag = pNode.Tag & ";" & sAddr
                pNode.Tag = pNode.Tag & ";" & Trim(Rs.Value("氏名"))
                Sr = Rs.Value("続柄1") & "の" & Rs.Value("続柄2") & "の" & Rs.Value("続柄3")
                Sr = Replace(Sr, "の-", "")
                If bUpdate Then SystemDB.ExecuteSQL "UPDATE [D:個人Info] SET [投票区]=" & Val(pNode.Parent.Text) & " WHERE [ID]=" & Rs.V("個人ID")
                pNode.Tag = pNode.Tag & ";" & Sr & ";" & Format(Rs.Value("生年月日"), "GGGEE年MM月DD日") & ";" & SArea & ";" & Rs.V("個人ID")
                Rs.MoveNext
            Loop
            If KCount > 0 Then
                .Nodes("行政区." & GID).Tag = Fix(KCount / 25) + 1 & ";" & SCount & ";" & KCount & ";" & .Nodes("行政区." & GID).Tag
            End If
            SystemDB.CloseRs Rs
            
            n = 0
            SCount = 0
            KCount = 0
            SID = 0
            For Each pNode In .Nodes
                Select Case Fnc.GetKeyHead(pNode.Key)
                    Case "分冊":
                    Case "選挙人名簿"
                    Case Else
                        Ar = Split(pNode.Tag, ";")
                        If SID = Fnc.GetKeyCode(pNode.Parent.Key) Then
                            
                        Else
                            SCount = 0
                            KCount = 0
                            
                            SID = Fnc.GetKeyCode(pNode.Parent.Key)
                        End If
                        If InStr(pNode.Tag, ";") Then
                            pNode.Tag = Left$(pNode.Tag, InStr(pNode.Tag, vbCrLf) - 1) & ";" & SCount & ";" & KCount & MID$(pNode.Tag, InStr(pNode.Tag, vbCrLf))
                            
                            Cm = Split(pNode.Tag, vbCrLf)
                            Vd = Split(Cm(0), ";")
                            For i = 1 To UBound(Cm)
                                If Len(Cm(i)) > 0 Then
                                    Va = Split(Cm(i), ";")
                                    If bUpdate Then SystemDB.ExecuteSQL "UPDATE [D:個人Info] SET [頁番号]=" & (Val(Va(0)) + Val(Vd(4))) & ", [整理番号]=" & (Val(Va(1)) + Val(Vd(5))) & " WHERE [ID]=" & Va(7)
                                End If
                            Next
                            
                            SCount = SCount + Val(Ar(1))
                            KCount = KCount + Val(Ar(2))
                        End If
                End Select
            Next
                        
            .Page = 1
        End With

    Exit Function
    
    Ext:
        MsgBox ErrorPos & ";" & Err.Description
        
        Exit Function
    End Function
    
    Private Property Let CPrintCls_Key(ByVal RHS As String)
    
    End Property
    Private Property Get CPrintCls_Key() As String
    
    End Property
    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants: CPrintCls_Orientation = vbPRORPortrait: End Property
    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&): CPrintCls_Repaint: End Sub
    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA3: End Property
    Private Property Set CPrintCls_Parent(RHS As CPrintFormSK): Set mvarParent = RHS: End Property
    
    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        Dim n As Long
        Dim pNode As Object
        With mvarParent
            For Each pNode In .Nodes
                If pNode.Checked Then
                    .ChangeLayout CPrintCls_PaperSize, CPrintCls_Orientation
                    For n = 1 To Val(pNode.Tag)
                        PrintSub pNode.Key, n
                        .NewPage
                    Next
                    If Val(pNode.Tag) > 0 Then .EndDoc

                    pNode.Checked = False
                End If
            Next
        End With
    End Sub
    
    Private Sub CPrintCls_TargetChange(sKey As String)
        mvarKey = sKey
        If Fnc.GetKeyHead(mvarKey) = "行政区" Then
            mvarParent.MaxPage = Val(mvarParent.Nodes(sKey).Tag)
            mvarParent.Page = 1
            CPrintCls_Repaint
        Else
            mvarParent.ClearScreen
        End If
    End Sub
    
    Private Sub CPrintCls_Repaint()
        If Fnc.GetKeyHead(mvarKey) = "行政区" Then
            PrintSub mvarKey, mvarParent.Page
        Else
            mvarParent.ClearScreen
        End If
    End Sub
    
    Private Sub PrintSub(sKey As String, nPage As Long)
        Dim y As Single
        Dim n As Single
        Dim nPit As Single, HH As Single, Rows As Long
        Dim nPit1 As Single, HH1 As Single, Rows1 As Long
        Dim St As String
        Dim P As Variant
        Dim Flg As Variant
        Dim Ar As Variant, Cm As Variant
        Dim nSC As Long
        Dim nKC As Long
        Dim sSC As String
        y = 0
        n = 0
        
        HH = 12
        Rows = 12
        nPit = 12
        
        HH1 = 12
        Rows1 = 13
        nPit1 = 12
    '----------------------------------
        With mvarParent
            .ClearScreen
            .Offset 0, 0
    '----------------------------------
    '----------------------------文字埋め等
            For n = 0 To 1
                .hTextOut "世　　帯一連番号", 16, 45 + y, 4, 6, 10
                .TextBox "選 挙 人", 30, 42 + y, 45, 49 + y, 10, 2, 2
                .TextBox "一連番号", 30, 49 + y, 45, 54 + y, 10, 2, 2
                .TextBox "住　　　　　所", 45, 41 + y, 95, 56 + y, 11, 2, 2
                .TextBox "氏　　　　名", 95, 41 + y, 135, 56 + y, 11, 2, 2
                .hTextOut "世 帯 主との続柄", 137, 44 + y, 5, 6, 11
                .TextBox "生　年　月　日", 155, 41 + y, 195, 56 + y, 11, 2, 2
                .TextOut "耕 作 面 積", 207, 48 + y, 11, 2, 2
                .TextOut "u", 218, 55 + y, 11, 1, 1
                .hTextOut "照 　 合整 理 欄", 223, 44 + y, 5, 6, 11
                .TextBox "備　　　考", 242, 41 + y, 280, 56 + y, 11, 2, 2
                If n < 1 Then
                    .DotLine 231, 55 + y, 231, nPit * Rows + 55 + y, vbBlack, vbDot     '家畜の縦向きの有無の右の線
                Else
                    .DotLine 231, 55 + y, 231, nPit * Rows1 + 55 + y, vbBlack, vbDot    '家畜の縦向きの有無の右の線
                End If
                y = (Rows + 1) * nPit + HH + 3
            Next
    '----------------------------------
    '----------------------------表作成
            .DLine 38, 40, 70, 40, vbBlack                                                      '集落名の下線
            .LineBoxDX 15, 43, HH, Rows, nPit, GetArray(15, 15, 50, 40, 20, 40, 24, 24, 37)        '表の上
            .LineBoxDX 15, 214, HH1, Rows1, nPit1, GetArray(15, 15, 50, 40, 20, 40, 24, 24, 37)    '表の下
    '-----------------------------------
    ''------------------------------当込み
            Ar = Split(.Nodes(sKey).Tag, vbCrLf)
            Cm = Split(Ar(0), ";")
            If UBound(Cm) > 0 Then
                .TextOut "集 落: " & Cm(3), 22, 37, 14, 0, 2
                .TextOut Cm(2) & " 人/", 250, 37, 12, 1, 2
                .TextOut Cm(1) & " 世帯", 274, 37, 12, 1, 2
                .TextOut nPage & " / " & Cm(0) & " ページ", 274, 28, 12, 1, 2
                nSC = Val(Cm(4))
                nKC = Val(Cm(5))
            End If
            y = 0
            If nPage = 0 Then Exit Sub
            sSC = ""
            For n = 1 To Rows + Rows1
                If (nPage - 1) * 25 + n > UBound(Ar) Then Exit For
                Cm = Split(Ar((nPage - 1) * 25 + n), ";")
                If sSC = CStr(Val(Cm(0)) + nSC) Then
                Else
                    .TextBox CStr(Val(Cm(0)) + nSC), 16, 56 + y, 29, 66 + y, 12, 1, 2                           '世帯一連番号
                    sSC = CStr(Val(Cm(0)) + nSC)
                End If
                
                .TextBox CStr(Val(Cm(1)) + nKC), 31, 56 + y, 44, 66 + y, 12, 1, 2                               '選挙人一連番号
                .TextBox CStr(Trim(Cm(2))), 46, 56 + y, 94, 66 + y, 12, 0, 2                                    '住所
                .TextBox CStr(Cm(3)), 96, 56 + y, 134, 66 + y, 12, 0, 2                                         '氏名
                .TextBox CStr(Cm(4)), 135, 56 + y, 155, 66 + y, 12, 2, 2                                        '選挙人一連番号
                .TextBox CStr(Cm(5)), 156, 56 + y, 194, 66 + y, 12, 2, 2                                        '生年月日
                If Len(Cm(6)) > 0 Then .TextBox FormatNumber(Val(Cm(6)), 0), 196, 56 + y, 218, 66 + y, 12, 1, 2 '耕作面積
                If n < Rows Then
                    y = n * nPit
                Else
                    y = (n + 1) * nPit + HH + 3
                End If
            Next

        End With
    End Sub

End Class










Class C担い手農家名簿
    Option Explicit
    Implements CPrintCls
    Private mvarParent As CPrintFormSK

    Private Property Get CPrintCls_CanCancelPrint() As Boolean: End Property
    Private Property Get CPrintCls_CanPrintNowPage() As Boolean: End Property
    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean: End Function
    
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants: CPrintCls_Orientation = vbPRORLandscape: End Property
    Private Property Let CPrintCls_Key(ByVal RHS As String): End Property
    Private Property Get CPrintCls_Key() As String: End Property

    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&): End Sub
    
    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property
    Private Property Set CPrintCls_Parent(RHS As CPrintFormSK): Set mvarParent = RHS: End Property

    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)

    End Sub

    Private Sub CPrintCls_PrintSub(pObj As Object, Optional sParam As String)
        Dim x As Single, y As Single                        'x→横用 値格納   y→縦用 値格納
        Dim m As Single, n As Single                        'm→ループ横      n→ループ縦
        Dim nPit As Single, HH As Single, Rows As Long      'DX1個目
        Dim nPit1 As Single, HH1 As Single, Rows1 As Long   'DX2個目
        Dim nPit2 As Single, HH2 As Single, Rows2 As Long   'DX3個目
        
        x = 0: y = 0
        m = 0: n = 0
        
        HH = 4     'ヘッダーの高さ
        Rows = 0   '何セル分
        nPit = 0    '表の中の繰り返しの巾
        
        HH1 = 4     'ヘッダーの高さ
        Rows1 = 0   '何セル分
        nPit1 = 4   '表の中の繰り返しの巾
        
        HH2 = 0     'ヘッダーの高さ
        Rows2 = 40   '何セル分
        nPit2 = 4   '表の中の繰り返しの巾
        
        With mvarParent
            .ClearScreen
            .Offset -5, 0
    '----------------------------文字埋め
            .TextOut "霧島町担い手農家名簿", 30, 18, 12
            .TextOut "平成　　年　　月 現在", 240, 18, 10
            .TextOut "田", 166.5, 23.5, 9, 2
            .TextOut "畑", 194.5, 23.5, 9, 2
            .TextOut "樹園地", 222.5, 23.5, 9, 2
            .TextOut "自作別合計", 250.5, 23.5, 9, 2
            .TextOut "番号", 19, 27.5, 9, 2
            .TextOut "集落名", 31, 27.5, 9, 2
            .TextOut "氏名", 49, 27.5, 9, 2
            .TextOut "年齢", 65, 27.5, 9, 2
            .TextOut "営農区分", 82, 27.5, 9, 2
            .TextOut "簿記記帳", 103, 27.5, 9, 2
            .TextOut "申告方法", 121, 27.5, 9, 2
            .TextOut "認定農家", 141, 27.5, 9, 2
            
            For m = 0 To 3
                x = m * 28
                .TextOut "自作地", 159 + x, 27.5, 9, 2
                .TextOut "小作地", 173 + x, 27.5, 9, 2
            Next
            .TextOut "総計", 274.5, 27.5, 9, 2
    '-----------------------------------
    '-----------------------------表作成
            .LineBoxDX 14, 23, HH, Rows, nPit, GetArray(10, 14, 22, 10, 24, 18, 18, 22, 28, 28, 28, 28)   'ヘッダー上(番号の上の空白のところの横)
            .LineBoxDX 14, 27, HH1, Rows1, nPit1, GetArray(10, 14, 22, 10, 24, 18, 18, 22, 14, 14, 14, 14, 14, 14, 14, 14)   'ヘッダー下(番号のところの横)
            .DBox 264, 23, 284, 31, vbBlack     'ヘッダー(総計)
            .LineBoxDX 14, 31, HH2, Rows2, nPit2, GetArray(10, 14, 22, 10, 24, 18, 18, 22, 14, 14, 14, 14, 14, 14, 14, 14, 20)   'ヘッダー上(番号の上の空白のところの横)
    '-----------------------------------
    '---------------------------データはめ込み用の文字位置
            .TextOut "88", 249.5, 18 + y, 10, 2                        '年
            .TextOut "88", 258, 18 + y, 10, 2                          '日
            
            For n = 0 To Rows2 - 1
                y = n * nPit2
                .TextOut "8", 23, 31.5 + y, 9, 1                       '番号
                .TextOut "集落名", 25, 31.5 + y, 9                     '集落名
                .TextOut "氏名", 39, 31.5 + y, 9                       '氏名
                .TextOut "88", 69, 31.5 + y, 9, 1                      '年齢
                .TextOut "営農区分", 71, 31.5 + y, 9                   '営農区分
                .TextOut "簿記記帳", 95, 31.5 + y, 9                   '簿記記帳
                .TextOut "申告方法", 122, 31.5 + y, 9, 2               '申告方法
                .TextOut DateValue(Now), 151, 31.5 + y, 9, 1           '認定農業者
                .TextOut FormatNumber(88888, 0), 165, 31.5 + y, 9, 1   '自作地(田)
                .TextOut FormatNumber(88888, 0), 179, 31.5 + y, 9, 1   '小作地(田)
                .TextOut FormatNumber(88888, 0), 193, 31.5 + y, 9, 1   '自作地(畑)
                .TextOut FormatNumber(88888, 0), 207, 31.5 + y, 9, 1   '小作地(畑)
                .TextOut FormatNumber(88888, 0), 221, 31.5 + y, 9, 1   '自作地(樹園地)
                .TextOut FormatNumber(88888, 0), 235, 31.5 + y, 9, 1   '小作地(樹園地)
                .TextOut FormatNumber(88888, 0), 249, 31.5 + y, 9, 1   '自作地(自作別合計)
                .TextOut FormatNumber(88888, 0), 263, 31.5 + y, 9, 1   '小作地(自作別合計)
                .TextOut FormatNumber(88888, 0), 283, 31.5 + y, 9, 1   '総計
            Next
    '-----------------------------------
            .EndDoc
        End With
    End Sub

    Private Sub CPrintCls_Repaint()

    End Sub

    Private Sub CPrintCls_TargetChange(sKey As String)

    End Sub

End Class










Class C農家基本台帳
    Option Explicit
    Implements ADBasicLIB2.CDataviewSK
        Private DVProperty As CDataviewProperty

    Implements ADBasicLIB2.CPrintCls
        Private mvarPRP As CPrintProperty

    Private mvarKey As String

    Private mvar印刷日時 As String
    Private bSeaclet As Boolean

    Private mvarData0 As String
    Private mvarData As String
    Private mvarData2 As String
    Private mvarData3 As String
    Private mvarData4 As String

    Private mvarXMLData As New CXMLDoc
    Private mvarPage2BTable As New CDrawTable

    Private Type type農家
        登記地目 As ADBasicLIB2.CDataDictionary
        現況地目 As ADBasicLIB2.CDataDictionary
        世帯ID As Long
        世帯の有無 As Boolean
        世帯主名 As String
        世帯主ID As Long
        住所 As String
        集落情報 As String
        郵便番号 As String
        電話番号 As String
        備考     As String
        申告方法 As Long
        申告年月日 As Date
        認定番号 As String
        認定農業者の有無 As String
        認定農業者の認定日 As String
        担い手農家の有無 As String
        担い手農家の認定日 As String
        家族経営協定 As String
        家族経営協定の認定日 As String

        住民コード As String
        農機具List As String
        家畜List As String
        販売収入順位List As String
        経営意向 As Long
        経営計画 As Long
        経営計画List As String
        拡大縮小方法 As Long
        希望面積 As Long
        農用地改善団体参加 As Long
        地域農業集団構成員 As Long
        その他の団体への参加 As String
        採草放牧地面積 As Long
        証明文 As String

        自作田 As Long
        自作畑 As Long
        自作樹 As Long
        自作草 As Long

        不耕作自作田 As Long
        不耕作自作畑 As Long
        不耕作自作樹 As Long
        不耕作自作草 As Long

        小作田 As Long
        小作畑 As Long
        小作樹 As Long
        小作草 As Long

        不耕作小作田 As Long
        不耕作小作畑 As Long
        不耕作小作樹 As Long
        不耕作小作草 As Long

        田筆数 As Long
        畑筆数 As Long
        樹筆数 As Long
        草筆数 As Long

        不耕作田筆数 As Long
        不耕作畑筆数 As Long
        不耕作樹筆数 As Long
        不耕作草筆数 As Long

        貸出田 As Long
        貸出畑 As Long
        貸出樹 As Long
        貸出草 As Long

        不耕作貸出田 As Long
        不耕作貸出畑 As Long
        不耕作貸出樹 As Long
        不耕作貸出草 As Long

        台帳登記面積 As Boolean
    End Type

    Private mode面積表示 As Long
    Private b現況表示 As Boolean
    Private mvarTableA As New CPrintTable
    Private mvar基本情報 As type農家

    Private Sub Class_Initialize(): Set mvarPRP = New CPrintProperty: Set DVProperty = mvarPDW.DataviewCol.GetNewDVP: End Sub

    Public Property Get Key() As String: Key = DVProperty.Key: End Property
    Public Property Let Key(ByVal RHS As String): DVProperty.SetDVP RHS: End Property

    Private Sub CDataviewSK_CloseRecordset(): End Sub

    Private Property Set CDataviewSK_Container(ByVal RHS As ADBasicLIB2.CPDW)
        Dim St As String

        Set DVProperty.Controls.Parent = Me
        Set DVProperty.Containner = RHS
        DVProperty.LocationString = ""

        St = "小作料の印刷,0,YesNo;印刷日時の表示,0,YesNo;隠し,0,YesNo;遊休化表示,0,YesNo"
        '
        ADApp.Common.SetAppPropertyView DVProperty.Controls, St
        DVProperty.Controls.AttachData
    End Property

    Private Sub CDataviewSK_DblClick(): mvarPDW.DataviewCol.Add Me: End Sub

    Private Function CDataviewSK_DoCommand2(sCmd As String, Optional sParam As String = "") As Variant
        Select Case sCmd
    '/*************データビュー**************/
            Case "開く": CDataviewSK_DblClick
            Case "閉じる": ADApp.DataviewCol.Remove DVProperty.Key
            Case "更新": DVProperty.Controls.UpdateControlValues
            Case "メニュー": CDataviewSK_PopupMenu
        End Select
    End Function

    Private Sub CDataviewSK_DropDown(sSourceList As String, Optional sOption As String = "")
        Select Case Fnc.GetKeyHead(sSourceList)
            Case "農家": mvarPDW.PrintGo Me, sSourceList
        End Select
    End Sub

    Private Property Set CDataviewSK_DVProperty(ByVal RHS As ADBasicLIB2.CDataviewProperty): Set DVProperty = RHS: End Property
    Private Property Get CDataviewSK_DVProperty() As ADBasicLIB2.CDataviewProperty: Set CDataviewSK_DVProperty = DVProperty: End Property

    Private Function CDataviewSK_GetProperty2(sPropName As String, Optional sParam As String = "") As Variant
        Select Case sPropName
            Case "名称": CDataviewSK_GetProperty2 = "農家基本台帳"
            Case "Icon": Set CDataviewSK_GetProperty2 = LoadResPicture("AvailNOKOpen", vbResIcon)
            Case "IconName": CDataviewSK_GetProperty2 = CDataviewSK_IconName
            Case Else
                Debug.Assert False 'Non Code
        End Select
    End Function

    Private Property Get CDataviewSK_IconName() As String: CDataviewSK_IconName = "NOUKADAICHO": End Property

    Private Property Get CDataviewSK_IsUpdated() As Boolean: CDataviewSK_IsUpdated = DVProperty.Controls.IsUpdated: End Property

    Private Property Get CDataviewSK_Key() As String: CDataviewSK_Key = DVProperty.Key: End Property
    Private Property Let CDataviewSK_Key(ByVal RHS As String): End Property

    Private Property Get CDataviewSK_ParentKey() As String: End Property

    Private Function CDataviewSK_PopupMenu(Optional ByVal sParam As String = "", Optional vParam As Variant) As String
        Dim St As String
        St = "開く;"
        If Not DVProperty.Body Is Nothing Then St = St & "-;閉じる;"
        CDataviewSK_DoCommand2 SysAD.PopupMenu(St)
    End Function

    Private Sub CDataviewSK_Refresh(Optional bReLoad As Boolean = False): End Sub

    Private Property Get CPrintCls_CanCancelPrint() As Boolean:
        CPrintCls_CanCancelPrint = True
    End Property
    Private Property Get CPrintCls_CanPrintNowPage() As Boolean: CPrintCls_CanPrintNowPage = True: End Property

    Private Property Let CPrintCls_Key(ByVal RHS As String): End Property
    Private Property Get CPrintCls_Key() As String: CPrintCls_Key = DVProperty.Key: End Property

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean
        Dim pMenber As New ADBasicLIB2.CDataDictionary
        Dim RsS As ADBasicLIB2.RecordsetEx
        Dim RsG As ADBasicLIB2.RecordsetEx
        Dim RsP As ADBasicLIB2.RecordsetEx
        Dim sSQL As String

        Dim Ar As Variant
        Dim Cm As Variant
        Dim n As Long
        Dim St As String
        Dim sBase As String
        Dim n田 As Long
        Dim n畑 As Long
        Dim n樹園地 As Long

        Dim n田筆数 As Long
        Dim n畑筆数 As Long
        Dim n樹園地筆数 As Long

        Dim n田計 As Long
        Dim n畑計 As Long
        Dim n樹園地計 As Long
        Dim sERR As String
        Dim n耕作 As Long
        Dim pDt As Date
        Dim nERL As Long
        Dim dicPerson As New ADBasicLIB2.CDataDictionary
        Dim s所有者 As String

        On Error GoTo ErrorDatainit
    nERL = 1:        With mvarPRP.Parent
    nERL = 2:            .PrintMode("白紙可能") = True
    nERL = 3:            .PrintMode("部数印刷") = True
    nERL = 4:            .PrintMode("ページ指定可") = True
    nERL = 5:            .表示倍率 = 0.71
    nERL = 6:        End With
                If InStr(sParam, "|") Then
    nERL = 7:           mvarKey = Left$(sParam, InStr(sParam, "|") - 1)
                    mvar印刷日時 = CDate(MID$(sParam, InStr(sParam, "|") + 1))
                Else
    nERL = 7:           mvarKey = sParam
                End If
    nERL = 8:        DVProperty.SetDVP mvarKey
    nERL = 9:        bSeaclet = Val(SystemDB.DBProperty("隠し"))
                 mode面積表示 = Val(SystemDB.DBProperty("台帳面積表示"))

    nERL = 11:       mvarTableA.Move 21, 152
    nERL = 12:           mvarTableA.bAllHLine = True
    nERL = 13:           mvarTableA.bAllVLine = True
    nERL = 14:       mvarTableA.SetColumnWidth -1, GetArray(14, 14, 14, 14, 14, 14, 14)
    nERL = 15:       mvarTableA.SetRowHeight -1, GetArray(15, 6)

    nERL = 17:       With mvar基本情報
    nERL = 18:          .証明文 = Trim(SystemDB.DBProperty("基本台帳への証明文"))
                    b現況表示 = Val(SystemDB.DBProperty("農地基本台帳現況面積表示"))
                    If Len(.証明文) Then
    nERL = 20:               With Fnc.InputMulti("農地基本台帳の証明", "証明文を印刷しますか", "印刷の有無;YesNo;-1|証明日;日付", , True)
                            If Not .ReturnCancel Then
                                If .Item("印刷の有無") Then
    nERL = 23:                           mvar基本情報.証明文 = SystemDB.StrReplace(mvar基本情報.証明文)
    nERL = 24:                           mvar基本情報.証明文 = Format(CDate(.Item("証明日")), mvar基本情報.証明文)
                                Else
    nERL = 26:                           mvar基本情報.証明文 = ""
                                End If
                            Else
    nERL = 29:                       mvar基本情報.証明文 = ""
                            End If
                        End With
                    Else

    nERL = 34:           End If
    nERL = 35:           .住民コード = SystemDB.DBProperty("台帳記載住民コード")
    nERL = 36:           If Len(.住民コード) = 0 Then MsgBox "台帳表示の対象となる住民コードが登録されていません", vbCritical: Exit Function
    nERL = 37:           Set .登記地目 = SysAD.ExtFunction.DoFunction("コード辞書の取得", , "SELECT 'n' & [ID] AS [KEY],[名称] FROM V_地目")
    nERL = 38:           Set .現況地目 = SysAD.ExtFunction.DoFunction("コード辞書の取得", , "SELECT 'n' & [ID] AS [KEY],[名称] FROM V_現況地目")
    nERL = 39:           .台帳登記面積 = Val(SystemDB.DBProperty("台帳登記面積"))
    nERL = 40:       End With
                If Not Fnc.TrueOrFalse(SystemDB.DBProperty("印刷日時の表示")) Then
                ElseIf mvar印刷日時 = "" And Fnc.TrueOrFalse(SystemDB.DBProperty("基本台帳日付変更")) Then
                    With Fnc.InputData("基本台帳の発行日付", "日付を入力してください", Nothing, "発効日;日付;%%Now%%")
                        If Not .IsObtained Then
                            CPrintCls_DataInit = True: Exit Function
                        ElseIf .IsDate("発行日") Then
                            mvar印刷日時 = Format(.Item("発行日"), "GGGEE年MM月DD日")
                        End If
                    End With
                Else
    nERL = 51:           mvar印刷日時 = Format(Now(), "GGGEE年MM月DD日")
                End If
    nERL = 53:      Select Case Fnc.GetKeyHead(mvarKey)
                    Case "農家":
    nERL = 55:              mvar基本情報.世帯ID = Fnc.GetKeyCode(mvarKey)
    nERL = 56:              Set RsS = SystemDB.GetRecordsetEx("SELECT [D:世帯Info].世帯主ID,[D:世帯Info].採草放牧地面積,[D:世帯Info].農家番号,[D:個人Info].氏名,[D:個人Info].住所,[D:個人Info].電話番号,[D:個人Info].郵便番号,[農用地改善団体参加],[地域農業集団構成員],[その他の団体への参加],[V_行政区].[名称] AS [集落],[D:世帯Info].[備考],[青色申告],[青色申告開始日],[家族経営協定] " & _
                        "FROM ([D:世帯Info] LEFT JOIN [D:個人Info] ON [D:世帯Info].世帯主ID = [D:個人Info].ID) LEFT JOIN [V_行政区] ON [D:個人Info].行政区ID = [V_行政区].ID " & _
                        "WHERE [D:世帯Info].[ID]=" & mvar基本情報.世帯ID, 0, , Me)
    nERL = 59:
                        If RsS.IsNoRecord Then
    nERL = 61:                   SystemDB.CloseRs RsS
    nERL = 62:                   Exit Function
                        Else
                            With mvar基本情報

    nERL = 74:                       .世帯の有無 = True
    nERL = 75:                       .住所 = StrConv(RsS.NullCast("住所", "世帯主の住所が入力されていません"), vbNarrow)
    nERL = 76:                       .世帯主ID = RsS.V("世帯主ID")
    nERL = 77:                       .世帯主名 = RsS.NullCast("氏名", "世帯主の入力が不適当です")
    nERL = 78:                       .集落情報 = RsS.NullCast("集落", "") & "(" & Right$("00000000" & RsS.NullCast("農家番号", 0), 7) & ")"
    nERL = 79:                       .電話番号 = RsS.NullCast("電話番号", ""): If Left$(.電話番号, 4) = "0000" Then .電話番号 = ""

    nERL = 80:                       .郵便番号 = RsS.NullCast("郵便番号", "")
    nERL = 81:                       .採草放牧地面積 = RsS.NullCast("採草放牧地面積", 0)
    nERL = 82:                       .申告方法 = RsS.NullCast("青色申告", 0)
    nERL = 83:                       .申告年月日 = RsS.NullCast("青色申告開始日", 0)
    nERL = 84:                       .備考 = RsS.NullCast("備考", "")
    nERL = 85:                       .農用地改善団体参加 = RsS.NullCast("農用地改善団体参加", 0)
    nERL = 86:                       .地域農業集団構成員 = RsS.NullCast("地域農業集団構成員", 0)
    nERL = 87:                       .その他の団体への参加 = RsS.NullCast("その他の団体への参加", "")
                                 .家族経営協定 = RsS.V("家族経営協定")
                            End With
    nERL = 89:                  SystemDB.CloseRs RsS
                        End If
    nERL = 91:
    nERL = 92:              Set RsS = SystemDB.GetRecordsetEx(DVProperty.StrReplace("SELECT V_農機具01.名称, D_世帯営農.農機具数量1, V_農機具02.名称, D_世帯営農.農機具数量2, V_農機具03.名称, D_世帯営農.農機具数量3, V_農機具04.名称, D_世帯営農.農機具数量4, V_農機具05.名称, D_世帯営農.農機具数量5, V_農機具06.名称, D_世帯営農.農機具数量6, V_農機具07.名称, D_世帯営農.農機具数量7 FROM ((((((D_世帯営農 LEFT JOIN V_農機具 AS V_農機具01 ON D_世帯営農.農機具種類1 = V_農機具01.ID) LEFT JOIN V_農機具 AS V_農機具02 ON D_世帯営農.農機具種類2 = V_農機具02.ID) LEFT JOIN V_農機具 AS V_農機具03 ON D_世帯営農.農機具種類3 = V_農機具03.ID) LEFT JOIN V_農機具 AS V_農機具04 ON D_世帯営農.農機具種類4 = V_農機具04.ID) LEFT JOIN V_農機具 AS V_農機具05 ON D_世帯営農.農機具種類5 = V_農機具05.ID) LEFT JOIN V_農機具 AS V_農機具06 ON D_世帯営農.農機具種類6 = V_農機具06.ID) LEFT JOIN V_農機具 AS V_農機具07 ON D_世帯営農.農機具種類7 = V_農機具07.ID WHERE (((D_世帯営農.ID)=%DVP.ID%));"), , , Me)
                        If Not RsS.IsNoRecord Then
    nERL = 94:                   mvar基本情報.農機具List = RsS.GetString(";", vbBack)
                        End If
    nERL = 96:              RsS.CloseRs
    nERL = 97:              Set RsS = SystemDB.GetRecordsetEx(DVProperty.StrReplace("SELECT V_家畜01.名称, D_世帯営農.家畜数量1, V_家畜02.名称, D_世帯営農.家畜数量2, V_家畜03.名称, D_世帯営農.家畜数量3, V_家畜04.名称, D_世帯営農.家畜数量4, V_家畜05.名称, D_世帯営農.家畜数量5, V_家畜06.名称, D_世帯営農.家畜数量6, V_家畜07.名称, D_世帯営農.家畜数量7 FROM ((((((D_世帯営農 LEFT JOIN V_家畜 AS V_家畜01 ON D_世帯営農.家畜種類1 = V_家畜01.ID) LEFT JOIN V_家畜 AS V_家畜02 ON D_世帯営農.家畜種類2 = V_家畜02.ID) LEFT JOIN V_家畜 AS V_家畜03 ON D_世帯営農.家畜種類3 = V_家畜03.ID) LEFT JOIN V_家畜 AS V_家畜04 ON D_世帯営農.家畜種類4 = V_家畜04.ID) LEFT JOIN V_家畜 AS V_家畜05 ON D_世帯営農.家畜種類5 = V_家畜05.ID) LEFT JOIN V_家畜 AS V_家畜06 ON D_世帯営農.家畜種類6 = V_家畜06.ID) LEFT JOIN V_家畜 AS V_家畜07 ON D_世帯営農.家畜種類7 = V_家畜07.ID WHERE (((D_世帯営農.ID)=%DVP.ID%));"), , , Me)
                        If Not RsS.IsNoRecord Then
    nERL = 99:                   mvar基本情報.家畜List = RsS.GetString(";", vbBack)
                        End If
    nERL = 101:             RsS.CloseRs
    nERL = 102:             Set RsS = SystemDB.GetRecordsetEx(DVProperty.StrReplace("SELECT '米',[販売収入順位米],'畜産',[販売収入順位畜産],'果樹',[販売収入順位果樹],'そさい',[販売収入順位そさい],'養蚕',[販売収入順位養蚕],[販売収入名称その他１],[販売収入順位その他１],[販売収入名称その他２],[販売収入順位その他２],[販売収入名称その他３],[販売収入順位その他３] FROM [D_世帯営農] WHERE (((D_世帯営農.ID)=%DVP.ID%));"), , , Me)
                        If Not RsS.IsNoRecord Then
    nERL = 104:                  mvar基本情報.販売収入順位List = Replace(RsS.GetString(";", vbBack), vbBack, "")
                        End If
    nERL = 106:             RsS.CloseRs
    nERL = 107:             Set RsS = SystemDB.GetRecordsetEx(DVProperty.StrReplace("SELECT D_世帯営農.経営意向, D_世帯営農.経営計画, D_世帯営農.希望面積, D_世帯営農.拡大縮小方法, '%$%' AS 式1,'米麦作', D_世帯営農.経営計画米麦作,'畜産', D_世帯営農.経営計画畜産,'果樹', D_世帯営農.経営計画果樹,'そさい', D_世帯営農.経営計画そさい,'養蚕', D_世帯営農.経営計画養蚕 FROM D_世帯営農 WHERE (((D_世帯営農.ID)=%DVP.ID%));"), 0, , Me)
                        If Not RsS.IsNoRecord Then
    nERL = 109:                  Ar = Split(RsS.GetString(";", "%$%"), "%$%")
    nERL = 110:                  Cm = Split(Ar(0), ";")
    nERL = 111:                  mvar基本情報.経営意向 = Val(Cm(0))
    nERL = 112:                  mvar基本情報.経営計画 = Val(Cm(1))
    nERL = 113:                  mvar基本情報.希望面積 = Val(Cm(2))
    nERL = 114:                  mvar基本情報.拡大縮小方法 = Val(Cm(3))
    nERL = 115:                  mvar基本情報.経営計画List = MID$(Ar(1), 2)
                        End If
    nERL = 117:             RsS.CloseRs
                    Case "世帯員":
    nERL = 119:              mvar基本情報.世帯主ID = Fnc.GetKeyCode(mvarKey)
    nERL = 120:              mvar基本情報.世帯ID = SystemDB.GetDirectData("D:個人Info", "世帯ID", mvar基本情報.世帯主ID)

                        Set RsS = SystemDB.GetRecordsetEx("SELECT [D:世帯Info].ID as SID,[D:世帯Info].採草放牧地面積,[D:世帯Info].農家番号,[D:個人Info].電話番号 AS 世帯電話,[D:個人Info].郵便番号 AS 世帯郵便,[D:個人Info].氏名,[D:個人Info].住所,[D:個人Info].電話番号,[D:個人Info].郵便番号,[V_行政区].[名称] AS [集落] " & _
                        "FROM ([D:個人Info] LEFT JOIN [D:世帯Info] ON [D:個人Info].世帯ID = [D:世帯Info].ID) LEFT JOIN [V_行政区] ON [D:個人Info].行政区ID = [V_行政区].ID " & _
                        "WHERE [D:個人Info].[ID]=" & mvar基本情報.世帯主ID, 0, , Me)
    nERL = 125:
                        If RsS.IsNoRecord Then
    nERL = 127:                  SystemDB.CloseRs RsS
    nERL = 128:                  Exit Function
                        Else
                            With mvar基本情報
    nERL = 131:                      .世帯の有無 = Not (RsS.NullCast("SID", 0) = 0)
    nERL = 132:                      .住所 = RsS.NullCast("住所", "世帯主の住所が入力されていません")
    nERL = 133:                      .世帯主名 = RsS.NullCast("氏名", "世帯主の入力が不適当です")
    nERL = 134:                      .集落情報 = RsS.NullCast("集落", "") & "(" & Right$("00000000" & RsS.NullCast("農家番号", 0), 7) & ")"
    nERL = 135:                      .電話番号 = RsS.NullCast("電話番号", RsS.NullCast("世帯電話", ""))
    nERL = 136:                      .郵便番号 = RsS.NullCast("郵便番号", RsS.NullCast("世帯郵便", ""))
    nERL = 137:                      .採草放牧地面積 = RsS.NullCast("採草放牧地面積", 0)
    nERL = 138:                      .備考 = ""
                            End With
    nERL = 140:                  SystemDB.CloseRs RsS
                        End If
    nERL = 142:         Case Else
    nERL = 143:             CPrintCls_DataInit = True
                        MsgBox "指定された世帯員情報が見つかりません", vbCritical
                        Exit Function
    nERL = 144:     End Select

    nERL = 146:     sBase = ";;;;;"
    nERL = 147:     mvarData = sBase

    nERL = 149:     mvarPDW.WaitMessage = "世帯員情報"
    nERL = 150:     sSQL = "SELECT *,[V_続柄].[名称] & 'の' & [V続柄2].[名称] & 'の' & [V続柄3].[名称] AS [続柄] " & _
                "FROM (([D:個人Info] LEFT JOIN [V_続柄] ON [D:個人Info].[続柄1]=[V_続柄].[ID]) LEFT JOIN [V_続柄] AS [V続柄2] ON [D:個人Info].[続柄2]=[V続柄2].[ID]) LEFT JOIN [V_続柄] AS [V続柄3] ON [D:個人Info].[続柄3]=[V続柄3].[ID] " & _
                "WHERE " & IIf(mvar基本情報.世帯の有無, "[世帯ID]=" & mvar基本情報.世帯ID & " AND [住民区分] IN (" & SystemDB.DBProperty("台帳記載住民コード") & ")", "[D:個人Info].ID=" & mvar基本情報.世帯主ID) & _
                " ORDER BY [続柄1],[続柄2]"
    nERL = 154:      Set RsG = SystemDB.GetRecordsetEx(sSQL, 0, , "基本台帳")

                Do Until RsG.EOF
    nERL = 157:         St = RsG.V("氏名") & ";"
    nERL = 158:         If IsNull(RsG.V("続柄")) Then St = St & ";" Else St = St & RsG.V("続柄") & ";"
    nERL = 159:         St = Replace(St, "の-", "")
    nERL = 160:         Do While Right$(St, 2) = "の;": St = Left$(St, Len(St) - 2) & ";": Loop

                    Select Case RsG.NullCast("農業改善計画認定", 0)
                        Case 1: mvar基本情報.認定農業者の有無 = 1
                                mvar基本情報.認定農業者の認定日 = RsG.NullCast("認定日", "")
                                mvar基本情報.認定番号 = RsG.NullCast("認定番号", "")
                        Case 2: mvar基本情報.担い手農家の有無 = 1
                                mvar基本情報.担い手農家の認定日 = RsG.NullCast("認定日", "")
                                mvar基本情報.認定番号 = RsG.NullCast("認定番号", "")
                    End Select

    nERL = 162:         St = St & RsG.Choose("性別", GetArray("-", "男", "女"), -1) & ";"
    nERL = 163:         St = St & RsG.FormatDateEx("生年月日", "GGEE/MM/DD") & ";"
    nERL = 164:         St = St & IIf(RsG.NullCast("世帯責任者", 0), "○", "") & ";"
    nERL = 165:         St = St & IIf(RsG.NullCast("農業経営者", 0), "○", "") & ";"
    nERL = 166:         St = St & IIf(RsG.NullCast("農業跡継ぎ", 0), "○", "") & ";"

    nERL = 168:         St = St & Fnc.NullCast(RsG.V("農業従事日数"), "") & ";"
    nERL = 169:         St = St & IIf(IsNull(RsG.V("自家農業従事程度")), "0;", RsG.V("自家農業従事程度") & ";")
                    If IsNull(RsG.V("兼業形態")) Then
    nERL = 171:              St = St & "0;"
                    ElseIf RsG.V("兼業形態") < 5 Then
    nERL = 173:              St = St & CStr(RsG.V("兼業形態")) & ";"
                    Else
    nERL = 175:              St = St & "0;"
                    End If

    nERL = 178:          St = St & RsG.V("職業") & ";"
    nERL = 179:          If IsNull(RsG.V("農年加入種別")) Then St = St & ";" Else St = St & MID$(" 当任未", Val(RsG.V("農年加入種別")) + 1, 1) & ";"
    nERL = 180:          If IsNull(RsG.V("資格取得年月日")) Then St = St & ";" Else St = St & RsG.FormatDateEx("資格取得年月日", "GEE/MM/DD") & ";"
    nERL = 181:          If IsNull(RsG.V("被保険者番号")) Then St = St & ";" Else St = St & RsG.V("被保険者番号") & ";"
    nERL = 182:          St = St & RsG.V("備考") & ";"

    nERL = 184:          mvarData = mvarData & vbCrLf & St
    nERL = 185:          RsG.MoveNext
    nERL = 186:      Loop
    nERL = 187:      SystemDB.CloseRs RsG

    nERL = 189:      mvarPDW.WaitMessage = "経営農地情報"

    nERL = 191:      mvarData2 = sBase
    nERL = 192:      mvarData2 = mvarData2 & ";;;;"
    nERL = 193:      mvarData2 = mvarData2 & ";;;;"
    nERL = 194:      mvarData2 = mvarData2 & ";;;;"
    nERL = 195:      mvarData2 = mvarData2 & ";;;;"
    nERL = 196:      mvarData2 = mvarData2 & ";;;;"

    nERL = 198:      mvarData3 = sBase

    nERL = 200:      St = "SELECT DISTINCTROW [土地改良法],[V_農地].実面積,V_農地.大字ID,[V_農地].土地所在,[V_農地].所有者ID,[V_農地].管理人ID,[V_農地].[融資対象農地],[V_農地].[納税猶予対象農地],[V_農地].借受人ID,[V_農地].登記簿地目 AS 台帳地目,[V_農地].現況地目,[V_農地].農業振興地域,[V_農地].都市計画法,[V_農地].遊休化,[V_農地].遊休時期,[V_農地].備考,[V_農地].[登記簿面積] AS 台帳面積,[V_農地].実面積,[V_農地].自小作別,[D:個人Info].氏名 AS [所有者氏名],Null AS [所有住所],Null AS [借受人氏名],0 AS [小作地適用法],0 AS [小作形態],0 AS [小作開始年月日],0 AS [小作終了年月日],Null AS [小作料S],Null AS [単位S]," & _
                IIf(mvar基本情報.台帳登記面積, "SGN([田面積])*[登記簿面積] AS [田面積A],SGN([畑面積])*[登記簿面積] AS [畑面積A]", "田面積 AS [田面積A],畑面積 AS [畑面積A]") & ",樹園地,採草放牧面積,[V_農地].部分面積,[V_農地].共有持分分子,[V_農地].共有持分分母,農地状況 " & _
                "FROM [V_農地] LEFT JOIN [D:個人Info] ON [V_農地].管理人ID = [D:個人Info].ID " & _
                "WHERE [自小作別]<1 AND " & IIf(mvar基本情報.世帯の有無, "[農家世帯ID] = " & mvar基本情報.世帯ID, "[管理人ID] = " & mvar基本情報.世帯主ID) & " " & _
                "ORDER BY V_農地.大字ID,[V_農地].土地所在 " & _
                "UNION ALL SELECT DISTINCTROW [土地改良法],[V_農地].実面積,V_農地.大字ID,V_農地.土地所在, V_農地.所有者ID,[V_農地].管理人ID,[V_農地].[融資対象農地],[V_農地].[納税猶予対象農地], V_農地.借受人ID, V_農地.登記簿地目 AS 台帳地目, V_農地.現況地目, V_農地.農業振興地域, V_農地.都市計画法, V_農地.遊休化, V_農地.遊休時期, V_農地.備考, V_農地.登記簿面積 AS 台帳面積, V_農地.実面積, V_農地.自小作別, [D:個人Info].氏名 AS 所有者氏名,[D:個人Info].住所 AS [所有住所], [D:個人Info_1].氏名 AS 借受人氏名, V_農地.小作地適用法, V_農地.小作形態, V_農地.小作開始年月日, V_農地.小作終了年月日, [小作料] AS 小作料S, [小作料単位] AS 単位S, V_農地.田面積, V_農地.畑面積, V_農地.樹園地, V_農地.採草放牧面積,[V_農地].部分面積,[V_農地].共有持分分子,[V_農地].共有持分分母,農地状況 " & _
                "FROM (V_農地 LEFT JOIN [D:個人Info] ON V_農地.管理人ID = [D:個人Info].ID) LEFT JOIN [D:個人Info] AS [D:個人Info_1] ON V_農地.借受人ID = [D:個人Info_1].ID " & _
                "WHERE [自小作別]>0 AND " & IIf(mvar基本情報.世帯の有無, "[借受世帯ID] = " & mvar基本情報.世帯ID, "[借受人ID] = " & mvar基本情報.世帯主ID) & " ORDER BY V_農地.大字ID,[V_農地].土地所在"

    nERL = 209:      Set RsS = SystemDB.GetRecordsetEx(St, 0, , Me)
    nERL = 210:      Do Until RsS.EOF
                    If RsS.NullCast("所有者ID", "0") <> RsS.NullCast("管理人ID", "0") Then
                        dicPerson.Add "p" & RsS.NullCast("所有者ID", "0"), RsS.NullCast("所有者ID", "0")
                    Else
                        s所有者 = ""
                    End If

    nERL = 211:         mvarData3 = mvarData3 & vbCrLf & SetmvarData(RsS)

    nERL = 213:         mvarData3 = mvarData3 & ";" & RsS.V("借受人氏名")

    nERL = 215:         mvarData3 = mvarData3 & ";" & RsS.Choose("小作地適用法", GetArray("", "農", "基", "他"))
    nERL = 216:         mvarData3 = mvarData3 & ";" & RsS.Choose("小作形態", GetArray("", "賃", "使", "他"))
    nERL = 217:         mvarData3 = mvarData3 & ";" & RsS.FormatDateEx("小作開始年月日", "GGEE年MM月DD日")
    nERL = 218:         mvarData3 = mvarData3 & ";" & RsS.FormatDateEx("小作終了年月日", "GGEE年MM月DD日")
    nERL = 219:         mvarData3 = mvarData3 & ";" & IIf(Val(SystemDB.DBProperty("遊休化表示")) And RsS.V("遊休化") And (Not IsNull(RsS.V("遊休時期"))), "遊休", "")
    nERL = 220:         mvarData3 = mvarData3 & ";" & Replace(RsS.NullCast("備考", ""), vbCrLf, vbTab)
                    If RsS.V("自小作別") > 0 And RsS.V("小作形態") = 1 Then
    nERL = 222:              mvarData3 = mvarData3 & ";" & RsS.FormatNumberEx("小作料S", InStrRev(RsS.V("小作料S"), ".")) & " " & RsS.V("単位S") '小作料
                    Else
    nERL = 224:              mvarData3 = mvarData3 & ";"
                    End If

    nERL = 227:         mvarData3 = mvarData3 & ";" & RsS.Choose("農業振興地域", GetArray("他", "内", "外"), 0)
    nERL = 228:         mvarData3 = mvarData3 & ";" & RsS.Choose("都市計画法", GetArray("外", "内", "用"), 0)

    nERL = 229:         mvarData3 = mvarData3 & ";" & IIf(IsNull(RsS.V("農地状況")), "", IIf(RsS.V("農地状況") > 19, "×", IIf(RsS.V("農地状況") > 9, "不", IIf(RsS.V("農地状況") = 1, "耕", ""))))
    nERL = 230:         n耕作 = IIf(IsNull(RsS.V("農地状況")), 1, IIf(RsS.V("農地状況") > 19, 0, 1))
    nERL = 231:         With mvar基本情報
                        Select Case RsS.NullCast("自小作別", 0)
                            Case 0, -1, -8
    nERL = 234:                     .自作田 = .自作田 + RsS.NullCast("田面積A", 0) * n耕作
    nERL = 235:                     .自作畑 = .自作畑 + RsS.NullCast("畑面積A", 0) * n耕作
    nERL = 236:                     .自作樹 = .自作樹 + RsS.NullCast("樹園地", 0) * n耕作
    nERL = 237:                     .自作草 = .自作草 + RsS.NullCast("採草放牧面積", 0) * n耕作
    nERL = 238:
    nERL = 239:                     .不耕作自作田 = .不耕作自作田 - RsS.NullCast("田面積A", 0) * (n耕作 = 0)
    nERL = 240:                     .不耕作自作畑 = .不耕作自作畑 - RsS.NullCast("畑面積A", 0) * (n耕作 = 0)
    nERL = 241:                     .不耕作自作樹 = .不耕作自作樹 - RsS.NullCast("樹園地", 0) * (n耕作 = 0)
    nERL = 242:                     .不耕作自作草 = .不耕作自作草 - RsS.NullCast("採草放牧面積", 0) * (n耕作 = 0)

                                If pMenber.Exists(CStr("世帯員." & RsS.V("管理人ID"))) Then
    nERL = 245:                         St = pMenber.Item("世帯員." & RsS.V("管理人ID"))
    nERL = 246:                         Ar = Split(St, ";")
    nERL = 247:                         Ar(1) = Val(Ar(1)) + Val(RsS.V("田面積A")) + Val(RsS.V("畑面積A"))
    nERL = 248:                         St = Join(Ar, ";")
    nERL = 249:                         pMenber.Item(CStr("世帯員." & RsS.V("管理人ID"))) = St
                                Else
    nERL = 251:                         pMenber.Add CStr("世帯員." & RsS.V("管理人ID")), CStr(RsS.V("所有者氏名") & ";" & (RsS.NullCast("田面積A", 0) + RsS.NullCast("畑面積A", 0)) & ";;;")
                                End If
                            Case 1
    nERL = 254:                     .小作田 = .小作田 + RsS.NullCast("田面積A", 0) * n耕作
    nERL = 255:                     .小作畑 = .小作畑 + RsS.NullCast("畑面積A", 0) * n耕作
    nERL = 256:                     .小作樹 = .小作樹 + RsS.NullCast("樹園地", 0) * n耕作
    nERL = 257:                     .小作草 = .小作草 + RsS.NullCast("採草放牧面積", 0) * n耕作
    nERL = 258:
    nERL = 259:                     .不耕作小作田 = .不耕作小作田 + RsS.NullCast("田面積A", 0) * (n耕作 = 0)
    nERL = 260:                     .不耕作小作畑 = .不耕作小作畑 + RsS.NullCast("畑面積A", 0) * (n耕作 = 0)
    nERL = 261:                     .不耕作小作樹 = .不耕作小作樹 + RsS.NullCast("樹園地", 0) * (n耕作 = 0)
    nERL = 262:                     .不耕作小作草 = .不耕作小作草 + RsS.NullCast("採草放牧面積", 0) * (n耕作 = 0)

                                If pMenber.Exists(CStr("世帯員." & RsS.V("借受人ID"))) Then
    nERL = 265:                         St = pMenber.Item(CStr("世帯員." & RsS.V("借受人ID")))
    nERL = 266:                         Ar = Split(St, ";")
    nERL = 267:                         Ar(2) = Val(Ar(2)) + RsS.V("田面積A") + RsS.V("畑面積A")
    nERL = 268:                         St = Join(Ar, ";")
    nERL = 269:                         pMenber.Item(CStr("世帯員." & RsS.V("借受人ID"))) = St
                                Else
    nERL = 271:                         pMenber.Add CStr("世帯員." & RsS.V("借受人ID")), CStr(RsS.V("借受人氏名") & ";;" & (RsS.NullCast("田面積A", 0) + RsS.NullCast("畑面積A", 0)) & ";;")
                                End If
                        Case 2
    nERL = 274:                     .小作田 = .小作田 + RsS.NullCast("田面積A", 0) * n耕作
    nERL = 275:                     .小作畑 = .小作畑 + RsS.NullCast("畑面積A", 0) * n耕作
    nERL = 276:                     .小作樹 = .小作樹 + RsS.NullCast("樹園地", 0) * n耕作
    nERL = 277:                     .小作草 = .小作草 + RsS.NullCast("採草放牧面積", 0) * n耕作
    nERL = 278:
    nERL = 279:                     .不耕作小作田 = .不耕作小作田 + RsS.NullCast("田面積A", 0) * (n耕作 = 0)
    nERL = 280:                     .不耕作小作畑 = .不耕作小作畑 + RsS.NullCast("畑面積A", 0) * (n耕作 = 0)
    nERL = 281:                     .不耕作小作樹 = .不耕作小作樹 + RsS.NullCast("樹園地", 0) * (n耕作 = 0)
    nERL = 282:                     .不耕作小作草 = .不耕作小作草 + RsS.NullCast("採草放牧面積", 0) * (n耕作 = 0)
    nERL = 283:
                                If pMenber.Exists(CStr("世帯員." & RsS.V("借受人ID"))) Then
    nERL = 285:                         St = pMenber.Item(CStr("世帯員." & RsS.V("借受人ID")))
    nERL = 286:                         Ar = Split(St, ";")
    nERL = 287:                         Ar(4) = Val(Ar(4)) + RsS.V("田面積A") + RsS.V("畑面積A")
    nERL = 288:                         St = Join(Ar, ";")
    nERL = 289:                         pMenber.Item(CStr("世帯員." & RsS.V("借受人ID"))) = St
                                Else
    nERL = 291:                         pMenber.Add CStr("世帯員." & RsS.V("借受人ID")), CStr(RsS.V("借受人氏名") & ";;;;" & (RsS.NullCast("田面積A", 0) + RsS.NullCast("畑面積A", 0)) & "")
                                End If
                        End Select

    nERL = 295:          .田筆数 = .田筆数 - (RsS.NullCast("田面積A", 0) > 0) * n耕作
    nERL = 296:          .畑筆数 = .畑筆数 - (RsS.NullCast("畑面積A", 0) > 0) * n耕作
    nERL = 297:          .樹筆数 = .樹筆数 - (RsS.NullCast("樹園地", 0) > 0) * n耕作
    nERL = 298:          .草筆数 = .草筆数 - (RsS.NullCast("採草放牧面積", 0) > 0) * n耕作

    nERL = 300:          .不耕作田筆数 = .不耕作田筆数 + (RsS.NullCast("田面積A", 0) > 0) * (n耕作 = 0)
    nERL = 301:          .不耕作畑筆数 = .不耕作畑筆数 + (RsS.NullCast("畑面積A", 0) > 0) * (n耕作 = 0)
    nERL = 302:          .不耕作樹筆数 = .不耕作樹筆数 + (RsS.NullCast("樹園地", 0) > 0) * (n耕作 = 0)
    nERL = 303:          .不耕作草筆数 = .不耕作草筆数 + (RsS.NullCast("採草放牧面積", 0) > 0) * (n耕作 = 0)

    nERL = 305:          mvarData3 = mvarData3 & ";" & RsS.Choose("納税猶予対象農地", GetArray("", "贈", "相"), 0)
    nERL = 306:          mvarData3 = mvarData3 & ";" & RsS.Choose("融資対象農地", GetArray("", "取", "買"), 0)
    nERL = 307:          mvarData3 = mvarData3 & ";" & RsS.NullCast("実面積", 0)
                     mvarData3 = mvarData3 & ";" & RsS.NullCast("所有住所", "")
                     mvarData3 = mvarData3 & ";" & RsS.Choose("土地改良法", GetArray("外", "内", "内"))

                     End With
    nERL = 309:          RsS.MoveNext
                Loop
                If dicPerson.Count Then
                    For n = 0 To dicPerson.Count - 1
                        s所有者 = s所有者 & "," & dicPerson.Items(n)
                    Next
                    s所有者 = MID$(s所有者, 2)
                    Set RsP = SystemDB.GetRecordsetEx("SELECT [ID],[氏名] FROM [D:個人INFO] WHERE [ID] IN (" & s所有者 & ")", 0, , Me)
                    Do Until RsP.EOF
                        mvarData3 = Replace(mvarData3, "p" & RsP.ID & "k", RsP.V("氏名"))
                        RsP.MoveNext
                    Loop
                End If


    nERL = 312:      mvarData3 = Replace(mvarData3, vbCrLf & vbCrLf, vbCrLf)
    nERL = 313:      SystemDB.CloseRs RsS

    nERL = 315:      mvarPDW.WaitMessage = "貸出農地情報"
    nERL = 316:      mvarData4 = sBase

    nERL = 318:      St = "SELECT [V_農地].実面積,[V_農地].土地所在,[V_農地].登記簿地目 AS 台帳地目,[V_農地].現況地目,[V_農地].農業振興地域,都市計画法,[V_農地].遊休化,[V_農地].遊休時期,[V_農地].備考,[V_農地].所有者ID,[V_農地].管理人ID,[V_農地].登記簿面積 AS 台帳面積,[V_農地].実面積,[V_農地].自小作別,[D:個人Info].氏名 AS [所有者氏名],[D:個人Info_1].氏名 AS [借受人氏名],[D:個人Info_1].住所 AS [借受人住所],小作地適用法,小作形態,小作開始年月日,小作終了年月日, [小作料] AS 小作料S, [小作料単位] AS 単位S,田面積,畑面積,樹園地,採草放牧面積,[V_農地].部分面積,[V_農地].共有持分分子,[V_農地].共有持分分母 " & _
                 "FROM ([V_農地] LEFT JOIN [D:個人Info] ON [V_農地].管理人ID = [D:個人Info].ID) LEFT JOIN [D:個人Info] AS [D:個人Info_1] ON [V_農地].借受人ID = [D:個人Info_1].ID " & _
                 "WHERE [自小作別]>0 AND " & IIf(mvar基本情報.世帯の有無, "[借受世帯ID] <> " & mvar基本情報.世帯ID, "[借受人ID] <> " & mvar基本情報.世帯主ID) & " AND " & IIf(mvar基本情報.世帯の有無, "[農家世帯ID] = " & mvar基本情報.世帯ID, "[管理人ID] = " & mvar基本情報.世帯主ID) & " " & _
                 "ORDER BY V_農地.大字ID, RIGHT('00000' & IIf(Left([地番],1)='甲',Mid([地番],2,InStr([地番] & '-','-')-2),IIf(Left([地番],1)='乙',Mid([地番],2,InStr([地番] & '-','-')-2),Left([地番],InStr([地番] & '-','-')-1))),6), Mid([地番],InStr([地番] & '-','-')+1)"

    nERL = 323:      Set RsS = SystemDB.GetRecordsetEx(St, 0, , "基本台帳")

    nERL = 325:      Do Until RsS.EOF
                    If RsS.NullCast("所有者ID", "0") <> RsS.NullCast("管理人ID", "0") Then
                        dicPerson.Add "p" & RsS.NullCast("所有者ID", "0"), RsS.NullCast("所有者ID", "0")
                    Else
                        s所有者 = ""
                    End If

    nERL = 326:          mvarData4 = mvarData4 & vbCrLf & SetmvarData(RsS)
    nERL = 327:          mvarData4 = mvarData4 & ";" & RsS.V("借受人氏名")
    nERL = 328:          mvarData4 = mvarData4 & ";" & Choose(RsS.NullCast("小作地適用法", 0) + 1, "", "農", "基", "他", "", "", "")
    nERL = 329:          mvarData4 = mvarData4 & ";" & Choose(RsS.NullCast("小作形態", 0) + 1, "", "賃", "使", "他", "", "", "")
    nERL = 330:          mvarData4 = mvarData4 & ";" & RsS.FormatDateEx("小作開始年月日", "GGEE年MM月DD日")
    nERL = 331:          mvarData4 = mvarData4 & ";" & RsS.FormatDateEx("小作終了年月日", "GGEE年MM月DD日")
    nERL = 332:          mvarData4 = mvarData4 & ";" & IIf(Val(SystemDB.DBProperty("遊休化表示")) And RsS.V("遊休化") And (Not IsNull(RsS.V("遊休時期"))), "遊休", "")
    nERL = 333:          mvarData4 = mvarData4 & ";" & Replace(RsS.NullCast("備考", ""), vbCrLf, vbTab)
                    If RsS.V("自小作別") > 0 And RsS.V("小作形態") = 1 Then
    nERL = 335:              mvarData4 = mvarData4 & ";" & RsS.FormatNumberEx("小作料S", 0) & " " & RsS.V("単位S") '小作料
                    Else
    nERL = 337:              mvarData4 = mvarData4 & ";"
                    End If
    nERL = 339:         mvarData4 = mvarData4 & ";" & StrConv(RsS.V("借受人住所"), vbNarrow)

                    If pMenber.Exists(CStr("世帯員." & RsS.V("所有者ID"))) Then
    nERL = 342:              St = pMenber.Item(CStr("世帯員." & RsS.V("所有者ID")))
    nERL = 343:              Ar = Split(St, ";")
    nERL = 344:              Ar(3) = Val(Ar(3)) + RsS.NullCast("田面積", 0) + RsS.NullCast("畑面積", 0)
    nERL = 345:              St = Join(Ar, ";")
    nERL = 346:              pMenber.Item(CStr("世帯員." & RsS.V("所有者ID"))) = St
                    Else
    nERL = 348:              pMenber.Add CStr("世帯員." & RsS.V("所有者ID")), CStr(RsS.V("所有者氏名") & ";;;" & (RsS.NullCast("田面積", 0) + RsS.NullCast("畑面積", 0)) & ";")
                    End If

                    With mvar基本情報
    nERL = 352:              .貸出田 = .貸出田 + RsS.NullCast("田面積", 0)
    nERL = 353:              .貸出畑 = .貸出畑 + RsS.NullCast("畑面積", 0)
    nERL = 354:              .貸出樹 = .貸出樹 + RsS.NullCast("樹園地", 0)
    nERL = 355:              .貸出草 = .貸出草 + RsS.NullCast("採草放牧面積", 0)
                    End With

    nERL = 357:         RsS.MoveNext
                Loop
    nERL = 359:     mvarData4 = Replace(mvarData4, vbCrLf & vbCrLf, vbCrLf)
    nERL = 360:     SystemDB.CloseRs RsS

                If dicPerson.Count Then
                    For n = 0 To dicPerson.Count - 1
                        s所有者 = s所有者 & "," & dicPerson.Items(n)
                    Next
                    s所有者 = MID$(s所有者, 2)
                    Set RsP = SystemDB.GetRecordsetEx("SELECT [ID],[氏名] FROM [D:個人INFO] WHERE [ID] IN (" & s所有者 & ")", 0, , Me)
                    Do Until RsP.EOF
                        mvarData4 = Replace(mvarData4, "p" & RsP.ID & "k", RsP.V("氏名"))
                        RsP.MoveNext
                    Loop
                End If


    nERL = 362:     Ar = pMenber.Items
                If UBound(Ar) >= 0 Then
    nERL = 364:          For n = 0 To UBound(Ar)
    nERL = 365:              Ar(n) = Replace(Ar(n), ";01;", ";0;")
    nERL = 366:              Ar(n) = Replace(Ar(n), ";02;", ";0;")
    nERL = 367:              Ar(n) = Replace(Ar(n), ";03;", ";0;")
    nERL = 368:              mvarData2 = mvarData2 & vbCrLf & Ar(n)
    nERL = 369:          Next
                End If

    nERL = 372:     mvarData0 = ";1;2"
    nERL = 373:     Ar = Split(mvarData3, vbCrLf)
                If UBound(Ar) > 0 Then
    nERL = 375:          For n = 1 To UBound(Ar)
                        If (n Mod 10) = 1 Then
    nERL = 377:                  mvarData0 = mvarData0 & ";3/" & n
                        End If
    nERL = 379:          Next
                End If

    nERL = 382:     Ar = Split(mvarData4, vbCrLf)
                If UBound(Ar) > 0 Then
    nERL = 384:          For n = 1 To UBound(Ar)
                        If (n Mod 10) = 1 Then
    nERL = 386:                  mvarData0 = mvarData0 & ";4/" & n
                        End If
                    Next
                End If

    nERL = 391:     Ar = Split(mvarData0, ";")
    nERL = 392:     mvarPRP.Parent.MaxPage = UBound(Ar)
    nERL = 393:     With mvarPRP.Parent
    nERL = 394:         .Page = 1
    nERL = 395:         ADApp.Common.DrawPrintData mvarPRP.Parent, "農家基本台帳PG1"
    nERL = 396:     End With
    nERL = 397:     mvarPDW.WaitMessage = ""

    nERL = 399:     mvarPage2BTable.SetWidth 15, GetArray(25, 20, 20, 20, 10, 20, 27)
    nERL = 400:     mvarPage2BTable.SetHeight 43, GetArray(8, 8, 8, 8, 8, 8, 8)
                If Abs(mvar基本情報.不耕作自作田 + mvar基本情報.不耕作小作田) > 0 Then
    nERL = 402:          mvarPage2BTable.SetText FormatNumber(mvar基本情報.自作田 + mvar基本情報.小作田, 0) & vbCrLf & "(" & FormatNumber(Abs(mvar基本情報.不耕作自作田 + mvar基本情報.不耕作小作田), 0) & ")", 1, 1, 11, 1, 1
                Else
    nERL = 404:          mvarPage2BTable.SetText FormatNumber(mvar基本情報.自作田 + mvar基本情報.小作田, 0), 1, 1, 11, 1, 1
                End If

                If mvar基本情報.不耕作自作畑 + mvar基本情報.不耕作小作畑 > 0 Then
    nERL = 408:          mvarPage2BTable.SetText FormatNumber(mvar基本情報.自作畑 + mvar基本情報.小作畑, 0) & vbCrLf & "(" & FormatNumber(Abs(mvar基本情報.不耕作自作畑 + mvar基本情報.不耕作小作畑), 0) & ")", 1, 2, 11, 1, 1
                Else
    nERL = 410:          mvarPage2BTable.SetText FormatNumber(mvar基本情報.自作畑 + mvar基本情報.小作畑, 0), 1, 2, 11, 1, 1
                End If
    nERL = 412:     mvarPage2BTable.SetText FormatNumber(mvar基本情報.自作樹 + mvar基本情報.小作樹, 0), 1, 3, 11, 1, 1

        CPrintCls_DataInit = False
        Exit Function
    ErrExt:
        CPrintCls_DataInit = True
        If Len(SysAD.DebugString) Then sERR = SysAD.DebugString
        MsgBox "次の箇所でエラーが発生しました=>" & sERR, vbCritical
        Exit Function
    ErrorDatainit:
        CPrintCls_DataInit = True
        MsgBox nERL & " 行目:" & Err.Description & vbCrLf & "[" & sParam & "]"
    End Function

    Private Function SetmvarData(Rs As ADBasicLIB2.RecordsetEx) As String
        Dim St As String
        St = Replace(Rs.V("土地所在"), "字.", "")
        St = St & ";" & Replace(mvar基本情報.登記地目.Item("n" & Rs.V("台帳地目")), "普通", "")
        St = St & ";" & Replace(mvar基本情報.現況地目.Item("n" & Rs.V("現況地目")), "普通", "")
        St = St & ";" & Rs.V("台帳面積")

        If Val(Rs.V("共有持分分母")) > 0 And Val(Rs.V("共有持分分子")) > 0 Then
            St = St & ";" & "(" & Rs.V("共有持分分子") & "/" & Rs.V("共有持分分母") & ")"
        ElseIf Rs.IsNull("部分面積") Then
            St = St & ";0"
        ElseIf Val(Rs.V("部分面積")) > 0 Then
            St = St & ";" & "(" & FormatNumber(Rs.V("部分面積"), 0) & ")"
        Else
            St = St & ";0"
        End If

        St = St & ";0"
        St = St & ";0"
        St = St & ";0"
        St = St & ";" & Choose(Rs.NullCast("自小作別", 0) + 1, "自", "小", "農")
        St = St & ";0"
        St = St & ";0"
        If Rs.NullCast("所有者ID", "0") <> Rs.NullCast("管理人ID", "0") Then
            St = St & ";" & Rs.V("所有者氏名") & "\n(p" & Rs.NullCast("所有者ID", "0") & "k)"
        Else
            St = St & ";" & Rs.V("所有者氏名")
        End If
        SetmvarData = St

    End Function
    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants: CPrintCls_Orientation = vbPRORLandscape: End Property
    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&)
        PrintCtrl nNewPage ' mvarParent.Page
    End Sub
    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Set CPrintCls_Parent(RHS As CPrintFormSK): Set mvarPRP.Parent = RHS: End Property

    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        Dim n As Long
        mvarPRP.Parent.PrintPage = 1
        mvarPRP.Parent.PrintMaxPage = mvarPRP.Parent.MaxPage

        'On Error Resume Next
        If bNowPage Then
            PrintCtrl mvarPRP.Parent.Page
            mvarPRP.EndDoc
        Else
            If nStart <= 0 Then nStart = 1
            If nEnd <= 0 Then nEnd = mvarPRP.Parent.MaxPage

            If nEnd < nStart Then nEnd = nStart

            For n = nStart To nEnd
                'mvarPRP.Parent.PrintPage = 1

                'Do Until mvarPRP.Parent.PrintPage > mvarPRP.Parent.PrintMaxPage
                    PrintCtrl n ' mvarPRP.Parent.PrintPage
                    mvarPRP.Parent.NewPage
                'Loop
            Next
            mvarPRP.Parent.EndDoc
        End If
    End Sub

    Private Sub CPrintCls_Repaint()
        On Error Resume Next
        PrintCtrl mvarPRP.Parent.Page
    End Sub
    Private Sub CPrintCls_TargetChange(sKey As String): End Sub

    Private Sub PrintCtrl(n As Long)
        Dim Ar As Variant
        Dim St As String

        On Error Resume Next
        If Len(mvarData0) > 0 Then
        Ar = Split(mvarData0, ";")
        St = Ar(n)
        Select Case Val(St)
            Case 1: Page1 n
            Case 2: Page2 n
            Case 3: Page3 Val(MID$(St, InStr(St, "/") + 1)), n
            Case 4: Page4 Val(MID$(St, InStr(St, "/") + 1)), n
        End Select
        End If
    End Sub

    Private Sub Page1(nNowPage As Long)
        Dim Ar As Variant, Cm As Variant
        Dim n As Long
        Dim y As Long
        Dim x As Long

        On Error Resume Next
        If Len(mvarData) = 0 Then Exit Sub
        With mvarPRP.Parent
            .ClearScreen
            Select Case Fnc.s市町村名
                Case "北郷町":
                    .Offset -6, 0
                Case Else
                    .Offset 0, 0
            End Select

    '-----------------------------表作成
            .TextOut mvar印刷日時, 278, 20, 11, 1

            .LineBoxDX 21, 25, 14, 0, 0, GetArray(8, 149, 8, 99)          '住所&氏名
            .LineBoxDX 21, 63, 9, 8, 9, GetArray(37, 21, 7, 22, 7, 7, 7, 14, 7, 7, 7, 7, 7, 7, 7, 7, 29, 56)   '下の表
            .LineX 199, 228, 67.5, 9, 9                         '資格取得&被保険者の間

            mvarTableA.Draw mvarPRP.Parent, True          '２-Ａ
            .LineBox 21, 177, 35, 190.5, 8, , , 4.5       '２-Ｂ
            .LineBox 125, 152, 139, 161, 6, 2             '２-Ｃ
            .LineBox 142, 174, 195, 178.5, , 3, 6         '２-Ｄ
            .LineBox 200, 174, 285, 178.5, , 3           '２-Ｅ
            .DLine 225, 174, 225, 187.5
            .DLine 235, 174, 235, 187.5

    '-----------------------------------
            .hTextOut "住所 ", 23, 28, 1, 5
            .hTextOut "氏名", 180, 28, 1, 5
    '-----------------------------------
            Ar = Split(mvarData, vbCrLf)
            Cm = Split(Ar(0), ";")
    '-------------------------------データはめ込み用の文字位置
    '            If bSeaclet Then .FontName = "Map Symbols"
            .TextOut mvar基本情報.住所, 34, 33, 11
            .TextOut mvar基本情報.世帯主名, 195, 32, 11
    '            .FontName = "ＭＳ 明朝"
                .TextOut mvar基本情報.集落情報, 175, 34, 11, 1
                .TextOut "〒 " & mvar基本情報.郵便番号, 34, 28, 11     '郵便番号
                .TextOut " " & mvar基本情報.電話番号, 62, 28, 11    '電話番号
    #If Not NONDBG Then
            'On Error GoTo Err_Page1
    #End If
            For n = 1 To UBound(Ar)
                Cm = Split(Ar(n), ";")
                y = n * 9
    '                If bSeaclet Then .FontName = "Map Symbols"
                .TextOut Cm(0), 22, 58.5 + y, 11           '氏名
                '.FontName = "ＭＳ 明朝"
                .TextOut Cm(1), 68.5, 58.5 + y, 11, 2      '続柄
                .TextOut Cm(2), 82.5, 58.5 + y, 11, 2      '性別
                .TextOut Cm(3), 97, 58.5 + y, 11, 2        '生年月日
                .TextOut Cm(4), 111.5, 58.5 + y, 11, 2     '世帯責任者
                .TextOut Cm(5), 118.5, 58.5 + y, 11, 2     '農業経営者
                .TextOut Cm(6), 125.5, 58.5 + y, 11, 2     '農業後継ぎ
                If Val(Cm(7)) > 0 Then .TextOut Cm(7), 142, 58.5 + y, 11, 1    '農業従事日数

                If Not Val(Cm(8)) = 0 Then .TextOut "○", 139.5 + Val(Cm(8)) * 7, 58.5 + y, 11, 2
                If Not Val(Cm(9)) = 0 Then .TextOut "○", 161 + Val(Cm(9)) * 7, 58.5 + y, 11, 2                  '兼業形態

    '                .TextOut Cm(10), 194, 58.5 + Y, 11         '職業
    '                .TextOut Cm(11), 223.5, 58.5 + Y, 11, 2    '加入種別
    '                .TextOut Cm(12), 241.5, 55 + Y, 10, 2      '資格取得年月日
    '                .TextOut Cm(13), 241.5, 59.5 + Y, 11, 2    '被保険者番号
    '                .TextOut Cm(14), 257, 58.5 + Y, 11         '備考

                .TextOut Cm(11), 195.5, 58.5 + y, 11, 2    '加入種別
                .TextOut Cm(12), 213.5, 55 + y, 10, 2      '資格取得年月日
                .TextOut Cm(13), 213.5, 59.5 + y, 9, 2    '被保険者番号
                .TextOut Cm(14), 229, 58.5 + y, 11         '備考
            Next

    '-----------------------------------
            Cm = Split(mvar基本情報.農機具List, ";")
            x = 0
            If UBound(Cm) > -1 Then
                For n = 0 To 13 Step 2
                    If Len(Cm(n)) Then
                        .DrawText Cm(n), 21 + x * 14, 154, 14, 4, 10, 2         '２-Ａ
                        .DrawText Cm(n + 1), 21 + x * 14, 154 + 13, 14, 4, 10, 1        '２-Ａ
                        x = x + 1
                    End If
                Next
            End If

            Cm = Split(mvar基本情報.家畜List, ";")
            x = 0
            If UBound(Cm) > -1 Then
                For n = 0 To 11 Step 2
                    If Len(Cm(n)) Then
                        .DrawText Cm(n), 125 + x * 14, 154, 14, 4, 10, 2         '２-C
                        .DrawText Cm(n + 1), 125 + x * 14, 154 + 9, 14, 4, 10, 1       '２-C
                        x = x + 1
                    End If
                Next
            End If

            Cm = Split(mvar基本情報.販売収入順位List, ";")
            If UBound(Cm) > -1 Then
                For n = 0 To 15
                    If Len(Cm(n)) = 0 Then Exit For
                    .DrawText IIf((n Mod 2), IIf(Val(Cm(n)), "第" & Cm(n) & "位", "-"), Cm(n)), 21 + Int(n / 2) * 14, 178 + (n Mod 2) * 7, 14, 4, 10, 2            '２-B
                Next
            End If
            .DrawObject 1
            Select Case mvar基本情報.申告方法
                Case 1: .DCircle 145, 172 + mvar基本情報.申告方法 * 4.5, 2, 0
                        If mvar基本情報.申告年月日 <> 0 Then .TextOut Format(mvar基本情報.申告年月日, "GEE"), 167, 175, 10
                Case 2, 3: .DCircle 145, 172 + mvar基本情報.申告方法 * 4.5, 2, 0
            End Select

            .TextOut "認定農業者", 201, 175, 10
            .TextOut "担い手農家", 201, 179.5, 10
            .TextOut "家族経営協定", 201, 184, 10

            If Val(mvar基本情報.認定農業者の有無) > 0 Then
                .TextOut "有", 228, 175, 10
                If IsDate(mvar基本情報.認定農業者の認定日) Then .TextOut mvar基本情報.認定番号 & " " & Format(mvar基本情報.認定農業者の認定日, "GEE/MM") & "認定", 235, 175, 10
            Else
                .TextOut "無", 228, 175, 10
            End If
            If Val(mvar基本情報.担い手農家の有無) > 0 Then
                .TextOut "有", 228, 179.5, 10
                If IsDate(mvar基本情報.担い手農家の認定日) Then .TextOut mvar基本情報.認定番号 & " " & Format(mvar基本情報.担い手農家の認定日, "GEE/MM") & "認定", 235, 179, 10
            Else
                .TextOut "無", 228, 179.5, 10
            End If
            If mvar基本情報.家族経営協定 Then
                .TextOut "締結", 226, 184, 10
            End If
        End With
        Exit Sub
    Err_Page1:
        MsgBox "問題点ページ1:" & Err.Description, vbInformation

    End Sub

    Private Sub Page2(nNowPage As Long)
        Dim Ar As Variant, Cm As Variant
        Dim Ay As Variant
        Dim SX As Single
        Dim n As Long
        Dim dX(7) As Single, hX(7) As Single
        Dim dX1(6) As Single, hX1(6) As Single

        On Error Resume Next
    '        On Error GoTo Err_Page2
        If Len(mvarData) = 0 Then Exit Sub
        With mvarPRP.Parent
            .ClearScreen
            Select Case Fnc.s市町村名
                Case "北郷町"
                    .Offset -4, 0
                Case Else
                    .Offset 0, 0
            End Select
            SX = 14
    '-----------------------------表作成
            .LineBoxDX 15, 23, 14, 0, 0, GetArray(8, 149, 8, 102)  '住所&氏名
    '-----------------------------３番土地総括表
            .LineBoxDX 15, 43, 8, 7, 8, GetArray(25, 70, 20, 27)    '項目全体
            Ay = GetArray(25, 20, 20, 20, 10, 20, 27)

            dX(0) = SX
            For n = 0 To UBound(Ay)
                dX(n + 1) = dX(n) + Ay(n)
            Next
            .LineBoxDX 40, 47, 4, 7, 8, GetArray(20, 20, 20, 10)   '総面積→小作地まで
    '-------------------------------
            Ay = GetArray(30, 22.5, 22.5, 22.5, 22.5, 22.5)
            .LineBoxDX 15, 114, 8, 8, 8, Ay                     '４番権利名義人
            dX1(0) = SX
            For n = 0 To UBound(Ay)
                dX1(n + 1) = dX1(n) + Ay(n)
            Next
    '-----------------------------５番経営意向等
            .LineBox 170, 50, 198, 58, 4, , 6    '５-Ａ
    '-------------------------------
            .LineBox 170, 67, 198, 75, , 3, 6     'Ｂ-１
            .LineXY 205, 67, 7, 3, 8, 11            'Ｂ-２
            .DBox 170, 94, 182, 126             'Ｂ-３
            .LineBox 176, 94, 226, 102, 1, 4    'Ｂ-３
            .DBox 230, 94, 242, 126             'Ｂ-４
            .LineBox 236, 94, 282, 102, 1, 4    'Ｂ-４
            .LineBox 170, 134, 282, 142, , 3, 6 '横枠まるごと(Ｃ)
            .DLine 265, 134, 265, 150           '有無仕切り線
    '-------------------------------
            .DBox 170, 166, 282, 186            '備考
    '-----------------------------------
            .hTextOut "住所", 17, 26, 1, 5
            .hTextOut "氏名", 174, 26, 1, 5
    '---------------------------文字埋め
            .TextOut mvar印刷日時, 278, 18, 11, 1
            ADApp.Common.DrawPrintData mvarPRP.Parent, "農家基本台帳B"
            .hTextOut "特 定 処 分対 象 農 地", 94, 115, 7, 4, 8


            If mvar基本情報.経営意向 > 0 Then .DCircle 173 + (mvar基本情報.経営意向 - 1) * 28, 54, 3, vbBlack, 1 ' mvar基本情報.経営意向 = Cm(0)
            If mvar基本情報.経営計画 > 0 Then .DCircle 173, 70.5 + Choose(mvar基本情報.経営計画, 0, 1, 2) * 9, 3, vbBlack, 1 ' mvar基本情報.経営意向 = Cm(0)
            If mvar基本情報.拡大縮小方法 > 0 Then
                .DCircle 179 + Int((mvar基本情報.拡大縮小方法 - 1) / 4) * 60, 98 + ((mvar基本情報.拡大縮小方法 - 1) Mod 4) * 8, 3, vbBlack, 1   ' mvar基本情報.経営意向 = Cm(0)
                If Val(mvar基本情報.希望面積) > 0 Then .TextOut mvar基本情報.希望面積 & "u", 222 + Int((mvar基本情報.拡大縮小方法 - 1) / 4) * 60, 96 + ((mvar基本情報.拡大縮小方法 - 1) Mod 4) * 8, 10, 1
            End If
            Cm = Split(mvar基本情報.経営計画List, ";")
            If UBound(Cm) > -1 Then
                For n = 0 To 9
                    If Len(Cm(n)) = 0 Then Exit For
                    If (n Mod 2) = 0 Then
                        .DrawText Cm(n), 215 + Int(n / 2) * 11, 78 + (n Mod 2) * 9, 12, 4, 10, IIf((n Mod 2) = 0, 2, 1)
                    ElseIf Val(Cm(n)) > 0 Then
                        .DCircle 220 + Int(n / 2) * 11, 55 + Val(Cm(n)) * 16, 2, vbBlack
                    End If

                Next
            End If
            .DCircle 270 + (1 - mvar基本情報.農用地改善団体参加) * 6, 138, 3, vbBlack '.農用地改善団体参加
            .DCircle 270 + (1 - mvar基本情報.地域農業集団構成員) * 6, 146, 3, vbBlack '.地域農業集団構成員 = RsS.NullCast("地域農業集団構成員", 0)
            .TextOut mvar基本情報.その他の団体への参加, 225, 152, 9, 2

            .hTextOut "拡大方法", 171, 102, 1
            .hTextOut "縮小方法", 231, 102, 1
    '-----------------------------------
            Ar = Split(mvarData2, vbCrLf)
            Cm = Split(Ar(0), ";")
    '            If bSeaclet Then .FontName = "Map Symbols"
                .TextOut mvar基本情報.住所, 28, 32, 11
                .TextOut mvar基本情報.世帯主名, 190, 29, 11
    '            .FontName = "ＭＳ 明朝"

            .TextOut mvar基本情報.集落情報, 130, 32, 11
            .TextOut "〒 " & Left$(mvar基本情報.郵便番号 & "          ", 10) & "   " & mvar基本情報.電話番号, 28, 25, 11   '郵便番号 & 電話番号


            If mvar基本情報.不耕作自作田 + mvar基本情報.不耕作自作畑 + mvar基本情報.不耕作自作樹 + mvar基本情報.不耕作小作田 + mvar基本情報.不耕作小作畑 + mvar基本情報.不耕作小作樹 > 0 Then
                .TextOut FormatNumber(mvar基本情報.自作田 + mvar基本情報.自作畑 + mvar基本情報.自作樹 + mvar基本情報.小作田 + mvar基本情報.小作畑 + mvar基本情報.小作樹, 0), dX(2), 79 - 4, 11, 1
                .TextOut "(" & FormatNumber(mvar基本情報.不耕作自作田 + mvar基本情報.不耕作自作畑 + mvar基本情報.不耕作自作樹 + mvar基本情報.不耕作小作田 + mvar基本情報.不耕作小作畑 + mvar基本情報.不耕作小作樹, 0) & ")", dX(2), 79, 11, 1
            Else
                .TextOut FormatNumber(mvar基本情報.自作田 + mvar基本情報.自作畑 + mvar基本情報.自作樹 + mvar基本情報.小作田 + mvar基本情報.小作畑 + mvar基本情報.小作樹, 0), dX(2), 79, 11, 1
            End If

            .TextOut FormatNumber(mvar基本情報.自作草 + mvar基本情報.小作草, 0), dX(2), 87, 11, 1

            If mvar基本情報.不耕作自作田 > 0 Then
                .TextOut FormatNumber(mvar基本情報.自作田, 0), dX(3), 55 - 4, 11, 1
                .TextOut "(" & FormatNumber(mvar基本情報.不耕作自作田, 0) & ")", dX(3), 55, 11, 1
            Else
                .TextOut FormatNumber(mvar基本情報.自作田, 0), dX(3), 55, 11, 1
            End If

            If mvar基本情報.不耕作自作畑 > 0 Then
                .TextOut FormatNumber(mvar基本情報.自作畑, 0), mvarPage2BTable.CellLeft(3), 63 - 4, 11, 1
                .TextOut "(" & FormatNumber(mvar基本情報.不耕作自作畑, 0) & ")", dX(3), 63, 11, 1
            Else
                .TextOut FormatNumber(mvar基本情報.自作畑, 0), mvarPage2BTable.CellLeft(3), 63, 11, 1
            End If


            If mvar基本情報.不耕作自作畑 + mvar基本情報.不耕作自作畑 + mvar基本情報.不耕作自作樹 > 0 Then
                .TextOut FormatNumber(mvar基本情報.自作田 + mvar基本情報.自作畑 + mvar基本情報.自作樹, 0), dX(3), 79 - 4, 11, 1
                .TextOut "(" & FormatNumber(mvar基本情報.不耕作自作田 + mvar基本情報.不耕作自作畑 + mvar基本情報.不耕作自作樹, 0) & ")", dX(3), 79, 11, 1
            Else
                .TextOut FormatNumber(mvar基本情報.自作田 + mvar基本情報.自作畑 + mvar基本情報.自作樹, 0), dX(3), 79, 11, 1
            End If

            .TextOut FormatNumber(mvar基本情報.自作樹, 0), mvarPage2BTable.CellLeft(3), 71, 11, 1
            .TextOut FormatNumber(mvar基本情報.自作草, 0), mvarPage2BTable.CellLeft(3), 87, 11, 1

            .TextOut FormatNumber(mvar基本情報.小作田, 0), dX(4), 55, 11, 1
            .TextOut FormatNumber(mvar基本情報.小作畑, 0), dX(4), 63, 11, 1
            .TextOut FormatNumber(mvar基本情報.小作樹, 0), dX(4), 71, 11, 1
            .TextOut FormatNumber(mvar基本情報.小作田 + mvar基本情報.小作畑 + mvar基本情報.小作樹, 0), dX(4), 79, 11, 1
            .TextOut FormatNumber(mvar基本情報.小作草, 0), dX(4), 87, 11, 1


            If mvar基本情報.不耕作田筆数 Then
                .TextOut FormatNumber(mvar基本情報.田筆数, 0), dX(5), 55 - 4, 11, 1
                .TextOut "(" & FormatNumber(Abs(mvar基本情報.不耕作田筆数), 0) & ")", dX(5), 55, 11, 1
            Else
                .TextOut FormatNumber(mvar基本情報.田筆数, 0), dX(5), 55, 11, 1
            End If
            If mvar基本情報.不耕作畑筆数 Then
                .TextOut FormatNumber(mvar基本情報.畑筆数, 0), dX(5), 63 - 4, 11, 1
                .TextOut "(" & FormatNumber(Abs(mvar基本情報.不耕作畑筆数), 0) & ")", dX(5), 63, 11, 1
            Else
                .TextOut FormatNumber(mvar基本情報.畑筆数, 0), dX(5), 63, 11, 1
            End If
            .TextOut FormatNumber(mvar基本情報.樹筆数, 0), dX(5), 71, 11, 1
            If mvar基本情報.不耕作田筆数 + mvar基本情報.不耕作畑筆数 + mvar基本情報.不耕作樹筆数 Then
                .TextOut FormatNumber(mvar基本情報.田筆数 + mvar基本情報.畑筆数 + mvar基本情報.樹筆数, 0), dX(5), 79 - 4, 11, 1
                .TextOut "(" & FormatNumber(mvar基本情報.不耕作田筆数 + mvar基本情報.不耕作畑筆数 + mvar基本情報.不耕作樹筆数, 0) & ")", dX(5), 79, 11, 1
            Else
                .TextOut FormatNumber(mvar基本情報.田筆数 + mvar基本情報.畑筆数 + mvar基本情報.樹筆数, 0), dX(5), 79, 11, 1
            End If
            .TextOut FormatNumber(mvar基本情報.草筆数, 0), dX(5), 87, 11, 1

            .TextOut FormatNumber(mvar基本情報.貸出田, 0), dX(6), 55, 11, 1
            .TextOut FormatNumber(mvar基本情報.貸出畑, 0), dX(6), 63, 11, 1
            .TextOut FormatNumber(mvar基本情報.貸出樹, 0), dX(6), 71, 11, 1
            .TextOut FormatNumber(mvar基本情報.貸出田 + mvar基本情報.貸出畑 + mvar基本情報.貸出樹, 0), dX(6), 79, 11, 1
            .TextOut FormatNumber(mvar基本情報.貸出草, 0), dX(6), 87, 11, 1

            .DrawText mvar基本情報.備考, 170, 166, 282 - 170, 4, 11

            For n = 1 To UBound(Ar)
                Cm = Split(Ar(n), ";")
                If Len(Ar(n)) Then
'                If bSeaclet Then .FontName = "Map Symbols"
                .TextOut Cm(0), dX1(0) + 2, 116.5 + n * 8, 11
                .FontName = "ＭＳ 明朝"
                .TextOut FormatNumber(Val(Cm(1)), 0), dX1(2), 116.5 + n * 8, 11, 1
                .TextOut FormatNumber(Val(Cm(2)), 0), dX1(3), 116.5 + n * 8, 11, 1
                .TextOut FormatNumber(Val(Cm(4)), 0), dX1(4), 116.5 + n * 8, 11, 1

                .TextOut FormatNumber(Val(Cm(1)) + Val(Cm(2)) + Val(Cm(4)), 0), dX1(5), 116.5 + n * 8, 11, 1
                .TextOut FormatNumber(Val(Cm(3)), 0), dX1(6), 116.5 + n * 8, 11, 1
                End If
            Next
            mvarPage2BTable.Draw mvarPRP.Parent
    '-----------------------------------
        End With
        If Len(mvar基本情報.証明文) And nNowPage = mvarPRP.Parent.MaxPage Then
            mvarPRP.Parent.DrawText mvar基本情報.証明文, 100, 188, 2000, 4, 10, 0, 0
        End If
        Exit Sub
    Err_Page2:
        MsgBox "問題点ページ2:" & Err.Description, vbInformation
    End Sub
    Private Sub Page3(LPage As Long, nNowPage As Long)
        Dim Ar As Variant, Cm As Variant
        Dim Ay As Variant
        Dim i As Long
        Dim y As Long
        Dim YY As Long
        Dim St As String
        Dim n As Long
        Dim dX(17) As Single, hX(17) As Single
        Dim nPit As Single, HH As Single, Rows As Long
        Dim SY As Single

        On Error Resume Next
    '        On Error GoTo Err_Page3
        Ay = GetArray(48, 6, 6, 16, 6, 6, 6, 6, 6, 6, 34, 34, 6, 6, 26, 6, 41)
        nPit = 12
        HH = 21
        Rows = 10

        dX(0) = 21: hX(0) = dX(0) + Ay(0) / 2
        For i = 0 To UBound(Ay)
            dX(i + 1) = dX(i) + Ay(i)
            If i < UBound(Ay) Then hX(i + 1) = dX(i + 1) + Ay(i + 1) / 2
        Next

        With mvarPRP.Parent
            .Offset 0, 0
            .ClearScreen
    '-----------------------------表作成
            ADApp.Common.DrawPrintData mvarPRP.Parent, "農家基本台帳C"

            .LineBoxDX 21, 23, 14, 0, 0, GetArray(8, 149, 8, 99)          '住所&氏名
            .LineBoxDX 21, 44, 21, 10, 12, GetArray(48, 12, 16, 18, 6, 6, 6, 68, 38, 6, 41)   'おおまかな表の線
            SY = 49
            If b現況表示 Then .DLine dX(3), 54, dX(4), 54
            .LineX dX(14), dX(15), SY + HH - 5 + (nPit / 3), Rows, nPit
            .LineX dX(14), dX(15), SY + HH - 5 + ((nPit / 3) * 2), Rows, nPit
    '-----------------------------------
    '---------------------------文字埋め
            .TextOut mvar印刷日時, dX(16), 18, 11
            .hTextOut "住所", 23, 25, 1, 6
            .hTextOut "氏名", 180, 25, 1, 6
            .hTextOut "登記簿", dX(1) + 1, 51, 1, 4
            .hTextOut "現況", dX(2) + 1, 52.5, 1, 5
            .hTextOut "農振法", dX(4) + 1, 50, 1, 5
            .hTextOut "都市計画", dX(5) + 1.5, 49.5, 1, 4, 9
            .hTextOut "土地改良", dX(6) + 1.5, 49.5, 1, 4, 9
            .hTextOut "自・小作別", dX(7) + 1.5, 45.5, 1, , 10
            .hTextOut "納税猶予対象", dX(8) + 1.5, 44.8, 1, , 9
            .hTextOut "融資対象農地", dX(9) + 1.5, 44.8, 1, , 9

            .hTextOut "適用法", dX(12) + 1, 50, 1, 5
            .hTextOut "形態", dX(13) + 1, 53, 1, 5
            .hTextOut "作付状況", dX(15) + 1, 45, 1, 5
    '-----------------------------------
            Ar = Split(mvarData3, vbCrLf)
            Cm = Split(Ar(0), ";")
    '-------------------------------データはめ込み用の文字位置
    '            If bSeaclet Then .FontName = "Map Symbols"
                .TextOut mvar基本情報.住所, 35, 31, 11
                .TextOut mvar基本情報.世帯主名, 195, 28.5, 11
    '            .FontName = "ＭＳ 明朝"
            .TextOut mvar基本情報.集落情報, 140, 33, 11
            .TextOut "〒 " & Left$(mvar基本情報.郵便番号 & "        ", 8) & "     " & mvar基本情報.電話番号, 31, 25, 11

            If UBound(Ar) > 0 Then
            For i = LPage To LPage + 9
                If i > UBound(Ar) Then Exit For
                Cm = Split(Ar(i), ";")
                n = i - LPage + 1
                YY = n * 12
                If UBound(Cm) > -1 Then
                    .DrawText Cm(0), dX(0) + 1, 57 + YY, 44, 4, 11, 0
                    .VText Left$(Cm(1), 3), hX(1), 59 + YY, 10, 2, 2
                    .VText Left$(Cm(2), 3), hX(2), 59 + YY, 10, 2, 2
                    If Cm(3) <> Cm(25) And b現況表示 Then
                        .DLine dX(3), 59 + YY, dX(4), 59 + YY
                        .DrawText FormatNumber(Val(Cm(3)), 0) & "\n\n" & FormatNumber(Val(Cm(25)), 0) & "", dX(3), 55 + YY, Ay(3), 4, 10, 1, 2, 10
                    Else
                        Select Case mode面積表示
                            Case 1:
                                .TextOut FormatNumber(Val(Cm(3)), 0), dX(4) - 1, 59 + YY, 10, 1, 2
                            Case Else
                                .TextOut FormatNumber(Val(Cm(25)), 0), dX(4) - 1, 59 + YY, 10, 1, 2
                        End Select
                    End If

                    .TextOut Cm(20), hX(4), 57.5 + YY, 10, 2
                    .TextOut Cm(21), hX(5), 57.5 + YY, 10, 2
                    .TextOut Cm(27), hX(6), 57.5 + YY, 10, 2
                    .TextOut Cm(8), hX(7), 57.5 + YY, 10, 2
                    .TextOut Cm(23), hX(8), 57.5 + YY, 10, 2
                    .TextOut Cm(24), hX(9), 57.5 + YY, 10, 2
    '                    If bSeaclet Then .FontName = "Map Symbols"
                        If Left$(Cm(26), Len(Fnc.s市町村名)) = Fnc.s市町村名 Then Cm(26) = MID$(Cm(26), Len(Fnc.s市町村名) + 1)
                        If Left$(Cm(26), 2) = "大字" Then Cm(26) = MID$(Cm(26), 3)
                        St = Cm(11) & IIf(Len(Cm(26)), "\n" & Cm(26), "")
                        .DrawText St, dX(10) + 1, 56 + YY + y, Ay(10), 4, IIf(Len(Cm(26)) > 20, 7, IIf(Len(Cm(11)) > 9, 8, 9)), 0, 2, 10
                        y = IIf(Len(Cm(12)) > 18, -4, 0)
                        .DrawText Cm(12), dX(11) + 1, 57.5 + YY + y, Ay(11), 4
    '                    .FontName = "ＭＳ 明朝"
                    .TextOut Cm(13), hX(12), 57.5 + YY, 10, 2
                    .TextOut Cm(14), hX(13), 57.5 + YY, 10, 2
                    .TextOut Cm(15), hX(14), 55 + YY, 10, 2, 2
                    .TextOut Cm(16), hX(14), 59 + YY, 10, 2, 2
                    .TextOut Cm(22), hX(15), 59 + YY, 10, 2, 2
                    .VText Cm(17), hX(15), 56 + YY, 10, 2, 2
                    .DrawText Replace(Cm(18), vbTab, vbCrLf), dX(16) + 1, 54 + YY, 40, 4, IIf(Len(Cm(18)) > 18, 8, 9)

                    If InStr(Cm(19), " ") <= 1 Then
                        .DrawText "−", dX(14), 61 + YY, Ay(14), 4, , 2, 2, 4
                    ElseIf InStr(Cm(19), " ") = 2 Then
                        If Trim(Cm(19)) = 0 Then
                            .DrawText "−", dX(14), 61 + YY, Ay(14), 4, , 2, 2, 4
                        Else
                            .DrawText Cm(19), dX(14), 61 + YY, Ay(14), 4, , 2, 2, 4
                        End If
                    Else
                        Cm(19) = Replace(Cm(19), "（全部で）", "/全")
                        .DrawText Cm(19), dX(14), 61 + YY, Ay(14), 4, , 2, 2, 4
                    End If
                End If
            Next
            End If
        End With

        If Len(mvar基本情報.証明文) And nNowPage = mvarPRP.Parent.MaxPage Then
            mvarPRP.Parent.DrawText mvar基本情報.証明文, 100, 188, 2000, 4, 10, 0, 0
        End If
        Exit Sub
    Err_Page3:
        MsgBox "問題点ページ3:" & Err.Description, vbInformation
    End Sub
    Private Sub Page4(LPage As Long, nNowPage As Long)
        Dim Ar As Variant, Cm As Variant
        Dim Ay As Variant
        Dim i As Long
        Dim y As Long
        Dim n As Long
        Dim dX(17) As Single, hX(17) As Single
        Dim nPit As Single, HH As Single, Rows As Long
        Dim SY As Single

        Ay = GetArray(48, 6, 6, 16, 30, 38, 40, 6, 6, 26, 6, 36)
        nPit = 12
        HH = 21
        Rows = 10

        dX(0) = 21
        hX(0) = dX(0) + Ay(0) / 2
        For i = 0 To UBound(Ay)
            dX(i + 1) = dX(i) + Ay(i)
            If i < UBound(Ay) Then hX(i + 1) = dX(i + 1) + Ay(i + 1) / 2
        Next

        On Error Resume Next
       With mvarPRP.Parent
            .ClearScreen
            Select Case Fnc.s市町村名
                Case "北郷町"
                    .ScaleLeft = 6
            End Select
    '-----------------------------表作成
            ADApp.Common.DrawPrintData mvarPRP.Parent, "農家基本台帳D"


            .LineBoxDX dX(0), 23, 14, 0, 0, GetArray(8, 149, 8, 99)                      '住所&氏名
            .LineBoxDX dX(0), 44, 21, 10, 12, GetArray(48, 12, 16, 30, 78, 38, 6, 36)    'おおまかな表の線

            .LineX dX(9), dX(10), 69, 10, 12
            .LineX dX(9), dX(10), 73, 10, 12

            SY = 49

            .hTextOut "住所", 23, 25, 1, 6
            .hTextOut "氏名", 180, 25, 1, 6
            .hTextOut "登記簿", dX(1) + 1, 51, 1, 4
            .hTextOut "現況", dX(2) + 1, 52.5, 1, 5
            .hTextOut "適用法", dX(7) + 1, 50, 1, 5
            .hTextOut "形態", dX(8) + 1, 53, 1, 5
            .hTextOut "奨励金", dX(10) + 1, 47, 1, 6

            Ar = Split(mvarData4, vbCrLf)
            Cm = Split(Ar(0), ";")
    '-------------------------------データはめ込み用の文字位置
            .TextOut mvar印刷日時, 278, 18, 11, 1
            If Not bSeaclet Then
                .TextOut mvar基本情報.住所, 35, 31, 11
                .TextOut mvar基本情報.世帯主名, 195, 28.5, 11
            End If

            .TextOut mvar基本情報.集落情報, 140, 33, 11
            .TextOut "〒 " & Left$(mvar基本情報.郵便番号 & "        ", 8) & "     " & mvar基本情報.電話番号, 31, 25, 11
            If UBound(Ar) > 0 Then
            For i = LPage To LPage + 9
                If i > UBound(Ar) Then Exit For
                Cm = Split(Ar(i), ";")
                n = i - LPage + 1
                If UBound(Cm) > -1 Then
                    .DrawText Cm(0), dX(0) + 1, 57 + n * 12, Ay(0), 4, 11, 0
                    .VText Cm(1), hX(1), 59 + n * 12, 10, 2, 2
                    .VText Cm(2), hX(2), 59 + n * 12, 10, 2, 2
                    If Cm(4) = "0" Then
                        .TextOut FormatNumber(Val(Cm(3)), 0), dX(4) - 1, 59 + n * 12, 10, 1, 2
                    Else
                        .TextOut FormatNumber(Val(Cm(3)), 0), dX(4) - 1, 55 + n * 12, 10, 1
                        .TextOut Cm(4), dX(4), 60 + n * 12, 10, 1
                    End If
'                    If bSeaclet Then .FontName = "Map Symbols"
                        y = IIf(Len(Cm(11)) > 16, -4, 0)
                        .DrawText Cm(11), dX(4) + 1, 57.5 + n * 12 + y, Ay(4), 4
                        y = IIf(Len(Cm(12)) > 22, -4, 0)
                        .DrawText Cm(12), dX(5) + 1, 57.5 + n * 12 + y, Ay(5), 4
                        y = IIf(Len(Cm(12)) > 22, -4, 0)
                        .DrawText Cm(20), dX(6) + 0.5, 57.5 + n * 12 + y, Ay(6), 4
                    .FontName = "ＭＳ 明朝"
                    .TextOut Cm(13), hX(7), 58.5 + n * 12, 10, 2, 2
                    .TextOut Cm(14), hX(8), 58.5 + n * 12, 10, 2, 2
                    .TextOut Cm(15), hX(9), 55 + n * 12, 10, 2, 2
                    .TextOut Cm(16), hX(9), 59 + n * 12, 10, 2, 2
                    .DrawText Replace(Cm(18), vbTab, vbCrLf), dX(11) + 1, 53 + n * 12, Ay(11), 4, 9
                    If InStr(Cm(19), " ") <= 1 Then
                        .TextOut "−", hX(9), 63 + n * 12, 10, 2, 2
                    ElseIf InStr(Cm(19), " ") = 2 Then
                        If Trim(Cm(19)) = 0 Then
                            .TextOut "−", hX(9), 63 + n * 12, 10, 2, 2
                        Else
                            .TextOut Cm(19), dX(10) - 1, 63 + n * 12, 10, 1, 2
                        End If
                    Else
                        .TextOut Trim(Cm(19)), dX(10) - 1, 63 + n * 12, 10, 1, 2
                    End If
                End If
            Next

            End If
        If Len(mvar基本情報.証明文) And nNowPage = mvarPRP.Parent.MaxPage Then
            mvarPRP.Parent.DrawText mvar基本情報.証明文, 100, 188, 2000, 4, 10, 0, 0
        End If

        End With
    End Sub


End Class










Class C農家基本台帳2
    Option Explicit
    Implements ADBasicLIB2.CDataviewSK
        Private DVProperty As CDataviewProperty

    Implements ADBasicLIB2.CPrintCls
        Private mvarPRP As CPrintProperty

    Private mvarKey As String

    Private mvar印刷日時 As String
    Private bSeaclet As Boolean

    Private mvarData0 As String
    Private mvarData As String
    Private mvarData2 As String
    Private mvarData3 As String
    Private mvarData4 As String

    Private mvarXMLData As New CXMLDoc
    Private mvarPage2BTable As New CDrawTable
    
    Private nPageF As Long
    Private nPCnt As Long   '経営農地のページ数
    Private Const Rows = 10
    Private Const nPit = 12
    Private Const nFs = 9
    Private Const HH = 24
    Private Const SX = 12
    Private PA As Long
    Private XPage As Long
    Private i As Long
    Private j As Long
    
    Private Ay As Variant
    
    Private dX3(20) As Single
    Private hX3(20) As Single
    Private sData3 As Variant
    
    Private dX4(12) As Single
    Private hX4(12) As Single
    Private sData4 As Variant

    Private Type type農家
        登記地目 As ADBasicLIB2.CDataDictionary
        現況地目 As ADBasicLIB2.CDataDictionary
        世帯ID As Long
        世帯の有無 As Boolean
        世帯主名 As String
        世帯主ID As Long
        住所 As String
        集落情報 As String
        郵便番号 As String
        電話番号 As String
        備考     As String
        申告方法 As Long
        申告年月日 As Date
        認定番号 As String
        認定農業者の有無 As String
        認定農業者の認定日 As String
        担い手農家の有無 As String
        担い手農家の認定日 As String
        家族経営協定 As String
        家族経営協定の認定日 As String

        住民コード As String
        農機具List As String
        家畜List As String
        販売収入順位List As String
        経営意向 As Long
        経営計画 As Long
        経営計画List As String
        拡大縮小方法 As Long
        希望面積 As Long
        農用地改善団体参加 As Long
        地域農業集団構成員 As Long
        その他の団体への参加 As String
        採草放牧地面積 As Long
        証明文 As String

        自作田 As Long
        自作畑 As Long
        自作樹 As Long
        自作草 As Long

        不耕作自作田 As Long
        不耕作自作畑 As Long
        不耕作自作樹 As Long
        不耕作自作草 As Long

        小作田 As Long
        小作畑 As Long
        小作樹 As Long
        小作草 As Long

        不耕作小作田 As Long
        不耕作小作畑 As Long
        不耕作小作樹 As Long
        不耕作小作草 As Long

        田筆数 As Long
        畑筆数 As Long
        樹筆数 As Long
        草筆数 As Long

        不耕作田筆数 As Long
        不耕作畑筆数 As Long
        不耕作樹筆数 As Long
        不耕作草筆数 As Long

        貸出田 As Long
        貸出畑 As Long
        貸出樹 As Long
        貸出草 As Long

        不耕作貸出田 As Long
        不耕作貸出畑 As Long
        不耕作貸出樹 As Long
        不耕作貸出草 As Long

        台帳登記面積 As Boolean
    End Type

    Private mode面積表示 As Long
    Private b現況表示 As Boolean
    Private mvarTableA As New CPrintTable
    Private mvar基本情報 As type農家

    Private Sub Class_Initialize(): Set mvarPRP = New CPrintProperty: Set DVProperty = mvarPDW.DataviewCol.GetNewDVP: End Sub

    Public Property Get Key() As String: Key = DVProperty.Key: End Property
    Public Property Let Key(ByVal RHS As String): DVProperty.SetDVP RHS: End Property

    Private Sub CDataviewSK_CloseRecordset(): End Sub

    Private Property Set CDataviewSK_Container(ByVal RHS As ADBasicLIB2.CPDW)
        Dim St As String

        Set DVProperty.Controls.Parent = Me
        Set DVProperty.Containner = RHS
        DVProperty.LocationString = ""

        St = "小作料の印刷,0,YesNo;印刷日時の表示,0,YesNo;隠し,0,YesNo;遊休化表示,0,YesNo"
        '
        ADApp.Common.SetAppPropertyView DVProperty.Controls, St
        DVProperty.Controls.AttachData
    End Property

    Private Sub CDataviewSK_DblClick(): mvarPDW.DataviewCol.Add Me: End Sub

    Private Function CDataviewSK_DoCommand2(sCmd As String, Optional sParam As String = "") As Variant
        Select Case sCmd
    '/*************データビュー**************/
            Case "開く": CDataviewSK_DblClick
            Case "閉じる": ADApp.DataviewCol.Remove DVProperty.Key
            Case "更新": DVProperty.Controls.UpdateControlValues
            Case "メニュー": CDataviewSK_PopupMenu
        End Select
    End Function

    Private Sub CDataviewSK_DropDown(sSourceList As String, Optional sOption As String = "")
        Select Case Fnc.GetKeyHead(sSourceList)
            Case "農家": mvarPDW.PrintGo Me, sSourceList
        End Select
    End Sub

    Private Property Set CDataviewSK_DVProperty(ByVal RHS As ADBasicLIB2.CDataviewProperty): Set DVProperty = RHS: End Property
    Private Property Get CDataviewSK_DVProperty() As ADBasicLIB2.CDataviewProperty: Set CDataviewSK_DVProperty = DVProperty: End Property

    Private Function CDataviewSK_GetProperty2(sPropName As String, Optional sParam As String = "") As Variant
        Select Case sPropName
            Case "名称": CDataviewSK_GetProperty2 = "農家基本台帳"
            Case "Icon": Set CDataviewSK_GetProperty2 = LoadResPicture("AvailNOKOpen", vbResIcon)
            Case "IconName": CDataviewSK_GetProperty2 = CDataviewSK_IconName
            Case Else
                Debug.Assert False 'Non Code
        End Select
    End Function

    Private Property Get CDataviewSK_IconName() As String: CDataviewSK_IconName = "NOUKADAICHO": End Property

    Private Property Get CDataviewSK_IsUpdated() As Boolean: CDataviewSK_IsUpdated = DVProperty.Controls.IsUpdated: End Property

    Private Property Get CDataviewSK_Key() As String: CDataviewSK_Key = DVProperty.Key: End Property
    Private Property Let CDataviewSK_Key(ByVal RHS As String): End Property

    Private Property Get CDataviewSK_ParentKey() As String: End Property

    Private Function CDataviewSK_PopupMenu(Optional ByVal sParam As String = "", Optional vParam As Variant) As String
        Dim St As String
        St = "開く;"
        If Not DVProperty.Body Is Nothing Then St = St & "-;閉じる;"
        CDataviewSK_DoCommand2 SysAD.PopupMenu(St)
    End Function

    Private Sub CDataviewSK_Refresh(Optional bReLoad As Boolean = False): End Sub

    Private Property Get CPrintCls_CanCancelPrint() As Boolean:
        CPrintCls_CanCancelPrint = True
    End Property
    Private Property Get CPrintCls_CanPrintNowPage() As Boolean: CPrintCls_CanPrintNowPage = True: End Property

    Private Property Let CPrintCls_Key(ByVal RHS As String): End Property
    Private Property Get CPrintCls_Key() As String: CPrintCls_Key = DVProperty.Key: End Property

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean
        Dim pMenber As New ADBasicLIB2.CDataDictionary
        Dim RsS As ADBasicLIB2.RecordsetEx
        Dim RsG As ADBasicLIB2.RecordsetEx
        Dim RsP As ADBasicLIB2.RecordsetEx
        Dim sSQL As String

        Dim Ar As Variant
        Dim Cm As Variant
        Dim n As Long
        
        Dim St As String
        Dim sBase As String
        Dim n田 As Long
        Dim n畑 As Long
        Dim n樹園地 As Long

        Dim n田筆数 As Long
        Dim n畑筆数 As Long
        Dim n樹園地筆数 As Long

        Dim n田計 As Long
        Dim n畑計 As Long
        Dim n樹園地計 As Long
        Dim sERR As String
        Dim n耕作 As Long
        Dim pDt As Date
        Dim nERL As Long
        Dim dicPerson As New ADBasicLIB2.CDataDictionary
        Dim s所有者 As String

        On Error GoTo ErrorDatainit
    nERL = 1:        With mvarPRP.Parent
    nERL = 2:            .PrintMode("白紙可能") = True
    nERL = 3:            .PrintMode("部数印刷") = True
    nERL = 4:            .PrintMode("ページ指定可") = True
    nERL = 5:            .表示倍率 = 1 '0.75
    nERL = 6:        End With
                If InStr(sParam, "|") Then
    nERL = 7:           mvarKey = Left$(sParam, InStr(sParam, "|") - 1)
                    mvar印刷日時 = CDate(MID$(sParam, InStr(sParam, "|") + 1))
                Else
    nERL = 8:           mvarKey = sParam
                End If
    nERL = 9:        DVProperty.SetDVP mvarKey
    nERL = 10:       bSeaclet = Val(SystemDB.DBProperty("隠し"))
                 mode面積表示 = Val(SystemDB.DBProperty("台帳面積表示"))

    nERL = 11:       mvarTableA.Move 21, 152
    nERL = 12:           mvarTableA.bAllHLine = True
    nERL = 13:           mvarTableA.bAllVLine = True
    nERL = 14:       mvarTableA.SetColumnWidth -1, GetArray(14, 14, 14, 14, 14, 14, 14)
    nERL = 15:       mvarTableA.SetRowHeight -1, GetArray(15, 6)

    nERL = 16:       nPageF = 0

    nERL = 17:       With mvar基本情報
    nERL = 18:          .証明文 = Trim(SystemDB.DBProperty("基本台帳への証明文"))
                    b現況表示 = Val(SystemDB.DBProperty("農地基本台帳現況面積表示"))
                    If Len(.証明文) Then
    nERL = 20:               With Fnc.InputMulti("農地基本台帳の証明", "証明文を印刷しますか", "印刷の有無;YesNo;-1|証明日;日付", , True)
                            If Not .ReturnCancel Then
                                If .Item("印刷の有無") Then
    nERL = 23:                           mvar基本情報.証明文 = SystemDB.StrReplace(mvar基本情報.証明文)
    nERL = 24:                           mvar基本情報.証明文 = Format(CDate(.Item("証明日")), mvar基本情報.証明文)
                                Else
    nERL = 26:                           mvar基本情報.証明文 = ""
                                End If
                            Else
    nERL = 29:                       mvar基本情報.証明文 = ""
                            End If
                        End With
                    Else

    neRL = 34:           End If
    neRL = 35:           .住民コード = SystemDB.DBProperty("台帳記載住民コード")
    neRL = 36:           If Len(.住民コード) = 0 Then MsgBox "台帳表示の対象となる住民コードが登録されていません", vbCritical: Exit Function
    neRL = 37:           Set .登記地目 = SysAD.ExtFunction.DoFunction("コード辞書の取得", , "SELECT 'n' & [ID] AS [KEY],[名称] FROM V_地目")
    neRL = 38:           Set .現況地目 = SysAD.ExtFunction.DoFunction("コード辞書の取得", , "SELECT 'n' & [ID] AS [KEY],[名称] FROM V_現況地目")
    neRL = 39:           .台帳登記面積 = Val(SystemDB.DBProperty("台帳登記面積"))
    neRL = 40:       End With
                If Not Fnc.TrueOrFalse(SystemDB.DBProperty("印刷日時の表示")) Then
                ElseIf mvar印刷日時 = "" And Fnc.TrueOrFalse(SystemDB.DBProperty("基本台帳日付変更")) Then
                    With Fnc.InputData("基本台帳の発行日付", "日付を入力してください", Nothing, "発効日;日付;%%Now%%")
                        If Not .IsObtained Then
                            CPrintCls_DataInit = True: Exit Function
                        ElseIf .IsDate("発行日") Then
                            mvar印刷日時 = Format(.Item("発行日"), "GGGEE年MM月DD日")
                        End If
                    End With
                Else
    neRL = 51:           mvar印刷日時 = Format(Now(), "GGGEE年MM月DD日")
                End If
    neRL = 53:      Select Case Fnc.GetKeyHead(mvarKey)
                    Case "農家":
    neRL = 55:              mvar基本情報.世帯ID = Fnc.GetKeyCode(mvarKey)
    neRL = 56:              Set RsS = SystemDB.GetRecordsetEx("SELECT [D:世帯Info].世帯主ID,[D:世帯Info].採草放牧地面積,[D:世帯Info].農家番号,[D:個人Info].氏名,[D:個人Info].住所,[D:個人Info].電話番号,[D:個人Info].郵便番号,[農用地改善団体参加],[地域農業集団構成員],[その他の団体への参加],[V_行政区].[名称] AS [集落],[D:世帯Info].[備考],[青色申告],[青色申告開始日],[家族経営協定] " & _
                        "FROM ([D:世帯Info] LEFT JOIN [D:個人Info] ON [D:世帯Info].世帯主ID = [D:個人Info].ID) LEFT JOIN [V_行政区] ON [D:個人Info].行政区ID = [V_行政区].ID " & _
                        "WHERE [D:世帯Info].[ID]=" & mvar基本情報.世帯ID, 0, , Me)
    neRL = 59:
                        If RsS.IsNoRecord Then
    neRL = 61:                   SystemDB.CloseRs RsS
    neRL = 62:                   Exit Function
                        Else
                            With mvar基本情報

    neRL = 74:                       .世帯の有無 = True
    neRL = 75:                       .住所 = StrConv(RsS.NullCast("住所", "世帯主の住所が入力されていません"), vbNarrow)
    neRL = 76:                       .世帯主ID = RsS.V("世帯主ID")
    neRL = 77:                       .世帯主名 = RsS.NullCast("氏名", "世帯主の入力が不適当です")
    neRL = 78:                       .集落情報 = RsS.NullCast("集落", "") & "(" & Right$("00000000" & RsS.NullCast("農家番号", 0), 7) & ")"
    neRL = 79:                       .電話番号 = RsS.NullCast("電話番号", ""): If Left$(.電話番号, 4) = "0000" Then .電話番号 = ""

    neRL = 80:                       .郵便番号 = RsS.NullCast("郵便番号", "")
    neRL = 81:                       .採草放牧地面積 = RsS.NullCast("採草放牧地面積", 0)
    neRL = 82:                       .申告方法 = RsS.NullCast("青色申告", 0)
    neRL = 83:                       .申告年月日 = RsS.NullCast("青色申告開始日", 0)
    neRL = 84:                       .備考 = RsS.NullCast("備考", "")
    neRL = 85:                       .農用地改善団体参加 = RsS.NullCast("農用地改善団体参加", 0)
    neRL = 86:                       .地域農業集団構成員 = RsS.NullCast("地域農業集団構成員", 0)
    neRL = 87:                       .その他の団体への参加 = RsS.NullCast("その他の団体への参加", "")
                                 .家族経営協定 = RsS.V("家族経営協定")
                            End With
    neRL = 89:                  SystemDB.CloseRs RsS
                        End If
    neRL = 91:
    neRL = 92:              Set RsS = SystemDB.GetRecordsetEx(DVProperty.StrReplace("SELECT V_農機具01.名称, D_世帯営農.農機具数量1, V_農機具02.名称, D_世帯営農.農機具数量2, V_農機具03.名称, D_世帯営農.農機具数量3, V_農機具04.名称, D_世帯営農.農機具数量4, V_農機具05.名称, D_世帯営農.農機具数量5, V_農機具06.名称, D_世帯営農.農機具数量6, V_農機具07.名称, D_世帯営農.農機具数量7 FROM ((((((D_世帯営農 LEFT JOIN V_農機具 AS V_農機具01 ON D_世帯営農.農機具種類1 = V_農機具01.ID) LEFT JOIN V_農機具 AS V_農機具02 ON D_世帯営農.農機具種類2 = V_農機具02.ID) LEFT JOIN V_農機具 AS V_農機具03 ON D_世帯営農.農機具種類3 = V_農機具03.ID) LEFT JOIN V_農機具 AS V_農機具04 ON D_世帯営農.農機具種類4 = V_農機具04.ID) LEFT JOIN V_農機具 AS V_農機具05 ON D_世帯営農.農機具種類5 = V_農機具05.ID) LEFT JOIN V_農機具 AS V_農機具06 ON D_世帯営農.農機具種類6 = V_農機具06.ID) LEFT JOIN V_農機具 AS V_農機具07 ON D_世帯営農.農機具種類7 = V_農機具07.ID WHERE (((D_世帯営農.ID)=%DVP.ID%));"), , , Me)
                        If Not RsS.IsNoRecord Then
    neRL = 94:                   mvar基本情報.農機具List = RsS.GetString(";", vbBack)
                        End If
    neRL = 96:              RsS.CloseRs
    neRL = 97:              Set RsS = SystemDB.GetRecordsetEx(DVProperty.StrReplace("SELECT V_家畜01.名称, D_世帯営農.家畜数量1, V_家畜02.名称, D_世帯営農.家畜数量2, V_家畜03.名称, D_世帯営農.家畜数量3, V_家畜04.名称, D_世帯営農.家畜数量4, V_家畜05.名称, D_世帯営農.家畜数量5, V_家畜06.名称, D_世帯営農.家畜数量6, V_家畜07.名称, D_世帯営農.家畜数量7 FROM ((((((D_世帯営農 LEFT JOIN V_家畜 AS V_家畜01 ON D_世帯営農.家畜種類1 = V_家畜01.ID) LEFT JOIN V_家畜 AS V_家畜02 ON D_世帯営農.家畜種類2 = V_家畜02.ID) LEFT JOIN V_家畜 AS V_家畜03 ON D_世帯営農.家畜種類3 = V_家畜03.ID) LEFT JOIN V_家畜 AS V_家畜04 ON D_世帯営農.家畜種類4 = V_家畜04.ID) LEFT JOIN V_家畜 AS V_家畜05 ON D_世帯営農.家畜種類5 = V_家畜05.ID) LEFT JOIN V_家畜 AS V_家畜06 ON D_世帯営農.家畜種類6 = V_家畜06.ID) LEFT JOIN V_家畜 AS V_家畜07 ON D_世帯営農.家畜種類7 = V_家畜07.ID WHERE (((D_世帯営農.ID)=%DVP.ID%));"), , , Me)
                        If Not RsS.IsNoRecord Then
    neRL = 99:                   mvar基本情報.家畜List = RsS.GetString(";", vbBack)
                        End If
    neRL = 101:             RsS.CloseRs
    neRL = 102:             Set RsS = SystemDB.GetRecordsetEx(DVProperty.StrReplace("SELECT '米',[販売収入順位米],'畜産',[販売収入順位畜産],'果樹',[販売収入順位果樹],'そさい',[販売収入順位そさい],'養蚕',[販売収入順位養蚕],[販売収入名称その他１],[販売収入順位その他１],[販売収入名称その他２],[販売収入順位その他２],[販売収入名称その他３],[販売収入順位その他３] FROM [D_世帯営農] WHERE (((D_世帯営農.ID)=%DVP.ID%));"), , , Me)
                        If Not RsS.IsNoRecord Then
    neRL = 104:                  mvar基本情報.販売収入順位List = Replace(RsS.GetString(";", vbBack), vbBack, "")
                        End If
    neRL = 106:             RsS.CloseRs
    neRL = 107:             Set RsS = SystemDB.GetRecordsetEx(DVProperty.StrReplace("SELECT D_世帯営農.経営意向, D_世帯営農.経営計画, D_世帯営農.希望面積, D_世帯営農.拡大縮小方法, '%$%' AS 式1,'米麦作', D_世帯営農.経営計画米麦作,'畜産', D_世帯営農.経営計画畜産,'果樹', D_世帯営農.経営計画果樹,'そさい', D_世帯営農.経営計画そさい,'養蚕', D_世帯営農.経営計画養蚕 FROM D_世帯営農 WHERE (((D_世帯営農.ID)=%DVP.ID%));"), 0, , Me)
                        If Not RsS.IsNoRecord Then
    neRL = 109:                  Ar = Split(RsS.GetString(";", "%$%"), "%$%")
    neRL = 110:                  Cm = Split(Ar(0), ";")
    neRL = 111:                  mvar基本情報.経営意向 = Val(Cm(0))
    neRL = 112:                  mvar基本情報.経営計画 = Val(Cm(1))
    neRL = 113:                  mvar基本情報.希望面積 = Val(Cm(2))
    neRL = 114:                  mvar基本情報.拡大縮小方法 = Val(Cm(3))
    neRL = 115:                  mvar基本情報.経営計画List = MID$(Ar(1), 2)
                        End If
    neRL = 117:             RsS.CloseRs
                    Case "世帯員":
    neRL = 119:              mvar基本情報.世帯主ID = Fnc.GetKeyCode(mvarKey)
    neRL = 120:              mvar基本情報.世帯ID = SystemDB.GetDirectData("D:個人Info", "世帯ID", mvar基本情報.世帯主ID)

                        Set RsS = SystemDB.GetRecordsetEx("SELECT [D:世帯Info].ID as SID,[D:世帯Info].採草放牧地面積,[D:世帯Info].農家番号,[D:個人Info].電話番号 AS 世帯電話,[D:個人Info].郵便番号 AS 世帯郵便,[D:個人Info].氏名,[D:個人Info].住所,[D:個人Info].電話番号,[D:個人Info].郵便番号,[V_行政区].[名称] AS [集落] " & _
                        "FROM ([D:個人Info] LEFT JOIN [D:世帯Info] ON [D:個人Info].世帯ID = [D:世帯Info].ID) LEFT JOIN [V_行政区] ON [D:個人Info].行政区ID = [V_行政区].ID " & _
                        "WHERE [D:個人Info].[ID]=" & mvar基本情報.世帯主ID, 0, , Me)
    neRL = 125:
                        If RsS.IsNoRecord Then
    neRL = 127:                  SystemDB.CloseRs RsS
    neRL = 128:                  Exit Function
                        Else
                            With mvar基本情報
    neRL = 131:                      .世帯の有無 = Not (RsS.NullCast("SID", 0) = 0)
    neRL = 132:                      .住所 = RsS.NullCast("住所", "世帯主の住所が入力されていません")
    neRL = 133:                      .世帯主名 = RsS.NullCast("氏名", "世帯主の入力が不適当です")
    neRL = 134:                      .集落情報 = RsS.NullCast("集落", "") & "(" & Right$("00000000" & RsS.NullCast("農家番号", 0), 7) & ")"
    neRL = 135:                      .電話番号 = RsS.NullCast("電話番号", RsS.NullCast("世帯電話", ""))
    neRL = 136:                      .郵便番号 = RsS.NullCast("郵便番号", RsS.NullCast("世帯郵便", ""))
    neRL = 137:                      .採草放牧地面積 = RsS.NullCast("採草放牧地面積", 0)
    neRL = 138:                      .備考 = ""
                            End With
    neRL = 140:                  SystemDB.CloseRs RsS
                        End If
    neRL = 142:         Case Else
    neRL = 143:             CPrintCls_DataInit = True
                        MsgBox "指定された世帯員情報が見つかりません", vbCritical
                        Exit Function
    neRL = 144:     End Select

    neRL = 146:     sBase = ";;;;;"
    neRL = 147:     mvarData = sBase

    neRL = 149:     mvarPDW.WaitMessage = "世帯員情報"
    neRL = 150:     sSQL = "SELECT *,[V_続柄].[名称] & 'の' & [V続柄2].[名称] & 'の' & [V続柄3].[名称] AS [続柄] " & _
                "FROM (([D:個人Info] LEFT JOIN [V_続柄] ON [D:個人Info].[続柄1]=[V_続柄].[ID]) LEFT JOIN [V_続柄] AS [V続柄2] ON [D:個人Info].[続柄2]=[V続柄2].[ID]) LEFT JOIN [V_続柄] AS [V続柄3] ON [D:個人Info].[続柄3]=[V続柄3].[ID] " & _
                "WHERE " & IIf(mvar基本情報.世帯の有無, "[世帯ID]=" & mvar基本情報.世帯ID & " AND [住民区分] IN (" & SystemDB.DBProperty("台帳記載住民コード") & ")", "[D:個人Info].ID=" & mvar基本情報.世帯主ID) & _
                " ORDER BY [続柄1],[続柄2]"
    neRL = 154:      Set RsG = SystemDB.GetRecordsetEx(sSQL, 0, , "基本台帳")

                Do Until RsG.EOF
    neRL = 157:         St = RsG.V("氏名") & ";"
    neRL = 158:         If IsNull(RsG.V("続柄")) Then St = St & ";" Else St = St & RsG.V("続柄") & ";"
    neRL = 159:         St = Replace(St, "の-", "")
    neRL = 160:         Do While Right$(St, 2) = "の;": St = Left$(St, Len(St) - 2) & ";": Loop

                    Select Case RsG.NullCast("農業改善計画認定", 0)
                        Case 1: mvar基本情報.認定農業者の有無 = 1
                                mvar基本情報.認定農業者の認定日 = RsG.NullCast("認定日", "")
                                mvar基本情報.認定番号 = RsG.NullCast("認定番号", "")
                        Case 2: mvar基本情報.担い手農家の有無 = 1
                                mvar基本情報.担い手農家の認定日 = RsG.NullCast("認定日", "")
                                mvar基本情報.認定番号 = RsG.NullCast("認定番号", "")
                    End Select

    neRL = 162:         St = St & RsG.Choose("性別", GetArray("-", "男", "女"), -1) & ";"
    neRL = 163:         St = St & RsG.FormatDateEx("生年月日", "GGEE/MM/DD") & ";"
    neRL = 164:         St = St & IIf(RsG.NullCast("世帯責任者", 0), "○", "") & ";"
    neRL = 165:         St = St & IIf(RsG.NullCast("農業経営者", 0), "○", "") & ";"
    neRL = 166:         St = St & IIf(RsG.NullCast("農業跡継ぎ", 0), "○", "") & ";"

    neRL = 168:         St = St & Fnc.NullCast(RsG.V("農業従事日数"), "") & ";"
    neRL = 169:         St = St & IIf(IsNull(RsG.V("自家農業従事程度")), "0;", RsG.V("自家農業従事程度") & ";")
                    If IsNull(RsG.V("兼業形態")) Then
    neRL = 171:              St = St & "0;"
                    ElseIf RsG.V("兼業形態") < 5 Then
    neRL = 173:              St = St & CStr(RsG.V("兼業形態")) & ";"
                    Else
    neRL = 175:              St = St & "0;"
                    End If

    neRL = 178:          St = St & RsG.V("職業") & ";"
    neRL = 179:          If IsNull(RsG.V("農年加入種別")) Then St = St & ";" Else St = St & MID$(" 当任未", Val(RsG.V("農年加入種別")) + 1, 1) & ";"
    neRL = 180:          If IsNull(RsG.V("資格取得年月日")) Then St = St & ";" Else St = St & RsG.FormatDateEx("資格取得年月日", "GEE/MM/DD") & ";"
    neRL = 181:          If IsNull(RsG.V("被保険者番号")) Then St = St & ";" Else St = St & RsG.V("被保険者番号") & ";"
    neRL = 182:          St = St & RsG.V("備考") & ";"

    neRL = 184:          mvarData = mvarData & vbCrLf & St
    neRL = 185:          RsG.MoveNext
    neRL = 186:      Loop
    neRL = 187:      SystemDB.CloseRs RsG

    neRL = 189:      mvarPDW.WaitMessage = "経営農地情報"

    neRL = 191:      mvarData2 = sBase
    neRL = 192:      mvarData2 = mvarData2 & ";;;;"
    neRL = 193:      mvarData2 = mvarData2 & ";;;;"
    neRL = 194:      mvarData2 = mvarData2 & ";;;;"
    neRL = 195:      mvarData2 = mvarData2 & ";;;;"
    neRL = 196:      mvarData2 = mvarData2 & ";;;;"

    '3/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    neRL = 198:      mvarData3 = sBase

    '    neRL = 200:     St = "SELECT DISTINCTROW V_農地.土地所在, V_農地.登記簿地目 AS 台帳地目, V_農地.現況地目, V_農地.登記簿面積 AS 台帳面積, V_農地.実面積, V_農地.農業振興地域, V_農地.都市計画法, V_農地.土地改良法, V_農地.生産緑地法, V_農地.自小作別, [D:個人Info].氏名 AS 所有者氏名, Null AS [所有住所], Null AS 借受人氏名, Null AS 借受人住所, 0 AS [小作地適用法],0 AS [小作形態],0 AS [小作開始年月日],0 AS [小作終了年月日],Null AS [小作料S],Null AS [単位S], V_農地.利用状況報告対象, V_農地.利用状況報告年月日, V_農地.是正勧告日, V_農地.是正内容, V_農地.是正期限, V_農地.根拠条件農地法, V_農地.根拠条件基盤強化法, V_農地.是正確認, V_農地.是正状況, V_農地.取消年月日, V_農地.取消事由, V_農地.取消条件農地法, V_農地.取消条件基盤強化法, V_農地.届出年月日, V_農地.届出事由, V_農地.届出者氏名, V_農地.あっせん希望, V_農地.無断転用調査日, V_農地.調査結果農地法, V_農地.無断転用, V_農地.解消意向, V_農地.農業委員会の指導年月,V_農地.遊休指導通知期限 , V_農地.遊休指導内容, " & _
                     "V_農地.市町村長の勧告年月, V_農地.遊休通知農地法, V_農地.遊休解消届出, V_農地.遊休解消斡旋, V_農地.遊休利用増進勧告日, V_農地.是正勧告内容, V_農地.遊休利用増進是正期限, V_農地.遊休利用増進農地法, V_農地.遊休利用増進是正確認, V_農地.遊休利用増進是正状況, V_農地.利用増進通知日, V_農地.利用増進協議者名, V_農地.納税猶予対象農地, V_農地.融資対象農地, V_農地.租税処置法, V_農地.営農困難, V_農地.仮登記日, V_農地.仮登記氏名, V_農地.仮登記住所, V_農地.備考, V_農地.大字ID, V_農地.所有者ID, V_農地.管理人ID, V_農地.融資対象農地, V_農地.納税猶予対象農地, V_農地.借受人ID, V_農地.遊休化, V_農地.遊休時期, V_農地.備考," & IIf(mvar基本情報.台帳登記面積, "SGN([田面積])*[登記簿面積] AS [田面積A],SGN([畑面積])*[登記簿面積] AS [畑面積A]", "田面積 AS [田面積A],畑面積 AS [畑面積A]") & ", 樹園地,採草放牧面積,[V_農地].部分面積,[V_農地].共有持分分子,[V_農地].共有持分分母,農地状況 " & _
                     "FROM (V_農地 LEFT JOIN [D:個人Info] ON V_農地.管理人ID = [D:個人Info].ID) LEFT JOIN [D:個人Info] AS [D:個人Info_1] ON V_農地.借受人ID = [D:個人Info_1].ID " & _
                     "WHERE [自小作別]<1 AND " & IIf(mvar基本情報.世帯の有無, "[農家世帯ID] = " & mvar基本情報.世帯ID, "[管理人ID] = " & mvar基本情報.世帯主ID) & " AND ((V_農地.農地状況)<20) " & _
                     "ORDER BY V_農地.大字ID, V_農地.土地所在 " & _
                     "UNION ALL " & _
                     "SELECT DISTINCTROW V_農地.土地所在, V_農地.登記簿地目 AS 台帳地目, V_農地.現況地目, V_農地.登記簿面積 AS 台帳面積, V_農地.実面積, V_農地.農業振興地域, V_農地.都市計画法, V_農地.土地改良法, V_農地.生産緑地法, V_農地.自小作別, [D:個人Info].氏名 AS 所有者氏名,[D:個人Info].住所 AS [所有住所], [D:個人Info_1].氏名 AS 借受人氏名, [D:個人Info_1].住所 AS 借受人住所, V_農地.小作地適用法, V_農地.小作形態, V_農地.小作開始年月日, V_農地.小作終了年月日, [小作料] AS 小作料S, [小作料単位] AS 単位S, V_農地.利用状況報告対象, V_農地.利用状況報告年月日, V_農地.是正勧告日, V_農地.是正内容, V_農地.是正期限, V_農地.根拠条件農地法, V_農地.根拠条件基盤強化法, V_農地.是正確認, V_農地.是正状況, V_農地.取消年月日, V_農地.取消事由, V_農地.取消条件農地法, V_農地.取消条件基盤強化法, V_農地.届出年月日, V_農地.届出事由, V_農地.届出者氏名, V_農地.あっせん希望, V_農地.無断転用調査日, V_農地.調査結果農地法, V_農地.無断転用,V_農地.解消意向, V_農地.農業委員会の指導年月 , V_農地.遊休指導通知期限, V_農地.遊休指導内容, " & _
                     "V_農地.市町村長の勧告年月, V_農地.遊休通知農地法, V_農地.遊休解消届出, V_農地.遊休解消斡旋, V_農地.遊休利用増進勧告日, V_農地.是正勧告内容, V_農地.遊休利用増進是正期限, V_農地.遊休利用増進農地法, V_農地.遊休利用増進是正確認, V_農地.遊休利用増進是正状況, V_農地.利用増進通知日, V_農地.利用増進協議者名, V_農地.納税猶予対象農地, V_農地.融資対象農地, V_農地.租税処置法, V_農地.営農困難, V_農地.仮登記日, V_農地.仮登記氏名, V_農地.仮登記住所, V_農地.備考, V_農地.大字ID, V_農地.所有者ID, V_農地.管理人ID, V_農地.融資対象農地, V_農地.納税猶予対象農地, V_農地.借受人ID, V_農地.遊休化, V_農地.遊休時期, V_農地.備考, V_農地.田面積, V_農地.畑面積, V_農地.樹園地, V_農地.採草放牧面積, [V_農地].部分面積, [V_農地].共有持分分子, [V_農地].共有持分分母, 農地状況 " & _
                     "FROM (V_農地 LEFT JOIN [D:個人Info] ON V_農地.管理人ID = [D:個人Info].ID) LEFT JOIN [D:個人Info] AS [D:個人Info_1] ON V_農地.借受人ID = [D:個人Info_1].ID " & _
                     "WHERE [自小作別]>0 AND " & IIf(mvar基本情報.世帯の有無, "[借受世帯ID] = " & mvar基本情報.世帯ID, "[借受人ID] = " & mvar基本情報.世帯主ID) & " AND ((V_農地.農地状況)<20) " & _
                     "ORDER BY V_農地.大字ID, V_農地.土地所在;"
    neRL = 200:     St = "SELECT DISTINCTROW V_農地.土地所在, V_農地.登記簿地目 AS 台帳地目, V_農地.現況地目, V_農地.登記簿面積 AS 台帳面積, V_農地.実面積, V_農地.農業振興地域, V_農地.都市計画法, V_農地.土地改良法, V_農地.生産緑地法, V_農地.自小作別, [D:個人Info].氏名 AS 所有者氏名, Null AS [所有住所], Null AS 借受人氏名, Null AS 借受人住所, 0 AS [小作地適用法],0 AS [小作形態],0 AS [小作開始年月日],0 AS [小作終了年月日],Null AS [小作料S],Null AS [単位S], V_農地.利用状況報告対象, V_農地.利用状況報告年月日, V_農地.是正勧告日, V_農地.是正内容, V_農地.是正期限, V_農地.根拠条件農地法, V_農地.根拠条件基盤強化法, V_農地.是正確認, V_農地.是正状況, V_農地.取消年月日, V_農地.取消事由, V_農地.取消条件農地法, V_農地.取消条件基盤強化法, V_農地.届出年月日, V_農地.届出事由, V_農地.届出者氏名, V_農地.あっせん希望, V_農地.無断転用調査日, V_農地.調査結果農地法, V_農地.無断転用, V_農地.解消意向, V_農地.農業委員会の指導年月,V_農地.遊休指導通知期限 , V_農地.遊休指導内容, " & _
                     "V_農地.市町村長の勧告年月, V_農地.遊休通知農地法, V_農地.遊休解消届出, V_農地.遊休解消斡旋, V_農地.遊休利用増進勧告日, V_農地.是正勧告内容, V_農地.遊休利用増進是正期限, V_農地.遊休利用増進農地法, V_農地.遊休利用増進是正確認, V_農地.遊休利用増進是正状況, V_農地.利用増進通知日, V_農地.利用増進協議者名, V_農地.納税猶予対象農地, V_農地.融資対象農地, V_農地.租税処置法, V_農地.営農困難, V_農地.仮登記日, V_農地.仮登記氏名, V_農地.仮登記住所, V_農地.備考, V_農地.大字ID, V_農地.所有者ID, V_農地.管理人ID, V_農地.融資対象農地, V_農地.納税猶予対象農地, V_農地.借受人ID, V_農地.遊休化, V_農地.遊休時期, V_農地.備考," & IIf(mvar基本情報.台帳登記面積, "SGN([田面積])*[登記簿面積] AS [田面積A],SGN([畑面積])*[登記簿面積] AS [畑面積A]", "田面積 AS [田面積A],畑面積 AS [畑面積A]") & ", 樹園地,採草放牧面積,[V_農地].部分面積,[V_農地].共有持分分子,[V_農地].共有持分分母,農地状況 " & _
                     "FROM (V_農地 LEFT JOIN [D:個人Info] ON V_農地.管理人ID = [D:個人Info].ID) LEFT JOIN [D:個人Info] AS [D:個人Info_1] ON V_農地.借受人ID = [D:個人Info_1].ID " & _
                     "WHERE [自小作別]<1 AND " & IIf(mvar基本情報.世帯の有無, "[農家世帯ID] = " & mvar基本情報.世帯ID, "[管理人ID] = " & mvar基本情報.世帯主ID) & " " & _
                     "ORDER BY V_農地.大字ID, V_農地.土地所在 " & _
                     "UNION ALL " & _
                     "SELECT DISTINCTROW V_農地.土地所在, V_農地.登記簿地目 AS 台帳地目, V_農地.現況地目, V_農地.登記簿面積 AS 台帳面積, V_農地.実面積, V_農地.農業振興地域, V_農地.都市計画法, V_農地.土地改良法, V_農地.生産緑地法, V_農地.自小作別, [D:個人Info].氏名 AS 所有者氏名,[D:個人Info].住所 AS [所有住所], [D:個人Info_1].氏名 AS 借受人氏名, [D:個人Info_1].住所 AS 借受人住所, V_農地.小作地適用法, V_農地.小作形態, V_農地.小作開始年月日, V_農地.小作終了年月日, [小作料] AS 小作料S, [小作料単位] AS 単位S, V_農地.利用状況報告対象, V_農地.利用状況報告年月日, V_農地.是正勧告日, V_農地.是正内容, V_農地.是正期限, V_農地.根拠条件農地法, V_農地.根拠条件基盤強化法, V_農地.是正確認, V_農地.是正状況, V_農地.取消年月日, V_農地.取消事由, V_農地.取消条件農地法, V_農地.取消条件基盤強化法, V_農地.届出年月日, V_農地.届出事由, V_農地.届出者氏名, V_農地.あっせん希望, V_農地.無断転用調査日, V_農地.調査結果農地法, V_農地.無断転用,V_農地.解消意向, V_農地.農業委員会の指導年月 , V_農地.遊休指導通知期限, V_農地.遊休指導内容, " & _
                     "V_農地.市町村長の勧告年月, V_農地.遊休通知農地法, V_農地.遊休解消届出, V_農地.遊休解消斡旋, V_農地.遊休利用増進勧告日, V_農地.是正勧告内容, V_農地.遊休利用増進是正期限, V_農地.遊休利用増進農地法, V_農地.遊休利用増進是正確認, V_農地.遊休利用増進是正状況, V_農地.利用増進通知日, V_農地.利用増進協議者名, V_農地.納税猶予対象農地, V_農地.融資対象農地, V_農地.租税処置法, V_農地.営農困難, V_農地.仮登記日, V_農地.仮登記氏名, V_農地.仮登記住所, V_農地.備考, V_農地.大字ID, V_農地.所有者ID, V_農地.管理人ID, V_農地.融資対象農地, V_農地.納税猶予対象農地, V_農地.借受人ID, V_農地.遊休化, V_農地.遊休時期, V_農地.備考, V_農地.田面積, V_農地.畑面積, V_農地.樹園地, V_農地.採草放牧面積, [V_農地].部分面積, [V_農地].共有持分分子, [V_農地].共有持分分母, 農地状況 " & _
                     "FROM (V_農地 LEFT JOIN [D:個人Info] ON V_農地.管理人ID = [D:個人Info].ID) LEFT JOIN [D:個人Info] AS [D:個人Info_1] ON V_農地.借受人ID = [D:個人Info_1].ID " & _
                     "WHERE [自小作別]>0 AND " & IIf(mvar基本情報.世帯の有無, "[借受世帯ID] = " & mvar基本情報.世帯ID, "[借受人ID] = " & mvar基本情報.世帯主ID) & " " & _
                     "ORDER BY V_農地.大字ID, V_農地.土地所在;"


    neRL = 209:      Set RsS = SystemDB.GetRecordsetEx(St, 0, , Me)
    neRL = 210:      Do Until RsS.EOF
                    If RsS.NullCast("所有者ID", "0") <> RsS.NullCast("管理人ID", "0") Then
                        dicPerson.Add "p" & RsS.NullCast("所有者ID", "0"), RsS.NullCast("所有者ID", "0")
                    Else
                        s所有者 = ""
                    End If

    neRL = 211:         mvarData3 = mvarData3 & vbBack & SetmvarData(RsS, 3)

    neRL = 230:         n耕作 = IIf(IsNull(RsS.V("農地状況")), 1, IIf(RsS.V("農地状況") > 19, 0, 1))
    neRL = 231:         With mvar基本情報
                        Select Case RsS.NullCast("自小作別", 0)
                            Case 0, -1, -8
    neRL = 234:                     .自作田 = .自作田 + RsS.NullCast("田面積A", 0) * n耕作
    neRL = 235:                     .自作畑 = .自作畑 + RsS.NullCast("畑面積A", 0) * n耕作
    neRL = 236:                     .自作樹 = .自作樹 + RsS.NullCast("樹園地", 0) * n耕作
    neRL = 237:                     .自作草 = .自作草 + RsS.NullCast("採草放牧面積", 0) * n耕作
    neRL = 238:
    neRL = 239:                     .不耕作自作田 = .不耕作自作田 - RsS.NullCast("田面積A", 0) * (n耕作 = 0)
    neRL = 240:                     .不耕作自作畑 = .不耕作自作畑 - RsS.NullCast("畑面積A", 0) * (n耕作 = 0)
    neRL = 241:                     .不耕作自作樹 = .不耕作自作樹 - RsS.NullCast("樹園地", 0) * (n耕作 = 0)
    neRL = 242:                     .不耕作自作草 = .不耕作自作草 - RsS.NullCast("採草放牧面積", 0) * (n耕作 = 0)

                                If pMenber.Exists(CStr("世帯員." & RsS.V("管理人ID"))) Then
    neRL = 245:                         St = pMenber.Item("世帯員." & RsS.V("管理人ID"))
    neRL = 246:                         Ar = Split(St, ";")
    neRL = 247:                         Ar(1) = Val(Ar(1)) + Val(RsS.V("田面積A")) + Val(RsS.V("畑面積A"))
    neRL = 248:                         St = Join(Ar, ";")
    neRL = 249:                         pMenber.Item(CStr("世帯員." & RsS.V("管理人ID"))) = St
                                Else
    neRL = 251:                         pMenber.Add CStr("世帯員." & RsS.V("管理人ID")), CStr(RsS.V("所有者氏名") & ";" & (RsS.NullCast("田面積A", 0) + RsS.NullCast("畑面積A", 0)) & ";;;")
                                End If
                            Case 1
    neRL = 254:                     .小作田 = .小作田 + RsS.NullCast("田面積A", 0) * n耕作
    neRL = 255:                     .小作畑 = .小作畑 + RsS.NullCast("畑面積A", 0) * n耕作
    neRL = 256:                     .小作樹 = .小作樹 + RsS.NullCast("樹園地", 0) * n耕作
    neRL = 257:                     .小作草 = .小作草 + RsS.NullCast("採草放牧面積", 0) * n耕作
    neRL = 258:
    neRL = 259:                     .不耕作小作田 = .不耕作小作田 + RsS.NullCast("田面積A", 0) * (n耕作 = 0)
    neRL = 260:                     .不耕作小作畑 = .不耕作小作畑 + RsS.NullCast("畑面積A", 0) * (n耕作 = 0)
    neRL = 261:                     .不耕作小作樹 = .不耕作小作樹 + RsS.NullCast("樹園地", 0) * (n耕作 = 0)
    neRL = 262:                     .不耕作小作草 = .不耕作小作草 + RsS.NullCast("採草放牧面積", 0) * (n耕作 = 0)

                                If pMenber.Exists(CStr("世帯員." & RsS.V("借受人ID"))) Then
    neRL = 265:                         St = pMenber.Item(CStr("世帯員." & RsS.V("借受人ID")))
    neRL = 266:                         Ar = Split(St, ";")
    neRL = 267:                         Ar(2) = Val(Ar(2)) + RsS.V("田面積A") + RsS.V("畑面積A")
    neRL = 268:                         St = Join(Ar, ";")
    neRL = 269:                         pMenber.Item(CStr("世帯員." & RsS.V("借受人ID"))) = St
                                Else
'    neRL = 271:                         pMenber.Add CStr("世帯員." & RsS.V("借受人ID")), CStr(RsS.V("借受人氏名") & ";;" & (RsS.NullCast("田面積A", 0) + RsS.NullCast("畑面積A", 0)) & ";;")
    neRL = 271:                         pMenber.Add CStr("世帯員." & RsS.V("借受人ID")), CStr(RsS.V("借受人氏名") & ";" & RsS.V("借受人住所") & ";" & (RsS.NullCast("田面積A", 0) + RsS.NullCast("畑面積A", 0)) & ";;")
                                End If
                        Case 2
    neRL = 274:                     .小作田 = .小作田 + RsS.NullCast("田面積A", 0) * n耕作
    neRL = 275:                     .小作畑 = .小作畑 + RsS.NullCast("畑面積A", 0) * n耕作
    neRL = 276:                     .小作樹 = .小作樹 + RsS.NullCast("樹園地", 0) * n耕作
    neRL = 277:                     .小作草 = .小作草 + RsS.NullCast("採草放牧面積", 0) * n耕作
    neRL = 278:
    neRL = 279:                     .不耕作小作田 = .不耕作小作田 + RsS.NullCast("田面積A", 0) * (n耕作 = 0)
    neRL = 280:                     .不耕作小作畑 = .不耕作小作畑 + RsS.NullCast("畑面積A", 0) * (n耕作 = 0)
    neRL = 281:                     .不耕作小作樹 = .不耕作小作樹 + RsS.NullCast("樹園地", 0) * (n耕作 = 0)
    neRL = 282:                     .不耕作小作草 = .不耕作小作草 + RsS.NullCast("採草放牧面積", 0) * (n耕作 = 0)
    neRL = 283:
                                If pMenber.Exists(CStr("世帯員." & RsS.V("借受人ID"))) Then
    neRL = 285:                         St = pMenber.Item(CStr("世帯員." & RsS.V("借受人ID")))
    neRL = 286:                         Ar = Split(St, ";")
    neRL = 287:                         Ar(4) = Val(Ar(4)) + RsS.V("田面積A") + RsS.V("畑面積A")
    neRL = 288:                         St = Join(Ar, ";")
    neRL = 289:                         pMenber.Item(CStr("世帯員." & RsS.V("借受人ID"))) = St
                                Else
    '    neRL = 291:                         pMenber.Add CStr("世帯員." & RsS.V("借受人ID")), CStr(RsS.V("借受人氏名") & ";;;;" & (RsS.NullCast("田面積A", 0) + RsS.NullCast("畑面積A", 0)) & "")
    neRL = 291:                         pMenber.Add CStr("世帯員." & RsS.V("借受人ID")), CStr(RsS.V("借受人氏名") & ";" & RsS.V("借受人住所") & ";;;" & (RsS.NullCast("田面積A", 0) + RsS.NullCast("畑面積A", 0)) & "")

                                End If
                        End Select

    neRL = 295:          .田筆数 = .田筆数 - (RsS.NullCast("田面積A", 0) > 0) * n耕作
    neRL = 296:          .畑筆数 = .畑筆数 - (RsS.NullCast("畑面積A", 0) > 0) * n耕作
    neRL = 297:          .樹筆数 = .樹筆数 - (RsS.NullCast("樹園地", 0) > 0) * n耕作
    neRL = 298:          .草筆数 = .草筆数 - (RsS.NullCast("採草放牧面積", 0) > 0) * n耕作

    neRL = 300:          .不耕作田筆数 = .不耕作田筆数 + (RsS.NullCast("田面積A", 0) > 0) * (n耕作 = 0)
    neRL = 301:          .不耕作畑筆数 = .不耕作畑筆数 + (RsS.NullCast("畑面積A", 0) > 0) * (n耕作 = 0)
    neRL = 302:          .不耕作樹筆数 = .不耕作樹筆数 + (RsS.NullCast("樹園地", 0) > 0) * (n耕作 = 0)
    neRL = 303:          .不耕作草筆数 = .不耕作草筆数 + (RsS.NullCast("採草放牧面積", 0) > 0) * (n耕作 = 0)

                     End With
    neRL = 309:          RsS.MoveNext
                Loop
                If dicPerson.Count Then
                    For n = 0 To dicPerson.Count - 1
                        s所有者 = s所有者 & "," & dicPerson.Items(n)
                    Next
                    s所有者 = MID$(s所有者, 2)
                    Set RsP = SystemDB.GetRecordsetEx("SELECT [ID],[氏名] FROM [D:個人INFO] WHERE [ID] IN (" & s所有者 & ")", 0, , Me)
                    Do Until RsP.EOF
                        mvarData3 = Replace(mvarData3, "p" & RsP.ID & "k", RsP.V("氏名"))
                        RsP.MoveNext
                    Loop
                End If


    neRL = 312:     mvarData3 = Replace(mvarData3, vbBack & vbBack, vbBack)
                nPCnt = UBound(Split(mvarData3, vbBack))
    neRL = 313:     SystemDB.CloseRs RsS

    neRL = 314:     If Len(Replace(mvarData3, ";", "")) Then nPageF = 1

    '3/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    '4/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    neRL = 315:      mvarPDW.WaitMessage = "貸出農地情報"
    neRL = 316:      mvarData4 = sBase

    neRL = 318:      St = "SELECT [V_農地].実面積,[V_農地].土地所在,[V_農地].登記簿地目 AS 台帳地目,[V_農地].現況地目,[V_農地].農業振興地域,都市計画法,[V_農地].遊休化,[V_農地].遊休時期,[V_農地].備考,[V_農地].所有者ID,[V_農地].管理人ID,[V_農地].登記簿面積 AS 台帳面積,[V_農地].実面積,[V_農地].自小作別,[D:個人Info].氏名 AS [所有者氏名],[D:個人Info_1].氏名 AS [借受人氏名],[D:個人Info_1].住所 AS [借受人住所],小作地適用法,小作形態,小作開始年月日,小作終了年月日, [小作料] AS 小作料S, [小作料単位] AS 単位S,田面積,畑面積,樹園地,採草放牧面積,[V_農地].部分面積,[V_農地].共有持分分子,[V_農地].共有持分分母 " & _
                 "FROM ([V_農地] LEFT JOIN [D:個人Info] ON [V_農地].管理人ID = [D:個人Info].ID) LEFT JOIN [D:個人Info] AS [D:個人Info_1] ON [V_農地].借受人ID = [D:個人Info_1].ID " & _
                 "WHERE [自小作別]>0 AND " & IIf(mvar基本情報.世帯の有無, "[借受世帯ID] <> " & mvar基本情報.世帯ID, "[借受人ID] <> " & mvar基本情報.世帯主ID) & " AND " & IIf(mvar基本情報.世帯の有無, "[農家世帯ID] = " & mvar基本情報.世帯ID, "[管理人ID] = " & mvar基本情報.世帯主ID) & " " & _
                 "ORDER BY V_農地.大字ID, RIGHT('00000' & IIf(Left([地番],1)='甲',Mid([地番],2,InStr([地番] & '-','-')-2),IIf(Left([地番],1)='乙',Mid([地番],2,InStr([地番] & '-','-')-2),Left([地番],InStr([地番] & '-','-')-1))),6), Mid([地番],InStr([地番] & '-','-')+1)"

    neRL = 323:      Set RsS = SystemDB.GetRecordsetEx(St, 0, , "基本台帳")

    neRL = 325:      Do Until RsS.EOF
                    If RsS.NullCast("所有者ID", "0") <> RsS.NullCast("管理人ID", "0") Then
                        dicPerson.Add "p" & RsS.NullCast("所有者ID", "0"), RsS.NullCast("所有者ID", "0")
                    Else
                        s所有者 = ""
                    End If

    neRL = 326:          mvarData4 = mvarData4 & vbCrLf & SetmvarData(RsS, 4)
    neRL = 327:          mvarData4 = mvarData4 & ";" & RsS.V("借受人氏名")
    neRL = 328:          mvarData4 = mvarData4 & ";" & Choose(RsS.NullCast("小作地適用法", 0) + 1, "", "農", "基", "他", "", "", "")
    neRL = 329:          mvarData4 = mvarData4 & ";" & Choose(RsS.NullCast("小作形態", 0) + 1, "", "賃", "使", "他", "", "", "")
    neRL = 330:          mvarData4 = mvarData4 & ";" & RsS.FormatDateEx("小作開始年月日", "GGEE年MM月DD日")
    neRL = 331:          mvarData4 = mvarData4 & ";" & RsS.FormatDateEx("小作終了年月日", "GGEE年MM月DD日")
    neRL = 332:          mvarData4 = mvarData4 & ";" & IIf(Val(SystemDB.DBProperty("遊休化表示")) And RsS.V("遊休化") And (Not IsNull(RsS.V("遊休時期"))), "遊休", "")
    neRL = 333:          mvarData4 = mvarData4 & ";" & Replace(RsS.NullCast("備考", ""), vbCrLf, vbTab)
                    If RsS.V("自小作別") > 0 And RsS.V("小作形態") = 1 Then
    neRL = 335:              mvarData4 = mvarData4 & ";" & RsS.FormatNumberEx("小作料S", 0) & " " & RsS.V("単位S") '小作料
                    Else
    neRL = 337:              mvarData4 = mvarData4 & ";"
                    End If
    neRL = 339:         mvarData4 = mvarData4 & ";" & StrConv(RsS.V("借受人住所"), vbNarrow)

                    If pMenber.Exists(CStr("世帯員." & RsS.V("所有者ID"))) Then
    neRL = 342:              St = pMenber.Item(CStr("世帯員." & RsS.V("所有者ID")))
    neRL = 343:              Ar = Split(St, ";")
    neRL = 344:              Ar(3) = Val(Ar(3)) + RsS.NullCast("田面積", 0) + RsS.NullCast("畑面積", 0)
    neRL = 345:              St = Join(Ar, ";")
    neRL = 346:              pMenber.Item(CStr("世帯員." & RsS.V("所有者ID"))) = St
                    Else
    neRL = 348:              pMenber.Add CStr("世帯員." & RsS.V("所有者ID")), CStr(RsS.V("所有者氏名") & ";;;" & (RsS.NullCast("田面積", 0) + RsS.NullCast("畑面積", 0)) & ";")
                    End If

                    With mvar基本情報
    neRL = 352:              .貸出田 = .貸出田 + RsS.NullCast("田面積", 0)
    neRL = 353:              .貸出畑 = .貸出畑 + RsS.NullCast("畑面積", 0)
    neRL = 354:              .貸出樹 = .貸出樹 + RsS.NullCast("樹園地", 0)
    neRL = 355:              .貸出草 = .貸出草 + RsS.NullCast("採草放牧面積", 0)
                    End With

    neRL = 357:         RsS.MoveNext
                Loop
    neRL = 359:     mvarData4 = Replace(mvarData4, vbCrLf & vbCrLf, vbCrLf)
    neRL = 360:     SystemDB.CloseRs RsS
    '4/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

                If dicPerson.Count Then
                    For n = 0 To dicPerson.Count - 1
                        s所有者 = s所有者 & "," & dicPerson.Items(n)
                    Next
                    s所有者 = MID$(s所有者, 2)
                    Set RsP = SystemDB.GetRecordsetEx("SELECT [ID],[氏名] FROM [D:個人INFO] WHERE [ID] IN (" & s所有者 & ")", 0, , Me)
                    Do Until RsP.EOF
                        mvarData4 = Replace(mvarData4, "p" & RsP.ID & "k", RsP.V("氏名"))
                        RsP.MoveNext
                    Loop
                End If
    neRL = 361:     If Len(Replace(mvarData4, ";", "")) Then nPageF = nPageF + 2


    neRL = 362:     Ar = pMenber.Items
                If UBound(Ar) >= 0 Then
    neRL = 364:          For n = 0 To UBound(Ar)
    neRL = 365:              Ar(n) = Replace(Ar(n), ";01;", ";0;")
    neRL = 366:              Ar(n) = Replace(Ar(n), ";02;", ";0;")
    neRL = 367:              Ar(n) = Replace(Ar(n), ";03;", ";0;")
    neRL = 368:              mvarData2 = mvarData2 & vbCrLf & Ar(n)
    neRL = 369:          Next
                End If

    neRL = 372:     mvarData0 = ";1;2"
    neRL = 373:     Ar = Split(mvarData3, vbBack)
                If UBound(Ar) > 0 Then
    neRL = 375:          For n = 1 To UBound(Ar)
                        If (n Mod Rows) = 1 Then
    neRL = 377:                  mvarData0 = mvarData0 & ";3/" & n & ";3/" & n & ";3/" & n & ";3/" & n
                        End If
    neRL = 379:          Next
                End If

    neRL = 382:     Ar = Split(mvarData4, vbCrLf)
                If UBound(Ar) > 0 Then
    neRL = 384:          For n = 1 To UBound(Ar)
                        If (n Mod Rows) = 1 Then
    neRL = 386:                  mvarData0 = mvarData0 & ";4/" & n
                        End If
                    Next
                End If

    neRL = 391:     Ar = Split(mvarData0, ";")
                XPage = IIf(nPCnt = 0, 0, IIf(nPCnt Mod Rows > 0, Fix(nPCnt / Rows) + 1, Fix(nPCnt / Rows))) ' * 3
    neRL = 392:     mvarPRP.Parent.MaxPage = UBound(Ar) '+ XPage
    neRL = 393:     With mvarPRP.Parent
    neRL = 394:         .Page = 1
    neRL = 395:         ADApp.Common.DrawPrintData mvarPRP.Parent, "農家基本台帳PG2"
    neRL = 396:     End With
    neRL = 397:     mvarPDW.WaitMessage = ""

    neRL = 399:     mvarPage2BTable.SetWidth 15, GetArray(25, 20, 20, 20, 10, 20, 27)
    neRL = 400:     mvarPage2BTable.SetHeight 43, GetArray(8, 8, 8, 8, 8, 8, 8)
                
                If Abs(mvar基本情報.不耕作自作田 + mvar基本情報.不耕作小作田) > 0 Then
    neRL = 402:          mvarPage2BTable.SetText FormatNumber(mvar基本情報.自作田 + mvar基本情報.小作田, 0) & vbCrLf & "(" & FormatNumber(Abs(mvar基本情報.不耕作自作田 + mvar基本情報.不耕作小作田), 0) & ")", 1, 1, 11, 1, 1
                Else
    neRL = 404:          mvarPage2BTable.SetText FormatNumber(mvar基本情報.自作田 + mvar基本情報.小作田, 0), 1, 1, 11, 1, 1
                End If

                If mvar基本情報.不耕作自作畑 + mvar基本情報.不耕作小作畑 > 0 Then
    neRL = 408:          mvarPage2BTable.SetText FormatNumber(mvar基本情報.自作畑 + mvar基本情報.小作畑, 0) & vbCrLf & "(" & FormatNumber(Abs(mvar基本情報.不耕作自作畑 + mvar基本情報.不耕作小作畑), 0) & ")", 1, 2, 11, 1, 1
                Else
    neRL = 410:          mvarPage2BTable.SetText FormatNumber(mvar基本情報.自作畑 + mvar基本情報.小作畑, 0), 1, 2, 11, 1, 1
                End If
    neRL = 412:     mvarPage2BTable.SetText FormatNumber(mvar基本情報.自作樹 + mvar基本情報.小作樹, 0), 1, 3, 11, 1, 1

    neRL = 3001:    sData3 = Split(mvarData3, vbBack)
    neRL = 4001:    sData4 = Split(mvarData4, vbCrLf)
        
                dX3(0) = SX
        
        CPrintCls_DataInit = False
        Exit Function
    ErrExt:
        CPrintCls_DataInit = True
        If Len(SysAD.DebugString) Then sERR = SysAD.DebugString
        MsgBox "次の箇所でエラーが発生しました=>" & sERR, vbCritical
        Exit Function
    ErrorDatainit:
        CPrintCls_DataInit = True
        MsgBox nERL & " 行目:" & Err.Description & vbCrLf & "[" & sParam & "]"
    End Function

    Private Function SetmvarData(Rs As ADBasicLIB2.RecordsetEx, nP As Long) As String
        Dim St As String
        
        St = Replace(Rs.V("土地所在"), "字.", "")
        St = St & ";" & Replace(mvar基本情報.登記地目.Item("n" & Rs.V("台帳地目")), "普通", "")
        St = St & ";" & Replace(mvar基本情報.現況地目.Item("n" & Rs.V("現況地目")), "普通", "")
        St = St & ";" & Rs.V("台帳面積")

        If Val(Rs.V("共有持分分母")) > 0 And Val(Rs.V("共有持分分子")) > 0 Then
            St = St & ";" & "(" & Rs.V("共有持分分子") & "/" & Rs.V("共有持分分母") & ")"
        ElseIf Rs.IsNull("部分面積") Then
            St = St & ";0"
        ElseIf Val(Rs.V("部分面積")) > 0 Then
            St = St & ";" & "(" & FormatNumber(Rs.V("部分面積"), 0) & ")"
        Else
            St = St & ";0"
        End If

        If nP = 3 Then
            St = St & ";" & Rs.Choose("農業振興地域", GetArray("他", "内", "外"), 0)    '農振法 '5
            St = St & ";" & Rs.Choose("都市計画法", GetArray("外", "内", "用"), 0)      '都市計画
            St = St & ";" & Rs.Choose("土地改良法", GetArray("外", "内", "内"))         '土地改良法
            St = St & ";" & Choose(Abs(Rs.V("生産緑地法")) + 1, "無", "有")             '生産緑地
            St = St & ";" & Choose(Rs.NullCast("自小作別", 0) + 1, "自", "小", "農")    '自小作別
        Else
            St = St & ";0"
            St = St & ";0"
            St = St & ";0"
            St = St & ";" & Choose(Rs.NullCast("自小作別", 0) + 1, "自", "小", "農")
            St = St & ";0"
            St = St & ";0"
        End If
        
        If Rs.NullCast("所有者ID", "0") <> Rs.NullCast("管理人ID", "0") Then    '10
            St = St & ";" & Rs.V("所有者氏名") & "\n(p" & Rs.NullCast("所有者ID", "0") & "k)"
        Else
            St = St & ";" & Rs.V("所有者氏名")
        End If

        If nP = 3 Then
            St = St & ";" & Rs.V("借受人氏名")  '11
            
            St = St & ";" & Rs.Choose("小作地適用法", GetArray("", "農", "基", "他"))
            St = St & ";" & Rs.Choose("小作形態", GetArray("", "賃", "使", "他"))
            
            St = St & ";" & Rs.FormatDateEx("小作開始年月日", "GEE/MM/DD")
            St = St & ";" & Rs.FormatDateEx("小作終了年月日", "GEE/MM/DD")
            
            If Rs.V("自小作別") > 0 And Rs.V("小作形態") = 1 Then   '16
                 St = St & ";" & Rs.FormatNumberEx("小作料S", 0) & " " & Rs.V("単位S")  '小作料
            Else
                 St = St & ";"
            End If
            St = St & ";" & IIf(IsNull(Rs.V("農地状況")), "", IIf(Rs.V("農地状況") > 19, "×", IIf(Rs.V("農地状況") > 9, "不", IIf(Rs.V("農地状況") = 1, "耕", ""))))   '作付状況
        
            St = St & ";" & IIf(Rs.V("利用状況報告対象"), "有", "無")                                           '利用状況報告対象   '18
            St = St & ";" & Rs.FormatDateEx("利用状況報告年月日", "GEE/MM/DD")                                  '利用状況報告年月日
            St = St & ";" & Rs.FormatDateEx("是正勧告日", "GEE/MM/DD")                                          '是正勧告日 '20
            St = St & ";" & Rs.V("是正内容")                                                                    '是正内容
            St = St & ";" & Rs.FormatDateEx("是正期限", "GEE/MM/DD")                                            '是正期限
            St = St & ";" & Rs.Choose("根拠条件農地法", GetArray("", "１号", "２号", "３号"))                   '根拠条件農地法
            St = St & ";" & Rs.Choose("根拠条件基盤強化法", GetArray("", "１号", "２号", "３号"))               '根拠条件基盤強化法
            St = St & ";" & Rs.FormatDateEx("是正確認", "GEE/MM/DD")                                            '是正確認
            St = St & ";" & Rs.V("是正状況")                                                                    '是正状況
            St = St & ";" & Rs.FormatDateEx("取消年月日", "GEE/MM/DD")                                          '取消年月日
            St = St & ";" & Rs.V("取消事由")                                                                    '取消事由
            St = St & ";" & Rs.Choose("取消条件農地法", GetArray("", "１号", "２号"))                           '取消条件農地法
            St = St & ";" & Rs.Choose("取消条件基盤強化法", GetArray("", "１号", "２号"))                       '取消条件基盤強化法   '30
            St = St & ";" & Rs.FormatDateEx("届出年月日", "GEE/MM/DD")                                          '届出年月日
            St = St & ";" & Rs.V("届出事由")                                                                    '届出事由
            St = St & ";" & Rs.V("届出者氏名")                                                                  '届出者氏名
            St = St & ";" & IIf(Rs.V("あっせん希望"), "有", "無")                                               'あっせん希望
            St = St & ";" & Rs.FormatDateEx("無断転用調査日", "GEE/MM/DD")                                      '無断転用調査日
            St = St & ";" & Rs.Choose("調査結果農地法", GetArray("", "１号", "２号"))                           '調査結果農地法
            St = St & ";" & IIf(Rs.V("無断転用"), "○", "")                                                     '無断転用
            St = St & ";" & Rs.V("解消意向")                                                                    '解消意向
            St = St & ";" & Rs.FormatDateEx("農業委員会の指導年月", "GEE/MM/DD")                                '農業委員会の指導年月
            St = St & ";" & Rs.FormatDateEx("遊休指導通知期限", "GEE/MM/DD")                                    '遊休指導通知期限   '40
            St = St & ";" & Rs.V("遊休指導内容")                                                                '遊休指導内容
    '            St = St & ";" & Rs.FormatDateEx("市町村長の勧告年月", "GEE" & Chr$(10) + Chr$(13) & "MM/DD")        '市町村長の勧告年月
            St = St & ";" & Rs.FormatDateEx("市町村長の勧告年月", "GEE/MM/DD")                                  '市町村長の勧告年月
            St = St & ";" & Rs.Choose("遊休通知農地法", GetArray("", "１号", "２号", "３号", "ただし書"))       '遊休通知農地法
            St = St & ";" & Rs.FormatDateEx("遊休解消届出", "GEE/MM/DD")                                        '遊休解消届出
            St = St & ";" & IIf(Rs.V("遊休解消斡旋"), "有", "無")                                               '遊休解消斡旋
            St = St & ";" & Rs.FormatDateEx("遊休利用増進勧告日", "GEE/MM/DD")                                  '遊休利用増進勧告日
            St = St & ";" & Rs.V("是正勧告内容")                                                                '是正勧告内容
            St = St & ";" & Rs.FormatDateEx("遊休利用増進是正期限", "GEE/MM/DD")                                '遊休利用増進是正期限
            St = St & ";" & Rs.Choose("遊休利用増進農地法", GetArray("", "１号", "２号", "３号"))               '遊休利用増進農地法
            St = St & ";" & Rs.FormatDateEx("遊休利用増進是正確認", "GEE/MM/DD")                                '遊休利用増進是正確認   '50
            St = St & ";" & Rs.V("遊休利用増進是正状況")                                                        '遊休利用増進是正状況
            St = St & ";" & Rs.FormatDateEx("利用増進通知日", "GEE/MM/DD")                                      '利用増進通知日
            St = St & ";" & Rs.V("利用増進協議者名")                                                            '利用増進協議者名
            St = St & ";" & IIf(Rs.V("納税猶予対象農地"), "有", "無")                                           '納税猶予対象農地   '54
            St = St & ";" & IIf(Rs.V("融資対象農地"), "有", "無")                                               '融資対象農地
            St = St & ";" & Rs.Choose("租税処置法", GetArray("", "１号", "２号", "３号"))                       '租税処置法
            St = St & ";" & Rs.V("営農困難")                                                                    '営農困難
            St = St & ";" & Rs.FormatDateEx("仮登記日", "GEE/MM/DD")                                            '仮登記日
            St = St & ";" & Rs.V("仮登記氏名")                                                                  '仮登記氏名
            St = St & ";" & Rs.V("仮登記住所")                                                                  '仮登記住所 '60
            St = St & ";" & Rs.V("備考")                                                                        '備考
            St = St & ";" & Rs.V("大字ID")                                                                      '大字ID
            St = St & ";" & Rs.V("所有者ID")                                                                    '所有者ID
            St = St & ";" & Rs.V("管理人ID")                                                                    '管理人ID
            St = St & ";" & Rs.V("融資対象農地")                                                                '融資対象農地
            St = St & ";" & Rs.V("納税猶予対象農地")                                                            '納税猶予対象農地
            St = St & ";" & Rs.V("借受人ID")                                                                    '借受人ID
            St = St & ";" & Rs.V("遊休化")                                                                      '遊休化
            St = St & ";" & Rs.FormatDateEx("遊休時期", "GEE/MM/DD")                                            '遊休時期
            St = St & ";" & Rs.V("備考")                                                                        '備考   '70
            St = St & ";" & Rs.V("田面積A")                                                                     '田面積
            St = St & ";" & Rs.V("畑面積A")                                                                     '畑面積
            St = St & ";" & Rs.V("樹園地")                                                                      '樹園地
            St = St & ";" & Rs.V("採草放牧面積")                                                                '採草放牧面積
            St = St & ";" & Rs.V("部分面積")                                                                    '部分面積
            St = St & ";" & Rs.V("共有持分分子")                                                                '共有持分分子
            St = St & ";" & Rs.V("共有持分分母")                                                                '共有持分分母
            St = St & ";" & Rs.V("農地状況")                                                                    '農地状況
            St = St & ";" & Rs.V("実面積")                                                                      '実面積     '79
        End If
    '            St = St & ";" & IIf(Val(SystemDB.DBProperty("遊休化表示")) And RsS.V("遊休化") And (Not IsNull(RsS.V("遊休時期"))), "遊休", "")
    '            St = St & ";" & Replace(RsS.NullCast("備考", ""), vbCrLf, vbTab)
        SetmvarData = St
    End Function
    
    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants: CPrintCls_Orientation = vbPRORLandscape: End Property
    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&)
    '        PrintCtrl nNewPage ' mvarParent.Page
        PrintCtrl nNewPage
    End Sub
    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Set CPrintCls_Parent(RHS As CPrintFormSK): Set mvarPRP.Parent = RHS: End Property

    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        Dim n As Long
        mvarPRP.Parent.PrintPage = 1
        mvarPRP.Parent.PrintMaxPage = mvarPRP.Parent.MaxPage

        'On Error Resume Next
        If bNowPage Then
            PrintCtrl mvarPRP.Parent.Page
            mvarPRP.EndDoc
        Else
            If nStart <= 0 Then nStart = 1
            If nEnd <= 0 Then nEnd = mvarPRP.Parent.MaxPage

            If nEnd < nStart Then nEnd = nStart

            For n = nStart To nEnd
                'mvarPRP.Parent.PrintPage = 1

                'Do Until mvarPRP.Parent.PrintPage > mvarPRP.Parent.PrintMaxPage
                    PrintCtrl n ' mvarPRP.Parent.PrintPage
                    mvarPRP.Parent.NewPage
                'Loop
            Next
            mvarPRP.Parent.EndDoc
        End If
    End Sub

    Private Sub CPrintCls_Repaint()
        On Error Resume Next
        PrintCtrl mvarPRP.Parent.Page
    End Sub
    Private Sub CPrintCls_TargetChange(sKey As String): End Sub

    Private Sub PrintCtrl(n As Long)
        Dim Ar As Variant, Cm As Variant
        Dim Ay As Variant
        Dim x As Long
        Dim St As String

        On Error Resume Next

    'nPageFで判断
        If Len(mvarData0) > 0 Then
            Ar = Split(mvarData0, ";")
            St = Ar(n)

            Select Case nPageF
                Case 0:
                    Select Case n
                        Case 1: Page1 n
                        Case 2: Page2 n
                    End Select
                Case 1:
                    If n <= 2 Then
                        Select Case n
                            Case 1: Page1 n
                            Case 2: Page2 n
                        End Select
                    Else
                        Select Case ((n - 3) + 1) Mod 4 '経営農地のページ計算(余りがページに該当　4枚中の（余り）ページ)
                            Case 1:
                                PA = 0
                                Page3 Val(MID$(St, InStr(St, "/") + 1)), n, Val(Left$(St, InStr(St, "/") - 1))
                            Case 2:
                                PA = (UBound(Ay) + 1)
                                Page4 Val(MID$(St, InStr(St, "/") + 1)), n, Val(Left$(St, InStr(St, "/") - 1))
                            Case 3:
                                PA = (UBound(Ay) + 1) + (UBound(Ay) + 1)
                                Page5 Val(MID$(St, InStr(St, "/") + 1)), n, Val(Left$(St, InStr(St, "/") - 1))
                            Case 0:
                                PA = (UBound(Ay) + 1) + (UBound(Ay) + 1) + (UBound(Ay) + 1)
                                Page6 Val(MID$(St, InStr(St, "/") + 1)), n, Val(Left$(St, InStr(St, "/") - 1))
                        End Select
                    End If
                Case 2:
                    Select Case n
                        Case 1: Page1 n
                        Case 2: Page2 n
                        Case Else
                            Page7 Val(MID$(St, InStr(St, "/") + 1)), n, Val(Left$(St, InStr(St, "/") - 1))
                    End Select
                Case 3:
                    If n <= 2 Then
                        Select Case n
                            Case 1: Page1 n
                            Case 2: Page2 n
                        End Select
                    Else
                        x = IIf(nPCnt Mod Rows > 0, Fix(nPCnt / Rows) + 1, Fix(nPCnt / Rows))

    '                        If Fix((n - 3) / 4) * 3 < XPage Then
    '                        If Fix((n - 3) / 4) <= XPage Then
                        If Fix((n - 3) / 4) < x Then
                            Select Case ((n - 3) + 1) Mod 4 '経営農地のページ計算(余りがページに該当　4枚中の（余り）ページ)
                                Case 1: Page3 Val(MID$(St, InStr(St, "/") + 1)), n, Val(Left$(St, InStr(St, "/") - 1))
                                Case 2: Page4 Val(MID$(St, InStr(St, "/") + 1)), n, Val(Left$(St, InStr(St, "/") - 1))
                                Case 3: Page5 Val(MID$(St, InStr(St, "/") + 1)), n, Val(Left$(St, InStr(St, "/") - 1))
                                Case 0: Page6 Val(MID$(St, InStr(St, "/") + 1)), n, Val(Left$(St, InStr(St, "/") - 1))
                            End Select
                        Else
                            Page7 Val(MID$(St, InStr(St, "/") + 1)), n, Val(Left$(St, InStr(St, "/") - 1))
                        End If
                    End If
            End Select
        End If
    End Sub

    Private Sub Page1(nNowPage As Long)
        Dim Ar As Variant, Cm As Variant
        Dim n As Long
        Dim x As Long
        Dim y As Long

        On Error Resume Next
        If Len(mvarData) = 0 Then Exit Sub
        With mvarPRP.Parent
            .ClearScreen
            Select Case Fnc.s市町村名
                Case "北郷町":
                    .Offset -6, 0
                Case Else
                    .Offset 0, 0
            End Select

    '-----------------------------表作成
            .TextOut mvar印刷日時, 278, 20, 11, 1

            .LineBoxDX 21, 25, 14, 0, 0, GetArray(8, 149, 8, 99)          '住所&氏名
            .LineBoxDX 21, 63, 9, 8, 9, GetArray(37, 21, 7, 22, 7, 7, 7, 14, 8, 8, 8, 7, 7, 7, 7, 7, 29, 53)   '下の表
            .LineX 202, 231, 67.5, 9, 9                         '資格取得&被保険者の間

            mvarTableA.Draw mvarPRP.Parent, True          '２-Ａ
            .LineBox 21, 177, 35, 190.5, 8, , , 4.5       '２-Ｂ
            .LineBox 125, 152, 139, 161, 6, 2             '２-Ｃ
            .LineBox 142, 174, 195, 178.5, , 3, 6         '２-Ｄ
            .LineBox 200, 174, 285, 178.5, , 3           '２-Ｅ
            .DLine 225, 174, 225, 187.5
            .DLine 235, 174, 235, 187.5

    '-----------------------------------
            .hTextOut "住所 ", 23, 28, 1, 5
            .hTextOut "氏名", 180, 28, 1, 5
    '-----------------------------------
            Ar = Split(mvarData, vbCrLf)
            Cm = Split(Ar(0), ";")
    '-------------------------------データはめ込み用の文字位置
    '            If bSeaclet Then .FontName = "Map Symbols"
            .TextOut mvar基本情報.住所, 34, 33, 11
            .TextOut mvar基本情報.世帯主名, 195, 32, 11
    '            .FontName = "ＭＳ 明朝"
                .TextOut mvar基本情報.集落情報, 175, 34, 11, 1
                .TextOut "〒 " & mvar基本情報.郵便番号, 34, 28, 11     '郵便番号
                .TextOut " " & mvar基本情報.電話番号, 62, 28, 11    '電話番号
    #If Not NONDBG Then
            'On Error GoTo Err_Page1
    #End If
            For n = 1 To UBound(Ar)
                Cm = Split(Ar(n), ";")
                y = n * 9
    '                If bSeaclet Then .FontName = "Map Symbols"
                .TextOut Cm(0), 22, 58.5 + y, 11           '氏名
                '.FontName = "ＭＳ 明朝"
                .TextOut Cm(1), 68.5, 58.5 + y, 11, 2      '続柄
                .TextOut Cm(2), 82.5, 58.5 + y, 11, 2      '性別
                .TextOut Cm(3), 97, 58.5 + y, 11, 2        '生年月日
                .TextOut Cm(4), 111.5, 58.5 + y, 11, 2     '世帯責任者
                .TextOut Cm(5), 118.5, 58.5 + y, 11, 2     '農業経営者
                .TextOut Cm(6), 125.5, 58.5 + y, 11, 2     '農業後継ぎ
                If Val(Cm(7)) > 0 Then .TextOut Cm(7), 142, 58.5 + y, 11, 1    '農業従事日数

                If Not Val(Cm(8)) = 0 Then .TextOut "○", 139.5 + Val(Cm(8)) * 7, 58.5 + y, 11, 2
                If Not Val(Cm(9)) = 0 Then .TextOut "○", 161 + Val(Cm(9)) * 7, 58.5 + y, 11, 2                  '兼業形態

    '                .TextOut Cm(10), 194, 58.5 + Y, 11         '職業
    '                .TextOut Cm(11), 223.5, 58.5 + Y, 11, 2    '加入種別
    '                .TextOut Cm(12), 241.5, 55 + Y, 10, 2      '資格取得年月日
    '                .TextOut Cm(13), 241.5, 59.5 + Y, 11, 2    '被保険者番号
    '                .TextOut Cm(14), 257, 58.5 + Y, 11         '備考

                .TextOut Cm(11), 195.5, 58.5 + y, 11, 2    '加入種別
                .TextOut Cm(12), 213.5, 55 + y, 10, 2      '資格取得年月日
                .TextOut Cm(13), 213.5, 59.5 + y, 9, 2    '被保険者番号
                .TextOut Cm(14), 229, 58.5 + y, 11         '備考
            Next

    '-----------------------------------
            Cm = Split(mvar基本情報.農機具List, ";")
            x = 0
            If UBound(Cm) > -1 Then
                For n = 0 To 13 Step 2
                    If Len(Cm(n)) Then
                        .DrawText Cm(n), 21 + x * 14, 154, 14, 4, 10, 2         '２-Ａ
                        .DrawText Cm(n + 1), 21 + x * 14, 154 + 13, 14, 4, 10, 1        '２-Ａ
                        x = x + 1
                    End If
                Next
            End If

            Cm = Split(mvar基本情報.家畜List, ";")
            x = 0
            If UBound(Cm) > -1 Then
                For n = 0 To 11 Step 2
                    If Len(Cm(n)) Then
                        .DrawText Cm(n), 125 + x * 14, 154, 14, 4, 10, 2         '２-Ｃ
                        .DrawText Cm(n + 1), 125 + x * 14, 154 + 9, 14, 4, 10, 1       '２-Ｃ
                        x = x + 1
                    End If
                Next
            End If

            Cm = Split(mvar基本情報.販売収入順位List, ";")
            If UBound(Cm) > -1 Then
                For n = 0 To 15
                    If Len(Cm(n)) = 0 Then Exit For
                    .DrawText IIf((n Mod 2), IIf(Val(Cm(n)), "第" & Cm(n) & "位", "-"), Cm(n)), 21 + Int(n / 2) * 14, 178 + (n Mod 2) * 7, 14, 4, 10, 2            '２-Ｂ
                Next
            End If
            .DrawObject 1
            Select Case mvar基本情報.申告方法
                Case 1: .DCircle 145, 172 + mvar基本情報.申告方法 * 4.5, 2, 0
                        If mvar基本情報.申告年月日 <> 0 Then .TextOut Format(mvar基本情報.申告年月日, "GEE"), 167, 175, 10
                Case 2, 3: .DCircle 145, 172 + mvar基本情報.申告方法 * 4.5, 2, 0
            End Select

            .TextOut "認定農業者", 201, 175, 10
            .TextOut "担い手農家", 201, 179.5, 10
            .TextOut "家族経営協定", 201, 184, 10

            If Val(mvar基本情報.認定農業者の有無) > 0 Then
                .TextOut "有", 228, 175, 10
                If IsDate(mvar基本情報.認定農業者の認定日) Then .TextOut mvar基本情報.認定番号 & " " & Format(mvar基本情報.認定農業者の認定日, "GEE/MM") & "認定", 235, 175, 10
            Else
                .TextOut "無", 228, 175, 10
            End If
            If Val(mvar基本情報.担い手農家の有無) > 0 Then
                .TextOut "有", 228, 179.5, 10
                If IsDate(mvar基本情報.担い手農家の認定日) Then .TextOut mvar基本情報.認定番号 & " " & Format(mvar基本情報.担い手農家の認定日, "GEE/MM") & "認定", 235, 179, 10
            Else
                .TextOut "無", 228, 179.5, 10
            End If
            If mvar基本情報.家族経営協定 Then
                .TextOut "締結", 226, 184, 10
            End If
        End With
        Exit Sub
    Err_Page1:
        MsgBox "問題点ページ1:" & Err.Description, vbInformation

    End Sub

    Private Sub Page2(nNowPage As Long)
        Dim Ar As Variant, Cm As Variant
        Dim Ay As Variant
        Dim SX As Single
        Dim n As Long
        Dim dX(7) As Single, hX(7) As Single
        Dim dX1(6) As Single, hX1(6) As Single

        On Error Resume Next
    '        On Error GoTo Err_Page2
        If Len(mvarData) = 0 Then Exit Sub
        With mvarPRP.Parent
            .ClearScreen
            Select Case Fnc.s市町村名
                Case "北郷町"
                    .Offset -4, 0
                Case Else
                    .Offset 0, 0
            End Select
            SX = 14
    '-----------------------------表作成
            .LineBoxDX 15, 23, 14, 0, 0, GetArray(8, 149, 8, 102)  '住所&氏名
    '-----------------------------３番土地総括表
            .LineBoxDX 15, 43, 8, 7, 8, GetArray(25, 70, 20, 27)    '項目全体
            Ay = GetArray(25, 20, 20, 20, 10, 20, 27)

            dX(0) = SX
            For n = 0 To UBound(Ay)
                dX(n + 1) = dX(n) + Ay(n)
            Next
            .LineBoxDX 40, 47, 4, 7, 8, GetArray(20, 20, 20, 10)   '総面積→小作地まで
    '-------------------------------
            Ay = GetArray(30, 22.5, 22.5, 22.5, 22.5, 22.5)
            .LineBoxDX 15, 114, 8, 8, 8, Ay                     '４番権利名義人
            dX1(0) = SX
            For n = 0 To UBound(Ay)
                dX1(n + 1) = dX1(n) + Ay(n)
            Next
    '-----------------------------５番経営意向等
            .LineBox 170, 50, 198, 58, 4, , 6    '５-Ａ
    '-------------------------------
            .LineBox 170, 67, 198, 75, , 3, 6     'Ｂ-１
            .LineXY 205, 67, 7, 3, 8, 11            'Ｂ-２
            .DBox 170, 94, 182, 126             'Ｂ-３
            .LineBox 176, 94, 226, 102, 1, 4    'Ｂ-３
            .DBox 230, 94, 242, 126             'Ｂ-４
            .LineBox 236, 94, 282, 102, 1, 4    'Ｂ-４
            .LineBox 170, 134, 282, 142, , 3, 6 '横枠まるごと(Ｃ)
            .DLine 265, 134, 265, 150           '有無仕切り線
    '-------------------------------
            .DBox 170, 166, 282, 186            '備考
    '-----------------------------------
            .hTextOut "住所", 17, 26, 1, 5
            .hTextOut "氏名", 174, 26, 1, 5
    '---------------------------文字埋め
            .TextOut mvar印刷日時, 278, 18, 11, 1
            ADApp.Common.DrawPrintData mvarPRP.Parent, "農家基本台帳B2"
            .hTextOut "特 定 処 分対 象 農 地", 94, 115, 7, 4, 8


            If mvar基本情報.経営意向 > 0 Then .DCircle 173 + (mvar基本情報.経営意向 - 1) * 28, 54, 3, vbBlack, 1 ' mvar基本情報.経営意向 = Cm(0)
            If mvar基本情報.経営計画 > 0 Then .DCircle 173, 70.5 + Choose(mvar基本情報.経営計画, 0, 1, 2) * 9, 3, vbBlack, 1 ' mvar基本情報.経営意向 = Cm(0)
            If mvar基本情報.拡大縮小方法 > 0 Then
                .DCircle 179 + Int((mvar基本情報.拡大縮小方法 - 1) / 4) * 60, 98 + ((mvar基本情報.拡大縮小方法 - 1) Mod 4) * 8, 3, vbBlack, 1   ' mvar基本情報.経営意向 = Cm(0)
                If Val(mvar基本情報.希望面積) > 0 Then .TextOut mvar基本情報.希望面積 & "u", 222 + Int((mvar基本情報.拡大縮小方法 - 1) / 4) * 60, 96 + ((mvar基本情報.拡大縮小方法 - 1) Mod 4) * 8, 10, 1
            End If
            Cm = Split(mvar基本情報.経営計画List, ";")
            If UBound(Cm) > -1 Then
                For n = 0 To 9
                    If Len(Cm(n)) = 0 Then Exit For
                    If (n Mod 2) = 0 Then
                        .DrawText Cm(n), 215 + Int(n / 2) * 11, 78 + (n Mod 2) * 9, 12, 4, 10, IIf((n Mod 2) = 0, 2, 1)
                    ElseIf Val(Cm(n)) > 0 Then
                        .DCircle 220 + Int(n / 2) * 11, 55 + Val(Cm(n)) * 16, 2, vbBlack
                    End If

                Next
            End If
            .DCircle 270 + (1 - mvar基本情報.農用地改善団体参加) * 6, 138, 3, vbBlack '.農用地改善団体参加
            .DCircle 270 + (1 - mvar基本情報.地域農業集団構成員) * 6, 146, 3, vbBlack '.地域農業集団構成員 = RsS.NullCast("地域農業集団構成員", 0)
            .TextOut mvar基本情報.その他の団体への参加, 225, 152, 9, 2

            .hTextOut "拡大方法", 171, 102, 1
            .hTextOut "縮小方法", 231, 102, 1
    '-----------------------------------
            Ar = Split(mvarData2, vbCrLf)
            Cm = Split(Ar(0), ";")
'            If bSeaclet Then .FontName = "Map Symbols"
                .TextOut mvar基本情報.住所, 28, 32, 11
                .TextOut mvar基本情報.世帯主名, 190, 29, 11
'            .FontName = "ＭＳ 明朝"

            .TextOut mvar基本情報.集落情報, 130, 32, 11
            .TextOut "〒 " & Left$(mvar基本情報.郵便番号 & "          ", 10) & "   " & mvar基本情報.電話番号, 28, 25, 11   '郵便番号 & 電話番号


            If mvar基本情報.不耕作自作田 + mvar基本情報.不耕作自作畑 + mvar基本情報.不耕作自作樹 + mvar基本情報.不耕作小作田 + mvar基本情報.不耕作小作畑 + mvar基本情報.不耕作小作樹 > 0 Then
                .TextOut FormatNumber(mvar基本情報.自作田 + mvar基本情報.自作畑 + mvar基本情報.自作樹 + mvar基本情報.小作田 + mvar基本情報.小作畑 + mvar基本情報.小作樹, 0), dX(2), 79 - 4, 11, 1
                .TextOut "(" & FormatNumber(mvar基本情報.不耕作自作田 + mvar基本情報.不耕作自作畑 + mvar基本情報.不耕作自作樹 + mvar基本情報.不耕作小作田 + mvar基本情報.不耕作小作畑 + mvar基本情報.不耕作小作樹, 0) & ")", dX(2), 79, 11, 1
            Else
                .TextOut FormatNumber(mvar基本情報.自作田 + mvar基本情報.自作畑 + mvar基本情報.自作樹 + mvar基本情報.小作田 + mvar基本情報.小作畑 + mvar基本情報.小作樹, 0), dX(2), 79, 11, 1
            End If

            .TextOut FormatNumber(mvar基本情報.自作草 + mvar基本情報.小作草, 0), dX(2), 87, 11, 1

            If mvar基本情報.不耕作自作田 > 0 Then
                .TextOut FormatNumber(mvar基本情報.自作田, 0), dX(3), 55 - 4, 11, 1
                .TextOut "(" & FormatNumber(mvar基本情報.不耕作自作田, 0) & ")", dX(3), 55, 11, 1
            Else
                .TextOut FormatNumber(mvar基本情報.自作田, 0), dX(3), 55, 11, 1
            End If

            If mvar基本情報.不耕作自作畑 > 0 Then
                .TextOut FormatNumber(mvar基本情報.自作畑, 0), mvarPage2BTable.CellLeft(3) - 1, 63 - 4, 11, 1
                .TextOut "(" & FormatNumber(mvar基本情報.不耕作自作畑, 0) & ")", dX(3), 63, 11, 1
            Else
                .TextOut FormatNumber(mvar基本情報.自作畑, 0), mvarPage2BTable.CellLeft(3) - 1, 63, 11, 1
            End If


            If mvar基本情報.不耕作自作畑 + mvar基本情報.不耕作自作畑 + mvar基本情報.不耕作自作樹 > 0 Then
                .TextOut FormatNumber(mvar基本情報.自作田 + mvar基本情報.自作畑 + mvar基本情報.自作樹, 0), dX(3), 79 - 4, 11, 1
                .TextOut "(" & FormatNumber(mvar基本情報.不耕作自作田 + mvar基本情報.不耕作自作畑 + mvar基本情報.不耕作自作樹, 0) & ")", dX(3), 79, 11, 1
            Else
                .TextOut FormatNumber(mvar基本情報.自作田 + mvar基本情報.自作畑 + mvar基本情報.自作樹, 0), dX(3), 79, 11, 1
            End If

            .TextOut FormatNumber(mvar基本情報.自作樹, 0), mvarPage2BTable.CellLeft(3) - 1, 71, 11, 1
            .TextOut FormatNumber(mvar基本情報.自作草, 0), mvarPage2BTable.CellLeft(3) - 1, 87, 11, 1

            .TextOut FormatNumber(mvar基本情報.小作田, 0), dX(4), 55, 11, 1
            .TextOut FormatNumber(mvar基本情報.小作畑, 0), dX(4), 63, 11, 1
            .TextOut FormatNumber(mvar基本情報.小作樹, 0), dX(4), 71, 11, 1
            .TextOut FormatNumber(mvar基本情報.小作田 + mvar基本情報.小作畑 + mvar基本情報.小作樹, 0), dX(4), 79, 11, 1
            .TextOut FormatNumber(mvar基本情報.小作草, 0), dX(4), 87, 11, 1


            If mvar基本情報.不耕作田筆数 Then
                .TextOut FormatNumber(mvar基本情報.田筆数, 0), dX(5), 55 - 4, 11, 1
                .TextOut "(" & FormatNumber(Abs(mvar基本情報.不耕作田筆数), 0) & ")", dX(5), 55, 11, 1
            Else
                .TextOut FormatNumber(mvar基本情報.田筆数, 0), dX(5), 55, 11, 1
            End If
            If mvar基本情報.不耕作畑筆数 Then
                .TextOut FormatNumber(mvar基本情報.畑筆数, 0), dX(5), 63 - 4, 11, 1
                .TextOut "(" & FormatNumber(Abs(mvar基本情報.不耕作畑筆数), 0) & ")", dX(5), 63, 11, 1
            Else
                .TextOut FormatNumber(mvar基本情報.畑筆数, 0), dX(5), 63, 11, 1
            End If
            .TextOut FormatNumber(mvar基本情報.樹筆数, 0), dX(5), 71, 11, 1
            If mvar基本情報.不耕作田筆数 + mvar基本情報.不耕作畑筆数 + mvar基本情報.不耕作樹筆数 Then
                .TextOut FormatNumber(mvar基本情報.田筆数 + mvar基本情報.畑筆数 + mvar基本情報.樹筆数, 0), dX(5), 79 - 4, 11, 1
                .TextOut "(" & FormatNumber(mvar基本情報.不耕作田筆数 + mvar基本情報.不耕作畑筆数 + mvar基本情報.不耕作樹筆数, 0) & ")", dX(5), 79, 11, 1
            Else
                .TextOut FormatNumber(mvar基本情報.田筆数 + mvar基本情報.畑筆数 + mvar基本情報.樹筆数, 0), dX(5), 79, 11, 1
            End If
            .TextOut FormatNumber(mvar基本情報.草筆数, 0), dX(5), 87, 11, 1

            .TextOut FormatNumber(mvar基本情報.貸出田, 0), dX(6), 55, 11, 1
            .TextOut FormatNumber(mvar基本情報.貸出畑, 0), dX(6), 63, 11, 1
            .TextOut FormatNumber(mvar基本情報.貸出樹, 0), dX(6), 71, 11, 1
            .TextOut FormatNumber(mvar基本情報.貸出田 + mvar基本情報.貸出畑 + mvar基本情報.貸出樹, 0), dX(6), 79, 11, 1
            .TextOut FormatNumber(mvar基本情報.貸出草, 0), dX(6), 87, 11, 1

            .DrawText mvar基本情報.備考, 170, 166, 282 - 170, 4, 11

            For n = 1 To UBound(Ar)
                Cm = Split(Ar(n), ";")
                If Len(Ar(n)) Then
'                If bSeaclet Then .FontName = "Map Symbols"
                .TextOut Cm(0), dX1(0) + 2, 116.5 + n * 8, 11
                .FontName = "ＭＳ 明朝"
                .TextOut FormatNumber(Val(Cm(1)), 0), dX1(2), 116.5 + n * 8, 11, 1
                .TextOut FormatNumber(Val(Cm(2)), 0), dX1(3), 116.5 + n * 8, 11, 1
                .TextOut FormatNumber(Val(Cm(4)), 0), dX1(4), 116.5 + n * 8, 11, 1

                .TextOut FormatNumber(Val(Cm(1)) + Val(Cm(2)) + Val(Cm(4)), 0), dX1(5), 116.5 + n * 8, 11, 1
                .TextOut FormatNumber(Val(Cm(3)), 0), dX1(6), 116.5 + n * 8, 11, 1
                End If
            Next
            mvarPage2BTable.Draw mvarPRP.Parent
    '-----------------------------------
        End With
        If Len(mvar基本情報.証明文) And nNowPage = mvarPRP.Parent.MaxPage Then
            mvarPRP.Parent.DrawText mvar基本情報.証明文, 100, 188, 2000, 4, 10, 0, 0
        End If
        Exit Sub
    Err_Page2:
        MsgBox "問題点ページ2:" & Err.Description, vbInformation
    End Sub
    
    Private Sub Page3(LPage As Long, nNowPage As Long, P As Long)
        Dim Ar As Variant, Cm As Variant
        Dim Ay As Variant
        Dim i As Long
        Dim y As Long
        Dim YY As Long
        Dim St As String
        Dim n As Long
        Dim dX(17) As Single, hX(17) As Single
        Dim SY As Single

        On Error Resume Next
        
        Ay = GetArray(6, 48, 6, 6, 16, 6, 6, 6, 6, 6, 40, 40, 6, 6, 28, 32, 6)
        CreatePitch SX, Ay, dX, hX
        SY = 40
        
        CreateGrid dX(0), SY, dX, Ay, P, nNowPage
        
        With mvarPRP.Parent
            ADApp.Common.DrawPrintData mvarPRP.Parent, "農家基本台帳C-ヘッダー"

    '            Ar = Split(mvarData3, vbCrLf)
            Ar = Split(mvarData3, vbBack)
    '-------------------------------データはめ込み用の文字位置
    ''            If bSeaclet Then .FontName = "Map Symbols"
    '                .TextOut mvar基本情報.住所, SX + 10, SY - 10, 11
    '                .TextOut mvar基本情報.世帯主名, SX + 167, SY - 15, 11
    ''            .FontName = "ＭＳ 明朝"
    '            .TextOut "〒 " & Left$(mvar基本情報.郵便番号 & "        ", 8) & "     " & mvar基本情報.電話番号, SX + 10, SY - 18, 11
    '            .TextOut mvar基本情報.集落情報, SX + 112, SY - 10, 11

            If UBound(Ar) > 0 Then
            SY = SY + HH
            For i = LPage To LPage + (Rows - 1)
                If i > UBound(Ar) Then Exit For
                Cm = Split(Ar(i), ";")
                n = i - LPage
                YY = n * nPit
                
                If UBound(Cm) > -1 Then
                    .DrawText i, dX(0) - 1, SY + YY, Ay(0), 4, nFs, 1, 2, nPit
                    
                    .DrawText Cm(0), dX(1) + 1, SY + YY, Ay(1) - 2, 4, 11, 0, 2, nPit
                    .DrawText Left$(Cm(1), 3), dX(2), SY + YY, Ay(2), 4, 11, 2, 2, nPit
                    .DrawText Left$(Cm(2), 3), dX(3), SY + YY, Ay(3), 4, 11, 2, 2, nPit
                    
                    If Cm(3) <> Cm(79) And b現況表示 Then
                        .DLine dX(4), SY + YY + (nPit / 2), dX(5), SY + YY + (nPit / 2)
                        .DrawText Format(Cm(3), "#,##0") & "\n\n" & Format(Cm(79), "#,##0"), dX(4) + 1, SY + YY + 1, Ay(4) - 2, 4, 10, 1, 2, nPit
                    Else
                        .DrawText Format(Cm(IIf(mode面積表示, 3, 79)), "#,##0"), dX(4) + 1, SY + YY, Ay(4) - 2, 4, 10, 1, 2, nPit
                    End If

                    .DrawText Cm(5), dX(5), SY + YY, Ay(5), 4, 10, 2, 2, nPit
                    .DrawText Cm(6), dX(6), SY + YY, Ay(6), 4, 10, 2, 2, nPit
                    .DrawText Cm(7), dX(7), SY + YY, Ay(7), 4, 10, 2, 2, nPit
                    .DrawText Cm(8), dX(8), SY + YY + 0.5, Ay(8) - 1, 4, 10, 2, 2, nPit - 1
                    .DrawText Cm(9), dX(9), SY + YY, Ay(9), 4, 10, 2, 2, nPit
                    .DrawText Cm(10), dX(10) + 1, SY + YY, Ay(10) - 2, 4, 10, 0, 2, nPit
                    .DrawText Cm(11), dX(11) + 1, SY + YY, Ay(11) - 2, 4, 10, 0, 2, nPit
                    .DrawText Cm(12), dX(12), SY + YY, Ay(12), 4, 10, 2, 2, nPit
                    .DrawText Cm(13), dX(13), SY + YY, Ay(13), 4, 10, 2, 2, nPit

    '                    If bSeaclet Then .FontName = "Map Symbols"
                        If Left$(Cm(80), Len(Fnc.s市町村名)) = Fnc.s市町村名 Then Cm(80) = MID$(Cm(80), Len(Fnc.s市町村名) + 1)
                        If Left$(Cm(80), 2) = "大字" Then Cm(80) = MID$(Cm(80), 3)
                        St = Cm(12) & IIf(Len(Cm(80)), "\n" & Cm(80), "")
                        .DrawText St, dX(9) + 1, SY + YY, Ay(9), 4, IIf(Len(Cm(14)) > 20, 7, IIf(Len(Cm(12)) > 9, 8, 9)), 0, 2, 10
                        y = IIf(Len(Cm(13)) > 18, -4, 0)
                        If UBound(Cm) >= 79 Then .DrawText Cm(80), dX(12) + 1, SY + YY, Ay(12), 4
    '                    .FontName = "ＭＳ 明朝"
                    
                    .DrawText Cm(14), dX(14), SY + YY, Ay(14), 4, 10, 2, 2, nPit / 2
                    .DrawText Cm(15), dX(14), SY + YY + (nPit / 2), Ay(14), 4, 10, 2, 2, nPit / 2
                    
                    If InStr(Cm(16), " ") <= 1 Then
                        .DrawText "−", dX(15), SY + YY, Ay(15), 4, 10, 2, 2, nPit
                    ElseIf InStr(Cm(16), " ") = 2 Then
                        If Trim(Cm(16)) = 0 Then
                            .DrawText "−", dX(15), SY + YY, Ay(15), 4, 10, 2, 2, nPit
                        Else
                            .DrawText Cm(16), dX(15), SY + YY, Ay(15), 4, 10, 1, 2, nPit
                        End If
                    Else
                        Cm(16) = Replace(Cm(16), "（全部で）", "/全")
                        .DrawText Cm(16), dX(15) + 1, SY + YY, Ay(15) - 2, 4, 10, 1, 2, nPit
                    End If
                End If
                .DrawText Cm(17), dX(16), SY + YY, Ay(16), 4, 10, 2, 2, nPit
            Next
            End If
        End With

        If Len(mvar基本情報.証明文) And nNowPage = mvarPRP.Parent.MaxPage Then
            mvarPRP.Parent.DrawText mvar基本情報.証明文, 100, 188, 2000, 4, 10, 0, 0
        End If
        Exit Sub
    Err_Page3:
        MsgBox "問題点ページ3:" & Err.Description, vbInformation
    End Sub

    Private Sub Page4(LPage As Long, nNowPage As Long, P As Long)
        Dim Ar As Variant, Cm As Variant
        Dim St As Variant
        Dim SY As Single
        Dim YY As Single
        Dim i As Long
        Dim dX(18) As Single, hX(18) As Single

        Ay = GetArray(6, 6, 17, 17, 21, 17, 13, 13, 17, 21, 17, 21, 12, 13, 17, 14, 25, 6)
        CreatePitch SX, Ay, dX, hX
        SY = 40

        CreateGrid dX(0), SY, dX, Ay, P, nNowPage
        
        With mvarPRP.Parent
            ADApp.Common.DrawPrintData mvarPRP.Parent, "農家基本台帳C-ヘッダー"
            

    '            .TextOut "太枠内の該当欄は必須記載事項", dX(18), SY - 1, nFs, 1, 1

            SY = SY + HH
    '            .LineBoxDX dX(0), SY, 0, Rows, nPit, Ay

    '            .TextOutR "(", dx(17) + 5, SY + (nPit * Rows) - 10, nFs + 10, 0, 0, 270
    '            .VText "無断複製を禁ず", dX(18) + 1, SY + (nPit * Rows) - 8, nFs - 2, 0, 0
    '            .TextOutR ")", dx(17) + 5, SY + (nPit * Rows) + 12, nFs + 10, 0, 0, 270

            For i = LPage To LPage + (Rows - 1)
                If i > UBound(sData3) Then Exit For
                Cm = Split(sData3(i), ";")
                
                YY = (i - ((Fix(LPage - 1) / Rows) * Rows) - 1) * nPit
                
                .DrawText i, dX(0) - 1, SY + YY, Ay(0), 4, nFs, 1, 2, nPit
                .DrawText Cm(18), dX(1), SY + YY, Ay(1), 4, nFs, 2, 2, nPit
                .DrawText Cm(19), dX(2), SY + YY, Ay(2), 4, nFs, 2, 2, nPit
                .DrawText Cm(20), dX(3), SY + YY, Ay(3), 4, nFs, 2, 2, nPit
                .DrawText Cm(21), dX(4) + 1, SY + YY + 1, Ay(4) - 1, 4, nFs, 0, 2, nPit - 1
                .DrawText Cm(22), dX(5), SY + YY, Ay(5), 4, nFs, 2, 2, nPit
                .DrawText Cm(23), dX(6), SY + YY, Ay(6), 3, nFs, 2, 2, nPit
                .DrawText Cm(24), dX(7), SY + YY, Ay(7), 3, nFs, 2, 2, nPit
                
                .DrawText Cm(25), dX(8), SY + YY, Ay(8), 3, nFs, 2, 2, nPit
                .DrawText Cm(26), dX(9) + 1, SY + YY + 1, Ay(9) - 1, 3, nFs, 0, 2, nPit - 1
                
                .DrawText Cm(27), dX(10), SY + YY, Ay(10), 3, nFs, 2, 2, nPit
                .DrawText Cm(28), dX(11) + 1, SY + YY + 1, Ay(11) - 1, 3, nFs, 0, 2, nPit - 1
                
                .DrawText Cm(29), dX(12), SY + YY, Ay(12), 3, nFs, 2, 2, nPit
                .DrawText Cm(30), dX(13), SY + YY, Ay(13), 3, nFs, 2, 2, nPit
                
                .DrawText Cm(31), dX(14), SY + YY, Ay(14), 4, nFs, 2, 2, nPit
                .DrawText Cm(32), dX(15), SY + YY, Ay(15), 4, nFs, 2, 2, nPit
                .DrawText Cm(33), dX(16) + 1, SY + YY + 1, Ay(16) - 1, 4, nFs, 0, 2, nPit - 1
                .DrawText Cm(34), dX(17), SY + YY, Ay(17), 4, nFs, 2, 2, nPit
            Next

            SY = SY + (nPit * Rows) + 2
        End With
    End Sub

    Private Sub Page5(LPage As Long, nNowPage As Long, P As Long)
        Dim Ar As Variant, Cm As Variant
        Dim St As Variant
        Dim SY As Single
        Dim YY As Single
        Dim i As Long
        Dim dX(20) As Single, hX(20) As Single

        Ay = GetArray(6, 16, 12, 4, 14, 15, 15, 14, 15, 12, 16, 8, 15, 15, 15, 12, 16, 16, 16, 20)
        CreatePitch SX, Ay, dX, hX
        SY = 40
        
        CreateGrid dX(0), SY, dX, Ay, P, nNowPage
        
        With mvarPRP.Parent
            ADApp.Common.DrawPrintData mvarPRP.Parent, "農家基本台帳C-ヘッダー"
            
    '            .TextOut "太枠内の該当欄は必須記載事項", dX(20), SY - 1, nFs + 1, 1, 1

            SY = SY + HH

    '            .TextOutR "(", dx(0) - 0.6, SY + (nPit * Rows) - 24, nFs + 10, 0, 0, 270
    '            .VText "無断複製を禁ず", dX(0) - 3.5, SY + (nPit * Rows) - 22, 8, 0, 0
    '            .TextOutR ")", dx(0) - 0.6, SY + (nPit * Rows) - 2, nFs + 10, 0, 0, 270

            For i = LPage To LPage + (Rows - 1)
                If i > UBound(sData3) Then Exit For
                Cm = Split(sData3(i), ";")
                
                YY = (i - ((Fix(LPage - 1) / Rows) * Rows) - 1) * nPit
                
                .DrawText i, dX(0) - 1, SY + YY, Ay(0), 4, nFs, 1, 2, nPit
                
                .DrawText Format(Cm(35), "GEE/MM/DD"), dX(1), SY + YY, Ay(1), 4, nFs, 2, 2, nPit
                .DrawText Cm(36), dX(2), SY + YY, Ay(2), 4, nFs, 2, 2, nPit
                .DrawText Cm(37), dX(3), SY + YY, Ay(3), 4, nFs, 2, 2, nPit
                .DrawText Cm(38), dX(4) + 0.5, SY + YY + 1, Ay(4) - 1, 3, nFs - 1, 0, 2, nPit - 1
                .DrawText Cm(39), dX(5), SY + YY, Ay(5), 4, nFs, 2, 2, nPit
                .DrawText Cm(40), dX(6), SY + YY, Ay(6), 4, nFs, 2, 2, nPit
                .DrawText Cm(41), dX(7) + 0.5, SY + YY + 1, Ay(7) - 1, 4, nFs - 1, 0, 2, nPit - 1
                .DrawText Cm(42), dX(8), SY + YY, Ay(8), 4, nFs, 2, 2, nPit
                .DrawText Cm(43), dX(9), SY + YY, Ay(9), 4, nFs - 2, 2, 2, nPit
                .DrawText Cm(44), dX(10), SY + YY, Ay(10), 4, nFs, 2, 2, nPit
                .DrawText Cm(45), dX(11), SY + YY, Ay(11), 4, nFs, 2, 2, nPit
                .DrawText Cm(46), dX(12), SY + YY, Ay(12), 4, nFs, 2, 2, nPit
                .DrawText Cm(47), dX(13) + 0.5, SY + YY, Ay(13) - 1, 4, nFs - 1, 0, 2, nPit
                
                .DrawText Cm(48), dX(14), SY + YY, Ay(14), 4, nFs, 2, 2, nPit
                .DrawText Cm(49), dX(15), SY + YY, Ay(15), 4, nFs, 2, 2, nPit
                .DrawText Cm(50), dX(16), SY + YY, Ay(16), 4, nFs, 2, 2, nPit
                .DrawText Cm(51), dX(17) + 0.5, SY + YY + 1, Ay(17) - 1, 4, nFs, 0, 2, nPit
                .DrawText Cm(52), dX(18), SY + YY, Ay(18), 4, nFs, 2, 2, nPit
                .DrawText Cm(53), dX(19) + 0.5, SY + YY + 1, Ay(19) - 1, 4, nFs - 1, 0, 2, nPit
            Next
        End With
    End Sub

    Private Sub Page6(LPage As Long, nNowPage As Long, P As Long)
        Dim Ar As Variant, Cm As Variant
        Dim St As Variant
        Dim SY As Single
        Dim YY As Single
        Dim i As Long
        Dim dX(9) As Single, hX(9) As Single

        Ay = GetArray(6, 8, 8, 18, 14, 18, 44, 54, 86)
        CreatePitch SX, Ay, dX, hX
        SY = 40
        
        CreateGrid dX(0), SY, dX, Ay, P, nNowPage
        
        With mvarPRP.Parent
            ADApp.Common.DrawPrintData mvarPRP.Parent, "農家基本台帳C-ヘッダー"


            .DrawText "納税猶予の適用状況", dX(1), SY, dX(5) - dX(1), 2.5, nFs, 2, 2, 4
            .DrawText "仮　　登　　記　　の　　設　　定　　状　　況", dX(5), SY, dX(8) - dX(5), 2.5, nFs, 2, 2, 4
            .DrawText "納税猶予上の分類", dX(3), SY + 4, dX(5) - dX(3), 2.5, nFs - 1, 2, 2, 4
            .DrawText "仮　登　記　権　者", dX(6), SY + 4, dX(8) - dX(6), 2.5, nFs - 1, 2, 2, 4

    '            .TextOut "太枠内の該当欄は必須記載事項", dX(9), SY - 1, nFs, 1, 1

            SY = SY + HH

    '            .TextOutR "(", dx(8) + 5, SY + (nPit * Rows) - 10, nFs + 10, 0, 0, 270
    '            .VText "無断複製を禁ず", dX(UBound(Ay) + 1) + 1, SY + (nPit * Rows) - 8, nFs - 2, 0, 0
    '            .TextOutR ")", dx(8) + 5, SY + (nPit * Rows) + 12, nFs + 10, 0, 0, 270

            For i = LPage To LPage + (Rows - 1)
                If i > UBound(sData3) Then Exit For
                Cm = Split(sData3(i), ";")
                
                YY = (i - ((Fix(LPage - 1) / Rows) * Rows) - 1) * nPit
                
                .DrawText i, dX(0) - 1, SY + YY, Ay(0), 4, nFs, 1, 2, nPit
                
                .DrawText Cm(54), dX(1), SY + YY, Ay(1), 4, nFs, 2, 2, nPit
                .DrawText Cm(55), dX(2), SY + YY, Ay(2), 4, nFs, 2, 2, nPit
                .DrawText Cm(56), dX(3), SY + YY, Ay(3), 4, nFs, 2, 2, nPit
                
                .DrawText Cm(57), dX(4) + 0.5, SY + YY + 1, Ay(4) - 1, 4, nFs, 0, 2, nPit - 1
                .DrawText Cm(58), dX(5), SY + YY, Ay(5), 4, nFs, 2, 2, nPit
                .DrawText Cm(59), dX(6) + 0.5, SY + YY + 1, Ay(6) - 1, 4, nFs, 0, 2, nPit - 1
                .DrawText Cm(60), dX(7) + 0.5, SY + YY + 1, Ay(7) - 1, 4, nFs, 0, 2, nPit - 1
                .DrawText Cm(61), dX(8) + 0.5, SY + YY + 1, Ay(8) - 1, 4, nFs, 0, 2, nPit - 1
            Next
        End With
    End Sub
    
    Private Sub Page7(LPage As Long, nNowPage As Long, P As Long)
        Dim Ar As Variant, Cm As Variant
        Dim St As Variant
        Dim Ay As Variant
        Dim i As Long
        Dim y As Long
        Dim n As Long
        Dim dX(12) As Single, hX(12) As Single
        Dim SY As Single
        Dim YY As Single
        Dim nH As Single

        nH = 6
        St = GetArray("所在\n\n\n大字・字・地番", "現\n　\n　\n　\n況", "登\n　\n記\n　\n簿", "登記簿面積(u),実　面　積(u)", "所　有　者\n\n氏　　　名", "氏　　　名", "住　　　所", "適　用　法", "形　　　態", "契　約　期　間", "賃 借 料", "備　　　考")

        Ay = GetArray(48, 6, 6, 28, 30, 34, 36, 6, 6, 30, 21, 25)
        CreatePitch SX, Ay, dX, hX
        SY = 40

        CreateGrid dX(0), SY, dX, Ay, P, nNowPage
        
        On Error Resume Next
        With mvarPRP.Parent
            ADApp.Common.DrawPrintData mvarPRP.Parent, "農家基本台帳C-ヘッダー"
            
            Select Case Fnc.s市町村名
                Case "北郷町"
                    .ScaleLeft = 6
            End Select
            
            .DBox dX(0), SY, dX(UBound(Ay) + 1), SY + HH

            For n = 0 To UBound(Ay) + 1
                Select Case n
                    Case 0
                        .DrawText St(n), dX(n), SY, Ay(n), 4, nFs, 2, 1, HH
                    Case 1, 7
                        .DLine dX(n), SY, dX(n), SY + HH
                        .DLine dX(n), SY + nH, dX(n + 2), SY + nH
                        .DrawText St(n), dX(n), SY + nH, Ay(n), 4, nFs, 2, 2, HH - 2
                        .DrawText St(n + 1), dX(n + 1), SY + nH, Ay(n + 1), 4, nFs, 2, 2, HH - 2
                    Case 2, 8
                        .DLine dX(n), SY + nH, dX(n), SY + HH
                    Case 3
                        .DLine dX(n), SY, dX(n), SY + HH
                        .DLine dX(n), SY + (HH / 2), dX(n + 1), SY + (HH / 2)
                        .DrawText Left(St(n), InStr(St(n), ",") - 1), dX(n), SY, Ay(n), 4, nFs, 2, 2, HH / 2
                        .DrawText MID(St(n), InStr(St(n), ",") + 1), dX(n), SY + (HH / 2), Ay(n), 4, nFs, 2, 2, HH / 2
                    Case 4
                        .DLine dX(n), SY, dX(n), SY + HH
                        .DrawText St(n), dX(n), SY, Ay(n), 4, nFs, 2, 2, HH
                    Case 5
                        .DLine dX(n), SY + nH, dX(n), SY + HH
                        .DLine dX(n), SY, dX(n), SY + HH
                        .DLine dX(n), SY + nH, dX(n + 2), SY + nH
                        .DrawText St(n), dX(n), SY + nH, Ay(n), 4, nFs, 2, 2, HH - nH
                    Case 6
                        .DLine dX(n), SY + nH, dX(n), SY + HH
                        .DrawText St(n), dX(n), SY + nH, Ay(n), 4, nFs, 2, 2, HH - nH
                    Case 9
                        .DLine dX(n), SY + nH, dX(n), SY + HH
                        .DLine dX(n), SY + nH, dX(n + 2), SY + nH
                        .DrawText St(n), dX(n), SY + nH, Ay(n), 4, nFs, 2, 2, HH - nH
                    Case 10
                        .DLine dX(n), SY + nH, dX(n), SY + HH
                        .DrawText St(n), dX(n), SY + nH, Ay(n), 4, nFs, 2, 2, HH - nH
                    Case 11
                        .DLine dX(n), SY, dX(n), SY + HH
                        .DrawText St(n), dX(n), SY, Ay(n), 4, nFs, 2, 2, HH
                End Select
            Next

            .DrawText "地目", dX(1), SY, Ay(1) + Ay(2), 4, nFs + 1, 2, 2, nH
            .DrawText "借　　　受　　　者", dX(5), SY, Ay(5) + Ay(6), 4, nFs + 1, 2, 2, nH
            .DrawText "貸　　付　　の　　状　　況", dX(7), SY, dX(11) - dX(7), 4, nFs + 1, 2, 2, nH
            
            
            Ar = Split(mvarData4, vbCrLf)
            Cm = Split(Ar(0), ";")
    '-------------------------------データはめ込み用の文字位置
            SY = SY + HH
            .LineBoxDX dX(0), SY, 0, Rows, nPit, Ay
            
            If UBound(Ar) > 0 Then
            For i = LPage To LPage + 9
                If i > UBound(Ar) Then Exit For
                Cm = Split(Ar(i), ";")
                n = i - LPage + 1
                YY = (i - ((Fix(LPage - 1) / Rows) * Rows) - 1) * nPit
                If UBound(Cm) > -1 Then
                    .DrawText Cm(0), dX(0) + 1, SY + YY, Ay(0), 4, 11, 0, 2, nPit

                    .VText Cm(1), hX(1), SY + YY + (nPit / 2), 10, 2, 2
                    .VText Cm(2), hX(2), SY + YY + (nPit / 2), 10, 2, 2
                    If Cm(4) = "0" Then
                        .DrawText FormatNumber(Val(Cm(3)), 0), dX(3) + 1, SY + YY, Ay(3) - 2, 4, nFs, 1, 2, nPit
                    Else
                        .DrawText FormatNumber(Val(Cm(3)), 0), dX(3) + 1, SY + YY, Ay(3) - 2, 4, nFs, 1, 2, nPit / 2
                        .DrawText FormatNumber(Val(Cm(4)), 0), dX(3) + 1, SY + YY + (nPit / 2), Ay(3) - 2, 4, nFs, 1, 2, nPit / 2
                        .DLine dX(3), SY + YY + (nPit / 2), dX(4), SY + YY + (nPit / 2)
                    End If
    '                    If bSeaclet Then .FontName = "Map Symbols"
                        y = IIf(Len(Cm(11)) > 16, -4, 0)
                        .DrawText Cm(11), dX(4) + 1, SY + YY + y, Ay(4), 4, , , 2, nPit
                        y = IIf(Len(Cm(12)) > 22, -4, 0)
                        .DrawText Cm(12), dX(5) + 1, SY + YY + y, Ay(5), 4, , , 2, nPit
                        y = IIf(Len(Cm(12)) > 22, -4, 0)
                        .DrawText Cm(20), dX(6) + 0.5, SY + YY + y, Ay(6), 4, , , 2, nPit
    '                    .FontName = "ＭＳ 明朝"
                    .DrawText Cm(13), dX(7), SY + YY, Ay(7), 4, nFs, 2, 2, nPit
                    .DrawText Cm(14), dX(8), SY + YY, Ay(8), 4, nFs, 2, 2, nPit
                    .DrawText Cm(15), dX(9), SY + YY, Ay(9), 4, nFs, 2, 2, nPit / 2
                    .DrawText Cm(16), dX(9), SY + YY + (nPit / 2), Ay(9), 4, nFs, 2, 2, nPit / 2
                    
                    .DrawText Replace(Cm(18), vbTab, vbCrLf), dX(11) + 1, SY + YY + 1, Ay(11), 4, 9, 0, 0, nPit - 1
                    
                    If InStr(Cm(19), " ") <= 1 Then
                        .DrawText "−", dX(10), SY + YY, Ay(10), 4, nFs, 2, 2, nPit
                    ElseIf InStr(Cm(19), " ") = 2 Then
                        If Trim(Cm(19)) = 0 Then
                            .DrawText "−", dX(10), SY + YY, Ay(10), 4, nFs, 2, 2, nPit
                        Else
                            .DrawText Cm(19), dX(10) - 1, SY + YY, Ay(10), 4, nFs, 1, 2, nPit
                        End If
                    Else
                        .DrawText Cm(19), dX(10) - 1, SY + YY + 1, Ay(10) - 1, 4, nFs, 1, 2, nPit - 1
                    End If
                End If
            Next

            End If
            
            SY = SY + (nPit * Rows) + 2
    '            Sub氏名 dX(UBound(Ay) + 1) - 140, SY, dX(UBound(Ay) + 1), SY + 14
        
            If Len(mvar基本情報.証明文) And nNowPage = mvarPRP.Parent.MaxPage Then
                mvarPRP.Parent.DrawText mvar基本情報.証明文, 100, 188, 2000, 4, 10, 0, 0
            End If

        End With
    End Sub

    '    Private Sub Sub氏名(SX As Single, SY As Single, EX As Single, EY As Single)
    '        Dim n As Long
    '
    '        With mvarPRP.Parent
    '            .VText "氏 名", SX + 5, SY + (EY - SY) / 2, nFs, 2, 2
    '            .VText "農家番号", SX + 55, SY + (EY - SY) / 2, nFs, 2, 2
    '
    '            .DBox SX, SY, EX, EY
    '            .DLine SX + 10, SY, SX + 10, EY
    '            .DLine SX + 50, SY, SX + 50, EY
    '            .DLine SX + 60, SY, SX + 60, EY
    '
    '            For n = 0 To 8
    '                .DotLine SX + 68 + n * 8, SY, SX + 68 + n * 8, EY, vbBlack
    '            Next
    '        End With
    '    End Sub

    Private Sub CreateGrid(ByVal SX As Single, ByVal SY As Single, ByRef dX() As Single, ByVal Ay As Variant, ByVal P As Long, ByVal nNowPage As Long)
        Dim n As Long
        Dim St As Variant
        Dim Hm(3) As Single
        Dim nFs As Integer
        
        With mvarPRP.Parent
            .ClearScreen
            .LineBoxDX dX(0), SY + HH, 0, Rows, nPit, Ay
            
            If P = 3 Then
                .TextOut "６.経営農地等の筆別表（" & StrConv(IIf((nNowPage - 2) Mod 4 = 0, 4, (nNowPage - 2) Mod 4), vbWide) & "）", dX(0), SY, 13, 0, 1
            Else
                .TextOut "７.貸付地の筆別表（農地・採草放牧地）", dX(0), SY, 13, 0, 1
            End If

            'If bSeaclet Then .FontName = "Map Symbols"
                .TextOut mvar基本情報.住所, SX + 14, SY - 11, 11
                .TextOut mvar基本情報.世帯主名, SX + 167, SY - 15, 11
    '                .TextOut "鹿児島市松原町７番６号", SX + 14, SY - 11, 11
    '                .TextOut "久永情報マネジメント", SX + 167, SY - 15, 11
            '.FontName = "ＭＳ 明朝"
            .TextOut "〒 " & Left$(mvar基本情報.郵便番号 & "        ", 8) & "     " & mvar基本情報.電話番号, SX + 14, SY - 18, 11
            .TextOut mvar基本情報.集落情報, SX + 112, SY - 11, 11
            .TextOut mvar印刷日時, 270, 18, 11, 1, 1
            
            Select Case P
                Case 3
                    Hm(0) = HH / 2  '12
                    Hm(1) = HH / 3  ' 8
                    Hm(2) = HH / 4  ' 6
                    Hm(3) = HH / 6  ' 4

                    Select Case (nNowPage + 1) Mod 4 + 1
                        Case 1
                            St = GetArray("番　　号", "所在" & vbCrLf & vbCrLf & "大字・字・地番", "登記簿", "現　況", "面積(u)・実面積", "農振法", "都市計画法", "土地改良", "生産緑地法に基づく指定", "自作借入別", "所有者氏名", "借受人氏名", "適用法", "形　態", "契約期間", "賃借料", "作付状況")
                            .Offset 0, 0
                            nFs = 11
                            
                            For n = 0 To UBound(Ay)
                                Select Case n
                                    Case 0
                                        .DBox dX(n), SY, dX(n + 1), SY + HH
                                        .DrawText St(n), dX(n), SY, Ay(n), 4, nFs, 2, 2, HH
                                    Case 1, 9, 15, 16
                                        .DBox dX(n), SY, dX(n + 1), SY + HH
                                        .DrawText St(n), dX(n), SY, Ay(n), 4, nFs, 2, 2, HH
                                    Case 2
                                        .DBox dX(n), SY, dX(n + 2), SY + Hm(3)
                                        .DrawText "地目", dX(n), SY, dX(n + 2) - dX(n), 4, 11, 2, 2, Hm(3)
                                        .DBox dX(n), SY + (Hm(3)), dX(n + 1), SY + HH
                                        .hTextOut CStr(St(n)), dX(n) + 1, SY + Hm(3) + 2, 1, 6, nFs
                                    Case 3
                                        .DBox dX(n), SY + Hm(3), dX(n + 1), SY + HH
                                        .hTextOut CStr(St(n)), dX(n) + 1, SY + Hm(3) + 2, 1, 6, nFs
                                    Case 4
                                        .DBox dX(n), SY, dX(n + 1), SY + HH
                                        .DLine dX(n), SY + Hm(0), dX(n + 1), SY + Hm(0)
                                        .DrawText Left(St(n), InStr(St(n), "・") - 1), dX(n), SY, Ay(n), 4, nFs - 1, 2, 2, Hm(0)
                                        .DrawText MID(St(n), InStr(St(n), "・") + 1), dX(n), SY + Hm(0), Ay(n), 4, nFs - 1, 2, 2, Hm(0)
                                    Case 5
                                        .DBox dX(n), SY, dX(n + 3), SY + Hm(3)
                                        .DrawText "地域区分", dX(n), SY, dX(n + 3) - dX(n), 4, nFs, 2, 2, Hm(3)
                                        .hTextOut CStr(St(n)), dX(n) + 1, SY + Hm(3) + 2, 1, 6, nFs
                                    Case 6
                                        .DLine dX(n), SY + Hm(3), dX(n), SY + HH
                                        .DrawText St(n), dX(n), SY + Hm(3) + 2, Ay(n), 4, nFs - 2, 2, 2, HH - Hm(3)
                                    Case 7
                                        .DLine dX(n), SY + Hm(3), dX(n), SY + HH
                                        .DrawText St(n), dX(n), SY + Hm(3), Ay(n), 4, nFs, 2, 2, HH - Hm(3)
                                    Case 8
                                        .DBox dX(n), SY, dX(n + 1), SY + HH
                                        .DBox dX(n + 2), SY, dX(n + 4), SY + Hm(3)
                                        .DrawText St(n), dX(n) + 1, SY - 1, Ay(n) - 2, 2, nFs - 5, 2, 2, HH + 1
                                        .DrawText "所有および借受名義人", dX(n + 2), SY, dX(n + 4) - dX(n + 2), 4, nFs, 2, 2, Hm(3)
                                    Case 10, 11
                                        .DLine dX(n + 1), SY + Hm(3), dX(n + 1), SY + HH
                                        .DrawText St(n), dX(n), SY + Hm(3), Ay(n), 4, nFs, 2, 2, HH - Hm(3)
                                    Case 12, 13
                                        .DLine dX(n + 1), SY + Hm(3), dX(n + 1), SY + HH
                                        .hTextOut CStr(St(n)), dX(n) + 1, SY + Hm(3) + 2, 1, 6, nFs
                                    Case 14
                                        .DBox dX(n - 2), SY, dX(n + 1), SY + Hm(3)
                                        .LineX dX(n), dX(n + 1), SY + HH + (nPit / 2), Rows, nPit
                                        .DrawText "借受地の状況", dX(n - 2), SY, dX(n + 1) - dX(n - 2), 4, nFs, 2, 2, Hm(3)
                                        .DrawText "契 約 期 間\n(開始･終了)", dX(n), SY + Hm(3), dX(n + 1) - dX(n), 4, nFs, 2, 2, HH - Hm(3)
                                End Select
                            Next
                        Case 2
                            St = GetArray("番　　号", "利\n用\n状\n況\n報\n告\nの\n対\n象", "利用状況\n報告年月日", "勧告年月日", "内　　容", "期限年月日", "農地法\n第3条の2\n第1項", "基盤法\n第20条の2\n第1項", "確認年月日", "是正状況", "取消年月日", "取消事由", "農地法\n第3条の2\n第２項", "基盤法\n第20条の2\n第２項", "届出年月日", "届出事由", "届出のあった\n権利取得者の氏名", "あ\nっ\nせ\nん\n希\n望")
                            .Offset 0, 0
                            nFs = 9
                            
                            For n = 0 To UBound(Ay)
                                Select Case n
                                    Case 0
                                        .DBox dX(n), SY, dX(n + 1), SY + HH
                                        .DrawText St(n), dX(n), SY + 1, Ay(n), 3.5, nFs, 2, 2, HH
                                    Case 1
                                        .DBox dX(n), SY, dX(n + 1), SY + HH
                                        .DrawText St(n), dX(n) + 1, SY + 1, Ay(n) - 1, 3.5, nFs - 2, 2, 0, HH
                                    Case 2
                                        .DBox dX(n), SY, dX(n + 12), SY + Hm(3)
                                        .DrawText "農地等の利用状況の報告等（農地法第３条第６項又は基盤法第１８条第２項第７号）", dX(n), SY + 0.5, dX(n + 12) - dX(n), 4, nFs, 2, 2, Hm(3)
                                        .DrawText St(n), dX(n), SY + Hm(3), Ay(n), 4, nFs, 2, 2, HH - Hm(3)
                                    Case 3
                                        .DBox dX(n), SY + Hm(3), dX(n + 7), SY + Hm(1)
                                        .DBox dX(n), SY + Hm(1), dX(n + 1), SY + HH
                                        .DrawText "勧告の状況等", dX(n), SY + Hm(3), dX(n + 7) - dX(n), 4, nFs + 1, 2, 2, Hm(3)
                                        .DrawText St(n), dX(n), SY + Hm(1), Ay(n), 4, nFs, 2, 2, HH - Hm(1)
                                    Case 4, 8
                                        .DBox dX(n), SY + Hm(1), dX(n + 2), SY + Hm(0)
                                        .DBox dX(n), SY + Hm(0), dX(n + 1), SY + HH
                                        .DrawText IIf(n = 4, "講ずべき是正措置", "是正の状況"), dX(n), SY + Hm(1) + 0.5, dX(n + 2) - dX(n), 4, nFs + 1, 2, 2, Hm(3)
                                        .DrawText St(n), dX(n), SY + Hm(2) + Hm(1) + IIf(n = 6, 1, 0), Ay(n), 4, nFs, 2, 2, HH - (Hm(2) + Hm(1))
                                    Case 5, 9
                                        .DBox dX(n), SY + Hm(0), dX(n + 1), SY + HH
                                        .DrawText St(n), dX(n), SY + Hm(2) + Hm(1) + IIf(n = 7, 1, 0), Ay(n), 4, nFs, 2, 2, HH - (Hm(2) + Hm(1))
                                    Case 6, 12
                                        .DBox dX(n), SY + Hm(1), dX(n + 2), SY + Hm(1) + Hm(3)
                                        .DBox dX(n), SY + Hm(0), dX(n + 1), SY + HH
                                        .DrawText "根拠条項", dX(n), SY + Hm(1) + 0.5, dX(n + 2) - dX(n), 4, nFs + 1, 2, 2, Hm(3)
                                        .DrawText St(n), dX(n), SY + Hm(0) + Hm(3) + 1, Ay(n), 4, nFs - 2, 2, 2, HH - (Hm(0) + Hm(3))
                                    Case 7, 13
                                        .DBox dX(n), SY + Hm(0), dX(n + 1), SY + HH
                                        .DrawText St(n), dX(n), SY + Hm(0) + Hm(3) + 1, Ay(n), 4, nFs - 2, 2, 2, HH - (Hm(0) + Hm(3))
                                    Case 10
                                        .DBox dX(n), SY + Hm(1), dX(n + 4), SY + Hm(1)
                                        .DBox dX(n), SY + Hm(1), dX(n + 1), SY + HH
                                        .DrawText "許可の取消に関する事項", dX(n), SY + Hm(3), dX(n + 4) - dX(n), 4, nFs + 1, 2, 2, Hm(3)
                                        .DrawText St(n), dX(n), SY + Hm(1), Ay(n), 4, nFs, 2, 2, HH - Hm(1)
                                    Case 11
                                        .DBox dX(n), SY + Hm(1), dX(n + 1), SY + HH
                                        .DrawText St(n), dX(n), SY + Hm(1), Ay(n), 4, nFs, 2, 2, HH - Hm(1)
                                    Case 14
                                        .DBox dX(n), SY, dX(n + 4), SY + Hm(3)
                                        .DBox dX(n), SY + Hm(3), dX(n + 1), SY + HH
                                        .DrawText "相続等の届出(農地法第３条の３第１項)", dX(n), SY + 0.5, dX(n + 4) - dX(n), 4, nFs, 2, 2, Hm(3)
                                        .DrawText St(n), dX(n), SY + Hm(3), Ay(n), 4, nFs, 2, 2, HH - Hm(3)
                                    Case 15
                                        .DBox dX(n), SY + Hm(3), dX(n + 1), SY + HH
                                        .DrawText St(n), dX(n), SY + Hm(3), Ay(n), 4, nFs, 2, 2, HH - Hm(3)
                                    Case 16
                                        .DBox dX(n), SY + Hm(3), dX(n + 1), SY + HH
                                        .DrawText St(n), dX(n) - 0.5, SY + Hm(3) + 0.5, Ay(n) + 1, 4, nFs - 1, 2, 2, HH - Hm(3)
                                    Case 17
                                        .DBox dX(n), SY + Hm(3), dX(n + 1), SY + HH
                                        .DrawText St(n), dX(n), SY + Hm(3) + 1, Ay(n), 4, nFs - 1, 2, 0, HH - Hm(3)
                                End Select
                            Next
                        Case 3
                            St = GetArray("番　　号", "調査\n年月日", "農地法\n第30条\n第３項", "違\n反\n転\n用", "農地の\n所有者\nの意向", "指導年月日", "通知を行う\n期限", "指導内容", "通知(公告)\n年月日", "農地法\n第32条", "届出年月日", "あっ\nせん\n希望", "勧告年月日", "内容", "期限", "農地法\n第34条", "報告\n年月日", "是正状況", "通知\n年月日", "協議を行う者\nの名称")
                            .Offset 0, 0
                            nFs = 11
                            
                            For n = 0 To UBound(Ay)
                                Select Case n
                                    Case 0
                                        .DBox dX(n), SY, dX(n + 1), SY + HH
                                        .DrawText St(n), dX(n), SY, Ay(n), 4, nFs, 2, 2, HH
                                    Case 1
                                        .DBox dX(n), SY, dX(n + 3), SY + Hm(3)
                                        .DBox dX(n), SY + Hm(3), dX(n + 1), SY + HH
                                        .DrawText "農地の利用状況調査", dX(n) + 1.5, SY + 0.5, Ay(n) + Ay(n + 1) + 1, 4, nFs - 2, 2, 2, Hm(3)
                                        .DrawText St(n), dX(n), SY + Hm(3), Ay(n), 4, nFs, 2, 2, HH - Hm(3)
                                    Case 2
                                        .DBox dX(n), SY + Hm(3), dX(n + 2), SY + Hm(1)
                                        .DBox dX(n), SY + Hm(3) + Hm(3), dX(n + 1), SY + HH
                                        .DrawText "調査結果", dX(n), SY + Hm(3) + 0.5, Ay(n) + Ay(n + 1), 4, nFs - 1, 2, 2, Hm(3)
                                        .DrawText St(n), dX(n), SY + Hm(1) + 2, Ay(n), 4, nFs - 2, 2, 2, HH - Hm(1) - 2
                                    Case 3
                                        .DBox dX(n), SY + Hm(1), dX(n + 1), SY + HH
                                        .DrawText St(n), dX(n), SY + Hm(1) + 3, Ay(n), 4, nFs - 2, 2, 2, HH - Hm(1) - 2
                                    Case 4
                                        .DBox dX(n), SY, dX(n + 16), SY + Hm(3)
                                        .DBox dX(n), SY + Hm(3), dX(n + 1), SY + HH
                                        .DrawText "遊　　休　　農　　地　　の　　措　　置　　状　　況", dX(n) + 1.5, SY + 0.5, dX(n + 14) - dX(n), 4, nFs - 2, 2, 2, Hm(3)
                                        .DrawText St(n), dX(n), SY + Hm(3) + 2, Ay(n), 4, nFs - 2, 2, 2, HH - Hm(3)
                                    Case 5
                                        .DBox dX(n), SY + Hm(3), dX(n + 3), SY + Hm(1)
                                        .DBox dX(n), SY + Hm(1), dX(n + 1), SY + HH
                                        .DrawText "遊休農地の指導状況", dX(n), SY + Hm(3) + 0.5, dX(n + 3) - dX(n), 4, nFs - 2, 2, 2, Hm(3)
                                        .DrawText St(n), dX(n), SY + Hm(1) + 2, Ay(n), 4, nFs - 4, 2, 2, HH - Hm(1) - 2
                                    Case 6
                                        .DBox dX(n), SY + Hm(1), dX(n + 1), SY + HH
                                        .DrawText St(n), dX(n), SY + Hm(1) + 2, Ay(n), 4, nFs - 4, 2, 2, HH - Hm(1) - 2
                                    Case 7
                                        .DBox dX(n), SY + Hm(1), dX(n + 1), SY + HH
                                        .DrawText St(n), dX(n), SY + Hm(1) + 2, Ay(n), 4, nFs - 4, 2, 2, HH - Hm(1) - 2
                                    Case 8
                                        .DBox dX(n), SY + Hm(3), dX(n + 2), SY + Hm(1)
                                        .DBox dX(n), SY + Hm(1), dX(n + 1), SY + HH
                                        .DrawText "遊休農地である旨の通知", dX(n), SY + Hm(3) + 1, dX(n + 2) - dX(n), 4, nFs - 5, 2, 2, Hm(3)
                                        .DrawText St(n), dX(n), SY + Hm(1) + 2, Ay(n), 4, nFs - 4, 2, 2, HH - Hm(1) - 2
                                    Case 9
                                        .DBox dX(n), SY + Hm(1), dX(n + 1), SY + Hm(1) + Hm(3)
                                        .DBox dX(n), SY + Hm(1) + Hm(3), dX(n + 1), SY + HH
                                        .DrawText "根拠条項", dX(n), SY + Hm(1) + 0.5, Ay(n), 4, nFs - 4, 2, 2, Hm(3)
                                        .DrawText St(n), dX(n), SY + Hm(1) + Hm(3) + 2, Ay(n), 4, nFs - 2, 2, 2, HH - Hm(0) - 2
                                    Case 10
                                        .DBox dX(n), SY + Hm(3), dX(n + 2), SY + Hm(1)
                                        .DBox dX(n), SY + Hm(1), dX(n + 1), SY + HH
                                        .DrawText "利用に関する計画の届出", dX(n), SY + Hm(3) + 1, dX(n + 2) - dX(n), 4, nFs - 5, 2, 2, Hm(3)
                                        .DrawText St(n), dX(n), SY + Hm(1), Ay(n), 4, nFs - 3, 2, 2, HH - Hm(1)
                                    Case 11
                                        .DBox dX(n), SY + Hm(1), dX(n + 1), SY + HH
                                        .DrawText St(n), dX(n), SY + Hm(1) + 2, Ay(n), 4, nFs - 2, 2, 2, HH - Hm(1) - 2
                                    Case 12
                                        .DBox dX(n), SY + Hm(3), dX(n + 6), SY + Hm(1)
                                        .DBox dX(n), SY + Hm(1), dX(n + 1), SY + HH
                                        .DrawText "農業上の利用の増進のための勧告", dX(n), SY + Hm(3) + 0.5, dX(n + 6) - dX(n), 4, nFs - 2, 2, 2, Hm(3)
                                        .DrawText St(n), dX(n), SY + Hm(1), Ay(n), 4, nFs - 3, 2, 2, HH - Hm(1)
                                    Case 13
                                        .DBox dX(n), SY + Hm(1), dX(n + 2), SY + Hm(0)
                                        .DBox dX(n), SY + Hm(0), dX(n + 1), SY + HH
                                        .DrawText "講ずべき是正措置", dX(n), SY + Hm(1) + 0.5, Ay(n) + Ay(n + 1), 4, nFs - 2, 2, 2, Hm(3)
                                        .DrawText St(n), dX(n), SY + Hm(0) + 2, Ay(n), 4, nFs - 2, 2, 2, HH - Hm(0) - 2
                                    Case 14
                                        .DBox dX(n), SY + Hm(0), dX(n + 1), SY + HH
                                        .DrawText St(n), dX(n), SY + Hm(0) + 2, Ay(n), 4, nFs - 2, 2, 2, HH - Hm(0) - 2
                                    Case 15
                                        .DBox dX(n), SY + Hm(1), dX(n + 1), SY + Hm(1) + Hm(3)
                                        .DBox dX(n), SY + Hm(0), dX(n + 1), SY + HH
                                        .DrawText "根拠条項", dX(n), SY + Hm(1) + 0.5, Ay(n), 4, nFs - 4, 2, 2, Hm(3)
                                        .DrawText St(n), dX(n), SY + Hm(0) + 2, Ay(n), 4, nFs - 2, 2, 2, HH - Hm(0) - 2
                                    Case 16
                                        .DBox dX(n), SY + Hm(1), dX(n + 2), SY + Hm(0)
                                        .DBox dX(n), SY + Hm(0), dX(n + 1), SY + HH
                                        .DrawText "是正の状況", dX(n), SY + Hm(1) + 0.5, Ay(n) + Ay(n + 1), 4, nFs - 2, 2, 2, Hm(3)
                                        .DrawText St(n), dX(n), SY + Hm(0) + 2, Ay(n), 4, nFs - 2, 2, 2, HH - Hm(0) - 2
                                    Case 17
                                        .DBox dX(n), SY + Hm(0), dX(n + 1), SY + HH
                                        .DrawText St(n), dX(n), SY + Hm(0) + 2, Ay(n), 4, nFs - 2, 2, 2, HH - Hm(0) - 2
                                    Case 18
                                        .DBox dX(n), SY + Hm(3), dX(n + 2), SY + Hm(1)
                                        .DBox dX(n), SY + Hm(1), dX(n + 1), SY + HH
                                        .DrawText "所有権の移転等の協議を行う旨の通知", dX(n), SY + Hm(3) + 0.5, Ay(n) + Ay(n + 1), 4, nFs - 5, 2, 2, Hm(3)
                                        .DrawText St(n), dX(n), SY + Hm(1), Ay(n), 4, nFs - 1, 2, 2, HH - Hm(1)
                                    Case 19
                                        .DBox dX(n), SY + Hm(1), dX(n + 1), SY + HH
                                        .DrawText St(n), dX(n), SY + Hm(1) + 2, Ay(n), 4, nFs - 3, 2, 2, HH - Hm(1) - 1
                                End Select
                            Next
                        Case 4
                            Dim vSt() As String
                            
                            St = GetArray("番　　　号", "相\n続\n税\n納\n税\n猶\n予", "贈\n与\n税\n納\n税\n猶\n予", "特定貸付け,根拠事項,租税特別措置法\n第70条の6の2第1項", "営農困難\n時貸付け", "設定年月日", "氏　　名", "住　　　所", "備　　　考\n(売買、転用年月日、基盤整備状況)")
                            .Offset 0, 0
                            nFs = 9
                            
                            For n = 0 To UBound(Ay)
                                Select Case n
                                    Case 0
                                        .DBox dX(n), SY, dX(n + 1), SY + HH
                                        .DrawText St(n), dX(0), SY, Ay(0), 3, nFs, 2, 2, HH
                                    Case 1
                                        .DBox dX(n), SY, dX(n + 4), SY + Hm(3)
                                        .DBox dX(n), SY + Hm(3), dX(n + 1), SY + HH
                                        .DrawText St(n), dX(n), SY + Hm(3), Ay(n), 2.8, nFs - 1, 2, 2, HH - Hm(3)
                                    Case 2
                                        .DBox dX(n), SY + Hm(3), dX(n + 1), SY + HH
                                        .DrawText St(n), dX(n), SY + Hm(3), Ay(n), 2.8, nFs - 1, 2, 2, HH - Hm(3)
                                    Case 3
                                        .DBox dX(n), SY + Hm(3), dX(n + 2), SY + Hm(1)
                                        .DBox dX(n), SY + Hm(1), dX(n + 1), SY + HH
                                        .DLine dX(n), SY + Hm(0), dX(n + 1), SY + Hm(0)
                                        .DLine dX(n), SY + Hm(0) + Hm(3), dX(n + 1), SY + Hm(0) + Hm(3)
                
                                        vSt = Split(St(n), ",")
                                        .DrawText vSt(0), dX(n), SY + 8, Ay(n), 3, nFs - 2, 2, 2, 4
                                        .DrawText vSt(1), dX(n), SY + 12, Ay(n), 3, nFs - 2, 2, 2, 4
                                        .DrawText vSt(2), dX(n), SY + 16, Ay(n), 2, nFs - 4, 2, 2, 8
                                    Case 4
                                        .DBox dX(n), SY + Hm(1), dX(n + 1), SY + HH
                                        .DrawText St(n), dX(n), SY + 8, Ay(n), 2, nFs - 1, 2, 2, HH - 8
                                    Case 5
                                        .DBox dX(n), SY, dX(n + 3), SY + Hm(3)
                                        .DBox dX(n), SY + Hm(3), dX(n + 1), SY + HH
                                        .DrawText St(n), dX(n), SY + 4, Ay(n), 2, nFs - 1, 2, 2, HH - 4
                                    Case 6
                                        .DBox dX(n), SY + Hm(3), dX(n + 2), SY + Hm(1)
                                        .DBox dX(n), SY + Hm(1), dX(n + 1), SY + HH
                                        .DrawText St(n), dX(n), SY + 8, Ay(n), 3, nFs, 2, 2, HH - 8
                                    Case 7
                                        .DBox dX(n), SY + Hm(1), dX(n + 1), SY + HH
                                        .DrawText St(n), dX(n), SY + 8, Ay(n), 3, nFs, 2, 2, HH - 8
                                    Case 8
                                        .DBox dX(n), SY, dX(n + 1), SY + HH
                
                                        vSt = Split(St(n), ",")
                                        .DrawText St(n), dX(n), SY, Ay(n), 3, nFs, 2, 2, HH
                                End Select
                            Next
                        Case Else
                            Debug.Assert False
                    End Select
                Case Else
    '                    Debug.Assert False
            End Select
        End With
    End Sub

End Class










Class C枕崎現地調査
    Option Explicit
    Implements ADBasicLIB2.CPrintCls
    Private mvarParent As CPrintFormSK
    Private mvarDt As Date
    Private mvarKey As String
    Private mvarDic As ADBasicLIB2.CDataDictionary
    Private sTownCode As Long
    Private s市町村名 As String
    Private s住所 As String
    Private s連絡先 As String
    Private s郵便番号 As String
    Private Ay As Variant
    Private str As Variant
    Private dX(5) As Single
    Private hX(5) As Single
    Private Const HH = 9
    Private Const Rows = 20
    Private Const nPit = 8
    Private s挨拶 As String
    Private LTop As Single
    Private RTop As Single
    Private RLeft As Single
    Private CTop As Single
    Private CLeft As Single
    Private s支所 As String
    
    
    Private Sub Class_Initialize(): Set mvarDic = New ADBasicLIB2.CDataDictionary: End Sub

    Private Property Get CPrintCls_CanCancelPrint() As Boolean: End Property
    Private Property Get CPrintCls_CanPrintNowPage() As Boolean: End Property

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim St As String
        Dim pNode As MSComctlLib.Node
        Dim sPKey As String
        Dim sGKey As String
        Dim pData As CDataDictionary
        Dim vDate As Variant
        Dim n As Long
        
        'On Error GoTo DataInitError
        sTownCode = Right(SystemDB.DBProperty("市町村コード"), 3)
        s市町村名 = Replace(SystemDB.DBProperty("市町村名"), "役所", "")
        s住所 = SysAD.GetSettingData("支所情報", "住所", SystemDB.DBProperty("住所"))
        s連絡先 = SysAD.GetSettingData("支所情報", "連絡先", SystemDB.DBProperty("連絡先"))
        s郵便番号 = SysAD.GetSettingData("支所情報", "郵便番号", SystemDB.DBProperty("郵便番号"))
        
        With mvarParent
            .UsedTreeView = True
            .表示倍率 = 0.75
            
                    
            Set pData = Fnc.InputMulti("現地調査", "出力条件を入力してください", "出力日;日付;" & Date & "|支所住所;文字;" & s住所 & "|支所郵便番号;文字;" & s郵便番号 & "|支所電話番号;文字;" & s連絡先)
            If pData Is Nothing Then
                CPrintCls_DataInit = True
                Exit Function
            Else
                s住所 = pData.Item("支所住所")
                s郵便番号 = pData.Item("支所郵便番号")
                s連絡先 = pData.Item("支所電話番号")
                mvarDt = pData.Item("出力日")
                SysAD.SetSettingData "支所情報", "住所", s住所
                SysAD.SetSettingData "支所情報", "連絡先", s連絡先
                SysAD.SetSettingData "支所情報", "郵便番号", s郵便番号
            End If
            
            Select Case sTownCode
                Case "204": '枕崎
                    Set Rs = SystemDB.GetRecordsetEx("SELECT '世帯員.' & [D:個人Info].[ID] & '.' & Format$([遊休時期], 'EEMM') AS [Key], [V_行政区].ID AS 行政区CD,[V_行政区].行政区, [D:個人Info].郵便番号, [D:個人Info].住所, [D:個人Info].氏名, [V_大字].大字, [V_小字].名称, [D:農地Info].地番, [V_地目].名称, [D:農地Info].登記簿面積,[遊休時期] FROM (([D:個人Info] INNER JOIN (([D:農地Info] LEFT JOIN [V_大字] ON [D:農地Info].大字ID = [V_大字].ID) LEFT JOIN [V_小字] ON [D:農地Info].小字ID = [V_小字].ID) ON [D:個人Info].ID = [D:農地Info].所有者ID) INNER JOIN [V_地目] ON [D:農地Info].登記簿地目 = [V_地目].ID) INNER JOIN [V_行政区] ON [D:個人Info].行政区ID = [V_行政区].ID WHERE ((([D:農地Info].遊休化) = True)) ORDER BY [D:農地Info].遊休時期,[V_行政区].ID,[D:個人Info].[フリガナ],[D:農地Info].地番;", 0, , Me)
                    Ay = GetArray(10, 60, 15, 25)
                    str = Split("番号,土　　地　　所　　在　　地,地目,地積（u)", ",")
                    s挨拶 = LoadResString(sTownCode & "00")
                    LTop = 25
                    RTop = 25
                    RLeft = 125
                Case "218": '霧島
                    Set Rs = SystemDB.GetRecordsetEx("SELECT '世帯員.' & [D:個人Info].[ID] AS [Key], [V_行政区].ID AS 行政区CD, [V_行政区].行政区, [D:個人Info].郵便番号, [D:個人Info].住所, [D:個人Info].氏名, [V_大字].大字, [V_小字].名称, [D:農地Info].地番, V_地目.名称, [D:農地Info].登記簿面積, M_BASICALL.名称 AS 農地状況名,#" & mvarDt & "# AS [遊休時期] FROM ((([D:個人Info] INNER JOIN (([D:農地Info] LEFT JOIN [V_大字] ON [D:農地Info].大字ID = [V_大字].ID) LEFT JOIN [V_小字] ON [D:農地Info].小字ID = [V_小字].ID) ON [D:個人Info].ID = [D:農地Info].所有者ID) INNER JOIN V_地目 ON [D:農地Info].登記簿地目 = V_地目.ID) INNER JOIN [V_行政区] ON [D:個人Info].行政区ID = [V_行政区].ID) INNER JOIN M_BASICALL ON [D:農地Info].農地状況 = M_BASICALL.ID WHERE ((([D:農地Info].農地状況) <> 0) AND ((M_BASICALL.Class) = '農地状況')) ORDER BY [V_行政区].ID, [D:個人Info].フリガナ, [D:農地Info].地番;", 0, , Me)
                    Ay = GetArray(10, 60, 15, 25, 55)
                    str = Split("番号,土　　地　　所　　在　　地,地目,地積（u),備　考", ",")
                    s挨拶 = SystemDB.DBProperty("遊休農地調査挨拶")
                    s支所 = Choose(SysAD.GetSettingData("農地基本台帳", "支所番号", 1), "", "溝辺総合支所", "横川総合支所", "牧園総合支所", "霧島総合支所", "隼人総合支所", "福山総合支所")
                    LTop = 10
                    RTop = 10
                    RLeft = 110
            End Select
            
            dX(0) = 20: hX(0) = dX(0) + Ay(0) / 2
            For n = 0 To UBound(Ay)
                dX(n + 1) = dX(n) + Ay(n)
                If n < UBound(Ay) Then hX(n + 1) = dX(n + 1) + Ay(n + 1) / 2
            Next
            
            Do Until Rs.EOF
                sPKey = "時期." & Format(Rs.Value("遊休時期"), "EEMM")
                sGKey = "行政区" & Format(Rs.Value("遊休時期"), "EEMM") & Rs.Value("行政区CD")
                If Not Rs.IsNull("遊休時期") Then
                    For Each pNode In .Nodes
                        If sPKey = pNode.Key Then
                            Exit For
                        End If
                    Next
                    If pNode Is Nothing Then
                        .TreeNodeAdd sPKey, Format(Rs.Value("遊休時期"), "GGGEE年MM月調査"), "CloseFolder"
                    End If
                    For Each pNode In .Nodes
                        If sGKey = pNode.Key Then
                            Exit For
                        End If
                    Next
                    If pNode Is Nothing Then
                        .TreeNodeAdd sGKey, Rs.Value("行政区"), "CloseFolder", sPKey
                    End If
                    
                    If mvarDic.Exists(Rs.Value("Key")) Then
                        St = mvarDic.Item(Rs.Value("Key"))
                        St = St & vbCrLf & Rs.Value("大字") & IIf(Rs.Value("小字") = ".", "", Rs.Value("小字")) & Rs.Value("地番") & ";" & Rs.Value("名称") & ";" & Rs.Value("登記簿面積")
                        mvarDic.Item(Rs.Value("Key")) = St
                    Else
                        St = Rs.Value("郵便番号") & ";" & Rs.Value("氏名") & ";" & Rs.Value("住所") & ";" & Rs.Value("行政区") & vbCrLf & Rs.Value("大字") & IIf(Rs.Value("小字") = ".", "", Rs.Value("小字")) & Rs.Value("地番") & ";" & Rs.Value("名称") & ";" & Rs.Value("登記簿面積")
                        mvarDic.Add Rs.Value("Key"), St
                        .Nodes.Add sGKey, 4, CStr(Rs.Value("Key")), CStr(Rs.Value("氏名")), "Farmer", "Farmer"
                    End If
                    
                    If InStr(";" & .Nodes(sPKey).Tag & ";", ";" & Rs.Value("大字") & ";") Then
                    Else
                        .Nodes(sPKey).Tag = .Nodes(sPKey).Tag & Rs.Value("大字") & ";"
                    End If
                    
                    Rs.MoveNext
                End If
            Loop
        End With
        MsgBox "件数 = " & mvarDic.Count & " 件", vbInformation
        SystemDB.CloseRs Rs
        
        CPrintCls_DataInit = False
        Exit Function
    DataInitError:
        CPrintCls_DataInit = True
    End Function
    

    Private Property Let CPrintCls_Key(ByVal RHS As String)
    
    End Property

    Private Property Get CPrintCls_Key() As String
    
    End Property
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants: CPrintCls_Orientation = vbPRORPortrait: End Property

    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&)

    End Sub
    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property
    Private Property Set CPrintCls_Parent(RHS As ADBasicLIB2.CPrintFormSK): Set mvarParent = RHS: End Property

    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        Dim pNode As Object
        Dim n As Long
        Dim Ar As Variant

        For Each pNode In mvarParent.Nodes
            If Fnc.GetKeyHead(pNode.Key) <> "世帯員" Then
            ElseIf pNode.Checked Then
                pNode.Checked = False
                Ar = Split(mvarDic.Item(pNode.Key), vbCrLf)
                mvarParent.MaxPage = IIf(UBound(Ar) - 1 <= Rows, 1, Fix((UBound(Ar) - 1) / Rows) + 1)

                For n = 1 To mvarParent.MaxPage
                    PrintSub pNode.Key, n
                    mvarParent.NewPage
                Next
                mvarParent.EndDoc
            End If
        Next
    End Sub
    Private Sub CPrintCls_Repaint(): PrintSub mvarKey, mvarParent.MaxPage: End Sub
        
    Private Sub PrintSub(sKey As String, nMaxP As Long)
        Dim y As Single
        Dim TB As Single
        Dim Count As Single
        Dim St As String
        Dim Ar As Variant, Cm As Variant
        Dim pNode As MSComctlLib.Node
        Dim sHeader As String
        Dim arOZ As Variant
        Dim n As Long
        
        With mvarParent
            .ClearScreen
            .Offset 0, 0
            
            If sKey = "" Then Exit Sub
            If Fnc.GetKeyHead(sKey) <> "世帯員" Then Exit Sub
            
            Set pNode = .Nodes(sKey)
            Set pNode = pNode.Parent.Parent
            
            sHeader = pNode.Text
            arOZ = Split(pNode.Tag, ";")
                        
            St = mvarDic.Item(sKey)
            Ar = Split(St, vbCrLf)
            Cm = Split(Ar(0), ";")
    '------------------------------表作成
            .DBox 20, LTop, 104, LTop + 31, vbBlack, 4     '上の左の枠
            .DLine 30, LTop + 25, 90, LTop + 25, vbBlack      '上の左の枠の中の横線
            
            .DBox RLeft, RTop, 190, RTop + 22, vbBlack, 4  '上の右の枠
            
            .DBox 20, 102, 90, 107, vbBlack         '下の左の表の上
            .LineBoxDX 20, 107, HH, Rows, nPit, Ay  '下の左の表
    '------------------------------------
    '----------------------------文字埋め
            .TextOut "ｂP", 182, RTop - 5
            .TextOut "〒" & Cm(0), 22, LTop + 1
            .TextOut Cm(2), 22, LTop + 5, 11
            .TextOut Cm(1), 33, LTop + 21, 11
            .TextOut "様", 91, LTop + 21, 11
            .TextOut IIf(Cm(3) = "不明", "", "( " & Cm(3) & " )"), 64, LTop + 25, 11
            
            .TextOut "問い合わせ先", RLeft + 1, RTop + 1
            .TextOut s市町村名 & "農業委員会 " & s支所, RLeft + 1, RTop + 10
            .TextOut "〒" & s郵便番号 & " " & s住所, RLeft + 1, RTop + 14
            .TextOut "" & s連絡先, RLeft + 1, RTop + 18
            .TextOut Format(mvarDt, "GGGEE年 MM月 DD日"), RLeft, RTop + 25
            
            Select Case sTownCode
                Case "204": '枕崎
                    .TextOut Left$(sHeader, 4) & "年度農地現況調査について(お願い)", 40, 14, 18
                    .DBox 140, 102, 185, 236, vbBlack       '上の右の枠
                    .LineX 140, 185, 116, 15                '下の右の表の横線
                    
                    .DrawText s挨拶, 20, 62, 172, 4, 13, 0, 0, 36
                    
                    .TextOut "今回調査したところ", 146, 108
                    For y = 0 To UBound(arOZ)
                        .TextOut "  " & arOZ(y), 146, 118 + y * nPit
                    Next
                Case "218": '霧島
                    .TextOut "耕作放棄地の管理について(依頼)", 22, LTop + 36, 18, 0
                    .DrawText s挨拶, 20, 60, 172, 4, 12, 0, 0, 38
            End Select
            .TextOut "耕作されていない農地", 37, 103
            
            For n = 0 To UBound(str)
                .TextOut str(n), hX(n), 110, 10, 2
            Next
            
            .TextOut "◎　調査員の誤認の場合は、ご了承下さい｡", 22, 280, 13

            St = MID$(St, InStr(St, vbCrLf) + 2)
            Cm = Split(St, ";")
    '-----------------------------------
    '---------------------------データはめ込み用の文字位置
        For y = 1 To 15
            If y > UBound(Ar) Then Exit For
            Cm = Split(Ar(y), ";")
            .DrawText y, dX(0), 116 + TB, Ay(0), 4, 10, 2, 2, nPit
            .DrawText Cm(0), dX(1), 116 + TB, Ay(1), 4, 10, 0, 2, nPit
            .DrawText Cm(1), dX(2), 116 + TB, Ay(2), 4, 10, 2, 2, nPit
            .DrawText FormatNumber(Cm(2), 0), dX(3), 116 + TB, Ay(3), 4, 10, 1, 2, nPit
            TB = nPit * y
        Next
    '-----------------------------------
        End With
    End Sub

    Private Sub CPrintCls_TargetChange(sKey As String)
        Dim Ar As Variant
        
        If Fnc.GetKeyHead(sKey) = "世帯員" Then
            mvarKey = sKey
            Ar = Split(mvarDic.Item(sKey), vbCrLf)
            mvarParent.MaxPage = IIf(UBound(Ar) - 1 <= Rows, 1, Fix((UBound(Ar) - 1) / Rows) + 1)
        Else
            mvarKey = ""
        End If
        
        CPrintCls_Repaint
    End Sub

End Class


Class C利用権終期通知書
     Option Explicit
    Implements CPrintCls
    Private mvarParent As CPrintFormSK
    Private mvarKey As String
    Private dtStart As Date
    Private dtEnd As Date
    Private dtPrintDay As Date
    Private dtXX As Date
    Private mvarData As String
    Private mvar市町村 As String
    Private mvarTPH As Single
    Private mvarPn(1 To 2) As String
    Private mvarQn(1 To 3) As String
    Private mvarRn(1 To 2) As String
    Private b封筒 As Boolean
    Private s連絡先 As String
    Private mvar〆日 As Long
    Private dt提出 As Date

    Private Property Get CPrintCls_CanCancelPrint() As Boolean: End Property
    Private Property Get CPrintCls_CanPrintNowPage() As Boolean: End Property

    Private Function CPrintCls_DataInit(Optional sParam As String = "") As Boolean
        Dim Ar As Variant
        Dim Rs As ADBasicLIB2.RecordsetEx
        Dim pNode As MSComctlLib.Node
        Dim pDic As CDataDictionary
        Dim sSQL As String
        
        Ar = Split(sParam, ";")
        If IsDate(Ar(0)) Then dtPrintDay = CDate(Ar(0))
        mvar市町村 = SystemDB.DBProperty("市町村名")
        If Ar(2) Then
            mvar〆日 = Val(Ar(2))
        End If
        
        If mvar〆日 = 0 Then mvar〆日 = 1
        dtStart = DateSerial(Year(dtPrintDay), Month(dtPrintDay) + SystemDB.DBProperty("利用権終期検索開始"), 1)
        dtEnd = DateSerial(Year(dtStart), Month(dtStart) + SystemDB.DBProperty("利用権終期検索終了"), 1) - 1
        dtXX = DateSerial(Year(dtPrintDay), Month(dtPrintDay) + 2, mvar〆日)
        
        dt提出 = 0
        If UBound(Ar) > 2 Then
            dt提出 = CDate(Ar(3))
        End If
        
        mvarParent.UsedTreeView = True
        
        mvarData = mvar市町村
        Select Case mvar市町村
            Case "大崎町"
                mvarTPH = 8
                '1 〜 4
                mvarPn(1) = "耕作者"
                mvarPn(2) = "所有者"
                mvarRn(1) = "継続して貸し付けたい場合は"
                mvarRn(2) = "引き続き耕作する希望があれば"
                mvarQn(1) = "を設定した"
                mvarQn(2) = "の設定を受けた"
                mvarQn(3) = "(契約されない場合は、利用権は自動的に消滅します。)"
            Case Else
                If mvar市町村 = "枕崎市" Then
                    mvarTPH = 8
                Else
                    mvarTPH = 10
                End If
                
                '1 〜 4
                mvarPn(1) = "耕作者"
                mvarPn(2) = "所有者"
                mvarRn(1) = "貸付けたい"
                mvarRn(2) = "耕作したい"
                mvarQn(1) = "を設定した"
                mvarQn(2) = "の設定を受けた"
                mvarQn(3) = ""
        End Select
        
        Select Case mvar市町村
            Case "さつま町"
                b封筒 = True
                mvarData = mvarData & ";;"
                mvarData = mvarData & ";" & mvar市町村 & "農業委員会会長;" & SystemDB.DBProperty("会長名")
            Case "姶良市"
                b封筒 = True
                mvarData = mvarData & ";;"
                mvarData = mvarData & ";" & mvar市町村 & "農業委員会;"
            Case Else
                b封筒 = False
                mvarData = mvarData & ";;"
                mvarData = mvarData & ";" & mvar市町村 & "農業委員会会長;" & SystemDB.DBProperty("会長名")
        End Select
        
        
        '5 〜
        If SystemDB.DBProperty("利用権終期文字列") = "" Then
            mvarData = mvarData & ";" & "%D1%付け公告の農用地利用集積計画によって利用権を設定した下記の土地は、%D2%を持って貸借契約の期間が終了しますので通知します。\n　また、%Pn%の%An%氏にも契約が終了する旨、連絡いたしましたので\n申し添えます｡なお、契約期間が終了する土地を継続して%Rn%場合、農業委員等を通じて%D3%までに農業委員会へ申し出て下さい｡"
        Else
            mvarData = mvarData & ";" & SystemDB.DBProperty("利用権終期文字列")
        End If


        mvarData = mvarData & ";" & Ar(1)
                
        Set Rs = SystemDB.GetRecordsetEx("SELECT V_農地.土地所在, V_農地.所有者ID, V_農地.管理人ID, [D:個人Info].氏名 AS 貸し手, [D:個人Info].住所 AS 貸し手住所, V_農地.借受人ID, V_農地.小作形態, [D:個人Info_1].氏名 AS 借り手, [D:個人Info_1].住所 AS 借り手住所, V_農地.小作開始年月日, V_農地.小作終了年月日, V_地目.名称 AS 地目名, ([田面積]+[畑面積]) AS 面積, [D:個人Info].郵便番号 AS 郵便番号A, V_行政区.名称 AS 集落名A, [D:個人Info_1].郵便番号 AS 郵便番号B, V_行政区_1.名称 AS 集落名B FROM ((((V_農地 LEFT JOIN [D:個人Info] ON V_農地.管理人ID = [D:個人Info].ID) LEFT JOIN [D:個人Info] AS [D:個人Info_1] ON V_農地.借受人ID = [D:個人Info_1].ID) LEFT JOIN V_地目 ON V_農地.登記簿地目 = V_地目.ID) LEFT JOIN V_行政区 ON [D:個人Info].行政区ID = V_行政区.ID) LEFT JOIN V_行政区 AS V_行政区_1 ON [D:個人Info_1].行政区ID = V_行政区_1.ID " & _
                                         "WHERE ([小作地適用法]=2) AND ([V_農地].[小作終了年月日]>=#" & Format(dtStart, "yyyy/mm/dd") & "# And (V_農地.小作終了年月日)<=#" & Format(dtEnd, "yyyy/mm/dd") & "#) AND ((V_農地.自小作別)>0) ORDER BY V_農地.小作終了年月日;")
        Do Until Rs.EOF
            For Each pNode In mvarParent.Nodes
                If pNode.Key = "n" & Rs.Value("管理人ID") & "X" & Rs.Value("借受人ID") Then
                    Exit For
                End If
            Next
            
            If pNode Is Nothing Then
                Set pNode = mvarParent.TreeNodeAdd("n" & Rs.Value("管理人ID") & "X" & Rs.Value("借受人ID"), "(" & Format(Rs.Value("小作終了年月日"), "GGEE年MM月DD日") & ")" & Rs.Value("貸し手") & "→" & Rs.Value("借り手"), "Unit")
                pNode.Tag = Rs.Value("小作開始年月日") & "," & Rs.Value("小作終了年月日") & "," & Rs.Value("貸し手") & "," & Rs.Value("借り手")
                pNode.Tag = pNode.Tag & "," & Fnc.GetShortAddress(Rs.NullCast("貸し手住所", ""), "鹿児島県", SystemDB.DBProperty("郡部"), , , True)
                pNode.Tag = pNode.Tag & "," & Fnc.GetShortAddress(Rs.NullCast("借り手住所", ""), "鹿児島県", SystemDB.DBProperty("郡部"), , , True)
                pNode.Tag = pNode.Tag & "," & Rs.NullCast("郵便番号A", "") & "," & Rs.NullCast("集落名A", "") & "," & Rs.NullCast("郵便番号B", "") & "," & Rs.NullCast("集落名B", "")
                pNode.Tag = pNode.Tag & ";" & Rs.Value("土地所在") & "," & Rs.Value("地目名") & "," & Rs.Value("面積") & "," & Rs.Value("小作形態")
            Else
                pNode.Tag = pNode.Tag & ";" & Rs.Value("土地所在") & "," & Rs.Value("地目名") & "," & Rs.Value("面積") & "," & Rs.Value("小作形態")
            End If
            
            Rs.MoveNext
        Loop
        Rs.CloseRs
        
        MsgBox "全 " & mvarParent.Nodes.Count & " 件(" & dtStart & "〜" & dtEnd & ")"
        mvarParent.Page = 1
        mvarParent.MaxPage = 1
        
        sSQL = "SELECT '世帯員.' & [D:個人Info_1].[ID] AS [Key], [D:個人Info_1].氏名, [D:個人Info_1].フリガナ, [D:個人Info_1].郵便番号 AS 郵便番号, [D:個人Info_1].住所 " & _
        "FROM V_農地 LEFT JOIN [D:個人Info] AS [D:個人Info_1] ON V_農地.管理人ID = [D:個人Info_1].ID " & _
        "WHERE (((V_農地.小作終了年月日)>=#" & Format(dtStart, "yyyy/mm/dd") & "# And (V_農地.小作終了年月日)<=#" & Format(dtEnd, "yyyy/mm/dd") & "#) AND ((V_農地.自小作別)>0) AND ((V_農地.小作地適用法)=2)) " & _
        "GROUP BY '世帯員.' & [D:個人Info_1].[ID], [D:個人Info_1].氏名, [D:個人Info_1].フリガナ, [D:個人Info_1].郵便番号, [D:個人Info_1].住所; " & _
        "UNION SELECT '世帯員.' & [D:個人Info_1].[ID] AS [Key], [D:個人Info_1].氏名, [D:個人Info_1].フリガナ, [D:個人Info_1].郵便番号 AS 郵便番号, [D:個人Info_1].住所 " & _
        "FROM V_農地 LEFT JOIN [D:個人Info] AS [D:個人Info_1] ON V_農地.借受人ID = [D:個人Info_1].ID " & _
        "WHERE (((V_農地.小作終了年月日)>=#" & Format(dtStart, "yyyy/mm/dd") & "# And (V_農地.小作終了年月日)<=#" & Format(dtEnd, "yyyy/mm/dd") & "#) AND ((V_農地.自小作別)>0) AND ((V_農地.小作地適用法)=2)) " & _
        "GROUP BY '世帯員.' & [D:個人Info_1].[ID], [D:個人Info_1].氏名, [D:個人Info_1].フリガナ, [D:個人Info_1].郵便番号, [D:個人Info_1].住所;"

        mvarPDW.SQLListview.SQLListviewCHead sSQL, "氏名;氏名;郵便番号;郵便番号;住所;住所", "利用権終了通知通知対象者リスト【宛名ラベル】"
    End Function
    Private Property Get CPrintCls_FontType() As String: CPrintCls_FontType = "ＭＳ 明朝": End Property
    Private Property Let CPrintCls_Key(ByVal RHS As String): End Property
    Private Property Get CPrintCls_Key() As String: CPrintCls_Key = mvarKey: End Property
    Private Property Get CPrintCls_Orientation() As PrinterObjectConstants: CPrintCls_Orientation = vbPRORPortrait: End Property

    Private Sub CPrintCls_PageChange(sKey As String, Optional nNewPage As Long = 0&)
        PrintSub mvarKey, mvarParent.Page
    End Sub

    Private Property Get CPrintCls_PaperSize() As Long: CPrintCls_PaperSize = vbPRPSA4: End Property
    Private Property Set CPrintCls_Parent(RHS As ADBasicLIB2.CPrintFormSK): Set mvarParent = RHS: End Property

    Private Sub CPrintCls_PrintStart(Optional nStart As Long = 0&, Optional nEnd As Long = 0&, Optional bNowPage As Boolean = False)
        Dim pNode As MSComctlLib.Node
        Dim n As Long
        Dim nMaxPage As Long
        
        For Each pNode In mvarParent.Nodes
            If pNode.Checked Then
                nMaxPage = GetMaxPage(pNode.Key)
                For n = 1 To nMaxPage
                    PrintSub pNode.Key, n
                    mvarParent.NewPage
                Next
                mvarParent.EndDoc
                pNode.Checked = False
            End If
        Next
    End Sub

    Private Sub CPrintCls_Repaint()
        If Len(mvarKey) Then PrintSub mvarKey, mvarParent.Page
    End Sub

    Private Sub PrintSub(sKey As String, nPage As Long)
        Dim sData As String
        Dim Ar As Variant, Cm As Variant
        Dim Ax As Variant
        
        Dim n As Single, i As Long
        Dim nPit As Single, HH As Single, Rows As Long, Ay As Variant       'DX1個目
        Dim P As Variant, st変更 As Variant
        Dim Ln As String
        Dim LX(20) As String
        Dim pDate As Date
        Dim dX(5) As Single, hX(5) As Single
        Dim nL As Long
        
        If nPage = 0 Then Exit Sub
        sData = mvarParent.Nodes(sKey).Tag
        n = 0

        HH = 23     'ヘッダーの高さ
        Rows = 15   '何セル分
        nPit = 8    '表の中の繰り返しの巾
        Ay = GetArray(70, 15, 23, 28, 30)

        dX(0) = 23: hX(0) = dX(0) + Ay(0) / 2
        For n = 0 To UBound(Ay)
            dX(n + 1) = dX(n) + Ay(n)
            If n < UBound(Ay) Then hX(n + 1) = dX(n + 1) + Ay(n + 1) / 2
        Next
    '----------------------------------
        With mvarParent
            .ClearScreen
            .Offset 0, 0
            
            
            If mvar市町村 = "姶良市" Then
                nL = 22
            Else
                nL = 0
            End If
            
            If nPage <= 2 Then
    '----------------------------表作成
                .LineBoxDX dX(0), 141, HH, Rows, nPit, Ay   '地目→相手方
    
                .DLine 9 + IIf(mvar市町村 = "姶良市", nL, 0), 43, 57 + nL, 43, vbBlack    '殿の下線
                .DLine 45, 72, 155, 72, vbBlack    'タイトルの下線
    '-----------------------------------
                If Len(mvarData) Then
                    Ax = Split(mvarData, ";")
                Else
                    Exit Sub
                End If
    '------------------------------共通部
                .TextOut Format(dtPrintDay, "GGG  E年  M月   D日"), 175 + IIf(mvar市町村 = "姶良市", -10, 0), 21, 11, 1
                If Val(SystemDB.DBProperty("終期通知番号指定")) = 1 Then .TextOut "農委第  " & Ax(6) & " 号", 175, 15, 11, 1
                If Len(Ax(1)) Then
                    .TextOut Ax(1), 115, 45, 11, 0
                    .TextOut Ax(2), 165, 45, 11, 0
                End If
    
                If Len(Ax(4)) Then
                    .TextOut Ax(3), 95, 51, 11, 0
                    .TextOut Ax(4), 145, 51, 11, 0
                Else
                    .TextOut Ax(3), 145, 51, 11, 0
                End If
                
                .TextOut "利用権" & mvarQn(nPage) & "農地の契約期間終了通知書", 100, 67, 13, 2
                
                .TextOut "記", (dX(0) + dX(5)) / 2, 130, 11, 2

                .TextOut "所　　　在　　　地", hX(0), 150, 11, 2
                If mvar市町村 = "三股町" Then .TextOut "(三股町)", hX(0), 155, 11, 2
                .TextOut "地 目", hX(1), 150, 11, 2
                .TextOut "備  考", hX(4), 150, 11, 2
                .DrawText " 面  積\n\n(  u  )", dX(2) + 3, 146, Ay(2), 4, 11
                .DrawText "利用権等\n\nの 種 類", dX(3) + 6, 146, Ay(3), 4, 11
    '------------------------------個人別
                Ar = Split(sData, ";")
                Cm = Split(Ar(0), ",")
                .TextOut "殿", 54 + nL, 38, 11, 2
    '------------------------------市町村別

                If mvar市町村 <> "三股町" Then
                    .TextOut Format(Cm(0), "公告日　GGG E年 M月 D日"), dX(0), 132, 11, 0
                Else
                    .TextOut Format(Cm(0), "開始日　GGG E年 M月 D日"), dX(0), 132, 11, 0
                End If
                .TextOut Format(Cm(1), "終了日　GGG E年 M月 D日"), dX(0), 136, 11, 0
                
                If UBound(Ax) > 4 Then
                    Ln = Ax(5)
                    Ln = Replace(Ln, "%D1%", " " & Format(Cm(0), "GGG E年 M月 D日") & " ")
                    Ln = Replace(Ln, "%D2%", " " & Format(Cm(1), "GGG E年 M月 D日") & " ")

                    If mvar市町村 = "南種子町" Then
                        pDate = DateAdd("m", -1, CDate(Cm(1)))
                        dtXX = DateSerial(Year(pDate), Month(pDate), mvar〆日)
                        If dt提出 = 0 Then
                            Ln = Replace(Ln, "%D3%", " " & Format(dtXX, "GGG E年 M月 D日") & " ")
                        Else
                            Ln = Replace(Ln, "%D3%", " " & Format(dt提出, "GGG E年 M月 D日") & " ")
                        End If
                    Else
                        If dt提出 = 0 Then
                            Ln = Replace(Ln, "%D3%", " " & Format(dtXX, "GGG E年 M月 D日") & " ")
                        Else
                            Ln = Replace(Ln, "%D3%", " " & Format(dt提出, "GGG E年 M月 D日") & " ")
                        End If
                    End If
                    Ln = Replace(Ln, "%Pn%", mvarPn(nPage))
                    Ln = Replace(Ln, "%Rn%", mvarRn(nPage))
                    Ln = Replace(Ln, "%Qn%", mvarQn(nPage))
                    Ln = Ln & mvarQn(3)
            
                    If nPage = 1 And mvar市町村 = "三股町" Then
                        .TextOut "貸し手農家に対する通知書", 175, 15, 11, 1, 0
                        .DLine 124, 19, 176, 19
                        .TextOut Cm(4), 9, 31, 11   '窓空き封筒で出すという話になれば表示させる
                        .TextOut Cm(2), 25, 38, 11, 2
    '                        .TextOut "住所住所住所", 9, 31, 11   '窓空き封筒で出すという話になれば表示させる
    '                        .DrawText "あいうえおかきくけこさしすせそたちつてとなにぬねの", 6, 35, 48, 4, 11, 0, 1, 8
    '                        .DBox 6, 35, 54, 43, vbRed
                        .TextOut "借受人:" & Cm(3), 125, 136, 11, 2
                        Ln = Replace(Ln, "%An%", " " & Cm(3) & " ")
                        If Len(Cm(6)) = 7 Then Cm(6) = Left$(Cm(6), 3) & "-" & MID$(Cm(6), 4)
    '                        If b封筒 Then .TextOut Cm(6), 9, 24, 11 '郵便番号
    '                        If b封筒 Then .TextOut Cm(7), 9, 46, 11 '集落名
                    ElseIf nPage = 1 And (mvar市町村 <> "姶良市") Then
    '                    If nPage = 1 And (mvar市町村 <> "姶良市") Then
                        .TextOut Cm(4), 9, 31, 11
                        .TextOut Cm(2), 25, 38, 11, 2
                        .TextOut "借受人:" & Cm(3), 125, 136, 11, 2
                        Ln = Replace(Ln, "%An%", " " & Cm(3) & " ")
                        If Len(Cm(6)) = 7 Then Cm(6) = Left$(Cm(6), 3) & "-" & MID$(Cm(6), 4)
                        If b封筒 Then .TextOut Cm(6), 9, 24, 11 '郵便番号
                        If b封筒 Then .TextOut Cm(7), 9, 46, 11 '集落名
                    ElseIf nPage = 1 And mvar市町村 = "姶良市" Then
                        .TextOut Cm(4), 9 + nL, 31, 11
                        .TextOut Cm(2), 25 + nL, 38, 11, 2
                        .TextOut "借受人:" & Cm(3), 125, 136, 11, 2
                        Ln = Replace(Ln, "%An%", " " & Cm(3) & " ")
                        If Len(Cm(6)) = 7 Then Cm(6) = Left$(Cm(6), 3) & "-" & MID$(Cm(6), 4)
                        If b封筒 Then .TextOut "〒" & Cm(6), 9 + nL, 24, 11 '郵便番号
                        If b封筒 And Len(Cm(7)) > 0 Then .TextOut "(" & Trim(Cm(7)) & ")", 9 + nL, 46, 11  '集落名
                    Else
                        If mvar市町村 <> "姶良市" Then .TextOut Cm(5), 9, 31, 11
                        .TextOut Cm(3), 25 + nL, 38, 11, 2
                        .TextOut "貸付人:" & Cm(2), 125, 136, 11, 2
                        Ln = Replace(Ln, "%An%", " " & Cm(2) & " ")
                        
                        If Len(Cm(8)) = 7 Then Cm(8) = Left$(Cm(8), 3) & "-" & MID$(Cm(8), 4)
                        If mvar市町村 = "姶良市" Then
                            Cm(5) = Replace(Cm(5), mvar市町村, "")
                            If InStr(Cm(5), "姶良町") > 0 Or InStr(Cm(5), "加治木町") > 0 Or InStr(Cm(5), "蒲生町") > 0 Then
                                .TextOut mvar市町村 & Cm(5), 9 + nL, 31, 11
                            Else
                                .TextOut Cm(5), 9 + nL, 31, 11
                            End If
                            
                            If b封筒 Then .TextOut "〒" & Cm(8), 9 + nL, 24, 11 '郵便番号
                            If b封筒 And Len(Cm(9)) > 0 Then .TextOut "(" & Trim(Cm(9)) & ")", 9 + nL, 46, 11 '集落名
                        Else
                            If b封筒 Then .TextOut Cm(8), 9, 24, 11 '郵便番号
                            If b封筒 Then .TextOut Cm(9), 9, 46, 11 '集落名
                        End If
                    
                        If mvar市町村 = "三股町" Then
                            .TextOut "借り手農家に対する通知書", 175, 15, 11, 1, 0
                            .DLine 124, 19, 176, 19
                        End If
                    
                    End If
                End If

                '利用権終期文字列
                If InStr(Ln, "＄＄＄") Then
                    Cm = Split(Ln, "＄＄＄")
                    If mvarParent.Page = 1 Then
                        .DrawText Cm(0), 29, 82, 160, mvarTPH, 12
                        .TextOut "【貸し手】", 6, 16, 11
                    Else
                        .DrawText Cm(1), 29, 82, 160, mvarTPH, 12
                        .TextOut "【借り手】", 6, 16, 11
                    End If
                Else
                    .DrawText Ln, 29, 82, 162, mvarTPH, 12
                End If
    '                Select Case mvarData & mvarParent.Page
                Select Case mvar市町村 & mvarParent.Page
                    Case "三股町1", "三股町2"
                        If mvarParent.Page = 1 Then
                            st変更 = "利用権を設定した,耕作者,連絡いたしましたので申し添えます。   　賃借契約が終了した後、貴殿が耕作される場合は借手にも連絡しておいて下さい。また耕作されず、,貸,　貸借契約が終了した後、貴殿が耕作される場合は借手にも連絡しておいてください。また耕作されず、継続して貸される場合には必ず、利用権の設定をしてください。"
                            P = Split(st変更, ",")
                        Else
                            st変更 = "利用権の設定を受けた,所有者,連絡いたしましたが、さらに,耕作"
                            P = Split(st変更, ",")
                        End If
    '                        .hTextOut "　平成　　　年　　　月　　　日付公告の農用地利用集積計画によって" & P(0) & "下記の農地は、平成　　年　　月　　日をもって賃借契約の期間が終了しますので通知致します。", 29, 82, 37, 8
    '                        .hTextOut "　なお、" & P(1) & "にも契約が終了する旨、" & P(2) & "継続して" & P(3) & "される場合は必ず、利用権の設定をして下さい｡", 29, 106, 38, 8
    '                        .hTextOut "※この通知書の写しは最寄の農業委員（農地集積促進員）にも配布してありますので利用権の設定をされる場合はご相談下さい。", 29, 138, 37, 8
                End Select
    '-----------------------------------
    '------------------------------当込み
                For n = 1 To UBound(Ar)
    '                    If n > 10 Then Exit For
                    If n > 15 Then Exit For
                    Cm = Split(Ar(n), ",")
                    .TextOut Cm(0), dX(0) + 1, 160 + n * 8, 11, , 2
                    .TextOut Cm(1), hX(1), 160 + n * 8, 11, 2, 2
                    .TextOut FormatNumber(Cm(2), 0), dX(3) - 1, 160 + n * 8, 11, 1, 2
                    .TextOut Choose(Val(Cm(3)) + 1, "", "賃貸借権", "使用貸借権", "その他", ""), hX(3), 160 + n * 8, 11, 2, 2
                Next
    '-----------------------------------
            Else
                Ar = Split(sData, ";")
                .TextOut "所　　　在　　　地", hX(0), 35, 11, 2
                If mvar市町村 = "三股町" Then .TextOut "(三股町)", hX(0), 40, 11, 2
                .TextOut "地 目", hX(1), 35, 11, 2
                .TextOut "備  考", hX(4), 35, 11, 2
                .DrawText " 面  積\n\n(  u  )", dX(2) + 3, 31, Ay(2), 4, 11
                .DrawText "利用権等\n\nの 種 類", dX(3) + 6, 31, Ay(3), 4, 11
                    
                .LineBoxDX dX(0), 26, HH, 28, nPit, Ay   '地目→相手方
                If nPage = 3 Then
                    i = 11
                Else
                    i = 11 + (nPage - 3) * 27
                End If
                
                n = 1
                For n = i To n + 27
                    If n > UBound(Ar) Then Exit For
                    Cm = Split(Ar(n), ",")
                    .TextOut Cm(0), dX(0) + 1, 53 + (n - i) * 8, 11, , 2
                    .TextOut Cm(1), hX(1), 53 + (n - i) * 8, 11, 2, 2
                    .TextOut FormatNumber(Cm(2), 0), dX(3) - 1, 53 + (n - i) * 8, 11, 1, 2
                    .TextOut Choose(Val(Cm(3)) + 1, "", "賃貸借権", "使用貸借権", "その他", ""), hX(3), 53 + (n - i) * 8, 11, 2, 2
                Next
            
            End If
        End With
    End Sub

End Class
